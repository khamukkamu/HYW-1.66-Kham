# -*- coding: cp1254 -*-
from header_common import *
from header_dialogs import *
from header_operations import *
from header_parties import *
from header_item_modifiers import *
from header_skills import *
from header_triggers import *
from ID_troops import *
from ID_party_templates import *

from module_constants import *
from compiler import *
########################################################
# During a dialog, the dialog lines are scanned from top to bottom.
# If the dialog-line is spoken by the player, all the matching lines are displayed for the player to pick from.
# If the dialog-line is spoken by another, the first (top-most) matching line is selected.
#
#  Each dialog line contains the following fields:
# 1) Dialogue partner: This should match the person player is talking to.
#    Usually this is a troop-id.
#    You can also use a party-template-id by appending '|party_tpl' to this field.
#    Use the constant 'anyone' if you'd like the line to match anybody.
#    Appending '|plyr' to this field means that the actual line is spoken by the player
#    Appending '|other(troop_id)' means that this line is spoken by a third person on the scene.
#       (You must make sure that this third person is present on the scene)
#
# 2) Starting dialog-state:
#    During a dialog there's always an active Dialog-state.
#    A dialog-line's starting dialog state must be the same as the active dialog state, for the line to be a possible candidate.
#    If the dialog is started by meeting a party on the map, initially, the active dialog state is "start"
#    If the dialog is started by speaking to an NPC in a town, initially, the active dialog state is "start"
#    If the dialog is started by helping a party defeat another party, initially, the active dialog state is "party_relieved"
#    If the dialog is started by liberating a prisoner, initially, the active dialog state is "prisoner_liberated"
#    If the dialog is started by defeating a party led by a hero, initially, the active dialog state is "enemy_defeated"
#    If the dialog is started by a trigger, initially, the active dialog state is "event_triggered"
# 3) Conditions block (list): This must be a valid operation block. See header_operations.py for reference.
# 4) Dialog Text (string):
# 5) Ending dialog-state:
#    If a dialog line is picked, the active dialog-state will become the picked line's ending dialog-state.
# 6) Consequences block (list): This must be a valid operation block. See header_operations.py for reference.
# 7) Voice-over (string): sound filename for the voice over. Leave here empty for no voice over
####################################################################################################################

dialogs = [
  [anyone ,"start", [(store_conversation_troop, "$g_talk_troop"),
      (store_conversation_agent, "$g_talk_agent"),
      (store_troop_faction, "$g_talk_troop_faction", "$g_talk_troop"),
      #                     (troop_get_slot, "$g_talk_troop_relation", "$g_talk_troop", slot_troop_player_relation),
      (call_script, "script_troop_get_player_relation", "$g_talk_troop"),
      (assign, "$g_talk_troop_relation", reg0),
      
      #This may be different way to handle persuasion, which might be a little more transparent to the player in its effects
      #Persuasion will affect the player's relation with the other character -- but only for 1 on 1 conversations
      (store_skill_level, ":persuasion", "skl_persuasion", "trp_player"),
      (assign, "$g_talk_troop_effective_relation", "$g_talk_troop_relation"),
      (val_add, "$g_talk_troop_effective_relation", ":persuasion"),
      (try_begin),
        (gt, "$g_talk_troop_effective_relation", 0),
        (store_add, ":persuasion_modifier", 10, ":persuasion"),
        (val_mul, "$g_talk_troop_effective_relation", ":persuasion_modifier"),
        (val_div, "$g_talk_troop_effective_relation", 10),
      (else_try),
        (lt, "$g_talk_troop_effective_relation", 0),
        (store_sub, ":persuasion_modifier", 20, ":persuasion"),
        (val_mul, "$g_talk_troop_effective_relation", ":persuasion_modifier"),
        (val_div, "$g_talk_troop_effective_relation", 20),
      (try_end),
      (val_clamp, "$g_talk_troop_effective_relation", -100, 101),
      (try_begin),
        (eq, "$cheat_mode", 1),
        (assign, reg3, "$g_talk_troop_effective_relation"),
        (display_message, "str_test_effective_relation_=_reg3"),
      (try_end),
      
      (try_begin),
        (this_or_next|is_between, "$g_talk_troop", village_elders_begin, village_elders_end),
        (is_between, "$g_talk_troop", mayors_begin, mayors_end),
        (party_get_slot, "$g_talk_troop_relation", "$current_town", slot_center_player_relation),
      (try_end),
      (store_relation, "$g_talk_troop_faction_relation", "$g_talk_troop_faction", "fac_player_faction"),
      
      (assign, "$g_talk_troop_party", "$g_encountered_party"),
      (try_begin),
        (troop_slot_ge, "$g_talk_troop", slot_troop_leaded_party, 1),
        (troop_get_slot, "$g_talk_troop_party", "$g_talk_troop", slot_troop_leaded_party),
      (try_end),
      
      #                     (assign, "$g_talk_troop_kingdom_relation", 0),
      #                     (try_begin),
      #                       (gt, "$players_kingdom", 0),
      #                       (store_relation, "$g_talk_troop_kingdom_relation", "$g_talk_troop_faction", "$players_kingdom"),
      #                     (try_end),
      
      
      
      (store_current_hours, "$g_current_hours"),
      (troop_get_slot, "$g_talk_troop_last_talk_time", "$g_talk_troop", slot_troop_last_talk_time),
      (troop_set_slot, "$g_talk_troop", slot_troop_last_talk_time, "$g_current_hours"),
      (store_sub, "$g_time_since_last_talk","$g_current_hours","$g_talk_troop_last_talk_time"),
      (troop_get_slot, "$g_talk_troop_met", "$g_talk_troop", slot_troop_met),
      (val_min, "$g_talk_troop_met", 1), #the global variable goes no higher than one
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", slot_troop_met, 0),
        (troop_set_slot, "$g_talk_troop", slot_troop_met, 1),
        
        #Possible later activations of notes
        (try_begin),
          (is_between, "$g_talk_troop", kingdom_ladies_begin, kingdom_ladies_end),
        (try_end),
        
      (try_end),
      
      (try_begin),
        #                       (this_or_next|eq, "$talk_context", tc_party_encounter),
        #                       (this_or_next|eq, "$talk_context", tc_castle_commander),
        (call_script, "script_party_calculate_strength", "p_collective_enemy",0),
        (assign, "$g_enemy_strength", reg0),
        (call_script, "script_party_calculate_strength", "p_main_party",0),
        (assign, "$g_ally_strength", reg0),
        (store_mul, "$g_strength_ratio", "$g_ally_strength", 100),
        (assign, ":enemy_strength", "$g_enemy_strength"), #these two lines added to avoid div by zero error
        (val_max, ":enemy_strength", 1),
        (val_div, "$g_strength_ratio", ":enemy_strength"),
      (try_end),
      
      (assign, "$g_comment_found", 0),
      
      (assign, "$g_comment_has_rejoinder", 0),
      (assign, "$g_romantic_comment_made", 0),
      (assign, "$skip_lord_assumes_argument", 0), #a lord pre-empts a player's issue, ie, when the player is conducting a rebellion
      (assign, "$bypass_female_vassal_explanation", 0),
      (assign, "$g_done_wedding_comment", 0),
      
      #					 (assign, "$g_time_to_spare", 0),
      
      
      (try_begin),
        (troop_is_hero, "$g_talk_troop"),
        (talk_info_show, 1),
        
      (try_end),
      
      (assign, "$g_last_comment_copied_to_s42", 0),
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
        (call_script, "script_get_relevant_comment_to_s42"),
        (assign, "$g_comment_found", reg0),
      (try_end),
      
      (troop_get_type, reg65, "$g_talk_troop"),
      (try_begin),
        (faction_slot_eq,"$g_talk_troop_faction",slot_faction_leader,"$g_talk_troop"),
        (str_store_string,s64,"@{reg65?my Lady:my Lord}"), #bug fix
        (str_store_string,s65,"@{reg65?my Lady:my Lord}"),
        (str_store_string,s66,"@{reg65?My Lady:My Lord}"),
        (str_store_string,s67,"@{reg65?My Lady:My Lord}"), #bug fix
      (else_try),
        (str_store_string,s64,"@{reg65?madame:sir}"), #bug fix
        (str_store_string,s65,"@{reg65?madame:sir}"),
        (str_store_string,s66,"@{reg65?Madame:Sir}"),
        (str_store_string,s67,"@{reg65?Madame:Sir}"), #bug fix
      (try_end),
      
      (try_begin),
        (gt, "$cheat_mode", 0),
        (assign, reg4, "$talk_context"),
        (display_message, "@{!}DEBUG -- Talk context: {reg4}"),
      (try_end),
      
      (try_begin),
        (gt, "$cheat_mode", 0),
        (assign, reg4, "$g_time_since_last_talk"),
        (display_message, "@{!}DEBUG -- Time since last talk: {reg4}"),
      (try_end),
      
      
      (try_begin),
        (eq, "$cheat_mode", 0),
        (store_partner_quest, ":quest"),
        (ge, ":quest", 0),
        (str_store_quest_name, s4, ":quest"),
        
      (try_end),
      
      (eq, 1, 0)],
    "{!}Warning: This line is never displayed. It is just for storing conversation variables.", "close_window", []],
  
  
  
  
  
  [anyone ,"member_chat", [
      (store_conversation_troop, "$g_talk_troop"),
      (try_begin),
        (is_between, "$g_talk_troop", companions_begin, companions_end),
        (talk_info_show, 1),
        (call_script, "script_setup_talk_info_companions"),
      (else_try),
        (is_between, "$g_talk_troop", pretenders_begin, pretenders_end),
        (talk_info_show, 1),
        (call_script, "script_setup_talk_info"),
      (try_end),
      
      (troop_get_type, reg65, "$g_talk_troop"),
      
      (troop_get_type, reg65, "$g_talk_troop"),
      (try_begin),
        (faction_slot_eq,"$g_talk_troop_faction",slot_faction_leader,"$g_talk_troop"),
        (str_store_string,s64,"@{reg65?my Lady:my Lord}"), #bug fix
        (str_store_string,s65,"@{reg65?my Lady:my Lord}"),
        (str_store_string,s66,"@{reg65?My Lady:My Lord}"),
      (else_try),
        (str_store_string,s64,"@{reg65?madame:sir}"), #bug fix
        (str_store_string,s65,"@{reg65?madame:sir}"),
        (str_store_string,s66,"@{reg65?Madame:Sir}"),
      (try_end),
      
      (store_current_hours, "$g_current_hours"),
      (troop_set_slot, "$g_talk_troop", slot_troop_last_talk_time, "$g_current_hours"),
      
      (eq, 1, 0)],
    "{!}Warning: This line is never displayed. It is just for storing conversation variables.", "close_window", []],
  
  #Dialogue for Sarge / Captain Promotions
  
  #Sarge Dialogues START
  [anyone,"event_triggered",
    [
      (this_or_next|eq, "$talk_context", tc_freelancer_infantry_captain),
      (eq, "$talk_context", tc_freelancer_ranged_captain),
      (store_faction_of_troop, ":commander_faction", "$enlisted_lord"),
      (faction_slot_eq, ":commander_faction", slot_faction_freelancer_captain, 1), #Sarge
    ],
    "{playername}, I've been watching you and I am quite impressed with your progress.^ I've spoken to the men and they agree with my decision.", "freelancer_sarge_1",
    [],
  ],
  
  [anyone|plyr, "freelancer_sarge_1",
    [
      (troop_get_type, reg65, "$enlisted_lord"),
      (try_begin),
        (eq, reg3, 2),
        (assign, reg3, 1), #Kham - Jeanne is female
      (else_try),
        (gt, reg3, 2), #Kham: other skins are male
        (assign, reg3, 0),
      (try_end),
    ],
    "Thank you, my {reg3?Lady:Lord}, I try my best to bring honour to your house.^ What decision is that?", "freelancer_sarge_2",
    [],
  ],
  
  [anyone, "freelancer_sarge_2",
    [(try_begin),
        (eq, "$talk_context", tc_freelancer_ranged_captain),
        (str_store_string, s5, "@Ranged Division Sergeants"),
        (str_store_string, s6, "@A modified shield, or an improved crossbow"),
      (else_try),
        (eq, "$talk_context", tc_freelancer_infantry_captain),
        (str_store_string, s5, "@Infantry Division Sergeants"),
        (str_store_string, s6, "@A modified shield, or an improved bastard sword"),
      (try_end),],
    "You will now be one of my {s5}, commanding a group of 7 men. Your new salary should cover theirs, so will the improved rations I will be giving you.^ Also, as a symbol of your new authority, I will reward you a choice of a two things.^ {s6}, both made by my personal blacksmith.", "freelancer_sarge_3",
    [],
  ],
  
  [anyone|plyr, "freelancer_sarge_3",
    [],
    "I choose the shield. I will not let you nor the men down. You can count on me.", "freelancer_sarge_finish",
    [ (try_begin),
        (eq, "$talk_context", tc_freelancer_infantry_captain),
        (troop_add_item, "trp_player", "itm_tab_shield_kite_d", imod_reinforced),
      (else_try),
        (troop_add_item, "trp_player", "itm_tab_shield_pavise_d", imod_reinforced),
      (try_end)],
  ],
  
  [anyone|plyr, "freelancer_sarge_3",
    [],
    "I choose the weapon. I will not let you nor the men down. You can count on me.", "freelancer_sarge_finish",
    [
      (try_begin),
        (eq, "$talk_context", tc_freelancer_infantry_captain),
        (troop_add_item, "trp_player", "itm_bastard_sword_b", imod_tempered),
      (else_try),
        (troop_add_item, "trp_player", "itm_sniper_crossbow", imod_balanced),
      (try_end)],
  ],
  
  [anyone, "freelancer_sarge_finish",
    [],
    "Good to hear it, {playername}. I'll have someone deliver it to you. Now go and meet your men.", "close_window",
    [ (try_begin),
        (eq, "$talk_context", tc_freelancer_infantry_captain),
        (call_script, "script_freelancer_promoted_to_commander", 1, 7), #Infantry Sarge with 7 troops
      (else_try),
        (call_script, "script_freelancer_promoted_to_commander", 2, 7),
      (try_end),
      (assign, "$talk_context", 0)],
  ],
  #Sarge Dialogues END
  
  #Captain Dialogues START
  [anyone,"event_triggered",
    [
      (this_or_next|eq, "$talk_context", tc_freelancer_infantry_captain),
      (eq, "$talk_context", tc_freelancer_ranged_captain),
      (store_faction_of_troop, ":commander_faction", "$enlisted_lord"),
      (faction_slot_eq, ":commander_faction", slot_faction_freelancer_captain, 2), #Captain
    ],
    "{playername}, You have once again truly proved your worth. You are an example to all of our men.", "freelancer_cap_1",
    [],
  ],
  
  [anyone|plyr, "freelancer_cap_1",
    [
      (troop_get_type, reg65, "$enlisted_lord"),
      (try_begin),
        (eq, reg3, 2),
        (assign, reg3, 1), #Kham - Jeanne is female
      (else_try),
        (gt, reg3, 2), #Kham: other skins are male
        (assign, reg3, 0),
      (try_end),
    ],
    "Thank you, my {reg3?Lady:Lord}. A soldier is only as good as their commander.", "freelancer_cap_2",
    [],
  ],
  
  [anyone, "freelancer_cap_2",
    [(try_begin),
        (eq, "$talk_context", tc_freelancer_ranged_captain),
        (str_store_string, s5, "@Ranged Division Captain"),
        (str_store_item_name, s7, "itm_matchlock_2"),
        (str_store_string, s6, "@a coat of plates fit for a Lord, or an {s7}"),
      (else_try),
        (eq, "$talk_context", tc_freelancer_infantry_captain),
        (str_store_string, s5, "@Infantry Division Captain"),
        (str_store_item_name, s7, "itm_realflambergeb"),
        (str_store_string, s6, "@a coat of plates fit for a Lord, or a {s7}"),
      (try_end),],
    "From now on, you will be my {s5}, commanding a group of 15 men. You will also be given a considerable wage increase, as befit your station.^ I have also something to give you, choose between {s6}, straight from our family's treasures...^", "freelancer_cap_3",
    [],
  ],
  
  [anyone|plyr, "freelancer_cap_3",
    [],
    "The armour will help me defend you from your enemies. I will continue bringing honour to your house.", "freelancer_cap_finish",
    [ (troop_add_item, "trp_player", "itm_early_transitional_heraldic", imod_reinforced)],
  ],
  
  [anyone|plyr, "freelancer_cap_3",
    [],
    "The weapon will help me destroy your enemies. I will continue bringing honour to your house.", "freelancer_cap_finish",
    [
      (try_begin),
        (eq, "$talk_context", tc_freelancer_infantry_captain),
        (troop_add_item, "trp_player", "itm_realflambergeb", imod_balanced),
      (else_try),
        (troop_add_item, "trp_player", "itm_matchlock_2", imod_balanced),
      (try_end)],
  ],
  
  [anyone, "freelancer_cap_finish",
    [],
    "I know you will, {playername}. Now go and meet your men.", "close_window",
    [ (try_begin),
        (eq, "$talk_context", tc_freelancer_infantry_captain),
        (call_script, "script_freelancer_promoted_to_commander", 1, 15), #Infantry Cap with 15 troops
      (else_try),
        (call_script, "script_freelancer_promoted_to_commander", 2, 15),
      (try_end),
      (assign, "$talk_context", 0)],
  ],
  
  #Dialogue Auto-Return from Vacation (Kham)
  
  [anyone,"event_triggered",
    [
      (eq, "$talk_context", tc_vacation_over),
    ],
    "{playername}, I am here to tell you that your leave is over. Join me and return to your post.", "close_window",[
      (call_script, "script_party_copy", "p_freelancer_party_backup", "p_main_party"),
      (remove_member_from_party, "trp_player","p_freelancer_party_backup"),
      (call_script, "script_event_player_returns_vacation"),
      (change_screen_map),
    ],
  ],

# Event Triggers for Pacify Unhappy Troops
  [anyone,"event_triggered", [(check_quest_active, "qst_freelancer_mission_2"), (quest_slot_eq, "qst_freelancer_mission_2", slot_quest_current_state, 1),], 
    "Ha! Good fight, good fight! Exactly what the men were looking for. We should do this more, eh?", "freelancer_pacify_duel_win",[]],

  [anyone,"event_triggered", [(check_quest_active, "qst_freelancer_mission_2"), (quest_slot_eq, "qst_freelancer_mission_2", slot_quest_current_state, 2),], 
    "Alright, we've entertained the men, now for the good stuff. Pay up!", "freelancer_pacify_duel_lose",[]],
  
  [anyone, "event_triggered", [
    (check_quest_active, "qst_freelancer_mission_2"),
    (eq, "$talk_context", tc_garden), #piggybacking on this tc...
    (store_faction_of_troop, ":commander_faction", "$enlisted_lord"),
    (faction_get_slot, ":is_sarge", ":commander_faction", slot_faction_freelancer_captain),
    (try_begin),
      (eq, ":is_sarge", 2),
      (str_store_string, s5, "@Oh, Hello Captain, sorry, didn't see you there. I hope all is well..."),
    (else_try),
      (eq, ":is_sarge", 1),
      (str_store_string, s5, "@Hey Sarge, I bet you know all about blood and guts, eh?"),
    (else_try),
      (str_store_string, s5, "@Oi, {playername},  don't be sneaking about. What do you want?"),
    (try_end)],
    "...blood and guts everywhere, then the rats eat the blood and guts! At least they are feasting, eh! Unlike us, covered with blood, guts, and shit!" + 
    "{s5}", "freelancer_pacify_start",
    []],

  # END Event Triggers for Pacify Unhappy Troops

  #Dialogue for Freelancer Outbound Missions START - Kham
  
  [anyone,"event_triggered", [(eq, "$g_talk_troop", "$enlisted_lord"), (ge, "$cheat_imposed_quest", 0)], "{playername}, I have a task for you.", "freelancer_mission_start",[]],
  
  #Dialogue for Pacify Unhappy Troops

  [anyone, "freelancer_mission_start", [(eq, "$cheat_imposed_quest", "qst_freelancer_mission_2")],
    "{playername}, as you are probably well aware, some of are troops are unhappy. Whether it is the losses we have suffered, or perhaps a lack of beer or ale, there are rumblings among the men." +
    "This cannot stand. I want you to go and placate them. Do what you must, as long as we can continue on without this air of dissatisfaction.", "freelancer_lord_mission_told_pacify",
    []],

  [anyone|plyr, "freelancer_lord_mission_told_pacify", [],
    "I will do what I can to pacify the men.", "freelancer_lord_mission_pacify_accepted",
    []],
  
  [anyone|plyr, "freelancer_lord_mission_told_pacify", [],
    "I cannot accept this mission.", "freelancer_lord_mission_pacify_declined",
    []],


  [anyone, "freelancer_lord_mission_pacify_accepted", [],
    "Very good. I look forward to hearing back from you.", "close_window",[

    #Gold and XP reward based on level.
      (store_character_level, ":level", "trp_player"),
      (assign, ":xp", 150),
      (assign, ":gold", 100),
      (try_begin),
        (le, ":level", 5),
        (assign, ":xp", 100),
        (assign, ":gold", 50),
      (else_try),
        (ge, ":level", 12),
        (assign, ":xp", 200),
        (assign, ":gold", 150),
      (try_end),
      (quest_set_slot, "qst_freelancer_mission_2", slot_quest_xp_reward, ":xp"),
      (quest_set_slot, "qst_freelancer_mission_2", slot_quest_importance, 8),
      (quest_set_slot, "qst_freelancer_mission_2", slot_quest_gold_reward, ":gold"),
      (quest_set_slot, "qst_freelancer_mission_2", slot_quest_expiration_days, 30),
    #Init the quest
      (str_store_troop_name_link, s9, "$enlisted_lord"),
      (setup_quest_text, "qst_freelancer_mission_2"),
      (str_store_string, s2, "@{s9} wants you to pacify his unhappy troops."),
      (call_script, "script_start_quest", "qst_freelancer_mission_2", "$enlisted_lord"),
      (jump_to_menu, "mnu_freelancer_pacify_troops")]],

  [anyone, "freelancer_lord_mission_pacify_declined", [],
    "That is unfortunate, {playername}. Perhaps you are one of the unhappy ones too... Go back to your post.", "close_window",
    []],

  #Unhappy Troops Dialogue Start

  

  [anyone|plyr, "freelancer_pacify_start", [
    (store_faction_of_troop, ":commander_faction", "$enlisted_lord"),
    (faction_get_slot, ":is_sarge", ":commander_faction", slot_faction_freelancer_captain),
    (try_begin),
      (eq, ":is_sarge", 2),
      (str_store_string, s5, "@At ease, soldier. I've been hearing that there is some discord among the men. What can you tell me about it?"),
    (else_try),
      (eq, ":is_sarge", 1),
      (str_store_string, s5, "@I do, yes. But I bet you know more about shit, eh? So what is it that I am hearing, that there are rumblings about the men, eh?"),
    (else_try),
      (str_store_string, s5, "@I just want to know why the men have been disquiet these days. I know I don't feel any better myself, but wanted to hear how it is with the other men."),
    (try_end)],
    "{s5}", "freelancer_pacify_explain", 
    []],

  [anyone, "freelancer_pacify_explain", [
    (store_faction_of_troop, ":commander_faction", "$enlisted_lord"),
    (faction_get_slot, ":is_sarge", ":commander_faction", slot_faction_freelancer_captain),
    (try_begin),
      (eq, ":is_sarge", 2),
      (str_store_string, s5, "@Well, {sir/ma'am}. The men are not happy, that is true. There is just too much walking, too much fighting, but not enough feasting, not enough drinks, not enough fun! We are paid well, yes, but maybe we deserve a bit more. Respectfully, {sir/ma'am}."),
    (else_try),
      (eq, ":is_sarge", 1),
      (str_store_string, s5, "@Sarge, you know that we don't complain unless things are bad, right? Well, things do feel bad. Too much walking, and fighting, but there is not enough fun to be had! When we do stop by town, we don't have enough to enjoy ourselves."),
    (else_try),
      (str_store_string, s5, "@You are in the frontlines with us, don't you feel a bit down with all this walking and fighting? But not enough drinking, feasting, and fun? When you go to town, what do you do? I bet you don't do shit, cause you ain't got enough to do shit! Like all of us..."),
    (try_end)],
    "{s5}", "freelancer_pacify_attempt", 
    []],

#Pacify - Choices
  [anyone|plyr, "freelancer_pacify_attempt", [],
    "Perhaps I can change your mind... (Persuasion + Leadership Check)", "freelancer_pacify_persuade", 
    [(call_script, "script_freelancer_pacify_quest_persuade")]],

  [anyone, "freelancer_pacify_persuade", [
    (store_random_in_range, ":random", 0, 100),
    (le, ":random", reg0), #Success

    (store_faction_of_troop, ":commander_faction", "$enlisted_lord"),
    (faction_get_slot, ":is_sarge", ":commander_faction", slot_faction_freelancer_captain),
    (try_begin),
      (eq, ":is_sarge", 2),
      (str_store_string, s5, "@Well, {sir/ma'am}. You have a very good point, {sir/ma'm}. We shouldn't be complaining at all... Thank you for setting us straight."),
    (else_try),
      (eq, ":is_sarge", 1),
      (str_store_string, s5, "@Sarge, you really do know us better than we know ourselves. You are going to make the men cry! I'll make sure to tell the men what you said, and we'll straighten up, you'll see."),
    (else_try),
      (str_store_string, s5, "@You have a good point, {playername}. I don't know why you aren't being promoted yet. Anyways, I'll tell the men what you told me. Tell the commander that we'll march on."),
    (try_end)],
    "{s5}", "freelancer_pacify_persuade_success", 
    []],

  [anyone, "freelancer_pacify_persuade", [
    (store_random_in_range, ":random", 0, 100),
    (gt, ":random", reg0), #fail

    (store_faction_of_troop, ":commander_faction", "$enlisted_lord"),
    (faction_get_slot, ":is_sarge", ":commander_faction", slot_faction_freelancer_captain),
    (try_begin),
      (eq, ":is_sarge", 2),
      (str_store_string, s5, "@Captain, with all due respect, we do not agree with you. If anything, your attempt just made it worse."),
    (else_try),
      (eq, ":is_sarge", 1),
      (str_store_string, s5, "@What is this Sarge? I thought you knew us better! The men will start to think you are full of shit. This is pointless, just leave us be."),
    (else_try),
      (str_store_string, s5, "@What are you babbling on about? You know nothing about what we are going through, go away and leave us be."),
    (try_end)],
    "{s5}", "freelancer_pacify_persuade_fail", 
    []],

  [anyone|plyr, "freelancer_pacify_persuade_success", [], 
    "Good. I'll let the commander know.", "close_window", 
    [(call_script, "script_succeed_quest", "qst_freelancer_mission_2"),
     (party_get_morale, ":cur_morale", "$enlisted_party"),
     (store_sub, ":to_add", 60, ":cur_morale"), #Target Morale is 60 when we successfully persuade
     (call_script, "script_change_party_morale", "$enlisted_party", ":to_add"), 
     (display_message, "@The men are hearthened by your speech. (Morale Improved)", color_good_news)]],

  [anyone|plyr, "freelancer_pacify_persuade_fail", [], 
    "I am sorry that I cannot convince you. I'll let the commander know.", "close_window", 
    [(call_script, "script_fail_quest", "qst_freelancer_mission_2"),
     (party_get_morale, ":cur_morale", "$enlisted_party"),
     (call_script, "script_change_party_morale", "$enlisted_party", -10), #Failure leads to reduction of morale 
     (display_message, "@The men are dishearthened by your failed attempt. (Morale Worsened)", color_bad_news)]],


  [anyone|plyr, "freelancer_pacify_attempt", [], 
    "So, the men wants to have fun? They want a bit of entertainment? (Duel)", "freelancer_pacify_fight", 
    []],

  [anyone|plyr, "freelancer_pacify_fight", [], 
    "So, the men wants to have fun? They want a bit of entertainment? Well, we can give them a show right now. You and I have a friendly duel, and if I win, convince the men to stop their grumbling. If you win, well, I'll pay the men 15 crowns each. What do you say?", "freelancer_pacify_fight_ask", 
    []],

  [anyone, "freelancer_pacify_fight_ask", [], 
    "Sounds good. With weapons or fists?", "freelancer_pacify_fight_ask_weapons", 
    []],

  [anyone|plyr, "freelancer_pacify_fight_ask_weapons", [], 
    "Weapons.", "freelancer_pacify_fight_ask_weapons_choose_weapons", 
    []],

  [anyone|plyr, "freelancer_pacify_fight_ask_weapons", [], 
    "Fists.", "freelancer_pacify_fight_ask_weapons_choose_fists", 
    []],

  [anyone, "freelancer_pacify_fight_ask_weapons_choose_weapons", [], 
    "Let's begin then! En garde!", "close_window", 
    [ (assign, "$talk_context", tc_back_alley), #piggyback
      (jump_to_menu, "mnu_freelancer_pacify_duel")]],

  [anyone, "freelancer_pacify_fight_ask_weapons_choose_fists", [], 
    "Let's begin then! Put em up!", "close_window", 
    [ (assign, "$talk_context", tc_garden), #piggyback
      (jump_to_menu, "mnu_freelancer_pacify_duel")]],

  
  [anyone|plyr, "freelancer_pacify_duel_win", [], 
    "Definitely. Now that the fun is over, the men seems to be in better spirits. I'll let the commander know. Good fight.", "close_window", 
    [(call_script, "script_succeed_quest", "qst_freelancer_mission_2"),
     (party_get_morale, ":cur_morale", "$enlisted_party"),
     (store_sub, ":to_add", 50, ":cur_morale"), #Target Morale is 50 when we successfully win the duel
     (call_script, "script_change_party_morale", "$enlisted_party", ":to_add"), 
     (display_message, "@The men respects you more now, and was also entertained. (Morale Improved)", color_good_news)]],

  [anyone|plyr, "freelancer_pacify_duel_lose", [
     (party_get_num_companions, ":num_companions", "$enlisted_party"),
     (val_sub, ":num_companions", 2), #No player nor lord
     (store_mul, ":payoff", ":num_companions", 15),
     (store_troop_gold, ":gold", "trp_player"),
     (ge, ":gold", ":payoff")], 
    "Good fight... I am a man of my word. Here, distribute it to the men.", "close_window", 
    [(call_script, "script_succeed_quest", "qst_freelancer_mission_2"),
     (party_get_morale, ":cur_morale", "$enlisted_party"),
     (store_sub, ":to_add", 40, ":cur_morale"), #Target Morale is 40 when we lose the duel
     (call_script, "script_change_party_morale", "$enlisted_party", ":to_add"), 
     (display_message, "@The men thinks you are weak, but are happy to see you pay. (Morale Slightly Improved)", color_good_news),
     (party_get_num_companions, ":num_companions"),
     (val_sub, ":num_companions", 2), #no player nor lord
     (store_mul, ":payoff", ":num_companions", 15),
     (troop_remove_gold, "trp_player", ":payoff"),
     (assign, reg1, ":payoff"),
     (display_message, "@You paid {reg1} gold to the men.", color_bad_news),
    ]],

  [anyone|plyr, "freelancer_pacify_duel_lose", [
     (party_get_num_companions, ":num_companions", "$enlisted_party"),
     (val_sub, ":num_companions", 2), #No player nor lord
     (store_mul, ":payoff", ":num_companions", 15),
     (store_troop_gold, ":gold", "trp_player"),
     (lt, ":gold", ":payoff")], 
    "Good fight... I am a man of my word. But I do not have enough... here, take all that I have", "close_window", 
    [(call_script, "script_succeed_quest", "qst_freelancer_mission_2"),
     (party_get_morale, ":cur_morale", "$enlisted_party"),
     (store_sub, ":to_add", 37, ":cur_morale"), #Target Morale is 37 when we lose the duel AND can't pay
     (call_script, "script_change_party_morale", "$enlisted_party", ":to_add"), 
     (display_message, "@The men thinks you are weak, and disappointed that you cannot pay the full sum. (Morale Slightly Improved)", color_good_news),
     (store_troop_gold, ":gold"),
     (troop_remove_gold, "trp_player", ":gold"),
     (assign, reg1, ":gold"),
     (display_message, "@You paid {reg1} gold to the men.", color_bad_news),
    ]],

  [anyone|plyr, "freelancer_pacify_attempt", [(this_or_next|player_has_item, "itm_bier"), (player_has_item, "itm_ale")], 
    "Well, it so happens that I have some booze that we can all share. What do you say?", "freelancer_pacify_booze", 
    []],

  [anyone, "freelancer_pacify_booze", [], 
    "Now you are talking! Let the merry-making begin!", "close_window", 
    [(call_script, "script_succeed_quest", "qst_freelancer_mission_2"),
     (party_get_morale, ":cur_morale", "$enlisted_party"),
     (store_sub, ":to_add", 70, ":cur_morale"), #Target Morale is 70 when give them beer
     (call_script, "script_change_party_morale", "$enlisted_party", ":to_add"), 
     (display_message, "@You distribute the alcohol to the men and join the festivities. (Morale Greatly Improved)", color_good_news),
     (try_begin),
      (player_has_item, "itm_bier"),
      (troop_remove_item, "trp_player", "itm_bier"),
    (else_try),
      (player_has_item, "itm_ale"),
      (troop_remove_item, "trp_player", "itm_ale"),
    (try_end),
    (rest_for_hours, 5, 2, 1)]],

  [anyone|plyr, "freelancer_pacify_attempt", [], 
    "If crowns are what the men want, crowns are what I can offer. How much do you think the men want?", "freelancer_pacify_bribe", 
    []],

  [anyone, "freelancer_pacify_bribe", [
    (store_item_value, reg4, "itm_bier"),
    (party_get_num_companions, reg5, "$enlisted_party"),
    (val_sub, reg5, 2), #Do not count player & lord
    (store_mul, reg6, reg5, reg4), #Multiply Value of Beer with number of companions
    (val_div, reg6, 8),
    (val_min, reg6, 2000),
    (val_max, reg6, 1000),], 
    "Now we are talking, eh? Beer is expensive, at {reg4} for a few cases, and there are quite a lot of us men that would like to drink and enjoy ourselves. So we think {reg6} crowns should cover it and whatever extras we want.", "freelancer_pacify_bribe_ask", 
    []],

  [anyone|plyr, "freelancer_pacify_bribe_ask", [
    (store_troop_gold, ":gold", "trp_player"),
    (ge, ":gold", reg6),], 
    "I see... I have that amount. Here are your {reg6} crowns. Spend it wisely, and no more grumblings.", "freelancer_pacify_bribe_pay", 
    []],

  [anyone|plyr, "freelancer_pacify_bribe_ask", [
    (store_troop_gold, ":gold", "trp_player"),
    (lt, ":gold", reg6),], 
    "I see... I do not have enough money.", "freelancer_pacify_bribe_not_enough", 
    []],

  [anyone|plyr, "freelancer_pacify_bribe_ask", [
    (store_troop_gold, ":gold", "trp_player"),
    (store_skill_level, ":trade", skl_trade),
    (ge, ":trade", 1),
    (val_mul, ":trade", 100), 
    (val_sub, reg6, ":trade"),
    (ge, ":gold", reg6),
    ], 
    "I see... I do know a place where we can get your beer for cheaper. Here, for {reg6} crowns, you will get everything you need.", "freelancer_pacify_bribe_pay", 
    []],

  [anyone, "freelancer_pacify_bribe_pay", [], 
    "Great! Let us go buy it now and distribute it to the men. Once they are all drunk, there will be no more complaining. ", "close_window", 
    [
     (call_script, "script_succeed_quest", "qst_freelancer_mission_2"),
     (party_get_morale, ":cur_morale", "$enlisted_party"),
     (store_sub, ":to_add", 65, ":cur_morale"), #Target Morale is 65 when give them cash
     (call_script, "script_change_party_morale", "$enlisted_party", ":to_add"), 
     (display_message, "@You give the men {reg6} crowns and leave them to their festivities. (Morale Improved)", color_good_news),
     (troop_remove_gold, "trp_player", reg6),]],

  [anyone, "lord_start", [(check_quest_active, "qst_freelancer_mission_2"), (check_quest_succeeded, "qst_freelancer_mission_2")],
    "{playername}, It seems our men are of better spirits. I do not need to know what you did, just know that I am thankful.", "freelancer_pacify_success",
    []],
  
  [anyone|plyr, "freelancer_pacify_success", [],
    "The men just needed something to occupy their time. I will go back to my post.", "close_window",
    [(call_script, "script_finish_quest", "qst_freelancer_mission_2", 100)]],

  #Dialogue for Hunt Down Deserters
  
  [anyone, "freelancer_mission_start", [(eq, "$cheat_imposed_quest", "qst_freelancer_mission_1")],
    "{playername}, there has been a number of deserters in our ranks. In our nation, we do not tolerate cowards. Have them taste the steel they are so afraid of, make examples of them.", "freelancer_lord_mission_told_deserters",
    []],
  
  [anyone|plyr, "freelancer_lord_mission_told_deserters", [],
    "I do not tolerate cowards. I will hunt them down and end them.", "freelancer_lord_mission_deserters_accepted",
    []],
  
  [anyone|plyr, "freelancer_lord_mission_told_deserters", [],
    "I cannot accept this mission.", "freelancer_lord_mission_deserters_declined",
    []],
  
  [anyone, "freelancer_lord_mission_deserters_accepted", [],
    "Glad to hear it. Take some men with you, these deserters are not common bandits. I look forward to your report. They should be nearby, do not linger or else they will get away.", "close_window",[
      (call_script, "script_event_player_mission"),
      (call_script, "script_freelancer_start_deserter_quest"),
      (store_faction_of_troop, ":commander_faction", "$enlisted_lord"),
      (faction_get_slot, ":culture", ":commander_faction", slot_faction_culture),
      (faction_get_slot, ":tier_2_troop", ":culture", slot_faction_tier_2_troop),
      (faction_get_slot, ":tier_archer_troop", ":culture", slot_faction_tier_1_archer),
      (faction_get_slot, ":tier_3_troop", ":culture", slot_faction_tier_3_troop),
      (store_character_level, ":level", "trp_player"),
      
      (assign, ":troop_type", ":tier_2_troop"),
      (store_mul, ":troops", ":level", 2),
      (val_add, ":troops", 5),
      (store_div, ":no_archers", ":troops", 2),
      
      (try_begin),
        (le, ":level", 5),
        (assign, ":troop_type", ":tier_2_troop"),
      (else_try),
        (ge, ":level", 12),
        (assign, ":troop_type", ":tier_3_troop"),
      (try_end),
      
      (party_add_members, "p_main_party", ":troop_type", ":troops"),
      (party_add_members, "p_main_party", ":tier_archer_troop", ":no_archers"),
      
      (assign, "$g_leave_encounter", 1),
      
  ]],
  
  [anyone,"freelancer_lord_mission_deserters_declined", [], "Hm. I'm disappointed, {playername}. I might start thinking that you are a coward too. Go back to your post. I need to go and find somebody to hunt them down for us.", "close_window",
    []],
  
  [anyone,"lord_start", [
      (check_quest_active, "qst_freelancer_mission_1"),
      (check_quest_succeeded, "qst_freelancer_mission_1"),
    ],
    "I've heard from our scouts that you have defeated the party of deserters. The men will now think twice about running away from this war. Good job, {playername}. Go back to your post.", "lord_freelancer_deserters_thank",
    [(call_script, "script_finish_quest", "qst_freelancer_mission_1", 100),
      #removes troops from player party
      (party_get_num_companion_stacks, ":num_stacks", "p_main_party"),
      (try_for_range_backwards, ":cur_stack", 1, ":num_stacks"), #lower bound is 1 to ignore player character
        (party_stack_get_troop_id, ":cur_troops", "p_main_party", ":cur_stack"),
        (party_stack_get_size, ":cur_size", "p_main_party", ":cur_stack"),
        (party_remove_members, "p_main_party", ":cur_troops", ":cur_size"),
      (try_end),]],
  
  [anyone,"lord_start", [
      (check_quest_active, "qst_freelancer_mission_1"),
      (check_quest_failed, "qst_freelancer_mission_1"),
    ],
    "I've heard from our scouts that you have failed to defeat the party of deserters. Quite disappointing, it may even embolden other cowards to join them. Go back to your post, I'll send other men to hunt them down.", "lord_freelancer_deserters_fail",
    [(cancel_quest, "qst_freelancer_mission_1"),
      #removes troops from player party
      (party_get_num_companion_stacks, ":num_stacks", "p_main_party"),
      (try_for_range_backwards, ":cur_stack", 1, ":num_stacks"), #lower bound is 1 to ignore player character
        (party_stack_get_troop_id, ":cur_troops", "p_main_party", ":cur_stack"),
        (party_stack_get_size, ":cur_size", "p_main_party", ":cur_stack"),
        (party_remove_members, "p_main_party", ":cur_troops", ":cur_size"),
      (try_end),]],
  
  [anyone|plyr, "lord_freelancer_deserters_thank", [],
    "Cowardice is never an excuse for treason.", "lord_pretalk",[]],
  [anyone|plyr, "lord_freelancer_deserters_thank", [],
    "It was a difficult task, but it had to be done.", "lord_pretalk",[]],
  [anyone|plyr, "lord_freelancer_deserters_fail", [],
    "I will do better next time.", "lord_pretalk",[]],
  
  #Dialogue for Scout Waypoints
  
  [anyone, "freelancer_mission_start",
    [(eq, "$cheat_imposed_quest", "qst_scout_waypoints"),],
    "{playername}, I need a volunteer to scout the area. We're sorely lacking on information, " +
    "and I simply must have a better picture of the situation before we can proceed. " +
    "Do you want to accept this mission?", "freelancer_lord_mission_told_scout_waypoints",
    [
  ]],
  
  [anyone|plyr, "freelancer_lord_mission_told_scout_waypoints", [], "You've found your volunteer, sir.", "freelancer_lord_mission_told_scout_waypoints_accepted",[
      (store_faction_of_troop, ":commander_faction", "$enlisted_lord"),
      (faction_get_slot, ":freelancer_rank", ":commander_faction", slot_freelancer_rank),
      (try_begin),
        (le, ":freelancer_rank", 2),
        (assign, ":waypoints", 1),
      (else_try),
        (le, ":freelancer_rank", 4),
        (assign, ":waypoints", 2),
      (else_try),
        (assign, ":waypoints", 3),
      (try_end),
      (call_script, "script_freelancer_mission_scout_waypoints", ":waypoints")]],
  [anyone|plyr, "freelancer_lord_mission_told_scout_waypoints", [], "I cannot accept this mission.", "freelancer_lord_mission_told_scout_waypoints_rejected",[]],
  
  [anyone,"freelancer_lord_mission_told_scout_waypoints_accepted",
    [(store_faction_of_troop, ":commander_faction", "$enlisted_lord"),
      (faction_get_slot, ":freelancer_rank", ":commander_faction", slot_freelancer_rank),
      (try_begin),
        (le, ":freelancer_rank", 2),
        (str_store_string, s5, "@Simply pass near {s13}"),
      (else_try),
        (le, ":freelancer_rank", 4),
        (str_store_string, s5, "@Simply pass near {s13} and {s14}"),
      (else_try),
        (str_store_string, s5, "@Simply pass near {s13}, {s14}, and {s15}"),
      (try_end),],
    "Good {man/lass}! {s5} and check out what's there. Make a note of anything you find and return to me as soon as possible.", "close_window",
    [
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (store_faction_of_troop, ":commander_faction", "$enlisted_lord"),
      (faction_get_slot, ":freelancer_rank", ":commander_faction", slot_freelancer_rank),
      (str_clear, s7),
      (str_clear, s13),
      (str_clear, s14),
      (str_clear, s15),
      (try_begin),
        (le, ":freelancer_rank", 2),
        (str_store_party_name_link, s13, "$qst_scout_waypoints_wp_1"),
        (str_store_string, s7, "@{s13}"),
      (else_try),
        (le, ":freelancer_rank", 4),
        (str_store_party_name_link, s13, "$qst_scout_waypoints_wp_1"),
        (str_store_party_name_link, s14, "$qst_scout_waypoints_wp_2"),
        (str_store_string, s7, "@{s13} and {s14"),
      (else_try),
        (str_store_party_name_link, s13, "$qst_scout_waypoints_wp_1"),
        (str_store_party_name_link, s14, "$qst_scout_waypoints_wp_2"),
        (str_store_party_name_link, s15, "$qst_scout_waypoints_wp_3"),
        (str_store_string, s7, "@{s13}, {s14} and {s15}"),
      (try_end),
      (setup_quest_text, "$cheat_imposed_quest"),
      (str_store_string, s2, "@{s9} asked you to scout {s7}, then report back."),
      (call_script, "script_start_quest", "$cheat_imposed_quest", "$g_talk_troop"),
      (store_faction_of_troop, ":commander_faction", "$enlisted_lord"),
      #If player is a sarge or captain, remove his party - Kham
      (try_begin),
        (faction_get_slot, ":is_sarge", ":commander_faction", slot_faction_freelancer_captain), #is sarge / captain?
        (gt, ":is_sarge", 0),
        (call_script, "script_freelancer_remove_player_party"),
      (try_end),
      #End Removal of Player Party
      (call_script, "script_event_player_mission"), (call_script, "script_party_restore"),
      (assign, "$g_leave_encounter",1),
  ]],
  
  [anyone,"freelancer_lord_mission_told_scout_waypoints_rejected", [], "Hm. I'm disappointed, {playername}. Go back to your post. I need to go and find somebody to scout for us.", "close_window",
    []],
  
  
  #Dialogue for Freelancer Deliver Message
  [anyone,"freelancer_mission_start", [(eq, "$random_quest_no", "qst_deliver_message")],
    "I need to send a letter to {s13} who should be currently at {s4}. " +
    "If you will be heading towards there, would you deliver it to him? " +
    "The letter needs to be in his hands in 10 days.", "freelancer_mission_deliver_message",
    [
      (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (quest_set_slot, "$random_quest_no", slot_quest_expiration_days, 10),
      (quest_set_slot, "$random_quest_no", slot_quest_dont_give_again_period, 0),
      (str_store_troop_name_link,s9,"$g_talk_troop"),
      (str_store_troop_name_link,s13,":quest_target_troop"),
      (str_store_party_name_link,s4,":quest_target_center"),
      (setup_quest_text,"$random_quest_no"),
      (str_store_string, s2, "@{s9} asked you to take a message to {s13}. {s13} was believed to be at {s4} when you were given this quest."),
  ]],
  
  [anyone|plyr,"freelancer_mission_deliver_message", [], "Certainly, I intend to pass by {s4} and it would be no trouble.", "freelancer_mission_deliver_message_accepted",[]],
  
  [anyone,"freelancer_mission_deliver_message_accepted", [], "I appreciate it, {playername}. Here's the letter, " +
    "and a small sum to cover your travel expenses. Give my regards to {s13} when you see him.", "close_window",
    [(call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_troop_add_gold", "trp_player", 30),
      (store_faction_of_troop, ":commander_faction", "$enlisted_lord"),
      #If player is a sarge or captain, remove his party - Kham
      (try_begin),
        (faction_get_slot, ":is_sarge", ":commander_faction", slot_faction_freelancer_captain), #is sarge / captain?
        (gt, ":is_sarge", 0),
        (call_script, "script_freelancer_remove_player_party"),
      (try_end),
      #End Removal of Player Party
      (call_script, "script_event_player_mission"), (call_script, "script_party_restore"),
      (assign, "$g_leave_encounter",1),
  ]],
  
  [anyone|plyr,"freelancer_mission_deliver_message", [], "Apologies, I cannot do this mission. You'd best send it with someone else.", "freelancer_mission_deliver_message_rejected",[]],
  [anyone,"freelancer_mission_deliver_message_rejected", [], "That is too bad, {playername}. Go back to your post, then.", "close_window",[]],
  #Dialogue for Freelancer Deliver Message END
  
  #Dialogue for Freelancer Hunt Fugitive START
  
  #Hunt down fugitive
  [anyone,"freelancer_mission_start", [(eq,"$random_quest_no","qst_hunt_down_fugitive")],
    "I have something you could help with, an issue with the lawless villain known as {s4}. " +
    "He murdered one of my men and has been on the run from his judgment ever since. " +
    "I can't let him get away with avoiding justice, so I've put a bounty of 300 denars on his head. " +
    "Friends of the murdered man reckon that this assassin may have taken refuge with his kinsmen at {s3}. " +
    "You might be able to hunt him down and give him what he deserves, and claim the bounty for yourself.", "freelancer_mission_hunt_down_fugitive_told",
    [
      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (quest_get_slot, ":quest_target_dna", "$random_quest_no", slot_quest_target_dna),
      (quest_set_slot, "$random_quest_no", slot_quest_expiration_days, 10),
      (quest_set_slot, "$random_quest_no", slot_quest_dont_give_again_period, 0),
      (str_store_troop_name_link,s9, "$g_talk_troop"),
      (str_store_party_name_link,s3, ":quest_target_center"),
      (call_script, "script_get_name_from_dna_to_s50", ":quest_target_dna"),
      (str_store_string, s4, s50),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s9} asked you to hunt down a fugitive named {s4}. He is currently believed to be at {s3}."),
  ]],
  
  [anyone|plyr,"freelancer_mission_hunt_down_fugitive_told", [],
    "Then I will hunt him down and execute the law.", "freelancer_mission_hunt_down_fugitive_accepted",[]],
  
  [anyone|plyr,"freelancer_mission_hunt_down_fugitive_told", [], "Apologies, I cannot do this mission. You'd best send it with someone else.", "freelancer_mission_hunt_down_fugitive_rejected",[]],
  
  [anyone,"freelancer_mission_hunt_down_fugitive_accepted", [], "That's excellent, {playername}. " +
    "I will be grateful to you and so will the family of the man he murdered. " +
    "And of course the bounty on his head will be yours if you can get him. " +
    "Well, good hunting to you.", "close_window",
    [(call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",1),
      (store_faction_of_troop, ":commander_faction", "$enlisted_lord"),
      #If player is a sarge or captain, remove his party - Kham
      (try_begin),
        (faction_get_slot, ":is_sarge", ":commander_faction", slot_faction_freelancer_captain), #is sarge / captain?
        (gt, ":is_sarge", 0),
        (call_script, "script_freelancer_remove_player_party"),
      (try_end),
      #End Removal of Player Party
      (call_script, "script_event_player_mission"), (call_script, "script_party_restore"),
      (assign, "$g_leave_encounter",1),
  ]],
  
  [anyone,"freelancer_mission_hunt_down_fugitive_rejected", [], "As you wish, {playername}. " +
    "Go back to your post.", "close_window",
    []],
  
  
  ##Dialogue For Freelancer Outbound missions END - Kham
  
  #Error Handling
  [anyone,"freelancer_mission_start", [],
    "Nevermind... (This is an error)", "close_window",
    [
      (str_store_quest_name, s1, "$cheat_imposed_quest"),
      (display_message, "@Attempting to Trigger {s1}. Failed", color_bad_news),
  ]],
  
  
  [anyone ,"event_triggered", [(store_conversation_troop, "$g_talk_troop"),
      (try_begin),
        (is_between, "$g_talk_troop", companions_begin, companions_end),
        (talk_info_show, 1),
        (call_script, "script_setup_talk_info_companions"),
      (try_end),
      
      (troop_get_type, reg65, "$g_talk_troop"),
      (try_begin),
        (faction_slot_eq,"$g_talk_troop_faction",slot_faction_leader,"$g_talk_troop"),
        (str_store_string,s64,"@{reg65?my Lady:my Lord}"), #bug fix
        (str_store_string,s65,"@{reg65?my Lady:my Lord}"),
        (str_store_string,s66,"@{reg65?My Lady:My Lord}"),
      (else_try),
        (str_store_string,s64,"@{reg65?madame:sir}"), #bug fix
        (str_store_string,s65,"@{reg65?madame:sir}"),
        (str_store_string,s66,"@{reg65?Madame:Sir}"),
      (try_end),
      
      
      (eq, 1, 0)],
    "{!}Warning: This line is never displayed. It is just for storing conversation variables.", "close_window", []],
  
  [anyone, "event_triggered",
    [
      (eq, "$talk_context", tc_give_center_to_fief),
      
      (assign, ":there_are_vassals", 0),
      (assign, ":end_cond", active_npcs_end),
      (try_for_range, ":troop_no", active_npcs_begin, ":end_cond"),
        (troop_slot_eq, ":troop_no", slot_troop_occupation, slto_kingdom_hero),
        (neq, "trp_player", ":troop_no"),
        (store_troop_faction, ":faction_no", ":troop_no"),
        (eq, ":faction_no", "fac_player_supporters_faction"),
        (val_add, ":there_are_vassals", 1),
        (assign, ":end_cond", 0),
      (try_end),
      
      (try_begin),
        (gt, ":there_are_vassals", 0),
        (str_store_string, s2, "str_do_you_wish_to_award_it_to_one_of_your_vassals"),
      (else_try),
        (str_store_string, s2, "str_who_do_you_wish_to_give_it_to"),
      (try_end),
      
      (str_store_party_name, s1, "$g_center_taken_by_player_faction"),
      (str_store_string, s5, "str_sire_my_lady_we_have_taken_s1_s2"),
    ],
    "{!}{s5}", "award_fief_to_vassal",
    []],
  
  [anyone|plyr, "award_fief_to_vassal",
    [
      (is_between, "$g_player_court", centers_begin, centers_end),
      (store_faction_of_party, ":player_court_faction", "$g_player_court"),
      (eq, ":player_court_faction", "fac_player_supporters_faction"),
    ],
    "I wish to defer the appointment of a lord, until I take the counsel of my subjects", "award_fief_to_vassal_defer",
    [
  ]],
  
  [anyone, "award_fief_to_vassal_defer",
    [
    ],
    "As you wish, {sire/my lady}. You may decide this matter at a later date.", "close_window",
    [
      (try_begin),
        (faction_slot_eq, "$players_kingdom", slot_faction_political_issue, -1),
        (faction_set_slot, "$players_kingdom", slot_faction_political_issue, "$g_center_taken_by_player_faction"),
      (try_end),
      (call_script, "script_give_center_to_lord", "$g_center_taken_by_player_faction", -1, 0), #-1 for the faction lord in this script is used exclusively in this context
      #It is only used because script_give_center_to_faction does not reset the town lord if fac_player_supporters_faction is the attacker
      
      (assign, "$g_center_taken_by_player_faction", -1),
      
      #new start
      (try_begin),
        (eq, "$g_next_menu", "mnu_castle_taken"),
        (jump_to_menu, "$g_next_menu"),
      (try_end),
      #new end
      
  ]],
  
  
  
  [anyone|plyr|repeat_for_troops,"award_fief_to_vassal",
    [
      (store_repeat_object, ":troop_no"),
      (troop_slot_eq, ":troop_no", slot_troop_occupation, slto_kingdom_hero),
      (neq, "trp_player", ":troop_no"),
      (store_troop_faction, ":faction_no", ":troop_no"),
      (eq, ":faction_no", "fac_player_supporters_faction"),
      (str_store_troop_name, s11, ":troop_no"),
      (call_script, "script_print_troop_owned_centers_in_numbers_to_s0", ":troop_no"),
      
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", slot_lord_recruitment_argument, argument_benefit),
        (str_store_string, s12, "str__promised_fief"),
      (else_try),
        (str_clear, s12),
      (try_end),
      
      (try_begin),
        (eq, reg0, 0),
        (str_store_string, s1, "str_no_fiefss12"),
      (else_try),
        (str_store_string, s1, "str_fiefs_s0s12"),
      (try_end),
    ],
    "{!}{s11} {s1}.", "award_fief_to_vassal_2",[(store_repeat_object, "$temp")]],
  
  [anyone|plyr, "award_fief_to_vassal",
    [
      (call_script, "script_print_troop_owned_centers_in_numbers_to_s0", "trp_player"),
      (str_store_party_name, s1, "$g_center_taken_by_player_faction"),
      
      (try_begin),
        (is_between, "$g_talk_troop", pretenders_begin, pretenders_end),
        (str_store_string, s12, "str_please_s65_"),
      (else_try),
        (str_clear, s12),
      (try_end),
      
      (assign, ":there_are_vassals", 0),
      (assign, ":end_cond", active_npcs_end),
      (try_for_range, ":troop_no", active_npcs_begin, ":end_cond"),
        (troop_slot_eq, ":troop_no", slot_troop_occupation, slto_kingdom_hero),
        (neq, "trp_player", ":troop_no"),
        (store_troop_faction, ":faction_no", ":troop_no"),
        (eq, ":faction_no", "fac_player_supporters_faction"),
        (val_add, ":there_are_vassals", 1),
        (assign, ":end_cond", 0),
      (try_end),
      
      (try_begin),
        (gt, ":there_are_vassals", 0),
        (str_store_string, s2, "str_fiefs_s0"),
      (else_try),
        (str_clear, s2),
      (try_end),
      
      (str_store_string, s5, "str_s12i_want_to_have_s1_for_myself"),
    ],
    "{!}{s5}", "award_fief_to_vassal_2",
    [
      (assign, "$temp", "trp_player"),
  ]],
  
  [anyone, "award_fief_to_vassal_2",
    [
    ],
    "As you wish, {sire/my lady}. {reg6?I:{reg7?You:{s11}}} will be the new {reg3?lady:lord} of {s1}.", "close_window",
    [
      (assign, ":new_owner", "$temp"),
      
      (call_script, "script_give_center_to_lord", "$g_center_taken_by_player_faction", ":new_owner", 0),
      (try_begin),
        (faction_slot_eq, "$players_kingdom", slot_faction_political_issue, "$g_center_taken_by_player_faction"),
        (faction_set_slot, "$players_kingdom", slot_faction_political_issue, -1),
      (try_end),
      
      (assign, reg6, 0),
      (assign, reg7, 0),
      (try_begin),
        (eq, ":new_owner", "$g_talk_troop"),
        (assign, reg6, 1),
      (else_try),
        (eq, ":new_owner", "trp_player"),
        (assign, reg7, 1),
      (else_try),
        (str_store_troop_name, s11, ":new_owner"),
      (try_end),
      (str_store_party_name, s1, "$g_center_taken_by_player_faction"),
      (troop_get_type, reg3, ":new_owner"),
      
      (assign, "$g_center_taken_by_player_faction", -1),
      
      #new start
      (try_begin),
        (eq, "$g_next_menu", "mnu_castle_taken"),
        (jump_to_menu, "$g_next_menu"),
      (try_end),
      #new end
  ]],
  
  # Awarding fiefs in rebellion...
  
  [anyone, "event_triggered",
    [
      (faction_slot_eq, "fac_player_supporters_faction", slot_faction_leader, "$g_talk_troop"),
      (ge, "$g_center_taken_by_player_faction", 0),
      (str_store_party_name, s1, "$g_center_taken_by_player_faction"),
    ],
    "{s1} is not being managed by anyone. Whom shall I put in charge?", "center_captured_rebellion",
    []],
  
  [anyone|plyr|repeat_for_troops, "center_captured_rebellion",
    [
      (store_repeat_object, ":troop_no"),
      (troop_slot_eq, ":troop_no", slot_troop_occupation, slto_kingdom_hero),
      (neq, "$g_talk_troop", ":troop_no"),
      (neq, "trp_player", ":troop_no"),
      (store_troop_faction, ":faction_no", ":troop_no"),
      (eq, ":faction_no", "fac_player_supporters_faction"),
      (str_store_troop_name, s11, ":troop_no"),
      (call_script, "script_print_troop_owned_centers_in_numbers_to_s0", ":troop_no"),
      (try_begin),
        (eq, reg0, 0),
        (str_store_string, s1, "@(no fiefs)"),
      (else_try),
        (str_store_string, s1, "@(fiefs: {s0})"),
      (try_end),
    ],
    "{s11}. {s1}", "center_captured_rebellion_2",
    [
      (store_repeat_object, "$temp"),
  ]],
  
  [anyone|plyr, "center_captured_rebellion",
    [
      (call_script, "script_print_troop_owned_centers_in_numbers_to_s0", "trp_player"),
      (str_store_party_name, s1, "$g_center_taken_by_player_faction"),
    ],
    "Please {s65}, I want to have {s1} for myself. (fiefs: {s0})", "center_captured_rebellion_2",
    [
      (assign, "$temp", "trp_player"),
  ]],
  
  [anyone|plyr, "center_captured_rebellion",
    [
      (call_script, "script_print_troop_owned_centers_in_numbers_to_s0", "$g_talk_troop"),
      (str_store_party_name, s1, "$g_center_taken_by_player_faction"),
    ],
    "{s66}, you should have {s1} for yourself. (fiefs: {s0})", "center_captured_rebellion_2",
    [
      (assign, "$temp", "$g_talk_troop"),
  ]],
  
  [anyone, "center_captured_rebellion_2",
    [
      #     (faction_slot_eq, "fac_player_supporters_faction", slot_faction_leader, "$g_talk_troop"),
      #     (ge, "$g_center_taken_by_player_faction", 0),
    ],
    "Hmmm. All right, {playername}. I value your counsel highly. {reg6?I:{reg7?You:{s11}}} will be the new {reg3?lady:lord} of {s1}.", "close_window",
    [
      (assign, ":new_owner", "$temp"),
      (call_script, "script_calculate_troop_score_for_center", ":new_owner", "$g_center_taken_by_player_faction"),
      (assign, ":new_owner_score", reg0),
      (assign, ":total_negative_effect"),
      (try_for_range, ":cur_troop", active_npcs_begin, active_npcs_end),
        (troop_slot_eq, ":cur_troop", slot_troop_occupation, slto_kingdom_hero),
        (store_troop_faction, ":cur_faction", ":cur_troop"),
        (eq, ":cur_faction", "fac_player_supporters_faction"),
        (neq, ":cur_troop", ":new_owner"),
        (neg|troop_slot_eq, ":cur_troop", slot_troop_stance_on_faction_issue, ":new_owner"),
        (call_script, "script_troop_get_relation_with_troop", ":cur_troop", ":new_owner"),
        (lt, reg0, 25),
        
        
        (call_script, "script_calculate_troop_score_for_center", ":cur_troop", "$g_center_taken_by_player_faction"),
        (assign, ":cur_troop_score", reg0),
        (gt, ":cur_troop_score", ":new_owner_score"),
        (store_sub, ":difference", ":cur_troop_score", ":new_owner_score"),
        (store_random_in_range, ":random_dif", 0, ":difference"),
        (val_div, ":random_dif", 1000),
        (gt, ":random_dif", 0),
        (val_add, ":total_negative_effect", ":random_dif"),
        (val_mul, ":random_dif", -1),
        (call_script, "script_change_player_relation_with_troop", ":cur_troop", ":random_dif"),
      (try_end),
      (val_mul, ":total_negative_effect", 2),
      (val_div, ":total_negative_effect", 3),
      (val_add, ":total_negative_effect", 5),
      (try_begin),
        (neq, ":new_owner", "trp_player"),
        (val_min, ":total_negative_effect", 30),
        (call_script, "script_change_player_relation_with_troop", ":new_owner", ":total_negative_effect"),
      (try_end),
      
      (call_script, "script_give_center_to_lord", "$g_center_taken_by_player_faction", ":new_owner", 0),
      (try_begin),
        (faction_slot_eq, "$players_kingdom", slot_faction_political_issue, "$g_center_taken_by_player_faction"),
        (faction_set_slot, "$players_kingdom", slot_faction_political_issue, -1),
      (try_end),
      
      (assign, reg6, 0),
      (assign, reg7, 0),
      (try_begin),
        (eq, ":new_owner", "$g_talk_troop"),
        (assign, reg6, 1),
      (else_try),
        (eq, ":new_owner", "trp_player"),
        (assign, reg7, 1),
      (else_try),
        (str_store_troop_name, s11, ":new_owner"),
      (try_end),
      (str_store_party_name, s1, "$g_center_taken_by_player_faction"),
      (troop_get_type, reg3, ":new_owner"),
      
      (assign, "$g_center_taken_by_player_faction", -1),
      
      #new start
      (try_begin),
        (eq, "$g_next_menu", "mnu_castle_taken"),
        (jump_to_menu, "$g_next_menu"),
      (try_end),
      #new end
  ]],
  
  #TUTORIAL START
  [anyone, "start",
    [
      (is_between, "$g_talk_troop", tutorial_fighters_begin, tutorial_fighters_end),
      (eq, "$g_tutorial_training_ground_conversation_state", 0),
      (eq, "$g_tutorial_fighter_talk_before", 0)],
    "Hello there. We are polishing off our combat skills here with a bit of sparring practice. " +
    "You look like you could use a bit of training. Why don't you join us, and we can show you a few tricks. " +
    "And if you need explanation of any combat concepts, just ask, and I will do my best to fill you in.", "fighter_talk",
    [
      (try_begin),
        (eq, "$g_tutorial_training_ground_intro_message_being_displayed", 1),
        (assign, "$g_tutorial_training_ground_intro_message_being_displayed", 0),
        (tutorial_message, -1), #remove tutorial intro immediately before a conversation
      (try_end),
      (assign, "$g_tutorial_fighter_talk_before", 1)]],
  
  [anyone, "start",
    [(is_between, "$g_talk_troop", tutorial_fighters_begin, tutorial_fighters_end),
      (eq, "$g_tutorial_training_ground_conversation_state", 0)],
    "What do you want to practice?", "fighter_talk", []],
  
  [anyone, "fighter_pretalk", [],
    "Tell me what kind of practice you want.", "fighter_talk", []],
  
  [anyone|plyr, "fighter_talk",
    [],
    "I want to practice attacking.", "fighter_talk_train_attack", []],
  
  [anyone|plyr, "fighter_talk",
    [],
    "I want to practice blocking with my weapon.", "fighter_talk_train_parry", []],
  
  [anyone|plyr, "fighter_talk",
    [],
    "Let's do some sparring practice.", "fighter_talk_train_combat", []],
  
  [anyone|plyr, "fighter_talk",
    [(eq,1,0)],
    "{!}TODO: Let's train chamber blocking.", "fighter_talk_train_chamber", []],
  
  [anyone|plyr, "fighter_talk",
    [],
    "[Leave]", "close_window", []],
  
  [anyone, "fighter_talk_train_attack",
    [
      (get_player_agent_no, ":player_agent"),
      (agent_has_item_equipped, ":player_agent", "itm_practice_sword"), #TODO: add other melee weapons
    ],
    "All right. There are four principle directions for attacking. These are overhead swing, right swing, left swing and thrust. " +
    "Now, I will tell you which direction to attack from and you must try to do the correct attack. " +
    "^^(Move your mouse while you press the left mouse button to specify attack direction. For example, to execute an overhead attack, move the mouse up at the instant you press the left mouse button. " +
    "The icons on your screen will help you do the correct action.)" , "fighter_talk_train_attack_2",
    []],
  
  [anyone|plyr, "fighter_talk_train_attack_2",  [],
    "Let's begin then. I am ready.", "close_window",
    [
      (assign, "$g_tutorial_training_ground_melee_trainer_attack", "$g_talk_troop"),
      (assign, "$g_tutorial_training_ground_melee_state", 0),
      (assign, "$g_tutorial_training_ground_melee_trainer_action_state", 0),
      (assign, "$g_tutorial_training_ground_current_score", 0),
      (assign, "$g_tutorial_training_ground_current_score_2", 0),
      (assign, "$g_tutorial_update_mouse_presentation", 0),
  ]],
  
  [anyone|plyr, "fighter_talk_train_attack_2",  [],
    "Actually I want to do something else.", "fighter_pretalk", []],
  
  [anyone, "fighter_talk_train_attack",
    [(str_store_string, s3, "str_tutorial_training_ground_warning_no_weapon")],
    "{!}{s3}", "close_window",
    []],
  
  [anyone, "fighter_talk_train_parry",
    [
      (get_player_agent_no, ":player_agent"),
      (agent_has_item_equipped, ":player_agent", "itm_practice_sword"), #TODO: add other melee weapons
    ],
    "Unlike a shield, blocking with a weapon can only stop attacks coming from one direction. " +
    "For example if you block up, you'll deflect overhead attacks, but you can still be hit by side swings or thrust attacks. " +
    "^^(You must press and hold down the right mouse button to block.)", "fighter_talk_train_parry_2", [ ]],
  
  [anyone, "fighter_talk_train_parry_2", [],
    "I'll now attack you with different types of strokes, and I will wait until you do the correct block before attacking. " +
    "Try to do the correct block as soon as you can. " +
    "^^(This practice is easy to do with the 'automatic block direction' setting which is the default. " +
      "If you go to the Options menu and change defend direction control to 'mouse movement' or 'keyboard', you'll need to manually choose block direction. This is much more challenging, but makes the game much more interesting. " +
    "This practice can be very useful if you use manual blocking.)", "fighter_talk_train_parry_3",
    []],
  
  [anyone|plyr, "fighter_talk_train_parry_3",  [],
    "Let's begin then. I am ready.", "close_window",
    [
      (assign, "$g_tutorial_training_ground_melee_trainer_parry", "$g_talk_troop"),
      (assign, "$g_tutorial_training_ground_melee_state", 0),
      (assign, "$g_tutorial_training_ground_melee_trainer_action_state", 0),
      (assign, "$g_tutorial_training_ground_current_score", 0),
  ]],
  
  [anyone|plyr, "fighter_talk_train_parry_3",  [],
    "Actually I want to do something else.", "fighter_pretalk", []],
  
  
  
  [anyone, "fighter_talk_train_parry",
    [(str_store_string, s3, "str_tutorial_training_ground_warning_no_weapon")],
    "{!}{s3}", "close_window",
    []],
  
  [anyone, "fighter_talk_train_chamber",
    [
      (get_player_agent_no, ":player_agent"),
      (agent_has_item_equipped, ":player_agent", "itm_practice_sword"), #TODO: add other melee weapons
    ],
    "{!}TODO: OK.", "close_window",
    [
      (assign, "$g_tutorial_training_ground_melee_trainer_chamber", "$g_talk_troop"),
      (assign, "$g_tutorial_training_ground_melee_state", 0),
      (assign, "$g_tutorial_training_ground_melee_trainer_action_state", 0),
      (assign, "$g_tutorial_training_ground_current_score", 0),
  ]],
  
  [anyone, "fighter_talk_train_chamber",
    [(str_store_string, s3, "str_tutorial_training_ground_warning_no_weapon")],
    "{!}{s3}", "close_window",
    []],
  
  [anyone, "fighter_talk_train_combat",
    [
      (get_player_agent_no, ":player_agent"),
      (agent_has_item_equipped, ":player_agent", "itm_practice_sword"), #TODO: add other melee weapons
    ],
    "Sparring is an excellent way to prepare for actual combat. " +
    "We'll fight each other with non-lethal weapons now, until one of us falls to the ground. " +
    "You can get some bruises of course, but better that than being cut down in the real thing.", "fighter_talk_train_combat_2",
    []],
  
  [anyone|plyr, "fighter_talk_train_combat_2",  [],
    "Let's begin then. I am ready.", "close_window", [
      (assign, "$g_tutorial_training_ground_melee_trainer_combat", "$g_talk_troop"),
      (assign, "$g_tutorial_training_ground_melee_state", 0),
      (assign, "$g_tutorial_training_ground_melee_trainer_action_state", 0),
  ]],
  
  [anyone|plyr, "fighter_talk_train_combat_2",  [],
    "Actually I want to do something else.", "fighter_pretalk", []],
  
  [anyone, "fighter_talk_train_combat",
    [(str_store_string, s3, "str_tutorial_training_ground_warning_no_weapon")],
    "{!}{s3}", "close_window",
    []],
  
  [anyone, "start",
    [(is_between, "$g_talk_troop", tutorial_fighters_begin, tutorial_fighters_end),
      (eq, "$g_tutorial_training_ground_conversation_state", 1)], #parry complete
    "Good. You were able to block my attacks successfully. You may repeat this practice and try to get faster each time, until you are confident of your defense skills. Do you want to have another go?", "fighter_parry_try_again",
    [
      (assign, "$g_tutorial_training_ground_conversation_state", 0),
  ]],
  
  [anyone, "start",
    [(is_between, "$g_talk_troop", tutorial_fighters_begin, tutorial_fighters_end),
      (eq, "$g_tutorial_training_ground_conversation_state", 2)], #player knocked down in parry
    "Well that didn't go too well, did it? (Remember, you must press and hold down the right mouse button to keep your block effective.) Do you want to try again?", "fighter_parry_try_again",
    [
      (assign, "$g_tutorial_training_ground_conversation_state", 0),
  ]],
  
  [anyone|plyr, "fighter_parry_try_again",
    [],
    "Yes. Let's try again.", "fighter_talk_train_parry", []],
  
  [anyone|plyr, "fighter_parry_try_again",
    [],
    "No, I think I am done for now.", "fighter_talk_leave_parry", []],
  
  [anyone, "start",
    [(is_between, "$g_talk_troop", tutorial_fighters_begin, tutorial_fighters_end),
      (eq, "$g_tutorial_training_ground_conversation_state", 3)], #trainer knocked down in parry
    "Hey! We are doing a blocking practice, mate! You are supposed to block my attacks, not attack me back.", "fighter_parry_warn",
    [
      (assign, "$g_tutorial_training_ground_conversation_state", 0),
  ]],
  
  [anyone|plyr, "fighter_parry_warn",
    [],
    "I am sorry. Let's try once again.", "fighter_talk_train_parry", []],
  
  [anyone|plyr, "fighter_parry_warn",
    [],
    "Sorry. I must leave this practice now.", "fighter_talk_leave_parry", []],
  
  [anyone, "fighter_talk_leave_parry",
    [],
    "All right. As you wish.", "close_window", []],
  
  [anyone, "start",
    [(is_between, "$g_talk_troop", tutorial_fighters_begin, tutorial_fighters_end),
      (eq, "$g_tutorial_training_ground_conversation_state", 4)], #player knocked down in combat
    "Well that didn't go too well, did it?  Don't feel bad, and try not to do same mistakes next time. Do you want to have a go again?", "fighter_combat_try_again",
    [
      (assign, "$g_tutorial_training_ground_conversation_state", 0),
  ]],
  
  [anyone|plyr, "fighter_combat_try_again",
    [],
    "Yes. Let's do another round.", "fighter_talk_train_combat", []],
  
  [anyone|plyr, "fighter_combat_try_again",
    [],
    "No. That was enough for me.", "fighter_talk_leave_combat", []],
  
  [anyone, "fighter_talk_leave_combat",
    [],
    "Well, all right. Talk to me again if you change your mind.", "close_window", []],
  
  [anyone, "start",
    [(is_between, "$g_talk_troop", tutorial_fighters_begin, tutorial_fighters_end),
      (eq, "$g_tutorial_training_ground_conversation_state", 5)], #trainer knocked down in combat
    "Hey, that was good sparring. You defeated me, but next time I'll be more careful. Do you want to have a go again?", "fighter_combat_try_again",
    [
      (assign, "$g_tutorial_training_ground_conversation_state", 0),
  ]],
  
  # [anyone, "start",
  # [(is_between, "$g_talk_troop", tutorial_fighters_begin, tutorial_fighters_end),
  # (eq, "$g_tutorial_training_ground_conversation_state", 6)], #chamber complete
  # "{!}TODO: Congratulations. Anything else?", "fighter_talk",
  # [
  # (assign, "$g_tutorial_training_ground_conversation_state", 0),
  # ]],
  
  # [anyone, "start",
  # [(is_between, "$g_talk_troop", tutorial_fighters_begin, tutorial_fighters_end),
  # (eq, "$g_tutorial_training_ground_conversation_state", 7)], #player knocked down in chamber
  # "{!}TODO: Want to try again?", "fighter_chamber_try_again",
  # [
  # (assign, "$g_tutorial_training_ground_conversation_state", 0),
  # ]],
  
  # [anyone|plyr, "fighter_chamber_try_again",
  # [],
  # "{!}TODO: OK let's try again.", "fighter_talk_train_chamber", []],
  
  # [anyone|plyr, "fighter_chamber_try_again",
  # [],
  # "TODO: No, let's leave it there.", "fighter_talk_leave_chamber", []],
  
  # [anyone, "fighter_talk_leave_chamber",
  # [],
  # "{!}TODO: OK. Bye.", "close_window", []],
  
  [anyone, "start",
    [(is_between, "$g_talk_troop", tutorial_fighters_begin, tutorial_fighters_end),
      (eq, "$g_tutorial_training_ground_conversation_state", 8)], #trainer knocked down in chamber
    "{!}TODO: What are you doing? Don't attack me except while chambering!", "fighter_chamber_warn",
    [
      (assign, "$g_tutorial_training_ground_conversation_state", 0),
  ]],
  
  [anyone, "start",
    [(is_between, "$g_talk_troop", tutorial_fighters_begin, tutorial_fighters_end),
      (eq, "$g_tutorial_training_ground_conversation_state", 9)], #attack complete
    "Very good. You have learned how to attack from any direction you want. If you like we can try this again or move to a different exercise.", "fighter_talk",
    [
      (assign, "$g_tutorial_training_ground_conversation_state", 0),
  ]],
  
  
  [anyone|plyr, "fighter_chamber_warn",
    [],
    "{!}TODO: Sorry, let's try once again.", "fighter_talk_train_chamber", []],
  
  [anyone|plyr, "fighter_chamber_warn",
    [],
    "{!}TODO: Sorry. I want to leave the exercise.", "fighter_talk_leave_chamber", []],
  
  [trp_tutorial_archer_1|auto_proceed, "start",
    [],
    "{!}.", "tutorial_troop_default",
    []],
  
  [trp_tutorial_master_archer, "start",
    [
      (eq, "$g_tutorial_training_ground_archer_trainer_completed_chapters", 1),
    ],
    "Not bad. Not bad at all! You seem to have grasped the basics of archery. Now, try to do the same thing with a crossbow. " +
    "Take the crossbow and the bolts over there and shoot those three targets. The crossbow is much easier to shoot with compared with the bow, " +
    "but you need to reload it after each shot.", "archer_challenge_2", []],
  
  [trp_tutorial_master_archer, "start",
    [
      (eq, "$g_tutorial_training_ground_archer_trainer_completed_chapters", 2),
    ],
    "Good. You didn't have too much difficulty using the crossbow either. Next you will learn to use throwing weapons. " +
    "Pick up the javelins you see over there and try to hit those three targets. ",
    "archer_challenge_2", []],
  
  [trp_tutorial_master_archer, "start",
    [
      (eq, "$g_tutorial_training_ground_archer_trainer_completed_chapters", 3),
    ],
    "Well, with that you have recevied the basic skills to use all three types of ranged weapons. The rest will come with practice. Train each and every day, and in time you will be as good as the best marksmen in whole length and breadth of jolly old England.",
    "ranged_end", []],
  
  [trp_tutorial_master_archer, "ranged_end", [],
    "Now, you can go talk with the melee fighters or the horsemanship trainer if you haven't already done so. They can teach you important skills too.",
    "close_window", []],
  
  [trp_tutorial_master_archer, "start",
    [
      (try_begin),
        (eq, "$g_tutorial_training_ground_intro_message_being_displayed", 1),
        (assign, "$g_tutorial_training_ground_intro_message_being_displayed", 0),
        (tutorial_message, -1), #remove tutorial intro immediately before a conversation
      (try_end),
      
    ],
    "Good day to you, young fellow. I spend my days teaching about ranged weapons to anyone that is willing to learn. " +
    "If you need a tutor, let me know and I'll teach you how to use the bow, the crossbow and the javelin.", "archer_talk",
    []],
  
  [anyone|plyr, "archer_talk",
    [
      (eq, "$g_tutorial_training_ground_archer_trainer_completed_chapters", 0),
    ],
    "Yes, show me how to use ranged weapons.", "archer_challenge", []],
  
  # [anyone|plyr, "archer_talk",
  # [
  # (gt, "$g_tutorial_training_ground_archer_trainer_completed_chapters", 0),
  # ],
  # "{!}TODO: I want to move to the next stage.", "archer_challenge", []],
  
  [anyone|plyr, "archer_talk",
    [],
    "No, not now.", "close_window", []],
  
  [trp_tutorial_master_archer, "archer_challenge",
    [
      (eq, "$g_tutorial_training_ground_archer_trainer_completed_chapters", 0),
    ],
    "All right. Your first training will be in bowmanship. The bow is a difficult weapon to master. But once you are sufficiently good at it, you can shoot quickly and with great power. " +
    "Go pick up the bow and arrows you see over there now and shoot those targets.", "archer_challenge_2",
    []],
  
  # [trp_tutorial_master_archer, "archer_challenge",
  # [
  # (eq, "$g_tutorial_training_ground_archer_trainer_completed_chapters", 1),
  # ],
  # "{!}TODO: Make 3 shots with crossbow.", "archer_challenge_2",
  # []],
  
  # [trp_tutorial_master_archer, "archer_challenge",
  # [],
  # "{!}TODO: Make 3 shots with javelin.", "archer_challenge_2",
  # []],
  
  [anyone|plyr, "archer_challenge_2",
    [],
    "All right. I am ready.", "close_window",
    [
      (assign, "$g_tutorial_training_ground_archer_trainer_state", 1),
      (try_begin),
        (eq, "$g_tutorial_training_ground_archer_trainer_completed_chapters", 0),
        (assign, "$g_tutorial_training_ground_archer_trainer_item_1", "itm_practice_bow"),
        (assign, "$g_tutorial_training_ground_archer_trainer_item_2", "itm_practice_arrows"),
      (else_try),
        (eq, "$g_tutorial_training_ground_archer_trainer_completed_chapters", 1),
        (assign, "$g_tutorial_training_ground_archer_trainer_item_1", "itm_practice_crossbow"),
        (assign, "$g_tutorial_training_ground_archer_trainer_item_2", "itm_practice_bolts"),
      (else_try),
        (assign, "$g_tutorial_training_ground_archer_trainer_item_1", "itm_practice_javelin"),
        (assign, "$g_tutorial_training_ground_archer_trainer_item_2", -1),
      (try_end),
  ]],
  
  [anyone|plyr, "archer_challenge_2",
    [],
    "Just a minute. I want to do something else first.", "close_window",
    []],
  
  
  [trp_tutorial_master_horseman, "start",
    [
      (eq, "$g_tutorial_training_ground_horseman_trainer_completed_chapters", 1),
    ],
    "I hope you enjoyed the ride. Now we move on to something a bit more difficult. Grab the lance you see over there and ride around the course hitting each target at least once.",
    "horseman_melee_challenge_2", []],
  
  [trp_tutorial_master_horseman, "start",
    [
      (eq, "$g_tutorial_training_ground_horseman_trainer_completed_chapters", 2),
    ],
    "Good! You have been able to hit all targets on horseback. That's no easy feat for a starter. Your next challange will be using a bow and arrows to shoot at the archery targets by the road. You need to put an arrow to each target to consider yourself successful.",
    "horseman_melee_challenge_2", []],
  
  [trp_tutorial_master_horseman, "start",
    [
      (eq, "$g_tutorial_training_ground_horseman_trainer_completed_chapters", 3),
    ],
    "Very good. You were able to shoot all targets from horseback. Keep riding and practicing each day and in time you will be an expert horseman.", "horsemanship_end",
    [
  ]],
  
  [trp_tutorial_master_horseman, "horsemanship_end",
    [
    ],
    "Now, you can go talk with the melee fighters or the archery trainer if you haven't already done so. You need to learn everything you can to be prepared when you have to defend yourself.", "close_window",
    []],
  
  
  
  [trp_tutorial_master_horseman, "start",
    [
      (try_begin),
        (eq, "$g_tutorial_training_ground_intro_message_being_displayed", 1),
        (assign, "$g_tutorial_training_ground_intro_message_being_displayed", 0),
        (tutorial_message, -1), #remove tutorial intro immediately before a conversation
      (try_end),
    ],
    "Good day! I have come here for some riding practice, but my old bones are aching badly so I decided to give myself a rest today. " +
    "If you would like to practice your horsemanship, you can take my horse here. The exercise would be good for her.", "horseman_talk",
    []],
  
  [anyone|plyr, "horseman_talk",
    [],
    "Yes, I would like to practice riding.", "horseman_challenge", []],
  
  [anyone|plyr, "horseman_talk",
    [],
    "Uhm. Maybe later.", "close_window", []],
  
  # [trp_tutorial_master_horseman, "horseman_challenge",
  # [
  # (eq, "$g_tutorial_training_ground_player_continue_without_basics", 0),
  # (this_or_next|eq, "$g_tutorial_training_ground_melee_trainer_attack_completed", 0),
  # (eq, "$g_tutorial_training_ground_archer_trainer_completed_chapters", 0),
  # ],
  # "Hmm. Do you know how to use your weapons? You'd better learn to use those on foot before you start to train using them on horseback.", "horseman_ask",
  # []],
  
  # [anyone|plyr, "horseman_ask",
  # [],
  # "Yes, I know ", "horseman_challenge",
  # [
  # (assign, "$g_tutorial_training_ground_player_continue_without_basics", 1),
  # ]],
  
  # [anyone|plyr, "horseman_ask",
  # [],
  # "{!}TODO: No", "horseman_ask_2",
  # []],
  
  # [trp_tutorial_master_horseman, "horseman_ask_2",
  # [],
  # "{!}TODO: Come back later then.", "close_window",
  # []],
  
  [trp_tutorial_master_horseman, "horseman_challenge",
    [
      (eq, "$g_tutorial_training_ground_horseman_trainer_completed_chapters", 0),
    ],
    "Good. Now, I will give you a few exercises that'll teach you riding and horseback weapon use. " +
    "Your first assignment is simple. Just take your horse for a ride around the course. " +
    "Go as slow or as fast as you like. " +
    "Come back when you feel confident as a rider and I'll give you some tougher exercises.", "horseman_melee_challenge_2",
    []],
  
  [anyone|plyr, "horseman_melee_challenge_2",
    [],
    "All right. I am ready.", "close_window",
    [
      (assign, "$g_tutorial_training_ground_horseman_trainer_state", 1),
      (try_begin),
        (eq, "$g_tutorial_training_ground_horseman_trainer_completed_chapters", 0),
        (assign, "$g_tutorial_training_ground_horseman_trainer_item_1", -1),
        (assign, "$g_tutorial_training_ground_horseman_trainer_item_2", -1),
      (else_try),
        (eq, "$g_tutorial_training_ground_horseman_trainer_completed_chapters", 1),
        (assign, "$g_tutorial_training_ground_horseman_trainer_item_1", "itm_arena_lance"),
        (assign, "$g_tutorial_training_ground_horseman_trainer_item_2", -1),
      (else_try),
        (assign, "$g_tutorial_training_ground_horseman_trainer_item_1", "itm_practice_bow_2"),
        (assign, "$g_tutorial_training_ground_horseman_trainer_item_2", "itm_practice_arrows_2"),
      (try_end),
  ]],
  
  [anyone|plyr, "horseman_melee_challenge_2",
    [],
    "Just a minute. I need to do something else first.", "close_window", []],
  
  [trp_tutorial_rider_1|auto_proceed, "start",
    [],
    "{!}Warning: This line is never displayed.", "tutorial_troop_default",
    []],
  
  [trp_tutorial_rider_2|auto_proceed, "start",
    [],
    "{!}Warning: This line is never displayed.", "tutorial_troop_default",
    []],
  
  [anyone, "tutorial_troop_default",
    [
      (try_begin),
        (eq, "$g_tutorial_training_ground_intro_message_being_displayed", 1),
        (assign, "$g_tutorial_training_ground_intro_message_being_displayed", 0),
        (tutorial_message, -1), #remove tutorial intro immediately before a conversation
      (try_end),
    ],
    "Hey, I am trying to practice here. Go, talk with the archery trainer if you need guidance about ranged weapons.", "close_window", []],
  
  
  #PRISON BREAK START
  [anyone,"start",
    [
      (eq, "$talk_context", tc_prison_break),
      (troop_slot_eq, "$g_talk_troop", slot_troop_prisoner_of_party, "$g_encountered_party"),
      (troop_slot_ge, "$g_talk_troop", slot_troop_mission_participation, mp_stay_out),
    ],
    "Is there a change of plans?", "lord_prison_break_confirm_3",[]],
  
  [anyone,"start",
    [
      (eq, "$talk_context", tc_prison_break),
      (try_begin),
        (eq, "$cheat_mode", 1),
        (assign, reg0, "$g_talk_troop"),
        (assign, reg1, "$g_encountered_party"),
        (troop_get_slot, reg2, "$g_talk_troop", slot_troop_prisoner_of_party),
        (display_message, "@{!}g_talk_troop = {reg0} , g_encountered_party = {reg1} , slot value = {reg2}"),
      (try_end),
      (troop_slot_eq, "$g_talk_troop", slot_troop_prisoner_of_party, "$g_encountered_party"),
    ],
    "What's going on?", "lord_prison_break",[]],
  
  
  #TAVERN DRUNK DIALOGS
  [anyone, "start",
    [
      (eq, "$g_talk_troop", "trp_belligerent_drunk"),
    ],
    "What are you looking at?", "drunk_response",
    [
      (try_begin),
        (eq, "$g_main_attacker_agent", 0),
        (call_script, "script_activate_tavern_attackers"),
      (try_end),
      
  ]],
  
  [anyone, "start",
    [
      (eq, "$g_talk_troop", "trp_hired_assassin"),
    ],
    "Are you looking at me?", "drunk_response",
    [
      (try_begin),
        (eq, "$g_main_attacker_agent", 0),
        (call_script, "script_activate_tavern_attackers"),
      (try_end),
      (mission_disable_talk),
  ]],
  
  [anyone, "start",
    [
      (eq, "$g_talk_troop", "trp_hired_assassin"),
      (eq,1,0),
    ],
    "{!}Added to match dialog ids with translations.", "close_window",
    []],
  
  
  [anyone, "start", [
      (is_between, "$g_talk_troop", tavernkeepers_begin, tavernkeepers_end),
      (gt, "$g_main_attacker_agent", 0),
      (neg|agent_is_alive, "$g_main_attacker_agent"),
      
      (try_begin),
        (neg|agent_is_alive, "$g_main_attacker_agent"),
        (agent_get_troop_id, ":type", "$g_main_attacker_agent"),
        (eq, ":type", "trp_hired_assassin"),
        
        (str_store_string, s9, "str_strange_that_one_didnt_seem_like_your_ordenary_troublemaker_he_didnt_drink_all_that_much__he_just_stood_there_quietly_and_watched_the_door_you_may_wish_to_consider_whether_you_have_any_enemies_who_know_you_are_in_town_a_pity_that_blood_had_to_be_spilled_in_my_establishment"),
        
        (assign, "$g_main_attacker_agent", 0),
        (troop_add_gold, "trp_player", 50),
        (troop_add_item, "trp_player", "itm_sword_viking_1", 0),
        
      (else_try),
        #(display_message, "str_wielded_item_reg3"),
        
        (lt, "$g_attacker_drawn_weapon", "itm_tutorial_spear"),
        (str_store_string, s9, "str_you_never_let_him_draw_his_weapon_still_it_looked_like_he_was_going_to_kill_you_take_his_sword_and_purse_i_suppose_he_was_trouble_but_its_not_good_for_an_establishment_to_get_a_name_as_a_place_where_men_are_killed"),
        
        (assign, "$g_main_attacker_agent", 0),
        (troop_add_gold, "trp_player", 50),
        (troop_add_item, "trp_player", "itm_sword_viking_1", 0),
        (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", -1),
      (else_try),
        (neg|agent_is_alive, "$g_main_attacker_agent"),
        (str_store_string, s9, "str_well_id_say_that_he_started_it_that_entitles_you_to_his_sword_and_purse_i_suppose_have_a_drink_on_the_house_as_i_daresay_youve_saved_a_patron_or_two_a_broken_skull_still_i_hope_he_still_has_a_pulse_its_not_good_for_an_establishment_to_get_a_name_as_a_place_where_men_are_killed"),
        (assign, "$g_main_attacker_agent", 0),
        (troop_add_gold, "trp_player", 50),
        (troop_add_item, "trp_player", "itm_sword_viking_1", 0),
        (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", 1),
      (try_end),
      (troop_set_slot, "trp_hired_assassin", slot_troop_cur_center, -1),
    ],
    "{!}{s9}", "player_duel_response", [
  ]],
  
  
  [anyone, "start", [
      (is_between, "$g_talk_troop", tavernkeepers_begin, tavernkeepers_end),
      (gt, "$g_main_attacker_agent", 0),
      (try_begin),
        (get_player_agent_no, ":player_agent"),
        (agent_get_wielded_item, ":wielded_item", ":player_agent", 0),
        (is_between, ":wielded_item", "itm_darts", "itm_torch"),
        (neq, ":wielded_item", "itm_javelin_melee"),
        (neq, ":wielded_item", "itm_throwing_spear_melee"),
        (neq, ":wielded_item", "itm_jarid_melee"),
        (neq, ":wielded_item", "itm_light_throwing_axes_melee"),
        (neq, ":wielded_item", "itm_throwing_axes_melee"),
        (neq, ":wielded_item", "itm_heavy_throwing_axes_melee"),
        (str_store_string, s9, "str_stop_no_shooting_no_shooting"),
        
        (assign, ":default_item", -1),
        (troop_get_inventory_capacity, ":end_cond", "trp_player"),
        (try_for_range, ":i_slot", 0, ":end_cond"),
          (troop_get_inventory_slot, ":item_id", "trp_player", ":i_slot"),
          
          (is_between, ":item_id", weapons_begin, weapons_end),
          (neg|is_between, ":item_id", ranged_weapons_begin, ranged_weapons_end),
          
          (assign, ":default_item", ":item_id"),
          (assign, ":end_cond", 0), #break
        (try_end),
        
        (agent_set_wielded_item, ":player_agent", ":default_item"),
      (else_try),
        (str_store_string, s9, "str_em_ill_stay_out_of_this"),
      (try_end),
    ],
    "{!}{s9}", "close_window", [
  ]],
  
  [anyone|plyr, "player_duel_response", [],
    "Such a waste...", "close_window", [
  ]],
  
  [anyone|plyr, "player_duel_response", [],
    "Better him than me", "close_window", [
  ]],
  
  
  [anyone|plyr, "drunk_response", [],
    "I'm not sure... Some sort of animal, clearly", "drunk_fight_start", [
  ]],
  
  [anyone|plyr, "drunk_response", [],
    "Excuse me -- please accept my apologies", "drunk_fight_start", [
  ]],
  
  [anyone, "drunk_fight_start", [],
    "I'll wipe that smirk right off your face!", "close_window", [
      (troop_set_slot, "trp_belligerent_drunk", slot_troop_cur_center, 0),
  ]],
  
  [anyone|plyr, "drunk_response",
    [
      (troop_slot_ge, "trp_player", slot_troop_renown, 150),
    ],
    "Do you have any idea who I am?", "drunk_player_high_renown", [
  ]],
  
  [anyone, "drunk_player_high_renown", [
      (eq, "$g_talk_troop", "trp_hired_assassin"),
    ],
    "Do I care?", "drunk_fight_start", [
  ]],
  
  [anyone, "drunk_player_high_renown", [],
    "Emmm... Actually... Yes, yes, I do know who you are, {sir/madame}. Please forgive me, your grace -- it must be the drink. I'll be leaving, now...", "drunk_player_high_renown", [
  ]],
  
  [anyone|plyr, "drunk_player_high_renown", [],
    "Why, if you want a fight, you shall have one!", "drunk_fight_start", [
  ]],
  
  [anyone|plyr, "drunk_player_high_renown", [],
    "I thought as much. Now, remove yourself from here", "close_window",
    [
      (assign, "$drunks_dont_pick_fights", 1),
      (troop_set_slot, "trp_belligerent_drunk", slot_troop_cur_center, 0),
      
      (call_script, "script_deactivate_tavern_attackers"),
      
      (assign, "$g_belligerent_drunk_leaving", "$g_main_attacker_agent"),
      
      (mission_enable_talk),
      
      (try_for_agents, ":agent"),
        (agent_is_alive, ":agent"),
        (agent_get_position, pos4, ":agent"),
        (agent_set_scripted_destination, ":agent", pos4),
      (try_end),
      
      (entry_point_get_position, pos1, 0),
      (agent_set_scripted_destination, "$g_main_attacker_agent", pos1),
      
      (assign, "$g_main_attacker_agent", 0),
  ]],
  
  
  [anyone, "start",
    [
      (eq, "$g_talk_troop", "trp_fight_promoter"),
    ],
    "You look like a {fellow/lady} who can take a few hard knocks -- and deal them out, too. I have a business proposition for you.", "fistfight_response", [
  ]],
  
  [anyone|plyr, "fistfight_response", [],
    "How's that?", "fistfight_response_2", [
  ]],
  
  [anyone, "fistfight_response_2", [
    ],
    "Good -- I'm glad you're interested. Here's the plan... It's a little complicated, so listen well. ", "fistfight_response_2a", [
  ]],
  
  [anyone, "fistfight_response_2a", [
    ],
    "You and this other fellow will start up a fight here. No weapons, no armor -- I'll sit back and take bets, and split the profits with the winner. If we make a loss, then I'll cover it. You've got nothing to lose -- except a bit of blood, of course.", "fistfight_response_3", [
  ]],
  
  [anyone, "fistfight_response_3", [
    ],
    "However, we can't organize this like one of those nice arena bouts, where everyone places their bets beforehand. People will walk in, drawn by the noise, and put a denar or two on whichever one of your two they think is winning. I'll give 'em even odds -- anything else is going to be too tricky for someone who's already on his third flagon of ale.", "fistfight_response_4", [
  ]],
  
  [anyone, "fistfight_response_4", [
    ],
    "So, as you can see, the trick is to stretch things out for as long as possible where it looks like you're losing, and people bet against you -- and then come back fast, and win, before the betting can turn. The best way to make money is for you to be battered almost to the floor, and then jump back off your feet and take the other guy down. However, you have to win in the end in order for me, and you, to make money. ", "fistfight_response_4a", [
  ]],
  
  [anyone, "fistfight_response_4a", [
    ],
    "Also, you can't stretch the fight out too long, or people will suspect a fix. So, one of you has to take a punch every so often. I don't care whose blood is spilled, but there has to be some blood.", "fistfight_response_5", [
  ]],
  
  [anyone, "fistfight_response_5", [
    ],
    "And one other thing -- my mate, your opponent, he doesn't take to well to complexity. So he's just going to come straight at you. It's up to you to supply the artistry.", "fistfight_response_5a", [
  ]],
  
  [anyone, "fistfight_response_5a", [
    ],
    "So, what do you think?", "fistfight_response_confirm", [
  ]],
  
  [anyone|plyr, "fistfight_response_confirm", [
    ],
    "{!}[Yes -- not yet implemented]", "close_window", [
  ]],
  
  [anyone|plyr, "fistfight_response_confirm", [
    ],
    "I have better things to do", "close_window", [
  ]],
  
  
  
  [trp_ramun_the_slave_trader, "start", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_met_previously, 0),
      ], "Good day to you, {young man/lassie}.", "ramun_introduce_1",[]],
  [trp_ramun_the_slave_trader|plyr, "ramun_introduce_1", [], "Forgive me, you look like a trader, but I see none of your merchandise.", "ramun_introduce_2",[
      (troop_set_slot, "$g_talk_troop", slot_troop_met_previously, 1),
  ]],
  [trp_ramun_the_slave_trader|plyr, "ramun_introduce_1", [], "Never mind.", "close_window",[]],
  [trp_ramun_the_slave_trader, "ramun_introduce_2", [], "A trader? Oh, aye, I certainly am that. " +
    "My merchandise is a bit different from most, however. It has to be fed and watered twice a day and tries to run away if I turn my back.", "ramun_introduce_3",[]],
  [trp_ramun_the_slave_trader|plyr, "ramun_introduce_3", [], "Livestock?", "ramun_introduce_4",[]],
  [trp_ramun_the_slave_trader, "ramun_introduce_4", [], "Close enough. I like to call myself the man who keeps every boat on this ocean moving. " +
    "Boats are driven by oars, you see, and oars need men to pull them or they stop. That's where I come in.", "ramun_introduce_5",[]],
  [trp_ramun_the_slave_trader|plyr, "ramun_introduce_5", [], "Galley slaves.", "ramun_introduce_6",[]],
  [trp_ramun_the_slave_trader, "ramun_introduce_6", [], "Now you're catching on! A trading port like this couldn't survive without them. " +
    "The ships lose a few hands on every voyage, so there's always a high demand. The captains come to me and they pay well.", "ramun_introduce_7",[]],
  [trp_ramun_the_slave_trader|plyr, "ramun_introduce_7", [], "Where do the slaves come from?", "ramun_introduce_8",[]],
  [trp_ramun_the_slave_trader, "ramun_introduce_8", [], "Mostly I deal in convicted criminals bought from the authorities. " +
    "Others are prisoners of war from various nations, brought to me because I offer the best prices. " +
    "However, on occasion I'll buy from privateers and other . . . 'individuals'. You can't be picky about your suppliers in this line of work. " +
    "You wouldn't happen to have any prisoners with you, would you?", "ramun_introduce_9",[]],
  [trp_ramun_the_slave_trader|plyr, "ramun_introduce_9", [], "Me? ", "ramun_introduce_10",[]],
  [trp_ramun_the_slave_trader, "ramun_introduce_10", [], "Why not? If you intend to set foot outside this town, " +
    "you're going to cross swords with someone sooner or later. And, God willing, you'll come out on top. " +
    "Why not make some extra money off the whole thing? Take them alive, bring them back to me, and I'll pay you fifty denars for each head. " +
    "Don't much care who they are or where they come from.", "ramun_introduce_11",[]],
  [trp_ramun_the_slave_trader|plyr, "ramun_introduce_11", [], "Hmm. I'll think about it.", "ramun_introduce_12",[]],
  [trp_ramun_the_slave_trader, "ramun_introduce_12", [], "Do think about it! " +
    "There's a lot of silver to be made, no mistake. More than enough for the both of us.", "close_window",[]],
  
  [trp_ramun_the_slave_trader,"start", [], "Hello, {playername}.", "ramun_talk",[]],
  [trp_ramun_the_slave_trader,"ramun_pre_talk", [], "Anything else?", "ramun_talk",[]],
  
  [trp_ramun_the_slave_trader|plyr,"ramun_talk",
    [[store_num_regular_prisoners,reg(0)],[ge,reg(0),1]],
    "I've brought you some prisoners, Ramun. Would you like a look?", "ramun_sell_prisoners",[]],
  [trp_ramun_the_slave_trader,"ramun_sell_prisoners", [],
    "Let me see what you have...", "ramun_sell_prisoners_2",
    [[change_screen_trade_prisoners]]],
  [trp_ramun_the_slave_trader, "ramun_sell_prisoners_2", [], "A pleasure doing business with you.", "close_window",[]],
  
  [trp_ramun_the_slave_trader|plyr,"ramun_talk", [(neg|troop_slot_ge,"$g_talk_troop",slot_troop_met_previously,1)], "How do I take somebody as prisoner?", "ramun_ask_about_capturing",[]],
  [trp_ramun_the_slave_trader|plyr,"ramun_talk", [(troop_slot_ge,"$g_talk_troop", slot_troop_met_previously, 1)], "Can you tell me again about capturing prisoners?", "ramun_ask_about_capturing",[(troop_set_slot,"$g_talk_troop", slot_troop_met_previously, 2)]],
  
  [trp_ramun_the_slave_trader,"ramun_ask_about_capturing", [(neg|troop_slot_ge,"$g_talk_troop",slot_troop_met_previously,1)],
    "You're new to this, aren't you? Let me explain it in simple terms. " +
    "The basic rule of taking someone prisoner is knocking him down with a blunt weapon, like a mace or a club, " +
    "rather than cutting him open with a sword. That way he goes to sleep for a little while rather than bleeding to death, you see? " +
    "I'm assuming you have a blunt weapon with you . . .", "ramun_have_blunt_weapon",[]],
  [trp_ramun_the_slave_trader|plyr,"ramun_have_blunt_weapon", [],
    "Of course.", "ramun_have_blunt_weapon_yes",[]],
  [trp_ramun_the_slave_trader|plyr,"ramun_have_blunt_weapon", [],
    "As a matter of fact, I don't.", "ramun_have_blunt_weapon_no",[]],
  [trp_ramun_the_slave_trader,"ramun_have_blunt_weapon_yes", [],
    "Good. Then all you need to do is beat the bugger down with your weapon, and when the fighting's over you clap him in irons. " +
    "It's a bit different for nobles and such, they tend to be protected enough that it won't matter what kind of weapon you use, " +
    "but your average rabble-rouser will bleed like a stuck pig if you get him with something sharp. I don't have many requirements in my merchandise, " +
    "but I do insist they be breathing when I buy them.", "ramun_ask_about_capturing_2",[]],
  [trp_ramun_the_slave_trader,"ramun_have_blunt_weapon_no", [],
    "No? Heh, well, this must be your lucky day. I've got an old club lying around that I was going to throw away. " +
    "It a bit battered, but still good enough bash someone until he stops moving. " +
    "Here, have it.","ramun_have_blunt_weapon_no_2",[(troop_add_item, "trp_player","itm_club",imod_cracked)]],
  [trp_ramun_the_slave_trader|plyr,"ramun_have_blunt_weapon_no_2", [],
    "Thanks, Ramun. Perhaps I may try my hand at it.", "ramun_have_blunt_weapon_yes",[]],
  [trp_ramun_the_slave_trader,"ramun_ask_about_capturing", [],
    "Alright, I'll try and expain it again in simple terms. The basic rule of taking someone prisoner is knocking him down with a blunt weapon, like a mace or a club, " +
    "rather than cutting him open with a sword. That way he goes to sleep for a little while rather than bleeding to death, you see? " +
    "It's a bit different for nobles and such, they tend to be protected enough that it won't matter what kind of weapon you use, " +
    "but your average rabble-rouser will bleed like a stuck pig if you get him with something sharp.", "ramun_ask_about_capturing_2",[]],
  [trp_ramun_the_slave_trader|plyr,"ramun_ask_about_capturing_2", [], "Alright, I think I understand. Anything else?", "ramun_ask_about_capturing_3",[]],
  [trp_ramun_the_slave_trader,"ramun_ask_about_capturing_3", [],
    "Well, it's not as simple as all that. Blunt weapons don't do as much damage as sharp ones, so they won't bring your enemies down as quickly. " +
    "And trust me, given the chance, most of the scum you run across would just as soon kill you as look at you, so don't expect any courtesy when you pull out a club instead of a sword. " +
    "Moreover, having to drag prisoners to and fro will slow down your party, which is why some people simply set their prisoners free after the fighting's done. " +
    "It's madness. How could anyone turn down all that silver, eh?", "ramun_ask_about_capturing_4",[]],
  [trp_ramun_the_slave_trader|plyr,"ramun_ask_about_capturing_4", [],
    "Is that everything?", "ramun_ask_about_capturing_5",[]],
  [trp_ramun_the_slave_trader,"ramun_ask_about_capturing_5", [],
    "Just one final thing. Managing prisoners safely is not an easy thing to do, you could call it a skill in itself. " +
    "If you want to capture a lot of prisoners, you should try and learn the tricks of it yourself, " +
    "or you won't be able to hang on to a single man you catch.", "ramun_ask_about_capturing_7",[]],
  [trp_ramun_the_slave_trader|plyr,"ramun_ask_about_capturing_7", [],
    "Thanks, I'll keep it in mind.", "ramun_pre_talk",[]],
  
  [trp_ramun_the_slave_trader|plyr,"ramun_talk", [], "I'd better be going.", "ramun_leave",[]],
  [trp_ramun_the_slave_trader,"ramun_leave", [], "Remember, any prisoners you've got, bring them to me. I'll pay you good silver for every one.", "close_window",[]],
  
  
  
  
  
  
  [trp_nurse_for_lady, "start", [
      #  (eq, "$talk_context", tc_garden),
      ], "I humbly request that your lordship keeps his hands where I can see them.", "close_window",[]],
  
  ##  [trp_tutorial_trainer, "start", [(eq, "$tutorial_1_state", 1),], "TODO: Watch me.", "tutorial_1_1_1",[]],
  ##  [trp_tutorial_trainer, "tutorial_1_1_1", [], "TODO: This is up.", "tutorial_1_1_2",[(agent_set_attack_action, "$g_talk_agent", 3),]],
  ##  [trp_tutorial_trainer, "tutorial_1_1_2", [], "TODO: This is left.", "tutorial_1_1_3",[(agent_set_attack_action, "$g_talk_agent", 2),]],
  ##  [trp_tutorial_trainer, "tutorial_1_1_3", [], "TODO: This is right.", "tutorial_1_1_4",[(agent_set_attack_action, "$g_talk_agent", 1),]],
  ##  [trp_tutorial_trainer|plyr, "tutorial_1_1_4", [], "TODO: OK.", "close_window",[]],
  
  
  #old tutorial is below
  
  ##  [trp_tutorial_trainer,"start", [(eq, "$tutorial_quest_award_taken", 1),], "I think you have trained enough. Perhaps you should go to Zendar for the next step of your adventure.", "close_window",[]],
  ##  [trp_tutorial_trainer,"start", [(store_character_level, ":player_level", "trp_player"),(gt, ":player_level", 1)], "I think you have trained enough. Perhaps you should go to Zendar for the next step of your adventure.", "close_window",[]],
  ##  [trp_tutorial_trainer,"start", [(eq, "$tutorial_quest_taken", 0),], "Greetings stranger. What's your name?", "tutorial1_1",[]],
  ##  [trp_tutorial_trainer|plyr, "tutorial1_1", [], "Greetings sir, it's {playername}.", "tutorial1_2", []],
  ##  [trp_tutorial_trainer, "tutorial1_2", [], "Well {playername}, this place you see is the training ground. Locals come here to practice their combat skills. Since you are here you may have a go as well.", "tutorial1_3", []],
  ##  [trp_tutorial_trainer|plyr, "tutorial1_3", [], "I'd like that very much sir. Thank you.", "tutorial1_4", []],
  ##  [trp_tutorial_trainer, "tutorial1_4", [], "You will learn the basics of weapons and riding a horse here.\
  ##  First you'll begin with melee weapons. Then you'll enter an archery range to test your skills. And finally you'll see a horse waiting for you.\
  ##  I advise you to train in all these 3 areas. But you can skip some of them, it's up to you.", "tutorial1_6", []],
  ##  [trp_tutorial_trainer, "tutorial1_6", [], "Tell you what, if you destroy at least 10 dummies while training, I will give you my old knife as a reward. It's a little rusty but it's a good blade.", "tutorial1_7", []],
  ##  [trp_tutorial_trainer|plyr, "tutorial1_7", [], "Sounds nice, I'm ready for training.", "tutorial1_9", []],
  ##  [trp_tutorial_trainer, "tutorial1_9", [], "Good. Return to me when you have earned your reward.", "close_window", [(eq, "$tutorial_quest_taken", 0),
  ##                                                                                                                     (str_store_troop_name, 1, "trp_tutorial_trainer"),
  ##                                                                                                                     (str_store_party_name, 2, "p_training_ground"),
  ##                                                                                                                     (setup_quest_giver, "qst_destroy_dummies", "str_given_by_s1_at_s2"),
  ##                                                                                                                     (str_store_string, s2, "@Trainer ordered you to destroy 10 dummies in the training camp."),
  ##                                                                                                                     (call_script, "script_start_quest", "qst_destroy_dummies", "$g_talk_troop"),
  ##                                                                                                                     (assign, "$tutorial_quest_taken", 1)]],
  ##
  ##  [trp_tutorial_trainer,"start", [(eq, "$tutorial_quest_taken", 1),
  ##                                  (eq, "$tutorial_quest_succeeded", 1),], "Well done {playername}. Now you earned this knife. There you go.", "tutorial2_1",[]],
  ##  [trp_tutorial_trainer|plyr, "tutorial2_1", [], "Thank you master.", "close_window", [(call_script, "script_end_quest", "qst_destroy_dummies"),(assign, "$tutorial_quest_award_taken", 1),(add_xp_to_troop, 100, "trp_player"),(troop_add_item, "trp_player","itm_knife",imod_chipped),]],
  ##
  ##  [trp_tutorial_trainer,"start", [(eq, "$tutorial_quest_taken", 1),
  ##                                  (eq, "$tutorial_quest_succeeded", 1),], "Greetings {playername}. Feel free to train with the targets.", "tutorial2_1",[]],
  ##
  ##  [trp_tutorial_trainer,"start", [(eq, "$tutorial_quest_taken", 1),
  ##                                  (eq, "$tutorial_quest_succeeded", 0),], "I don't see 10 dummies on the floor from here. You haven't earned your reward yet.", "tutorial3_1",[]],
  ##  [trp_tutorial_trainer|plyr, "tutorial3_1", [], "Alright alright, I was just tired and wanted to talk to you while resting.", "tutorial3_2", []],
  ##  [trp_tutorial_trainer, "tutorial3_2", [], "Less talk, more work.", "close_window", []],
  
  
  ##  [party_tpl|pt_peasant,"start", [(eq,"$talk_context",tc_party_encounter)], "Greetings traveller.", "peasant_talk_1",[(play_sound,"snd_encounter_farmers")]],
  ##  [party_tpl|pt_peasant|plyr,"peasant_talk_1", [[eq,"$quest_accepted_zendar_looters"]], "Greetings to you too.", "close_window",[(assign, "$g_leave_encounter",1)]],
  ##  [party_tpl|pt_peasant|plyr,"peasant_talk_1", [[neq,"$quest_accepted_zendar_looters"],[eq,"$peasant_misunderstanding_said"]], "I have been charged with hunting down outlaws in this area...", "peasant_talk_2",[[assign,"$peasant_misunderstanding_said",1]]],
  ##  [party_tpl|pt_peasant|plyr,"peasant_talk_1", [[neq,"$quest_accepted_zendar_looters"],[neq,"$peasant_misunderstanding_said"]], "Greetings. I am hunting outlaws. Have you seen any around here?", "peasant_talk_2b",[]],
  ##  [party_tpl|pt_peasant,"peasant_talk_2", [], "I swear to God {sir/madam}. I am not an outlaw... I am just a simple peasant. I am taking my goods to the market, see.", "peasant_talk_3",[]],
  ##  [party_tpl|pt_peasant|plyr,"peasant_talk_3", [], "I was just going to ask if you saw any outlaws around here.", "peasant_talk_4",[]],
  ##  [party_tpl|pt_peasant,"peasant_talk_4", [], "Oh... phew... yes, outlaws are everywhere. They are making life miserable for us.\
  ## I pray to God you will kill them all.", "close_window",[(assign, "$g_leave_encounter",1)]],
  ##  [party_tpl|pt_peasant,"peasant_talk_2b", [], "Outlaws? They are everywhere. They are making life miserable for us.\
  ## I pray to God you will kill them all.", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  [party_tpl|pt_manhunters,"start", [(eq,"$talk_context",tc_party_encounter)], "Hey, you there! You seen any outlaws around here?", "manhunter_talk_b",[]],
  [party_tpl|pt_manhunters|plyr,"manhunter_talk_b", [], "Yes, they went this way about an hour ago.", "manhunter_talk_b1",[]],
  [party_tpl|pt_manhunters,"manhunter_talk_b1", [], "I knew it! Come on, lads, lets go get these bastards! Thanks a lot, friend.", "close_window",[(assign, "$g_leave_encounter",1)]],
  [party_tpl|pt_manhunters|plyr,"manhunter_talk_b", [], "No, haven't seen any outlaws lately.", "manhunter_talk_b2",[]],
  [party_tpl|pt_manhunters,"manhunter_talk_b2", [], "Bah. They're holed up in this country like rats, but we'll smoke them out yet. Sooner or later.", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  [party_tpl|pt_looters|auto_proceed,"start", [(eq,"$talk_context",tc_party_encounter),(encountered_party_is_attacker),], "{!}Warning: This line should never be displayed.", "looters_1",[
      (str_store_string, s11, "@It's your money or your life, {mate/girlie}. No sudden moves or we'll run you through."),
      (str_store_string, s12, "@Lucky for you, you caught me in a good mood. Give us all your coin and I might just let you live."),
      (str_store_string, s13, "@This a robbery, eh? I givin' you one chance to hand over everythin' you got, or me and my mates'll kill you. Understand?"),
      (store_random_in_range, ":random", 11, 14),
      (str_store_string_reg, s4, ":random"),
      (play_sound, "snd_encounter_looters")
  ]],
  [party_tpl|pt_looters,"looters_1", [], "{s4}", "looters_2",[]],
  [party_tpl|pt_looters|plyr,"looters_2", [[store_character_level,reg(1),"trp_player"],[lt,reg(1),4]], "I'm not afraid of you lot. Fight me if you dare!", "close_window",
    [[encounter_attack]]],
  [party_tpl|pt_looters|plyr,"looters_2", [[store_character_level,reg(1),"trp_player"],[ge,reg(1),4]], "You'll have nothing of mine but cold steel, scum.", "close_window",
    [[encounter_attack]]],
  
  [party_tpl|pt_village_farmers,"start", [(eq,"$talk_context",tc_party_encounter),
      (agent_play_sound, "$g_talk_agent", "snd_encounter_farmers"),
    ],
    " My {lord/lady}, we're only poor farmers from the village of {s11}. {reg1?We are taking our products to the market at {s12}.:We are returning from the market at {s12} back to our village.}", "village_farmer_talk",
    [(party_get_slot, ":target_center", "$g_encountered_party", slot_party_ai_object),
      (party_get_slot, ":home_center", "$g_encountered_party", slot_party_home_center),
      (party_get_slot, ":market_town", ":home_center", slot_village_market_town),
      (str_store_party_name, s11, ":home_center"),
      (str_store_party_name, s12, ":market_town"),
      (assign, reg1, 1),
      (try_begin),
        (party_slot_eq, ":target_center", slot_party_type, spt_village),
        (assign, reg1, 0),
      (try_end),
  ]],
  
  [anyone|plyr,"village_farmer_talk",
    [(check_quest_active, "qst_track_down_bandits"),
      (neg|check_quest_succeeded, "qst_track_down_bandits"),
      
      ], "I am hunting a group of bandits with the following description... Have you seen them?", "farmer_bandit_information",[]],
  
  [anyone,"farmer_bandit_information", [
      (call_script, "script_get_manhunt_information_to_s15", "qst_track_down_bandits"),
      ], "{s15}", "village_farmer_talk",[]],
  
  
  [anyone|plyr,"village_farmer_talk",
    [
      (store_faction_of_party, ":faction_of_villager", "$g_encountered_party"),
      
      (neq, ":faction_of_villager", "$players_kingdom"),
      (neq, ":faction_of_villager", "fac_player_supporters_faction"),
    ],
    "We'll see how poor you are after I take what you've got!", "close_window",
    [(party_get_slot, ":home_center", "$g_encountered_party", slot_party_home_center),
      (party_get_slot, ":market_town", ":home_center", slot_village_market_town),
      (party_get_slot, ":village_owner", ":home_center", slot_town_lord),
      (call_script, "script_change_player_relation_with_center", ":home_center", -4),
      (call_script, "script_change_player_relation_with_center", ":market_town", -2),
      (call_script, "script_change_player_relation_with_troop", ":village_owner", -2),
      (call_script, "script_diplomacy_party_attacks_neutral", "p_main_party", "$g_encountered_party"),
      
      (store_relation,":rel", "$g_encountered_party_faction","fac_player_supporters_faction"),
      (try_begin),
        (gt, ":rel", 0),
        (val_sub, ":rel", 5),
      (try_end),
      
      (val_sub, ":rel", 3),
      (call_script, "script_set_player_relation_with_faction", "$g_encountered_party_faction", ":rel"),
      
      (assign,"$encountered_party_hostile",1),
      (assign,"$encountered_party_friendly",0),
  ]],
  [anyone|plyr,"village_farmer_talk", [], "Carry on, then. Farewell.", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  
  ###1429 SL ENCOUNTER
  [party_tpl|pt_sang_lys,"start", [(eq,"$talk_context",tc_party_encounter)], "Salutations,que pouvons nous faire pour vous?", "slel_talk_b",[]],
  
  [party_tpl|pt_sang_lys|plyr,"slel_talk_b",
    [
      (check_quest_active, "qst_sl_viland_troop1"),
      (neg|check_quest_succeeded, "qst_sl_viland_troop1"),
      (eq, "$recruitpourvialandrand", 0),
    ],
    "Salutations,le Maitre de la compagnie vous ordonne de me suivre pour une mission d'importance.", "slrecrui_novilandrw",
    [(change_screen_exchange_members,0)]],
  [party_tpl|pt_sang_lys|plyr,"slel_talk_b", [], "Je voudrais vous recruter.", "slrecrui_noxw",[]],
  [party_tpl|pt_sang_lys|plyr,"slel_talk_b", [], "Rien,je voullais juste vous saluer.", "close_window",[]],
  
  [party_tpl|pt_sang_lys,"slrecrui_novilandrw",[],"J'éspère qu'il ne nous envoie pas a la mort...en avant!.", "close_window",[(assign, "$recruitpourvialandrand", 1),(assign, "$g_leave_encounter",1)]],
  [party_tpl|pt_sang_lys,"slrecrui_noxw", [], "Nous recruter? et bien,nous avons déja un contrat,et nous devons l'honorer,c'est notre renommée qui es en jeu,mais si vous voullez des troupes du SansLys,recrutez les directement dans les tavernes,si ils y sont,cela veux dire qu'ils n'ont aucuns contrats et son prets a vous suivre.", "slrecrui_noxw2",[]],
  [party_tpl|pt_sang_lys|plyr,"slrecrui_noxw2", [], "Je comprend,adieu.", "close_window",[]],
  ###1429 REBEL ENCOUNTER
  [party_tpl|pt_black_khergit,"start", [(eq,"$talk_context",tc_party_encounter)], "Salutations Compagnon,as tu besoin d'aide ?", "rreebel_talk_b",[(play_sound, "snd_rebels_greetings"),]],
  
  [party_tpl|pt_black_khergit|plyr,"rreebel_talk_b", [], "Avez vous quelques vivres?", "reeebbel_vevre",[]],
  [party_tpl|pt_black_khergit|plyr,"rreebel_talk_b",
    [
      (ge, "$g_talk_troop_faction_relation", 4),
      (store_current_hours,":cur_hours"),
      (val_sub, ":cur_hours", 72),
      (gt, ":cur_hours", "$gamble_last_time"),
    ],
    "Avez vous des armes ou munitions?", "rreebebl_munitions",[]],
  
  [party_tpl|pt_black_khergit|plyr,"rreebel_talk_b",
    [
      (check_quest_active, "qst_rebel_attack_c1"),
      (neg|check_quest_succeeded, "qst_rebel_attack_c1"),
    ],
    "Salutations,le chef de Montpellier vous demande de me suivre pour une mission.", "rreebel_recruuiit",[(change_screen_exchange_members,0)]],
  [party_tpl|pt_black_khergit|plyr,"rreebel_talk_b",
    [
      (neg|check_quest_active, "qst_rebel_attack_c1"),
      (eq, "$derierequetpiinsok", 1),
      (ge, "$g_talk_troop_faction_relation", 8),
    ],
    "Rejoigniez ma troupe,vous serez plus utiles a la cause !", "rreebel_recruuiit",[(change_screen_exchange_members,0)]],
  #  [party_tpl|pt_black_khergit|plyr,"rreebel_talk_b", [], "Suivez moi,j'ai un plan!", "close_window",[]],
  [party_tpl|pt_black_khergit|plyr,"rreebel_talk_b", [], "Non,je n'ai besoin de rien,bonne route.", "close_window",[(assign, "$g_leave_encounter",1)]],
  #[party_tpl|pt_black_khergit|plyr,"rreebel_talk_b", [], "aller au campement des rebels...", "close_window",
  #  [
  #    (assign, "$g_leave_encounter",1)
  #   ]],
  
  [party_tpl|pt_black_khergit,"rreebel_preetalkk", [], "Autre chose compagnon?", "rreebel_talk_b",[]],
  
  [party_tpl|pt_black_khergit,"rreebel_recruuiit", [], "En route...", "close_window",[(assign, "$g_leave_encounter",1)]],
  [party_tpl|pt_black_khergit,"reeebbel_vevre", [], "Et bien,a dire vrais nous allions te demander la meme chose voie tu...", "rreebel_preetalkk",[]],
  
  [party_tpl|pt_black_khergit,"rreebebl_munitions", [], "On vien juste d'intercepter une cargaison d'armes bourgignone,ces idiots avaient conincée leur chariot dans une creuvasse,c'etait une chance.de quois as tu besoin ?.", "rreebel_arma_choiix",[]],
  [party_tpl|pt_black_khergit|plyr,"rreebel_arma_choiix", [], "Il me faut des fléches.", "rebel_done_fleches",[]],
  [party_tpl|pt_black_khergit|plyr,"rreebel_arma_choiix", [], "Je n'ai plus de careaux pour mon arbalete.", "rebel_done_bolts",[]],
  [party_tpl|pt_black_khergit|plyr,"rreebel_arma_choiix", [], "J'ai besoin d'une épée et d'un bouclier.", "renel_done_shieldnsword",[]],
  [party_tpl|pt_black_khergit|plyr,"rreebel_arma_choiix", [], "Donnez moi une épée a deux mains.", "renel_done_dnsword",[]],
  [party_tpl|pt_black_khergit|plyr,"rreebel_arma_choiix", [], "Non,finalement je n'ai besoin de rien de tout ca.", "rreebel_preetalkk",[]],
  
  [party_tpl|pt_black_khergit,"rebel_done_fleches", [], "Voila...", "rreebel_preetalkk",[(troop_add_item, "trp_player", "itm_arrows", 0),(store_current_hours,":cur_hours"),
      (assign, "$gamble_last_time", ":cur_hours"),]],
  [party_tpl|pt_black_khergit,"rebel_done_bolts", [], "J'éspére que tes dérniers careaux sont réstés sur le cadavre d'un bourgignon et qu'ils ne sont pas tombés dans un ravin,en voila un carquois plein.", "rreebel_preetalkk",[(troop_add_item, "trp_player", "itm_bolts", 0),(store_current_hours,":cur_hours"),
      (assign, "$gamble_last_time", ":cur_hours"),]],
  [party_tpl|pt_black_khergit,"renel_done_shieldnsword", [], "Tu as de la chance,le convoie etait chargé d'armes magnifiques,voila ce que tu demande.", "rreebel_preetalkk",[(troop_add_item, "trp_player", "itm_heraldric_shieldred3lions", 0),(troop_add_item, "trp_player", "itm_templar", 0),(store_current_hours,":cur_hours"),
      (assign, "$gamble_last_time", ":cur_hours"),]],
  [party_tpl|pt_black_khergit,"renel_done_dnsword", [], "Une arme simple mais efficace,c'est tout ce qu'on a put récuperer", "rreebel_preetalkk",[(troop_add_item, "trp_player", "itm_sword_two_handed_a", 0),(store_current_hours,":cur_hours"),
      (assign, "$gamble_last_time", ":cur_hours"),]],
  
  
  ##########################################################################################################################################################################
  
  ##dial rebels exterieurssuite
  [party_tpl|pt_catareb,"start", [(eq,"$talk_context",tc_party_encounter),(eq, "$pasdesiegepouparris", 1),], "Que veux tu ?", "paris_retrouv",[(play_sound, "snd_rebels_greetings"),]],
  
  [party_tpl|pt_catareb|plyr,"paris_retrouv",[],"Rejoignez mes rangs, et je vous enméneraient a la victoire sur Paris.", "paris_retrouv2",[(change_screen_exchange_members,0)]],
  [party_tpl|pt_catareb,"paris_retrouv2", [], "Nous te suivons, nous n'avons pas d'autres choix de toute facon.", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  [party_tpl|pt_catareb|plyr,"paris_retrouv", [], "Rien, vous pouvez partire.", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  
  #dial rebels exterieurs
  [party_tpl|pt_catareb,"start", [(eq,"$talk_context",tc_party_encounter)], "Te voila enfin, assiègont Paris !", "paris_siegestr",[(play_sound, "snd_rebels_greetings"),]],
  
  [party_tpl|pt_catareb|plyr,"paris_siegestr",[],
    "Oui, rejoignez mes rangs, et je vous enméneraient a la victoire.", "paris_siegestrend",[(change_screen_exchange_members,0)]],
  
  [party_tpl|pt_catareb,"paris_siegestrend", [], "Que Dieu es pitié des vaincus.", "close_window",
    [
      (assign, "$g_leave_encounter",1),
  ]],
  
  
  [party_tpl|pt_catareb|plyr,"paris_siegestr", [], "Malheureusement, les choses ont changées, il n'es plus question de siège.", "paris_siegestrno",[(assign, "$pasdesiegepouparris", 1),]],
  [party_tpl|pt_catareb,"paris_siegestrno", [], "Dit moi que ce n'es pas vrais...Seigneur, nous ne pouveons meme pas retourner a Paris, il ne nous reste plus qu'a errer dans la forêt, va au diable avec tes idées.", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  
  ### COMPANIONS
  
  [anyone,"start", [(gt,"$g_talk_troop", 0),
      (eq, "$g_talk_troop", "$g_player_minister"),
      (neg|troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop")],
    "I am at your service, {sire/my lady}", "minister_issues",[]],
  
  [anyone,"start", [(eq,"$g_talk_troop", "trp_temporary_minister"),
      (neq, "$g_talk_troop", "$g_player_minister")],
    "It has been an honor to serve you, {sire/my lady}", "close_window",[]],
  
  
  [anyone,"start", [(troop_slot_eq,"$g_talk_troop", slot_troop_occupation, slto_player_companion),
      (party_slot_eq, "$g_encountered_party", slot_party_type, spt_castle),
      (party_get_num_companion_stacks, ":num_stacks", "$g_encountered_party"),
      (ge, ":num_stacks", 1),
      (party_stack_get_troop_id, ":castle_leader", "$g_encountered_party", 0),
      (eq, ":castle_leader", "$g_talk_troop"),
      (eq, "$talk_context", 0)],
    "Yes, {playername}? What can I do for you?", "member_castellan_talk",[]],
  
  [anyone,"member_castellan_pretalk", [], "Anything else?", "member_castellan_talk",[]],
  
  [anyone|plyr,"member_castellan_talk", [],
    "I want to review the castle garrison.", "member_review_castle_garrison",[]],
  [anyone,"member_review_castle_garrison", [], "Of course. Here are our lists, let me know of any changes you require...", "member_castellan_pretalk",[(change_screen_exchange_members,0)]],
  [anyone|plyr,"member_castellan_talk", [],
    "Let me see your equipment.", "member_review_castellan_equipment",[]],
  [anyone,"member_review_castellan_equipment", [], "Very well, it's all here...", "member_castellan_pretalk",[(change_screen_equip_other)]],
  [anyone|plyr,"member_castellan_talk", [],
    "I want you to abandon the castle and join my party.", "member_castellan_join",[]],
  [anyone,"member_castellan_join", [(party_can_join_party,"$g_encountered_party","p_main_party")],
    "I've grown quite fond of the place... But if it is your wish, {playername}, I'll come with you.", "close_window", [
      (assign, "$g_move_heroes", 1),
      (call_script, "script_party_add_party", "p_main_party", "$g_encountered_party"),
      (party_clear, "$g_encountered_party"),
  ]],
  [anyone,"member_castellan_join", [],
    "And where would we sleep? You're dragging a whole army with you, {playername}, there's no more room for all of us.", "member_castellan_pretalk",[]],
  
  [anyone|plyr,"member_castellan_talk", [], "[Leave]", "close_window",[]],
  
  
  [anyone,"start", [(troop_slot_eq,"$g_talk_troop", slot_troop_occupation, slto_player_companion),
      (neg|main_party_has_troop,"$g_talk_troop"),
      (eq, "$talk_context", tc_party_encounter)],
    "Do you want me to rejoin you?", "member_wilderness_talk",[]],
  [anyone,"start", [(neg|main_party_has_troop,"$g_talk_troop"),(eq, "$g_encountered_party", "p_four_ways_inn")], "Do you want me to rejoin you?", "member_inn_talk",[]],
  #  [anyone,"member_separate_inn", [], "I don't know what you will do without me, but you are the boss. I'll wait for you at the Four Ways inn.", "close_window",
  #  [anyone,"member_separate_inn", [], "All right then. I'll meet you at the four ways inn. Good luck.", "close_window",
  #   [(remove_member_from_party,"$g_talk_troop", "p_main_party"),(add_troop_to_site, "$g_talk_troop", "scn_four_ways_inn", borcha_inn_entry)]],
  
  #Quest heroes member chats
  
  [trp_kidnapped_girl,"member_chat", [], "Are we home yet?", "kidnapped_girl_chat_1",[]],
  [trp_kidnapped_girl|plyr,"kidnapped_girl_chat_1", [], "Not yet.", "kidnapped_girl_chat_2",[]],
  [trp_kidnapped_girl,"kidnapped_girl_chat_2", [], "I can't wait to get back. I've missed my family so much, I'd give anything to see them again.", "close_window",[]],
  
  [anyone,"member_chat",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      ], "{playername}, when do you think we can reach our destination?", "member_lady_1",[]],
  [anyone|plyr, "member_lady_1", [],  "We still have a long way ahead of us.", "member_lady_2a", []],
  [anyone|plyr, "member_lady_1", [],  "Very soon. We're almost there.", "member_lady_2b", []],
  
  [anyone ,"member_lady_2a", [],  "Ah, I am going to enjoy the road for a while longer then. I won't complain. " +
    "I find riding out in the open so much more pleasant than sitting in the castle all day. " +
    "You know, I envy you. You can live like this all the time.", "close_window", []],
  [anyone ,"member_lady_2b", [],  "That's good news. Not that I don't like your company, but I did miss my little luxuries. " +
    "Still I am sorry that I'll leave you soon. You must promise me, you'll come visit me when you can.", "close_window", []],
  
  [anyone ,"member_chat", [(is_between, "$g_talk_troop", pretenders_begin, pretenders_end),],
    "Greetings, {playername}, my first and foremost vassal. I await your counsel.", "supported_pretender_talk", []],
  [anyone ,"supported_pretender_pretalk", [],
    "Anything else?", "supported_pretender_talk", []],
  
  [anyone|plyr,"supported_pretender_talk", [],
    "What do you think about our progress so far?", "pretender_progress",[]],
  
  [anyone,"pretender_progress", [
      (assign, reg11, 0),(assign, reg13, 0),(assign, reg14, 0),(assign, reg15, 0),
      (assign, reg21, 0),(assign, reg23, 0),(assign, reg24, 0),(assign, reg25, 0),
      
      (try_for_range, ":troop_no", active_npcs_begin, active_npcs_end),
        (troop_slot_eq, ":troop_no", slot_troop_occupation, slto_kingdom_hero),
        (store_troop_faction, ":troop_faction", ":troop_no"),
        (try_begin),
          (eq, ":troop_faction", "fac_player_supporters_faction"),
          (neq, ":troop_no", "trp_player"),
          (neq, ":troop_no", "$supported_pretender"),
          (val_add, reg11, 1),
        (else_try),
          (eq, ":troop_faction", "$supported_pretender_old_faction"),
          (neg|faction_slot_eq, "$supported_pretender_old_faction", slot_faction_leader, ":troop_no"),
          (val_add, reg21, 1),
        (try_end),
      (try_end),
      (try_for_range, ":center_no", centers_begin, centers_end),
        (store_faction_of_party, ":center_faction", ":center_no"),
        (try_begin),
          (eq, ":center_faction", "fac_player_supporters_faction"),
          (try_begin),
            (party_slot_eq, ":center_no", slot_party_type, spt_town),
            (val_add, reg13, 1),
          (else_try),
            (party_slot_eq, ":center_no", slot_party_type, spt_castle),
            (val_add, reg14, 1),
          (else_try),
            (party_slot_eq, ":center_no", slot_party_type, spt_village),
            (val_add, reg15, 1),
          (try_end),
        (else_try),
          (eq, ":center_faction", "$supported_pretender_old_faction"),
          (try_begin),
            (party_slot_eq, ":center_no", slot_party_type, spt_town),
            (val_add, reg23, 1),
          (else_try),
            (party_slot_eq, ":center_no", slot_party_type, spt_castle),
            (val_add, reg24, 1),
          (else_try),
            (party_slot_eq, ":center_no", slot_party_type, spt_village),
            (val_add, reg25, 1),
          (try_end),
        (try_end),
      (try_end),
      (store_add, reg19, reg13, reg14),
      (val_add, reg19, reg15),
      (store_add, reg29, reg23, reg24),
      (val_add, reg29, reg25),
      (store_add, ":our_score", reg13, reg14),
      (val_add, ":our_score", reg11),
      (store_add, ":their_score", reg23, reg24),
      (val_add, ":their_score", reg21),
      (store_add, ":total_score", ":our_score", ":their_score"),
      (val_mul, ":our_score", 100),
      (store_div, ":our_ratio", ":our_score", ":total_score"),
      (try_begin),
        (lt, ":our_ratio", 10),
        (str_store_string, s30, "@we have made very little progress so far"),
      (else_try),
        (lt, ":our_ratio", 30),
        (str_store_string, s30, "@we have suceeded in gaining some ground, but we still have a long way to go"),
      (else_try),
        (lt, ":our_ratio", 50),
        (str_store_string, s30, "@we have become a significant force, and we have an even chance of victory"),
      (else_try),
        (lt, ":our_ratio", 75),
        (str_store_string, s30, "@we are winning the war, but our enemies are still holding on."),
      (else_try),
        (str_store_string, s30, "@we are on the verge of victory. The remaining enemies pose no threat, but we still need to hunt them down."),
      (try_end),
      (faction_get_slot, ":enemy_king", "$supported_pretender_old_faction", slot_faction_leader),
      (str_store_troop_name, s9, ":enemy_king"),
    ],
    "{reg11?We have {reg11} lords on our side:We have no lord with us yet}, " +
    "whereas {reg21?{s9} still has {reg21} lords supporting him:{s9} has no loyal lords left}. " +
    "{reg19?We control {reg13?{reg13} towns:} {reg14?{reg14} castles:} {reg15?and {reg15} villages:}:We don't control any settlements}, " +
    "while {reg29?they have {reg23?{reg23} towns:} {reg24?{reg24} castles:} {reg25?and {reg25} villages:}:they have no remaining settlements}. " +
    "Overall, {s30}.", "pretender_progress_2",[]],
  
  [anyone|plyr,"pretender_progress_2", [],
    "Then, we must keep fighting and rally our supporters!", "supported_pretender_pretalk",[]],
  
  [anyone|plyr,"pretender_progress_2", [],
    "It seems this rebellion is not going anywhere. We must give up.", "pretender_quit_rebel_confirm",[]],
  
  [anyone,"pretender_quit_rebel_confirm", [],
    "{playername}, you can't abandon me now. Are you serious?", "pretender_quit_rebel_confirm_2",[]],
  
  [anyone|plyr,"pretender_quit_rebel_confirm_2", [],
    "Indeed, I am. I can't support you any longer.", "pretender_quit_rebel_confirm_3",[]],
  
  [anyone|plyr,"pretender_quit_rebel_confirm_2", [],
    "I was jesting. I will fight for you until we succeed.", "supported_pretender_pretalk",[]],
  
  [anyone,"pretender_quit_rebel_confirm_3", [],
    "Are you absolutely sure? I will never forgive you if you abandon my cause.", "pretender_quit_rebel_confirm_4",[]],
  
  [anyone|plyr,"pretender_quit_rebel_confirm_4", [],
    "I am sure.", "pretender_quit_rebel",[]],
  
  [anyone|plyr,"pretender_quit_rebel_confirm_4", [],
    "Let me think about this some more.", "supported_pretender_pretalk",[]],
  
  [anyone,"pretender_quit_rebel", [],
    "So be it. Then my cause is lost. There is only one thing to do for me now. I will go from France and never come back. With me gone, you may try to make your peace with {s4}.", "close_window",
    [
      (troop_get_slot, ":original_faction", "$g_talk_troop", slot_troop_original_faction),
      (faction_get_slot, ":original_faction_leader", ":original_faction", slot_faction_leader),
      (str_store_troop_name, s4, ":original_faction_leader"),
      
      (try_for_range, ":cur_troop", active_npcs_begin, active_npcs_end),
        (troop_slot_eq, ":cur_troop", slot_troop_occupation, slto_kingdom_hero),
        (neq, "$supported_pretender", ":cur_troop"),
        (store_troop_faction, ":cur_faction", ":cur_troop"),
        (eq, ":cur_faction", "fac_player_supporters_faction"),
        (call_script, "script_change_troop_faction", ":cur_troop", ":original_faction"),
      (try_end),
      (troop_set_faction, "$g_talk_troop", "fac_neutral"),
      (faction_set_slot, "fac_player_supporters_faction", slot_faction_leader, "trp_player"),
      (assign, ":has_center", 0),
      (try_for_range, ":cur_center", centers_begin, centers_end),
        (store_faction_of_party, ":cur_faction", ":cur_center"),
        (eq, ":cur_faction", "fac_player_supporters_faction"),
        (assign, ":has_center", 1),
        (neg|party_slot_eq, ":cur_center", slot_town_lord, "trp_player"),
        (call_script, "script_give_center_to_lord", ":cur_center", "trp_player", 0),
      (try_end),
      (party_remove_members, "p_main_party", "$supported_pretender", 1),
      (faction_set_slot, ":original_faction", slot_faction_has_rebellion_chance, 0),
      (assign, "$supported_pretender", 0),
      (try_begin), #Still has center
        (eq, ":has_center", 1),
        (faction_set_color, "fac_player_supporters_faction", 0xFF0000),
        (try_begin), #added to prevent no minister if player gives up rebellion
          (eq, "$g_player_minister", 0),
          (assign, "$g_player_minister", "trp_temporary_minister"),
        (try_end),
      (else_try), #No center
        (call_script, "script_deactivate_player_faction"),
      (try_end),
      (call_script, "script_change_player_honor", -20),
      (call_script, "script_fail_quest", "qst_rebel_against_kingdom"),
      (call_script, "script_end_quest", "qst_rebel_against_kingdom"),
  ]],
  
  
  [anyone|plyr,"supported_pretender_talk", [],
    "{reg65?My lady:My lord}, would you allow me to check out your equipment?", "supported_pretender_equip",[]],
  [anyone,"supported_pretender_equip", [], "Very well, it's all here...", "supported_pretender_pretalk",[
      (change_screen_equip_other),
  ]],
  
  [anyone|plyr,"supported_pretender_talk", [], "If it would please you, can you tell me about your skills?", "pretneder_view_char_requested",[]],
  [anyone,"pretneder_view_char_requested", [], "Well, all right.", "supported_pretender_pretalk",[(change_screen_view_character)]],
  
  
  [anyone|plyr,"supported_pretender_talk", [
      
      (assign, ":center_found", 0),
      (try_for_range, ":fief_to_grant", centers_begin, centers_end),
        (store_faction_of_party, ":fief_faction", ":fief_to_grant"),
        (eq, ":fief_faction", "fac_player_supporters_faction"),
        (party_slot_eq, ":fief_to_grant", slot_town_lord, -1),
        (assign, ":center_found", 1),
      (try_end),
      (eq, ":center_found", 1),
      
    ],
    "I suggest that you decide who should hold a fief that does not have a lord.", "supported_pretender_grant_fief",[]],
  
  [anyone,"supported_pretender_grant_fief", [
    ],
    "Which fief did you have in mind?", "supported_pretender_grant_fief_select",[]],
  
  [anyone|plyr|repeat_for_parties,"supported_pretender_grant_fief_select", [
      (store_repeat_object, ":fief_to_grant"),
      (is_between, ":fief_to_grant", centers_begin, centers_end),
      (store_faction_of_party, ":fief_faction", ":fief_to_grant"),
      (eq, ":fief_faction", "fac_player_supporters_faction"),
      (party_slot_eq, ":fief_to_grant", slot_town_lord, -1),
      (str_store_party_name, s4, ":fief_to_grant"),
    ],
    "{s4}", "supported_pretender_grant_fief_choose_recipient",[
      (store_repeat_object, "$g_center_taken_by_player_faction"),
  ]],
  
  [anyone,"supported_pretender_grant_fief_choose_recipient", [
    ],
    "And who should receive it?", "center_captured_rebellion",[
      (str_store_party_name, s4, "$g_center_taken_by_player_faction"),
  ]],
  
  [anyone|plyr,"supported_pretender_grant_fief_select", [
    ],
    "Never mind.", "supported_pretender_pretalk",[]],
  
  
  
  
  [anyone|plyr,"supported_pretender_talk", [],###cccc
    "Let us keep going, {reg65?my lady:sir}.", "close_window",[]],
  
  
  [anyone,"do_member_trade", [], "Anything else?", "member_talk",[]],
  
  [anyone,"member_pretalk", [], "Anything else?", "member_talk",[]],
  
  
  
  
  [anyone,"member_chat",
    [
      (store_conversation_troop,"$g_talk_troop"),
      (troop_is_hero,"$g_talk_troop"),
      (troop_get_slot, ":honorific", "$g_talk_troop", slot_troop_honorific),
      (str_store_string, s5, ":honorific"),
    ], "Yes, {s5}?", "member_talk",
    [
      (try_begin),
        (is_between, "$g_talk_troop", companions_begin, companions_end),
        (unlock_achievement, ACHIEVEMENT_TALKING_HELPS),
      (try_end),
  ]],
  
  [anyone|plyr,"member_talk", [
      (is_between, "$players_kingdom", kingdoms_begin, kingdoms_end),
      (faction_slot_eq,  "$players_kingdom", slot_faction_marshall, "trp_player"),
      ], "As marshal, I wish you to send a message to the vassals of the realm", "member_direct_campaign",[]],
  
  ######## pere antony soigneur
  
  [anyone|plyr,"member_talk", [
      (eq, "$g_talk_troop", "trp_npc12"),
      (eq, "$blesse_a_tete", 1),
      ], "Pouvez vous guerire cette bléssure a ma tête ?", "regular_member_removebelesstete",[]],
  #
  [anyone|plyr,"member_talk", [
      (eq, "$g_talk_troop", "trp_npc12"),
      (eq, "$blesse_au_bras", 1),
      ], "J'ai une bléssure au bras, pouvez vous faire quelque chose ?", "regular_member_removebelessbras",[]],
  #
  [anyone|plyr,"member_talk", [
      (eq, "$g_talk_troop", "trp_npc12"),
      (eq, "$blesse_a_jambe", 1),
      ], "J'ai une bléssure a la jambe, pouvez vous faire quelque chose ?", "regular_member_removebelessjambe",[]],
  #
  
  # # # # #reponsse blessures frere
  #tete
  [anyone ,"regular_member_removebelesstete", [],"Seigneur! comment faites vous pour etre encore vivant ? il faut refermer cette horible bléssure avant qu'elle ne s'infecte, cela vous coutera 200 écus je vous prie.", "regular_m_removebelesstetepay", []],
  [anyone|plyr ,"regular_m_removebelesstetepay",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 200),
    ],  "Tres bien, voici l'argent, faites vite, la doulleure es inssuportable.", "regular_m_removebelessteteokn",
    [
      (troop_remove_gold,"trp_player",200),
  ]],
  [anyone|plyr ,"regular_m_removebelesstetepay", [],  "Je n'ai pas la somme que vous demandez.", "regular_m_removebelesstetenomon", []],
  [anyone ,"regular_m_removebelesstetenomon", [],"Je suis navré, mais je ne puis rien faire dans ce cas, il faut bien que je paye ces médicaments.", "do_member_trade", []],
  
  [anyone ,"regular_m_removebelessteteokn", [],"Bien, faites attention la prochaine fois, vous allez finire par trépasser.", "do_member_trade",
    [
      #redoner stat et remetre variable a 0
      (call_script, "script_rest_bless_tete"),
  ]],
  #tete fin !
  
  #bras
  [anyone ,"regular_member_removebelessbras", [],"En effet, votre bras es en piteux état, avez vous 100 écus pour payer les soins.", "regular_m_removebelessbraspay", []],
  [anyone|plyr ,"regular_m_removebelessbraspay",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 100),
    ],  "Tres bien, voici l'argent, faites vite, je peut a peine bouger le bras.", "regular_m_removebelessbraspayokn",
    [
      (troop_remove_gold,"trp_player",100),
  ]],
  [anyone|plyr ,"regular_m_removebelessbraspay", [],  "Je n'ai pas la somme que vous demandez.", "regular_m_removebelessbraspayoknnomon", []],
  [anyone ,"regular_m_removebelessbraspayoknnomon", [],"Je suis navré, mais je ne puis rien faire dans ce cas.", "do_member_trade", []],
  
  [anyone ,"regular_m_removebelessbraspayokn", [],"Bien, faites attention la prochaine fois, ce bras va finire par tomber ?", "do_member_trade",
    [
      #redoner stat et remetre variable a 0
      (call_script, "script_rest_bless_bras"),
  ]],
  #bras fin !
  
  
  #jambe
  [anyone ,"regular_member_removebelessjambe", [],"Ca n'es point grave, cependant il faut netoyer la bléssure et changer le bandage régulièrement, les onguents et les bandages vous couterons 50 écus je vous prie.", "regular_m_removebelessjambepay", []],
  [anyone|plyr ,"regular_m_removebelessjambepay",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 50),
    ],  "Tres bien, voici l'argent, faites vite, je tiens a peine debout.", "regular_m_removebelessjambepayokn",
    [
      (troop_remove_gold,"trp_player",50),
  ]],
  [anyone|plyr ,"regular_m_removebelessjambepay", [],  "Je n'ai pas la somme que vous demandez.", "regular_m_removebelessjambeon", []],
  [anyone ,"regular_m_removebelessjambeon", [],"Je suis navré, mais je ne puis rien faire dans ce cas.", "do_member_trade", []],
  
  [anyone ,"regular_m_removebelessjambepayokn", [],"Je vous recomande d'etre plus prudent, personne ne voudrais d'un capitaine qui ne peut simplement marcher.", "do_member_trade",
    [
      #redoner stat et remetre variable a 0
      (call_script, "script_rest_bless_jambe"),
  ]],
  #jambe fin !
  
  ############################################################
  [anyone|plyr,"member_talk", [],
    
    "Let me see your equipment.", "member_trade",[]],
  [anyone,"member_trade", [], "Very well, it's all here...", "do_member_trade",[
      #      (change_screen_trade)
      (change_screen_equip_other),
  ]],
  
  [anyone,"do_member_trade", [], "Anything else?", "member_talk",[]],
  
  [anyone|plyr,"member_talk", [], "What can you tell me about your skills?", "view_member_char_requested",[]],
  [anyone,"view_member_char_requested", [], "All right, let me tell you...", "do_member_view_char",[(change_screen_view_character)]],
  
  [anyone|plyr,"member_talk", [], "We need to separate for a while.", "member_separate",[
      (call_script, "script_npc_morale", "$g_talk_troop"),
      (assign, "$npc_quit_morale", reg0),
  ]],
  
  [anyone,"member_separate", [
      (gt, "$npc_quit_morale", 30),
    ], "Oh really? Well, I'm not just going to wait around here. I'm going to go to the towns to look for other work. Is that what you want?", "member_separate_confirm",
    []],
  
  [anyone,"member_separate", [
    ], "Well, actually, there was something I needed to tell you.", "companion_quitting",
    [
      (assign, "$player_can_refuse_npc_quitting", 0),
      (assign, "$player_can_persuade_npc", 0),
  ]],
  
  
  [anyone|plyr,"member_separate_confirm", [], "That's right. We need to part ways.", "member_separate_yes",[]],
  [anyone|plyr,"member_separate_confirm", [], "No, I'd rather have you at my side.", "do_member_trade",[]],
  
  [anyone,"member_separate_yes", [
    ], "Well. I'll be off, then. Look me up if you need me.", "close_window",
    [
      (troop_set_slot, "$g_talk_troop", slot_troop_occupation, 0),
      (troop_set_slot, "$g_talk_troop", slot_troop_playerparty_history, pp_history_dismissed),
      (remove_member_from_party, "$g_talk_troop"),
  ]],
  
  
  [anyone|plyr,"member_talk", [], "I'd like to ask you something.", "member_question",[]],
  
  [anyone|plyr,"member_talk", [], "Never mind.", "close_window",[]],
  
  [anyone,"member_question", [], "Very well. What did you want to ask?", "member_question_2",[]],
  
  [anyone|plyr,"member_question_2", [], "How do you feel about the way things are going in this company?", "member_morale",[]],
  [anyone|plyr,"member_question_2", [], "Tell me your story again.", "member_background_recap",[]],
  [anyone|plyr,"member_question_2", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_kingsupport_state, 0),
      ], "I suppose you know that I aspire to be {king/queen} of this land?", "member_kingsupport_1",[]],
  
  [anyone|plyr,"member_question_2", [
      ], "Do you have any connections that we could use to our advantage?", "member_intelgathering_1",[]],
  
  [anyone|plyr,"member_question_2", [
      (faction_slot_eq, "$players_kingdom", slot_faction_leader, "trp_player"),
      ], "Would you be interested in holding a fief?", "member_fief_grant_1",[]],
  
  
  [anyone,"member_morale", [
      (call_script, "script_npc_morale", "$g_talk_troop"),
      ], "{s21}", "do_member_trade",[]],
  
  [anyone,"member_background_recap", [
      (troop_get_slot, ":first_met", "$g_talk_troop", slot_troop_first_encountered),
      (str_store_party_name, 20, ":first_met"),
      (troop_get_slot, ":home", "$g_talk_troop", slot_troop_home),
      (str_store_party_name, 21, ":home"),
      (troop_get_slot, ":recap", "$g_talk_troop", slot_troop_home_recap),
      (str_store_string, 5, ":recap"),
      ], "{s5}", "member_background_recap_2",[]],
  
  [anyone,"member_background_recap_2", [
      (str_clear, 19),
      (troop_get_slot, ":background", "$g_talk_troop", slot_troop_backstory_b),
      (str_store_string, 5, ":background"),
      ], "{s5}", "member_background_recap_3",[]],
  
  [anyone,"member_background_recap_3", [
      ], "Then shortly after, I joined up with you.", "do_member_trade",[]],
  
  [anyone,"do_member_view_char", [], "Anything else?", "member_talk",[]],
  
  
  [anyone,"member_kingsupport_1", [
      (troop_get_slot, ":morality_grievances", "$g_talk_troop", slot_troop_morality_penalties),
      (gt, ":morality_grievances", 10),
      ], "Um... Yes. I had heard.", "do_member_trade",[]],
  
  [anyone,"member_kingsupport_1", [
      (store_sub, ":npc_no", "$g_talk_troop", "trp_npc1"),
      (store_add, ":string", "str_npc1_kingsupport_1", ":npc_no"),
      #		 (troop_get_slot, ":string", "$g_talk_troop", slot_troop_kingsupport_string_1),
      (str_store_string, s21, ":string"),
      ], "{s21}", "member_kingsupport_1a",[]],
  
  [anyone|plyr,"member_kingsupport_1a", [
      ], "Would you then support my cause?", "member_kingsupport_2",[]],
  
  [anyone|plyr,"member_kingsupport_1a", [
      ], "Very good. I shall keep that in mind.", "do_member_trade",[]],
  
  
  [anyone,"member_kingsupport_2", [
      (assign, ":companion_already_on_mission", -1),
      (try_for_range, ":companion", companions_begin, companions_end),
        (troop_slot_eq, ":companion", slot_troop_occupation, slto_player_companion),
        (troop_get_slot, ":days_on_mission", ":companion", slot_troop_days_on_mission),
        (gt, ":days_on_mission", 17),
        (neg|main_party_has_troop, ":companion"),
        (assign, ":companion_already_on_mission", ":companion"),
      (try_end),
      
      (gt, ":companion_already_on_mission", -1),
      (troop_get_slot, ":honorific", "$g_talk_troop", slot_troop_honorific),
      (str_store_string, s21, ":honorific"),
      (str_store_troop_name, s22, ":companion_already_on_mission"),
      
      ], "I would, {s21}. Moreover, I have a proposal on how I might help you attain your throne. But you recently sent {s22} off on a similar mission. Perhaps we should wait for a couple of weeks to avoid drawing too much attention to ourselves.", "do_member_trade",[]],
  
  
  [anyone,"member_kingsupport_2", [
      (store_sub, ":npc_no", "$g_talk_troop", "trp_npc1"),
      (store_add, ":string", "str_npc1_kingsupport_2", ":npc_no"),
      #		 (troop_get_slot, ":string", "$g_talk_troop", slot_troop_kingsupport_string_2),
      (str_store_string, s21, ":string"),
      ], "{s21}", "member_kingsupport_2a",[]],
  
  [anyone|plyr,"member_kingsupport_2a", [
      (store_sub, ":npc_no", "$g_talk_troop", "trp_npc1"),
      (store_add, ":string", "str_npc1_kingsupport_2a", ":npc_no"),
      #  		 (troop_get_slot, ":string", "$g_talk_troop", slot_troop_kingsupport_string_2a),
      (str_store_string, s21, ":string"),
      ], "{s21}", "member_kingsupport_3",[]],
  
  [anyone|plyr,"member_kingsupport_2a", [
      (store_sub, ":npc_no", "$g_talk_troop", "trp_npc1"),
      (store_add, ":string", "str_npc1_kingsupport_2b", ":npc_no"),
      #    	 (troop_get_slot, ":string", "$g_talk_troop", slot_troop_kingsupport_string_2b),
      (str_store_string, s21, ":string"),
      
      ], "{s21}", "do_member_trade",[]],
  
  [anyone,"member_kingsupport_3", [
      (store_sub, ":npc_no", "$g_talk_troop", "trp_npc1"),
      (store_add, ":string", "str_npc1_kingsupport_3", ":npc_no"),
      #		 (troop_get_slot, ":string", "$g_talk_troop", slot_troop_kingsupport_string_3),
      (str_store_string, s21, ":string"),
      ], "{s21}", "member_kingsupport_3a",[]],
  
  
  [anyone|plyr,"member_kingsupport_3a", [
      ], "Very good. You do that", "member_kingsupport_4",[
  ]],
  
  [anyone|plyr,"member_kingsupport_3a", [
      ], "On second thought, stay with me for a while", "do_member_trade",[]],
  
  [anyone,"member_kingsupport_4", [
      (troop_set_slot, "$g_talk_troop", slot_troop_days_on_mission, 21),
      (troop_set_slot, "$g_talk_troop", slot_troop_current_mission, npc_mission_kingsupport),
      
      (remove_member_from_party, "$g_talk_troop", "p_main_party"),
      
      (troop_get_slot, ":string", "$g_talk_troop", slot_troop_honorific),
      (str_store_string, s21, ":string"),
      
      ], "Farewell then, {s21}, for a little while", "close_window",[]],
  
  [anyone,"member_intelgathering_1", [
      (troop_get_slot, ":town_with_contacts", "$g_talk_troop", slot_troop_town_with_contacts),
      (str_store_party_name, s17, ":town_with_contacts"),
      (store_faction_of_party, ":contact_town_faction", ":town_with_contacts"),
      (str_store_faction_name, s18, ":contact_town_faction"),
      
      (store_sub, ":npc_no", "$g_talk_troop", "trp_npc1"),
      (store_add, ":connections_string", "str_npc1_intel_mission", ":npc_no"),
      (str_store_string, s21, ":connections_string"),
      ], "{s21}", "member_intelgathering_3",[]],
  
  [anyone,"member_intelgathering_3", [ #change back to member_intelgathering_2 if this will be used
      (eq, 1, 0),
      ], "Of course, as few people should know of this as possible. If you want to collect the information, or pull me out, then don't send a messenger. Come and get me yourself -- even if that means you have to sneak through the gates.", "member_intelgathering_3",[]],
  
  [anyone|plyr,"member_intelgathering_3", [
      ], "Splendid idea -- you do that.", "member_intelgathering_4",[]],
  
  [anyone|plyr,"member_intelgathering_3", [
      ], "Actually, hold off for now.", "do_member_trade",[]],
  
  [anyone,"member_intelgathering_4", [
      (troop_set_slot, "$g_talk_troop", slot_troop_days_on_mission, 5),
      (troop_set_slot, "$g_talk_troop", slot_troop_current_mission, npc_mission_gather_intel),
      
      (remove_member_from_party, "$g_talk_troop", "p_main_party"),
      
      (troop_get_slot, ":string", "$g_talk_troop", slot_troop_honorific),
      (str_store_string, s21, ":string"),
      
      ], "Good. I should be ready to report in about five days. Farewell then, {s21}, for a little while.", "close_window",[]],
  
  
  #1429 dialogues +
  [anyone,"start", [(eq, "$g_talk_troop", "trp_paris_merchant"),
    ],
    "Messire,regardez ces chevaux...", "march_bas_cartiers", []],
  [anyone|plyr,"march_bas_cartiers", [], "Je les voie marchand...", "regard_bas_cartiers",[]],
  [anyone|plyr,"march_bas_cartiers", [], "Tu appelle ca des chevaux ?", "regard_bas_cartiers",[]],
  
  [anyone,"regard_bas_cartiers", [],"Ho ils ne payent pas de mine,mais ils sont pas chers,je vous en pris messire,nous ne suportons plus la famine a cause de la guerre,ne m'obligez pas a manger mes chevaux,achetez les moi.", "oblig_bas_cartiers",[]],
  
  [anyone|plyr,"oblig_bas_cartiers", [], "Soit marchand...puis que tu tiens tant a tes chevaux,j'en prendrais grand soin.", "ventcheuvv_bas_cartiers",[]],
  [anyone|plyr,"oblig_bas_cartiers", [], "J'ai besoin d'un vrais cheval pour faire la guerre...bonne chance...", "close_window",[]],
  
  
  [anyone,"ventcheuvv_bas_cartiers", [],"Vraiment messire ?...ho comme je suis heureux!,je les es appellés,patriarche,colombe et Isabelle...", "cheuvv_bas_cartiers_pretalk",[[change_screen_trade]]],
  
  
  [anyone,"cheuvv_bas_cartiers_pretalk", [],"Prenez en un autre,je vous en prie.", "march_bas_cartiers2",[]],
  
  
  [anyone|plyr,"march_bas_cartiers2", [], "Je doit m'en aller...", "close_window",[]],
  
  
  
  
  
  #mendiant paris
  [anyone,"start", [(eq, "$g_talk_troop", "trp_paris_mendiant1"),
    ],
    "Monseigneur...une pièce pour un pauvre mendiant,ma femme as perdue la vue,quand a moi...non,ne craignez rien,je ne suis point pesteu je vous assure...", "mendiant_bas_cartiers", []],
  
  [anyone|plyr ,"mendiant_bas_cartiers", [      (store_current_hours,":cur_hours"),
      (val_sub, ":cur_hours", 48),
      (gt, ":cur_hours", "$gamble_last_time"),
      
      ],  "Bien sur,brave homme...Ma foi ne me permeterais pas de te laisser ainssi.", "mendiant1", []],
  [anyone|plyr ,"mendiant_bas_cartiers", [],  "Hors de ma vue lépreu....", "close_window", []],
  [anyone|plyr ,"mendiant_bas_cartiers", [],  "[partir]", "close_window", []],
  
  [anyone ,"mendiant1", [],"Ho! mon seigneur...vous etes si bon,permetez de vous demander la modique somme de 10 malheureux écus,vous sauverais un pauvre homme sur le point de mourir de faim.", "mendiant_reclame", []],
  [anyone|plyr ,"mendiant_reclame", [],  "Voila 20 écus.", "mendiant_reclame_2",
    [
      (troop_remove_gold,"trp_player",20),
      (call_script, "script_change_troop_renown", "trp_player", 1),
      (store_current_hours,":cur_hours"),
      (assign, "$gamble_last_time", ":cur_hours"),
  ]],
  [anyone|plyr ,"mendiant_reclame", [],  "Pour 20 écus?...je peut avoir un repas,du vin et une femme,adieu mandiant...", "close_window", []],
  [anyone ,"mendiant_reclame_2", [],"Merci,vous etes si brave mon Seigneur,je dirais a tout le monde a quel point vous etes généreux.", "close_window", []],
  ###ecurie
  [anyone,"start", [(eq, "$g_talk_troop", "trp_paris_formateurch"),
    ],
    "Vous voyez ce Cheval messire ? il n'es point donné a tout le monde de pouvoir le monter.", "dial_ecur_1", []],
  
  [anyone|plyr ,"dial_ecur_1", [],  "Et pourquois donc ?", "cheval_top1", []],
  [anyone|plyr ,"dial_ecur_1", [],  "Tans Mieu pour lui,adieu.", "close_window", []],
  
  
  [anyone ,"cheval_top1", [],"Les chevaux comme celui la,sont des dont de la nature,que seul un veritable maitre en dressage peut amener a son meilleur niveau,ils peuvent porter une armure de plates complete sans en ressentir le poix ajouté.", "dressage1", []],
  [anyone|plyr ,"dressage1", [],  "Impressionant.", "dial_impression", []],
  [anyone|plyr ,"dressage1", [],  "Je conais parfaitement les chevaux,ca ne m'impressione guerre.", "close_window", []],
  
  [anyone ,"dial_impression", [],"Je pourais vous aprendre a monter ces betes particulièrement difficiles a comprendre,contre une certaine somme naturellement,disons 1000 écus.", "dressagepaye1", []],
  
  [anyone|plyr ,"dressagepaye1", [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 1000),
    ],
    "C'es d'accord,il faut que je sache monter ce genre de chevaux coute que coute,il en va de ma salut.", "ok_fintraincheval",
    [
      (troop_remove_gold,"trp_player",1000),
  ]],
  [anyone|plyr ,"dressagepaye1", [],  "Je crain de ne pas avoir les moyens,mais je reviendrais.", "close_window", []],
  
  [anyone ,"ok_fintraincheval", [],"C'est tres bien,commencez par vous tenir droit,coment voullez vous faire corp avec un si noble animal,si vous avez vous meme si peut de souplesse...", "close_window",
    [
      (jump_to_menu, "mnu_training_horseparis"),
      (finish_mission),
  ]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_paris_vendeurchevauxtop"),
    ],
    "Qu'es ce qui vous amene a l'Ecurie Royale messire,vous désirez un cheval ? ou peut etre avez vous perdu votre chemin ?.", "dial_ecur_achat_1", []],
  
  [anyone|plyr ,"dial_ecur_achat_1", [],  "J'aimerais voir vos chevaux en effet,ils sont réputés dans toute la france.", "ecurie_vendok2", []],
  [anyone|plyr ,"dial_ecur_achat_1", [],  "Je voulais juste faire un tour.", "close_window", []],
  
  
  [anyone ,"ecurie_vendok2", [],"Normalement ils ne sont pas a vendre,mais le Regent a besoin d'or,alors il se sépare de quelques unes de ses meilleures montures.", "ecurie_preetalk",[[change_screen_trade]]],
  
  [anyone ,"ecurie_preetalk", [],"Il vous faut autre chose ?", "ecurie_encore", []],
  
  
  [anyone|plyr ,"ecurie_encore", [],  "Je voudrais revoir vos chevaux.", "ecurie_vendok2", []],
  [anyone|plyr ,"ecurie_encore", [],  "Non,j'en es assez vue.", "close_window", []],
  
  
  ################## ecuyer quete
  #fernier dial ecuyer
  [anyone,"start", [(eq, "$g_talk_troop", "trp_paris_ecuyer"),
      (eq, "$nouvddialecuyye", 1),
    ],
    "Encore merci pour le service, je serais bientot Chevalier et je ne me voyais pas devoir combattre sans l'épée de ma Maison.", "ecurie_retourvoir", []],
  [anyone|plyr ,"ecurie_retourvoir", [],  "Heureux d'avoir put etre utile.", "close_window", []],
  
  
  
  
  
  #win avec l'epee
  [anyone,"start", [(eq, "$g_talk_troop", "trp_paris_ecuyer"),
      (this_or_next|player_has_item,"itm_espee_ecuyer"),
      (troop_has_item_equipped,"trp_player","itm_espee_ecuyer"),
      (check_quest_active, "qst_crypt_sworr"),
      (neg|check_quest_succeeded, "qst_crypt_sworr"),
      (neg|check_quest_failed, "qst_crypt_sworr"),
      (neg|check_quest_finished, "qst_crypt_sworr"),
    ],
    "Avez vous mon épée Messire ?", "ecurie_ecuasitem", []],
  [anyone|plyr ,"ecurie_ecuasitem", [],  "La voici, mais elle es en mauvais état.", "ecurie_ecuasitem2",
    [
      (troop_remove_item, "trp_player","itm_espee_ecuyer"),
      (call_script, "script_end_quest", "qst_crypt_sworr"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",2),
      (call_script, "script_change_troop_renown", "trp_player", 2),
  ]],
  [anyone ,"ecurie_ecuasitem2", [],"Oui! c'est bien elle, la dérniere fois que je l'es vue j'etait encore enfant, tennez prennez ces 200 écus, et naturellement ne parlez a personne de votre expedition.", "ecurie_ecuasitem3",
    [
      (troop_add_gold, "trp_player", 200),
  ]],
  
  [anyone|plyr ,"ecurie_ecuasitem3", [],  "C'es pratiquement la somme que j'es due donner au garde.", "ecurie_ecuasitem4", []],
  
  [anyone ,"ecurie_ecuasitem4", [],"Je suis navré, mais je ne suis pas encore fortuné loing de la, dites vous qu'un homme pourra mourire avec son épée, c'est très important pour un Chevalier savez vous?", "close_window",
    [
      (assign, "$nouvddialecuyye", 1),
  ]],
  
  #en attente
  [anyone,"start", [(eq, "$g_talk_troop", "trp_paris_ecuyer"),
      (check_quest_active, "qst_crypt_sworr"),
      (neg|check_quest_succeeded, "qst_crypt_sworr"),
      (neg|check_quest_failed, "qst_crypt_sworr"),
      (neg|check_quest_finished, "qst_crypt_sworr"),
    ],
    "Avez vous mon épée Messire ?", "ecurie_ecuyerattat", []],
  [anyone|plyr ,"ecurie_ecuyerattat", [],  "Non, pas encore.", "close_window", []],
  
  [anyone|plyr ,"ecurie_ecuyerattat", [],  "Je ne veux plus m'en occuper, trouvez quelqu'un d'autre.", "ecurie_ecuyerattatno",
    [
      #fail et end quest
      (call_script, "script_fail_quest", "qst_crypt_sworr"),
      (call_script, "script_end_quest", "qst_crypt_sworr"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-2),
  ]],
  
  [anyone ,"ecurie_ecuyerattatno", [],"Je voie, hors de ma vue pleutre.", "close_window", []],
  
  
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_paris_ecuyer"),
    ],
    "Vous désirez ?", "ecurie_ecuyer", []],
  [anyone|plyr ,"ecurie_ecuyer", [],  "Puis je vous demander qui vous etes ? un chevalier ?.", "ecuyer_chevalier_ecurie", []],
  [anyone|plyr ,"ecurie_ecuyer", [],  "Rien,je voulais juste me réchauffer pret du feux.", "close_window", []],
  [anyone ,"ecuyer_chevalier_ecurie", [],"Ecuyer...je suis simplement ecuyer,mais je serais fait chevalier sous peut, j'ai d'ailleurs un service a vous demander a ce propos.", "dial_ecuyer_ecur", []],
  
  
  [anyone ,"dial_ecuyer_ecur", [],"Je partirais très bientot guerroyer, et je désire ardament avoir l'épée de mon ancestre, je suis sur qu'elle me portera chance au combat, pouriez vous me la ramener je vous prie, je vous donnerais 200 écus pour ce service, bien que vous pouriez la revendre plus chére, mais il va faloire que je vous fasse confiance.", "dial_ecuyer_ecur2", []],
  
  [anyone|plyr ,"dial_ecuyer_ecur2", [],  "Pourquois ne pas demander ceci a une personne de confiance justement ?", "dial_ecuyer_ecur23", []],
  
  [anyone ,"dial_ecuyer_ecur23", [],"Impossible, car l'on s'appercevrais que ma lignée a été rompue si ce n'es pas mon père qui m'as remis mon ?ée, mon père n'as pas pris les armes au nom de la famille, il etait...souffrant, il vous faudra alors chercher l'épée dans le tombeau de mon grand père, acceptez vous Messire ?", "dial_ecuyer_ecur25", []],
  
  [anyone|plyr ,"dial_ecuyer_ecur25", [],  "Soit, si vous en avez besoin...et pour 200 écus.", "dial_ecuyer_ecur25oke",
    [
      #lancer quete
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Un écuyer dans les quartiers des écuries de Paris m'a demandé de lui ramener son épée des catacombes, elle se trouve dans un un tombeau dans les cryptes profondes, il me donnera 200 écus si je parviens a la lui ramener."),
      (call_script, "script_start_quest", "qst_crypt_sworr", "$g_talk_troop"),
      
  ]],
  [anyone|plyr ,"dial_ecuyer_ecur25", [],  "Je reffuse d'aller dans un tombeau pour 200 écus, adieu.", "close_window", []],
  
  [anyone ,"dial_ecuyer_ecur25oke", [],"Je vous remercie de tout coeur, vous trouverez l'épée dans une tombe dans les cryptes des catacombes ici meme a Paris, seulement l'entrée es interdite, il vous faudra peut etre soudoyer le garde, dans ce cas je vous remboursserais. ramennez moi mon épée, je me sentirais nu sans elle sur le champ de bataille ou devans Dieu.", "close_window",[]],
  
  #dials dijon
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_dijon_moine_guer_troup"),
    ],
    "Salutations,Je suis le père Jacob,je dirige les hospices,et comme vous le voyez les batiments ne sufisent plus a contenir tous les bléssés de la guerre.nous ne fesont pas de distinction,Bourgignons,anglais ou meme francais,nous devons venir en aide aux mourants,mais que puis je faire pour vous ?", "Dijon_jacob1", []],
  
  [anyone|plyr ,"Dijon_jacob1", [],  "Je suis bléssé mon père,pouvez vous me soigner ?.", "dijon_soinsok", []],
  #blessures debut
  [anyone|plyr ,"Dijon_jacob1", [(eq, "$blesse_a_tete", 1),],  "Je suis bléssure a la tête, faites quelque chose je vous en prie.", "dijon_removebelesstete", []],
  [anyone|plyr ,"Dijon_jacob1", [(eq, "$blesse_au_bras", 1),],  "J'ai une bléssure au bras, pouvez vous faire quelque chose ?", "dijon_removebelessbras", []],
  [anyone|plyr ,"Dijon_jacob1", [(eq, "$blesse_a_jambe", 1),],  "J'ai une bléssure a la jambe, pouvez vous faire quelque chose ?", "dijon_removebelessjambe", []],
  
  #
  [anyone|plyr ,"Dijon_jacob1", [],  "Parlez moi de votre travail aux hospices.", "dijon_travailpere", []],
  [anyone|plyr ,"Dijon_jacob1",
    [
      (call_script, "script_party_count_members_with_full_health", "p_main_party"),
      (ge, reg0, 2),
    ],
    "Pouvez vous bénir mes hommes ? ce sont de braves soldats,et cela leur remonterais le moral de se savoir pret au pire.", "dijon_benirok", []],
  [anyone|plyr ,"Dijon_jacob1", [],  "Ne faites pas attention a moi,je fait juste une promenade.", "dijon_etrange", []],
  [anyone ,"dijon_etrange", [],"Etrange endroit pour se promener mon fils,etes vous saint d'ésprtit ? un de mes colléges a Metz pourais faire quelque chose pour vous si ce n'etait pas le cas.", "close_window", []],
  
  
  [anyone ,"dijon_soinsok", [],"Et bien,je n'ai pas le temp de soigner tout le monde vous vous en doutez,mais je peut faire un effort si vous me verssiez une compenssation de 200 écus,ca me permeterais d'acheter des vivres et des médicaments pour les bléssés.", "dijon_peresoinschers", []],
  [anyone|plyr ,"dijon_peresoinschers",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 200),
    ],
    "Tres bien,faites vite si possible,j'ai beaucoup a faire.", "dijon_pereblessur",
    [
      (troop_remove_gold,"trp_player",200),
  ]],
  [anyone ,"dijon_pereblessur", [],"Quelle vilaine bléssure,laissez moi faire...", "close_window",
    [
      (jump_to_menu, "mnu_generic_soins"),
      (finish_mission),
  ]],
  
  [anyone|plyr ,"dijon_peresoinschers", [],  "Je ne peut pas me le permetre.", "predial_dijonpere", []],
  
  #blessures debut reponsses azqsAZQS
  #tete
  [anyone ,"dijon_removebelesstete", [],"Seigneur! savez vous que vous avez le crane ouvert ? il faut refermer cette horible bléssure avant qu'elle ne s'infecte, cela vous coutera 200 écus je vous prie.", "dijon_removebelesstetepay", []],
  [anyone|plyr ,"dijon_removebelesstetepay",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 200),
    ],  "Tres bien, voici l'argent, faites vite, la douleure es insupportable.", "dijon_removebelessteteokn",
    [
      (troop_remove_gold,"trp_player",200),
  ]],
  [anyone|plyr ,"dijon_removebelesstetepay", [],  "Je n'ai pas la somme que vous demandez.", "dijon_removebelesstetenomon", []],
  [anyone ,"dijon_removebelesstetenomon", [],"Je suis navré, mais je ne puis rien faire dans ce cas.", "predial_dijonpere", []],
  
  [anyone ,"dijon_removebelessteteokn", [],"Bien, faites attention la prochaine fois, je ne veux plus revoir une telle bléssure.", "predial_dijonpere",
    [
      #redoner stat et remetre variable a 0
      (call_script, "script_rest_bless_tete"),
  ]],
  #tete fin !
  
  #bras
  [anyone ,"dijon_removebelessbras", [],"En effet, ceci es une bléssure de guerre, je ne vous demande pas de quel camp vous etes, ou meme si vous etes un brigand,je vous demanderais seulement si vous avez 100 écus pour payer les soins.", "dijon_removebelessbraspay", []],
  [anyone|plyr ,"dijon_removebelessbraspay",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 100),
    ],  "Tres bien, voici l'argent, faites vite, je peut a peine bouger le bras.", "dijon_removebelessbraspayokn",
    [
      (troop_remove_gold,"trp_player",100),
  ]],
  [anyone|plyr ,"dijon_removebelessbraspay", [],  "Je n'ai pas la somme que vous demandez.", "dijon_removebelessbraspayoknnomon", []],
  [anyone ,"dijon_removebelessbraspayoknnomon", [],"Je suis navré, mais je ne puis rien faire dans ce cas.", "predial_dijonpere", []],
  
  [anyone ,"dijon_removebelessbraspayokn", [],"Bien, faites attention la prochaine fois, que diriez vous d'acheter un bouclier ?", "predial_dijonpere",
    [
      #redoner stat et remetre variable a 0
      (call_script, "script_rest_bless_bras"),
  ]],
  #bras fin !
  
  
  #jambe
  [anyone ,"dijon_removebelessjambe", [],"Ca n'es point grave, cependant il faut netoyer la bléssure et changer le bandage régulièrement, les onguents et les bandages vous couterons 50 écus je vous prie.", "dijon_removebelessjambepay", []],
  [anyone|plyr ,"dijon_removebelessjambepay",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 50),
    ],  "Tres bien, voici l'argent, faites vite, je tiens a peine debout.", "dijon_removebelessjambepayokn",
    [
      (troop_remove_gold,"trp_player",50),
  ]],
  [anyone|plyr ,"dijon_removebelessjambepay", [],  "Je n'ai pas la somme que vous demandez.", "dijon_removebelessjambeon", []],
  [anyone ,"dijon_removebelessjambeon", [],"Je suis navré, mais je ne puis rien faire dans ce cas.", "predial_dijonpere", []],
  
  [anyone ,"dijon_removebelessjambepayokn", [],"Je vous recomande d'etre plus prudent, un peut de repos loing des combats vous ferais le plus grand bien.", "predial_dijonpere",
    [
      #redoner stat et remetre variable a 0
      (call_script, "script_rest_bless_jambe"),
  ]],
  #jambe fin !
  #
  
  [anyone ,"dijon_travailpere", [],"Il n'y a rien d'interéssant a dire je vous assure,l'armée m'amène ici des hommes et ils repartent pratiquement tous sur le chariot,la guerre fait beaucoup de dégats vous savez.", "predial_dijonpere", []],
  [anyone ,"predial_dijonpere", [],"Puis je faire autre chose pour vous aider ?", "Dijon_jacob1", []],
  
  [anyone ,"dijon_benirok", [],"Hum,comment refuser de benir ces hommes,si il devaient mourir au combat il faut qu'ils soient prets.je pourais le faire mais j'ai des obligations,je pourais peut etre me libérer contre une compenssation,une donation de 200 écus devrais faire l'affaire,cela nous permetra de comander des vivres et de quois soigner les nouveaux arivants.", "dijon_cher", []],
  [anyone|plyr ,"dijon_cher",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 200),
    ],
    "Entendu,mes hommes le mérite.", "dijon_benirokok",
    [
      (troop_remove_gold,"trp_player",200),
  ]],
  
  [anyone|plyr ,"dijon_cher", [],  "Je n'ai pas une telle somme.", "dijon_benirno", []],
  [anyone|plyr ,"dijon_cher", [],  "C'est bien trop cher pour une seule prière,etes vous vraiment religieux,ou banquier ?", "dijon_insultepere", []],
  
  [anyone ,"dijon_benirokok", [],"Tres bien,dans ce cas amenez moi a eux...", "close_window",
    [
      (jump_to_menu, "mnu_generic_benire"),
      (finish_mission),
  ]],
  
  [anyone ,"dijon_benirno", [],"Dans ce cas,je serais plus utile a soigner mes malades,je suis confus,mais je dois aller la ou je serais le plus utile.", "predial_dijonpere", []],
  [anyone ,"dijon_insultepere", [],"Surveillez vos paroles mon fils,tout le monde soufre dans tous les camps,pour ma part je ne peut pas aider tout le monde,je me suis fait a cette idée depuis bien longtemp.", "close_window", []],
  
  ##
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_dijon_moine_discut_troup"),
    ],
    "Qu'y a t'il mon frère ?", "dijon_freree", []],
  [anyone|plyr ,"dijon_freree", [],  "Pouvez vous me parler du père Jacob ?", "dijon_frerepere", []],
  [anyone|plyr ,"dijon_freree", [],  "Rien,je doit m'en aller.", "close_window", []],
  [anyone ,"dijon_frerepere", [],"Le père Jacob a beaucoup souffert ces dérniers temps,il a vue tous ses patiens mourir les uns apres les autres,la plupart d'entres eux etaient tellement mutilés qu'on ne pouvais rien faire,mais malgrés tout il s'en veux de ne pas avoir put les sauver..", "dial_dijon_frerefin", []],
  [anyone|plyr ,"dial_dijon_frerefin", [],  "Dites lui de tenir le coup,tout ca aura bien une fin.", "dijon_fin", []],
  [anyone ,"dijon_fin", [],"Je lui dirais,merci de votre gratitude.", "close_window", []],
  
  ##
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_dijon_blesse_troop"),
    ],
    "Il vous ont eu vous aussi ?", "dijon_blesse", []],
  [anyone|plyr ,"dijon_blesse", [],  "Qui ca ?", "dijon_francais", []],
  [anyone|plyr ,"dijon_blesse", [],  "Oui ils m'ont eu,je doit partir a present.", "close_window", []],
  [anyone ,"dijon_francais", [],"Cette question,ces chiens de francais bien sur,pour moi les combats sont terminés,je peut a peine marcher,le careau d'une arbalete a traverssé ma cuisse,c'etait pas beau a voir,mais pour vous ca a l'air d'aller...pour le moment en tout cas.", "dial_dijon_blessefin", []],
  [anyone|plyr ,"dial_dijon_blessefin", [], "En tout cas cette arbalete ne t'as pas transpercé la langue.", "dijon_finin", []],
  [anyone ,"dijon_finin", [],"Qu'es ce que ca veut dire ?.", "close_window", []],
  
  ##jacobins
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_jacobin_gueris"),
    ],
    "Quelle belle journée mon fils,n'est t'il pas ?", "jacobin_belle", []],
  
  [anyone|plyr ,"jacobin_belle", [],  "En effet mon père,il fait bon.", "jacobin_start", []],
  [anyone|plyr ,"jacobin_belle", [],  "Vous trouvez...vraiment?", "jacobin_mauvaistmp", []],
  [anyone ,"jacobin_mauvaistmp", [],"Mais bien sur mon fils,toutes les saisons sont belles quand ont es au service du seigneur,chaque saison donne une récolte différente,la pluie les fait pousser et le soleil leur donne parfum et aromes.", "jacobin_start", []],
  
  [anyone ,"jacobin_start", [],"Mais que venez vous faire au cloitre mon fils,voullez vous nous rejoindre ?", "jacobin_start2", []],
  [anyone ,"jacobin_predial", [],"Désirez vous savoir autre chose mon fils ?", "jacobin_start2", []],
  
  [anyone|plyr ,"jacobin_start2", [], "Je viens mander un guérisseur,je suis bléssé.", "jacobin_soinstart", []],
  
  #blessures debut
  [anyone|plyr ,"jacobin_start2", [(eq, "$blesse_a_tete", 1),],  "Je suis bléssure a la tête, faites quelque chose ca fait afreusement mal.", "jacobin_removebelesstete", []],
  [anyone|plyr ,"jacobin_start2", [(eq, "$blesse_au_bras", 1),],  "J'ai une bléssure au bras, j'ai grande peine a le bouger, pouvez vous faire quelque chose ?", "jacobin_removebelessbras", []],
  [anyone|plyr ,"jacobin_start2", [(eq, "$blesse_a_jambe", 1),],  "J'ai une bléssure a la jambe, pouvez vous la guérire ?", "jacobin_removebelessjambe", []],
  
  #
  
  [anyone|plyr ,"jacobin_start2", [], "Que faites vous de vos journées au cloitre ?.", "jacobin_rensgueriss", []],
  [anyone|plyr ,"jacobin_start2", [], "J'ai a faire ailleurs,mais je reviendrais.", "close_window", []],
  
  [anyone ,"jacobin_rensgueriss", [],"Et bien nous produisons de la cervoise,du fromage d'excellente qualité,un peut de vin,et je soigne moi meme les gens de la ville,nous subvenons a nos humbles besoin,et nous récoltons de l'argent pour en venir en aide aux malades et aux pauvres.", "jacobin_danger", []],
  [anyone|plyr ,"jacobin_danger", [], "Les anglois ne vont ont jamais attaqués ?.", "jacobin_dangerno", []],
  [anyone ,"jacobin_dangerno", [],"Ils ne l'oserais jamais,du moin nous l'ésèrons,la colère de Dieu s'abatterais sur eux.", "jacobin_predial", []],
  
  
  [anyone ,"jacobin_soinstart", [],"Et bien,je ne suis pas le meilleur médecin de france,mais je peut vous guérire d'une dent gatée ou cicatriser une bléssure grace a mes plantes,je vous demanderais une obole de 100 écus en retour.", "jacobin_soinokok", []],
  [anyone|plyr ,"jacobin_soinokok",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 100),
    ],
    "Faites de votre mieux,mais faites vite.", "jacobin_pereblessur",
    [
      (troop_remove_gold,"trp_player",100),
  ]],
  [anyone|plyr ,"jacobin_soinokok", [], "Je n'ai pas assez d'argent,je reviendrais.", "jacobin_predial", []],
  
  
  #blessures debut reponsses jacobins
  #tete
  [anyone ,"jacobin_removebelesstete", [],"Mon Dieu! savez vous que vous avez le crane ouvert ? il faut refermer cette horible bléssure avant qu'elle ne s'infecte, cela vous coutera 200 écus je vous prie.", "jacobin_removebelesstetepay", []],
  [anyone|plyr ,"jacobin_removebelesstetepay",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 200),
    ],  "Tres bien, voici l'argent, faites vite, je suis quelque peut désorienté.", "jacobin_removebelessteteokn",
    [
      (troop_remove_gold,"trp_player",200),
  ]],
  [anyone|plyr ,"jacobin_removebelesstetepay", [],  "Je n'ai pas cette somme sur moi.", "jacobin_removebelesstetenomon", []],
  [anyone ,"jacobin_removebelesstetenomon", [],"Je suis navré, mais je ne puis rien faire dans ce cas.", "jacobin_predial", []],
  
  [anyone ,"jacobin_removebelessteteokn", [],"Bien, faites attention la prochaine fois, vous vennez de tutoyer la mort.", "jacobin_predial",
    [
      #redoner stat et remetre variable a 0
      (call_script, "script_rest_bless_tete"),
  ]],
  #tete fin !
  
  #bras
  [anyone ,"jacobin_removebelessbras", [],"En effet, une affreuse bléssure que voila. avez 100 écus pour payer les soins.", "jacobin_removebelessbraspay", []],
  [anyone|plyr ,"jacobin_removebelessbraspay",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 100),
    ],  "Tres bien, voici l'argent, faites vite le sang ne cesse de s'écouler.", "jacobin_removebelessbraspayokn",
    [
      (troop_remove_gold,"trp_player",100),
  ]],
  [anyone|plyr ,"jacobin_removebelessbraspay", [],  "Je n'ai pas la somme que vous demandez.", "jacobin_removebelessbraspayoknnomon", []],
  [anyone ,"jacobin_removebelessbraspayoknnomon", [],"Je suis navré, mais je ne puis rien faire dans ce cas.", "jacobin_predial", []],
  
  [anyone ,"jacobin_removebelessbraspayokn", [],"Bien, faites attention la prochaine fois, ou vous perdrez vostre bras.", "jacobin_predial",
    [
      #redoner stat et remetre variable a 0
      (call_script, "script_rest_bless_bras"),
  ]],
  #bras fin !
  
  
  #jambe
  [anyone ,"jacobin_removebelessjambe", [],"Ca n'es point grave, cependant il faut netoyer la bléssure et changer le bandage régulièrement, les onguents et les bandages vous couterons 50 écus je vous prie.", "jacobin_removebelessjambepay", []],
  [anyone|plyr ,"jacobin_removebelessjambepay",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 50),
    ],  "Tres bien, voici l'argent, faites vite, je tiens a peine debout.", "jacobin_removebelessjambepayokn",
    [
      (troop_remove_gold,"trp_player",50),
  ]],
  [anyone|plyr ,"jacobin_removebelessjambepay", [],  "Je n'ai pas la somme que vous demandez.", "jacobin_removebelessjambeon", []],
  [anyone ,"jacobin_removebelessjambeon", [],"Je suis navré, mais je ne puis rien faire dans ce cas.", "jacobin_predial", []],
  
  [anyone ,"jacobin_removebelessjambepayokn", [],"Je vous recomande d'etre plus prudent, et déplacez vous a cheval pendant quelques temps.", "jacobin_predial",
    [
      #redoner stat et remetre variable a 0
      (call_script, "script_rest_bless_jambe"),
  ]],
  #jambe fin !
  
  
  [anyone|plyr ,"jacobin_soinokok", [], "Ou puis je trouver un meilleur médecin,sans vous ofensser...", "jacobin_infobest", []],
  [anyone ,"jacobin_infobest", [],"Ho il n'y a pas de mal,le meilleur médecin que je conaisse es le père Jacob a Dijon,c'est peut etre en teritoire ennemie,mais si vous etes souffrant,vous n'avez pas le choix.", "jacobin_predial", []],
  
  [anyone ,"jacobin_pereblessur", [],"Cessez de bouger mon fils,vous faite tomber mon couteau a chaques fois...", "close_window",
    [
      (jump_to_menu, "mnu_generic_soins_low"),
      (finish_mission),
  ]],
  ##
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_jacobin_benis"),
    ],
    "Salutations mon fils,que faites vous ici,voullez vous devenir moine ?", "jacobin_startbenis", []],
  
  [anyone|plyr ,"jacobin_startbenis",
    [
      (call_script, "script_party_count_members_with_full_health", "p_main_party"),
      (ge, reg0, 2),
    ],
    "J'es une troupe de soldats dont le morale es au plas bas,ils craignent pour le salut de leur ame,pouvez vous les benires..", "jacobin_benirok", []],
  
  [anyone ,"jacobin_benirok", [],"Et bien je ne doit pas quitter le cloitre,mais si vous les amenez ici je peut faire mon office,d'ailleur vous tombez bien,nos prières sont réputées dans toute la france,grace au miracle qu'il y a eu lieu il y a bien longtemp pret du chemin qui mene a la ville,je vous demanderais une somme de 400 écus,cela aidera grandement nos pauvres et nos malades.", "jacobin_cher", []],
  [anyone|plyr ,"jacobin_cher",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 400),
    ],
    "C'est une somme,mais mes hommes se sentierons beaucoup mieux apres ca,c'est d'accord.", "jacobinss_benirokok",
    [
      (troop_remove_gold,"trp_player",400),
  ]],
  
  [anyone|plyr ,"jacobin_cher", [],  "Je n'ai pas une telle somme.", "jacobin_predialbeniss", []],
  [anyone|plyr ,"jacobin_predialbeniss", [], "Que puis je faire de plus dans ce cas ?", "jacobin_startbenis", []],
  
  [anyone ,"jacobinss_benirokok", [],"Fort bien,amenez les moi ici...", "close_window",
    [
      (jump_to_menu, "mnu_generic_benire_high"),
      (finish_mission),
  ]],
  [anyone|plyr ,"jacobin_startbenis", [],  "Je vous laisse mon père,je doit moi meme me retirer pour réfléchire.", "close_window", []],
  ##
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_jacobin_vendor"),
    ],
    "Mon fils,goutez moi ce raisain,c'est le meilleur de toute la france,meme si tous les vignerons penssent la meme chose,en tout cas je n'en suis tres fier.", "jacobin_vendstart", []],
  [anyone|plyr,"jacobin_vendstart", [], "Produisez vous du vin ?", "jacobin_vendsitem",[]],
  [anyone|plyr,"jacobin_vendstart", [], "Je doit partir,une autre fois peut etre.", "close_window",[]],
  
  [anyone,"jacobin_vendsitem", [],"Oui,du vin et de la cervoise de tres bonne qualité,ainsi que du tres bon fromage que nous vendons en ville et aux pélerins.", "jacobin_vendsfin",[]],
  
  [anyone|plyr,"jacobin_vendsfin", [], "J'aimerais acheter vos produits.", "jacobin_vendus",[]],
  [anyone|plyr,"jacobin_vendsfin", [], "Y as t'il souvent des pèlerinages", "jacobin_pelerins",[]],
  [anyone|plyr,"jacobin_vendsfin", [], "J'en suis navré,mais je doit partir maintenant.", "close_window",[]],
  
  [anyone,"jacobin_vendus", [],"Mais bien entendu,regardez cette qualité.", "jacobinpredialvend",[[change_screen_trade]]],
  [anyone,"jacobinpredialvend", [],"Merci mon fils,vous fallait t'il autre chose ?.", "jacobin_vendsfin",[]],
  
  [anyone,"jacobin_pelerins", [],"Tous les ans a la saint jacques,les pèlerins de toute la france prenent le chemin de saint jaques de compostelle,beaucoup d'entres eux font une halte dans notre cloitre,les pèlerins sont reconaissables a leur coquille blanche,cousue sur leurs chapeaux,voullez vous savoir autre chose ?.  .", "jacobin_vendsfin",[]],
  
  ##
  [anyone,"start", [(eq, "$g_talk_troop", "trp_jacobin_chief"),
    ],
    "Bienvenue dans notre cloitre mon fils,ou il règne la bonne hummeur comme vous avez due vous en rendre compte,que puis je faire pour vous ?", "jacobinchief_start", []],
  
  [anyone|plyr ,"jacobinchief_start",
    [
      (check_quest_active, "qst_conffes_chevalier"),
      (neg|check_quest_succeeded, "qst_conffes_chevalier"),
    ],
    "Pouvez vous me conffesser mon père ?", "jacobinchief_conffeess", []],
  [anyone|plyr ,"jacobinchief_start", [],  "J'ai besoin d'aide.", "jacobinchief_help", []],
  [anyone|plyr ,"jacobinchief_start", [],  "Rien merci,je doit partir au plus vite.", "close_window", []],
  
  [anyone ,"jacobinchief_help", [],"Je vous aiderais avec grand plaisir mon fils,de quois s'agit t'il ?", "jacobinchief_helpok", []],
  
  [anyone|plyr ,"jacobinchief_helpok", [],  "J'ai besoin d'un médecin.", "jacobinchief_helpmedic", []],
  [anyone|plyr ,"jacobinchief_helpok", [],  "Avez vous des vivres a vendre ?", "jacobinchief_helpvend", []],
  [anyone|plyr ,"jacobinchief_helpok", [],  "Un pretre peut t'il benire ma troupe ?", "jacobinchief_helpbenir", []],
  [anyone|plyr ,"jacobinchief_helpok", [],  "Ca sera tout merci.", "close_window", []],
  
  [anyone ,"jacobinchief_helpmedic", [],"Le père Michel soignent les gens de la villes,adressez vous a lui si vous etes soufrant,il fait de son mieux le pauvre,ne lui en veuillez pas si vous n'etes pas complétement satisfais.", "jacobinchief_help", []],
  [anyone ,"jacobinchief_helpvend", [],"Demandez au père Jacques,il as surement des résérves a vendre,vous le trouverez dans le jardin.", "jacobinchief_help", []],
  [anyone ,"jacobinchief_helpbenir", [],"Adressez vous au père Guillaume,il poura peut etre vous venir en aide.", "jacobinchief_help", []],
  [anyone ,"jacobinchief_conffeess", [],"Certainement mon fils, vous avez l'air pressé si je puis me permetre, pourquois une telle impatience, avez vous commis un crime ?", "close_window",
    ############ menu conffess########################### benire_high
    [
      (call_script, "script_succeed_quest", "qst_conffes_chevalier"),
      (jump_to_menu, "mnu_conffes"),
      (finish_mission),
  ]],
  
  ##soeurs
  [anyone,"start", [(eq, "$g_talk_troop", "trp_soeur_2d"),
    ],
    "Grand Dieu ! comment etes vous arivé jusqu'ici mon frère ?", "quarantine_sister1", []],
  [anyone|plyr ,"quarantine_sister1", [],  "que se passe t'il ici ?.", "quarantine_dangerf", []],
  [anyone|plyr ,"quarantine_sister1", [],  "J'ai due me perdre,au revoir.", "close_window", []],
  [anyone ,"quarantine_dangerf", [],"Vous feriez mieux de parler a la mère supérieure au plus vite", "close_window", []],
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_soeur_4d"),
    ],
    "Partez d'ici,je vous en conjure...", "close_window", []],
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_soeur_1d"),
    ],
    "Que faites vous encore la ? avez vous parlé a la mère supérieure ?", "quarantine_parlermeresup", []],
  [anyone|plyr ,"quarantine_parlermeresup", [],  "Qu'y as t'il ?.", "quarantine_soeurexpliq", []],
  [anyone|plyr ,"quarantine_parlermeresup", [],  "J'y vais de ce pas.", "close_window", []],
  
  [anyone ,"quarantine_soeurexpliq", [],"Nous sommes contagieuses,une épidémie de peste s'est déclarée,il y a longtemps,depuis les habitants de ce quartiers l'ont abandoné,ils voulaient mettre le feux a l'abbaye pour éradiquer le mel,mais ils n'ont pas osé de peur que cela provoque la collére de dieu et étende l'épidémie.", "quarantine_question", []],
  
  [anyone|plyr ,"quarantine_question", [],  "Mais de quois vivez vous ?.", "quarantine_vivres", []],
  [anyone|plyr ,"quarantine_question", [],  "Je doit partir avant qu'il soit trop tard,bonne chance.", "quarantineclose", []],
  [anyone ,"quarantineclose", [],"Priez pour nous mon frére.", "close_window", []],
  
  [anyone ,"quarantine_vivres", [],"Les villageois nous apporte tous les jours un panier de provisions,depuis maintenant longtemp il aivaient glissé une lettre a l'intérieur d'un panier a provisions,cette lettre disait que si nous ne prenions pas le panier avant la tombée du jour c'est que nous etions toutes mortes,et qu'ils metteraient le feux au quartier si ca arivais,depuis tout ce temp nous continuons a le ramasser et nous survivons,mais beaucoup de nos soeurs sont mortes.", "quarantine_mortes", []],
  
  [anyone|plyr ,"quarantine_mortes", [],  "Mais depuis tout ce temps,vous etes toutes vivantes,l'épidémie es peut etre passée ?.", "quarantine_doute", []],
  [anyone|plyr ,"quarantine_mortes", [],  "Je ne resterais pas un instant de plus,adieu.", "close_window", []],
  [anyone ,"quarantine_doute", [],"L'épidémie serais terminée dites vous ? c'est étrange que nous n'y avions pas penssé.mais comment en etre sur ? si nous sortions nous allons peut etre provoquer la mort de tous les villageois,nous ne pouvont pas courir ce risque.", "close_window", []],
  
  
  
  #mere/guerisseur une fois amis
  [anyone,"start", [(eq, "$g_talk_troop", "trp_soeur_3d"),
      (eq, "$guerisseur_marsami", 1),
    ],
    
    "Vous voila de retour ? que pouvons nous faire pour nostre ami qui n'as point peur de nous ?", "quarsuit_meresupquestiong", []],
  
  
  [anyone|plyr ,"quarsuit_meresupquestiong", [],  "Je me doute que vous avez vos problèmes,mais je suis bléssé,pouvez vous me soigner ?", "quarsuiit_meresoinstart", []],
  #blessures debut
  [anyone|plyr ,"quarsuit_meresupquestiong", [(eq, "$blesse_a_tete", 1),],  "Je suis bléssure a la tête, faites quelque chose je vous en prie.", "quarsuiit_removebelesstete", []],
  [anyone|plyr ,"quarsuit_meresupquestiong", [(eq, "$blesse_au_bras", 1),],  "J'ai une bléssure au bras, pouvez vous faire quelque chose ?.", "quarsuiit_removebelessbras", []],
  [anyone|plyr ,"quarsuit_meresupquestiong", [(eq, "$blesse_a_jambe", 1),],  "J'ai une bléssure a la jambe, pouvez vous faire quelque chose ?.", "quarsuiit_removebelessjambe", []],
  #
  [anyone|plyr ,"quarsuit_meresupquestiong", [],  "Je venais juste vous saluer, je dois m'en aller a présent.", "close_window", []],
  
  #
  [anyone ,"quarsuiit_meresoinstart", [],"Bien entendu mon ami, quelles affreuses bléssures...", "close_window",
    [
      (jump_to_menu, "mnu_generic_soins"),
      (finish_mission),
  ]],
  #
  #blessures debut reponsses azqs
  #tete
  [anyone ,"quarsuiit_removebelesstete", [],"Seigneur! savez vous que vous avez le crane ouvert ? il faut refermer cette horible bléssure avant qu'elle ne s'infecte, cela ne vous coutera 100 écus je vous prie.", "quarsuiit_removebelesstetepay", []],
  [anyone|plyr ,"quarsuiit_removebelesstetepay",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 100),
    ],  "Tres bien, voici l'argent, faites vite, la doulleure es inssuportable.", "quarsuiit_removebelessteteokn",
    [
      (troop_remove_gold,"trp_player",100),
  ]],
  [anyone|plyr ,"quarsuiit_removebelesstetepay", [],  "Je n'ai pas la somme que vous demandez.", "quarsuiit_removebelesstetenomon", []],
  [anyone ,"quarsuiit_removebelesstetenomon", [],"Je suis navré, mais je ne puis rien faire dans ce cas, je ne pourais pas remplacer ces médicaments si je n'ai point d'argent en retour, et nous sommes si nmalades ici.", "close_window", []],
  
  [anyone ,"quarsuiit_removebelessteteokn", [],"Bien, faites attention la prochaine fois, je ne veux plus revoir une telle bléssure.", "close_window",
    [
      #redoner stat et remetre variable a 0
      (call_script, "script_rest_bless_tete"),
  ]],
  #tete fin !
  
  #bras
  [anyone ,"quarsuiit_removebelessbras", [],"En effet, ceci es une bléssure de guerre, je ne vous demande pas de quel camp vous etes, ou meme si vous etes un brigand,je vous demanderais seulement si vous avez 50 écus pour payer les soins.", "quarsuiit_removebelessbraspay", []],
  [anyone|plyr ,"quarsuiit_removebelessbraspay",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 50),
    ],  "Tres bien, voici l'argent, faites vite, je peut a peine bouger le bras.", "quarsuiit_removebelessbraspayokn",
    [
      (troop_remove_gold,"trp_player",50),
  ]],
  [anyone|plyr ,"quarsuiit_removebelessbraspay", [],  "je n'ai pas la somme que vous demandez.", "quarsuiit_removebelessbraspayoknnomon", []],
  [anyone ,"quarsuiit_removebelessbraspayoknnomon", [],"Je suis navré, mais je ne puis rien faire dans ce cas, je ne pourais pas remplacer ces médicaments si je n'ai point d'argent en retour, et nous sommes si nmalades ici.", "close_window", []],
  
  [anyone ,"quarsuiit_removebelessbraspayokn", [],"Bien, faites attention la prochaine fois, que diriez vous d'acheter un bouclier ?", "close_window",
    [
      #redoner stat et remetre variable a 0
      (call_script, "script_rest_bless_bras"),
  ]],
  #bras fin !
  
  
  #jambe
  [anyone ,"quarsuiit_removebelessjambe", [],"Ca n'es point grave, cependant il faut netoyer la bléssure et changer le bandage régulièrement, les onguents et les bandages vous couterons 10 écus je vous prie.", "quarsuiit_removebelessjambepay", []],
  [anyone|plyr ,"quarsuiit_removebelessjambepay",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 10),
    ],  "Tres bien, voici l'argent, faites vite, je tiens a peine debout.", "quarsuiit_removebelessjambepayokn",
    [
      (troop_remove_gold,"trp_player",10),
  ]],
  [anyone|plyr ,"quarsuiit_removebelessjambepay", [],  "je n'ai pas la somme que vous demandez.", "quarsuiit_removebelessjambeon", []],
  [anyone ,"quarsuiit_removebelessjambeon", [],"Je suis navré, mais je ne puis rien faire dans ce cas, je ne pourais pas remplacer ces médicaments si je n'ai point d'argent en retour, et nous sommes si nmalades ici.", "close_window", []],
  
  [anyone ,"quarsuiit_removebelessjambepayokn", [],"Je vous recomande d'etre plus prudent, un peut de repos loing des combats vous ferais le plus grand bien.", "close_window",
    [
      #redoner stat et remetre variable a 0
      (call_script, "script_rest_bless_jambe"),
  ]],
  #jambe fin !
  
  
  #mere/guerisseur
  [anyone,"start", [(eq, "$g_talk_troop", "trp_soeur_3d"),
    ],
    "Qui etes vous ? et que faites vous ici ? ?", "quarantine_meresupquestiong", []],
  [anyone|plyr ,"quarantine_meresupquestiong", [],  "je me nome {playername},de quels tourments souffrez vous ma mère ?", "quarantine_mereexpliq", []],
  [anyone|plyr ,"quarantine_meresupquestiong", [],  "Je me doute que vous avez des problèmes,mais je suis bléssé,pouvez vous me soigner ?", "quarantine_meresoinstart", []],
  [anyone|plyr ,"quarantine_meresupquestiong", [],  "Tout ca sent les histoires a plein nez,je préfére m'en aller.", "close_window", []],
  [anyone ,"quarantine_mereexpliq", [],"La peste s'est abattue ici,dans cette ville,elle as comencée a se propager dans nos murs,dieu seul sait comment,et nous vivons ici,recluses,mais comment diable etes vous rentré,nous sommes censsés avoir bloqué le passage jusqu'au cloitre,vous devez partir au plus vite quois qu'il en soit,il en va de votre vie.", "quarantine_bloquer", []],
  
  [anyone|plyr ,"quarantine_bloquer", [],  "Vous n'avais pas suffisament bloqué le passage,j'ai put me frayer un chemin.", "quarantine_meresoinstartcc", []],
  [anyone|plyr ,"quarantine_bloquer", [],  "Je m'en vais.", "close_window", []],
  [anyone ,"quarantine_meresoinstartcc", [], "Pardonez nous dans ce cas,mais maintenant vous devez partir,fuyez.", "close_window", []],
  [anyone ,"quarantine_meresoinstart", [], "Mais...ne craignez vous donc pas d'atraper la peste?", "close_qurantinepeste", []],
  [anyone|plyr ,"close_qurantinepeste", [],  "Je suis certain de ne courir aucun risque,croyez moi.", "quarantine_crainno", []],
  [anyone|plyr ,"close_qurantinepeste", [],  "C'est une mauvaise idée,en effet,je pensse que je devrais partir.", "close_window", []],
  
  [anyone ,"quarantine_crainno", [],"Tres bien comme vous voudrez,je comprend que vous n'avez pas le choix,je peut vous soigner,mais a une condition,nous avons besoin de pain,donner nous du pain et je vous remetrais en etat.", "merequarantine_soinokokfin", []],
  
  [anyone|plyr ,"merequarantine_soinokokfin",
    [
      (player_has_item, "itm_bread"),
    ],
    "Voici votre pain,remettez moi sur pied je vous prie.", "merequarantine_soinokokfinfinfingg",
    [
      (troop_remove_item, "trp_player", "itm_bread"),
  ]],
  [anyone|plyr ,"merequarantine_soinokokfin", [],  "Je n'en es pas,mais je reviens avec votre pain au plus vite.", "close_window", []],
  
  [anyone ,"merequarantine_soinokokfinfinfingg", [],"Je n'ai jamais vue de telles bléssures...", "close_window",
    [
      (jump_to_menu, "mnu_generic_soins"),
      (finish_mission),
      (assign, "$guerisseur_marsami", 1),
  ]],
  #
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_limoge_artisant1"),
    ],
    "La taverne n'es pas encore ouverte,repassez plus tard.", "limoge_ingtaverne", []],
  [anyone|plyr ,"limoge_ingtaverne", [],  "Etes vous l'aubergiste ?", "limoge_ingtaverneno", []],
  [anyone|plyr ,"limoge_ingtaverne", [],  "Merci pour le rensseignement.", "close_window", []],
  [anyone ,"limoge_ingtaverneno", [],"Pas du tout,je suis menuisier.", "close_ingenieurlimog", []],
  [anyone|plyr ,"close_ingenieurlimog", [],  "Si la taverne es fermée que faite vous devans?", "close_ingenieurfine", []],
  [anyone|plyr ,"close_ingenieurlimog", [],  "Adieu,je doit m'en aller.", "close_window", []],
  [anyone ,"close_ingenieurfine", [],"Cette question,j'attend qu'elle ouvre..", "limoge_open", []],
  [anyone|plyr ,"limoge_open", [],  "Je vous shouaite réussite dans une telle entreprise.", "limogechance", []],
  [anyone ,"limogechance", [],"C'est ca.", "close_window", []],
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_limoge_artisant2"),
    ],
    "Belle piéce n'est ce pas?", "limoge_cordier", []],
  [anyone|plyr ,"limoge_cordier", [],  "Tres belle,et tres dangeureuse j'imagine.", "limoge_dangeureuse", []],
  [anyone|plyr ,"limoge_cordier", [],  "Pas mal,mais j'ai a faire.", "close_window", []],
  [anyone ,"limoge_dangeureuse", [],"C'est surtout efficace pour abattre un mur que des sapeurs ont préalablement fragilisé en creusant un tunel qui passe sous une fondation,ils y mette le feux et quand la première pierre touche le mur il s'effondre sur ceux qui s'etait protégés deriére.", "limog_conaissanc", []],
  [anyone|plyr ,"limog_conaissanc", [],  "Vous semblez vous y conaitre en arme de siege,pouvez vous me donner quelques indications?", "ingenieurcordierfine", []],
  [anyone|plyr ,"limog_conaissanc", [],  "Tres interessant,mais je doit m'en aller.", "close_window", []],
  
  [anyone ,"ingenieurcordierfine", [],"Je ne suis que cordier,adressez vous au maitre pour les détails.", "close_window", []],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_limoge_artisant3"),
    ],
    "Que puis je faire pour vous ? si c'est pour une comande je ne travaille que pour les seigneurs avec les quels j'ai passé un accord.", "limoge_accord", []],
  [anyone|plyr ,"limoge_accord", [],  "je voudrais juste apprendre a me servir d'armes de siège plus efficament.", "limoge_aprendre", []],
  [anyone|plyr ,"limoge_accord", [],  "Avez vous des armes qui sortent de l'ordinaire?", "limoge_big_gun", []],
  [anyone,"limoge_big_gun", [],"Et bien...je pensse que je peut vous faire confiance,mais encore faudras t'il payer le prix fort,ce sont de nouvelles armes tres puissantes et dangeureuses voyez vous?...", "prediallimoge_big_gun",[[change_screen_trade]]],
  [anyone ,"prediallimoge_big_gun", [],"Merci bien,j'ose simplement éspèrer que ces armes dévastatrices seront entre de bonnes mains.voyez vous elles ne sont efficaces qu'a une certaine distance,vous devriez les essayer dehors sur la cible pour vous rendre compte...voullez vous autre chose?", "limoge_accord", []],
  
  
  
  
  
  [anyone|plyr ,"limoge_accord", [],  "Je ne voudrais pas déranger,je m'en vais.", "close_window", []],
  [anyone ,"limoge_aprendre", [],"C'est donc ca,tres bien je peut vous ensseigner les details,contre 1000 écus,qu'en dites vous?", "limog_aprendreok", []],
  [anyone|plyr ,"limog_aprendreok", [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 1000),
    ],
    "Tres bien,voici l'or..", "ingenieurcordierfineokok",
    [
      (troop_remove_gold,"trp_player",1000),
  ]],
  [anyone|plyr ,"limog_aprendreok", [],  "Je n'ai pas 1000 écus,je reviendrais avec la somme.", "close_window", []],
  [anyone ,"ingenieurcordierfineokok", [],"Parfait,commencons du debut,pour vous quel es le meilleur moyen de franchir un mur?", "close_window",
    [
      (jump_to_menu, "mnu_training_ingenieur"),
      (finish_mission),
  ]],
  
  #TOUR  CASERNE
  [anyone,"start", [(eq, "$g_talk_troop", "trp_tour_caserne_1"),
    ],
    "Qu'y as t'il Messire ?.", "Tour_gardess1", []],
  [anyone|plyr ,"Tour_gardess1", [],  "Je cherche la taverne.", "tour_findtavern", []],
  [anyone|plyr ,"Tour_gardess1", [],  "Je ne voudrais pas déranger,je m'en vais.", "close_window", []],
  [anyone ,"tour_findtavern", [],"Vous n'y etes pas du tout,vous en etes meme tres loing,retournez a l'entré,et en haut des éscaliers,prenez a votre droite,et c'ast tout en bas avant le lavoir,n'oubliez pas de boire un vere pour moi quand vous serez la bas.", "tour_merci", []],
  [anyone|plyr ,"tour_merci", [],  "Merci mon brave.", "close_window", []],
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_tour_caserne_2"),
    ],
    "Je n'aime pas spécialement m'entrainer mais c'est indispenssable.", "Tour_gardess12", []],
  [anyone|plyr ,"Tour_gardess12", [],  "L'entrainement es indispenssable pour tout combatant qui souhaite vivre quelques temps.", "tour_vivre21", []],
  [anyone|plyr ,"Tour_gardess12", [],  "Bon courage.", "close_window", []],
  [anyone ,"tour_vivre21", [],"Je le sais bien,parfois je comprend les voleurs,pas besoin de s'échiner a la tache,ils prenent aux autres!.", "tour_voleursno11", []],
  [anyone|plyr ,"tour_voleursno11", [],  "Le sort que l'on résérve aux voleurs n'es point enviable a l'entrainement d'un garde.", "close_window", []],
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_tour_caserne_3"),
    ],
    "Navré Messire,mais si vous voullez acheter ces armes,elles ne sont pas a vendre.", "Tour_gardess13", []],
  [anyone|plyr ,"Tour_gardess13", [],  "Ce sont de bonnes lames a première vue.", "tour_premiervue1", []],
  [anyone|plyr ,"Tour_gardess13", [],  "Je ne fait que passer.", "close_window", []],
  [anyone ,"tour_premiervue1", [],"Ce sont de tres bonnes épées vous pouvez le croire,elles sont forgées dans la rue juste dérière,mais elles sont résérvées pour la garde.", "tour_reservegarde1", []],
  [anyone|plyr ,"tour_reservegarde1", [],  "Tans pis,adieu.", "close_window", []],
  
  
  
  #instructeur loose
  #######################
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_tour_caserne_4"),
      (eq, "$instructeurtourwin", -1),
    ],
    "Alors pas trop bléssé? en voullez vous encore?", "Tour_master_enccoorreess2", []],
  [anyone|plyr ,"Tour_master_enccoorreess2", [],  "Oui encore,ce qui ne tue pas rend plus fort.", "tour_bonaprentissloosspre2", []],
  [anyone|plyr ,"Tour_master_enccoorreess2", [],  "Ca ira je crois...", "close_window", []],
  
  
  [anyone ,"tour_bonaprentissloosspre2", [],"Je vous shouaite bonne chance.", "tour_bonaprentisslooss2",[]],
  
  
  [anyone|plyr ,"tour_bonaprentisslooss2", [],  "Pouvez vous m'apprendre a améliorer ma maitrise des armes a deux mains?.", "tours_demainss2", []],
  [anyone|plyr ,"tour_bonaprentisslooss2", [],  "Battons nous!", "tour_fights2", []],
  [anyone|plyr ,"tour_bonaprentisslooss2", [],  "Merci,mais je doit partir a present.", "close_window", []],
  [anyone ,"tour_fights2", [],"Fort bien,si quelques entorces ne vous font pas peur,je suis a vous.", "close_window",
    [
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 0, 2, 0),
      (team_set_relation, 0, 3, 0),
      (team_set_relation, 0, 4, 0),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 1, 3, 0),
      (team_set_relation, 1, 4, 0),
      (team_set_relation, 2, 3, -1),
      (team_set_relation, 2, 0, 0),
      (team_set_relation, 2, 1, 0),
      (team_set_relation, 2, 4, 0),
      (team_set_relation, 3, 2, -1),
      (team_set_relation, 3, 0, 0),
      (team_set_relation, 3, 1, 0),
      (team_set_relation, 3, 4, 0),
      (team_set_relation, 4, 0, 0),
      (team_set_relation, 4, 1, 0),
      (team_set_relation, 4, 2, 0),
      (team_set_relation, 4, 3, 0),
  ]],
  
  [anyone ,"tours_demainss2", [],"Hum...bien sur,si vous avez ce qu'il faut pour réussir et si vous avez de l'or,3000 écus ferons l'affaire.", "tourqbcpors2", []],
  
  [anyone|plyr ,"tourqbcpors2", [],  "Que pourez vous m'apprendre a ce prix?", "tour_prixdemainss2", []],
  [anyone|plyr ,"tourqbcpors2", [],  "Combien? non je reffuse.", "close_window", []],
  
  [anyone ,"tour_prixdemainss2", [],"Vous avez peut etre toujours désiré ne vous servir que d'une arme a deux mains sur le champ de bataille,mais vous vous etes dit que vous n'aurais pas l'avantage,que ces armes sont trop lourdes,je vous propose a ce prix de vous prouver le contraire et de vous ensseigner ce qu'il faut pour que vous soyez crain a travers tout le pays.", "tourqbcporokoks2", []],
  
  [anyone|plyr ,"tourqbcporokoks2", [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 3000),
    ],
    "C'est d'accord,cela me plait.", "tourtraindemainoks2",
    [
      (troop_remove_gold,"trp_player",3000),
  ]],
  
  [anyone|plyr ,"tourqbcporokoks2", [],  "Je ne peut pas payer une telle some.", "close_window", []],
  
  [anyone ,"tourtraindemainoks2", [],"Tres bien,commencez a pensser a quelque chose qui vous mette en colère...", "tourscollleres2",[]],
  
  [anyone|plyr ,"tourscollleres2", [],  "Comme par exemple le fait d'avoir perdu 3000 écus?", "close_window",
    [
      (jump_to_menu, "mnu_training_arme_deux_mains"),
      (finish_mission),
  ]],
  
  
  
  
  #instructeur win
  [anyone,"start", [(eq, "$g_talk_troop", "trp_tour_caserne_4"),
      (eq, "$instructeurtourwin", 1),
    ],
    "Ca alors! vous m'avez battu!..moi!...encore Messire,je ne puis rester sur une defaite devans mes hommes.", "Tour_master_enccoorreewi3", []],
  [anyone|plyr ,"Tour_master_enccoorreewi3", [],  "Oui,je vous donne votre revanche.", "tour_bonaprentisspre3", []],
  [anyone|plyr ,"Tour_master_enccoorreewi3", [],  "Je vais vous laisser...récuperer.", "close_window", []],
  
  
  [anyone ,"tour_bonaprentisspre3", [],"Cette fois,vous n'aurez pas une chance.", "tour_bonaprentiss3",[]],
  
  [anyone|plyr ,"tour_bonaprentiss3", [],  "Pouvez vous m'apprendre a améliorer ma maitrise des armes a deux mains?.", "tours_demains3", []],
  [anyone|plyr ,"tour_bonaprentiss3", [],  "Battons nous!", "tour_fight3", []],
  [anyone|plyr ,"tour_bonaprentiss3", [],  "Merci,mais je doit partir a present.", "close_window", []],
  [anyone ,"tour_fight3", [],"Fort bien,si quelques entorces ne vous font pas peur,je suis a vous.", "close_window",
    [
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 0, 2, 0),
      (team_set_relation, 0, 3, 0),
      (team_set_relation, 0, 4, 0),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 1, 3, 0),
      (team_set_relation, 1, 4, 0),
      (team_set_relation, 2, 3, -1),
      (team_set_relation, 2, 0, 0),
      (team_set_relation, 2, 1, 0),
      (team_set_relation, 2, 4, 0),
      (team_set_relation, 3, 2, -1),
      (team_set_relation, 3, 0, 0),
      (team_set_relation, 3, 1, 0),
      (team_set_relation, 3, 4, 0),
      (team_set_relation, 4, 0, 0),
      (team_set_relation, 4, 1, 0),
      (team_set_relation, 4, 2, 0),
      (team_set_relation, 4, 3, 0),
  ]],
  
  [anyone ,"tours_demains3", [],"Hum...bien sur,si vous avez ce qu'il faut pour réussir et si vous avez de l'or,3000 écus ferons l'affaire.", "tourqbcpor3", []],
  
  [anyone|plyr ,"tourqbcpor3", [],  "Que pourez vous m'apprendre a ce prix?", "tour_prixdemains3", []],
  [anyone|plyr ,"tourqbcpor3", [],  "Combien?non je reffuse.", "close_window", []],
  
  [anyone ,"tour_prixdemains3", [],"Vous avez peut etre toujours désiré ne vous servir que d'une arme a deux mains sur le champ de bataille,mais vous vous etes dit que vous n'aurais pas l'avantage,que ces armes sont trop lourdes,je vous propose a ce prix de vous prouver le contraire et de vous ensseigner ce qu'il faut pour que vous soyez crain a travers tout le pays.", "tourqbcporokok3", []],
  
  [anyone|plyr ,"tourqbcporokok3", [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 3000),
    ],
    "C'est d'accord,cela me plait.", "tourtraindemainok3",
    [
      (troop_remove_gold,"trp_player",3000),
  ]],
  
  [anyone|plyr ,"tourqbcporokok3", [],  "Je ne peut pas payer une telle some.", "close_window", []],
  
  [anyone ,"tourtraindemainok3", [],"Tres bien,commencez a pensser a quelque chose qui vous mette en colère...", "tourscolllere3",[]],
  
  [anyone|plyr ,"tourscolllere3", [],  "Comme par exemple le fait d'avoir perdu 3000 écus?", "close_window",
    [
      (jump_to_menu, "mnu_training_arme_deux_mains"),
      (finish_mission),
  ]],
  
  #entraineur
  [anyone,"start", [(eq, "$g_talk_troop", "trp_tour_caserne_4"),
    ],
    "Que puis je faire pour vous Messire ? si c'est pour se plaindre du tapage des hommes,sachez que je ne suis pas leur mère,je leur aprend seulement a tenir une épée.", "Tour_master_startt", []],
  [anyone|plyr ,"Tour_master_startt", [],  "Non,je me demandais si vous pouviez m'entrainer aussi.", "tour_entrainementpossible", []],
  [anyone|plyr ,"Tour_master_startt", [],  "Je doit partir.", "close_window", []],
  
  [anyone ,"tour_entrainementpossible", [],"Ca dépend...si vous avez les bonnes aptitudes,je peut vous aider a vous perfectioner,mais je ne suis pas la pour vous montrer comment on sort une épée de son foureau.", "tour_bonaprentis", []],
  
  
  [anyone|plyr ,"tour_bonaprentis", [],  "Pouvez vous m'apprendre a améliorer ma maitrise des armes a deux mains?.", "tours_demains", []],
  [anyone|plyr ,"tour_bonaprentis", [],  "Battons nous!", "tour_fight", []],
  [anyone|plyr ,"tour_bonaprentis", [],  "Merci,mais je doit partir a present.", "close_window", []],
  [anyone ,"tour_fight", [],"Fort bien,si quelques entorces ne vous font pas peur,je suis a vous.", "close_window",
    [
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 0, 2, 0),
      (team_set_relation, 0, 3, 0),
      (team_set_relation, 0, 4, 0),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 1, 3, 0),
      (team_set_relation, 1, 4, 0),
      (team_set_relation, 2, 3, -1),
      (team_set_relation, 2, 0, 0),
      (team_set_relation, 2, 1, 0),
      (team_set_relation, 2, 4, 0),
      (team_set_relation, 3, 2, -1),
      (team_set_relation, 3, 0, 0),
      (team_set_relation, 3, 1, 0),
      (team_set_relation, 3, 4, 0),
      (team_set_relation, 4, 0, 0),
      (team_set_relation, 4, 1, 0),
      (team_set_relation, 4, 2, 0),
      (team_set_relation, 4, 3, 0),
  ]],
  
  [anyone ,"tours_demains", [],"Hum...bien sur,si vous avez ce qu'il faut pour réussir et si vous avez de l'or,3000 écus ferons l'affaire.", "tourqbcpor", []],
  
  [anyone|plyr ,"tourqbcpor", [],  "Que pourez vous m'apprendre a ce prix?", "tour_prixdemains", []],
  [anyone|plyr ,"tourqbcpor", [],  "Combien?non je reffuse.", "close_window", []],
  
  [anyone ,"tour_prixdemains", [],"Vous avez peut etre toujours désiré ne vous servir que d'une arme a deux mains sur le champ de bataille,mais vous vous etes dit que vous n'aurais pas l'avantage,que ces armes sont trop lourdes,je vous propose a ce prix de vous prouver le contraire et de vous ensseigner ce qu'il faut pour que vous soyez crain a travers tout le pays.", "tourqbcporokok", []],
  
  [anyone|plyr ,"tourqbcporokok", [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 3000),
    ],
    "C'est d'accord,cela me plait.", "tourtraindemainok",
    [
      (troop_remove_gold,"trp_player",3000),
  ]],
  
  [anyone|plyr ,"tourqbcporokok", [],  "Je ne peut pas payer une telle some.", "close_window", []],
  
  [anyone ,"tourtraindemainok", [],"Tres bien,commencez a pensser a quelque chose qui vous mette en colère...", "tourscolllere",[]],
  
  [anyone|plyr ,"tourscolllere", [],  "Comme par exemple le fait d'avoir perdu 3000 écus?", "close_window",
    [
      (jump_to_menu, "mnu_training_arme_deux_mains"),
      (finish_mission),
  ]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_tour_caserne_5"),
    ],
    "Atention,reculez Messire ou vous risquez de vous faire trancher la gorge.", "tour_partir", []],
  [anyone|plyr ,"tour_partir", [],  "Faites un peut attention.", "close_window", []],
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_tour_caserne_6"),
    ],
    "En arière Messire.", "tourtraingorge", []],
  [anyone|plyr ,"tourtraingorge", [],  "Faites un peut attention.", "close_window", []],
  
  
  
  ####################### caserne lyon ##############################################
  
  #instructeur lyon loose
  #######################
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_lyon_caserne_4"),
      (eq, "$instructeurlyonwin", -1),
    ],
    "Alors c'es trop rapide ?", "lyon_master_enccoorreess2", []],
  [anyone|plyr ,"lyon_master_enccoorreess2", [],  "Je vais y arriver, je le sais.", "lyon_bonaprentissloosspre2", []],
  [anyone|plyr ,"lyon_master_enccoorreess2", [],  "Ca ira je crois...", "close_window", []],
  
  
  [anyone ,"lyon_bonaprentissloosspre2", [],"Je vous shouaite bonne chance.", "lyon_bonaprentissloosspre22",[]],
  
  
  [anyone|plyr ,"lyon_bonaprentissloosspre22", [],  "Pouvez vous m'apprendre a améliorer ma maitrise de lépée a une main et du bouclier en meme temps ?", "lyon_demainss2", []],
  [anyone|plyr ,"lyon_bonaprentissloosspre22", [],  "En garde!", "lyon_fights2", []],
  [anyone|plyr ,"lyon_bonaprentissloosspre22", [],  "Merci,mais je doit partir a present.", "close_window", []],
  [anyone ,"lyon_fights2", [],"C'es ca...", "close_window",
    [
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 0, 2, 0),
      (team_set_relation, 0, 3, 0),
      (team_set_relation, 0, 4, 0),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 1, 3, 0),
      (team_set_relation, 1, 4, 0),
      (team_set_relation, 2, 3, -1),
      (team_set_relation, 2, 0, 0),
      (team_set_relation, 2, 1, 0),
      (team_set_relation, 2, 4, 0),
      (team_set_relation, 3, 2, -1),
      (team_set_relation, 3, 0, 0),
      (team_set_relation, 3, 1, 0),
      (team_set_relation, 3, 4, 0),
      (team_set_relation, 4, 0, 0),
      (team_set_relation, 4, 1, 0),
      (team_set_relation, 4, 2, 0),
      (team_set_relation, 4, 3, 0),
  ]],
  
  [anyone ,"lyon_demainss2", [],"Vous voullez savoir comment les gardes Lyonnais font pour etre intouchables et pour riposter aussi vite hein ? et bien je peut vous ensseigner quelques coups pour 3000 écus, ca vous va ?", "lyonqbcpors2", []],
  
  [anyone|plyr ,"lyonqbcpors2", [],  "Que pourez vous m'apprendre a ce prix?", "lyon_prixdemainss2", []],
  [anyone|plyr ,"lyonqbcpors2", [],  "Combien? non je reffuse.", "close_window", []],
  
  [anyone ,"lyon_prixdemainss2", [],"Bon, certains vous dirons que la meilleure arme es la lance ou un marteau, ou encore une cruche couverte de bouze...envoyez les se faire foutre. le seul armement de guerre vallable es une épée et un bouclier, je peut vous apprendre a manier les deux en meme temps éfficacement...reste encore que pour découper une armure et le gueux qu'il y a dedans, tout compte fait le marteau ou le bec de corbin n'es pas si mal.", "lyonqbcporokoks2", []],
  
  [anyone|plyr ,"lyonqbcporokoks2", [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 3000),
    ],
    "C'est d'accord, je veux etre rapide !", "lyontraindemainoks2",
    [
      (troop_remove_gold,"trp_player",3000),
  ]],
  
  [anyone|plyr ,"lyonqbcporokoks2", [],  "Je ne peut pas payer une telle some.", "close_window", []],
  
  [anyone ,"lyontraindemainoks2", [],"Tres bien, vous devez commencer a prendre conscience que vous avez deux bras, un deffend et l'autre attaque...seulement il vous faudra pensser a la déffensse tandis que vous attaquer et pensser a l'attaque au moment ou vous déffendez.", "lyonscollleres2",[]],
  
  [anyone|plyr ,"lyonscollleres2", [],  "Je pensse que je saisie le truc.", "close_window",
    [
      (jump_to_menu, "mnu_training_arme_une_mains"),
      (finish_mission),
  ]],
  
  
  
  #instructeur win
  [anyone,"start", [(eq, "$g_talk_troop", "trp_lyon_caserne_4"),
      (eq, "$instructeurlyonwin", 1),
    ],
    "Foutre putain de Gueux ! comment avez vous réussis ? si jétait sur le champ de bataille je serais mort, encore...il ne faut pas rester sur une défaite.", "lyon_master_enccoorreewi3", []],
  [anyone|plyr ,"lyon_master_enccoorreewi3", [],  "Oui,je vous donne votre revanche.", "lyon_bonaprentisspre3", []],
  [anyone|plyr ,"lyon_master_enccoorreewi3", [],  "Je ne puis perdre plus de temp...navré pour votre amour propre.", "close_window", []],
  
  
  [anyone ,"lyon_bonaprentisspre3", [],"Cette fois, tu vera rien venire.", "lyon_bonaprentiss3",[]],
  
  [anyone|plyr ,"lyon_bonaprentiss3", [],  "Pouvez vous m'apprendre a améliorer ma maitrise de lépée a une main et du bouclier en meme temps ?", "lyon_demains3", []],
  [anyone|plyr ,"lyon_bonaprentiss3", [],  "En garde!", "lyon_fight3", []],
  [anyone|plyr ,"lyon_bonaprentiss3", [],  "Navré, mais je doit partir a present.", "close_window", []],
  [anyone ,"lyon_fight3", [],"En garde le gueux !", "close_window",
    [
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 0, 2, 0),
      (team_set_relation, 0, 3, 0),
      (team_set_relation, 0, 4, 0),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 1, 3, 0),
      (team_set_relation, 1, 4, 0),
      (team_set_relation, 2, 3, -1),
      (team_set_relation, 2, 0, 0),
      (team_set_relation, 2, 1, 0),
      (team_set_relation, 2, 4, 0),
      (team_set_relation, 3, 2, -1),
      (team_set_relation, 3, 0, 0),
      (team_set_relation, 3, 1, 0),
      (team_set_relation, 3, 4, 0),
      (team_set_relation, 4, 0, 0),
      (team_set_relation, 4, 1, 0),
      (team_set_relation, 4, 2, 0),
      (team_set_relation, 4, 3, 0),
  ]],
  
  [anyone ,"lyon_demains3", [],"Vous voullez savoir comment les gardes Lyonnais font pour etre intouchables et pour riposter aussi vite hein ? et bien je peut vous ensseigner quelques coups pour 3000 écus, ca vous va ?", "lyonqbcpor3", []],
  
  [anyone|plyr ,"lyonqbcpor3", [],  "Que pourez vous m'apprendre a ce prix?", "lyon_prixdemains3", []],
  [anyone|plyr ,"lyonqbcpor3", [],  "Combien?non je reffuse.", "close_window", []],
  
  [anyone ,"lyon_prixdemains3", [],"Bon, certains vous dirons que la meilleure arme es la lance ou un marteau, ou encore une cruche couverte de bouze...envoyez les se faire foutre. le seul armement de guerre vallable es une épée et un bouclier, je peut vous apprendre a manier les deux en meme temps éfficacement...reste encore que pour découper une armure et le gueux qu'il y a dedans, tout compte fait le marteau ou le bec de corbin n'es pas si mal.", "lyonqbcporokok3", []],
  
  [anyone|plyr ,"lyonqbcporokok3", [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 3000),
    ],
    "C'est d'accord,cela me plait.", "lyontraindemainok3",
    [
      (troop_remove_gold,"trp_player",3000),
  ]],
  
  [anyone|plyr ,"lyonqbcporokok3", [],  "Je ne peut pas payer une telle some.", "close_window", []],
  
  [anyone ,"lyontraindemainok3", [],"Tres bien, vous devez commencer a prendre conscience que vous avez deux bras, un deffend et l'autre attaque...seulement il vous faudra pensser a la déffensse tandis que vous attaquer et pensser a l'attaque au moment ou vous déffendez.", "lyonscolllere3",[]],
  
  [anyone|plyr ,"lyonscolllere3", [],  "Je pensse que je saisie le truc.", "close_window",
    [
      (jump_to_menu, "mnu_training_arme_une_mains"),
      (finish_mission),
  ]],
  
  
  
  
  
  #entraineur
  [anyone,"start", [(eq, "$g_talk_troop", "trp_lyon_caserne_4"),
    ],
    "Salutations, que faistes vous dans la caserne ? la taverne n'es pas de ce coté savez vous.", "lyon_master_startt", []],
  [anyone|plyr ,"lyon_master_startt", [],  "je me demandais si vous pouviez m'entrainer a lépée et au bouclier.", "lyon_entrainementpossible", []],
  [anyone|plyr ,"lyon_master_startt", [],  "Je reprend le chemin de la taverne dans ce cas, adieu.", "close_window", []],
  
  [anyone ,"lyon_entrainementpossible", [],"Et ben...pourquois pas, quelle technique vous fait défaut actuellement ?", "lyon_bonaprentis", []],
  
  
  [anyone|plyr ,"lyon_bonaprentis", [],  "Pouvez vous m'apprendre a améliorer ma maitrise de lépée a une main et du bouclier en meme temps ?", "lyon_demains", []],
  [anyone|plyr ,"lyon_bonaprentis", [],  "Battons nous!", "lyon_fight", []],
  [anyone|plyr ,"lyon_bonaprentis", [],  "Merci,mais je doit partir a present.", "close_window", []],
  [anyone ,"lyon_fight", [],"Si vous voullez prendre des coups je ne saurez vous en empecher...bon, essayez de me suivre.", "close_window",
    [
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 0, 2, 0),
      (team_set_relation, 0, 3, 0),
      (team_set_relation, 0, 4, 0),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 1, 3, 0),
      (team_set_relation, 1, 4, 0),
      (team_set_relation, 2, 3, -1),
      (team_set_relation, 2, 0, 0),
      (team_set_relation, 2, 1, 0),
      (team_set_relation, 2, 4, 0),
      (team_set_relation, 3, 2, -1),
      (team_set_relation, 3, 0, 0),
      (team_set_relation, 3, 1, 0),
      (team_set_relation, 3, 4, 0),
      (team_set_relation, 4, 0, 0),
      (team_set_relation, 4, 1, 0),
      (team_set_relation, 4, 2, 0),
      (team_set_relation, 4, 3, 0),
  ]],
  
  [anyone ,"lyon_demains", [],"Vous voullez savoir comment les gardes Lyonnais font pour etre intouchables et pour riposter aussi vite hein ? et bien je peut vous ensseigner quelques coups pour 3000 écus, ca vous va ?", "lyonqbcpor", []],
  
  [anyone|plyr ,"lyonqbcpor", [],  "Que pourez vous m'apprendre a ce prix?", "lyon_prixdemains", []],
  [anyone|plyr ,"lyonqbcpor", [],  "Le prix d'une rancon royale ?! adieu, c'es non.", "close_window", []],
  
  [anyone ,"lyon_prixdemains", [],"Bon, certains vous dirons que la meilleure arme es la lance ou un marteau, ou encore une cruche couverte de bouze...envoyez les se faire foutre. le seul armement de guerre vallable es une épée et un bouclier, je peut vous apprendre a manier les deux en meme temps éfficacement...reste encore que pour découper une armure et le gueux qu'il y a dedans, tout compte fait le marteau ou le bec de corbin n'es pas si mal.", "lyonqbcporokok", []],
  
  [anyone|plyr ,"lyonqbcporokok", [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 3000),
    ],
    "C'est d'accord, etre rapide me plait.", "lyontraindemainok",
    [
      (troop_remove_gold,"trp_player",3000),
  ]],
  
  [anyone|plyr ,"lyonqbcporokok", [],  "Je ne peut pas payer une telle some.", "close_window", []],
  
  [anyone ,"lyontraindemainok", [],"Tres bien, vous devez commencer a prendre conscience que vous avez deux bras, un deffend et l'autre attaque...seulement il vous faudra pensser a la déffensse tandis que vous attaquer et pensser a l'attaque au moment ou vous déffendez.", "lyontraindemainok2",[]],
  
  [anyone|plyr ,"lyontraindemainok2", [],  "Je pensse que je saisie le truc...", "close_window",
    [
      (jump_to_menu, "mnu_training_arme_une_mains"),
      (finish_mission),
  ]],
  
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_lyon_caserne_5"),
    ],
    "Attention! qu'es c'que vous fouttez dans nos pattes ?", "lyyon_partir", []],
  [anyone|plyr ,"lyyon_partir", [],  "Mes excuses.", "close_window", []],
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_lyon_caserne_6"),
    ],
    "En arière.", "lyyon_partir2", []],
  [anyone|plyr ,"lyyon_partir2", [],  "Faites un peut attention.", "close_window", []],
  
  #sentinelle de lyon
  [anyone,"start", [(eq, "$g_talk_troop", "trp_lyon_caserne_1"),
    ],
    "N'approchez pas un homme qui monte la garde sans faire de bruits je vous prie.", "lyon_senti", []],
  
  [anyone|plyr ,"lyon_senti", [],  "Mes excuses.", "close_window", []],
  
  
  #garde entree de lyon
  [anyone,"start", [(eq, "$g_talk_troop", "trp_lyon_caserne_2"),
    ],
    "Messire ? es ce une visite, ou avez vous un méssage pour le capitaine ?", "lyon_gardedeentre", []],
  
  [anyone|plyr ,"lyon_gardedeentre", [],  "Il s'agis plutot d'une visite dans ce cas, mais je ne resterez pas longtemps.", "close_window", []],
  
  
  
  
  #a table de lyon
  [anyone,"start", [(eq, "$g_talk_troop", "trp_lyon_caserne_3"),
    ],
    "Que faistes vous ici ? c'es une caserne vous savez ? meme si cela pourais ressembler a une taverne.", "lyon_tav_caserne", []],
  
  [anyone|plyr ,"lyon_tav_caserne", [],  "Bien, je m'en vais.", "close_window", []],
  
  
  
  ##orleans forgerons
  #aprentis
  [anyone,"start", [(eq, "$g_talk_troop", "trp_orleans_aprentis"),
    ],
    "Le bonjour Messire,si c'est pour une comande,veuillez en parler au maistre.", "orleans_maitre", []],
  [anyone|plyr ,"orleans_maitre", [],  "Que pensez vous du maistre ?.", "orleans_dialmaitre", []],
  [anyone|plyr ,"orleans_maitre", [],  "J'y vais de ce pas.", "close_window", []],
  
  [anyone ,"orleans_dialmaitre", [],"Ho ce n'est pas un mauvais bougre,certes il ne manque pas une occasion de me rabrouer en public,mais c'est certainement pour rappeller a tout le monde qui es maistre Forgeron et qui es l'aprentis.", "close_window",[]],
  #maitre forgeron
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_orleans_maitre"),
    ],
    "Bienvenue dans ma modéste échoppe Messire,que puis je pour vous ?", "orleans_vendeur12", []],
  
  [anyone|plyr ,"orleans_vendeur12", [],  "Modeste échoppe ? il y a la de quois équiper une armée.", "orleans_vendeurgo", []],
  [anyone|plyr ,"orleans_vendeur1", [],  "J'aimerais voir vos oeuvres Maistre.", "orleans_dialvendeur1j", []],
  [anyone|plyr ,"orleans_vendeur1", [],  "Je doit partir mais je reviendrais.", "close_window", []],
  
  [anyone ,"orleans_vendeurgo", [],"J'attire surtout votre attention sur la qualitée,mes lames sont forgées avec les aciers les plus purs,et il faut également la main et le savoir d'un Maistre Forgeron pour un tel résultat.", "orleans_vendeur1",[]],
  [anyone ,"orleans_vendeurpredial", [],"Autre chose ?", "orleans_vendeur1",[]],
  
  [anyone ,"orleans_dialvendeur1j", [],"Admirez cette qualitée messire.", "orleans_vendeurpredial",[[change_screen_trade]]],
  
  ###vendeurs de bordeau
  #vendeur de bani?es
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_bordeau_artisant1"),
    ],
    "Approchez mon Seigneur,désirez vous une nouvelles bannière ? un instant,pardonez moi ,mais vous etes bien noble n'est ce pas,en tout cas vous en avez l'allure,mais sachez que je me refuserais de confectioner un étendart a qui n'est point noble,vous savez sans doute que c'est interdit,et je ne voudrais pas me mettre dans l'embaras.", "bordeau_banner1", []],
  
  [anyone|plyr ,"bordeau_banner1", [],  "Bien sur que je suis noble,montre moi tes bannières artisant.", "bordeau_banner_vend", []],
  [anyone|plyr ,"bordeau_banner1", [],  "Et si je n'etais pas noble et que je voulais une bannière quand meme,histoire d'impressioner ma troupe de mercenaires,que se passerais t'il?.", "Bordeau_banimpression", []],
  [anyone|plyr ,"bordeau_banner1", [],  "Ne te tracasse pas,de toute facon ca ne m'interesse pas.", "close_window", []],
  
  [anyone ,"bordeau_banner_vend", [],"C'est parfait Mon Seigneur,permettez moi de vous montrer mes créations,il vous en couteras 150 écus pièce,et soyez assuré de la qualité.", "bordeau_banner_vendmoney",[]],
  [anyone ,"Bordeau_banimpression", [],"Ho mon dieu,je risquerais de ne plus avoir le droit d'exercer ma profession si jamais cela se savais.je refuse,allez vous en ou j'appelle la garde.", "close_window",[]],
  
  [anyone|plyr ,"bordeau_banner_vendmoney", [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 150),
    ],
    "Voila mon or,montre moi les bannières a present.", "bordeau_fin_banniere",
    [
      (troop_remove_gold,"trp_player",150),
  ]],
  [anyone|plyr ,"bordeau_banner_vendmoney", [],  "Je n'ai pas 150 écus a dépenssez pour une fichue bannière.", "close_window", []],
  [anyone ,"bordeau_fin_banniere", [],"Vous ne serez pas décu,je vous le garantis.", "close_window",
    [
      (jump_to_menu, "mnu_banner_choix_generique"),
      (finish_mission),
  ]],
  #somelier
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_bordeau_artisant2"),
    ],
    "Par ici Messire...voullez vous de la bonne Cervoise bien fraiche ? ou voullez vous gouter de mon vin ? je peut en avoir en quantité si vous le désirez.", "bordeau_vendsom", []],
  [anyone|plyr,"bordeau_vendsom", [], "Exelente idée,fait moi voir ca.", "bordeau_vendsom2",[]],
  [anyone|plyr,"bordeau_vendsom", [], "J'en es déja bien assez ,mais merci bien.", "close_window",[]],
  
  
  [anyone,"bordeau_vendsom2", [],"Mais bien entendu,allez y gouttez.", "predialbordeau_vendsom2",[[change_screen_trade]]],
  [anyone,"predialbordeau_vendsom2", [],"Merci mon ami,vous fallait t'il autre chose ?.", "bordeau_vendsom",[]],
  
  
  #bordeau livrer vendeur livres
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_bordeau_artisant3"),
      (check_quest_active, "qst_messager_qst5"),
      (neg|check_quest_succeeded, "qst_messager_qst5"),
      (neg|check_quest_failed, "qst_messager_qst5"),
    ],
    "Voullez vous acheter mes livres ?", "destinat_bordeaud", []],
  
  [anyone|plyr ,"destinat_bordeaud", [], "Non, je vous en amène, la guild des Messager m'a chargé de vous emené une cargaison.", "destinat_bordeaud2",[]],
  
  [anyone ,"destinat_bordeaud2", [],"Tres bien! ou es elle ?", "destinat_bordeaud2ou",[]],
  
  [anyone|plyr ,"destinat_bordeaud2ou",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre5"),
    ], "La voici.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre5"),
      (call_script, "script_succeed_quest", "qst_messager_qst5"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"destinat_bordeaud2ou", [], "Et bien, je l'es perdue.", "destinat_bordeaud2oufail",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst5"),
      (call_script, "script_end_quest", "qst_messager_qst5"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"destinat_bordeaud2oufail", [],"Comment ?! comment avez vous pu perdre une caisse si grosse ? disparessez.", "close_window",[]],
  #
  #bordeau
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_bordeau_artisant3"),
      (check_quest_active, "qst_messager_qst5b"),
      (neg|check_quest_succeeded, "qst_messager_qst5b"),
      (neg|check_quest_failed, "qst_messager_qst5b"),
    ],
    "Voullez vous acheter mes livres ?", "bdestinat_bordeaud", []],
  
  [anyone|plyr ,"bdestinat_bordeaud", [], "Non, je vous en amène, la guild des Messager m'a chargé de vous emené une cargaison.", "bdestinat_bordeaud2",[]],
  
  [anyone ,"bdestinat_bordeaud2", [],"Tres bien! ou es elle ?", "bdestinat_bordeaud2ou",[]],
  
  [anyone|plyr ,"bdestinat_bordeaud2ou",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre5"),
    ], "La voici.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre5"),
      (call_script, "script_succeed_quest", "qst_messager_qst5b"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"bdestinat_bordeaud2ou", [], "Et bien, je l'es perdue.", "bdestinat_bordeaud2oufail",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst5b"),
      (call_script, "script_end_quest", "qst_messager_qst5b"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"bdestinat_bordeaud2oufail", [],"Comment ?! comment avez vous pu perdre une caisse si grosse ? disparessez.", "close_window",[]],
  #
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_bordeau_artisant3"),
      (check_quest_active, "qst_messager_qst5d"),
      (neg|check_quest_succeeded, "qst_messager_qst5d"),
      (neg|check_quest_failed, "qst_messager_qst5d"),
    ],
    "Voullez vous acheter mes livres ?", "ddestinat_bordeaud", []],
  
  [anyone|plyr ,"ddestinat_bordeaud", [], "Non, je vous en amène, la guild des Messager m'a chargé de vous emené une cargaison.", "ddestinat_bordeaud2",[]],
  
  [anyone ,"ddestinat_bordeaud2", [],"Tres bien! ou es elle ?", "ddestinat_bordeaud2ou",[]],
  
  [anyone|plyr ,"ddestinat_bordeaud2ou",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre5"),
    ], "La voici.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre5"),
      (call_script, "script_succeed_quest", "qst_messager_qst5d"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"ddestinat_bordeaud2ou", [], "Et bien, je l'es perdue.", "ddestinat_bordeaud2oufail",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst5d"),
      (call_script, "script_end_quest", "qst_messager_qst5d"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"ddestinat_bordeaud2oufail", [],"Comment ?! comment avez vous pu perdre une caisse si grosse ? disparessez.", "close_window",[]],
  
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_bordeau_artisant3"),
      (check_quest_active, "qst_messager_qst5m"),
      (neg|check_quest_succeeded, "qst_messager_qst5m"),
      (neg|check_quest_failed, "qst_messager_qst5m"),
    ],
    "Voullez vous acheter mes livres ?", "mdestinat_bordeaud", []],
  
  [anyone|plyr ,"mdestinat_bordeaud", [], "Non, je vous en amène, la guild des Messager m'a chargé de vous emené une cargaison.", "mdestinat_bordeaud2",[]],
  
  [anyone ,"mdestinat_bordeaud2", [],"Tres bien! ou es elle ?", "mdestinat_bordeaud2ou",[]],
  
  [anyone|plyr ,"mdestinat_bordeaud2ou",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre5"),
    ], "La voici.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre5"),
      (call_script, "script_succeed_quest", "qst_messager_qst5m"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"mdestinat_bordeaud2ou", [], "Et bien, je l'es perdue.", "mdestinat_bordeaud2oufail",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst5m"),
      (call_script, "script_end_quest", "qst_messager_qst5m"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"mdestinat_bordeaud2oufail", [],"Comment ?! comment avez vous pu perdre une caisse si grosse ? disparessez.", "close_window",[]],
  
  
  #livres apres aide ressources
  [anyone,"start", [(eq, "$g_talk_troop", "trp_bordeau_artisant3"),
      (eq, "$ressourcesstopbord", 1),
    ],
    "Ho! c'est vous?", "bordeau_vendlivreapres", []],
  
  [anyone|plyr,"bordeau_vendlivreapres", [], "L'Archange Gabriel a faim.", "bordeau_donncressourc2plusressour",[]],
  [anyone|plyr,"bordeau_vendlivreapres", [], "Je voudrais un livre.", "bordeau_vendlivre2apre",[]],
  [anyone|plyr,"bordeau_vendlivreapres", [], "J'ai mieux a faire que de lire.", "close_window",[]],
  
  
  [anyone,"bordeau_vendlivre2apre", [],"Tres bien,achetez le et partez je vous en prie.", "predialbordeau_vendlivre2aprrs",[[change_screen_trade]]],
  [anyone,"predialbordeau_vendlivre2aprrs", [],"Maintenant partez,je risque ma vie.", "bordeau_vendlivreapres",[]],
  
  
  [anyone,"bordeau_donncressourc2plusressour", [],"tres drole,vraiment,écoutez les Rebelles m'ont rendue un service et maintenant on es quitte,achetez moi un livre ou disparaissez...atention,parlez d'autre chose vite.", "close_window",[]],
  
  #livres
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_bordeau_artisant3"),
    ],
    "Messire,messire,ha enfin...quelqu'un qui sache lire,voullez vous achetter un de mes livres ? j'ai la une fabuleuse collection,a des prix imbatables.", "bordeau_vendlivre", []],
  
  [anyone|plyr,"bordeau_vendlivre", [(eq, "$ressourcesrebeladmirbord", 1),], "On m'a dit de vous dire que l'Archange Gabriel a faim.", "bordeau_donncressourc2",[]],
  [anyone|plyr,"bordeau_vendlivre", [], "Faites moi voir ca,ca m'interèsse.", "bordeau_vendlivre2",[]],
  [anyone|plyr,"bordeau_vendlivre", [], "J'ai mieux a faire que de lire.", "close_window",[]],
  
  
  [anyone,"bordeau_vendlivre2", [],"Voyez vous meme.", "predialbordeau_vendlivre2",[[change_screen_trade]]],
  [anyone,"predialbordeau_vendlivre2", [],"Mes remerciements,voullez vous en prendre un autre ?.", "bordeau_vendlivre",[]],
  
  
  [anyone,"bordeau_donncressourc2", [],"Bien...je ne vous attendais plus,tenez,on es quitte maintenant.", "close_window",
    [
      (troop_add_gold, "trp_player", 2800),
      (assign, "$ressourcesstopbord", 1),
  ]],
  
  #potier
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_bordeau_artisant4"),
    ],
    "Aprochez,aprochez! Potteries,bols,soupières,verres...", "bordeau_potiersvend", []],
  [anyone|plyr,"bordeau_potiersvend", [], "Que ferais je de vos potteries ?", "bordeau_potiersvend2",[]],
  [anyone|plyr,"bordeau_potiersvend", [], "Non,merci.", "close_window",[]],
  
  [anyone,"bordeau_potiersvend2", [],"Je ne sais pas moi,si ce n'es pas pour un ménage,vous pouriez toujours les vendres plus chers ailleurs si vous voyagez beaucoup.", "predialbordeau_potiersvend22",[]],
  [anyone|plyr,"predialbordeau_potiersvend22", [], "C'est peut etre une bonne idée,montrez moi vos prix.", "bordeau_potiersvend23",[]],
  [anyone|plyr,"predialbordeau_potiersvend22", [], "J'ai mieux a faire que de m'encombrer de toute cette terre.", "close_window",[]],
  
  [anyone,"bordeau_potiersvend23", [],"Vous faites une exelente affaire messire,les artisants sont encore moin chers que les grossistes voyez vous.", "predialbordeau_potiersvend2",[[change_screen_trade]]],
  [anyone,"predialbordeau_potiersvend2", [],"Merci beaucoup Messire,en voullez vous d'autre ?", "bordeau_potiersvend",[]],
  
  ### DIALOGUES fleuve pour dijon
  ##CAPITAINE :raccourcit voyage si parl?au rebel entre temp
  ##
  
  [anyone,"start",
    [
      (eq, "$g_talk_troop", "trp_provence6"),##rajouter condition avoir parl?au rebel et pay?la place sur le bateau
      (eq, "$paye_place_bateau", 1),
      (eq, "$talk_to_rebel", 1),
      (eq, "$sanglys_fleuve", 1),
    ],
    "Pouvons nous partir Messire?.", "provencecapitaine2", []],
  
  [anyone|plyr ,"provencecapitaine2", [],  "Oui,partons au plus vite.", "close_window",
    [
      (jump_to_menu, "mnu_start_phase_pirates"),
      (finish_mission),
  ]],
  
  [anyone|plyr,"provencecapitaine2", [], "Pas encore.", "close_window",[]],
  
  
  #(neg|eq, "$talk_to_rebel", 1),
  [anyone,"start",
    [
      (eq, "$g_talk_troop", "trp_provence6"),##rajouter condition avoir parl?au rebel et pay?la place sur le bateau
      (eq, "$paye_place_bateau", 1),
      (eq, "$sanglys_fleuve", 0),
    ],
    "Nous partons bientot,aller donc parler avec les passagers.", "provencecapitainecondition2hh", []],
  [anyone|plyr,"provencecapitainecondition2hh", [], "Tres bien.", "close_window",[]],
  
  
  
  #mettre bloc avoir pay?mais pas parl?au rebel condition " nous partons bientot"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
  #(neg|eq, "$talk_to_rebel", 1),
  [anyone,"start",
    [
      (eq, "$g_talk_troop", "trp_provence6"),##rajouter condition avoir parl?au rebel et pay?la place sur le bateau
      (eq, "$paye_place_bateau", 1),
      (eq, "$talk_to_rebel", 0),
    ],
    "Nous partons bientot,aller donc parler avec les passagers.", "provencecapitainecondition2", []],
  [anyone|plyr,"provencecapitainecondition2", [], "Tres bien.", "close_window",[]],
  
  
  ##  si pas les deux conditions variable pay?place et parl?au rebel
  [anyone,"start", [(eq, "$g_talk_troop", "trp_provence6"),
    ],
    "Bienvenue Voyageur,trouvez vous une place dans tout ce bazard,si vous voullez que l'on vous enmène a Dijon,il faudra payer d'avance 50 écus.", "provencecapitaine", [(play_sound, "snd_maitre_guild"),]],
  [anyone|plyr,"provencecapitaine",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 50),
    ], "Tres bien,voici l'argent...", "provence_capitaine_partirdebut",
    [
      (assign, "$paye_place_bateau", 1),
      (troop_remove_gold,"trp_player",50),
  ]],#debloquer variable avoir pay?la place ici
  [anyone|plyr,"provencecapitaine", [], "Ca ne m'arange pas,je n'ai pas assez.", "close_capitaine1",[]],
  
  [anyone,"close_capitaine1", [], "Pas d'argent pas de voyage,je regrette,trouvez une solution ou vous restez ici.", "close_window",[]],
  [anyone,"provence_capitaine_partirdebut",
    [
      (eq, "$talk_to_rebel", 1),
      (eq, "$sanglys_fleuve", 1),
    ]
    , "C'est parfait,nous partons sur le champ,etes vous pret ?", "close_debutvoyage_1",[]],#debloque voyage  :!si variable avoir parl?au rebel et on vien de payer
  
  [anyone,"provence_capitaine_partirdebut",
    [
      (this_or_next|eq, "$talk_to_rebel", 0),
      (eq, "$sanglys_fleuve", 0),
      ], "Nous partons bientot,restez dans les parages...", "close_window",[]],#sinon (sans ajouter de condition...libre tel quel)
  
  [anyone,"provence_capitaine_partirdebut",
    [
      (eq, "$talk_to_rebel", 1),
      (eq, "$sanglys_fleuve", 0),
      ], "Ne restez pas dans mes pattes,nous ne sommes pas prets,allez sur le pont...", "close_window",[]],#sinon (sans ajouter de condition...libre tel quel)
  
  [anyone,"provence_capitaine_partirdebut",
    [
      (eq, "$talk_to_rebel", 0),
      (eq, "$sanglys_fleuve", 1),
      ], "Nous partons bientot,restez dans les parages...", "close_window",[]],#sinon (sans ajouter de condition...libre tel quel)
  
  [anyone|plyr ,"close_debutvoyage_1", [],  "Oui,partons au plus vite.", "close_window",
    [
      (jump_to_menu, "mnu_start_phase_pirates"),
      (finish_mission),
  ]],
  
  [anyone|plyr,"close_debutvoyage_1", [], "Pas encore,j'ai quelque chose a faire.", "close_window",[]],
  
  ###paysan
  [anyone,"start", [(eq, "$g_talk_troop", "trp_provence"),
    ],
    "Bien le bonjour Seigneur,nous...heu,c'est juste une petite pause vous savez,je...", "provence_paysan_1", [(play_sound, "snd_taverniers_h"),]],
  [anyone|plyr,"provence_paysan_1", [], "Calmez vous,je ne suis point votre seigneur mais juste un Voyageur.", "provence_paysan_1playerz",[]],
  [anyone|plyr,"provence_paysan_1playerz", [], "Avez vous quelque chose a manger?.", "provence_paysan_1z",[]],
  [anyone|plyr,"provence_paysan_1", [], "Je doit partir paysan.", "close_window",[]],
  
  
  [anyone,"provence_paysan_1z", [],"Ho...mais bien sur,je fabrique du pain et du fromage,choisissez.", "provence_paysan_1zfin",[[change_screen_trade]]],
  [anyone,"provence_paysan_1zfin", [],"Merci bien,mes excuses mais j'ai du travail.", "close_window",[]],
  
  ###armurier
  [anyone,"start", [(eq, "$g_talk_troop", "trp_provence2"),
    ],
    "Aprochez Voyageur,je vend des armes,voullez vous voir mes coffres? j'es ici des pièces de tres bonne qualitée.", "provence_vendeur_2", [(play_sound, "snd_maitre_guild"),]],
  [anyone|plyr,"provence_vendeur_2", [], "J'avais deviné a vous voir déguisé en ratelier d'armes.", "provence_vendeur_2ok",[]],
  [anyone|plyr,"provence_vendeur_2", [], "Je repasserais plus tard,je doit recompter ma boursse.", "close_window",[]],
  
  
  [anyone,"provence_vendeur_2ok", [],"Certes...C'est une pure folie de voyager sans armes par les temps qui courent vous savez,si je peut vous consseiller,plus la lame es longue et plus elle impressionera les brigands de tous bords.", "provence_vendeur_2end",[[change_screen_trade]]],
  [anyone,"provence_vendeur_2end", [],"Mes remerciements,j'éspère que le voyage ne sera pas trop long.", "close_window",[]],
  
  ###chevaux
  [anyone,"start", [(eq, "$g_talk_troop", "trp_provence3"),
    ],
    "Des chevaux frais Messire,vous en aurez besoin a Dijon.", "provence_vendeur_3", [(play_sound, "snd_maitre_guild"),]],
  [anyone|plyr,"provence_vendeur_3", [], "Ces chevaux ont l'air bons.", "provence_vendeur_3ok",[]],
  [anyone|plyr,"provence_vendeur_3", [], "Ma boursse se fait vide,je doit bien réfléchire avant d'acheter quois que ce soit.", "close_window",[]],
  
  
  [anyone,"provence_vendeur_3ok", [],"Voyez vous meme mon seigneur,ils viennent juste d'etre ferés.", "provence_vendeur_3end",[[change_screen_trade]]],
  [anyone,"provence_vendeur_3end", [],"A votre service.", "close_window",[]],
  
  ###rebel !apres avoir parlee
  [anyone,"start", [(eq, "$g_talk_troop", "trp_provence5"),
      (eq, "$quetedurebelmontpelier", 1),
    ],
    "Un long voyage nous attend,je vais dormire un peut en éspérant que tu ne nous trahira pas.", "provence_notrahison", []],
  [anyone|plyr,"provence_notrahison", [], "Tu peut dormire tranquile.", "close_window",[]],
  
  ###rebel !doit debloquer la variable pour parler au capitaine et donner la mission 1
  [anyone,"start", [(eq, "$g_talk_troop", "trp_provence5"),
    ],
    "Eh! Compagnon,approche par ici.", "provence_rebel_3", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr,"provence_rebel_3", [], "Encore un voleur,que dirais tu de nager au fond du fleuve?", "provence_debut_quete",
    [
      (assign, "$talk_to_rebel", 1),
  ]],
  
  [anyone,"provence_debut_quete", [],"Non,tu te méprend l'ami,je me nome Michel et je suis juste un voyageur comme toi qui marche vers son destin,es tu francais? et tu es...un Marchand?.", "find_bourgg",[]],
  
  [anyone|plyr,"find_bourgg", [], "Es tu Bourgignon?", "haha_provenc",[]],
  
  [anyone,"haha_provenc", [],"Ha,ha!...Tu me plais Voyageur.Es tu au courant de la situation en france,ou était tu a ce point coupé du reste du monde dans ton village ?...laisse moi te dire ceci:Tu te crois a l'abrit de la guerre au fond de la france,mais un jour les Anglais viendront et meterons le feux a ta maison,ils tuerons tous ceux qui leur résiste et violerons les femmes,en suite ils se meterons a boire et violerons encore.Un francais qui prend un bateau pour rejoindre la Bourgogne doit savoir ce qui l'attend la bas.", "find_bourgasg",[]],
  [anyone|plyr,"find_bourgasg", [], "La guerre ?", "prov_guerre",[]],
  [anyone,"prov_guerre", [],"La guerre? la guerre oui,elle a cent visages,celui de l'enfant qui pleure,celui de l'homme torturé qui supplie son boureau,et celui de l'homme qui n'as plus de visage,mutilé au plus profond de sa chair. ", "find_chairr1",[]],
  [anyone,"find_chairr1", [],"Et le pire dans tout ceci c'est que ceux qui tiennent la lance,les nobles,n'ont que faire de ces souffrances,ils s'empifrent en jouant a la guerre,ils envoient toujours les pauvres diables se faire massacrer,et si ils ne sont pas d'accord ils sont tués sur place.", "find_rejoindre",[]],
  [anyone|plyr,"find_rejoindre", [], "Si ton but était de gacher mon voyage tu as reussis...compagnon.", "prov_rejoindrejeanne",[]],
  [anyone,"prov_rejoindrejeanne", [],"Tu pensse etre pret pour combat,mais tu ne l'es pas crois moi.Cepandant il existe un éspoire,connais tu jeanne la Lorraine ? elle dit etre envoyé par Dieu,pour nous sauver,le peuple se rebelle et se rassemble sous ses ordres pret des villes occupées et commencent a s'organiser,je fait parti d'un rassemblement de compagnons,tu semble digne de confiance alors je vais te dire que nous sommes rassemblés dans les ruines de la tour des pins a Montpellier,rejoins nous ! c'est ta seulle chance de salut,nous avons besoin les uns des autres crois moi,et si tu n'avais pas la foi,tu sera payé pour ton aide n'es crainte.Alors,va tu aller a Montpellier compagnon ?", "find_montpeliergo",[]],
  [anyone|plyr,"find_montpeliergo", [], "Tres bien,j'irais voir tes amis quand je passerais a Montpelier.", "close_finfleuve",
    [
      #(str_store_party_name, s3, "$current_town"),
      # (str_store_string, s2, "str_start_up_quest_message_1"),
      (str_store_string, s2, "@Michel,un passager du bateau pour Dijon,m'as compté la situation en France,il appartient au cercle discret des Rebelles,et m'as proposé d'en faire partie en rencontrant le chef Rebelle d'un petit groupe local,a la tour en ruines, aux portes de Montpellier."),
      (call_script, "script_start_quest", "qst_rebelc1", "$g_talk_troop"),
      (play_sound,"snd_start_quest"),
  ]],
  [anyone|plyr,"find_montpeliergo", [], "Ca ne m'intéresse guère,désolé.", "close_window",[(assign, "$quetedurebelmontpelier", 1),]],
  [anyone,"close_finfleuve", [],"Voila qui fait plaisire a entendre! tu veras,tu te plaira parmis nous compagnon...", "close_window",[(assign, "$quetedurebelmontpelier", 1),]],
  
  
  ###equipage
  [anyone,"start", [(eq, "$g_talk_troop", "trp_provence7"),
    ],
    "Bienvenu,montez a bord,et n'oubliez pas de payer votre place,le capitaine a déja fait passer des Voyageurs par dessus bord par ce qu'ils n'avaient pas de quois payer,je vous assure,je l'es vue de mes propres yeux.", "provence_wherecapitaine", [(play_sound, "snd_taverniers_h"),]],
  [anyone|plyr,"provence_wherecapitaine", [], "Ou puis je trouver le capitaine ?", "close_wherecapitaine",[]],
  [anyone|plyr,"provence_wherecapitaine", [], "Merci du conseil l'ami,adieu.", "close_window",[]],
  [anyone,"close_wherecapitaine", [],"Sur le pont superieur,je serais vous,je me mefierais de ses colères.", "close_window",[]],
  
  ##TEST ITEM ENLEVER!!!!!!!
  #  [anyone|plyr,"provence_wherecapitaine", [], "test item torch,rubis,et chevalire", "close_window",
  #  [
  #(troop_add_item, "trp_player", "itm_plan_1", 0),
  #(troop_add_item, "trp_player", "itm_ampoule", 0),
  #(troop_add_item, "trp_player", "itm_Chevaliere", 0),
  #(troop_add_item, "trp_player", "itm_plume", 0),
  #(troop_add_item, "trp_player", "itm_poison", 0),
  #(troop_add_item, "trp_player", "itm_pier", 0),
  #(troop_add_item, "trp_player", "itm_bois", 0),
  #(troop_add_item, "trp_player", "itm_cuir", 0),
  #   ]],
  
  ##
  
  ##voyageur
  [anyone,"start", [(eq, "$g_talk_troop", "trp_provence4"),
    ],
    "Pourquois allez vous a Dijon,si je puis vous poser cette question?", "provence_to_Dijon", []],
  [anyone|plyr,"provence_to_Dijon", [], "Je suis un homme d'armes,et je rejoint les combats plus au nord,c'est la qu'es ma place.", "provence_to_Dijon_fin",[]],
  [anyone|plyr,"provence_to_Dijon", [], "Je désire gagner Dijon,je doit rendre visite a une tante mourante.", "provence_to_Dijon_fin",[]],
  
  [anyone|plyr,"provence_to_Dijon", [], "Vous ne pouvez pas.", "close_window",[]],
  [anyone,"provence_to_Dijon_fin", [],"J'éspère que le voyage se passera bien,j'es entendu des rumeurs comme quois le fleuve serais infesté de bandits.", "close_window",[]],
  
  
  
  ##mercenaire sang lysapres parlee
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lysbateau"),
      (eq, "$sanglys_fleuve", 1),
    ],
    "Je vais enfin pouvoir dormire un peut avant les prochains combats", "sanglysbatdormrr_1", []],
  
  [anyone|plyr ,"sanglysbatdormrr_1", [],  "Ca semble etre la meilleure idée de la journée.", "close_window", []],
  
  ##mercenaire sang lys
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lysbateau"),
    ],
    "Le bonjour aventurier,es tu mercenaire?", "sanglysbateau_1", []],
  
  [anyone|plyr ,"sanglysbateau_1", [(eq,"$background_item_mercenaire",1),],  "Je suis mercenaire en effet.", "sanglysmercenairebat", []],
  [anyone|plyr ,"sanglysbateau_1", [(eq,"$background_item_mercenaire",0),],  "Pas vraiment,je suis une autre voie.", "sanglysno_mercenairebat", []],
  
  
  
  [anyone ,"sanglysmercenairebat", [],"Je m'en doutais,et a quelle compagnie appartiens tu?.", "sanglysmercenairhqcompagn", []],
  [anyone ,"sanglysno_mercenairebat", [],"Et bien si jamais tu etait a court d'écus,sache que la compagnie du SansLys recrute dans la ville de Bourges,leur caserne es sur la place Gordaine,mais leurs tests d'admission sont tres durs,par contre ils payent comme des seigneurs.", "slys_payehseifgneur", []],
  [anyone|plyr ,"slys_payehseifgneur", [],  "Merci,je m'en souviendrais.", "close_window",
    [
      (play_sound,"snd_start_quest"),
      (assign,"$sanglys_fleuve", 1),
      (str_store_string, s2, "@Aller passer le test d'admission pour travailler en tant que mercenaire pour la compagnie du SansLys,ils ont une caserne sur la place Gordaine a Bourges."),
      (call_script, "script_start_quest", "qst_sl_1caserne", "$g_talk_troop"),
  ]],
  
  [anyone|plyr ,"sanglysmercenairhqcompagn", [],  "Je n'ai pas de compagnie pour le moment.", "sanglysmercenairhqcompagnh2", []],
  [anyone ,"sanglysmercenairhqcompagnh2", [],"Je fait patis de la grande compagnie du SansLys,les combats font rage en ce moment et ils recrutent,tu devrais aller a Bourges et passer le test d'admission,mais attention ils sont exigeants,par contre ils payent bien.si tu veux tenter ta chance leur caserne es sur la place Gordaine.", "sanglysmercenairchanccsgord", []],
  [anyone|plyr ,"sanglysmercenairchanccsgord", [],  "Tres bien,j'irais passer leurs test,merci.", "sanglysmercenairhqcompagnhendd",
    [
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Aller passer le test d'admission pour travailler en tant que mercenaire pour la compagnie du SansLys,ils ont une caserne sur la place Gordaine a Bourges."),
      (call_script, "script_start_quest", "qst_sl_1caserne", "$g_talk_troop"),
  ]],#donner quete ICI
  
  
  [anyone|plyr ,"sanglysmercenairchanccsgord", [],  "Merci,mais je ne veux pas integrer de compagnie.", "close_window", [(assign,"$sanglys_fleuve", 1),]],
  [anyone ,"sanglysmercenairhqcompagnhendd", [],"bonne chance l'ami.", "close_window", [(assign,"$sanglys_fleuve", 1),]],
  
  
  #vendeur de bani?es2 anger
  [anyone,"start", [(eq, "$g_talk_troop", "trp_anger_baner"),
    ],
    "Approchez mon Seigneur,désirez vous une nouvelles bannière ? un instant,pardonez moi ,mais vous etes bien noble n'est ce pas,en tout cas vous en avez l'allure,mais sachez que je me refuserais de confectioner un étendart a qui n'est point noble,vous savez sans doute que c'est interdit,et je ne voudrais pas me mettre dans l'embaras.", "anger_banner1", []],
  
  [anyone|plyr ,"anger_banner1", [],  "Bien sur que je suis noble,montre moi tes bannières artisant.", "anger_banner_vend", []],
  [anyone|plyr ,"anger_banner1", [],  "Et si je n'etais pas noble et que je voulais une bannière quand meme,histoire d'impressioner ma troupe de mercenaires,que se passerais t'il?.", "anger_banimpression", []],
  [anyone|plyr ,"anger_banner1", [],  "Ne te tracasse pas,de toute facon ca ne m'interesse pas.", "close_window", []],
  
  [anyone ,"anger_banner_vend", [],"C'est parfait Mon Seigneur,permettez moi de vous montrer mes créations,il vous en couteras 150 écus pièce,et soyez assuré de la qualité.", "anger_banner_vendmoney",[]],
  [anyone ,"anger_banimpression", [],"Ho mon dieu,je risquerais de ne plus avoir le droit d'exercer ma profession si jamais cela se savais.je refuse,allez vous en ou j'appelle la garde.", "close_window",[]],
  
  [anyone|plyr ,"anger_banner_vendmoney", [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 150),
    ],
    "Voila mon or,montre moi les bannières a present.", "anger_fin_banniere",
    [
      (troop_remove_gold,"trp_player",150),
  ]],
  [anyone|plyr ,"anger_banner_vendmoney", [],  "Je n'ai pas 150 écus a dépenssez pour une fichue bannière.", "close_window", []],
  [anyone ,"anger_fin_banniere", [],"Vous ne serez pas décu,je vous le garantis.", "close_window",
    [
      (jump_to_menu, "mnu_banner_choix_generique"),
      (finish_mission),
  ]],
  #chateau ducal,guarde passage
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_spec_guard"),
    ],
    "Eh! que faites vous ici? passez votre chemin.", "ducale_guardstart1", []],
  
  [anyone|plyr ,"ducale_guardstart1", [],  "Qui habite ce chateau ?", "ducale_guardstartwho", []],
  [anyone|plyr ,"ducale_guardstart1",
    [
      (player_has_item, "itm_plis_caen"),
    ],
    "J'ai sur moi une invitation au banquet,faites place,je veux entrer.", "ducale_guardqueteok", []],  #condition quete active!!! remove item au script d'entree! (lettre)!!!
  [anyone|plyr ,"ducale_guardstart1", [],  "Ne faites pas attention,je ne fait que passer.", "close_window", []],
  
  [anyone ,"ducale_guardstartwho", [],"Que...Si tu ne le sait pas,tu n'as rien as faire ici,disparait sale voleur!", "close_window", []],
  
  [anyone ,"ducale_guardqueteok", [],"Montrez moi...tout es en ordre seigneur,vous pouvez entrer.", "close_window",
    [
      (troop_remove_item, "trp_player", "itm_plis_caen"),
      (jump_to_menu, "mnu_town_Caen_castle_scene"),
      (finish_mission),
  ]],
  
  #dials chateau ducale
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_spec_guard_int1"),
    ],
    "Monseigneur.", "ducale_monss", []],
  
  [anyone|plyr ,"ducale_monss", [],  "Repos.", "close_window", []],
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_spec_guard_int2"),
    ],
    "Bon séjour Monseigneur.", "ducale_monss2", []],
  
  [anyone|plyr ,"ducale_monss2", [],  "Jolie armure.", "close_window", []],
  
  #TEST DEPART COMBAT!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_chateau_conte"),
    ],
    "Mais...qui etes vous donc ?.", "ducale_comte", []],
  
  [anyone|plyr ,"ducale_comte", [],  "N'entendez vous pas les voix des inocants que vous avez fait massacrer? Je suis leur bras vengeur.", "start_epic_battlecomte", []],
  [anyone|plyr ,"ducale_comte", [],  "Je vous pris de m'excuser cher comte,une affaire urgente me rappelle a mon comté.", "close_window", []],
  [anyone ,"start_epic_battlecomte", [],"Seigneur non! un Rebelle...Un Rebelle!!", "close_window",
    [
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 0, 2, -1),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 1),
      (team_set_relation, 2, 0, -1),
      (team_set_relation, 2, 1, 1),
  ]],
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_chateau_garde1"),
    ],
    "Bon séjour Mon seigneur.", "ducale_monss3", []],
  
  [anyone|plyr ,"ducale_monss3", [],  "Merci.", "close_window", []],
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_chateau_garde2"),
    ],
    "Mes respects Mon seigneur.", "ducale_monss4", []],
  
  [anyone|plyr ,"ducale_monss4", [],  "...", "close_window", []],
  
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_chateau_armurier"),
      (eq, "$arme_caen_ok", 1),
    ],
    "Et bien,ne m'en veuillez pas mon seigneur,mais tout de meme...puis je vous suggerer de faire attention avec votre nouvelle arme.", "ducale_attentarm", []],
  
  [anyone|plyr ,"ducale_attentarm", [],  "N'ayez craintes.", "close_window", []],
  
  #armurier caen
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_chateau_armurier"),
    ],
    "Mon seigneur? que...que puis je faire pour vous dans notre humble caserne?.", "ducale_armurier", []],
  
  [anyone|plyr ,"ducale_armurier", [],  "Ou se trouve le comte?.", "caen_ou_comte_1", []],
  [anyone|plyr ,"ducale_armurier", [],  "Je crain une attaque de Rebelles,pouriez vous me donner une arme? je me sentirais bien mieux.", "caen_donnerarme", []],
  [anyone|plyr ,"ducale_armurier", [],  "Rien,je me suis simplement perdu.", "close_window", []],
  
  [anyone ,"caen_donnerarme", [],"Mais certainement seigneur,certainement.que désirez vous? une dague peut etre.", "caen_armechoix",[]],
  
  [anyone|plyr ,"caen_armechoix", [],  "Je n'y connais rien en armes,je suis plus habitué a tenire une plume,mais une arbaléte ou une épée devrais suffire a me rassurer.", "arbalete_ok_caen", []],
  
  [anyone ,"arbalete_ok_caen", [],"Un éccelent choix monseigneur,et vous dites que vous n'avez jamais vue une arme ? vous etes doué pour toutes disciplines assurément.tenez voici la meilleure pièce.", "close_window",
    [
      (jump_to_menu, "mnu_choose_armes_caen"),
      (finish_mission),
  ]],
  
  [anyone ,"caen_ou_comte_1", [],"Le comte es dans ses appartements,en haut du chateau,je ne l'es pas vue redescendre et c'est le seul passage,désirez vous autre chose?.", "ducale_armurier",[]],
  
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_chateau_archer"),
    ],
    "Monseigneur,un peut d'air frais ne fait pas de mal n'est ce pas ?.", "ducale_monssair", []],
  
  [anyone|plyr ,"ducale_monssair", [],  "Craigniez vous une attaque des Rebelles?", "close_caenrebelz", []],
  [anyone ,"close_caenrebelz", [],"Non,pas du tout,croyez en mon éxpérience,ils ne viendrons pas en pleine ville nous attaquer avec une fourche en bois,ha,ha...de plus nous avons ici de tres bons soldats.", "caen_bonsoldat",[]],
  [anyone|plyr ,"caen_bonsoldat", [],"Si ils sont tous aussi vif d'esprit que vous,me voila rassuré !", "close_window",[]],
  
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_chateau_garde3"),
    ],
    "Mes respects Monseigneur.", "ducale_monss11", []],
  
  [anyone|plyr ,"ducale_monss11", [],  "...", "close_window", []],
  
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_chateau_garde4"),
    ],
    "Mes respects Monseigneur.", "ducale_monss12", []],
  
  [anyone|plyr ,"ducale_monss12", [],  "Merci...enfin,je veux dire...non rien.", "close_window", []],
  
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_chateau_garde5"),
    ],
    "Mes respects Mon seigneur.", "ducale_monss1z", []],
  
  [anyone|plyr ,"ducale_monss1z", [],  "...", "close_window", []],
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_chateau_gardecour"),
    ],
    "Mes respects Mon seigneur.", "ducale_monss1s", []],
  
  [anyone|plyr ,"ducale_monss1s", [],  "...", "close_window", []],
  
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_chateau_invitespec"),
    ],
    "Salutations distinguées cher ami, estes vous parenté au comte ?", "ducale_paren", []],
  
  [anyone|plyr ,"ducale_paren", [],  "Et bien...non,je doit vous laisser.", "close_window", []],
  
  #REBEL EXTRACTION!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_chateau_rebel"),
      (eq, "$comttcaennenfinmortt", 1),
    ],
    "Alors...ce batard es mort?", "ducale_comtedeadd", []],
  
  [anyone|plyr ,"ducale_comtedeadd", [],  "On ne peut plus mort,partons vite.", "ducale_comtfuitt", []],
  [anyone ,"ducale_comtfuitt", [],"Merde,tirons nous d'ici.", "close_window",
    [
      #  (call_script, "script_succeed_quest", "qst_rebel_assas_comtcaen"),
      (call_script, "script_change_player_relation_with_faction_ex", "fac_kingdom_2", -4),
      (jump_to_menu, "mnu_town"),
      (finish_mission),
  ]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_chateau_rebel"),
      (eq, "$comttcaennenfinmortt", 0),
    ],
    "Alors...ce batard es mort?", "ducale_rebelbatar", []],
  
  [anyone|plyr ,"ducale_rebelbatar", [],  "Je ne peut plus remonter,la mission...es un echec.", "close_caenechec", []],
  [anyone ,"close_caenechec", [],"Merde,tirons nous d'ici.", "close_window",
    [
      (jump_to_menu, "mnu_town"),
      (finish_mission),
  ]],
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_chateau_invitee1"),
    ],
    "Ces banquets sont si enuyeux,on ne fait que boire ,manger et boire encore...", "ducale_convivboir", []],
  
  [anyone|plyr ,"ducale_convivboir", [],  "J'avoue avoir tres peut l'occasion de m'enuyer.", "caen_enuyy", []],
  [anyone ,"caen_enuyy", [],"Que voullez vous dire? un trait d'esprit que je ne comprend pas,comme c'est domage,cela aurais put égayer cette...soiré.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_chateau_invitee2"),
    ],
    "La france appartiendra bientot a l'Angleterre soyez en sur.", "ducale_franceang", []],
  
  [anyone|plyr ,"ducale_franceang", [],  "Des nouvelles du front ?.", "jeanne_caen_nouv", []],
  [anyone ,"jeanne_caen_nouv", [],"Cette corcière paysane,continue de provoquer la révolte,c'est inacceptable,il faudrais mander un assassin coute que coute.", "close_window",[]],
  
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_chateau_invitee3"),
    ],
    "Este vous dans le comerce ou bien...austre chose ?.", "ducale_comerce", []],
  
  [anyone|plyr ,"ducale_comerce", [],  "Et vous,je devine a vostre allure,que vous etes le plus habile marchand de nous tous,avez vous de nombreux biens?", "caen_nbiens", []],
  [anyone ,"caen_nbiens", [],"Oh,oh...vous avez deviné Messire,je posséde de nombreuses écuries,nous fabriqons aussi des bateaux voyez vous,cette soiré s'annonce délicieuse.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_chateau_invitee4"),
    ],
    "Ne pourlions pas...nee,hips!...nous... ?", "ducale_ivre", []],
  
  [anyone|plyr ,"ducale_ivre", [],  "Comment est le vin messire ?", "caen_vii", []],
  [anyone ,"caen_vii", [],"Pouué!...rho...né renviendrez vouus?", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_chateau_invitee5"),
    ],
    "C'est la fin de la Chevalerie Messire,j'en es bien peur...Autrefois,nous nous battions a armes égales sures de nostre bon droit.comment va finire cette guerre ,je vous le demande.", "ducale_chevalier", []],
  
  [anyone|plyr ,"ducale_chevalier", [],  "Il nous es parfois offert dans une rencontre de pouvoir cotoyer un vrais Chevalier GentilHomme quelque soit son camp.", "caen_gentil", []],
  [anyone ,"caen_gentil", [],"Ha?!...et ce Chevalier,vous l'avez rencontré ?", "caen_assur",[]],
  
  [anyone|plyr ,"caen_assur", [],  "Assurément...", "close_window", []],
  
  #TOUR DES PINS
  #sentinelle
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_1"),
      (eq, "$quetmontpelierravitailee", 1),
    ],
    "Tu peut passer.", "pin_sepiasser", []],
  
  [anyone|plyr ,"pin_sepiasser", [],  "Tu fais un travail remarquable compagnon.", "pin_sepiasser2", []],
  
  [anyone ,"pin_sepiasser2", [],"C'est ca, rit de moi, pfeu!", "close_window",[]],
  # 2eme auto talk
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_1"),
      (eq, "$parler_guard_montpellier", 1),
    ],
    "Je ne te fait pas confiance,malgrés tout,alors garde tes mains loing de tes armes.", "pin_sentend", []],
  
  [anyone|plyr ,"pin_sentend", [],  "Je m'en souviendrais.", "close_window", []],
  
  #  auto talk
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_1"),
    ],
    "Halte! qui es tu,et que fait tu ici ?.", "pin_sent1", [(play_sound, "snd_alt"),]],
  
  [anyone|plyr ,"pin_sent1", [],  "Michel m'a envoyé ici pour rencontrer votre chef.", "pin_welcom", [(assign, "$parler_guard_montpellier", 1),]],
  # [anyone|plyr ,"pin_sent1", [],  "Je me suis égaré mais je m'en vais.", "close_window", []],
  
  [anyone ,"pin_welcom", [],"Ah! tres bien,tu peut passer camarade.", "close_window",[]],
  
  
  #accolyte3
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_2"),
      (eq, "$quetmontpelierravitailee", 1),
    ],
    "J'en es assez de tout ca.", "pin_mmaarr", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"pin_mmaarr", [],  "Tu n'as qu'a partir c'est simple.", "pinss_partirsimpl1", []],
  
  [anyone ,"pinss_partirsimpl1", [],"Et j'abondonerais mes compagnons? pour qui me prend tu?.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_2"),
    ],
    "Alors,on es venue s'enliser dans ces Marais?", "pin_maarais1", []],
  
  [anyone|plyr ,"pin_maarais1", [],  "Comment vont les choses ici?", "pinss_maarais1", []],
  
  [anyone ,"pinss_maarais1", [],"Mal,tres mal,on meurt de faim et il n'y a plus de gibier par ici,sinon on es bien cachés,Oh je ne crain pas les Anglais,car c'est la faim qui va nous terasser.", "close_window",[]],
  
  #acolyte2
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_3"),
      (eq, "$quetmontpelierravitailee", 1),
    ],
    "Un peut de repos ne me ferais pas de mal.", "pin_reprep1", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"pin_reprep1", [],  "Qu'es ce qui t'use a ce point?", "ploincoupe", []],
  [anyone ,"ploincoupe", [],"Et qui a coupé le bois d'apres toi,hein ? non mais c'est incroyable.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_3"),
    ],
    "Bienvenue l'ami,comment te nome tu ?", "pin_mzzis1", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"pin_mzzis1", [],  "Je suis {playername}.", "pineeis1", []],
  [anyone ,"pineeis1", [],"Et bien,bienvenue {playername},trouve toi une place au sec,et ne t'inquiete pas tu ne sera pas embeté,il n'y a pas de mauvais bougres ici.", "close_window",[]],
  
  #accolite1
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_4"),
      (eq, "$quetmontpelierravitailee", 1),
    ],
    "J'ai besoin de boire,toute cette flote me donne soif.", "pin_flottd1", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"pin_flottd1", [],  "Tu n'as qu'a boire l'eau des marais.", "close_window", []],
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_4"),
    ],
    "Comment te sens tu ?", "pin_find1", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"pin_find1", [],  "Un peut humide...ou es votre chef?", "pin_find1e", []],
  [anyone ,"pin_find1e", [],"Tu veux dire notre chef,Il est en haut de sa tour comme toujours,j'éspère qu'il cherche un moyen de nous trouver a manger.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_5"),
    ],
    "Bien le bonjour.", "pin_haut", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"pin_haut", [],  "Ou es le chef?", "pin_hautd", []],
  [anyone ,"pin_hautd", [],"La,tout en haut.", "close_window",[]],
  
  #sniper
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_6"),
      (eq, "$quetmontpelierravitailee", 1),
    ],
    "Salutations.", "pin_arbamurapres", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"pin_arbamurapres", [],"Salutations,toujours dans les courants d'air?", "pinsclose", []],
  [anyone ,"pinsclose", [],"oui,mais toi qui reste en bas tu risque beaucoup plus que moi,tu sais c'est etrange mais ca fait un moment que je ne suit pas descendue de cette tour.", "close_window",[]],
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_6"),
    ],
    "Salutations.", "pin_arbamur", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"pin_arbamur", [],"Salutations,j'ai entendue dire que vous donniez des rècompensses aux mercenaires,c'est bien ca?.", "pin_arbamurdd", []],
  [anyone ,"pin_arbamurdd", [],"Des...Ha,ha,ha,ha!", "close_window",[]],
  
  #segond chef
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_7"),
      (eq, "$quetmontpelierravitailee", 1),
    ],
    "Merci pour tout camarade.", "pin_mercicaseg", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"pin_mercicaseg", [],"C'est tout naturel.", "close_window", []],
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_7"),
    ],
    "Ca fait plaisir de voir des nouvelles têtes,va parler au chef.", "pin_arbamurdd11", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"pin_arbamurdd11", [],"Tres bien.", "close_window", []],
  
  # # # # # # # # # # # # # # # # # # # # # # # # # # # # #CHEFrebelc1 gordedes
  ##################################################  ##################################################
  
  
  ########dernier dial tour des pins
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_8"),
      (eq, "$dernier_dialchefpinstour", 1),
      
    ],
    "{playername},c'est toujours un plaisir de te revoir.comment ca va?", "dern_dialchefpi", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"dern_dialchefpi", [], "Je me débrouille...et vous?", "dern_dialchefpi2",[]],
  
  [anyone ,"dern_dialchefpi2", [],"On s'en sort comme on peut,meme si c'est pas toujours facile.", "close_window",[]],
  
  
  ##
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_8"),
      (player_has_item, "itm_plis_toul"),#a la lettre
      (check_quest_active, "qst_rebel_chearchcamp"),
      (neg|check_quest_succeeded, "qst_rebel_chearchcamp"),
      (neg|check_quest_finished, "qst_rebel_chearchcamp"),
    ],
    "De retour? comment t'en sort tu en Bourgogne?", "plis_toulnot", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"plis_toulnot", [], "Je suis allé a Toul,mais les Rebelles n'y sont plus.j'ai trouvé cette note a la place,mais elle semble codée.", "plis_toulnot2",[]],
  
  [anyone ,"plis_toulnot2", [],"Fait moi voir...", "plis_toulnot3",[(troop_remove_item, "trp_player","itm_plis_toul"),]],
  [anyone ,"plis_toulnot3", [],"Oui c'est bien ca,c'est un code assez simple mais indéchiffrable au cas ou nous devions laisser des indications sur le terrain.les Rebelles de Bourgogne disent qu'ils ont duent se déplacer,ils sont maintenant cachés dans la foret de Verzy,pret de Reims.tu sais ce qu'il te reste a faire.", "plis_toulnot4",[]],
  
  [anyone|plyr ,"plis_toulnot4", [], "Pourquois avoir changé d'endroit,et m'avoir fait faire tout ce chemin?", "plis_toulnot5",[]],
  
  [anyone ,"plis_toulnot5", [],"Aucune idée,tu leur demanderas,bonne chance.", "close_window",
    [(assign, "$dernier_dialchefpinstour", 1),(call_script, "script_note_toul"),]],
  
  ########
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_8"),#n'a pas la lettre
      (check_quest_active, "qst_rebel_chearchcamp"),
      (neg|check_quest_succeeded, "qst_rebel_chearchcamp"),
      (neg|check_quest_finished, "qst_rebel_chearchcamp"),
    ],
    "De retour? comment t'en sort tu en Bourgogne?", "noplis_toulnot", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"noplis_toulnot", [], "Je ne trouve pas les Rebelles a Touls,ils ont duent changer de coin.", "noplis_toulnot2",[]],
  
  [anyone ,"noplis_toulnot2", [],"Et bien,les endroits les plus propices a rester dissimulés tout en étant assez proche de l'ennemi ce sont les forets.tu devrais chercher dans les forets pret des villes Bourgignones,Reims ou Metz semble etre des endroits parfaits.", "close_window",
    [
      ########cacher touls montrer verzy
      (assign, "$dernier_dialchefpinstour", 1),
      (call_script, "script_note_toul"),
  ]],
  
  
  
  ####################################################
  ### en atente de nouvelles de Toul
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_8"),
      (eq, "$sipastrouveplisi", 1),
      #(check_quest_active, "qst_rebel_toul"),
      #(neg|check_quest_succeeded, "qst_rebel_toul"),
      # (neg|check_quest_failed, "qst_rebel_toul"),
      #(neg|check_quest_finished, "qst_rebel_toul"),
    ],
    "Content de te revoir Compagnon! tu as l'air de te porter bien,comment vont les choses a Touls?", "reb_toulnotway", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"reb_toulnotway", [], "Je n'y suis pas encore allé,d'autres affaires urgentes me retiennent.", "reb_toulnotway2",[]],
  
  [anyone ,"reb_toulnotway2", [],"Fait de ton mieux,et tu sera toujours le bienvenue au camp.", "close_window",[]],
  
  
  ######################si mission ataque camp sautee
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_8"),
      (eq, "$next_rebelquettette", 1),
    ],
    "C'est grande Joie Compagnon,nous avons enfin trouvé notre voie.aprés toutes ces années a tourner en rond de caches en campements pourchassés par les patrouilles d'Anglois,nous savons maintenant quois faire,attaquer les convois et les campements génera grandement la stratégie Anglobourgignone visant a s'établire dans le sud.quand a toi,tu nous a bien aidé,mais tu ne nous es d'aucune utilité ici nous saurons nous en sortire,le camp de Rebelles qui opère en Bourgogne a surement plus de mal a etre efficace que nous et il leur faut des hommes.j'es envoyè dèja certains gars d'ici,tu devrais les rejoindres ils se sont établis dans le village desert de Toul au sud de Metz.", "reb_toulgo", [(play_sound, "snd_rebels_greetings"),]],
  [anyone ,"reb_toulgo", [],"Ce village etait autrefois gagné par la peste,mais ne t'inquiète pas tu ne risque rien,c'est finis depuis longtemp.par contre cet endroit lugubre que certains disent hanté etait l'endroit parfais pour leur cache...va les trouver et demande leur de quois ils ont besoin,si tu veux toujours servire la cause,et ca je l'éspère,tu es un bon ellement.", "reb_toulgo2",[]],
  
  [anyone|plyr ,"reb_toulgo2", [], "Tres bien,j'irais au village de Toul,je suis moi meme opposé aux Anglois.", "reb_toulgook",
    [
  ]],
  [anyone|plyr ,"reb_toulgo2", [], "Je ne saurais dire si votre cause es la voie que je veux suivre,j'y réflèchirais.", "close_window",[]],
  
  [anyone ,"reb_toulgook", [],"Parfais,bonne route Compagnon...Je ne sais quois t'offrir pour ton aide je ne posséde plus rien,mais je t'offre volontier mon cheval,c'est une tres bonne monture,va l'ami et que Dieu te protège.", "close_window",
    [
      #donner cheval /lancer quete/aparaitre ppartie village Toul
      (troop_add_item, "trp_player", "itm_hunter_f", 0),
      (assign, "$sipastrouveplisi", 1),
      (party_set_flags, "p_toul_village", pf_disabled, 0),
      (party_set_flags, "p_toul_village", pf_always_visible, 1),
      (party_set_flags, "p_toul_village", pf_quest_party, 1),
  ]],
  
  
  
  ################################################## mision next
  
  #mission win
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_8"),
      (check_quest_succeeded, "qst_rebel_camp_atck1"),
      (neg|check_quest_failed, "qst_rebel_camp_atck1"),
    ],
    "Alors avez vous rasé ce camp?", "cour_demolicampeng", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"cour_demolicampeng", [], "C'est fait,ils ne sont plus.", "cour_demolicampeng2",
    [
      ###fail et variable suite...
      (call_script, "script_end_quest", "qst_rebel_camp_atck1"),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", 2),
      (call_script, "script_change_player_relation_with_faction_ex", "fac_kingdom_1", 1),
      (call_script, "script_change_troop_renown", "trp_player", 2),
  ]],
  
  [anyone ,"cour_demolicampeng2", [],"Ca alors,j'ai du mal a y croire.nous arivons enfin a quelque chose! nous devons poursuivre notre action compagnon,ne pas relacher la pression et rester fort dans les moments difficiles,a present laisse moi,je doit réflèchir,et...encore merci.", "close_window",
    [
      (assign, "$next_rebelquettette", 1),
      (party_set_flags, "p_camp_anglais", pf_always_visible, 0),
      (party_set_flags, "p_camp_anglais", pf_disabled, 1),
  ]],
  
  
  #mission FAIL
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_8"),
      (check_quest_failed, "qst_rebel_camp_atck1"),
      (neg|check_quest_succeeded, "qst_rebel_camp_atck1"),
    ],
    "Alors avez vous rasé ce camp?", "cour_failldemolicampeng", []],
  
  [anyone|plyr ,"cour_failldemolicampeng", [], "Non,nous avons été vaincus,j'en suis navré.", "cour_failldemolicampeng2",
    [
      ###fail et variable suite...
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -2),
  ]],
  
  [anyone ,"cour_failldemolicampeng2", [],"Merde,juste quand on commencais a s'en sortire.ce n'es pas de votre faute je suis sur que vous avez fait de votre mieux,peut etre sont t'ils trop forts pour le moment.laisse moi seul camarade je doit réflèchire.", "close_window",
    [
      ###variable ici si besoin...
      (assign, "$next_rebelquettette", 1),
      (party_set_flags, "p_camp_anglais", pf_always_visible, 0),
      (party_set_flags, "p_camp_anglais", pf_disabled, 1),
  ]],
  
  
  
  ################################################## mision next
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_8"),
      (check_quest_active, "qst_rebel_camp_atck1"),
      (neg|check_quest_succeeded, "qst_rebel_camp_atck1"),
      (neg|check_quest_failed, "qst_rebel_camp_atck1"),
      (neg|check_quest_finished, "qst_rebel_camp_atck1"),
    ],
    "Alors avez vous rasé ce camp?", "cour_dataquecampenglishlish", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"cour_dataquecampenglishlish", [], "Pas encore,mais on s'en occupe.", "close_window",[]],
  [anyone|plyr ,"cour_dataquecampenglishlish", [], "Je m'excuse compagnon,mais je ne peut pas m'occuper de ca.", "cour_dataquecampenglishlishfail",
    [
      ###fail et variable suite...
      (call_script, "script_fail_quest", "qst_rebel_camp_atck1"),
      (call_script, "script_end_quest", "qst_rebel_camp_atck1"),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -4),
      (party_set_flags, "p_camp_anglais", pf_always_visible, 0),(party_set_flags, "p_camp_anglais", pf_disabled, 1),
  ]],
  
  [anyone ,"cour_dataquecampenglishlishfail", [],"Je ne peut pas te forcer pas vrais? mais pensse au fait que si nous n'agissons pas,les Anglois seront a notre porte sous peut,et il te dicterons la facon dont tu devra vivre et je ne te parle pas du reste...", "close_window",
    [
      ###variable ici
      (assign, "$next_rebelquettette", 1),
  ]],
  
  
  
  #############################################################################################################################################################
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_8"),
      (eq, "$derierequetpiinsok", 1),
    ],
    "Pret pour la suite compagnon?", "canglais_batpretpuy",[]],
  [anyone|plyr ,"canglais_batpretpuy", [],"la suite?", "canglais_batpretpuy2",[]],
  [anyone|plyr ,"canglais_batpretpuy", [],"Pas pour le moment,je suis assez...fatigé.", "close_window",[]],
  
  [anyone ,"canglais_batpretpuy2", [],"Nous avons a manger,nous avons des armes,et nous sommes opposés a l'envahisseur,que faut t'il de plus pour que nous passion enfin a l'action? mon plan es de géner l'ennemi le décourager,au point ou le Regent d'Angleterre lui meme se dise qu'il n'a plus rien a faire en France,qu'ils ramasse ses soit disant soldat,qu'il les jette dans un bateau et qu'il disparaissent tous.", "canglais_batpretpuy3",[]],
  
  [anyone|plyr ,"canglais_batpretpuy3", [],"Je suppose que tu as toi meme souffert dans cette guerre.", "canglais_batpretpuy4",[]],
  
  [anyone ,"canglais_batpretpuy4", [],"Non ne te meprend pas,meme si j'ai perdu des proches dans cette guerre,je n'en aime pas moin la France et j'oeuvre uniquement pour son bien.avant les combats,j'etait le Maistre de Guilde des marchants dans une ville calme,et sais tu ce qui es arivé la bas? les Anglois nous on assiegés,nous leur avons fait part de notre rédition,mais pris dans une fureur causée par leur dernière bataille qui s'est soldée par un échec,ils ont tout brullé et ont tué tout le monde,sauf ceux qui ont put fuir.malheureusement j'était de ceux la.tu voie,les gens aspirent a une vie tranquile,et pour cela il faudra que l'on se batte meme au peril de notre vie car il est impossible de toute facon de vivre avec les Anglois.", "canglais_batpretpuy5",[]],
  
  [anyone|plyr ,"canglais_batpretpuy5", [],"Que compte tu faire alors?.", "canglais_batpretpuy6",[]],
  
  [anyone ,"canglais_batpretpuy6", [],"Un post avancé a été découvert par une de nos patrouilles non loing du chateau du puy,a quelques lieux d'ici.il est évident que les Anglois compte assieger le chateau pour s'assurer un post avancé dans notre secteur en comptant sur la population pour dénoncer la position des Rebelles,c'est a dire nous.je pensse que tout ca vise a conquerire le sud de la France a long thèrme.allons les trouver et boutons les hors de la région,ils n'aurons pas d'autre choix que de se replier en Guyenne,au moin ils ne pourons pas s'étendre pour le moment,peut tu t'en charger compagnon?", "canglais_batpretpuy7",[]],
  
  [anyone|plyr ,"canglais_batpretpuy7", [],"Si je peut oeuvrer a long therme contre les Anglais,je ne suis pas contre.", "canglais_batpretpuy7ok",[]],
  [anyone|plyr ,"canglais_batpretpuy7", [],"Votre cause ne me raporte rien et j'es besoin d'or,J'irais voir ce camp plus tard.", "close_window",
    [
      ###reprend plus tard la quete
  ]],
  
  
  [anyone ,"canglais_batpretpuy7ok", [],"Nous te remercions.le campement ou ils se regroupent se trouve pres du chateau du Puy,je te le montre sur ta carte...ca n'es pas tres compliqué,ils ne doivent pas nous attendre,restez groupés et attaquez les petits groupes ca devrais faire la différence par apport a leur entrainement et leur experience.je vais demander a d'autres groupes de se rendre la bas,ne t'inquiéte pas nous serons assez nombreux,par contre il nous faut agire vite avant qu'ils ne recoivent plus de troupes.", "canglais_batpretpuy7ok2",[(party_set_flags, "p_camp_anglais", pf_disabled, 0),(party_set_flags, "p_camp_anglais", pf_always_visible, 1),(party_set_flags, "p_camp_anglais", pf_quest_party, 1),]],
  
  [anyone|plyr ,"canglais_batpretpuy7ok2", [],"Tres bien,je m'y rend aussi.", "canglais_batpretpuy7ok3",[]],
  
  [anyone ,"canglais_batpretpuy7ok3", [],"Bonne chance,et soyez vaillants au combat.que Dieu vous accompagnes Compagnons.", "close_window",
    [
      #show "partie" lancer quet et le reste !!!!!!!!!!!!!!!!!!!!!!!!!
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le chef des Rebelles de Montpelier veux raser le camp qui s'est établis pret du chateau du Puy,il compte sur l'effet de surprise pour que nous puissons l'emporter,des autres Rebelles m'attendent la bas."),
      (call_script, "script_start_quest", "qst_rebel_camp_atck1", "$g_talk_troop"),
      #show "partie" !!!!!!!!!!!!!!!
  ]],
  
  
  
  
  
  
  
  ####################################
  #victoire convoi
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_8"),
      (eq, "$enfinendconv", 1),
    ],
    "Alors comment ca s'est passé avec le convoi?", "pin_2ggg3cpassecovoyi",[(play_sound, "snd_rebels_greetings"),]],
  [anyone|plyr ,"pin_2ggg3cpassecovoyi", [],"On les as eu!", "pins_f31maluuse",
    [
      (call_script, "script_end_quest", "qst_rebel_attack_c1"),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", 4),
  ]],
  [anyone ,"pins_f31maluuse", [],"Quois? j'en crois pas mes oreilles,ha,ha! c'est une grande victoire pour la rebellion crois moi,fêtons ca comme il se doit,nous verons plus tard pour le reste,je voie que tu as gardé des armes du convoi,garde les avec toi tu les as bien gagnés! on se voie plus tard d'accord ? laisse moi savourer cette victoire.", "close_window",[(assign, "$derierequetpiinsok", 1),]],
  
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_8"),
      (eq, "$enfinendconv", -1),
    ],
    "Alors comment ca s'est passé avec le convoi?.", "pin_2cparrssecovoyi",[(play_sound, "snd_rebels_greetings"),]],
  [anyone|plyr ,"pin_2cparrssecovoyi", [],"Ca a quelque peut...raté.", "pins_2mffaluuse",
    [
      (call_script, "script_fail_quest", "qst_rebel_attack_c1"),
      (call_script, "script_end_quest", "qst_rebel_attack_c1"),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -4),
  ]],
  [anyone ,"pins_2mffaluuse", [],"Quelque peut raté ? mais c'est pas vrais!...écoute on reparlera plus tard d'accord?", "close_window",[(assign, "$derierequetpiinsok", 1),]],
  #
  
  
  #faire entree au dessus resultat de quete,c'est fait/rat?et assigner des variables en combat pour ca
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_8"),
      (eq, "$partattaqueconv", 1),
    ],
    "Alors comment ca s'est passé avec le convoi?.", "pin_cpassecovoyidd",[(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"pin_cpassecovoyidd", [],"Je ne les es pas encore trouvés.", "close_window",[]],
  [anyone|plyr ,"pin_cpassecovoyidd", [],"Je ne peut pas m'en occuper désolé.", "pins_maluushhe",
    [
      (call_script, "script_fail_quest", "qst_rebel_attack_c1"),
      (call_script, "script_end_quest", "qst_rebel_attack_c1"),
      # (troop_set_slot, "$g_talk_troop", "p_main_party"),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -4),
  ]],#!!!!!!!!!!!!!!!!!!!!!!!!!!!casser la quete /baisser relation/assigner variable quete suivante possible la meme variable que quete ccomplie
  
  [anyone ,"pins_maluushhe", [],"C'est pas vrais...je ne veux pas t'accabler,mais des vies dependaient du resultat de cette mission,écoute,on se voie plus tard d'accord?", "close_window",[(assign, "$derierequetpiinsok", 1),]],
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_8"),
      (eq, "$quetmontpelierravitailee", 1),
    ],
    "C'est un plaisir de pouvoir compter sur toi.", "pin_comptsur",[(music_set_situation, 0),(play_sound,"snd_adrenaline_generique1"),]],
  
  [anyone|plyr ,"pin_comptsur", [],"Parle moi de la résistance.", "close_parlechefg",[]],
  [anyone|plyr ,"pin_comptsur", [],"Que pensse tu de la compagnie mercenaire du SansLys ?", "close_parlechefgsngsl",[]],
  [anyone|plyr ,"pin_comptsur", [],"Que fesons nous maintenant?", "pin_quoisfairnew", []],
  
  [anyone ,"close_parlechefg", [],"Nous ne sommes encore que des groupes disperssés a travers la france,mais nous commencons a nous rassembler et a nous organiser pour luter sous l'initiative d'un noble mysterieux,il se fait appeler la Licorne,tu doit en avoir au moin entendue parler,mais personne ne sait qui il est.", "pin_comptsur",[]],
  [anyone ,"close_parlechefgsngsl", [],"Ce sont des salauds,ils travaillent pour le plus offrant a la solde de leur chef,un noble sans scrupules avide de richesses,son plan es de remplire ses coffres en s'entourant des soldats les plus forts pour en suite s'attaquer aux faibles.aujourd'hui ils sont de notre coté mais demain ils seront contre nous,a mon sens seule notre cause es juste.", "pin_comptsur",[]],
  [anyone ,"pin_quoisfairnew", [],"Maintenant que nous sommes rassasiés,il nous faut nous armer d'avantage,car ce que nous n'avons pas et que les soldats anglais ou bourgignons ont c'est l'entrainement,j'éstime que nous pouvons compensser cela en nous armant de ce qu'il existe de mieux,arbaletes,couleuvrines,les armes les plus tranchantes et percantes faites du meilleur acier.", "pin_quoisfairnewsuit",[]],
  [anyone|plyr ,"pin_quoisfairnewsuit", [],"Ca semble etre un bon debut,mais ou trouver de telles armes et si chères?", "pin_quoisfairnewsuit2", []],
  [anyone ,"pin_quoisfairnewsuit2", [],"Les Anglois ravitaillent des villes aquises et fortifiées a leurs postes avancés,ils leur enménent les armes qu'il nous faut,non seulement elles manqueront a leurs troupes mais de plus elles seront entres nos mains!.", "pin_savamennt",[]],
  [anyone|plyr ,"pin_savamennt", [],"Savament penssé.", "pin_quoisfairnewsuit23", []],
  [anyone ,"pin_quoisfairnewsuit23", [],"Tu tombe on ne peut mieux,un front s'ouvre non loing d'ici,il vise a empecher les Rebelles de circuler librement de notre position qu'ils ont vagement reperé,jusqu'au fronts plus au nord,de ce fait si nous les anéantissons,nous découragerons leurs efforts a se deployer dans toute la france et nous les forcerons a renforcer leurs positions principales.", "pin_posprincip",[]],
  [anyone|plyr ,"pin_posprincip", [],"Un plan digne d'un grand maréchal!.", "pin_digndun", []],
  [anyone ,"pin_digndun", [],"Merci,le problème voie tu,c'est que bien qu'ils soient peut nombreux,ils sont puissament équipés,il nous faut renversser la tendance,en attaquant chaquns d'entres eux en surnombre,cela fait un moment que nous les observons de loing et tu tombe a pic pour une embuscade,tu va te joindre a nous naturellement?", "pin_jointu",[]],
  
  
  # donner quete/variable/et gain relation pour suite/lancer quete de l'attaque convoi
  [anyone|plyr ,"pin_jointu", [],"J'en suis!", "pin_ouiattaque",
    [
      #(setup_quest_text, "qst_rebel_attack_c1"),#?
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le chef Rebelle de Montpellier m'as chargé d'intercepter le convoi d'armes pret du village de Rodez,je peut enroller des Rebelles qui patrouillent pret de Bourges si j'ai besoin de reforts."),
      (call_script, "script_start_quest", "qst_rebel_attack_c1", "$g_talk_troop"),
      (set_spawn_radius, 2),
      (spawn_around_party, "p_village_84", "pt_english_con"),
      (party_set_flags, reg0, pf_always_visible, 1),
      (assign, "$partattaqueconv", 1),
      #
      #(set_spawn_radius,1),(spawn_around_party,"p_village_48","pt_order_of_night"),
  ]],
  #
  
  [anyone|plyr ,"pin_jointu", [],"Pour le moment,je préfère rester neutre.", "close_window", []],
  [anyone ,"pin_ouiattaque", [],"C'est parfait! le prochain convoi ne devrais pas etre trop long a ariver,va l'intercepter pres de Rodez,cherche des groupes de Rebelles et dit leurs de te rejoindre pour l'assaut,si tu n'en trouve pas dans le secteur,remonte jusq'aux environs de bourges,bonne chance compagnon.", "close_window",
    []],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_8"),
      (check_quest_active, "qst_rebelvivre_montpelier"),
      (neg|check_quest_succeeded, "qst_rebelvivre_montpelier"),
      (player_has_item, "itm_bread"),
      (player_has_item, "itm_rhumm"),
      (player_has_item, "itm_cheese"),
      (player_has_item, "itm_dried_meat"),
    ],
    "Incroyable! vous les avez,vous avez les provisions! on va pouvoir manger! comment vous remercier camarade?", "pin_deautrechhssj",
    [
      (troop_remove_item, "trp_player", "itm_bread"),
      (troop_remove_item, "trp_player", "itm_rhumm"),
      (troop_remove_item, "trp_player", "itm_cheese"),
      (troop_remove_item, "trp_player", "itm_dried_meat"),
      (call_script, "script_end_quest", "qst_rebelvivre_montpelier"),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", 2),
      (assign, "$quetmontpelierravitailee", 1),
  ]],
  
  [anyone|plyr ,"pin_deautrechhssj", [],"A vous de trouver quelque chose.", "pin_autechoises",[]],
  [anyone|plyr ,"pin_deautrechhssj", [],"Ce n'etait rien.", "close_window", []],
  
  [anyone ,"pin_autechoises", [],"Naturellement,maintenant que tu es des notres,je vais te confier nos secrets,les Rebelles sont aidés par le peuple,certains font semblant d'avoir une soudaine admiration pour l'angleterre,mais en réalité ils mettent de coté pour nous des armes et d'autres ressources,je ne conais qu'un contact,c'est un marchant de la rue comercante de bordeau,c'est le vendeur de livres,va le voir quand tu sera dans le besoin et il te remettra de l'or,dit lui simplement que l'archange michael a faim,et il saura quois faire.", "pin_autechoises2",[]],
  [anyone|plyr ,"pin_autechoises2", [],"Je m'en souviendrais.", "close_window",[(assign, "$ressourcesrebeladmirbord", 1),]],
  
  #si pas revenu avec les vivre mais pas d'autres possibilit? de phrases:couper
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_8"),
      (eq, "$wherevivrequestnot", 1),
    ],
    "Va tu nous ramener de quois manger?.", "pin_alorsfin",[]],
  
  [anyone|plyr ,"pin_alorsfin", [],"J'y travaille.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_8"),
      (eq, "$deuxiemechanquestpins", 1),
    ],
    "Alors,vous avez changé d'avis? mes hommes sont sur le point de mourire de faim,allez juste nous chercher quelques vivres je vous en prie.", "pin_twochance",[(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"pin_twochance", [],"C'est d'accord,je vais vous ranener des vivres.", "close_twoochanc",
    [
      (str_store_party_name, s9, "$current_town"),
      (str_store_string, s2, "@J'ai été chargé de ravitailler en provisions la troupe de Rebelles dissimulés a {s9},sur le point de mourire de faim,ils m'ont comendé un tonneau d'hydromel,une unité de pain,de fromage et un jambon."),
      (call_script, "script_start_quest", "qst_rebelvivre_montpelier", "$g_talk_troop"),
      (play_sound,"snd_start_quest"),
      (assign, "$wherevivrequestnot", 1),
  ]],
  [anyone|plyr ,"pin_twochance", [],"Je ne peut pas,j'es déja bien assez de problèmes.", "close_window", []],
  [anyone ,"close_twoochanc", [],"Vraiment ? nous comptons sur vous,je vous en prie,ne les dècevez pas,ils attendent un vrais repas depuis si longtemp.", "close_window",[]],
  
  #  start chief rebel
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_montpelier_tower_8"),
    ],
    "Ne touchez pas a vos armes,et dites moi qui vous etes.", "pin_cheffd",
    [
      # (call_script, "script_succeed_quest",
      (call_script, "script_end_quest", "qst_rebelc1"),
  ]],
  [anyone|plyr ,"pin_cheffd", [],"Je suis {playername},et c'est Michel qui m'envoie,nous avons voyagé enssembles et il m'a proposé de travailler pour vous,il m'as aussi parlé de récompensse.", "pin_cheffdff", []],
  [anyone ,"pin_cheffdff", [],"De...récompensse,et bien a dire vrais,je n'aprouve pas les méthodes de Michel,bien qu'il nous fait parvenire pas mal de main d'oeuvre,il ne devrais pas...mentire.", "pin_cheffdff2",[]],
  [anyone|plyr ,"pin_cheffdff2", [],"Je voie.", "pin_cheffdff3", []],
  [anyone ,"pin_cheffdff3", [],"A vrais dire nous n'avons rien,et nous mouront de faim,mais notre cause es juste,et j'ose éspérer que cela va vous toucher et que vous vous joindriez a nous,croyez moi,tot ou tard nous vous rendrons au centuple tout ce que vous pouriez faire pour nous.", "pin_cheffdff5e",[]],
  [anyone|plyr ,"pin_cheffdff5e", [],"Bon,et que puis je faire pour vous aider?", "pin_caider", []],
  [anyone|plyr ,"pin_cheffdff5e", [],"Cest donc une sorte de placement,soit ,que puis je faire pour vous?", "pin_caider", []],
  [anyone|plyr ,"pin_cheffdff5e", [],"Je perd mon temp,adieu.", "close_window", [(assign, "$deuxiemechanquestpins", 1),]],
  [anyone ,"pin_caider", [],"Et bien comme vous l'aurais compris,nous n'avons aucunes victuailles,je doit trouver a manger au plus vite pour mes hommes ou ils vont s'en aller,je crain meme une mutinerie,nous avons éstimé qu'il nous fallais un tonneau d'hydromel,du pain,du fromage et du jambon,c'est le moin que je puisse faire pour remonter leur morale.", "pin_nouriss",[]],
  [anyone|plyr ,"pin_nouriss", [],"C'est d'accord,je vais voir ce que je peut faire.", "close_pinchef",
    [
      (play_sound,"snd_start_quest"),
      (setup_quest_text, "qst_rebelvivre_montpelier"),#?
      (str_store_party_name, s9, "$current_town"),
      (str_store_string, s2, "@J'ai été chargé de ravitailler en provisions la troupe de Rebelles dissimulés a {s9},sur le point de mourire de faim,ils m'ont comendé un tonneau d'hydromel,une unité de pain,de fromage et un jambon."),
      (call_script, "script_start_quest", "qst_rebelvivre_montpelier", "$g_talk_troop"),
  ]],
  [anyone|plyr ,"pin_nouriss", [],"Je ne peut pas,j'es déja bien assez de problèmes.", "close_window", [(assign, "$deuxiemechanquestpins", 1),]],
  [anyone ,"close_pinchef", [],"Vraiment ? nous comptons sur vous,je vous en prie,ne les dècevez pas,ils attendent un vrais repas depuis si longtemp.", "close_window",[(assign, "$wherevivrequestnot", 1),]],
  
  
  #########################################DIALS ACTEUR BATTLE ST BENEZET
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_milliceneutre1"),
    ],
    "Que faites vous sur les ramparts Messire?", "neutre_benezzendquete",[]],
  
  [anyone|plyr ,"neutre_benezzendquete", [],"Je me remémore de vieux souvenirs.", "close_window",[]],
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_milliceneutre2"),
    ],
    "Que faites vous la Messire?", "neutre_benezzendquete2",[]],
  
  [anyone|plyr ,"neutre_benezzendquete2", [],"Je me remémore de vieux souvenirs.", "close_window",[]],
  
  
  ######################################### tout es fini
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont1"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
      (eq, "$endendquestbenezett", 1),
    ],
    "Alors?", "spont_endquete",[]],
  
  [anyone|plyr ,"spont_endquete", [],"C'est términé,ils sont bien avec le Pape cela ne fait aucun doute,nous pouvons partire tranquilement.", "spont_endquete2",[]],
  [anyone ,"spont_endquete2", [],"Tant mieu,il ne me reste plus qu'a expliquer ca au maitre.j'éspère que tu ne t'es pas trompè,on partagera une chope a la taverne de Bourge si c'est le cas,au revoir camarade et merci pour ton aide.", "close_window",[]],
  
  ####### repert condition dial apres victoire
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont1"),
      (check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
    ],
    "Foutons le camp d'ici et prions pour ne pas avoir d'ennuis.", "spont_mauvaisquete",[]],
  
  [anyone|plyr ,"spont_mauvaisquete", [],"Je ne sais si ce que l'on viens de faire es vraiment juste,partons.", "close_window",[]],
  
  
  #############################attaque!!!
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont1"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
      (eq, "$deuxnextdialinquis", 1),
    ],
    "Alors?", "apon_en_ataquee",[]],
  
  [anyone|plyr ,"apon_en_ataquee", [],"Je ne sais pas,peut etre devrions nous attendre encore un peut un messager avans la rédition.", "apon_en_ataquee2",[(assign, "$departcomabatbeneset", 1),]],
  [anyone ,"apon_en_ataquee2", [],"Je n'aime pas ca et si...NON! ils nous attaquent! aux armes!!! déffendez vos vies malheureux.", "close_window",
    [
      ####ATAQUE!! play sound,refaire les equipes,disable dialogues
      #(call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -6)
      (play_sound,"snd_chrono_cry_alerte"),
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 1, 0, -1),
      (mission_disable_talk),
  ]],
  
  
  #####################en atente
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont1"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
      (eq, "$nextdialinquis", 1),
    ],
    "Et bien? va voir l'inquisiteur en face...que veux tu faire d'autre?", "strapon_en_attente",[]],
  
  [anyone|plyr ,"strapon_en_attente", [],"J'y vais,mais j'éspère qu'il ne me tirerons pas dessus.", "close_window",[]],
  
  #sl SERGEANT TROOP
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont1"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Que fait tu ici camarade? j'éspère que tu nous apporte les renforts ou un message.", "strapon_quesstbene",[(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"strapon_quesstbene", [],"Je suis bien en renfort mais je suis tout seul et je n'ai aucun message,le maitre me l'aurais donné.", "strapon_quesstbene2",[]],
  [anyone ,"strapon_quesstbene2", [],"Quois? le Maitre a vraiment des agissements douteux,soit ils nous prend pour des soldats invincibles,soit il veux notre mort.", "strapon_quesstbene3",[]],
  [anyone|plyr ,"strapon_quesstbene3", [],"Il m'as envoyé ici en renfort sans meme me dire qui nous assiegais,quelle es la situation?", "strapon_quesstbene4",[]],
  
  [anyone ,"strapon_quesstbene4", [],"Ha,Ha,Ha! pardonne moi,mais c'est risible vraiment,tu ne sais meme pas? et bien ouvre tes oreilles camarade,le Duc de provence es en pleine partie de bras de fer avec le Pape.a cause d'un désacord,il se trouve qu'Avignon sous la protection du Duc s'es retrouvée assiegée du jour au landemain et nous avons été embauchés pour résister a l'armée Papale,j'éspère que notre action es bien légitime,nous attendons un messager depuis si longtemp pour nous le confirmer mais personne ne viens et on es obligés de tenire le pont pour notre compagnie et le Duc de Provence,de plus nous avons été payés d'avance meme si nous avons déja tout dépennssé depuis longtemp.", "strapon_quesstbene5",[]],
  
  [anyone|plyr ,"strapon_quesstbene5", [],"Pardon? quelles sont les consséquences et quelles altèrnatives s'offrent a nous?", "strapon_quesstbene6",[]],
  
  [anyone ,"strapon_quesstbene6", [],"C'est assez simple,si nous ne sommes pas légitimes,un messager émissaire de la compagnie viendra tout aranger et nous dire de nous replier pour laisser Avignon au Pape,si nous sommes légitimes et de bon droit,nous devons continuer a déffendre le pont contre le possible usurpateur qu'es l'inquisiteur,en attendant nous devons tenire la ville par son unique entré,ce pont...", "strapon_quesstbene7",[]],
  
  [anyone|plyr ,"strapon_quesstbene7", [],"Et si l'armée du Pape attaque? combat ou rédition ?", "strapon_quesstbene8",[]],
  
  [anyone ,"strapon_quesstbene8", [],"Tu connais la situation...et je reffuse de prendre cette décision,car si nous sommes dans le mauvais chemin et que l'inquisiteur es légitime,nous risquons l'excomunication,la prison ou la peine capitale sur le buchet,quand a une possible rédition si c'etait nous qui avions raison et si l'on abandonne le Duc de provence nous aurions aussi les memes enuis,je reffuse donc de prendre cette décision sur une éventuielle rédition.", "strapon_quesstbene9",[]],
  
  [anyone|plyr ,"strapon_quesstbene9", [],"Je la prendrais moi.", "strapon_quesstbene10",[]],
  
  [anyone ,"strapon_quesstbene10", [],"Bien! commence par aller parler a l'inquisiteur,ca fait des jours qu'ils ne nous parle plus,peut etre attendent t'ils un message aussi,avec le cachet du pape nous prouvant leur bon droit,mais cela peut aussi etre un faut,je ne prendrais de décision qu'en ayant un message de notre compagnie.va voir l'inquisiteur dans leur camp,ne t'inquiéte pas il laisse passer les parlementaires.", "close_window",
    [
      (assign, "$nextdialinquis", 1),# # #
  ]],
  
  ##################################################
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont2"),
      (check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
    ],
    "Foutons le camp,le travail est finis ici.", "spont_mauvaisquete2",[]],
  
  [anyone|plyr ,"spont_mauvaisquete2", [],"Je ne sais si ce que l'on viens de faire es vraiment juste.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont2"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Content de voir du renfort camarade,meme si peut,va voir le sergeant sur les ramparts.", "sltrapon_ques1",[]],
  
  [anyone|plyr ,"sltrapon_ques1", [],"Vous n'etes pas tres nombreux non plus,une econamie du maitre de la compagnie je suppose.", "close_window",[]],
  
  
  ################################################## hhhvvv
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont3"),
      (check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
    ],
    "Ce fut une salle bataille.", "spont_mauvaisquete3",[]],
  
  [anyone|plyr ,"spont_mauvaisquete3", [],"Partons.", "close_window",[]],
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont3"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Ca fait des jours qu'ils ne nous parle meme plus,je n'aime pas ca,tu as été voir le sergeant de la compagnie sur les ramparts?", "sltrapon_ques2",[]],
  
  [anyone|plyr ,"sltrapon_ques2", [],"Ils ne savent peut etre pas quois dire...ne t'en fait pas.", "close_window",[]],
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont4"),
      (check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
    ],
    "Ce fut une salle bataille.", "spont_mauvaisquete4",[]],
  
  [anyone|plyr ,"spont_mauvaisquete4", [],"Partons.", "close_window",[]],
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont4"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Je ne m'y ferais pas,ca me rend nerveux d'attendre comme ca.", "sltrapon_ques3",[]],
  
  [anyone|plyr ,"sltrapon_ques3", [],"Ca finira bien un jour.", "close_window",[]],
  
  
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont5"),
      (check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
    ],
    "Ce fut une salle bataille.", "spont_mauvaisquete5",[]],
  
  [anyone|plyr ,"spont_mauvaisquete5", [],"Partons.", "close_window",[]],
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont5"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Va voir le sergeant sur les ramparts.", "sltrapon_ques4",[]],
  
  [anyone|plyr ,"sltrapon_ques4", [],"Je m'en occupe.", "close_window",[]],
  
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont6"),
      (check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
    ],
    "Ce fut une salle bataille.", "spont_mauvaisquete6",[]],
  
  [anyone|plyr ,"spont_mauvaisquete6", [],"Partons.", "close_window",[]],
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont6"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Qu'ils attaquent,pourquois attendre?", "sltrapon_ques5",[]],
  
  [anyone|plyr ,"sltrapon_ques5", [],"Ils préffére que l'on se rende,ils ne doivent pas comprendre que des mercenaires tiennent la ville a ce point,ils n'ont peut etre pas compris que la compagnie ne lachais pas un contrat.", "close_window",[]],
  
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont7"),
      (check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
    ],
    "Ce fut une salle bataille.", "spont_mauvaisquete7",[]],
  
  [anyone|plyr ,"spont_mauvaisquete7", [],"Partons.", "close_window",[]],
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont7"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Fait quelque chose,ou ca va mal tourner.", "sltrapon_ques6",[]],
  
  [anyone|plyr ,"sltrapon_ques6", [],"J'essaye.", "close_window",[]],
  
  #inquisiteur parlements terminee !!!!!!!!!!!!!
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop1"),
      
      (check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      #   (eq, "$endendquestbenezett", 1),
    ],
    "Vous pouvez partir,la ville va se rendre a present.", "inqque_terminer_endo",[]],
  
  [anyone|plyr ,"inqque_terminer_endo", [],"Bien,je suppose que je n'aurais pas de solde auprés de ma compagnie.", "close_window",[]],
  
  #inquisiteur parlements reparle
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop1"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
      (eq, "$deuxnextdialinquis", 1),
    ],
    "Alors? allez vous vous rendre? j'en es assez de cette campagne voyez vous.", "inq_redit_campcondz",[]],
  
  [anyone|plyr ,"inq_redit_campcondz", [],"Tres bien,nous partons et nous ne nous opposont plus a vous.", "inq_redit_campcondzok",
    [
      ####fail ques
      (call_script, "script_fail_quest", "qst_sl_deffensse_benezet"),
      (call_script, "script_end_quest", "qst_sl_deffensse_benezet"),
  ]],
  [anyone ,"inq_redit_campcondzok", [],"Je vous remercie d'avoir pris la bonne décision,rassurez vous,nous sommes bien une armée papale,allez en paix mon fils et restez toujours droit et juste.", "close_window",
    [
      (assign, "$endendquestbenezett", 1),
  ]],
  [anyone|plyr ,"inq_redit_campcondz", [],"Je doit encore réfléchire.", "close_window",[]],  #permet l'ataque
  
  
  
  
  #inquisiteur suite
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop1"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
      (eq, "$nextdialinquis", 1),
    ],
    "Rendez vous héretiques! savez vous que vous vous opposez au Pape?", "inqq_questionor_reditions",[]],
  
  [anyone|plyr ,"inqq_questionor_reditions", [],"Je viens parlementer MonSeigneur,nous sommes dans une situation délicate,nous ne savons pas si...vous etes celui que vous prétendez etre,si nous etions surs nous pourions nous rendres.", "inqq_questionor_reditions2",[]],
  [anyone ,"inqq_questionor_reditions2", [],"Vous devez vous rendre sans conditions,partez rejoindre votre région,des combats vous appellent contre l'Angleterre,que faites vous ici a vous opposer contre sa Sainteté le Pape en personne?!", "inqq_questionor_reditions3",[]],
  
  [anyone|plyr ,"inqq_questionor_reditions3", [],"Ou sont les armoiries du pape? pourquois ne dréssez vous pas une banière? et pourquois avoir recruté des mercenaires en guise de gardes Papaux?.", "inqq_questionor_reditions4",[]],
  
  [anyone ,"inqq_questionor_reditions4", [],"Je voie,il se trouve que ces mercenaires sont engagés avec les deniers du Pape,et notre etendar...es je le regrète tombè de nos chariots en traverssant une rivière,vous devez me croire,ne prennez pas le risque d'etre a mal envers le Royaume de france et le Pape lui meme,partez et il ne vous en sera tenue rigeure,je comprend que vous essayais de faire votre travail,mais de grace partez ou nous donnons l'assaut.", "inqq_questionor_reditions4con",[]],
  
  [anyone|plyr ,"inqq_questionor_reditions4con", [],"Tres bien,nous partons et nous ne nous opposont plus a vous.", "inqq_questionor_reditendfin",
    [
      ####fail quest
      (call_script, "script_fail_quest", "qst_sl_deffensse_benezet"),
      (call_script, "script_end_quest", "qst_sl_deffensse_benezet"),
  ]],
  [anyone ,"inqq_questionor_reditendfin", [],"Je vous remercie d'avoir pris la bonne décision,rassurez vous,nous sommes bien une armée papale,allez en paix mon fils et restez toujours droit et juste.", "close_window",
    [
      ##assigner variable tout es fini et reporter dials!!!!!!!!!!!!!!!!!!!!!!!!!!
      (assign, "$endendquestbenezett", 1),
  ]],
  
  
  
  
  [anyone|plyr ,"inqq_questionor_reditions4con", [],"Je doit y réfléchire.", "close_window",[(assign, "$deuxnextdialinquis", 1),]],  #permet l'ataque
  
  #inquisiteur troupes
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop1"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Rendez vous héretiques! savez vous que vous vous opposez au Pape bande de soudars?", "inqquestponinq2_benez",[]],
  
  [anyone|plyr ,"inqquestponinq2_benez", [],"Je regrette,je ne peut rien vous dire pour le moment.", "inqquestponinq2_benez2",[]],
  [anyone ,"inqquestponinq2_benez2", [],"Alors retournez vous cacher dérière vos murs bande de laches.", "close_window",[]],
  
  
  
  
  ############################################################
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop2"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Rendez vous,ou c'est la mort et l'enfer qui vous attend.", "questponinq1_benez",[]],
  
  [anyone|plyr ,"questponinq1_benez", [],"Ca n'es pas si simple soldat.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop3"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Rendez vous,ou c'est la mort et l'enfer qui vous attend.", "questponinq1_benez2",[]],
  
  [anyone|plyr ,"questponinq1_benez2", [],"Ca n'es pas si simple soldat.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop4"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Rendez vous,ou c'est la mort et l'enfer qui vous attend.", "questponinq1_benez3",[]],
  
  [anyone|plyr ,"questponinq1_benez3", [],"Ca n'es pas si simple soldat.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop5"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Rendez vous,ou c'est la mort et l'enfer qui vous attend.", "questponinq1_benez4",[]],
  
  [anyone|plyr ,"questponinq1_benez4", [],"Ca n'es pas si simple soldat.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop6"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Rendez vous,ou c'est la mort et l'enfer qui vous attend.", "questponinq1_benez5",[]],
  
  [anyone|plyr ,"questponinq1_benez5", [],"Ca n'es pas si simple soldat.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop7"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Rendez vous,ou c'est la mort et l'enfer qui vous attend.", "questponinq1_benez6",[]],
  
  [anyone|plyr ,"questponinq1_benez6", [],"Ca n'es pas si simple soldat.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop8"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Rendez vous,ou c'est la mort et l'enfer qui vous attend.", "questponinq1_benez7",[]],
  
  [anyone|plyr ,"questponinq1_benez7", [],"Ca n'es pas si simple soldat.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop9"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Rendez vous,ou c'est la mort et l'enfer qui vous attend.", "questponinq1_benez8",[]],
  
  [anyone|plyr ,"questponinq1_benez8", [],"Ca n'es pas si simple soldat.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop10"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Rendez vous,ou c'est la mort et l'enfer qui vous attend.", "questponinq1_benez9",[]],
  
  [anyone|plyr ,"questponinq1_benez9", [],"Ca n'es pas si simple soldat.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop11"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Rendez vous,ou c'est la mort et l'enfer qui vous attend.", "questponinq1_benez10",[]],
  
  [anyone|plyr ,"questponinq1_benez10", [],"Ca n'es pas si simple soldat.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop12"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Rendez vous,ou c'est la mort et l'enfer qui vous attend.", "questponinq1_benez11",[]],
  
  [anyone|plyr ,"questponinq1_benez11", [],"Ca n'es pas si simple soldat.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop13"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Rendez vous,ou c'est la mort et l'enfer qui vous attend.", "questponinq1_benez12",[]],
  
  [anyone|plyr ,"questponinq1_benez12", [],"Ca n'es pas si simple soldat.", "close_window",[]],
  
  
  
  ##################################### AVANT MISSION ACTIVE .NEUTRE
  
  
  
  #sl
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont1"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Que faites vous ici? la ville es assiegée,si vous ne prennez pas part aux combats je vous conseille de partir.", "pon_beneztroopramp",[(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"pon_beneztroopramp", [],"Qui assiege la ville?", "pon_beneztroopramp2",[]],
  [anyone ,"pon_beneztroopramp2", [],"Vous m'enuyez avec vos questions Messire.partez sur le champ.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont2"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Que faites vous ici? ceux qui ne prendrons pas part aux combats doivent quitter les ramparts.", "pon2_beneztroopramp",[(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"pon2_beneztroopramp", [],"Je m'en allais justement.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont3"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Que faites vous ici? ceux qui ne prendrons pas part aux combats doivent quitter les ramparts.", "pon3_beneztroopramp",[(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"pon3_beneztroopramp", [],"Je m'en allais justement.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont4"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Que faites vous ici? ceux qui ne prendrons pas part aux combats doivent quitter les ramparts.", "pon4_beneztroopramp",[(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"pon4_beneztroopramp", [],"Je m'en allais justement.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont5"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Que faites vous ici? ceux qui ne prendrons pas part aux combats doivent quitter les ramparts.", "pon5_beneztroopramp",[(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"pon5_beneztroopramp", [],"Je m'en allais justement.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont6"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Que faites vous ici? ceux qui ne prendrons pas part aux combats doivent quitter les ramparts.", "pon6_beneztroopramp",[(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"pon6_beneztroopramp", [],"Je m'en allais justement.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lyspont7"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Que faites vous ici? ceux qui ne prendrons pas part aux combats doivent quitter les ramparts.", "pon7_beneztroopramp",[(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"pon7_beneztroopramp", [],"Je m'en allais justement.", "close_window",[]],
  
  #inquisiteur troupes
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop1"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Que faites vous ici? les roturiers ne sont pas admis sur le camp de siege,repartez imédiatement dans vostre village.", "poninq_beneztroop",[(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"poninq_beneztroop", [],"Un inquisiteur sur un champ de bataille? allez vous bruller quelqu'un?", "poninq_beneztroop2",[]],
  [anyone ,"poninq_beneztroop2", [],"Ignorant,si quelqu'un doit etre brullé vous le verez sur la grand place,en attendant retournez a vos occupations c'est un ordre.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop2"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Fiche le camp,il n'y a pas de travail pour toi ici.", "poninq2_beneztroop",[]],
  
  [anyone|plyr ,"poninq2_beneztroop", [],"Je m'en allais Messire.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop3"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Fiche le camp,il n'y a pas de travail pour toi ici.", "poninq3_beneztroop",[]],
  
  [anyone|plyr ,"poninq3_beneztroop", [],"Je m'en allais Messire.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop4"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Fiche le camp,il n'y a pas de travail pour toi ici.", "poninq4_beneztroop",[]],
  
  [anyone|plyr ,"poninq4_beneztroop", [],"Je m'en allais Messire.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop5"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Fiche le camp,il n'y a pas de travail pour toi ici.", "poninq5_beneztroop",[]],
  
  [anyone|plyr ,"poninq5_beneztroop", [],"Je m'en allais Messire.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop6"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Fiche le camp,il n'y a pas de travail pour toi ici.", "poninq6_beneztroop",[]],
  
  [anyone|plyr ,"poninq6_beneztroop", [],"Je m'en allais Messire.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop7"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Fiche le camp,il n'y a pas de travail pour toi ici.", "poninq7_beneztroop",[]],
  
  [anyone|plyr ,"poninq7_beneztroop", [],"Je m'en allais Messire.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop8"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Fiche le camp,il n'y a pas de travail pour toi ici.", "poninq8_beneztroop",[]],
  
  [anyone|plyr ,"poninq8_beneztroop", [],"Je m'en allais Messire.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop9"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Fiche le camp,il n'y a pas de travail pour toi ici.", "poninq9_beneztroop",[]],
  
  [anyone|plyr ,"poninq9_beneztroop", [],"Je m'en allais Messire.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop10"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Fiche le camp,il n'y a pas de travail pour toi ici.", "poninq10_beneztroop",[]],
  
  [anyone|plyr ,"poninq10_beneztroop", [],"Je m'en allais Messire.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop11"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Fiche le camp,il n'y a pas de travail pour toi ici.", "poninq11_beneztroop",[]],
  
  [anyone|plyr ,"poninq11_beneztroop", [],"Je m'en allais Messire.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop12"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Fiche le camp,il n'y a pas de travail pour toi ici.", "poninq12_beneztroop",[]],
  
  [anyone|plyr ,"poninq12_beneztroop", [],"Je m'en allais Messire.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pontbenezet_troop13"),
      (neg|check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Fiche le camp,il n'y a pas de travail pour toi ici.", "poninq13_beneztroop",[]],
  
  [anyone|plyr ,"poninq13_beneztroop", [],"Je m'en allais Messire.", "close_window",[]],
  
  
  ##GORDAINE BASE SANG LYS
  #############################################################################################################################################################################
  
  ##########DERNIER DIAL LETTRE RECOMANDATION!!!!!!!!!!!!!!!!!!!!     ici
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (eq, "$perdurecommandletrgord", 1),
    ],
    "Que me vaut vostre visite Messire ...chevalier? ou peut etre ai je mal compris,vous etes peut etre éleveur de chevaux c'est bien cela?", "perd_recomanlettreza", []],
  
  [anyone|plyr ,"perd_recomanlettreza", [], "Toujours d'aussi bonne hummeur Messire, comment vont vos esclaves?", "perd_recomanlettreescl",[]],
  [anyone|plyr ,"perd_recomanlettreza", [], "J'ai...perdu la lettre de recomandation,m'en donneriez vous une autre?", "perd_recomrecomand",[]],
  [anyone|plyr ,"perd_recomanlettreza", [], "Je vennais saluer un gentil homme,mais je n'en trouve pas ici.", "close_window",[]],
  
  [anyone ,"perd_recomanlettreescl", [],"Vous n'etes point digne d'estre Chevalier, vous n'etes meme pas le fils battard d'un noble.", "perd_recomanletbastard",[]],
  [anyone|plyr ,"perd_recomanletbastard", [], "C'en es assez,je vous défie en duel!", "perd_recomanletbaduel",[]],
  [anyone|plyr ,"perd_recomanletbastard", [], "Bien le bonjour d'un Chevalier roturier...", "close_window",[]],
  
  
  [anyone ,"perd_recomanletbaduel", [],"Attendez, je...je ne sais point combattre,réglons cette affaire autrement...", "perd_recomanletbaduelno",[]],
  [anyone|plyr ,"perd_recomanletbaduelno", [], "J'es grand pitié de vous, puissiez vous etre jugé pour toutes vos actions tot ou tard.", "close_window",[]],
  
  
  [anyone ,"perd_recomrecomand", [],"Ah,ah, laissez moi rire, tachez de ne pas perdre vostre cheval ou vostre épée sur le champ de bataille chevalier, tennez en voici une autre, j'en es un coffre plein qui vous es déstiné, la prochaine fois je vous ferais payer le prix du papier.", "close_window",
    [
      (troop_add_item, "trp_player", "itm_plis_recomandation", 0),
  ]],
  
  
  ###################################################################
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (eq, "$endquestslfinish", 1),
    ],
    "Vous?...", "sls_endslquest", []],
  
  [anyone|plyr ,"sls_endslquest", [], "Oui,c'est bien moi.vous ne me donnerais pas de contrat je suppose?", "sls_endslquest2",[]],
  [anyone|plyr ,"sls_endslquest", [], "J'aspire a devenire Chevalier,et il me faut une lettre de recomandation rédigée par un noble.", "sls_endslquestrecomand",[]],
  [anyone|plyr ,"sls_endslquest", [], "Je vous es assez vu,adieu grand maitre.", "close_window",[]],
  
  [anyone ,"sls_endslquest2", [],"Non,je ne puis vous donner d'autres contrats,je suis navré de la dérnière mission croyez le bien.mais la fin justifie les moyens et cette guerre nous met tous dans de salles situations,personne n'est tout a fait propre croyez moi.", "sls_endslquest3",[]],
  [anyone|plyr ,"sls_endslquest3", [], "Et bien moi je n'ai pas de sang sur les mains.", "sls_endslquest4",[]],
  [anyone ,"sls_endslquest4", [],"En etes vous bien sure?", "close_window",[]],
  
  [anyone ,"sls_endslquestrecomand", [],"Vous,Chevalier? soit,en temp de guerre...en voici une,rajoutez simplement vostre nom,si vous en avez un.", "sls_endslquestrecomandtake",[]],
  [anyone|plyr ,"sls_endslquestrecomandtake", [], "Je suis {playername}, je serais un jour un grand Chevalier, et je ne vous ressemblerais pas.", "close_window",
    [
      (troop_add_item, "trp_player", "itm_plis_recomandation", 0),
      (assign, "$perdurecommandletrgord", 1),
  ]],
  
  
  
  ##faire dials sl troupes /inquisiteurs et ses hommes,avant quete/pendant quete/"votre saintete je viens d'ariver quelle es la situation?...""rendez vous heretiques"
  ###WIN
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
    ],
    "Que faites vous ici? le siège d'Avignon es t'il terminé?", "benez_winnlbattle", [(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"benez_winnlbattle", [], "Il est terminé oui,et nous avons étés obligés de nous deffendre contre l'armée...du Pape! vous avez bien fait de me cacher la verité ordure.", "benez_winnlbattle2",[]],
  
  [anyone ,"benez_winnlbattle2", [],"Le Pape? non vous vous meprenez,l'inquisiteur a agit selon son propre interet,le Pape ne le reconait pas et c'est nous qui avons la raison pour nous,du moin le client que je représente.", "benez_winnlbattle3",[]],
  [anyone|plyr ,"benez_winnlbattle3", [], "Il ne s'agit la que d'une manoeuvre de votre part n'es ce pas? l'inquisiteur es tout a fait légitime et vous saviez que ca aller mal finire pour nous,cependant vous auriez quand meme pris l'agent du client prétendant que nous avons agit a notre propre compte en vous trahissan moi et la poigné de malheureux qui y ont laissé leur vie.", "benez_winnlbattle4",[]],
  [anyone ,"benez_winnlbattle4", [],"Je...", "benez_winnlbattle5",[]],
  
  [anyone|plyr ,"benez_winnlbattle5", [], "Cessez ces menssonges,et priez pour que je n'ai pas d'autres problèmes a cause de cette histoire,et une dérnière chose,vous me devez 1000 écus.", "benez_winnlbattle7",[]],
  [anyone ,"benez_winnlbattle7", [],"Hum...naturellement,c'etait le prix convenu.il est préffèrable que vous ne travaillez plus pour moi le temp d'étouffer l'affaire,et surtout ne parlez de tout cela a personne,ce sont des choses qui échapent aux gens de votre rang.", "close_window",
    [
      #donner fric/quete finished/et variable dernier dialogue et lettre recomand
      (troop_add_gold, "trp_player", 1000),
      (call_script, "script_end_quest", "qst_sl_deffensse_benezet"),
      (assign, "$endquestslfinish", 1),
  ]],
  
  ###failed
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
    ],
    "Que faites vous ici? le siège d'Avignon es t'il terminé?", "benez_failbattle", [(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"benez_failbattle", [], "Il est terminé oui,et nous n'avons rien put faire contre l'armée...du Pape! vous avez bien fait de me cacher la verité ordure.", "benez_failbattle2",[]],
  
  [anyone ,"benez_failbattle2", [],"Le Pape? non vous vous meprenez,l'inquisiteur a agit selon son propre interet,le Pape ne le reconait pas et c'est nous qui avons la raison pour nous,du moin le client que je représente.", "benez_failbattle3",[]],
  [anyone|plyr ,"benez_failbattle3", [], "Il ne s'agit la que d'une manoeuvre de votre part n'es ce pas? l'inquisiteur es tout a fait légitime et vous saviez que ca aller mal finire pour nous,cependant vous auriez quand meme pris l'agent du client prétendant que nous avons agit a notre propre compte en vous trahissan moi et la poigné de malheureux qui y ont laissé leur vie.", "benez_failbattle4",[]],
  [anyone ,"benez_failbattle4", [],"Je...", "benez_failbattle5",[]],
  
  [anyone|plyr ,"benez_failbattle5", [], "Cessez ces menssonges,et priez pour que je n'ai pas d'autres problèmes a cause de cette histoire,et je ne veux plus travailler pour vous adieu.", "close_window",
    [
      #variable fin dernier dial et possible avoir lettre de recomandation
      (assign, "$endquestslfinish", 1),
  ]],
  
  
  #####en attente
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (check_quest_active, "qst_sl_deffensse_benezet"),
      (neg|check_quest_succeeded, "qst_sl_deffensse_benezet"),
      (neg|check_quest_failed, "qst_sl_deffensse_benezet"),
      (neg|check_quest_finished, "qst_sl_deffensse_benezet"),
    ],
    "Que faites vous ici? je n'ai pas d'autre travail a vous donner tant que vous n'avez pas fini votre dernière mission", "cour_benesett", [(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"cour_benesett", [], "Je m'y rendais justement...", "close_window",[]],
  
  
  
  #############
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (eq, "$encnouvelquestsls", 1),
      (store_current_hours,":cur_hours"),
      (val_sub, ":cur_hours", 48),
      (gt, ":cur_hours", "$temp_attente_3"),
    ],
    "Encore vous?...que voullez vous?.", "sls_benez", [(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"sls_benez", [], "Avez vous du travail pour moi?", "sls_benez2",[]],
  [anyone ,"sls_benez2", [],"Oui...oui,en fait vous pouriez m'ettre utile,il y a un contrat délicat,une mission difficile que vous pouriez remplire pour moi.", "sls_benez3",[]],
  
  [anyone|plyr ,"sls_benez3", [], "Allez vous encore m'envoyer a la mort?", "sls_benez4",[]],
  [anyone ,"sls_benez4", [],"Pas du tout,ca n'es pas le problème,voyez vous la difficulté es d'une autre nature,mais je ne doute pas que vous puissez vous en sortire.", "sls_benez5",[]],
  [anyone|plyr ,"sls_benez5", [], "Et de quelle nature es cette difficulté?", "sls_benez6",[]],
  [anyone ,"sls_benez6", [],"Je ne puis rien vous dire pour le moment,sachez juste que vous y gagnerais 1000 écus.mais pour des explications,il va faloire que vous me fassiez confiance,etes vous d'accord.", "sls_benez7",[]],
  
  [anyone|plyr ,"sls_benez7", [], "Il se trouve que j'ai besoin de cet or,je n'ai pas d'autre choix que d'accepter.", "sls_benezok",
    [
      #############star quest benezet
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la compagnie du SansLys, m'a ordonné de rejoindre le pont St Benezet a Avignon assiegée,sans prendre la peine de me preciser qui etaient les assaillants,j'ai toutefois le temps de m'y rendre."),
      (call_script, "script_start_quest", "qst_sl_deffensse_benezet", "$g_talk_troop"),
  ]],
  [anyone|plyr ,"sls_benez7", [], "Je regrète c'est non.", "sls_benezno",[]],
  
  [anyone ,"sls_benezno", [],"Je me doutais bien que vous refuseriez,mais sachez que mon offre tiens encore pour quelques mois peut etre,alors si jamais vous etiez dans le besoin,vous savez quois faire...", "close_window",[]],
  [anyone ,"sls_benezok", [],"Je savais que je pouvais compter sur vous dans les moments difficiles,il s'agit de rejoindre Avignon assiègée,notre post es sur le pont st Benezet,nous sommes chargés par le Duc de Provence de déffendre la ville.mais de grace une fois la bas,ne vous inquiétez point pour le reste.", "close_window",[]],
  
  
  
  
  ##########################################################
  #en attendant time reg
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (eq, "$encnouvelquestsls", 1),
    ],
    "Vous revoila.", "sl_jobhneww1", [(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"sl_jobhneww1", [], "Avez vous du travail pour moi?", "sl_jobhneww122",[]],
  [anyone|plyr ,"sl_jobhneww1", [], "Je m'en allais.", "close_window",[]],
  
  [anyone ,"sl_jobhneww122", [],"Non,il n'y a rien pour vous...plus tard sans doute.", "close_window",[]],
  
  
  #########################WIN SI DOIT PAYER 500 de plus  buggg
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (eq, "$entrepbougquestbatfinish", 1),
      (eq, "$ecuscinqcentdeplus", 1),
    ],
    "Alors? Comment nous nous en sommes sortie?", "d_quetboutgbatok22", [(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"d_quetboutgbatok22", [], "Il y a eu des béssés,mais les brigands sont morts ou aux arets a présent.", "d_quetboutgbatok33",
    [
      (call_script, "script_end_quest", "qst_sl_viland_troop1"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",2),
      (call_script, "script_change_troop_renown", "trp_player", 4),
  ]],
  [anyone ,"d_quetboutgbatok33", [], "Parfait,c'est du bon travail,voici 200 écus et les 500 de votre dérnière mission comme promis,je pensse qu'on en as fini avec ce Vilandrandro pour le moment,vous pouvez allez a la taverne,je n'ai pas besoin de vous pour l'instant.", "close_window",
    [
      (troop_add_gold, "trp_player", 700),
      (assign, "$encnouvelquestsls", 1),
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_3", ":cur_hours"),
  ]],
  
  ##########################WIN
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (eq, "$entrepbougquestbatfinish", 1),
    ],
    "Alors? Comment nous nous en sommes sortie?.", "end_quetboutgbatok", [(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"end_quetboutgbatok", [], "Il y a eu des béssés,mais les brigands sont morts ou aux arets a présent.", "end_quetboutgbatok2",
    [
      (call_script, "script_end_quest", "qst_sl_viland_attack1"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",2),
      (call_script, "script_change_troop_renown", "trp_player", 4),
  ]],
  [anyone ,"end_quetboutgbatok2", [], "Parfait,c'est du bon travail,voici 200 écus,je pensse qu'on en as fini avec ce Vilandrandro pour le moment,vous pouvez allez a la taverne,je n'ai plus besoin de vous.", "close_window",
    [
      (troop_add_gold, "trp_player", 200),
      (assign, "$encnouvelquestsls", 1),
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_3", ":cur_hours"),
  ]],
  
  ########################LOOSE
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (check_quest_failed, "qst_sl_viland_attack1"),
      (neg|check_quest_active, "qst_sl_viland_attack1"),
      (neg|check_quest_succeeded, "qst_sl_viland_attack1"),
    ],
    "Alors? Comment nous nous en sommes sortie?", "last_failsl_batbourg", [(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"last_failsl_batbourg", [],"Ils etaient en surnombre et ils nous ont eu,il y a des béssés et des...", "last_failsl_batbourg2",[]],
  
  [anyone ,"last_failsl_batbourg2", [], "Ca n'es pas possible! pourquois ai je recruté de tels inccapables? vous n'aurez plus un seul écu,partez immédiatement.", "close_window",
    [
      (call_script, "script_end_quest", "qst_sl_viland_attack1"),
      
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-2),
      (assign, "$encnouvelquestsls", 1),
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_3", ":cur_hours"),
  ]],
  
  #####################################
  
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (check_quest_active, "qst_sl_viland_attack1"),
      (neg|check_quest_succeeded, "qst_sl_viland_attack1"),
      (neg|check_quest_failed, "qst_sl_viland_attack1"),
      (neg|check_quest_finished, "qst_sl_viland_attack1"),
    ],
    "Et bien,ne restez pas la,une bataille es en cour aux entrepots!", "cour_bataentree", []],
  
  [anyone|plyr ,"cour_bataentree", [], "Je la rejoins de ce pas.", "close_window",[]],
  
  #####################################
  
  
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (eq, "$victoire_viland_quetebourges", -1),
    ],
    "Et bien? la bataille a t'elle eu lieu?.", "end_failrgland2", [(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"end_failrgland2", [], "Elle a eu lieu Messire,et nous avons été vaincus.", "end_failrgland23",
    [
      (call_script, "script_fail_quest", "qst_sl_viland_troop1"),
      (call_script, "script_end_quest", "qst_sl_viland_troop1"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-2),
  ]],
  [anyone ,"end_failrgland23", [],"Je n'en attendais pas moin de vous inccapable,toujours égale a vous meme...cependant vous pouvez vous rendre enfin utile pour changer.comme je le prédisais,un autre groupe de brigands a pris d'assaut les entrepots penssant que j'enverais l'escenssiel de ma garnison dans leur camp.vous devez partir imédiatement pour les entrepots soutenire vos camarades dans cette bataille.", "end_failrgland23oth",[]],
  
  [anyone|plyr ,"end_failrgland23oth", [], "Bien,je m'y rend de ce pas.", "close_window",
    [
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la compagnie du SansLys, m'a ordonné de rejoindre immédiatement la bataille aux entrepots de Bourges les opposants aux brigands de Vilandrandro."),
      (call_script, "script_start_quest", "qst_sl_viland_attack1", "$g_talk_troop"),
      
  ]],
  
  [anyone|plyr ,"end_failrgland23oth", [], "Je ne peut pas,je doit refuser.", "end_failrgland23otfafail",[]],
  [anyone ,"end_failrgland23otfafail", [],"Alors partez d'ici,vous etes la pire recrue que ma compagnie es comptée.", "close_window",
    [
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-4),
      (assign, "$encnouvelquestsls", 1),
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_3", ":cur_hours"),
  ]],
  
  #####################suite quete >>>
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (eq, "$victoire_viland_quetebourges", 1),
    ],
    "Et bien? la bataille a t'elle eu lieu?.", "end_quetebourgland", [(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"end_quetebourgland", [], "Elle a eu lieu Messire,et nous avons vaincu.", "end_quetebourgland2",
    [
      (call_script, "script_end_quest", "qst_sl_viland_troop1"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",4),
      (call_script, "script_change_troop_renown", "trp_player", 4),
  ]],
  
  
  [anyone ,"end_quetebourgland2", [],"Enfin une bonne nouvelle! mon plan a fonctioné a la perfection,tandis qu'ils nous attendais en nombre dans les collines,je n'ai envoyé qu'un petit groupe et nous sommes resté,pour attendre le plus gros de leur compagnie venire se faire fracasser le crane dans les entrepots qu'ils penssais trouvé gardés uniquement par la milice...le Dauphin va etre content de mes services,assurément.", "end_quetebourgland3",[]],
  
  [anyone|plyr ,"end_quetebourgland3", [], "Ainsi,vous m'avez envoyé retourner leur piège contre eux en nombre inférieur au risque de ma vie et de tous ces hommes?", "end_quetebourgland4",[]],
  
  [anyone ,"end_quetebourgland4", [],"Mais non voyons,je ne doutais pas de vos...compétences.", "end_quetebourgland5",[]],
  
  [anyone|plyr ,"end_quetebourgland5", [], "Et a propos de ma soldes...mes 500 écus.", "end_quetebourgland6",[]],
  
  [anyone ,"end_quetebourgland6", [],"Plus tard l'ami,plus tard.il se trouve que les combats font encore rage aux entrepos,allez préstement preter main forte a vos compagnons,et nous rajouterons 200 pièces.", "end_quetebourgland7",[]],
  
  [anyone|plyr ,"end_quetebourgland7", [], "Bien,je m'y rend.", "close_window",
    [
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la compagnie du SansLys, m'a ordonné de rejoindre immédiatement la bataille aux entrepots de Bourges les opposants aux brigands de Vilandrandro."),
      (call_script, "script_start_quest", "qst_sl_viland_attack1", "$g_talk_troop"),
      (quest_set_slot, "qst_sl_viland_attack1", slot_quest_expiration_days, 1),
      (assign, "$ecuscinqcentdeplus", 1),
  ]],
  
  
  [anyone|plyr ,"end_quetebourgland7", [], "Je ne peut pas,je doit refuser.", "end_quetebourgland7fail",[]],
  [anyone ,"end_quetebourgland7fail", [],"Alors partez d'ici,vous etes la pire recrue que ma compagnie es comptée.", "close_window",
    [
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-4),
      (assign, "$encnouvelquestsls", 1),
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_3", ":cur_hours"),
  ]],
  
  [anyone|plyr ,"end_quetebourgland7", [], "Un doute m'assaille...vous ne désirez tout de meme pas que je trépasse dans ce dérnier combat aux fins de ne pas avoir a me versser 500 écus?", "sl_jobhhnew22",[]],
  [anyone ,"sl_jobhhnew22", [],"Comment pouvez vous pensser une chose pareille? c'est un..c'est...un sacrilège.allez vites aux entrepots je vous en prie.", "end_quetebourgland7",[]],
  
  
  ##########
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (check_quest_active, "qst_sl_viland_troop1"),
      (neg|check_quest_succeeded, "qst_sl_viland_troop1"),
    ],
    "Que faites vous encore ici? la troupe de brigands peut repartire d'un instant a l'autre,je les soupcone de faire diverssion pour attaquer les entrepots avec un autre groupe.mais si nous envoyons un groupe de petite taille mais puissant,nous pourons les vaincres plus facilement car ils se sont séparés,mais vous devez agire vite! allez les prendre dans les collines en face de Bourges...maintenant.", "here_quetebourgviland", [(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"here_quetebourgviland", [], "Je me depéche Messire.", "close_window",[]],
  [anyone|plyr ,"here_quetebourgviland", [], "Je regrette,je n'en es pas les compétences.", "here_quetebourgviland2",[]],
  
  [anyone ,"here_quetebourgviland2", [],"Je voie...vous devriez peut etre faire autre chose,comme potier, bucheron ou lavandière,maintenant partez imbécile.", "close_window",
    [
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -4),
      (assign, "$encnouvelquestsls", 1),
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_3", ":cur_hours"),
  ]],
  
  ##########################################################prochaine mission
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (eq, "$toujoursnouvelquestsls", 1),
      (store_current_hours,":cur_hours"),
      (val_sub, ":cur_hours", 48),
      (gt, ":cur_hours", "$temp_attente_2"),
    ],
    "Vous?...que voullez vous?.", "slslslanottravgg", [(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"slslslanottravgg", [], "Avez vous du travail pour moi?", "slslslanottravgg2",[]],
  [anyone ,"slslslanottravgg2", [],"Vous tombez bien,les brigands ont quasiment déclaré la guerre a Bourges,attirés par les ressources de la ville,leur chef se nome Rodrigue Villandrandro,il a rassemblé avec lui les mercenaires sans contrat et a formé une troupe de malandrins de la pire éspèce sans foi ni loi dans le but de s'enrichire en pillage,meurtres et rapine,le pire es qu'ils savent se battre.", "slslslanottravgg3",[]],
  [anyone|plyr ,"slslslanottravgg3", [], "Que dois je faire?", "star_vil_troopp",[]],
  [anyone ,"star_vil_troopp", [],"Ils en veulent aux entrepots de marchandises,il ne font plus dans le détail et leur dérnère attaque que nous avons put repousser a tout de meme couté la vie de dix de mes hommes,ils sont en route plus nombreux,selon nos informateurs ils devraient meme ?éja camper aux allentours de la ville.rassemblez une troupe de volontaires et interceptez les avant qu'ils n'entrent a Bourges,une attaque surprise fera peut etre la différence.", "star_vil_troopp2",[]],
  
  
  [anyone|plyr ,"star_vil_troopp2", [], "Puis je avoir des hommes a vous pour me segonder?", "star_vil_troopp33",[]],
  [anyone|plyr ,"star_vil_troopp2", [], "J'en suis navré,mais je ne peut pas pour l'instant", "close_window",
    [
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-4),
      (assign, "$encnouvelquestsls", 1),
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_3", ":cur_hours"),
  ]],
  
  
  [anyone ,"star_vil_troopp33", [],"Et bien c'est assez risqué,si je me sépare des troupes qu'il me reste pour défendre les entrepots je risque de favoriser une stratégie possible visant a faire diverssion,et si une plus grosse troupe attaquais les entrepots par surprise il pourais bien l'emporter et causer des dommages important a l'économie de la ville.ceci dit je peut vous donner quelques hommes si etes vous d'accord pour ce contrat,cherchez une de nos patrouilles et demandez leur de vous suivre.", "star_vil_troopp34",[]],
  [anyone|plyr ,"star_vil_troopp34", [], "Combien cela va t'il me rapporter?", "star_vil_troopp35",[]],
  
  [anyone ,"star_vil_troopp35", [],"Pas moin de 400 écus.", "star_vil_troopp36",[]],
  
  [anyone|plyr ,"star_vil_troopp36", [], "600,et cette troupe ne vous enuira plus!", "star_vil_troopp37",[]],
  [anyone ,"star_vil_troopp37", [],"Dois je vous rappeller que vous etes a mon service? vous me décevez...soit pour 500 écus,payable a votre retour en cas de victoire.", "star_vil_troopp38ok",[]],
  
  [anyone|plyr ,"star_vil_troopp38ok", [], "C'est d'accord!", "star_vil_troopp38ok2",
    [
      ############## START MISSION ET MONTRER TROUPES GRATOS!!!!!!!!!! et le reste start quest,ect...
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la compagnie du SansLys, m'a demandé d'anéantire une troupe de brigands,ils roderais aux allentours de Bourges,pret a réaliser leur mauvais coup."),
      (call_script, "script_start_quest", "qst_sl_viland_troop1", "$g_talk_troop"),
      (quest_set_slot, "qst_sl_viland_troop1", slot_quest_expiration_days, 2),
      (set_spawn_radius, 2),
      (spawn_around_party, "p_town_4", "pt_quest_viland_bourges"),
      (party_set_flags, reg0, pf_always_visible, 1),
  ]],
  
  [anyone ,"star_vil_troopp38ok2", [],"Parfait,mais dépéchez vous,vous avez deux jours pour vous en occuper,pas un de plus.", "close_window",[]],
  
  [anyone|plyr ,"star_vil_troopp38ok", [], "J'en suis désolé,mais c'est trop dangeureux pour si peut.", "star_vil_troopp38fail",[]],
  
  [anyone ,"star_vil_troopp38fail", [],"Alors disparaissez!.", "close_window",
    [
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-4),
      (assign, "$encnouvelquestsls", 1),
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_3", ":cur_hours"),
  ]],
  
  
  
  ##########################################################
  #en attendant time reg
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (eq, "$toujoursnouvelquestsls", 1),
    ],
    "Vous revoila.", "slslslnotjobhh", [(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"slslslnotjobhh", [], "Avez vous du travail pour moi?", "trlastjob_gorddadss",[]],
  [anyone|plyr ,"slslslnotjobhh", [], "Je m'en allais.", "close_window",[]],
  
  [anyone ,"trlastjob_gorddadss", [],"Non,il n'y a rien pour vous,peut etre plus tard.", "close_window",[]],
  
  
  
  
  
  
  ############################# END ############################model attendre time reg !!!!!!END
  #si gagnee combat
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (eq, "$slivresmortokmaitre", 1),
    ],
    "Alors? que s'es t'il passé?", "slsfjobbeligerantend", [(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"slsfjobbeligerantend", [],"Il a quelque peut craqué,je pensse qu'il savais comment cela finirais et qu'il attendais son exécution.", "slsfjobbeligerantend1",[]],
  [anyone ,"slsfjobbeligerantend1", [], "C'est malheureux...ce soldat en avais peut etre trop vu,je devrais songer a donner leur retraite aux soldats qui ont trop servis ou on trop souffert.je me doute que vous penssez que je suis un monstre,mais ca n'es pas si simple vous savez,j'essaye juste de diriger cette compagnie du mieux que je peut et...", "slsfjobbeligerantend2",[]],
  [anyone|plyr ,"slsfjobbeligerantend2", [],"Et pour ma solde je vous pris ?", "slsfjobbeligerantend3",[]],
  [anyone ,"slsfjobbeligerantend3", [], "Oh,oui c'est exact,vous avez bien merité 600 écus qu'en pensez vous,si vous voullez encore travailler pour moi il se peut que j'es quelque chose pour vous prochainement.avec tous mes remerciements...je vais avoir du mal a étouffer cette affaire.", "close_window",
    [
      (call_script, "script_end_quest", "qst_sl_ivrogne1"),
      (troop_add_gold, "trp_player", 600),
      (call_script, "script_change_troop_renown", "trp_player", 2),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",4),
      (assign, "$toujoursnouvelquestsls", 1),
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_2", ":cur_hours"),
  ]],
  
  ##
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (check_quest_failed, "qst_sl_ivrogne1"),
      (neg|check_quest_active, "qst_sl_ivrogne1"),
      (neg|check_quest_succeeded, "qst_sl_ivrogne1"),
      #(check_quest_finished, "qst_sl_patrouil1"),####ne pas prendre en mod?e!!! adapt?!!!
    ],
    "Alors?que s'est t'il passé?", "slsfastjoblossekotavlys", []],
  
  [anyone|plyr ,"slsfastjoblossekotavlys", [],"Il m'as eu,je n'ai rien put faire.", "slsfastjoblossekotavlys2",[]],
  ########### ######################reporter temp attente et prochaine mission 1
  [anyone ,"slsfastjoblossekotavlys2", [], "NON!...il a du etre areté par la garde,et le Dauphin va me demander des comptes,hors de ma vue misérable!", "close_window",
    [
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-4),
      (assign, "$toujoursnouvelquestsls", 1),
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_2", ":cur_hours"),
  ]],
  ###########
  
  
  ###################################
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (check_quest_active, "qst_sl_ivrogne1"),
      (neg|check_quest_succeeded, "qst_sl_ivrogne1"),
      (neg|check_quest_failed, "qst_sl_ivrogne1"),
      (neg|check_quest_finished, "qst_sl_ivrogne1"),
    ],
    "Mais depechez vous donc que diable! il va tuer tout le monde,allez vite a la taverne des trois Lys.", "slsfastjobtav", []],
  
  [anyone|plyr ,"slsfastjobtav", [],"J'y cours.", "close_window",[]],
  
  
  #########################################################model attendre time reg !!!!!!
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (eq, "$nojobtimeatteteslys", 1),
      (store_current_hours,":cur_hours"),
      (val_sub, ":cur_hours", 48),
      (gt, ":cur_hours", "$temp_attente_1"),
    ],
    "Vous etes encore la,que voullez vous?.", "slslslnotjoba4", []],
  
  [anyone|plyr ,"slslslnotjoba4", [], "Avez vous du travail pour moi?", "slslslnotjoba41",[]],
  
  [anyone ,"slslslnotjoba41", [],"Il y a quelque chose que vous pouriez faire,c'est une mission on ne peut plus...délicate,il s'agit d'un problème tres gènant vis a vis de notre principale employeur le dauphin Charles VII.", "slslslnotjoba41suit",[]],
  [anyone|plyr ,"slslslnotjoba41suit", [], "Continuez.", "slslslnotjoba41suit2",[]],
  [anyone ,"slslslnotjoba41suit2", [],"Un de nos hommes es devenu comme fol,il est ivre et il reste a la taverne des trois Lys dans le quartier pauvre de Bourges ici meme,il a tué un millicien de la ville pris par une rage incontrolable.si cela arivais aux oreilles du Dauphin c'en es finis des contrats.allez au plus vite vous débarasser de lui,et le plus discrétement possible,peut m'importe la manière.", "slslslnotjoba41suit3",[]],
  
  [anyone|plyr ,"slslslnotjoba41suit3", [], "C'est un travail sale,mais on as pas toujours le choix,soit je réglerais ce problème.", "slslslnotjoba41okjob",[]],
  [anyone|plyr ,"slslslnotjoba41suit3", [], "Je refuse d'abatre un de nos hommes,adieu.", "close_window",
    [
      ############################ FAILED
      (troop_remove_item, "trp_player", "itm_brigandine_sl"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-2),
      (assign, "$toujoursnouvelquestsls", 1),
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_2", ":cur_hours"),
  ]],
  
  
  [anyone ,"slslslnotjoba41okjob", [],"Parfait,je savais que je pouvais compter sur vous,allez bien préstement mon ami.", "close_window",
    [
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la compagnie du SansLys, m'a demandé de le débarasser d'un problème génant,un de ses hommes s'est réfugié ivre a la taverne des trois Lys dans le quartier pauvre de Bourges,il aurais déja tué un garde de la ville dans une folie meurtrière."),
      (call_script, "script_start_quest", "qst_sl_ivrogne1", "$g_talk_troop"),
      (quest_set_slot, "qst_sl_ivrogne1", slot_quest_expiration_days, 2),
  ]],
  
  
  #en attendant time reg
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (eq, "$nojobtimeatteteslys", 1),
    ],
    "Vous etes encore la,que voullez vous?.", "slslslnotjob", []],
  
  [anyone|plyr ,"slslslnotjob", [], "Avez vous du travail pour moi?", "trlastjob_gorddad",[]],
  [anyone|plyr ,"slslslnotjob", [], "Je m'en allais.", "close_window",[]],
  
  [anyone ,"trlastjob_gorddad", [],"Non,il n'y a rien pour vous,peut etre plus tard.", "close_window",[]],
  
  
  ############################# END ############################model attendre time reg !!!!!!END
  ################################################
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (eq, "$patmissionllyyssloose", 1),
      (eq, "$patroltalktavernnkeepok", 1),
      (eq, "$patroltalkmerchhaanok", 1),
      (eq, "$patroltalkguildmaistrok", 1),
    ],
    "Vous revoila déja,et cette patrouille ?", "patpatroll_sucessuc", [(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"patpatroll_sucessuc", [], "C'est fait Messire,les rues étaient assez calmes,mais les entrepots sont pleins de brigands,j'es due en tuer deux.", "patpatroll_sucessuc2",
    [
      (call_script, "script_end_quest", "qst_sl_patrouil1"),
  ]],
  
  [anyone ,"patpatroll_sucessuc2", [], "Parfait! c'est du bon travail soldat,voila votre solde pour cette mission.ces entrepots sont un vrais problème,nous n'en avons pas finis avec cela,je sens que cela va m'enécher de dormir,nous en reparleront,vous pouvez disposer soldat.", "close_window",
    [
      ###donner or /relation+ sl/renomee/et variable prochaine quete#111
      (troop_add_gold, "trp_player", 400),
      (assign, "$nojobtimeatteteslys", 1),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",2),
      (call_script, "script_change_troop_renown", "trp_player", 4),
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_1", ":cur_hours"),
  ]],
  ############patrol failed si ko
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (eq, "$patmissionllyyssloose", -1),
    ],
    "Vous revoila déja,et cette patrouille ?", "patpatroll_endbourgend", [(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"patpatroll_endbourgend", [], "Et bien...je suis tombé sur deux malandrins,armés jusqu'aux dents,ils m'ont pris par surprise et m'on assomé,heureusement je n'ai...", "patpatroll_endbourgend2",[]],
  
  [anyone ,"patpatroll_endbourgend2", [], "Comment?! Oh,c'est parfait,tout le monde penssera a présent que le SansLys es un regroupement d'amateurs,et qu'il est inutile de leur donner du travail,autant se laisser piller par des malandrins que par des mercenaires inccapables.éspèce de ver de terre! ces brigands doivent etre en train de transporter leur butin jusqu'a leur cachette a l'heure qu'il est.disparaissez! je suis decu de m'etre trompé sur vos capacités.", "close_window",
    [
      ####pas quete failled! deja fait,mais relation -- et variable prochaine quete donnee,time reg....#333
      (assign, "$nojobtimeatteteslys", 1),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-2),
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_1", ":cur_hours"),
  ]],
  
  ######################gord continuer suite ici comme conditions et dials victoires defaites
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (eq, "$ptrollslaccepttss", 1),
    ],
    "Vous revoila déja,et cette patrouille ?", "ptrolssldejass", [(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"ptrolssldejass", [], "Je m'en occupe Messire.", "ptrolssldejassz22",[]],
  [anyone|plyr ,"ptrolssldejass", [], "Je ne peut pas m'en occuper Messire,j'en suis désolé.", "ptrolsslstop22",
    [
      (call_script, "script_fail_quest", "qst_sl_patrouil1"),
      (call_script, "script_end_quest", "qst_sl_patrouil1"),
  ]],###############refuser et autre mission:relations -- et variable meme que quete acomplie!!!!
  
  [anyone ,"ptrolsslstop22", [], "Comment? vous refusez une mission? Hors de ma vue! je me pose des questions sur l'éfficacité de nos tests.", "close_window",
    [
      #######quete failled /variable comme accomplie donn?/relation-- /brigandine enlevee/et time reg...#222
      (troop_remove_item, "trp_player", "itm_brigandine_sl"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-4),
      (assign, "$nojobtimeatteteslys", 1),
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_1", ":cur_hours"),
  ]],#
  [anyone ,"ptrolssldejassz22", [], "Surtout n'oubliez pas de parler a tous les résponssables de leur quartier! ce sont eux qui désciderons a la prochaine assemblée si ils doivent encore nous embaucher,alors il faut qu'ils voyent que leurs écus sont bien dépenssés.mais vous n'avez pas a conaitre tous ces détails,contentez vous d'obeire.", "close_window",[]],
  
  
  #maitre des sang LysB DONNER LES QUETES ICI
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
      (eq, "$menbredesslok", 1),
    ],
    "Vous voila.", "gordnoentrygord", [(play_sound, "snd_sanslys_greetings"),]],
  [anyone|plyr ,"gordnoentrygord", [], "J'ai passé vos tests avec succés,allez vous me donner du travail ?", "gordnopremiertf",[]],
  [anyone|plyr ,"gordnoentrygord", [], "Je reviendrais,je voullais juste vous presenter mes respects.", "close_window",[]],
  
  [anyone ,"gordnopremiertf", [], "J'ai vu cela,ce n'est pas trop mal je suppose,quois qu'il en soit plus nous avons de mercenaires et plus les contrats rapporterons,tennez voici la brigandine du SansLys avec nos armoiries,prennez en grand soin car un soldat n'en recoit qu'une de toute sa vie.portez la fierement et déffendez nos couleures contre nos ennemis quels qu'il soient,maintenant votre patrie es le SansLys!", "gordnopatries",[(troop_add_item, "trp_player", "itm_brigandine_sl", 0),]],
  [anyone|plyr ,"gordnopatries", [], "Je devrais me battre contre n'importe qui?.", "gordnopatrienoata",[]],
  [anyone ,"gordnopatrienoata", [], "Rassurez vous,nous sommes les alliés du Dauphin de France Charles VII,tant qu'il nous paye,et cela risque de durer,mais quand nous devrons changer de camp ou remplire un contrat délicat vous devrez le faire sans etats d'ame,la devise de la compagnie es nous remplirons le contrat meme si cela nous enmène en enfer,etes vous pret a aller jusque la? bien sur en contrepartie vous serez tres bien payé,mais cela dépend de la nature du contrat naturellement,qu'en dite vous?", "gordnopatrirefle",[]],
  
  [anyone|plyr ,"gordnopatrirefle", [], "Vive le SansLys! je suis des votres Messire Maitre.", "gordnopatenfinsl",[]],
  [anyone|plyr ,"gordnopatrirefle", [], "Je crain de ne pas avoir le choix,j'ai besoin d'argent.", "gordnopatenfinsl",[]],
  [anyone|plyr ,"gordnopatrirefle", [], "Je doit éfléchire,je reviendrais.", "close_window",
    [
      (troop_remove_item, "trp_player", "itm_brigandine_sl"),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -2),
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", -5),
  ]],
  
  [anyone ,"gordnopatenfinsl", [], "C'est entendue,vous voila des notres,j'ai justement une tache a vous confier,la millice de Bourges voie son nombre et sa qualité décliner ces derniers temps a cause de la guerre,et de la recrudescande des bandits.leur effectif es jugé insuffisant par les nobles Bourgeois,ils nous on payés pour renforcer les rangs de leurs hommes,la mission conssiste a patrouiller les rues de Bourges et de montrer aux passants que nos armoiries brillent désormais dans leurs rues,et qu'ils peuvent continuer a payer de lourds impots pour leur securité.", "gordnopatenfinslstar",[]],
  [anyone|plyr ,"gordnopatenfinslstar", [], "C'est bien compris.", "gordnopatenfinslstar2",[]],
  
  [anyone ,"gordnopatenfinslstar2", [], "Nous devons aussi éffrayer les brigands et les tirelaine,mais attention,si vous tombiez apres une de leurs embuscades nous serions ridiculisés,et le Dauphin lui meme réfflèchirais a deux fois avant de nous proposer un nouveau contrat,nous comptons sur vous c'est entendue?!", "gordnopatenfinslstar3",[]],
  [anyone|plyr ,"gordnopatenfinslstar3", [], "Oui Messire,ne craigniez rien,je vais m'armer lourdement et je serais sur mes gardes.", "gordnopatenfinslstar4",[]],
  [anyone|plyr ,"gordnopatenfinslstar3", [], "Je regrette,mais je ne puit faire ce travail pour le moment.", "close_window",
    [
      (troop_remove_item, "trp_player", "itm_brigandine_sl"),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -2),
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", -5),
  ]],
  
  [anyone ,"gordnopatenfinslstar4", [], "Bien,voila les détails de la mission,vous devrez patrouiller dans toute la ville et vous devrez parler aux résponssables de chaque quartier,demandez leur si tout va bien,il faut qu'ils vous voyent.", "travailsl_pat",
    [
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la compagnie du SansLys, m'a donné ma première affectation, patrouiller dans les quartiers suivants et parler a leurs résponssables:le maistre de guilde sur la place principale,le tavernier a la taverne,le grossiste au magasin et le contremaitre dans le quartier des entrpots.de plus je doit éviter a tout pris d'etre mis hors de combat si je rencontre des brigands."),
      (call_script, "script_start_quest", "qst_sl_patrouil1", "$g_talk_troop"),
  ]],############ developer les details de la mission patruoille/parler aux contribuables......!!!!!
  
  
  [anyone|plyr ,"travailsl_pat", [], "Entendu.", "travailsl_pat2",[]],
  [anyone ,"travailsl_pat2", [], "Et bien sur,ne vous laissez pas battre par les brigands,ou la renommé de la compagnie se vera entachée,il en es hors de question,vous recevrez votre solde une fois la tache accomplie avec succés,au travail soldat!", "close_window",[(assign, "$ptrollslaccepttss", 1),]],
  
  #maitre des sang Lys
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys8"),
    ],
    "Quelle impudence! sortez imeditement,savez vous qui je suis? allez passer les tests,et nous reparlerons,d'ici la vous n'etes aucunement autorisé a entrer ici.", "gordnoentrygorddd", []],
  [anyone|plyr ,"gordnoentrygorddd", [], "Ca n'es pas si grave,je m'en vais si cela peut vous calmer.", "gordnoentrygordai",[]],
  [anyone|plyr ,"gordnoentrygorddd", [], "Toutes mes excuses,je ne savais pas ou j'allais.", "close_window",[]],
  
  [anyone ,"gordnoentrygordai", [], "Je suis censsé engager des soldats avec si peut d'education? cela me navrerais de vous avoir dans ma compagnie,maintenant disparaissez!", "close_window",
    [
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -2),
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", -5),
  ]],
  
  #############################################################################################################################################################
  
  #taverne de gordaine3C
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys6"),
      (eq, "$toujoursnouvelquestsls", 1),
    ],
    "Toujours en vie? t'es pas si mauvais alors.", "champgomastermaitrav", [(play_sound, "snd_sanslys_taverne"),]],
  [anyone|plyr ,"champgomastermaitrav", [], "Que pensse tu du maitre?", "champgomastermaitrav2",[]],
  [anyone|plyr ,"champgomastermaitrav", [], "J'en profite tant que ca dure,adieu.", "close_window",[]],
  
  [anyone ,"champgomastermaitrav2", [], "Qui ca? oh oui,notre maitre a tous...laisse tomber,je ne veux pas me faire renvoyer", "close_window", []],
  
  #taverne de gordaine3B
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys6"),
      (eq, "$menbredesslok", 1),
    ],
    "Quelle horreur ces champs de bataille dans le nord,le froid,le sang sur la neige,partout,les loups qui viennent bouffer les carcasses des victimes des combats,je me demande pourquois je me suis engagé des fois.", "champgordtav", [(play_sound, "snd_sanslys_taverne"),]],
  [anyone|plyr ,"champgordtav", [], "Pour faire quois d'autre,potier et manger la terre de son etablis?", "champgordtavc2",[]],
  [anyone|plyr ,"champgordtav", [], "Il n'es jamais trop tard pour foutre le camp.", "close_window",[]],
  
  [anyone ,"champgordtavc2", [], "Je sais,l'idéale serais d'etre riche,d'avoir des terres...", "champgordtavc2cc3", []],
  [anyone|plyr ,"champgordtavc2cc3", [], "Ca n'es surement pas si simple.", "champgordtavc2cc322",[]],
  [anyone ,"champgordtavc2cc322", [], "Peut etre,mais si on a pas un but dans sa vie on es vraiment rien,il vaut mieu mourire pour ses reves,que de vivre raisonablement.", "close_window", []],
  
  #taverne de gordaine3
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys6"),
    ],
    "C'est un endroit privé ici,on ne va pas commencer a laisser entrer tous les paysans du royaume venuent tanter de gagner de l'or en se batant avec leur fourche a foin.", "gordtavpaysan", [(play_sound, "snd_sanslys_taverne"),]],
  [anyone|plyr ,"gordtavpaysan", [], "Me battre ici serais une tres mauvaise idée.", "gordtavpaysan2",[]],
  [anyone ,"gordtavpaysan2", [], "T'as tout compris,alors demi tour.", "close_window", []],
  
  #taverne de gordaine2C
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys5"),
      (eq, "$toujoursnouvelquestsls", 1),
    ],
    "Laisse moi boire tranquile.", "gordnofacboirt1", [(play_sound, "snd_sanslys_taverne"),]],
  [anyone|plyr ,"gordnofacboirt1", [], "Que pensse tu du maitre?", "gordnofacboirt12",[]],
  [anyone|plyr ,"gordnofacboirt1", [], "Bois tout ton saoul,adieu.", "close_window",[]],
  
  [anyone ,"gordnofacboirt12", [], "Je ne pensse pas,je fait mon travail et j'encaisse.tu apprendra bien assez tot a faire pareil et tu vera que ce sera la belle vie.", "gordnofacboirt13", []],
  [anyone|plyr ,"gordnofacboirt13", [], "Je pensse que tu as raison", "gordnofacboirt14",[]],
  [anyone ,"gordnofacboirt14", [], "J'ai toujours raison,tu ne sera jamais riche,mais toujours plus riche que beaucoup de francais.", "close_window", []],
  
  #taverne de gordaine2B
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys5"),
      (eq, "$menbredesslok", 1),
    ],
    "J'ai besoin de boire,ma dernière mission etait un échec.", "gordnofac1bcdd", [(play_sound, "snd_sanslys_taverne"),]],
  [anyone|plyr ,"gordnofac1bcdd", [], "Que s'es t'il passé?", "gordnofac1bcddwat",[]],
  [anyone|plyr ,"gordnofac1bcdd", [], "Je te laisse dans ce cas.", "close_window",[]],
  
  [anyone ,"gordnofac1bcddwat", [], "Un beau merdier! des foies je me rend compte que le Dauphin Charles nous a engagé pour ne pas salire ses bons seigneurs,j'etait chargé avec quelques gars de la ville d'escorter un convoi,ces types avaient l'air de soldats alors je ne m'en fesais pas trop,mais a la première embusquade,ces batards on fuis devans des ribauds armés de fourches,des bandits de grand chemins,je n'ai pas put faire autrement devans leur nombre de fuir aussi en laissant la cargaison.", "gordnofac1bcddwat2", []],
  [anyone|plyr ,"gordnofac1bcddwat2", [], "Tu as fait ce qu'il fallais,pourquois risquer ta vie si t'avais aucune chance?", "gordnofac1bcddwat212",[]],
  [anyone ,"gordnofac1bcddwat212", [], "Je crois que tu ne comprend pas,le maitre aurais voulu que j'y laisse la vie plutot que de fuir.le pire c'est pour la reputation de la compagnie,un soldat du SansLys fuyant devans des paysans...le maitre ne le sait pas encore,je ne suis pas pressé de me presenter a lui,c'est sur.", "close_window", []],
  
  #taverne de gordaine2
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys5"),
    ],
    "He! c'est la taverne de la compagnie ici,tu n'es pas des notres fout le camp ailleurs!", "gordnofac1bc", [(play_sound, "snd_sanslys_taverne"),]],
  [anyone|plyr ,"gordnofac1bc", [], "Pas la peine de prendre ce ton.", "close_window",[]],
  
  
  
  #taverne de gordaine1B
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys4"),
      (eq, "$menbredesslok", 1),
    ],
    "Alors tu es des notres hein? ca fait plaisir de voir que nos rangs grossissent,plus il y aura des mercenaires a la troupe du SansLys et mieux mes arieres seront couverts! je te paye une chope pour la peine.", "vvgordtavern1", [(play_sound, "snd_sanslys_taverne"),]],
  [anyone|plyr ,"vvgordtavern1", [], "Volontier,et si on jouais quelques écus a un jeu de hasard ?", "generique_des",[]],
  [anyone|plyr ,"vvgordtavern1", [], "Merci,mais je n'ai pas le temp.", "close_window",[]],
  ########################LA JEU DE PIECE
  
  [anyone|plyr,"generique_des", [
      
      ], "Jouons a pile ou face.", "start_pf",[
  ]],
  
  
  
  
  [anyone,"start_pf", [
      ], "Bon... combien on mise?", "gord_coin2-1",[]],
  
  [anyone|plyr,"gord_coin2-1", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",1),
      ], "1 ecus.", "gord_coin3-1",[
      (assign, reg6, 1),]],
  [anyone|plyr,"gord_coin2-1", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",2),
      ], "2 ecus.", "gord_coin3-1",[
      (assign, reg6, 2),]],
  [anyone|plyr,"gord_coin2-1", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",3),
      ], "3 ecus.", "gord_coin3-1",[
      (assign, reg6, 3),]],
  [anyone|plyr,"gord_coin2-1", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",4),
      ], "4 ecus.", "gord_coin3-1",[
      (assign, reg6, 4),]],
  [anyone|plyr,"gord_coin2-1", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",5),
      ], "5 ecus.", "gord_coin3-1",[
      (assign, reg6, 5),]],
  [anyone|plyr,"gord_coin2-1", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",10),
      ], "10 ecus.", "gord_coin3-1",[
      (assign, reg6, 10),]],
  [anyone|plyr,"gord_coin2-1", [
      ], "On a assez joué.", "gord_coinn_1_1",[]],
  
  [anyone,"gord_coinn_1_1", [
      ], "Tcha! t'es pas drole.", "close_window",[]],
  
  [anyone,"gord_coin3-1", [
      ], "Quelle face...face Ecu ou face du Lys ?", "gord_coin4-1",[]],
  
  [anyone|plyr,"gord_coin4-1", [
      ], "Ecu.", "gord_coin5-1",[
      (str_store_string, s2, "@Ecu"),
      (str_store_string, s3, "@Lys"),]],
  [anyone|plyr,"gord_coin4-1", [
      ], "Lys.", "gord_coin5-1",[
      (str_store_string, s2, "@Lys"),
      (str_store_string, s3, "@Ecu"),]],
  
  [anyone,"gord_coin5-1", [
      ], "Allez!...j'éspère qu'elle ne va pas encore tomber dans mon vere.", "gord_coin6-1",[
      (store_random_in_range, "$rand2", 0, 2),]],
  
  [anyone,"gord_coin6-1", [
      (eq,"$rand2",0),
      ], "J'ai gagné! ha,ha ha !", "gord_coin6a-1",[]],
  [anyone,"gord_coin6-1", [
      (eq,"$rand2",1),
      ], "Face {s2},j'ai perdu ,putain!.", "close_window",[
      (troop_add_gold,"trp_player",reg6),
  ]],
  
  [anyone|plyr,"gord_coin6a-1", [
      ], "Pas de chance...voila tes {reg6} ecus.", "close_window",[
      (troop_remove_gold,"trp_player",reg6),
  ]],
  
  ######################## mise
  
  [anyone|plyr,"generique_des", [
      
      ], "Faisons une partie aux dés.", "start_des",[
  ]],
  [anyone|plyr,"generique_des", [
      ], "On a assez joué.", "des_end",[]],
  
  [anyone,"des_end", [
      ], "Alors c'es terminé ? Bon, retour au travail.", "close_window",[]],
  
  
  ####################### mise
  
  [anyone,"start_des", [
      ], "Quelle est la mise?", "des_misesop",[]],
  
  [anyone|plyr,"des_misesop", [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 1),
      ], "1 écus.", "des_misesop2",[
      (assign, reg6, 1),
  ]],
  [anyone|plyr,"des_misesop", [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 2),
      ], "2 écus.", "des_misesop2",[
      (assign, reg6, 2),
  ]],
  [anyone|plyr,"des_misesop", [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 3),
      ], "3 écus.", "des_misesop2",[
      (assign, reg6, 3),
  ]],
  [anyone|plyr,"des_misesop", [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 4),
      ], "4 écus.", "des_misesop2",[
      (assign, reg6, 4),
  ]],
  [anyone|plyr,"des_misesop", [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 5),
      ], "5 écus.", "des_misesop2",[
      (assign, reg6, 5),
  ]],
  [anyone|plyr,"des_misesop", [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 10),
      ], "10 écus.", "des_misesop2",[
      (assign, reg6, 10),]],
  [anyone|plyr,"des_misesop", [
      ], "On a assez joué.", "des_mises_end",[]],
  
  [anyone,"des_mises_end", [
      ], "C'est pas drole.", "close_window",[]],
  
  ##############################
  
  [anyone,"des_misesop2", [
      ], "Je lance les dés.", "des_mises2",[
      (play_sound, "snd_dices"),
      (store_random_in_range, "$rand2", 0, 3),
  ]],
  
  
  
  [anyone,"des_mises2", [
      (eq,"$rand2",0),
      ], "J'ai gagné! ha,ha ha !", "des_mises3",[]],
  [anyone,"des_mises2", [
      (eq,"$rand2",1),
      ], "J'ai perdu.", "close_window",[
      (troop_add_gold,"trp_player",reg6),
  ]],
  
  [anyone|plyr,"des_mises3", [
      ], "On ne peut pas gagner a tous les coups.", "close_window",[
      (troop_remove_gold,"trp_player",reg6),
  ]],
  
  
  [anyone,"des_mises2", [
      (eq,"$rand2",2),
      ], "Exequo, les mises sont anulées.", "generique_des",[]],
  
  
  
  
  ############################################################################################################
  ################################################### jeux de des fin
  
  #taverne de gordaine1
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys4"),
    ],
    "Tu viens passer le test?", "gordtavern1", [(play_sound, "snd_sanslys_taverne"),]],
  [anyone|plyr ,"gordtavern1", [], "Oui,des conseils a me donner?", "gordtavern11",[]],
  [anyone|plyr ,"gordtavern1", [], "Pas du tout,adieu.", "close_window",[]],
  [anyone ,"gordtavern11", [], "Un bon conseil oui,repart d'ou tu viens...Ha,ha,ha!", "close_window", []],
  
  
  #guarde
  ############################################################################################################
  ############################################################################################################
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys7"),
    ],
    "...", "guard_gordnosp", []],
  [anyone|plyr ,"guard_gordnosp", [], "Tu n'as pas beaucoup de converssation, rien a dire peut etre?", "guard_gordnosp2",[]],
  [anyone ,"guard_gordnosp2", [], "...", "close_window",
    [
  ]],
  ############################################################################################################
  ############################################################################################################
  #combatants
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys2"),
    ],
    "Ne reste pas la,tu voie bien qu'on s'entraine.", "dial_tespasrestergord", []],
  [anyone|plyr ,"dial_tespasrestergord", [],  "Mes excuses.", "close_window",[]],
  
  #combatants2
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys3"),
    ],
    "Restez en arière.", "dial_tespasrestergord2", []],
  [anyone|plyr ,"dial_tespasrestergord2", [],  "...", "close_window",[]],
  
  
  
  
  
  ############################### MODIFIER ET CONTINUER A DUMY ################################################################################################
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys1"),
      (eq, "$menbredesslok", 1),
    ],
    "Que veux tu ? tu es déja des notres non? pourquois venire m'enmerder encore une fois?.", "gordaintest_segonchannnc",[]],
  
  # [anyone|plyr ,"gordaintest_segonchannnc", [],  "J'ai une enigme pour vous Capitaine.", "gordainjok",[]],
  [anyone|plyr ,"gordaintest_segonchannnc", [],  "Toujours aussi agréssif hein,on es pourtant de la meme compagnie.", "gord_memcompapa",[]],
  
  #[anyone ,"gordainjok", [], "Hum,dit toujours.", "gordainjok2",[]],
  [anyone ,"gord_memcompapa", [], "Ca oui,je suis en veine, je suis le frére de tous les paysans qui revent de porter une arme...fout l'camp.", "close_window",[]],
  
  #[anyone|plyr ,"gordainjok2", [],  "Vous la touchiez avant,vous la buviez avant,mais a present elle ne sera qu'un souvenir,qui es elle?", "gordainjok3",[]],
  
  #[anyone ,"gordainjok3", [], "Hum,et c'est..?.", "gordainjok4",[]],
  #  [anyone|plyr ,"gordainjok4", [],  "Votre solde! ordres du maitre,il m'as dit de vous dire que les temps sont durs et les soldes des élements pas indispenssables seront reduites!", "gordainjok5",[]],
  #  [anyone ,"gordainjok5", [], "Quois? le...c'est inadmissible! il va m'entendre,apres tout ce que j'es fait pour lui...", "close_window",[]],
  
  ###########
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys1"),
      (eq, "$retestintelsl", 1),
      (store_current_hours,":cur_hours"),
      (val_sub, ":cur_hours", 4),
      (gt, ":cur_hours", "$gamble_last_time"),
    ],
    "Alors,on a désaoulé,on es pret pour donner sa réponsse ou tu cherche l'adresse de la taverne?.", "gordaintest_segonch33",[(play_sound, "snd_sanslys_greetings"),]],
  
  [anyone|plyr ,"gordaintest_segonch33", [],  "Je suis pret.", "gordaintest_segonrepons",[]],
  [anyone|plyr ,"gordaintest_segonch33", [],  "Je préfère les taverne crasseuses a vos tests stupides,je devais vous le dire.", "close_window",[]],
  
  [anyone ,"gordaintest_segonrepons", [], "Bon...je disais,Celui qui me fabrique me vend,Celui qui m'ach?e ne m'utilise pas,Celui qui m'utilise ne le sait pas.qui suis je?.", "gordaintest_segonrepons2",[]],
  
  [anyone|plyr ,"gordaintest_segonrepons2", [],  "Le vent!", "wrongintell2",[]],
  [anyone|plyr ,"gordaintest_segonrepons2", [],  "L'écu", "wrongintell2",[]],
  [anyone|plyr ,"gordaintest_segonrepons2", [],  "Un chapeau!", "wrongintell2",[]],
  [anyone|plyr ,"gordaintest_segonrepons2", [],  "Un cerceuil.", "goodintel2",[]],
  [anyone|plyr ,"gordaintest_segonrepons2", [],  "Une chope pour la bièrre.", "wrongintell2",[]],
  [anyone|plyr ,"gordaintest_segonrepons2", [],  "Un menssonge.", "wrongintell2",[]],
  [anyone|plyr ,"gordaintest_segonrepons2", [],  "Je ne sais pas...", "wrongintell2",[]],
  
  
  [anyone ,"wrongintell2", [], "Fout l'camp !!! et ne reviend plus t'as compris?!", "close_window",
    [
      (store_current_hours,":cur_hours"),
      (assign, "$gamble_last_time", ":cur_hours"),
      (assign, "$retestintelsl2", 1),
  ]],
  [anyone ,"goodintel2", [], "Ah! tout de meme,nous avons affaire a un genie,mais qui doit réfléchire longtemp avant de nous reveler son talent,le maitre sera avisé crois moi,et tu sera surement affecté a la délicate mission de livraison de la bièrre,si tu t'en sent cappable.", "goodintelend55",[]],
  [anyone ,"goodintelend55", [], "Va voir le maitre de la compagnie en haut de la tour carée a l'entré,c'est lui qui te remetra ton armure et ta première affectation,pardonne moi si je ne fête pas ta victoire avec toi,mais j'es mieux a foutre,comme eduquer des gamins venues de la campagne.", "close_window",[(assign, "$menbredesslok", 1),]],
  
  
  ###si temp pas ecoulee
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys1"),
      (eq, "$retestintelsl2", 1),
    ],
    "Tiens,mais c'est notre Genie! tu reviendra passer le test plus tard pour le moment on as trop d'idiots.", "gordgord_failidiot",[(play_sound, "snd_sanslys_greetings"),]],
  [anyone|plyr ,"gordgord_failidiot", [],  "N'allez pas trop loing...", "close_window",[]],
  
  
  #GORDAINE BASE SANG LYS instructeur
  #dumy WIN
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys1"),
      (eq, "$end_dumy", 1),
    ],
    "Cetait pas si dur hein? tu nous a montré que tu savais te servire d'une lame et que tu avais la force de l'abattre sur les armures de nos ennemis,avec une force suffisante pour les briser.", "dumydial_testgord2fall",
    [
      (assign, "$bougemessage", 1),#variable afficher message "retournez voir l'instructeur"
      (assign, "$bougescendumy", 0),
      (assign, "$okpourdumygord", 1),
  ]],
  
  
  [anyone|plyr ,"dumydial_testgord2fall", [],  "Je suis engagé?.", "gordencgage",[]],
  [anyone ,"gordencgage", [], "Pas encore,la dernière qualité requise es l'intelligence,un soldat privé de son capitaine doit pouvoir a lui seul terminer un contrat pour un client,la force ,la rapidité et le savoir,ainssi qu'une facilité a s'adapter a toutes nouvelles situations font un soldat du SansLys. Et toi dit moi,pensse tu etre intelligent?.", "gordainintelstart",[]],
  [anyone|plyr ,"gordainintelstart", [],  "Nous verons ca.", "gordencgage2",[]],
  [anyone ,"gordencgage2", [], "Ecoute bien abrutis: Celui qui me fabrique me vend,Celui qui m'ach?e ne m'utilise pas,Celui qui m'utilise ne le sait pas.qui suis je?", "gordainintelgot",[]],  #CONTINUER TEST INTELLIGENCE ICIIIIIIIIIIIIIII
  
  [anyone|plyr ,"gordainintelgot", [],  "Un instructeur!", "wrongintell",[]],
  [anyone|plyr ,"gordainintelgot", [],  "Le vent.", "wrongintell",[]],
  [anyone|plyr ,"gordainintelgot", [],  "L'écu!", "wrongintell",[]],
  [anyone|plyr ,"gordainintelgot", [],  "Un chapeau.", "wrongintell",[]],
  [anyone|plyr ,"gordainintelgot", [],  "Un cerceuil.", "goodintel",[]],
  [anyone|plyr ,"gordainintelgot", [],  "Une chope pour la bièrre.", "wrongintell",[]],
  [anyone|plyr ,"gordainintelgot", [],  "Un menssonge.", "wrongintell",[]],
  [anyone|plyr ,"gordainintelgot", [],  "Je ne sais pas...", "wrongintell",[]],
  
  
  [anyone ,"wrongintell", [], "Espèce de sale poivrot,comment veux tu que l'on donne en meme temp une arme et le droit de porter le blason du SansLys a un imbécile pareil!", "close_window",
    [(assign, "$retestintelsl", 1),]],
  
  [anyone ,"goodintel", [], "Hum...c'est ca.", "goodintelend",[]],
  
  [anyone|plyr ,"goodintelend", [],  "C'est...la bonne réponsse c'est bien ca?", "goodintelend2",[]],
  [anyone ,"goodintelend2", [], "Oui.", "goodintelend3",[]],
  [anyone|plyr ,"goodintelend3", [],  "Alors je suis pris ?", "goodintelend5",[]],
  [anyone ,"goodintelend5", [], "Oui,va voir le maitre de la compagnie en haut de la tour carée a l'entré,c'est lui qui te remetra ton armure et ta première affectation,pardonne moi si je ne fête pas ta victoire avec toi,mais j'es mieux a foutre,comme eduquer des gamins venues de la campagne.", "close_window",[(assign, "$menbredesslok", 1),]],
  
  
  #dumy loose abrutis
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys1"),
      (eq, "$possibledestroudnow", 1),
    ],
    "T'attend quois Abrutis? les manequins sont la bas...va les mettre en morceaux.", "dumydial_testgordla",[]],
  
  [anyone|plyr ,"dumydial_testgordla", [],  "Ha!je...", "close_window",[]],
  
  
  
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys1"),
      (eq, "$instructeurbougessltest", 1),
    ],
    "C'est pas trop mal pour un debutant...me voila rassuré tu sais tenire une épée.une qualité indispenssable pour nous es la force,va au fond de la cour detruire les trois manequins en paille que je voye comment tu t'y prend..", "dial_testgord2fall",[]],
  
  
  [anyone|plyr ,"dial_testgord2fall", [],  "Tres bien.", "close_window",
    [
      (assign, "$reset_dumy", 1),
      (assign, "$possibledestroudnow", 1),
      (assign, "$okpourdumygord", -1),
      #####
  ]],
  [anyone|plyr ,"dial_testgord2fall", [],  "je reviendrais terminer ce travail...j'ai un probleme urgent a regler.", "close_window",[]],
  
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys1"),
      (eq, "$gordautreprochainchance", 1),
    ],
    "Tiens mais qui voila,notre vielle connaissance.déja de retour?...tu te moque de moi? Soit,si tu veux une autre chance tu es autorisé a passer le test de nouveau.", "dial_encorrdernteest", []],
  [anyone|plyr ,"dial_encorrdernteest", [],  "Je suis prêt.", "dial_encorrderdegainer",[]],
  [anyone|plyr ,"dial_encorrdernteest", [],  "Surement pas.", "close_window",[]],
  
  [anyone ,"dial_encorrderdegainer", [], "Tu sais comment ca se passe maintenant,Vitesse,Force et Precision...", "close_window",
    [
      (assign, "$gordcombatbat", -1),
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 0, 2, 0),
      (team_set_relation, 0, 3, 0),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 1, 3, 0),
      (team_set_relation, 2, 3, -1),
      (team_set_relation, 2, 0, 0),
      (team_set_relation, 2, 1, 0),
      (team_set_relation, 3, 2, -1),
      (team_set_relation, 3, 0, 0),
      (team_set_relation, 3, 1, 0),
      (music_set_situation, 0),
      (play_sound, "snd_chrono_cry_slwar1"),
  ]],
  
  
  #perdu
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys1"),
      (eq, "$instructeurbougessltest", -1),
    ],
    "Releve toi,tu es faible va t'en et ne reviend que quand tu seras enfin a la hauteur.", "dial_testgord2falllooseaa", [(assign, "$gordautreprochainchance", 1),]],
  [anyone|plyr ,"dial_testgord2falllooseaa", [],  "...", "close_window",[]],
  
  
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_gordaine_sang_lys1"),
    ],
    "J'éspère que vous êtes la pour passer le test de recrutement,entrer dans les quartiers du SansLys sans raison peut etre assimilé a de l'espionage,et nous traitons les espions comme il se doit,en les pendant dans la cour.", "dial_testgord",
    [(play_sound, "snd_sanslys_greetings"),
      (call_script, "script_end_quest", "qst_sl_1caserne"),
  ]],
  
  [anyone|plyr ,"dial_testgord", [],  "Je suis ici pour passer le test Capitaine!", "gotestgordainego",[]],
  [anyone|plyr ,"dial_testgord", [],  "Qu'est ce que le SansLys exactement?", "quesangglyiscap", []],
  [anyone|plyr ,"dial_testgord", [],  "Je m'en vais..tout de suite!", "close_window", []],
  
  [anyone ,"quesangglyiscap", [],"Comment ca...tu ne sais pas ou tu es,c'est bien ca? j'ai tres peut de patience,alors je vais simplement te dire que le SansLys es la plus grande compagnie de mercenaires qui soit,et nous sommes actuellement au service du la ville de Bourges,nous logeons dans la caserne Royale,la ou nous sommes actuellement,j'éspère que tu comprend...", "dial_testgord", []],
  
  
  
  [anyone ,"gotestgordainego", [],"Bien,si tu pensse etre a la hauteur...sache que nous traitons avec respect nos camarades,mais nous n'avons aucune pitié pour les faibles et envers ceux qui échouent,es tu prêt recrue?.", "pretcrecregordainee", []],
  
  
  [anyone|plyr ,"pretcrecregordainee", [],  "Je suis pret Capitaine!", "pretpretpretgord", []],
  [anyone|plyr ,"pretcrecregordainee", [],  "Je ne pensse pas etre pret a suporter tout ca pour quelques écus", "nopaspreetgord", []],
  [anyone ,"nopaspreetgord", [], "Alors,hors de ma vue!", "close_window", []],
  
  
  [anyone ,"pretpretpretgord", [], "Avans tout,je doit savoir pourquois tu veux t'engager.", "pastpourquoismercen", []],
  
  [anyone|plyr ,"pastpourquoismercen", [],  "Je désire gagner ma vie en tant qu'homme d'armes,et gravire les échelons,jusqu'a etre au service d'un Roi.", "pourquoismercen1", []],
  [anyone|plyr ,"pastpourquoismercen", [],  "J'ai une profonde admiration pour la compagnie du SansLys.", "pourquoismercen2", []],
  [anyone|plyr ,"pastpourquoismercen", [],  "Je ne sais pas trop...", "pourquoismercen3", []],
  
  [anyone ,"pourquoismercen1", [], "Tres bien,je suis convaincu,tu peut passer les tests,sache que nous recherchons des combatants parfaits pour notre compagnie.", "suitegordainegotest", []],
  [anyone ,"pourquoismercen2", [], "Soit,mais si tu veux en faire partie,il faudra etre a la hauteur.", "suitegordainegotest", []],
  [anyone ,"pourquoismercen3", [], "Crétin,tu manque de la qualité principale pour etre un homme d'armes,etre déja un homme.va t'en,j'ai déja perdu trop de temp.", "close_window", []],
  
  
  [anyone ,"suitegordainegotest", [],"Nous exigeons de nos hommes,de l'habileté avec une lame,de la force et de l'intelligence.", "gordaineattentiongo", []],
  [anyone ,"gordaineattentiongo", [],"Pour le premier test,il s'agit d'evaluer ton habileté avec une arme,montre moi comment tu dégaine ta lame pour parer le premier coup.", "close_window",
    [
      (assign, "$gordcombatbat", -1),
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 0, 2, 0),
      (team_set_relation, 0, 3, 0),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 1, 3, 0),
      (team_set_relation, 2, 3, -1),
      (team_set_relation, 2, 0, 0),
      (team_set_relation, 2, 1, 0),
      (team_set_relation, 3, 2, -1),
      (team_set_relation, 3, 0, 0),
      (team_set_relation, 3, 1, 0),
      (music_set_situation, 0),
      (play_sound, "snd_chrono_cry_slwar1"),
  ]],
  
  
  #dials acteurs taverne 3lys bourges
  #tavernier si beligerant mort et plus de renomee ville
  [anyone,"start", [(eq, "$g_talk_troop", "trp_tlys_tavernkeeper"),
      (eq, "$slivresmortokstopp", 1),
    ],
    "Seigneur, je vais devoir netoyer tout ce sang.", "trois_lysbeligerstoop", []],
  
  [anyone|plyr,"trois_lysbeligerstoop", [], "Reconvertissez vous en boucherie dans ce cas.", "close_window",[]],
  
  #tavernier si beligerant mort
  [anyone,"start", [(eq, "$g_talk_troop", "trp_tlys_tavernkeeper"),
      (eq, "$slivresmortokmaitre", 1),
    ],
    "C'est fini? alors vous l'avez...", "trois_lysbeligeransl", []],
  
  [anyone|plyr,"trois_lysbeligeransl", [], "C'es terminé,vous ne craigniez plus rien.", "trois_lysbeligeransl2",[]],
  [anyone,"trois_lysbeligeransl2", [],"Oh,merci Messire,vous m'enlever une sacré épine,je vais devoir netoyer tout ce sang,mais au moin je vais pouvoir réouvrire ma taverne.", "trois_lysbeligeransl3",
    [(call_script, "script_change_player_relation_with_center", "$current_town", 2),]],
  [anyone|plyr,"trois_lysbeligeransl3", [], "Ne parlez de ca a personne,pour autant qu'un tavernier peut tenire sa langue.", "close_window",[(assign, "$slivresmortokstopp", 1),]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_tlys_tavernkeeper"),
    ],
    "Fuyez Messire,un soldat ivre a tué un millicien,il s'est en suite refugié dans ma taverne.", "trois_lysbeligeranslnn", []],
  
  [anyone|plyr,"trois_lysbeligeranslnn", [], "Je viens pour lui,ou es t'il?.", "trois_lysbeligeranslnn2",[]],
  [anyone,"trois_lysbeligeranslnn2", [],"La,tout en haut,faites attention Messire,c'est un mercenaire de metier et il est comme fol c'est tres dangeureux.", "trois_lysbeligeranslnn3",[]],
  [anyone|plyr,"trois_lysbeligeranslnn3", [], "Ne bougez pas d'ici.", "close_window",[]],
  
  
  #vendeur livre si beligerant mort
  [anyone,"start", [(eq, "$g_talk_troop", "trp_tlys_bookseller"),
      (eq, "$slivresmortokmaitre", 1),
    ],
    "C'est Incroyable,il y aurais de quois ecrire un livre,quelle aventure!", "trois_lysbelibooksel", []],
  
  [anyone|plyr,"trois_lysbelibooksel", [], "Quel drame vous voullez dire,ecrivez donc sur cette partie de la noblesse qui traite ses cerfs comme un troupeau de porcs.", "close_window",[]],
  
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_tlys_bookseller"),
    ],
    "J'aimerais deffendre ces dames,mais je ne suis qu'un vendeur de livres voyez vous,et...", "trois_lysbelibooksel2", []],
  
  [anyone|plyr,"trois_lysbelibooksel2", [], "Je m'en occupe,personne ne vous demande de vous battre aujourd'hui.", "close_window",[]],
  #################
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sang_lysivretlys"),
    ],
    "Arière manant! pouriture...fripouille!", "trois_lysbeligerentfight", []],
  
  [anyone|plyr,"trois_lysbeligerentfight", [], "On se connais?", "trois_lysbeligerentfight2",[]],
  
  [anyone,"trois_lysbeligerentfight2", [],"Vous etes bien tous pareils les batards du SansLys, vous devriez vous appeller les sans scrupules, car c'est avec les ventres creux venus de la campagne que votre grand maitre accumule des mongtagnes d'écus,Norbert,va ramasser les cadavres de tes camarades,Norbert attaque ce campement de bléssés de guerre ils font peur aux marchants qui nous payent pour netoyer les routes,Norbert ici,Norbert la...bande de Batards!!!", "trois_lysbeligerentfight3",[]],
  [anyone|plyr,"trois_lysbeligerentfight3", [], "Tu devrais te calmer et lacher tes armes.", "trois_lysbeligerentfight4",[]],
  [anyone,"trois_lysbeligerentfight4", [],"Dépose les tiennes si tu veux parlementer, bientot si tu reste dans cette compagnie,toi aussi tu sera a bout,et ca va mal finire,oh oui! et je ne te parle pas des champs de batailles,les vrais,la ou le maitre amasse le plus décus,la ou l'horeur es a son comble surtout!", "trois_lysbeligerentfight5",[]],
  
  [anyone|plyr,"trois_lysbeligerentfight5", [], "Tu as trop bu,suis moi,tu fera quelques temps dans un cachot et tu resortira tot ou tard.", "trois_lysbeligerentfight6",[]],
  [anyone,"trois_lysbeligerentfight6", [],"Qu'es ce que tu raconte ? je ne suis pas saoul.", "trois_lysbeligerentfight7",[]],
  [anyone|plyr,"trois_lysbeligerentfight7", [], "Rend toi et tout se passera...", "trois_lysbeligerentfight8",[]],
  [anyone,"trois_lysbeligerentfight8", [],"MORT AU SANSLYS!!!.", "close_window",
    [
      (mission_disable_talk),
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 1, 0, -1),
      (play_sound, "snd_man_warcry"),
  ]],
  ###################################################
  
  
  #dialogues vendeurs ressourcesbis
  #  dijon
  [anyone,"start", [(eq, "$g_talk_troop", "trp_ressource_merchant_dijon"),
      (eq, "$nextdialressourcesvendij", 1),
    ],
    "Avez vous besoin de bois,ou de la corde...une pierre a aiguiser peut etre?.", "march_ressources_dij", [(play_sound, "snd_marchands_res_greetings"),]],
  
  [anyone|plyr,"march_ressources_dij", [], "J'aimerais apprendre a forger des armes.", "march_ressources_hodij",[]],
  [anyone|plyr,"march_ressources_dij", [], "Je voudais acheter des matières prmières.", "ressources_campdijo",[]],
  [anyone|plyr,"march_ressources_dij", [], "Ou puis je trouver d'autres vendeurs de ressources?", "ressources_ouadijdijontpar",[]],
  
  [anyone|plyr,"march_ressources_dij", [], "Voudriez vous jouer aux dés ?", "debut_des",[]],
  [anyone,"debut_des", [],"Avec plaisire !", "generique_des",[]],
  
  [anyone|plyr,"march_ressources_dij", [], "Je n'ai besoin de rien merci.", "close_window",[]],
  
  [anyone,"ressources_ouadijdijontpar", [],"Je suppose qu'il y en as dans le nord de la France,mais je ne saurais vous dire ou,voyez vous nous sommes en guerre contre la france,par contre je sais qu'il y a un vendeur a Bordeau.", "ressources_genedij",[]],
  [anyone,"ressources_campdijo", [],"Voila tout le stock.", "ressources_genedij",[[change_screen_trade]]],
  [anyone,"ressources_genedij", [],"Autre chose?.", "march_ressources_dij",[]],
  
  [anyone,"march_ressources_hodij", [],"Si c'est la fabrication d'armes qui vous intéresse,rien de plus simple pour commencer,il vous faut un plan que vous pouvez acheter auprés d'un forgeron,il y aura une liste des ressources et outils indispenssables a la confection,lisez le dans votre atelier et commencez la forge,attention toutefois certaines armes difficiles a réaliser demandent un niveau d'agilité élevé.", "march_ressources_hodij2",[]],
  [anyone|plyr,"march_ressources_hodij2", [], "Certes,je m'en doute,mais si je n'ai pas d'atelier et que je ne suis pas fixé dans une ville?", "march_ressources_hodij3",[]],
  [anyone,"march_ressources_hodij3", [],"Et bien les forgerons itinnérants existent vous savez,dans ce cas il vous faut travailler dans un atelier improvisé dans un camp aux abords de la ville,cela me parait évident pourtant.", "ressources_genedij",[]],
  
  #dialogues vendeurs ressources
  [anyone,"start", [(eq, "$g_talk_troop", "trp_ressource_merchant_dijon"),
    ],
    "Bienvenue a Dijon,je ne vous es jamais vue dans la ville,si vous etes venu installer votre atelier,vous aurez besoin de m'acheter des ressources,que vous soyez forgeron,charpentier,ou meme cordonier.", "march_dijs1", [(play_sound, "snd_marchands_res_greetings"),]],
  [anyone|plyr,"march_dijs1", [], "Pourquois ne pas acheter chez les grossistes?", "march_dijsgro",[]],
  [anyone|plyr,"march_dijs1", [], "J'aimerais apprendre a forger des armes.", "march_ressodij",[]],
  [anyone|plyr,"march_dijs1", [], "Je n'ai besoin de rien merci.", "close_window",[]],
  [anyone,"march_dijsgro", [],"Naturellement vous pouvez comparer les prix et acheter les ressources les moins chères,mais nous nous efforcons de garder les prix les plus bas,malgrès la guerre,et de plus nous reunissons suffisament de ressources pour assurer les demandes en différentes matières des productions des artisants,par les temps qui courent,ne pas avoir a se deplacer de villes en villes pour reunir toutes ces matières premieres n'as pas de prix!.", "march_dijs1",[]],
  
  [anyone,"march_ressodij", [],"Si c'est la fabrication d'armes qui vous intéresse,rien de plus simple pour commencer,il vous faut un plan que vous pouvez acheter auprés d'un forgeron,il y aura une liste des ressources et outils indispenssables a la confection,lisez le dans votre atelier et commencez la forge,attention toutefois certaines armes difficiles a réaliser demandent un niveau d'agilité élevé,pour le reste,c'est en forgant que l'on deviens....", "march_ressodij2",[]],
  [anyone|plyr,"march_ressodij2", [], "Certes,je m'en doute,mais si je n'ai pas d'atelier et que je ne suis pas fixé dans une ville?", "march_ressodij3",[]],
  [anyone,"march_ressodij3", [],"Et bien les forgerons itinnérants existent vous savez,dans ce cas il vous faut travailler dans un atelier improvisé dans un camp aux abords de la ville,cela me parait évident pourtant.", "march_ressodij5",[]],
  [anyone|plyr,"march_ressodij5", [], "Tres bien,j'aimerais voir quelles ingredients vous avez a vendre dans ce cas.", "march_ressbdij",[(assign, "$nextdialressourcesvendij", 1),]],
  [anyone|plyr,"march_ressodij5", [], "Je m'en souviendrais merci.", "close_window",[(assign, "$nextdialressourcesvendij", 1),]],
  
  [anyone,"march_ressbdij", [],"Naturellement,voila tout ce qu'il me reste.", "march_ressbdijend",[[change_screen_trade]]],
  [anyone,"march_ressbdijend", [],"A une autre fois je l'éspère.", "close_window",[]],
  
  
  #  bordeau
  [anyone,"start", [(eq, "$g_talk_troop", "trp_ressource_merchant_bordeau"),
      (eq, "$nextdialressourcesvenbord", 1),
    ],
    "Du bois,des cordes solides,pierres a aiguiser...", "march_ressources_bord", [(play_sound, "snd_marchands_res_greetings"),]],
  
  [anyone|plyr,"march_ressources_bord", [], "J'aimerais apprendre a forger des armes.", "march_ressources_hobord",[]],
  [anyone|plyr,"march_ressources_bord", [], "Je voudais acheter des matières prmières.", "ressources_campbord",[]],
  [anyone|plyr,"march_ressources_bord", [], "Ou puis je trouver d'autres vendeurs de ressources?", "ressources_ouabordedear",[]],
  [anyone|plyr,"march_ressources_bord", [], "Voudriez vous jouer aux dés ?", "debut_desno",[]],
  [anyone,"debut_desno", [],"Non merci, j'ai horeur de ca.", "close_window",[]],
  [anyone|plyr,"march_ressources_bord", [], "Je n'ai besoin de rien merci.", "close_window",[]],
  
  [anyone,"ressources_ouabordedear", [],"Je suppose qu'il y en as dans le nord de la France,mais je ne saurais vous dire ou,par contre je sais qu'il y en as un a Dijon en Bourgogne.", "ressources_genebord",[]],
  [anyone,"ressources_campbord", [],"Naturellement,voila tout ce qu'il me reste.", "ressources_genebord",[[change_screen_trade]]],
  [anyone,"ressources_genebord", [],"Autre chose?.", "march_ressources_bord",[]],
  
  [anyone,"march_ressources_hobord", [],"Si c'est la fabrication d'armes qui vous intéresse,rien de plus simple pour commencer,il vous faut un plan que vous pouvez acheter auprés d'un forgeron,il y aura une liste des ressources et outils indispenssables a la confection,lisez le dans votre atelier et commencez la forge,attention toutefois certaines armes difficiles a réaliser demandent un niveau d'agilité élevé.", "march_ressources_hobord2",[]],
  [anyone|plyr,"march_ressources_hobord2", [], "Certes,je m'en doute,mais si je n'ai pas d'atelier et que je ne suis pas fixé dans une ville?", "march_ressources_hobord3",[]],
  [anyone,"march_ressources_hobord3", [],"Et bien les forgerons itinnérants existent vous savez,dans ce cas il vous faut travailler dans un atelier improvisé dans un camp aux abords de la ville,cela me parait évident pourtant.", "ressources_genebord",[]],
  
  #dialogues vendeurs ressourcesc
  [anyone,"start", [(eq, "$g_talk_troop", "trp_ressource_merchant_bordeau"),
    ],
    "Bien le bonjour,que cherchez vous dans la rue du commerce,du bois,de la corde,ou quelque chose de special peut etre?.", "march_bods1", [(play_sound, "snd_marchands_res_greetings"),]],
  [anyone|plyr,"march_bods1", [], "Pourquois ne pas acheter chez les grossistes?", "march_bodsgro",[]],
  [anyone|plyr,"march_bods1", [], "J'aimerais apprendre a forger des armes.", "march_ressoubor",[]],
  [anyone|plyr,"march_bods1", [], "Je n'ai besoin de rien merci.", "close_window",[]],
  [anyone,"march_bodsgro", [],"Naturellement vous pouvez comparer les prix et acheter les ressources les moins chères,mais nous nous efforcons de garder les prix les plus bas,malgrès la guerre,et de plus nous reunissons suffisament de ressources pour assurer les demandes en différentes matières des productions des artisants,par les temps qui courent,ne pas avoir a se deplacer de villes en villes pour reunir toutes ces matières premieres n'as pas de prix!.", "march_bods1",[]],
  
  [anyone,"march_ressoubor", [],"Si c'est la fabrication d'armes qui vous intéresse,rien de plus simple pour commencer,il vous faut un plan que vous pouvez acheter auprés d'un forgeron,il y aura une liste des ressources et outils indispenssables a la confection,lisez le dans votre atelier et commencez la forge,attention toutefois certaines armes difficiles a réaliser demandent un niveau d'agilité élevé,pour le reste,c'est en forgant que l'on deviens....", "march_ressoubor2",[]],
  [anyone|plyr,"march_ressoubor2", [], "Certes,je m'en doute,mais si je n'ai pas d'atelier et que je ne suis pas fixé dans une ville?", "march_ressoubor3",[]],
  [anyone,"march_ressoubor3", [],"Et bien les forgerons itinnérants existent vous savez,dans ce cas il vous faut travailler dans un atelier improvisé dans un camp aux abords de la ville,cela me parait évident pourtant.", "march_ressoubor6",[]],
  [anyone|plyr,"march_ressoubor6", [], "Tres bien,j'aimerais voir quelles ingredients vous avez a vendre dans ce cas.", "march_ressbordven",[(assign, "$nextdialressourcesvenbord", 1),]],
  [anyone|plyr,"march_ressoubor6", [], "Je m'en souviendrais merci.", "close_window",[(assign, "$nextdialressourcesvenbord", 1),]],
  
  [anyone,"march_ressbordven", [],"Naturellement,voila tout ce qu'il me reste.", "march_ressbordvenend",[[change_screen_trade]]],
  [anyone,"march_ressbordvenend", [],"A une autre fois je l'éspère.", "close_window",[]],
  
  
  #tavernier quete de rouen
  #derniere phrase
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_12_tavernkeeper"),
      (check_quest_active, "qst_foret_filleroeun"),
      (neg|check_quest_succeeded, "qst_foret_filleroeun"),
      (neg|check_quest_failed, "qst_foret_filleroeun"),
      (neg|check_quest_finished, "qst_foret_filleroeun"),
      (eq, "$fin_tavern_rouen", 1),
    ],
    "Partez, ou je vous défigure avec le tison brulant.", "enquete_rouenattt", []],
  
  [anyone|plyr,"enquete_rouenattt", [], "Vous n'auriez jamais le courage bande de laches.", "close_window",[]],
  
  
  #start
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_12_tavernkeeper"),
      (check_quest_active, "qst_foret_filleroeun"),
      (neg|check_quest_succeeded, "qst_foret_filleroeun"),
      (neg|check_quest_failed, "qst_foret_filleroeun"),
      (neg|check_quest_finished, "qst_foret_filleroeun"),
    ],
    "Le bonjour mon seigneur,que voullez vous boire ?", "enquete_rouen_tav", [(play_sound, "snd_taverniers_h"), ]],
  
  [anyone|plyr,"enquete_rouen_tav", [], "Nous boirons quand vous m'aurez donné quelques renseignements.", "enquete_rouen_tav2",[]],
  
  [anyone,"enquete_rouen_tav2", [],"Oh, Je vois tres bien de quois vous voullez parler, je ne sais rien allez vous comprendre ?", "enquete_rouen_tav4",[]],
  
  [anyone|plyr,"enquete_rouen_tav4", [], "Mon employeur m'envoie vous chercher pour vous enmener dans un endroit ou vous pourrez parler, je vous conseil de parler tant qu'il en es temps.", "enquete_rouen_tav5",[]],
  [anyone,"enquete_rouen_tav5", [],"Que dites vous ? je vais de ce pas m'en plaindre au seigneur, je recevrais sa protection et ce maraud sera jeté au donjon.", "enquete_rouen_tav6",[]],
  
  [anyone|plyr,"enquete_rouen_tav6", [], "Vous savez qu'il n'en sera rien, vous allez perdre votre temps, mon employeur niera et vous n'avez aucune preuve, c'est vous qui allez perdre votre auberge...alors parlez maintenant.", "enquete_rouen_tav7",[]],
  
  [anyone,"enquete_rouen_tav7", [],"Je voie,puis que vous ne me laissez pas le choix misérables.", "enquete_rouen_tav8",[]],
  
  [anyone|plyr,"enquete_rouen_tav8", [], "Qui sont les hommes que vous avez servi et ou sont t'ils allés avec la fille ?", "enquete_rouen_tav9",[]],
  
  [anyone,"enquete_rouen_tav9", [],"Vous ne savez pas ou vous mettez les pieds, ces gens adorent le diable, ils, ils vont boire le sang de cette pauvre fille en échange de leur vie éternelle, seigneur protégez nous.", "enquete_rouen_tav10",[]],
  
  [anyone|plyr,"enquete_rouen_tav10", [], "Ce sont bien la des histoires de tavernes, ou sont t'ils allés ?  parle.", "enquete_rouen_tav11",[]],
  
  [anyone,"enquete_rouen_tav11", [],"Tout le monde sait qu'ils on un repert dans la foret au nord d'ici, mais vous ariverez trop tard, elle es probablement déja morte.", "enquete_rouen_tav12",[]],
  [anyone,"enquete_rouen_tav12", [],"De plus, vous allez attirer leur malédiction,toute la ville sera malade, laissez donc une jeune fille mourire de temp a autre, c'est la seule facon de se protéger de ces démonts.", "close_window",
    [
      (party_set_flags, "p_rouen_foret", pf_disabled, 0),
      (party_set_flags, "p_rouen_foret", pf_always_visible, 1),
      (party_set_flags, "p_rouen_foret", pf_quest_party, 1),
      (assign, "$fin_tavern_rouen", 1),
  ]],
  
  ################# dial extorssion paris
  #  grossiste
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_1_merchant"),
      (eq, "$okmarchparisgross", 0),
      (check_quest_active, "qst_extorsion"),
      (neg|check_quest_succeeded, "qst_extorsion"),
      (neg|check_quest_failed, "qst_extorsion"),
      (neg|check_quest_finished, "qst_extorsion"),
    ],
    "Que puis je pour vous?", "exto_parigossisst",
    [(play_sound, "snd_taverniers_h"),]],
  
  [anyone|plyr,"exto_parigossisst", [],"Messire Villandrandro m'envoie chercher l'argent de sa protection.", "exto_parigossisststar",[]],
  [anyone|plyr,"exto_parigossisst", [],"Non, je ne veux rien.", "close_window",[]],
  
  
  [anyone,"exto_parigossisststar", [],"Non,je vous en prie, pas maintenant! je n'ai rien vous comprennez?", "exto_parigossisststarno",[]],
  
  [anyone|plyr,"exto_parigossisststarno", [],"Il faut me payer,ou c'est votre sang que je prendrais.", "exto_parigossisststarforc",[]],
  [anyone|plyr,"exto_parigossisststarno", [],"Soit,je suppose que j'aurais interet a payer a votre place si je ne veux pas d'ennuis.", "exto_parigossisststarnot",[]],
  
  
  [anyone,"exto_parigossisststarnot", [],"Hum...merci, enfin, je suppose.", "close_window",
    [
      (assign, "$okmarchparisgross", 1),
  ]],
  [anyone,"exto_parigossisststarforc", [],"Non,non, attendez, je vais vous régler en nature qu'en dite vous? voila,c'est pour vous prennez tout, et dites a votre chez que la prochaine fois je n'aurais vraiment plus rien.", "close_window",
    [
      #add objets divers
      (assign, "$okmarchparisgross", 1),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
      (troop_add_item, "trp_player", "itm_bread", 0),
      (troop_add_item, "trp_player", "itm_sausages", 0),
      (troop_add_item, "trp_player", "itm_tools", 0),
      (troop_add_item, "trp_player", "itm_pottery", 0),
  ]],
  
  
  #  armurier
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_1_armorer"),
      (eq, "$okmarchparisarm", 0),
      (check_quest_active, "qst_extorsion"),
      (neg|check_quest_succeeded, "qst_extorsion"),
      (neg|check_quest_failed, "qst_extorsion"),
      (neg|check_quest_finished, "qst_extorsion"),
    ],
    "Une cotte de maille? un heaume peut etre? pour les armures de plates il vous faudra passer commande a...", "exto_parisvetok",
    [(play_sound, "snd_taverniers_h"),]],
  
  [anyone|plyr,"exto_parisvetok", [],"Messire Villandrandro m'envoie chercher l'argent de sa protection.", "exto_parisvetokgo",[]],
  [anyone|plyr,"exto_parisvetok", [],"Non, je ne veux rien.", "close_window",[]],
  
  
  [anyone,"exto_parisvetokgo", [],"C'est donc ca, maudits voleurs, moi qui avais fait une bonne journée. prennez ca et allez au diable.", "close_window",
    [
      (assign, "$okmarchparisarm", 1),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
      (call_script, "script_troop_add_gold", "trp_player", 300),
  ]],
  
  
  #  forgeron
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_1_weaponsmith"),
      (eq, "$okmarchparisforge", 0),
      (check_quest_active, "qst_extorsion"),
      (neg|check_quest_succeeded, "qst_extorsion"),
      (neg|check_quest_failed, "qst_extorsion"),
      (neg|check_quest_finished, "qst_extorsion"),
    ],
    "Avez vous besoin d'une arme Messire?", "exto_parisokforgla",
    [(play_sound, "snd_taverniers_h"),]],
  
  [anyone|plyr,"exto_parisokforgla", [],"Messire Villandrandro m'envoie chercher l'argent de sa ...protection.", "exto_parisokforglafin",[]],
  [anyone|plyr,"exto_parisokforgla", [],"Non, merci bien.", "close_window",[]],
  
  
  [anyone,"exto_parisokforglafin", [],"Bien, ai je le choix? mais un jour vous vous retrouverez tous dans un cachot et vous vous ferez pendre...pardonnez moi! je ne sais pas ce qui m'as pris, tennez,partez maintenant.", "close_window",
    [
      (assign, "$okmarchparisforge", 1),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
      (call_script, "script_troop_add_gold", "trp_player", 300),
  ]],
  
  
  #################dials et variables quetes patrouille
  #tevernier
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_4_tavernkeeper"),
      (check_quest_active, "qst_sl_patrouil1"),
      (neg|check_quest_succeeded, "qst_sl_patrouil1"),
      (neg|check_quest_failed, "qst_sl_patrouil1"),
      (neg|check_quest_finished, "qst_sl_patrouil1"),
    ],
    "Que voullez vous boire Messire? ou peut etre voullez vous...", "patroouilbrg_pnj1",
    [(play_sound, "snd_taverniers_h"),]],
  
  [anyone|plyr,"patroouilbrg_pnj1", [],"Je suis en patrouille,des brigands vous ont ils posé des problèmes ces derniers temps?", "patroouilbrg_pnj12",[]],
  
  
  [anyone,"patroouilbrg_pnj12", [],"Pas tout a fait,a part des tonneaux qui disparaissent,et quelques ivrognes qui se sont éstripés,je ne me sens pas en danger pour le moment,et ca ne risque pas d'ariver si la compagnie de mercenaires basés dans cette ville se met enfin a se montrer dans nos rues,c'est une bonne chose.", "close_window",
    [(assign, "$patroltalktavernnkeepok", 1),]],
  
  #grossiste
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_4_merchant"),
      (check_quest_active, "qst_sl_patrouil1"),
      (neg|check_quest_succeeded, "qst_sl_patrouil1"),
      (neg|check_quest_failed, "qst_sl_patrouil1"),
      (neg|check_quest_finished, "qst_sl_patrouil1"),
    ],
    "Que puis je faire pour vous Messire?", "patroouilbrg_pnjvend1",
    []],
  
  [anyone|plyr,"patroouilbrg_pnjvend1", [],"Je patrouille la ville a la recherche de brigands,en avez vous vue récament?", "patroouilbrg_pnjvend2",[]],
  
  
  [anyone,"patroouilbrg_pnjvend2", [],"A vrais dire ma boutique ne fait plus l'objet d'attaques directes depuis peut,mais plus aucunes marchandises ne me parvient,des ribauds et malandrins de la pire éspèce attaquent directement les entrepots de la ville,j'imagine que si ils voyais que les mercenaires tant redoutès basès dans notre ville commence a protéger les entrepots cela les disuaderais de continuer a les piller,c'est une bonne chose!", "close_window",
    [(assign, "$patroltalkmerchhaanok", 1),]],
  
  
  #maitre guild
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_4_mayor"),
      (check_quest_active, "qst_sl_patrouil1"),
      (neg|check_quest_succeeded, "qst_sl_patrouil1"),
      (neg|check_quest_failed, "qst_sl_patrouil1"),
      (neg|check_quest_finished, "qst_sl_patrouil1"),
    ],
    "Le Bonjour soldat,que puis je faire pour vous aider?", "patrbrg_pnjmstrguild1",
    [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr,"patrbrg_pnjmstrguild1", [],"Je renforce la millice de votre ville,je patrouille actuellement a la recherche de brigands,en avez vous vue?", "patrbrg_pnjmstrguild2",[]],
  
  
  [anyone,"patrbrg_pnjmstrguild2", [],"Nous ne manqueons pas de milliciens dans ce quartier,a vrais dire ce sont les entrpots qui nous posent problème,ils sont devenus le teritoire des pires malfaisans de france,plus personne n'ose s'y aventurer,j'etait présent a l'assemblée quand le roi a descidé de donner un nouveau contrat a ses mercenaires les plus dignes de confiance.avec la guerre et les maladies,le fléau que représentent ces bandits es vraiment plus que mal venue,il est grand temp de régler ce problème,et maintenant que je vous voie a l'oeuvre je me sent déja bien mieux,Dieu en soit loué!", "close_window",
    [(assign, "$patroltalkguildmaistrok", 1),]],
  
  #contremaitre apres victoire
  [anyone,"start", [(eq, "$g_talk_troop", "trp_entrepot_contremaitre"),
      (eq, "$patmissionllyyssloose", 1),
      (eq, "$patmissionllyysunefois", 1),
    ],
    "Vous les avez eu! incroyable! je dirais a tout le monde combien votre compagnie de mercenaires es éfficae,merci soldat,merci beaucoup.", "contrempatbourgsaif22",
    [
      
  ]],
  
  [anyone|plyr,"contrempatbourgsaif22", [],"C'est mon travail Messire,faites bien attention a vous.", "close_window",[]],
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_entrepot_contremaitre"),
      (eq, "$patmissionllyyssloose", 1),
    ],
    "Vous les avez eu! incroyable! je dirais a tout le monde combien votre compagnie de mercenaires es éfficae,merci soldat,merci beaucoup.", "contrempatbourgsaif",
    [
      (call_script, "script_change_player_relation_with_center", "$current_town", 2),
  ]],
  
  [anyone|plyr,"contrempatbourgsaif", [],"C'est mon travail Messire,faites bien attention a vous.", "close_window",[(assign, "$patmissionllyysunefois", 1),]],
  
  
  #zaza
  ##################### DIAL destinataires guild messagers #################################
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_7_mayor"),
      (check_quest_active, "qst_messager_qst0"),
      (neg|check_quest_succeeded, "qst_messager_qst0"),
      (neg|check_quest_failed, "qst_messager_qst0"),
    ],
    "Que puis je pour vous ?", "destinat_monpel", [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"destinat_monpel", [], "J'ai une lettre pour vous Maistre.", "destinat_monpel2",[]],
  
  [anyone ,"destinat_monpel2", [],"Ho! montrez moi cela.", "destinat_monpel2winf",[]],
  
  [anyone|plyr ,"destinat_monpel2winf",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre0"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je doit vous laisser.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre0"),
      (call_script, "script_succeed_quest", "qst_messager_qst0"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"destinat_monpel2winf", [], "Et bien, je l'es perdue.", "destinat_monpel2fail",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst0"),
      (call_script, "script_end_quest", "qst_messager_qst0"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"destinat_monpel2fail", [],"Hum, tout cela n'es pas tres serieux, c'etait une lettre importante vous savez ?", "close_window",[]],
  #
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_8_mayor"),
      (check_quest_active, "qst_messager_qst1"),
      (neg|check_quest_succeeded, "qst_messager_qst1"),
      (neg|check_quest_failed, "qst_messager_qst1"),
    ],
    "Oui ? qu'y a t'il ?", "destinat_marasaill", []],
  
  [anyone|plyr ,"destinat_marasaill", [], "J'ai une lettre pour le  Maistre de la guilde des marchands de Marseille.", "destinat_marasaill2",[]],
  
  [anyone ,"destinat_marasaill2", [],"Enfin! montrez moi cela.", "destinat_marasaill2winf",[]],
  
  [anyone|plyr ,"destinat_marasaill2winf",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre1"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je doit vous laisser.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre1"),
      (call_script, "script_succeed_quest", "qst_messager_qst1"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"destinat_marasaill2winf", [], "Et bien, je l'es perdue.", "destinat_marasaill2fall",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst1"),
      (call_script, "script_end_quest", "qst_messager_qst1"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"destinat_marasaill2fall", [],"Hum, tout cela n'es pas tres serieux.", "close_window",[]],
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_1_mayor"),
      (check_quest_active, "qst_messager_qst2"),
      (neg|check_quest_succeeded, "qst_messager_qst2"),
      (neg|check_quest_failed, "qst_messager_qst2"),
    ],
    "Oui ? qu'y a t'il ?", "destinat_parisguild", [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"destinat_parisguild", [], "J'ai une lettre pour le  Maistre de la guilde des marchands de Paris.", "destinat_parisguild2",[]],
  
  [anyone ,"destinat_parisguild2", [],"Il etait temps, montrez moi cela.", "destinat_parisguild3",[]],
  
  [anyone|plyr ,"destinat_parisguild3",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre2"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je doit vous laisser.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre2"),
      (call_script, "script_succeed_quest", "qst_messager_qst2"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"destinat_parisguild3", [], "Et bien, je l'es perdue.", "destinat_parisguild3fail",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst2"),
      (call_script, "script_end_quest", "qst_messager_qst2"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"destinat_parisguild3fail", [],"Hum, tout cela n'es pas tres serieux.", "close_window",[]],
  #
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_6_mayor"),
      (check_quest_active, "qst_messager_qst3"),
      (neg|check_quest_succeeded, "qst_messager_qst3"),
      (neg|check_quest_failed, "qst_messager_qst3"),
    ],
    "Oui ? qu'y a t'il ?", "destinat_dijiguild", [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"destinat_dijiguild", [], "J'ai une lettre pour le  Maistre de la guilde des marchands de Dijon.", "destinat_dijiguild2",[]],
  
  [anyone ,"destinat_dijiguild2", [],"Il etait temps, montrez moi cela.", "destinat_dijiguild23",[]],
  
  [anyone|plyr ,"destinat_dijiguild23",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre3"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je doit vous laisser.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre3"),
      (call_script, "script_succeed_quest", "qst_messager_qst3"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"destinat_dijiguild23", [], "Et bien, je l'es perdue.", "destinat_dijiguild23fai",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst3"),
      (call_script, "script_end_quest", "qst_messager_qst3"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"destinat_dijiguild23fai", [],"Hum, tout cela n'es pas tres serieux.", "close_window",[]],
  #
  
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_9_mayor"),
      (check_quest_active, "qst_messager_qst4"),
      (neg|check_quest_succeeded, "qst_messager_qst4"),
      (neg|check_quest_failed, "qst_messager_qst4"),
    ],
    "Oui Messire ?", "destinat_caanguildd", [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"destinat_caanguildd", [], "J'ai une lettre pour le  Maistre de la guilde des marchands de Caen.", "destinat_caanguildd2",[]],
  
  [anyone ,"destinat_caanguildd2", [],"C'es parfait, montrez moi cela.", "destinat_caanguildd3",[]],
  
  [anyone|plyr ,"destinat_caanguildd3",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre4"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je vais me repposer a la taverne.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre4"),
      (call_script, "script_succeed_quest", "qst_messager_qst4"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"destinat_caanguildd3", [], "Et bien, je l'es perdue.", "destinat_caanguildd3fail",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst4"),
      (call_script, "script_end_quest", "qst_messager_qst4"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"destinat_caanguildd3fail", [],"Hum, et bien, ca n'es pas si grave.", "close_window",[]],
  
  #paris
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_1_armorer"),
      (check_quest_active, "qst_messager_qst6"),
      (neg|check_quest_succeeded, "qst_messager_qst6"),
      (neg|check_quest_failed, "qst_messager_qst6"),
    ],
    "Voullez vous voir mes armures ?", "destinat_parriri", [(play_sound, "snd_taverniers_h"),]],
  
  [anyone|plyr ,"destinat_parriri", [], "Je viens vous livrer une cargaison.", "destinat_parriri2",[]],
  
  [anyone ,"destinat_parriri2", [],"Ha oui ? ou es elle ?", "destinat_parriri2ou",[]],
  
  [anyone|plyr ,"destinat_parriri2ou",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre6"),
    ], "La voici.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre6"),
      (call_script, "script_succeed_quest", "qst_messager_qst6"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"destinat_parriri2ou", [], "Et bien, je l'es perdue.", "destinat_parriri2oufa",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst6"),
      (call_script, "script_end_quest", "qst_messager_qst6"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"destinat_parriri2oufa", [],"Comment ?! ca ne va pas se passer comme ca, disparessez.", "close_window",[]],
  #
  
  
  
  #avignon
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_18_armorer"),
      (check_quest_active, "qst_messager_qst7"),
      (neg|check_quest_succeeded, "qst_messager_qst7"),
      (neg|check_quest_failed, "qst_messager_qst7"),
    ],
    "Voullez vous une armure ?", "destinat_avignni", [(play_sound, "snd_taverniers_f"),]],
  
  [anyone|plyr ,"destinat_avignni", [], "Je viens vous livrer une cargaison.", "destinat_avignni2",[]],
  
  [anyone ,"destinat_avignni2", [],"Tres bien, ou es elle ?", "destinat_avignni2ou",[]],
  
  [anyone|plyr ,"destinat_avignni2ou",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre7"),
    ], "La voici.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre7"),
      (call_script, "script_succeed_quest", "qst_messager_qst7"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"destinat_avignni2ou", [], "Et bien, je l'es perdue.", "destinat_avignni2ounon",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst7"),
      (call_script, "script_end_quest", "qst_messager_qst7"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"destinat_avignni2ounon", [],"Comment ?! ca ne va pas se passer comme ca, disparessez.", "close_window",[]],
  #
  
  
  #reims
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_2_weaponsmith"),
      (check_quest_active, "qst_messager_qst9"),
      (neg|check_quest_succeeded, "qst_messager_qst9"),
      (neg|check_quest_failed, "qst_messager_qst9"),
    ],
    "Voullez vous une nouvelle arme Messire ?", "destinat_reimso", [(play_sound, "snd_taverniers_h"),]],
  
  [anyone|plyr ,"destinat_reimso", [], "Je viens vous livrer une cargaison.", "destinat_reimso2",[]],
  
  [anyone ,"destinat_reimso2", [],"Tres bien, ou es elle ?", "destinat_reimso2ou",[]],
  
  [anyone|plyr ,"destinat_reimso2ou",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre9"),
    ], "La voici.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre9"),
      (call_script, "script_succeed_quest", "qst_messager_qst9"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"destinat_reimso2ou", [], "Et bien, je l'es perdue.", "destinat_reimso2ounon",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst9"),
      (call_script, "script_end_quest", "qst_messager_qst9"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"destinat_reimso2ounon", [],"Comment ?! ca ne va pas se passer comme ca, vous allez entendre parler de moi.", "close_window",[]],
  #
  
  
  
  #################################
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_7_mayor"),
      (check_quest_active, "qst_messager_qst0b"),
      (neg|check_quest_succeeded, "qst_messager_qst0b"),
      (neg|check_quest_failed, "qst_messager_qst0b"),
    ],
    "Que puis je pour vous ?", "bdestinat_monpel", [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"bdestinat_monpel", [], "J'ai une lettre pour vous Maistre.", "bdestinat_monpel2",[]],
  
  [anyone ,"bdestinat_monpel2", [],"Ho! montrez moi cela.", "bdestinat_monpel2winf",[]],
  
  [anyone|plyr ,"bdestinat_monpel2winf",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre0"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je doit vous laisser.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre0"),
      (call_script, "script_succeed_quest", "qst_messager_qst0b"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"bdestinat_monpel2winf", [], "Et bien, je l'es perdue.", "bdestinat_monpel2fail",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst0b"),
      (call_script, "script_end_quest", "qst_messager_qst0b"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"bdestinat_monpel2fail", [],"Hum, tout cela n'es pas tres serieux, c'etait une lettre importante vous savez ?", "close_window",[]],
  #
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_8_mayor"),
      (check_quest_active, "qst_messager_qst1b"),
      (neg|check_quest_succeeded, "qst_messager_qst1b"),
      (neg|check_quest_failed, "qst_messager_qst1b"),
    ],
    "Oui ? qu'y a t'il ?", "bdestinat_marasaill", [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"bdestinat_marasaill", [], "J'ai une lettre pour le  Maistre de la guilde des marchands de Marseille.", "bdestinat_marasaill2",[]],
  
  [anyone ,"bdestinat_marasaill2", [],"Enfin! montrez moi cela.", "bdestinat_marasaill2winf",[]],
  
  [anyone|plyr ,"bdestinat_marasaill2winf",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre1"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je doit vous laisser.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre1"),
      (call_script, "script_succeed_quest", "qst_messager_qst1b"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"bdestinat_marasaill2winf", [], "Et bien, je l'es perdue.", "bdestinat_marasaill2fall",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst1b"),
      (call_script, "script_end_quest", "qst_messager_qst1b"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"bdestinat_marasaill2fall", [],"Hum, tout cela n'es pas tres serieux.", "close_window",[]],
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_1_mayor"),
      (check_quest_active, "qst_messager_qst2b"),
      (neg|check_quest_succeeded, "qst_messager_qst2b"),
      (neg|check_quest_failed, "qst_messager_qst2b"),
    ],
    "Oui ? qu'y a t'il ?", "bdestinat_parisguild", [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"bdestinat_parisguild", [], "J'ai une lettre pour le  Maistre de la guilde des marchands de Paris.", "bdestinat_parisguild2",[]],
  
  [anyone ,"bdestinat_parisguild2", [],"Il etait temps, montrez moi cela.", "bdestinat_parisguild3",[]],
  
  [anyone|plyr ,"bdestinat_parisguild3",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre2"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je doit vous laisser.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre2"),
      (call_script, "script_succeed_quest", "qst_messager_qst2b"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"bdestinat_parisguild3", [], "Et bien, je l'es perdue.", "bdestinat_parisguild3fail",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst2b"),
      (call_script, "script_end_quest", "qst_messager_qst2b"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"bdestinat_parisguild3fail", [],"Hum, tout cela n'es pas tres serieux.", "close_window",[]],
  #
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_6_mayor"),
      (check_quest_active, "qst_messager_qst3b"),
      (neg|check_quest_succeeded, "qst_messager_qst3b"),
      (neg|check_quest_failed, "qst_messager_qst3b"),
    ],
    "Oui ? qu'y a t'il ?", "bdestinat_dijiguild", [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"bdestinat_dijiguild", [], "J'ai une lettre pour le  Maistre de la guilde des marchands de Dijon.", "bdestinat_dijiguild2",[]],
  
  [anyone ,"bdestinat_dijiguild2", [],"Il etait temps, montrez moi cela.", "bdestinat_dijiguild23",[]],
  
  [anyone|plyr ,"bdestinat_dijiguild23",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre3"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je doit vous laisser.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre3"),
      (call_script, "script_succeed_quest", "qst_messager_qst3b"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"bdestinat_dijiguild23", [], "Et bien, je l'es perdue.", "bdestinat_dijiguild23fai",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst3b"),
      (call_script, "script_end_quest", "qst_messager_qst3b"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"bdestinat_dijiguild23fai", [],"Hum, tout cela n'es pas tres serieux.", "close_window",[]],
  #
  
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_9_mayor"),
      (check_quest_active, "qst_messager_qst4b"),
      (neg|check_quest_succeeded, "qst_messager_qst4b"),
      (neg|check_quest_failed, "qst_messager_qst4b"),
    ],
    "Oui Messire ?", "bdestinat_caanguildd", [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"bdestinat_caanguildd", [], "J'ai une lettre pour le  Maistre de la guilde des marchands de Caen.", "bdestinat_caanguildd2",[]],
  
  [anyone ,"bdestinat_caanguildd2", [],"C'es parfait, montrez moi cela.", "bdestinat_caanguildd3",[]],
  
  [anyone|plyr ,"bdestinat_caanguildd3",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre4"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je vais me repposer a la taverne.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre4"),
      (call_script, "script_succeed_quest", "qst_messager_qst4b"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"bdestinat_caanguildd3", [], "Et bien, je l'es perdue.", "bdestinat_caanguildd3fail",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst4b"),
      (call_script, "script_end_quest", "qst_messager_qst4b"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"bdestinat_caanguildd3fail", [],"Hum, et bien, ca n'es pas si grave.", "close_window",[]],
  #paris
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_1_armorer"),
      (check_quest_active, "qst_messager_qst6b"),
      (neg|check_quest_succeeded, "qst_messager_qst6b"),
      (neg|check_quest_failed, "qst_messager_qst6b"),
    ],
    "Voullez vous voir mes armures ?", "bdestinat_parriri", [(play_sound, "snd_taverniers_h"),]],
  
  [anyone|plyr ,"bdestinat_parriri", [], "Je viens vous livrer une cargaison.", "bdestinat_parriri2",[]],
  
  [anyone ,"bdestinat_parriri2", [],"Ha oui ? ou es elle ?", "bdestinat_parriri2ou",[]],
  
  [anyone|plyr ,"bdestinat_parriri2ou",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre6"),
    ], "La voici.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre6"),
      (call_script, "script_succeed_quest", "qst_messager_qst6b"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"bdestinat_parriri2ou", [], "Et bien, je l'es perdue.", "bdestinat_parriri2oufa",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst6b"),
      (call_script, "script_end_quest", "qst_messager_qst6b"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"bdestinat_parriri2oufa", [],"Comment ?! ca ne va pas se passer comme ca, disparessez.", "close_window",[]],
  #
  
  
  
  #avignon
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_18_armorer"),
      (check_quest_active, "qst_messager_qst7b"),
      (neg|check_quest_succeeded, "qst_messager_qst7b"),
      (neg|check_quest_failed, "qst_messager_qst7b"),
    ],
    "Voullez vous une armure ?", "bdestinat_avignni", [(play_sound, "snd_taverniers_f"),]],
  
  [anyone|plyr ,"bdestinat_avignni", [], "Je viens vous livrer une cargaison.", "bdestinat_avignni2",[]],
  
  [anyone ,"bdestinat_avignni2", [],"Tres bien, ou es elle ?", "bdestinat_avignni2ou",[]],
  
  [anyone|plyr ,"bdestinat_avignni2ou",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre7"),
    ], "La voici.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre7"),
      (call_script, "script_succeed_quest", "qst_messager_qst7b"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"bdestinat_avignni2ou", [], "Et bien, je l'es perdue.", "bdestinat_avignni2ounon",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst7b"),
      (call_script, "script_end_quest", "qst_messager_qst7b"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"bdestinat_avignni2ounon", [],"Comment ?! ca ne va pas se passer comme ca, disparessez.", "close_window",[]],
  #
  
  
  #reims
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_2_weaponsmith"),
      (check_quest_active, "qst_messager_qst9b"),
      (neg|check_quest_succeeded, "qst_messager_qst9b"),
      (neg|check_quest_failed, "qst_messager_qst9b"),
    ],
    "Voullez vous une nouvelle arme Messire ?", "bdestinat_reimso", [(play_sound, "snd_taverniers_h"),]],
  
  [anyone|plyr ,"bdestinat_reimso", [], "Je viens vous livrer une cargaison.", "bdestinat_reimso2",[]],
  
  [anyone ,"bdestinat_reimso2", [],"Tres bien, ou es elle ?", "bdestinat_reimso2ou",[]],
  
  [anyone|plyr ,"bdestinat_reimso2ou",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre9"),
    ], "La voici.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre9"),
      (call_script, "script_succeed_quest", "qst_messager_qst9b"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"bdestinat_reimso2ou", [], "Et bien, je l'es perdue.", "bdestinat_reimso2ounon",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst9b"),
      (call_script, "script_end_quest", "qst_messager_qst9b"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"bdestinat_reimso2ounon", [],"Comment ?! ca ne va pas se passer comme ca, vous allez entendre parler de moi.", "close_window",[]],
  #
  
  
  #################################
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_7_mayor"),
      (check_quest_active, "qst_messager_qst0d"),
      (neg|check_quest_succeeded, "qst_messager_qst0d"),
      (neg|check_quest_failed, "qst_messager_qst0d"),
    ],
    "Que puis je pour vous ?", "ddestinat_monpel", [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"ddestinat_monpel", [], "J'ai une lettre pour vous Maistre.", "ddestinat_monpel2",[]],
  
  [anyone ,"ddestinat_monpel2", [],"Ho! montrez moi cela.", "ddestinat_monpel2winf",[]],
  
  [anyone|plyr ,"ddestinat_monpel2winf",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre0"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je doit vous laisser.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre0"),
      (call_script, "script_succeed_quest", "qst_messager_qst0d"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"ddestinat_monpel2winf", [], "Et bien, je l'es perdue.", "ddestinat_monpel2fail",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst0d"),
      (call_script, "script_end_quest", "qst_messager_qst0d"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"ddestinat_monpel2fail", [],"Hum, tout cela n'es pas tres serieux, c'etait une lettre importante vous savez ?", "close_window",[]],
  #
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_8_mayor"),
      (check_quest_active, "qst_messager_qst1d"),
      (neg|check_quest_succeeded, "qst_messager_qst1d"),
      (neg|check_quest_failed, "qst_messager_qst1d"),
    ],
    "Oui ? qu'y a t'il ?", "ddestinat_marasaill", [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"ddestinat_marasaill", [], "J'ai une lettre pour le  Maistre de la guilde des marchands de Marseille.", "ddestinat_marasaill2",[]],
  
  [anyone ,"ddestinat_marasaill2", [],"Enfin! montrez moi cela.", "ddestinat_marasaill2winf",[]],
  
  [anyone|plyr ,"ddestinat_marasaill2winf",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre1"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je doit vous laisser.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre1"),
      (call_script, "script_succeed_quest", "qst_messager_qst1d"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"ddestinat_marasaill2winf", [], "Et bien, je l'es perdue.", "ddestinat_marasaill2fall",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst1d"),
      (call_script, "script_end_quest", "qst_messager_qst1d"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"ddestinat_marasaill2fall", [],"Hum, tout cela n'es pas tres serieux.", "close_window",[]],
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_1_mayor"),
      (check_quest_active, "qst_messager_qst2d"),
      (neg|check_quest_succeeded, "qst_messager_qst2d"),
      (neg|check_quest_failed, "qst_messager_qst2d"),
    ],
    "Oui ? qu'y a t'il ?", "ddestinat_parisguild", [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"ddestinat_parisguild", [], "J'ai une lettre pour le  Maistre de la guilde des marchands de Paris.", "ddestinat_parisguild2",[]],
  
  [anyone ,"ddestinat_parisguild2", [],"Il etait temps, montrez moi cela.", "ddestinat_parisguild3",[]],
  
  [anyone|plyr ,"ddestinat_parisguild3",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre2"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je doit vous laisser.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre2"),
      (call_script, "script_succeed_quest", "qst_messager_qst2d"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"ddestinat_parisguild3", [], "Et bien, je l'es perdue.", "ddestinat_parisguild3fail",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst2d"),
      (call_script, "script_end_quest", "qst_messager_qst2d"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"ddestinat_parisguild3fail", [],"Hum, tout cela n'es pas tres serieux.", "close_window",[]],
  #
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_6_mayor"),
      (check_quest_active, "qst_messager_qst3d"),
      (neg|check_quest_succeeded, "qst_messager_qst3d"),
      (neg|check_quest_failed, "qst_messager_qst3d"),
    ],
    "Oui ? qu'y a t'il ?", "ddestinat_dijiguild", [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"ddestinat_dijiguild", [], "J'ai une lettre pour le  Maistre de la guilde des marchands de Dijon.", "ddestinat_dijiguild2",[]],
  
  [anyone ,"ddestinat_dijiguild2", [],"Il etait temps, montrez moi cela.", "ddestinat_dijiguild23",[]],
  
  [anyone|plyr ,"ddestinat_dijiguild23",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre3"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je doit vous laisser.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre3"),
      (call_script, "script_succeed_quest", "qst_messager_qst3d"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"ddestinat_dijiguild23", [], "Et bien, je l'es perdue.", "ddestinat_dijiguild23fai",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst3d"),
      (call_script, "script_end_quest", "qst_messager_qst3d"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"ddestinat_dijiguild23fai", [],"Hum, tout cela n'es pas tres serieux.", "close_window",[]],
  #
  
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_9_mayor"),
      (check_quest_active, "qst_messager_qst4d"),
      (neg|check_quest_succeeded, "qst_messager_qst4d"),
      (neg|check_quest_failed, "qst_messager_qst4d"),
    ],
    "Oui Messire ?", "ddestinat_caanguildd", [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"ddestinat_caanguildd", [], "J'ai une lettre pour le  Maistre de la guilde des marchands de Caen.", "ddestinat_caanguildd2",[]],
  
  [anyone ,"ddestinat_caanguildd2", [],"C'es parfait, montrez moi cela.", "ddestinat_caanguildd3",[]],
  
  [anyone|plyr ,"ddestinat_caanguildd3",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre4"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je vais me repposer a la taverne.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre4"),
      (call_script, "script_succeed_quest", "qst_messager_qst4d"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"ddestinat_caanguildd3", [], "Et bien, je l'es perdue.", "ddestinat_caanguildd3fail",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst4d"),
      (call_script, "script_end_quest", "qst_messager_qst4d"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"ddestinat_caanguildd3fail", [],"Hum, et bien, ca n'es pas si grave.", "close_window",[]],
  #bordeau
  #
  
  #paris
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_1_armorer"),
      (check_quest_active, "qst_messager_qst6d"),
      (neg|check_quest_succeeded, "qst_messager_qst6d"),
      (neg|check_quest_failed, "qst_messager_qst6d"),
    ],
    "Voullez vous voir mes armures ?", "ddestinat_parriri", [(play_sound, "snd_taverniers_h"),]],
  
  [anyone|plyr ,"ddestinat_parriri", [], "Je viens vous livrer une cargaison.", "ddestinat_parriri2",[]],
  
  [anyone ,"ddestinat_parriri2", [],"Ha oui ? ou es elle ?", "ddestinat_parriri2ou",[]],
  
  [anyone|plyr ,"ddestinat_parriri2ou",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre6"),
    ], "La voici.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre6"),
      (call_script, "script_succeed_quest", "qst_messager_qst6d"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"ddestinat_parriri2ou", [], "Et bien, je l'es perdue.", "ddestinat_parriri2oufa",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst6d"),
      (call_script, "script_end_quest", "qst_messager_qst6d"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"ddestinat_parriri2oufa", [],"Comment ?! ca ne va pas se passer comme ca, disparessez.", "close_window",[]],
  #
  
  
  
  #avignon
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_18_armorer"),
      (check_quest_active, "qst_messager_qst7d"),
      (neg|check_quest_succeeded, "qst_messager_qst7d"),
      (neg|check_quest_failed, "qst_messager_qst7d"),
    ],
    "Voullez vous une armure ?", "ddestinat_avignni", [(play_sound, "snd_taverniers_f"),]],
  
  [anyone|plyr ,"ddestinat_avignni", [], "Je viens vous livrer une cargaison.", "ddestinat_avignni2",[]],
  
  [anyone ,"ddestinat_avignni2", [],"Tres bien, ou es elle ?", "ddestinat_avignni2ou",[]],
  
  [anyone|plyr ,"ddestinat_avignni2ou",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre7"),
    ], "La voici.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre7"),
      (call_script, "script_succeed_quest", "qst_messager_qst7d"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"ddestinat_avignni2ou", [], "Et bien, je l'es perdue.", "ddestinat_avignni2ounon",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst7d"),
      (call_script, "script_end_quest", "qst_messager_qst7d"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"ddestinat_avignni2ounon", [],"Comment ?! ca ne va pas se passer comme ca, disparessez.", "close_window",[]],
  #
  
  
  #reims
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_2_weaponsmith"),
      (check_quest_active, "qst_messager_qst9d"),
      (neg|check_quest_succeeded, "qst_messager_qst9d"),
      (neg|check_quest_failed, "qst_messager_qst9d"),
    ],
    "Voullez vous une nouvelle arme Messire ?", "ddestinat_reimso", [(play_sound, "snd_taverniers_h"),]],
  
  [anyone|plyr ,"ddestinat_reimso", [], "Je viens vous livrer une cargaison.", "ddestinat_reimso2",[]],
  
  [anyone ,"ddestinat_reimso2", [],"Tres bien, ou es elle ?", "ddestinat_reimso2ou",[]],
  
  [anyone|plyr ,"ddestinat_reimso2ou",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre9"),
    ], "La voici.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre9"),
      (call_script, "script_succeed_quest", "qst_messager_qst9d"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"ddestinat_reimso2ou", [], "Et bien, je l'es perdue.", "ddestinat_reimso2ounon",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst9d"),
      (call_script, "script_end_quest", "qst_messager_qst9d"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"ddestinat_reimso2ounon", [],"Comment ?! ca ne va pas se passer comme ca, vous allez entendre parler de moi.", "close_window",[]],
  #
  
  
  #################################
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_7_mayor"),
      (check_quest_active, "qst_messager_qst0m"),
      (neg|check_quest_succeeded, "qst_messager_qst0m"),
      (neg|check_quest_failed, "qst_messager_qst0m"),
    ],
    "Que puis je pour vous ?", "mdestinat_monpel", [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"mdestinat_monpel", [], "J'ai une lettre pour vous Maistre.", "mdestinat_monpel2",[]],
  
  [anyone ,"mdestinat_monpel2", [],"Ho! montrez moi cela.", "mdestinat_monpel2winf",[]],
  
  [anyone|plyr ,"mdestinat_monpel2winf",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre0"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je doit vous laisser.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre0"),
      (call_script, "script_succeed_quest", "qst_messager_qst0m"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"mdestinat_monpel2winf", [], "Et bien, je l'es perdue.", "mdestinat_monpel2fail",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst0m"),
      (call_script, "script_end_quest", "qst_messager_qst0m"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"mdestinat_monpel2fail", [],"Hum, tout cela n'es pas tres serieux, c'etait une lettre importante vous savez ?", "close_window",[]],
  #
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_8_mayor"),
      (check_quest_active, "qst_messager_qst1m"),
      (neg|check_quest_succeeded, "qst_messager_qst1m"),
      (neg|check_quest_failed, "qst_messager_qst1m"),
    ],
    "Oui ? qu'y a t'il ?", "mdestinat_marasaill", [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"mdestinat_marasaill", [], "J'ai une lettre pour le  Maistre de la guilde des marchands de Marseille.", "mdestinat_marasaill2",[]],
  
  [anyone ,"mdestinat_marasaill2", [],"Enfin! montrez moi cela.", "mdestinat_marasaill2winf",[]],
  
  [anyone|plyr ,"mdestinat_marasaill2winf",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre1"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je doit vous laisser.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre1"),
      (call_script, "script_succeed_quest", "qst_messager_qst1m"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"mdestinat_marasaill2winf", [], "Et bien, je l'es perdue.", "mdestinat_marasaill2fall",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst1m"),
      (call_script, "script_end_quest", "qst_messager_qst1m"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"mdestinat_marasaill2fall", [],"Hum, tout cela n'es pas tres serieux.", "close_window",[]],
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_1_mayor"),
      (check_quest_active, "qst_messager_qst2m"),
      (neg|check_quest_succeeded, "qst_messager_qst2m"),
      (neg|check_quest_failed, "qst_messager_qst2m"),
    ],
    "Oui ? qu'y a t'il ?", "mdestinat_parisguild", [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"mdestinat_parisguild", [], "J'ai une lettre pour le  Maistre de la guilde des marchands de Paris.", "mdestinat_parisguild2",[]],
  
  [anyone ,"mdestinat_parisguild2", [],"Il etait temps, montrez moi cela.", "mdestinat_parisguild3",[]],
  
  [anyone|plyr ,"mdestinat_parisguild3",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre2"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je doit vous laisser.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre2"),
      (call_script, "script_succeed_quest", "qst_messager_qst2m"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"mdestinat_parisguild3", [], "Et bien, je l'es perdue.", "mdestinat_parisguild3fail",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst2m"),
      (call_script, "script_end_quest", "qst_messager_qst2m"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"mdestinat_parisguild3fail", [],"Hum, tout cela n'es pas tres serieux.", "close_window",[]],
  #
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_6_mayor"),
      (check_quest_active, "qst_messager_qst3m"),
      (neg|check_quest_succeeded, "qst_messager_qst3m"),
      (neg|check_quest_failed, "qst_messager_qst3m"),
    ],
    "Oui ? qu'y a t'il ?", "mdestinat_dijiguild", [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"mdestinat_dijiguild", [], "J'ai une lettre pour le  Maistre de la guilde des marchands de Dijon.", "mdestinat_dijiguild2",[]],
  
  [anyone ,"mdestinat_dijiguild2", [],"Il etait temps, montrez moi cela.", "mdestinat_dijiguild23",[]],
  
  [anyone|plyr ,"mdestinat_dijiguild23",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre3"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je doit vous laisser.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre3"),
      (call_script, "script_succeed_quest", "qst_messager_qst3m"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"mdestinat_dijiguild23", [], "Et bien, je l'es perdue.", "mdestinat_dijiguild23fai",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst3m"),
      (call_script, "script_end_quest", "qst_messager_qst3m"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"mdestinat_dijiguild23fai", [],"Hum, tout cela n'es pas tres serieux.", "close_window",[]],
  #
  
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_9_mayor"),
      (check_quest_active, "qst_messager_qst4m"),
      (neg|check_quest_succeeded, "qst_messager_qst4m"),
      (neg|check_quest_failed, "qst_messager_qst4m"),
    ],
    "Oui Messire ?", "mdestinat_caanguildd", [(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"mdestinat_caanguildd", [], "J'ai une lettre pour le  Maistre de la guilde des marchands de Caen.", "mdestinat_caanguildd2",[]],
  
  [anyone ,"mdestinat_caanguildd2", [],"C'es parfait, montrez moi cela.", "mdestinat_caanguildd3",[]],
  
  [anyone|plyr ,"mdestinat_caanguildd3",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre4"),
    ], "La voici, pardonnez moi, mais ce voyage m'a épuisé, je vais me repposer a la taverne.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre4"),
      (call_script, "script_succeed_quest", "qst_messager_qst4m"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"mdestinat_caanguildd3", [], "Et bien, je l'es perdue.", "mdestinat_caanguildd3fail",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst4m"),
      (call_script, "script_end_quest", "qst_messager_qst4m"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"mdestinat_caanguildd3fail", [],"Hum, et bien, ca n'es pas si grave.", "close_window",[]],
  #bordeau
  #
  
  #paris
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_1_armorer"),
      (check_quest_active, "qst_messager_qst6m"),
      (neg|check_quest_succeeded, "qst_messager_qst6m"),
      (neg|check_quest_failed, "qst_messager_qst6m"),
    ],
    "Voullez vous voir mes armures ?", "mdestinat_parriri", [(play_sound, "snd_taverniers_h"),]],
  
  [anyone|plyr ,"mdestinat_parriri", [], "Je viens vous livrer une cargaison.", "mdestinat_parriri2",[]],
  
  [anyone ,"mdestinat_parriri2", [],"Ha oui ? ou es elle ?", "mdestinat_parriri2ou",[]],
  
  [anyone|plyr ,"mdestinat_parriri2ou",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre6"),
    ], "La voici.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre6"),
      (call_script, "script_succeed_quest", "qst_messager_qst6m"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"mdestinat_parriri2ou", [], "Et bien, je l'es perdue.", "mdestinat_parriri2oufa",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst6m"),
      (call_script, "script_end_quest", "qst_messager_qst6m"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"mdestinat_parriri2oufa", [],"Comment ?! ca ne va pas se passer comme ca, disparessez.", "close_window",[]],
  #
  
  
  
  #avignon
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_18_armorer"),
      (check_quest_active, "qst_messager_qst7m"),
      (neg|check_quest_succeeded, "qst_messager_qst7m"),
      (neg|check_quest_failed, "qst_messager_qst7m"),
    ],
    "Voullez vous une armure ?", "mdestinat_avignni", [(play_sound, "snd_taverniers_f"),]],
  
  [anyone|plyr ,"mdestinat_avignni", [], "Je viens vous livrer une cargaison.", "mdestinat_avignni2",[]],
  
  [anyone ,"mdestinat_avignni2", [],"Tres bien, ou es elle ?", "mdestinat_avignni2ou",[]],
  
  [anyone|plyr ,"mdestinat_avignni2ou",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre7"),
    ], "La voici.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre7"),
      (call_script, "script_succeed_quest", "qst_messager_qst7m"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"mdestinat_avignni2ou", [], "Et bien, je l'es perdue.", "mdestinat_avignni2ounon",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst7m"),
      (call_script, "script_end_quest", "qst_messager_qst7m"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"mdestinat_avignni2ounon", [],"Comment ?! ca ne va pas se passer comme ca, disparessez.", "close_window",[]],
  #
  
  
  #reims
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_town_2_weaponsmith"),
      (check_quest_active, "qst_messager_qst9m"),
      (neg|check_quest_succeeded, "qst_messager_qst9m"),
      (neg|check_quest_failed, "qst_messager_qst9m"),
    ],
    "Voullez vous une nouvelle arme Messire ?", "mdestinat_reimso", [(play_sound, "snd_taverniers_h"),]],
  
  [anyone|plyr ,"mdestinat_reimso", [], "Je viens vous livrer une cargaison.", "mdestinat_reimso2",[]],
  
  [anyone ,"mdestinat_reimso2", [],"Tres bien, ou es elle ?", "mdestinat_reimso2ou",[]],
  
  [anyone|plyr ,"mdestinat_reimso2ou",
    [
      #si j'ai la lettre
      (player_has_item, "itm_lettre9"),
    ], "La voici.", "close_window",
    [
      #  la donner et win
      (troop_remove_item, "trp_player","itm_lettre9"),
      (call_script, "script_succeed_quest", "qst_messager_qst9m"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
  ]],
  [anyone|plyr ,"mdestinat_reimso2ou", [], "Et bien, je l'es perdue.", "mdestinat_reimso2ounon",
    [
      #failed et peut etre relation moin ville ou maitre
      (call_script, "script_fail_quest", "qst_messager_qst9m"),
      (call_script, "script_end_quest", "qst_messager_qst9m"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
  ]],
  
  [anyone ,"mdestinat_reimso2ounon", [],"Comment ?! ca ne va pas se passer comme ca, vous allez entendre parler de moi.", "close_window",[]],
  #
  
  ##################### DIAL destinataires guild messagers  END ! ##########################
  #dials patrouille entrepot contremaitre
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_entrepot_contremaitre"),
    ],
    "Garde! par ici!!! oh,seigneur,débarassez moi de ces ribauds,ils en veullent a la marchandise,attention ils sont armés,attention!.", "patrbourg_contrematt", []],
  
  [anyone|plyr,"patrbourg_contrematt", [], "Ne craigniez rien je m'occupe d'eux,restez en arière..", "close_window",
    [
      (music_set_situation, 0),
      (assign, "$okbatbandentrepottd", 1),
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 1, 0, -1),
      (play_sound, "snd_man_warcry"),
  ]],
  
  #bandits entrepos2
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_entrepot_bandit_2"),
    ],
    "Dégage puceau,ou on te saigne comme un porc,n'entre pas dans nos affaires.", "patrbourg_bandittalk", []],
  
  [anyone|plyr,"patrbourg_bandittalk", [], "C'est mon travail d'entrer dans vos affaires.", "patrbourg_bandittalk2",[]],
  
  [anyone,"patrbourg_bandittalk2", [],"T'aura été prevenue.", "patrbourg_bandittalk3",[]],
  
  [anyone|plyr,"patrbourg_bandittalk3", [], "connaissez vous la devise de la compagnie? le sang des faibles coulera...", "patrbourg_bandittalk4",[]],
  
  [anyone,"patrbourg_bandittalk4", [],"Ca sera le tiens!", "close_window",
    [
      (music_set_situation, 0),
      (assign, "$okbatbandentrepottd", 1),
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 1, 0, -1),
      (play_sound, "snd_man_warcry"),
  ]],
  [anyone,"patrbourg_bandittalk", [],"Je préfère ne pas m'en meller,vous n'avez qu'a voler vos poules.", "close_window",[]],
  
  
  #bandits entrepos1
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_entrepot_bandit_1"),
    ],
    "Dégage,t'occupe pas de ca,on es deux et t'es seul.", "patrbourg_bandittalkq1", []],
  
  [anyone|plyr,"patrbourg_bandittalkq1", [], "Un contrat es un contrat.", "patrbourg_bandittalkq22",[]],
  
  [anyone,"patrbourg_bandittalkq22", [],"T'aura été prevenue.", "patrbourg_bandittalkq33",[]],
  
  [anyone|plyr,"patrbourg_bandittalkq33", [], "connaissez vous la devise de la compagnie? le sang des faibles coulera...", "patrbourg_bandittalkq44",[]],
  
  [anyone,"patrbourg_bandittalkq44", [],"Ca sera le tiens!", "close_window",
    [
      (music_set_situation, 0),
      (assign, "$okbatbandentrepottd", 1),
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 1, 0, -1),
      (play_sound, "snd_man_warcry"),
  ]],
  [anyone,"patrbourg_bandittalkq1", [],"Je préfère ne pas m'en meller,vous n'avez qu'a voler vos poules.", "close_window",[]],
  
  
  #  tour
  [anyone,"start", [(eq, "$g_talk_troop", "trp_ressource_merchant_tours"),
      (eq, "$nextdialressourcesventour", 1),
    ],
    "Du bois,des cordes solides,pierres a aiguiser...", "march_ressources_tour", [(play_sound, "snd_marchands_res_greetings"),]],
  
  [anyone|plyr,"march_ressources_tour", [], "J'aimerais apprendre a forger des armes.", "march_ressources_hotour",[]],
  [anyone|plyr,"march_ressources_tour", [], "Je voudais acheter des matières prmières.", "ressources_camptour",[]],
  [anyone|plyr,"march_ressources_tour", [], "Ou puis je trouver d'autres vendeurs de ressources?", "ressources_ouautttourar",[]],
  [anyone|plyr,"march_ressources_tour", [], "Je n'ai besoin de rien merci.", "close_window",[]],
  
  [anyone,"ressources_ouautttourar", [],"A ma connaissance il y a un marchant a Paris,Rouen,Caen,Nantes et Orléans.il y en a peut etre d'autres ailleurs en france mais je ne les connais pas..", "ressources_genetour",[]],
  
  [anyone,"ressources_camptour", [],"Naturellement,voila tout ce qu'il me reste.", "ressources_genetour",[[change_screen_trade]]],
  [anyone,"ressources_genetour", [],"Autre chose?.", "march_ressources_tour",[]],
  
  [anyone,"march_ressources_hotour", [],"Si c'est la fabrication d'armes qui vous intéresse,rien de plus simple pour commencer,il vous faut un plan que vous pouvez acheter auprés d'un forgeron,il y aura une liste des ressources et outils indispenssables a la confection,lisez le dans votre atelier et commencez la forge,attention toutefois certaines armes difficiles a réaliser demandent un niveau d'agilité élevé.", "march_ressources_hotour2",[]],
  [anyone|plyr,"march_ressources_hotour2", [], "Certes,je m'en doute,mais si je n'ai pas d'atelier et que je ne suis pas fixé dans une ville?", "march_ressources_hotour3",[]],
  [anyone,"march_ressources_hotour3", [],"Et bien les forgerons itinnérants existent vous savez,dans ce cas il vous faut travailler dans un atelier improvisé dans un camp aux abords de la ville,cela me parait évident pourtant.", "ressources_genetour",[]],
  
  #dialogues vendeurs ressources
  [anyone,"start", [(eq, "$g_talk_troop", "trp_ressource_merchant_tours"),
    ],
    "Du bois,des cordes solides,pierres a aiguiser...quel es votre metier messire? je ne vous es jamais vue dans la ville,si vous etes venu installer votre atelier,vous aurez besoin de m'acheter des ressources,que vous soyez forgeron,charpentier,ou meme cordonier.", "march_toures1", [(play_sound, "snd_marchands_res_greetings"),]],
  [anyone|plyr,"march_toures1", [], "Pourquois ne pas acheter chez les grossistes?", "march_tourn2",[]],
  [anyone|plyr,"march_toures1", [], "J'aimerais apprendre a forger des armes.", "march_ressoutour3",[]],
  [anyone|plyr,"march_toures1", [], "Je n'ai besoin de rien merci.", "close_window",[]],
  [anyone,"march_tourn2", [],"Naturellement vous pouvez comparer les prix et acheter les ressources les moins chères,mais nous nous efforcons de garder les prix les plus bas,malgrès la guerre,et de plus nous reunissons suffisament de ressources pour assurer les demandes en différentes matières des productions des artisants,par les temps qui courent,ne pas avoir a se deplacer de villes en villes pour reunir toutes ces matières premieres n'as pas de prix!.", "march_toures1",[]],
  
  [anyone,"march_ressoutour3", [],"Si c'est la fabrication d'armes qui vous intéresse,rien de plus simple pour commencer,il vous faut un plan que vous pouvez acheter auprés d'un forgeron,il y aura une liste des ressources et outils indispenssables a la confection,lisez le dans votre atelier et commencez la forge,attention toutefois certaines armes difficiles a réaliser demandent un niveau d'agilité élevé,pour le reste,c'est en forgant que l'on deviens....", "march_ressoutour4",[]],
  [anyone|plyr,"march_ressoutour4", [], "Certes,je m'en doute,mais si je n'ai pas d'atelier et que je ne suis pas fixé dans une ville?", "march_ressoutour5",[]],
  [anyone,"march_ressoutour5", [],"Et bien les forgerons itinnérants existent vous savez,dans ce cas il vous faut travailler dans un atelier improvisé dans un camp aux abords de la ville,cela me parait évident pourtant.", "march_ressoutour6",[]],
  [anyone|plyr,"march_ressoutour6", [], "Tres bien,j'aimerais voir quelles ingredients vous avez a vendre dans ce cas.", "march_ressoutour6ven",[(assign, "$nextdialressourcesventour", 1),]],
  [anyone|plyr,"march_ressoutour6", [], "Je m'en souviendrais merci.", "close_window",[(assign, "$nextdialressourcesventour", 1),]],
  
  [anyone,"march_ressoutour6ven", [],"Naturellement,voila tout ce qu'il me reste.", "march_ressoutour62",[[change_screen_trade]]],
  [anyone,"march_ressoutour62", [],"A une autre fois je l'éspère.", "close_window",[]],
  
  
  #  orleans
  [anyone,"start", [(eq, "$g_talk_troop", "trp_ressource_merchant_orleans"),
      (eq, "$nextdialressourcesvenorlean", 1),
    ],
    "Du bois,des cordes,des pierres,les meilleures sont a Orléans...", "march_ressources_orleans", [(play_sound, "snd_marchands_res_greetings"),]],
  
  [anyone|plyr,"march_ressources_orleans", [], "J'aimerais apprendre a forger des armes.", "march_ressources_howorleans",[]],
  [anyone|plyr,"march_ressources_orleans", [], "Je voudais acheter des matières prmières.", "ressources_camporleans",[]],
  [anyone|plyr,"march_ressources_orleans", [], "Ou puis je trouver d'autres vendeurs de ressources?", "ressources_ouauorelanssr",[]],
  
  [anyone|plyr,"march_ressources_orleans", [], "Voudriez vous jouer aux dés ?", "debut_desrour",[]],
  [anyone,"debut_desrour", [],"Avec plaisire !", "generique_des",[]],
  [anyone|plyr,"march_ressources_orleans", [], "Je n'ai besoin de rien merci.", "close_window",[]],
  
  [anyone,"ressources_ouauorelanssr", [],"A ce que je sache,il y a un marchant a Paris au quartier des écuries royales,a Rouen,Caen,Tours et Nantes.il y en a peut etre d'autres au sud,mais je ne les connais pas.", "ressources_geneorleans",[]],
  [anyone,"ressources_camporleans", [],"Naturellement,voila tout ce qu'il me reste.", "ressources_geneorleans",[[change_screen_trade]]],
  [anyone,"ressources_geneorleans", [],"Autre chose?.", "march_ressources_orleans",[]],
  
  [anyone,"march_ressources_howorleans", [],"Si c'est la fabrication d'armes qui vous intéresse,rien de plus simple pour commencer,il vous faut un plan que vous pouvez acheter auprés d'un forgeron,il y aura une liste des ressources et outils indispenssables a la confection,lisez le dans votre atelier et commencez la forge,attention toutefois certaines armes difficiles a réaliser demandent un niveau d'agilité élevé.", "march_ressources_howorleans2",[]],
  [anyone|plyr,"march_ressources_howorleans2", [], "Certes,je m'en doute,mais si je n'ai pas d'atelier et que je ne suis pas fixé dans une ville?", "march_ressources_howorleans3",[]],
  [anyone,"march_ressources_howorleans3", [],"Et bien les forgerons itinnérants existent vous savez,dans ce cas il vous faut travailler dans un atelier improvisé dans un camp aux abords de la ville,cela me parait évident pourtant.", "march_ressources_orleans",[]],
  
  #dialogues vendeurs ressources
  [anyone,"start", [(eq, "$g_talk_troop", "trp_ressource_merchant_orleans"),
    ],
    "Du bois,des cordes,des pierres a aiguiser...je ne vous es jamais vue dans la ville Messire,etes vous etes venu installer dans notre ville? vous aurez besoin de m'acheter des ressources,que vous soyez forgeron,charpentier,ou meme cordonier.", "march_ressourceorleansa1", [(play_sound, "snd_marchands_res_greetings"),]],
  [anyone|plyr,"march_ressourceorleansa1", [], "Pourquois ne pas acheter chez les grossistes?", "march_grosorlean2",[]],
  [anyone|plyr,"march_ressourceorleansa1", [], "J'aimerais apprendre a forger des armes.", "march_ressources_oraleansa3",[]],
  [anyone|plyr,"march_ressourceorleansa1", [], "Je n'ai besoin de rien merci.", "close_window",[]],
  [anyone,"march_grosorlean2", [],"Naturellement vous pouvez comparer les prix et acheter les ressources les moins chères,mais nous nous efforcons de garder les prix les plus bas,malgrès la guerre,et de plus nous reunissons suffisament de ressources pour assurer les demandes en différentes matières des productions des artisants,par les temps qui courent,ne pas avoir a se deplacer de villes en villes pour reunir toutes ces matières premieres n'as pas de prix!.", "march_ressourceorleansa1",[]],
  
  [anyone,"march_ressources_oraleansa3", [],"Si c'est la fabrication d'armes qui vous intéresse,rien de plus simple pour commencer,il vous faut un plan que vous pouvez acheter auprés d'un forgeron,il y aura une liste des ressources et outils indispenssables a la confection,lisez le dans votre atelier et commencez la forge,attention toutefois certaines armes difficiles a réaliser demandent un niveau d'agilité élevé,pour le reste,c'est en forgant que l'on deviens....", "march_ressources_oraleansa4",[]],
  [anyone|plyr,"march_ressources_oraleansa4", [], "Certes,je m'en doute,mais si je n'ai pas d'atelier et que je ne suis pas fixé dans une ville?", "march_ressources_oraleansa6",[]],
  [anyone,"march_ressources_oraleansa6", [],"Et bien les forgerons itinnérants existent vous savez,dans ce cas il vous faut travailler dans un atelier improvisé dans un camp aux abords de la ville,cela me parait évident pourtant.", "march_aa_oraleansa6",[]],
  [anyone|plyr,"march_aa_oraleansa6", [], "Tres bien,j'aimerais voir quelles ingredients vous avez a vendre dans ce cas.", "ressoures_marchoraleansa6okok1",[(assign, "$nextdialressourcesvenorlean", 1),]],
  [anyone|plyr,"march_aa_oraleansa6", [], "Je m'en souviendrais merci.", "close_window",[(assign, "$nextdialressourcesvenorlean", 1),]],
  
  [anyone,"ressoures_marchoraleansa6okok1", [],"Naturellement,voila tout ce qu'il me reste.", "ressoures_mar22",[[change_screen_trade]]],
  [anyone,"ressoures_mar22", [],"A une autre fois je l'éspère.", "close_window",[]],
  
  
  #  anger
  [anyone,"start", [(eq, "$g_talk_troop", "trp_ressource_merchant_anger"),
      (eq, "$nextdialressourcesvenanger", 1),
    ],
    "Du bois,des cordes solides,pierres a aiguiser...", "march_ressources_anger", [(play_sound, "snd_marchands_res_greetings"),]],
  
  [anyone|plyr,"march_ressources_anger", [], "J'aimerais apprendre a forger des armes.", "march_ressources_howanger",[]],
  [anyone|plyr,"march_ressources_anger", [], "Je voudais acheter des matières prmières.", "ressources_campanger",[]],
  [anyone|plyr,"march_ressources_anger", [], "Ou puis je trouver d'autres vendeurs de ressources?", "ressources_ouautangeger",[]],
  [anyone|plyr,"march_ressources_anger", [], "Jouons aux dés ?", "debut_desanger",[]],
  [anyone,"debut_desanger", [],"Avec plaisir !", "generique_des",[]],
  [anyone|plyr,"march_ressources_anger", [], "Je n'ai besoin de rien merci.", "close_window",[]],
  
  [anyone,"ressources_ouautangeger", [],"Il y a un autre marchant a Paris,Tours,Rouen,Caen et Orléans.il y en a peut etre d'autres ailleurs en france mais je ne les connais pas..", "ressources_generianger",[]],
  
  [anyone,"ressources_campanger", [],"Naturellement,voila tout ce qu'il me reste.", "ressources_generianger",[[change_screen_trade]]],
  [anyone,"ressources_generianger", [],"Autre chose?.", "march_ressources_anger",[]],
  
  [anyone,"march_ressources_howanger", [],"Si c'est la fabrication d'armes qui vous intéresse,rien de plus simple pour commencer,il vous faut un plan que vous pouvez acheter auprés d'un forgeron,il y aura une liste des ressources et outils indispenssables a la confection,lisez le dans votre atelier et commencez la forge,attention toutefois certaines armes difficiles a réaliser demandent un niveau d'agilité élevé.", "march_howanger2",[]],
  [anyone|plyr,"march_howanger2", [], "Certes,je m'en doute,mais si je n'ai pas d'atelier et que je ne suis pas fixé dans une ville?", "march_ressources_anger3",[]],
  [anyone,"march_ressources_anger3", [],"Et bien les forgerons itinnérants existent vous savez,dans ce cas il vous faut travailler dans un atelier improvisé dans un camp aux abords de la ville,cela me parait évident pourtant.", "ressources_generianger",[]],
  
  #dialogues vendeurs ressources
  [anyone,"start", [(eq, "$g_talk_troop", "trp_ressource_merchant_anger"),
    ],
    "Du bois,des cordes solides,pierres a aiguiser...quel es votre metier messire? je ne vous es jamais vue dans la ville,si vous etes venu installer votre atelier,vous aurez besoin de m'acheter des ressources,que vous soyez forgeron,charpentier,ou meme cordonier.", "march_ressourceangera", [(play_sound, "snd_marchands_res_greetings"),]],
  [anyone|plyr,"march_ressourceangera", [], "Pourquois ne pas acheter chez les grossistes?", "march_grosanger2",[]],
  [anyone|plyr,"march_ressourceangera", [], "J'aimerais apprendre a forger des armes.", "march_ressources_angera3",[]],
  [anyone|plyr,"march_ressourceangera", [], "Je n'ai besoin de rien merci.", "close_window",[]],
  [anyone,"march_grosanger2", [],"Naturellement vous pouvez comparer les prix et acheter les ressources les moins chères,mais nous nous efforcons de garder les prix les plus bas,malgrès la guerre,et de plus nous reunissons suffisament de ressources pour assurer les demandes en différentes matières des productions des artisants,par les temps qui courent,ne pas avoir a se deplacer de villes en villes pour reunir toutes ces matières premieres n'as pas de prix!.", "march_ressourceangera",[]],
  
  [anyone,"march_ressources_angera3", [],"Si c'est la fabrication d'armes qui vous intéresse,rien de plus simple pour commencer,il vous faut un plan que vous pouvez acheter auprés d'un forgeron,il y aura une liste des ressources et outils indispenssables a la confection,lisez le dans votre atelier et commencez la forge,attention toutefois certaines armes difficiles a réaliser demandent un niveau d'agilité élevé,pour le reste,c'est en forgant que l'on deviens....", "march_ressources_angera4",[]],
  [anyone|plyr,"march_ressources_angera4", [], "Certes,je m'en doute,mais si je n'ai pas d'atelier et que je ne suis pas fixé dans une ville?", "march_ressources_angera5",[]],
  [anyone,"march_ressources_angera5", [],"Et bien les forgerons itinnérants existent vous savez,dans ce cas il vous faut travailler dans un atelier improvisé dans un camp aux abords de la ville,cela me parait évident pourtant.", "march_ressources_angera6",[]],
  [anyone|plyr,"march_ressources_angera6", [], "Tres bien,j'aimerais voir quelles ingredients vous avez a vendre dans ce cas.", "ressoures_angerokok1",[(assign, "$nextdialressourcesvenanger", 1),]],
  [anyone|plyr,"march_ressources_angera6", [], "Je m'en souviendrais merci.", "close_window",[(assign, "$nextdialressourcesvenanger", 1),]],
  
  [anyone,"ressoures_angerokok1", [],"Naturellement,voila tout ce qu'il me reste.", "ressoures_angerokok2",[[change_screen_trade]]],
  [anyone,"ressoures_angerokok2", [],"A une autre fois je l'éspère.", "close_window",[]],
  
  
  #  caen
  [anyone,"start", [(eq, "$g_talk_troop", "trp_ressource_merchant_caen"),
      (eq, "$nextdialressourcesvencae", 1),
    ],
    "Du bois,des cordes solides,les pierres a aiguiser de Caen sont les meilleures!", "march_ressources_starcaen", [(play_sound, "snd_marchands_res_greetings"),]],
  
  [anyone|plyr,"march_ressources_starcaen", [], "J'aimerais apprendre a forger des armes.", "march_ressources_howcaen",[]],
  [anyone|plyr,"march_ressources_starcaen", [], "Je voudais acheter des matières prmières.", "ressources_campvcaen",[]],
  [anyone|plyr,"march_ressources_starcaen", [], "Ou puis je trouver d'autres vendeurs de ressources?", "ressources_ouautpartcaeenr",[]],
  [anyone|plyr,"march_ressources_starcaen", [], "Voudriez vous jouer aux dés ?", "debut_descaen",[]],
  [anyone,"debut_descaen", [],"Mon dieu non, c'est un peché !", "close_window",[]],
  [anyone|plyr,"march_ressources_starcaen", [], "Je n'ai besoin de rien merci.", "close_window",[]],
  
  [anyone,"ressources_ouautpartcaeenr", [],"Et bien,il y a un marchant a Rouen,Paris,Nantes,Tours et Orléans.il y en a peut etre d'autres dans le sud mais je ne les connais pas.", "ressources_campvendgenecaen",[]],
  
  [anyone,"ressources_campvcaen", [],"Naturellement,voila tout ce qu'il me reste.", "ressources_campvendgenecaen",[[change_screen_trade]]],
  [anyone,"ressources_campvendgenecaen", [],"Autre chose?.", "march_ressources_starcaen",[]],
  
  [anyone,"march_ressources_howcaen", [],"Si c'est la fabrication d'armes qui vous intéresse,rien de plus simple pour commencer,il vous faut un plan que vous pouvez acheter auprés d'un forgeron,il y aura une liste des ressources et outils indispenssables a la confection,lisez le dans votre atelier et commencez la forge,attention toutefois certaines armes difficiles a réaliser demandent un niveau d'agilité élevé.", "oblig_bas_ouprcaen",[]],
  [anyone|plyr,"oblig_bas_ouprcaen", [], "Certes,je m'en doute,mais si je n'ai pas d'atelier et que je ne suis pas fixé dans une ville?", "march_ressources_campcaen",[]],
  [anyone,"march_ressources_campcaen", [],"Et bien les forgerons itinnérants existent vous savez,dans ce cas il vous faut travailler dans un atelier improvisé dans un camp aux abords de la ville,cela me parait évident pourtant.", "ressources_campvendgenecaen",[]],
  
  #dialogues vendeurs ressources
  [anyone,"start", [(eq, "$g_talk_troop", "trp_ressource_merchant_caen"),
    ],
    "Du bois,des cordes solides,pierres a aiguiser...quel es votre metier messire? je ne vous es jamais vue dans la ville,si vous etes venu installer votre atelier,vous aurez besoin de m'acheter des ressources,que vous soyez forgeron,charpentier,ou meme cordonier.", "march_ressourcesrcaen", [(play_sound, "snd_marchands_res_greetings"),]],
  [anyone|plyr,"march_ressourcesrcaen", [], "Pourquois ne pas acheter chez les grossistes?", "march_ressourcesrocaen",[]],
  [anyone|plyr,"march_ressourcesrcaen", [], "J'aimerais apprendre a forger des armes.", "march_ressources_howrocaen",[]],
  [anyone|plyr,"march_ressourcesrcaen", [], "Je n'ai besoin de rien merci.", "close_window",[]],
  [anyone,"march_ressourcesrocaen", [],"Naturellement vous pouvez comparer les prix et acheter les ressources les moins chères,mais nous nous efforcons de garder les prix les plus bas,malgrès la guerre,et de plus nous reunissons suffisament de ressources pour assurer les demandes en différentes matières des productions des artisants,par les temps qui courent,ne pas avoir a se deplacer de villes en villes pour reunir toutes ces matières premieres n'as pas de prix!.", "march_ressourcesrcaen",[]],
  
  [anyone,"march_ressources_howrocaen", [],"Si c'est la fabrication d'armes qui vous intéresse,rien de plus simple pour commencer,il vous faut un plan que vous pouvez acheter auprés d'un forgeron,il y aura une liste des ressources et outils indispenssables a la confection,lisez le dans votre atelier et commencez la forge,attention toutefois certaines armes difficiles a réaliser demandent un niveau d'agilité élevé,pour le reste,c'est en forgant que l'on deviens....", "oblig_bas_ourocaen",[]],
  [anyone|plyr,"oblig_bas_ourocaen", [], "Certes,je m'en doute,mais si je n'ai pas d'atelier et que je ne suis pas fixé dans une ville?", "march_ressources_camprocaen",[]],
  [anyone,"march_ressources_camprocaen", [],"Et bien les forgerons itinnérants existent vous savez,dans ce cas il vous faut travailler dans un atelier improvisé dans un camp aux abords de la ville,cela me parait évident pourtant.", "march_ressources_cacaen",[]],
  [anyone|plyr,"march_ressources_cacaen", [], "Tres bien,j'aimerais voir quelles ingredients vous avez a vendre dans ce cas.", "ressources_campvendokrocaen",[(assign, "$nextdialressourcesvencae", 1),]],
  [anyone|plyr,"march_ressources_cacaen", [], "Je m'en souviendrais merci.", "close_window",[(assign, "$nextdialressourcesvencae", 1),]],
  
  [anyone,"ressources_campvendokrocaen", [],"Naturellement,voila tout ce qu'il me reste.", "ressources_camcaenro",[[change_screen_trade]]],
  [anyone,"ressources_camcaenro", [],"A une autre fois je l'éspère.", "close_window",[]],
  
  
  #  rouen
  [anyone,"start", [(eq, "$g_talk_troop", "trp_ressource_merchant_roen"),
      (eq, "$nextdialressourcesvenro", 1),
    ],
    "Du bois,des cordes solides,pierres a aiguiser...", "march_ressources_starrouen", [(play_sound, "snd_marchands_res_greetings"),]],
  
  [anyone|plyr,"march_ressources_starrouen", [], "J'aimerais apprendre a forger des armes.", "march_ressources_howrou",[]],
  [anyone|plyr,"march_ressources_starrouen", [], "Je voudais acheter des matières prmières.", "ressources_campvrour",[]],
  [anyone|plyr,"march_ressources_starrouen", [], "Ou puis je trouver d'autres vendeurs de ressources?", "ressources_ouautpartroouen",[]],
  [anyone|plyr,"march_ressources_starrouen", [], "Voudriez vous jouer aux dés ?", "debut_desrouen",[]],
  [anyone,"debut_desrouen", [],"Allons y !", "generique_des",[]],
  [anyone|plyr,"march_ressources_starrouen", [], "Je n'ai besoin de rien merci.", "close_window",[]],
  
  [anyone,"ressources_ouautpartroouen", [],"A ma connaissance il y a un marchant a Paris,Tours,Caen,Nantes et Orléans.il y en a peut etre d'autres ailleurs dans le sud de la france mais je ne les connais pas..", "ressources_campvendgenerou",[]],
  
  [anyone,"ressources_campvrour", [],"Naturellement,voila tout ce qu'il me reste.", "ressources_campvendgenerou",[[change_screen_trade]]],
  [anyone,"ressources_campvendgenerou", [],"Autre chose?.", "march_ressources_starrouen",[]],
  
  [anyone,"march_ressources_howrou", [],"Si c'est la fabrication d'armes qui vous intéresse,rien de plus simple pour commencer,il vous faut un plan que vous pouvez acheter auprés d'un forgeron,il y aura une liste des ressources et outils indispenssables a la confection,lisez le dans votre atelier et commencez la forge,attention toutefois certaines armes difficiles a réaliser demandent un niveau d'agilité élevé.", "oblig_bas_ouprou",[]],
  [anyone|plyr,"oblig_bas_ouprou", [], "Certes,je m'en doute,mais si je n'ai pas d'atelier et que je ne suis pas fixé dans une ville?", "march_ressources_camprou",[]],
  [anyone,"march_ressources_camprou", [],"Et bien les forgerons itinnérants existent vous savez,dans ce cas il vous faut travailler dans un atelier improvisé dans un camp aux abords de la ville,cela me parait évident pourtant.", "ressources_campvendgenerou",[]],
  
  #dialogues vendeurs ressources
  [anyone,"start", [(eq, "$g_talk_troop", "trp_ressource_merchant_roen"),
    ],
    "Du bois,des cordes solides,pierres a aiguiser...quel es votre metier messire? je ne vous es jamais vue dans la ville,si vous etes venu installer votre atelier,vous aurez besoin de m'acheter des ressources,que vous soyez forgeron,charpentier,ou meme cordonier.", "march_ressourcesro", [(play_sound, "snd_marchands_res_greetings"),]],
  [anyone|plyr,"march_ressourcesro", [], "Pourquois ne pas acheter chez les grossistes?", "march_ressourcesrouu",[]],
  [anyone|plyr,"march_ressourcesro", [], "J'aimerais apprendre a forger des armes.", "march_ressources_howro",[]],
  [anyone|plyr,"march_ressourcesro", [], "Je n'ai besoin de rien merci.", "close_window",[]],
  [anyone,"march_ressourcesrouu", [],"Naturellement vous pouvez comparer les prix et acheter les ressources les moins chères,mais nous nous efforcons de garder les prix les plus bas,malgrès la guerre,et de plus nous reunissons suffisament de ressources pour assurer les demandes en différentes matières des productions des artisants,par les temps qui courent,ne pas avoir a se deplacer de villes en villes pour reunir toutes ces matières premieres n'as pas de prix!.", "march_ressourcesro",[]],
  
  [anyone,"march_ressources_howro", [],"Si c'est la fabrication d'armes qui vous intéresse,rien de plus simple pour commencer,il vous faut un plan que vous pouvez acheter auprés d'un forgeron,il y aura une liste des ressources et outils indispenssables a la confection,lisez le dans votre atelier et commencez la forge,attention toutefois certaines armes difficiles a réaliser demandent un niveau d'agilité élevé,pour le reste,c'est en forgant que l'on deviens....", "oblig_bas_ouro",[]],
  [anyone|plyr,"oblig_bas_ouro", [], "Certes,je m'en doute,mais si je n'ai pas d'atelier et que je ne suis pas fixé dans une ville?", "march_ressources_campro",[]],
  [anyone,"march_ressources_campro", [],"Et bien les forgerons itinnérants existent vous savez,dans ce cas il vous faut travailler dans un atelier improvisé dans un camp aux abords de la ville,cela me parait évident pourtant.", "march_ressources_campvendro",[]],
  [anyone|plyr,"march_ressources_campvendro", [], "Tres bien,j'aimerais voir quelles ingredients vous avez a vendre dans ce cas.", "ressources_campvendokro",[(assign, "$nextdialressourcesvenro", 1),]],
  [anyone|plyr,"march_ressources_campvendro", [], "Je m'en souviendrais merci.", "close_window",[(assign, "$nextdialressourcesvenro", 1),]],
  
  [anyone,"ressources_campvendokro", [],"Naturellement,voila tout ce qu'il me reste.", "ressources_campvendro",[[change_screen_trade]]],
  [anyone,"ressources_campvendro", [],"A une autre fois je l'éspère.", "close_window",[]],
  
  #  paris
  [anyone,"start", [(eq, "$g_talk_troop", "trp_ressource_merchant_paris"),
      (eq, "$nextdialressourcesven", 1),
    ],
    "Du bois,des cordes solides,pierres a aiguiser...", "march_ressources_starpar", [(play_sound, "snd_marchands_res_greetings"),]],
  
  [anyone|plyr,"march_ressources_starpar", [], "J'aimerais apprendre a forger des armes.", "march_ressources_howpar",[]],
  [anyone|plyr,"march_ressources_starpar", [], "Je voudais acheter des matières prmières.", "ressources_campvpar",[]],
  [anyone|plyr,"march_ressources_starpar", [], "Ou puis je trouver d'autres vendeurs de ressources?", "ressources_ouautpartpar",[]],
  [anyone|plyr,"march_ressources_starpar", [], "Une partie au jeu de dés ?", "debut_desparis",[]],
  [anyone,"debut_desparis", [],"Avec plaisire.", "generique_des",[]],
  [anyone|plyr,"march_ressources_starpar", [], "Je n'ai besoin de rien merci.", "close_window",[]],
  
  [anyone,"ressources_ouautpartpar", [],"Vous etes bien hardi de me poser une telle question,si j'entend bien vous voullez l'adrèsse de mes concurents? soit,aucune importance,a ma connaissance il y a un marchant a Tours,Rouen,Caen,Nantes et Orléans.il y en a peut etre d'autres ailleurs en france mais je ne les connais pas..", "ressources_campvendgene",[]],
  [anyone,"ressources_campvpar", [],"Naturellement,voila tout ce qu'il me reste.", "ressources_campvendgene",[[change_screen_trade]]],
  [anyone,"ressources_campvendgene", [],"Autre chose Messire?.", "march_ressources_starpar",[]],
  
  [anyone,"march_ressources_howpar", [],"Si c'est la fabrication d'armes qui vous intéresse,rien de plus simple pour commencer,il vous faut un plan que vous pouvez acheter auprés d'un forgeron,il y aura une liste des ressources et outils indispenssables a la confection,lisez le dans votre atelier et commencez la forge,attention toutefois certaines armes difficiles a réaliser demandent un niveau d'agilité élevé.", "oblig_bas_oupar",[]],
  [anyone|plyr,"oblig_bas_oupar", [], "Certes,je m'en doute,mais si je n'ai pas d'atelier et que je ne suis pas fixé dans une ville?", "march_ressources_camppar",[]],
  [anyone,"march_ressources_camppar", [],"Et bien les forgerons itinnérants existent vous savez,dans ce cas il vous faut travailler dans un atelier improvisé dans un camp aux abords de la ville,cela me parait évident pourtant.", "ressources_campvendgene",[]],
  
  #dialogues vendeurs ressources
  [anyone,"start", [(eq, "$g_talk_troop", "trp_ressource_merchant_paris"),
    ],
    "Du bois,des cordes solides,pierres a aiguiser...quel es votre metier messire? je ne vous es jamais vue dans la ville,si vous etes venu installer votre atelier,vous aurez besoin de m'acheter des ressources,que vous soyez forgeron,charpentier,ou meme cordonier.", "march_ressources_star", [(play_sound, "snd_marchands_res_greetings"),]],
  [anyone|plyr,"march_ressources_star", [], "Pourquois ne pas acheter chez les grossistes?", "march_ressources_gros",[]],
  [anyone|plyr,"march_ressources_star", [], "J'aimerais apprendre a forger des armes.", "march_ressources_how",[]],
  [anyone|plyr,"march_ressources_star", [], "Je n'ai besoin de rien merci.", "close_window",[]],
  [anyone,"march_ressources_gros", [],"Naturellement vous pouvez comparer les prix et acheter les ressources les moins chères,mais nous nous efforcons de garder les prix les plus bas,malgrès la guerre,et de plus nous reunissons suffisament de ressources pour assurer les demandes en différentes matières des productions des artisants,par les temps qui courent,ne pas avoir a se deplacer de villes en villes pour reunir toutes ces matières premieres n'as pas de prix!.", "march_ressources_star",[]],
  
  [anyone,"march_ressources_how", [],"Si c'est la fabrication d'armes qui vous intéresse,rien de plus simple pour commencer,il vous faut un plan que vous pouvez acheter auprés d'un forgeron,il y aura une liste des ressources et outils indispenssables a la confection,lisez le dans votre atelier et commencez la forge,attention toutefois certaines armes difficiles a réaliser demandent un niveau d'agilité élevé,pour le reste,c'est en forgant que l'on deviens....", "oblig_bas_ou",[]],
  [anyone|plyr,"oblig_bas_ou", [], "Certes,je m'en doute,mais si je n'ai pas d'atelier et que je ne suis pas fixé dans une ville?", "march_ressources_camp",[]],
  [anyone,"march_ressources_camp", [],"Et bien les forgerons itinnérants existent vous savez,dans ce cas il vous faut travailler dans un atelier improvisé dans un camp aux abords de la ville,cela me parait évident pourtant.", "march_ressources_campvend",[]],
  [anyone|plyr,"march_ressources_campvend", [], "Tres bien,j'aimerais voir quelles ingredients vous avez a vendre dans ce cas.", "ressources_campvendok",[(assign, "$nextdialressourcesven", 1),]],
  [anyone|plyr,"march_ressources_campvend", [], "Je m'en souviendrais merci.", "close_window",[(assign, "$nextdialressourcesven", 1),]],
  
  [anyone,"ressources_campvendok", [],"Naturellement,voila tout ce qu'il me reste.", "ressources_campvend",[[change_screen_trade]]],
  [anyone,"ressources_campvend", [],"A une autre fois je l'éspère.", "close_window",[]],
  
  
  #######################  DIAL ACTEURS VERZY  ###########################
  ###########################################################################
  #autre dial Foureau
  #################ICI
  
  #  Foureau
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzy6"),
    ],
    "Le Bonjour Compagnon on m'appelle Foureau,tu viens d'ou?", "sqverzycomp1_1", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"sqverzycomp1_1", [],  "D'un peut partout.", "verzycomp1_2", []],
  [anyone|plyr ,"sqverzycomp1_1", [],  "Pourquois ce surnom?", "verzycomp1_nam", []],
  [anyone ,"verzycomp1_2", [],"Comme nous tous je suppose,fait attention a toi.", "close_window", []],
  
  [anyone ,"verzycomp1_nam", [],"Et ben,c'est a dire que j'ai du succés avec les dames....", "verzycomp1_namok", []],
  [anyone|plyr ,"verzycomp1_namok", [],  "Ca va...j'es compris.", "close_window", []],
  
  #autre dial Tibaut
  
  #################ICI
  #Tibaut sentinele a verzy
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzy5"),
    ],
    "Bonjour et bienvenue,je suis Tibaut.", "verzycom2_1", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"verzycom2_1", [],  "Salutation,je me nome {playername}.", "verzycom2_2", []],
  [anyone ,"verzycom2_2", [],"Reste sur tes gardes surtout.", "close_window", []],
  
  #autre dial Ripaille
  
  #################ICI
  #La Ripaille
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzy4"),
    ],
    "Halte! qui es tu toi,et que fait tu au beau milieu de la foret?", "verzycom3_1d", [(play_sound, "snd_alt"),]],
  [anyone|plyr ,"verzycom3_1d", [],  "Je cherche les Rebelles,le chef de Montpelier m'envoie vous trouver.", "verzycom3_12", []],
  [anyone ,"verzycom3_12", [],"Ca va entre,on m'appelle La Ripaille par ici.", "verzycom3_1", []],
  [anyone|plyr ,"verzycom3_1", [],  "Je suis {playername}.", "close_window", []],
  [anyone|plyr ,"verzycom3_1", [],  "La Ripaille?", "verzycom3_name", []],
  [anyone ,"verzycom3_name", [],"Oui,car j'aime faire la fête et boire,mais pas trop sinom je me bat avec n'importe qui.Dominique a due m'assomer d'ailleurs lorsque je m'en etait pris a lui,alors evite de rester prés de moi quand je bois te voila prévenue.", "close_window", []],
  
  #autre dial Poignard
  #################ICI
  
  #Poignard
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzy3"),
    ],
    "Bien le bonjour mon ami,on m'appelle Poignard,et ces bois sont ma patrie,je suis partout chez moi a dire vrais tant que je reste avec ceux la,on a vécus beaucoup de choses enssembles tu peut me croire.", "verzycom4_1", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"verzycom4_1", [],  "Je te crois volontier,vous avez l'air de solides combatants.", "close_window", []],
  [anyone|plyr ,"verzycom4_1", [],  "Poignard? comptez vous me donner un surnom aussi?", "verzycom4_po", []],
  [anyone ,"verzycom4_po", [],"C'est possible,cela dépendra de tes actions,j'éspère ne pas avoir a t'appeller pleutre ou couard.", "verzycom4_po2", []],
  [anyone|plyr ,"verzycom4_po2", [],  "Ne va pas trop loing,ce n'es pas par ce que vous etes six que je me laisserais insulter.", "verzycom4_po3", []],
  [anyone ,"verzycom4_po3", [],"Ha,ha,ha! mais ton nom es déja tout trouvé...{playername} le Fou.", "verzycom4_po4", []],
  [anyone|plyr ,"verzycom4_po4", [],  "Je ne suis pas sur de pouvoir m'habituer a toi.", "close_window", []],
  
  
  #autre dial Antoine
  
  #################ICI
  # Antoine
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzy2"),
    ],
    "Je suis Antoine,bienvenue a toi Compagnon.", "verzycom5_1", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"verzycom5_1", [],  "Merci,je vais réster quelques temps,j'ai un compte a régler avec les Bourgignons.", "verzycom5_ca", []],
  [anyone|plyr ,"verzycom5_1", [],  "Merci,j'éspère pouvoir me faire quelques écus par ici.", "verzycom5_ec", []],
  
  [anyone ,"verzycom5_ca", [],"Tu es au bon endroit alors.", "close_window", []],
  [anyone ,"verzycom5_ec", [],"Et bien,j'imagine que ca devrais etre possible,tant que tu respecte nos lois.elles sont simples,ne pas prendre aux plus démunis et rester fidéle au Royaume de France,quand au fait de piller les cadavres,je tournerais la tête quand tu le feras.", "close_window", []],
  
  
  ################################# place forte gogorda
  
  #dERNIERE PHRASE
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzy1"),
      (check_quest_active, "qst_rebel_shearchlico"),
      (neg|check_quest_finished, "qst_rebel_shearchlico"),
      (neg|check_quest_succeeded, "qst_rebel_shearchlico"),
    ],
    "Bon courage pour la suite,de notre coté,on saura se débrouiller,comme toujours.", "endof_verzyqut",[]],
  
  [anyone|plyr ,"endof_verzyqut", [],  "Faites attention a vous.", "close_window",[]],
  
  
  #deuxiemee chance quete
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzy1"),
      (eq, "$dernierdialverzyyyz", 1),
      
    ],
    "Alors? t'as changé d'avis,tu veux rencontrer Licorne?", "chpchancrenc_licorn",[]],
  
  [anyone|plyr ,"chpchancrenc_licorn", [],  "Tres bien je suis d'accord.", "chpchancrenc_licornok", []],
  [anyone|plyr ,"chpchancrenc_licorn", [],  "Pas encore,j'ai bien trop a faire.", "close_window", []],
  [anyone ,"chpchancrenc_licornok", [],"Parfait,il t'atendra dans le jardin de Poitiers,dés qu'il saura que tu es entré en ville,il te donnera les directives lui meme quand tu le vera,quand a nous,nous allons continuer a nous battre contre les Bourgignons.merci pour tout Compagnon,et garde toujours l'éspoir quois qu'il arive.", "close_window",
    [
      #lance mission rencontrer licorne3
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Licorne veux me rencontrer dans les jardins de la ville de Poitiers,il dit avoir du travail pour moi."),
      (call_script, "script_start_quest", "qst_rebel_shearchlico", "$g_talk_troop"),
      (assign, "$rencontrdelicornpott", 1),
  ]],
  
  # # # # # # # # # # # # # # # #fail et win
  
  #win
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzy1"),
      (check_quest_succeeded, "qst_rebel_placeforte"),
      (neg|check_quest_failed, "qst_rebel_placeforte"),
    ],
    "Le bonjour Compagnon,me voila de retour.alors cette place forte?", "chplacef_wwiin",[(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"chplacef_wwiin", [],  "Elle es a nous!", "chplacef_wwiinnou",
    [
      #finish mission/variabl autre dial/renomee et relation plus
      (call_script, "script_end_quest", "qst_rebel_placeforte"),
      (call_script, "script_change_troop_renown", "trp_player", 4),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", 2),
  ]],
  [anyone ,"chplacef_wwiinnou", [],"Je savais que vous réussiriez,je n'en es pas douté un instant.quand a moi,j'es rencontré Licorne,et il m'a fait part de projets intéréssants.je lui es parlé de toi,et si tu le shouaite,tu pourais travailler directement pour lui et l'aider a réaliser ses plans,qu'en dit tu?.", "chplacef_wwiinnoulic", []],
  [anyone|plyr ,"chplacef_wwiinnoulic", [],  "Tres bien je suis d'accord.", "chplacef_wwiinnoulicok", []],
  [anyone|plyr ,"chplacef_wwiinnoulic", [],  "Pas pour le moment,j'ai bien trop a faire.", "close_window", [(assign, "$dernierdialverzyyyz", 1),]],
  [anyone ,"chplacef_wwiinnoulicok", [],"Parfait,il t'atendra dans le jardin de Poitiers,dés qu'il saura que tu es entré en ville,il te donnera les directives lui meme quand tu le vera,quand a nous,nous allons continuer a nous battre contre les Bourgignons.merci pour tout Compagnon,et garde toujours l'éspoir quois qu'il arive.", "close_window",
    [
      #lance mission rencontrer licorne2
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Licorne veux me rencontrer dans les jardins de la ville de Poitiers,il dit avoir du travail pour moi."),
      (call_script, "script_start_quest", "qst_rebel_shearchlico", "$g_talk_troop"),
      (assign, "$rencontrdelicornpott", 1),
  ]],
  
  #fail
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzy1"),
      #cond quete active
      (check_quest_failed, "qst_rebel_placeforte"),
      (neg|check_quest_succeeded, "qst_rebel_placeforte"),
    ],
    "Le bonjour Compagnon,me voila de retour.alors cette place forte?", "chplacef_faill",[(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"chplacef_faill", [],  "Nous n'y sommes pas arivé.", "chplacef_faill2",
    [
      #relation moin /variable
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -2),
      #(party_set_flags, "p_place_forte_b", pf_always_visible, 0),
      #(party_set_flags, "p_place_forte_b", pf_disabled, 1),
  ]],
  [anyone ,"chplacef_faill2", [],"C'est pas possible,je t'avais pourtant dit de bien préparer ton plan avant.bon,on y peut rien maintenant.j'es rencontré Licorne,et il m'a fait part de projets intéréssants.je lui es parlé de toi,et si tu le shouaite,tu pourais travailler directement pour lui et l'aider a réaliser ses plans,qu'en dit tu?.", "chplacef_failllico", []],
  [anyone|plyr ,"chplacef_failllico", [],  "Tres bien je suis d'accord.", "chplacef_failllicook", []],
  [anyone|plyr ,"chplacef_failllico", [],  "Pas pour le moment,j'ai bien trop a faire.", "close_window", [(assign, "$dernierdialverzyyyz", 1),]],
  
  [anyone ,"chplacef_failllicook", [],"Parfait,il t'atendra dans le jardin de Poitiers,dés qu'il saura que tu es entré en ville,il te donnera les directives lui meme quand tu le vera,quand a nous,nous allons continuer a nous battre contre les Bourgignons.merci pour tout Compagnon,et garde toujours l'éspoir quois qu'il arive.", "close_window",
    [
      #lance mission rencontrer licorne1
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Licorne veux me rencontrer dans les jardins de la ville de Poitiers,il dit avoir du travail pour moi."),
      (call_script, "script_start_quest", "qst_rebel_shearchlico", "$g_talk_troop"),
      (assign, "$rencontrdelicornpott", 1),
  ]],
  #################################
  
  #en attente
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzy1"),
      #cond quete active
      (check_quest_active, "qst_rebel_placeforte"),
      (neg|check_quest_succeeded, "qst_rebel_placeforte"),
      (neg|check_quest_failed, "qst_rebel_placeforte"),
      (neg|check_quest_finished, "qst_rebel_placeforte"),
    ],
    "{playername}? quand allez vous vous rendres a la place forte? nous comptons tous sur vous.", "chief_verznewattentt",[(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"chief_verznewattentt", [],  "Je doit me préparer,je m'y rendrais le plus possible.", "close_window", []],
  
  
  
  #en attente si j'ai demand?d'attendre,repossible de lancer quete ici
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzy1"),
      (eq, "$waitforatakplacfor", 1),
      (neg|check_quest_active, "qst_rebel_placeforte"),
    ],
    "Alors? es tu pret a enmener mes hommes a la place forte?.", "domi_deuxchancepforte",[(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"domi_deuxchancepforte", [],  "Oui,je suis pret.", "domi_deuxchancepforteok", []],
  [anyone|plyr ,"domi_deuxchancepforte", [],  "Je doit me préparer le plus possible.", "close_window", []],
  [anyone ,"domi_deuxchancepforteok", [],"Voila ce que j'aime entendre,et souviens toi,prend le temp d'observer de loing et de planifier l'attaque,a tres bientot Compagnons.quand a moi,un long voyage m'attend.", "close_window",
    [
      #lancer quete 2 aparaitre partie
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le chef des Rebelles du camp de la foret de Verzy,m'a demandé de mener ses hommes a la place forte Bourgignone au sud ouest de Dijon,de planifier l'attaque et de capturer la place en controlant la troupe au combat."),
      (call_script, "script_start_quest", "qst_rebel_placeforte", "$g_talk_troop"),
      (party_set_flags, "p_place_forte_b", pf_disabled, 0),
      (party_set_flags, "p_place_forte_b", pf_always_visible, 1),
      (party_set_flags, "p_place_forte_b", pf_quest_party, 1),
  ]],
  
  
  
  #autre dial chef
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzy1"),
      (eq, "$uneautrequeteverzy", 1),
    ],
    "{playername},tu tombe bien.pour l'aide que tu nous apporte,j'es décidé de te récompensser du mieux que je le peut,comme tu le sait nous n'avons rien,mais il y a des contacts qui nous ravitaille quand nous en avons vraiment besoin.va voir le fossoyeur dans le cimetiere de Calais,et dit lui simplement:les anges de Dominique veulent une épée,il te donnera ce qu'il a put rassemblé pour nous,je suis sur que tu en fera bon usage.", "chief_verznewquessst",
    [
      (play_sound, "snd_rebels_greetings"),
      (assign, "$codsecretfosscalaisopen", 1),
  ]],
  
  [anyone|plyr ,"chief_verznewquessst", [],  "Que pouvons nous faire pour harceler les Bourgignons de nouveau Dominique?", "domi_newqquest", []],
  [anyone|plyr ,"chief_verznewquessst", [],  "Qui es ce fossoyeur?", "domi_fosst", []],
  [anyone|plyr ,"chief_verznewquessst", [],  "Merci,toute aide es bonne a prendre,je doit partir a present,je reviendrais le plus tot possible.", "close_window", []],
  
  [anyone ,"verz_diomipredial", [],"Autre chose a me demander?", "chief_verznewquessst", []],
  
  [anyone ,"domi_fosst", [],"Il etait autrefois un des notres,et bléssé il a du se résigner a nous quitter et a prendre n'importe quel travail,mais il continue de nous aider,en ce moment il cache des armes ou autre dans des fausses tombes dans le cimetiere de Calais.", "verz_diomipredial", []],
  [anyone ,"domi_newqquest", [],"Nous pouvons faire mieux que ca,nous allons leur prendre une place forte.", "domi_newqquest2", []],
  
  [anyone|plyr ,"domi_newqquest2", [],  "Prendre une place forte a sept? c'est une plaisanterie.", "domi_newqquest3", []],
  
  [anyone ,"domi_newqquest3", [],"Non,a vous six,je ne viens pas je doit rencontrer Licorne lui meme.mais rassure toi,ils ne sont qu'une poigné a déffendre la place.je te confie le comandement {playername},je t'es bien observé et je sais que tu sera a la hauteur pour cette tache.évite de laisser ceux la foncer dans le tas et je te recomande de prendre un peut de hauteur pour coordonner l'attaque.", "domi_newqquest4", []],
  [anyone ,"domi_newqquest4", [],"Je crois en vous Compagnons,par Saint Michel,prennez cette place et Licorne décidera de la suite.", "domi_newqquest5", []],
  
  [anyone|plyr ,"domi_newqquest5", [],  "Tres bien,je prendrais cette place meme a moi tout seul si il le faut.", "domi_newqquestokk", []],
  [anyone|plyr ,"domi_newqquest5", [],  "Je ne suis pas encore pret,pouvez vous m'attendre un peut?", "domi_newqquestwait", []],
  
  [anyone ,"domi_newqquestwait", [],"Soit,mais ne traine pas trop.je peut repousser mon départ,mais pas étérnelement.", "close_window",
    [
      (assign, "$waitforatakplacfor", 1),
  ]],
  
  [anyone ,"domi_newqquestokk", [],"Voila ce que j'aime entendre,et souviens toi,prend le temp d'observer de loing et de planifier l'attaque,a tres bientot Compagnons.quand a moi,un long voyage m'attend.", "close_window",
    [
      #lancer quete 1 aparaitre partie
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le chef des Rebelles du camp de la foret de Verzy,m'a demandé de mener ses hommes a la place forte Bourgignone au sud ouest de Dijon,de planifier l'attaque et de capturer la place en controlant la troupe au combat."),
      (call_script, "script_start_quest", "qst_rebel_placeforte", "$g_talk_troop"),
      (party_set_flags, "p_place_forte_b", pf_disabled, 0),
      (party_set_flags, "p_place_forte_b", pf_always_visible, 1),
      (party_set_flags, "p_place_forte_b", pf_quest_party, 1),
  ]],
  
  ########################################################################################################
  
  #win
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzy1"),
      (check_quest_succeeded, "qst_rebel_entrepmetz"),
      (neg|check_quest_failed, "qst_rebel_entrepmetz"),
    ],
    "Ah,te voila.c'etait un beau combat a Metz pas vrais? ces chiens ont eu ce qu'il méritais,et nous on a enfin de quois se remplire le ventre,tiens a ce propos voila ta part,j'éspère que tu sera aprécier des victuailles prisent aux Bourgignons,c'etait vraiment du bon travail l'ami,merci.", "winverzetpy",
    [
      (play_sound, "snd_rebels_greetings"),
      (call_script, "script_end_quest", "qst_rebel_entrepmetz"),
      (troop_add_item, "trp_player", "itm_cheese", 0),
      (troop_add_item, "trp_player", "itm_bread", 0),
      (troop_add_item, "trp_player", "itm_sausages", 0),
  ]],
  
  [anyone|plyr ,"winverzetpy", [],  "C'etait un plaisir,vraiment.", "close_window",
    [
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", 2),
      (assign, "$uneautrequeteverzy", 1),
  ]],
  
  
  
  #FAIL
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzy1"),
      (check_quest_failed, "qst_rebel_entrepmetz"),
      (neg|check_quest_active, "qst_rebel_entrepmetz"),
      (neg|check_quest_succeeded, "qst_rebel_entrepmetz"),
    ],
    "Et bien,on peut dire qu'on s'est raté.au moin on a put avoir du pain rassis et de l'eau croupis au cachot,sauf que j'es encore plus faim qu'avant de partir pour ce maudis entrepot.", "faillverzetpy", [(play_sound, "snd_rebels_greetings"),]],
  
  [anyone|plyr ,"faillverzetpy", [],  "Que pouvions nour faire de plus? au moin on auras éssayé.", "faillverzetpy2", []],
  
  [anyone ,"faillverzetpy2", [],"Bha! j'es pas envie de parler.", "close_window",
    [
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -4),
      (assign, "$uneautrequeteverzy", 1),
  ]],
  
  
  #en attendans entrepot de metz
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzy1"),
      (check_quest_active, "qst_rebel_entrepmetz"),
      (neg|check_quest_succeeded, "qst_rebel_entrepmetz"),
      (neg|check_quest_failed, "qst_rebel_entrepmetz"),
      (neg|check_quest_finished, "qst_rebel_entrepmetz"),
    ],
    "Part devans et attend nous a la rivière.", "metz_averzy_verzz", []],
  
  [anyone|plyr ,"metz_averzy_verzz", [],  "Bien.", "close_window", []],
  [anyone|plyr ,"metz_averzy_verzz", [],  "Je crois que je ne pourais pas le faire.", "metz_averzy_verzzfail",
    [
      #####failed et assigner variable suite
      (call_script, "script_fail_quest", "qst_rebel_entrepmetz"),
      (call_script, "script_end_quest", "qst_rebel_entrepmetz"),
      (assign, "$uneautrequeteverzy", 1), ########################################################################  VARIABLE CONDITION AUTRE QUETE A REPORTER
  ]],
  [anyone ,"metz_averzy_verzzfail", [],"Mais c'est pas vrais...bon,et bien va ou tu veux traitre.", "close_window",
    [
      #relation black khergit moin
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -4),
  ]],
  
  
  
  
  ############################################### chef
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzy1"),
    ],
    "Salutation mon ami,Je me nome Dominique,si tu es la au coeur de la foret c'est que tu as lu mon message caché dans la tombe et que tu as su le déchiffrer...un instant,je suis en train de me dire que si tu n'es pas un des notres et un voyageur égaré tu doit trouver ce discourt on ne peut plus...étrange...", "chief_verzz",
    [
      (call_script, "script_succeed_quest", "qst_rebel_chearchcamp"),
      (call_script, "script_end_quest", "qst_rebel_chearchcamp"),
  ]],
  
  [anyone|plyr ,"chief_verzz", [],  "Ne t'inquiète pas je suis bien un Rebelle,c'est le chef de Montpelier qui m'envoie,et j'ai bien trouvé votre message.", "chief_verzz2", []],
  [anyone ,"chief_verzz2", [],"Bien,nous partons sur de bonnes bases alors.tu as bien fait de venir a nous,nous avons des difficultés a éffectuer nos opérations,les villes de Bourgognes sont trop bien gardés,notre but es d'arceler l'ennemi Bourgignon dans son propre teritoire,et ce meme pendant les trêves.", "chief_verzzchoi", []],
  
  [anyone|plyr ,"chief_verzzchoi", [],  "Que pouvons nous faire pour lutter contre les Bourgignons?", "chief_starbourds", []],
  [anyone|plyr ,"chief_verzzchoi", [],  "N'avez vous pas l'impression de luter pour rien parfois?", "chief_verzzrien", []],
  [anyone|plyr ,"chief_verzzchoi", [],  "Pourquois avez vous quité le camp de la ville de Toul?", "chief_verzztoul", []],
  [anyone|plyr ,"chief_verzzchoi", [],  "Je doit partir,mais nous reprendrons cette converssation plus tard.", "close_window", []],
  [anyone ,"chiefvz_prediaien", [],"As tu d'autres questions?", "chief_verzzchoi", []],
  
  
  [anyone ,"chief_verzztoul", [],"Je ne veux plus entendre parler de cet horible endroit,impossible de fermer l'oeil un instant sans etre pris d'angoisses,ca devenait insuportable il falait vraiment que l'on partent on es bien mieux ici pour le moment.", "chiefvz_prediaien", []],
  [anyone ,"chief_verzzrien", [],"Et que propose tu? s'enroler dans la garde de Charles VII? ca n'es pas mieux crois moi.il faut luter encore,jusqu'a ce que l'on soient assez nombreux et nous suivrons les directives de Licorne.", "chiefv_liccoorrnnn", []],
  
  [anyone|plyr ,"chiefv_liccoorrnnn", [],  "De qui?.", "chiefv_liccoorrnnn22", []],
  [anyone ,"chiefv_liccoorrnnn22", [],"Tu n'as donc pas entendu parler de la Licorne? c'est le chef de tous les Rebelles,du moin il va le devenire.je l'es déja rencontré et c'est lui qui m'as dit de venire ici.c'est un grand stratège,la guerre sera gagnée dés que nous nous serons rassemblés sous sa bannière.", "chiefvz_prediaien", []],
  
  [anyone ,"chief_starbourds", [],"Nous n'avons plus de vivres pour commencer,nous devrions attaquer une caravane,mais il y a plus simple et moin dangereux.les entrepots de Metz,recoivent tous les jours des vivres pour les soldats du Duc en provenance d'Allemagne.ils ne sont pas tres bien gardés et il nous suffis de nous débarasser des quelques gardes pour pouvoir prendre toute la nouriture qu'il nous faut,l'enuis c'est que l'on se fera remarquer et que des patrouilles fouillerons les forets,et nous verons pour la suite une fois que l'on auras le ventre plein.tu nous accompagne?", "chief_starbourdsokmiss", []],
  
  [anyone|plyr ,"chief_starbourdsokmiss", [],  "Tres bien,je vous suis,j'ai moi meme tres faim.", "chief_starbourdsokmissoui", []],
  [anyone|plyr ,"chief_starbourdsokmiss", [],  "Pas pour le moment,je reviendrais plus tard.", "close_window", []],
  
  [anyone ,"chief_starbourdsokmissoui", [],"Tres bien...Ah,a propos,si nous étions séparés dans la batailles,nous nous retrouverons bien sur ici a cet endroit de la foret.Bon,je crois que tout es pret nous pouvons partir,nous nous retrouverons a Metz,passe par la rivière en contrebas et attend nous en bas de la porte des Allemands.", "close_window",
    [
      #####lancer quete et autre si besoin
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le chef Rebelle de la troupe cachée dans la foret de Verzy,m'a envoyé en éclaireur a Metz dans le quartier de la porte des Allemands afin de préparer une opération visant a s'emparer des vivres entreposés."),
      (call_script, "script_start_quest", "qst_rebel_entrepmetz", "$g_talk_troop"),
  ]],
  
  
  ##################  FIN dial VERZY     ###################
  ##################################################################################
  #dials entrepots METZ
  #REBELS SUR LE TERAIN
  #6B
  
  #  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzentrep6"),
  #                     (check_quest_succeeded, "qst_rebel_entrepmetz"),
  #                     ],
  #   "Foutons le camp.", "verz_mztzprebat1", []],
  #  [anyone|plyr ,"verz_mztzprebat1", [],  "Ne trainons pas.", "close_window", []],
  
  #6
  # [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzentrep6"),
  #                    ],
  #  "Faut pas se rater,prenons le temp de réfléchire pour une fois.", "verz_mztzprebat2", []],
  # [anyone|plyr ,"verz_mztzprebat2", [],  "Ca va bien se passer..", "close_window", []],
  
  
  #5B
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzentrep5"),
      (check_quest_succeeded, "qst_rebel_entrepmetz"),
    ],
    "Foutons le camp.", "verz_mztzprebat3", []],
  [anyone|plyr ,"verz_mztzprebat3", [],  "Ne trainons pas.", "close_window", []],
  
  #5
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzentrep5"),
    ],
    "Faut pas se rater,prenons le temp de réfléchire pour une fois.", "verz_mztzprebat4", []],
  [anyone|plyr ,"verz_mztzprebat4", [],  "Ca va bien se passer..", "close_window", []],
  
  #4B
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzentrep4"),
      (check_quest_succeeded, "qst_rebel_entrepmetz"),
    ],
    "Allez,on ramasse les vivres et on file d'ici.", "verz_mztzprebat5", []],
  [anyone|plyr ,"verz_mztzprebat5", [],  "Ne trainons pas.", "close_window", []],
  
  #4
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzentrep4"),
    ],
    "Faut pas se rater,prenons le temp de réfléchire pour une fois.", "verz_mztzprebat6", []],
  [anyone|plyr ,"verz_mztzprebat6", [],  "Ca va bien se passer..", "close_window", []],
  
  #3B
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzentrep3"),
      (check_quest_succeeded, "qst_rebel_entrepmetz"),
    ],
    "Prenons les vivres et filons.", "verz_mztzprebat7", []],
  [anyone|plyr ,"verz_mztzprebat7", [],  "Ne trainons pas.", "close_window", []],
  
  #3
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzentrep3"),
    ],
    "Faut pas se rater,prenons le temp de réfléchire pour une fois.", "verz_mztzprebat8", []],
  [anyone|plyr ,"verz_mztzprebat8", [],  "Ca va bien se passer..", "close_window", []],
  
  #2B
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzentrep2"),
      (check_quest_succeeded, "qst_rebel_entrepmetz"),
    ],
    "Partons...vite.", "verz_mztzprebat9", []],
  [anyone|plyr ,"verz_mztzprebat9", [],  "Ne trainons pas.", "close_window", []],
  
  #2
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzentrep2"),
    ],
    "Faut pas se rater,prenons le temp de réfléchire pour une fois.", "verz_mztzprebat10", []],
  [anyone|plyr ,"verz_mztzprebat10", [],  "Ca va bien se passer.", "close_window", []],
  
  ##########################VICTOIRE CHEF
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzentrep1"),
      (check_quest_succeeded, "qst_rebel_entrepmetz"),
    ],
    "On les as eu! ramassons tout ce qu'on peut et foutons le camp,on se reparle au camp.", "vict_etpmetz", []],
  [anyone|plyr ,"vict_etpmetz", [],  "Ne trainons pas.", "close_window", []],
  
  #CHEF apres arbalete
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzentrep1"),
      (neg|check_quest_succeeded, "qst_rebel_entrepmetz"),
      (eq, "$donnaarbaltt", 1),
    ],
    "Va tuer ce garde a l'entrée du pont,tire lui un carreau dans la tete, on lance le signal dés qu'il est mort et on attaque.", "comando_rappelmo",[]],
  [anyone|plyr ,"comando_rappelmo", [],  "J'y vais.", "close_window", []],
  
  #CHEF
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_verzentrep1"),
    ],
    "Nous sommes la,ca a l'air de bien se presenter.tiens prend cette arbalete et ces careaux,tu voie la guerite en pierre la bas avant le pont? le garde es seul,de plus quand tu l'aura tué tu aura une tres bonne position pour nous couvrire,mais fait attention a leurs fléches.dés que le garde sera mort on lance le signal et on attaque.va! maintenant.", "comando_etp1",
    [
      (troop_add_item, "trp_player","itm_heavy_crossbow",0),
      (troop_add_item, "trp_player","itm_bolts",0),
  ]],
  [anyone|plyr ,"comando_etp1", [],  "Ne trainez pas,je serais seul dans la guertite pendant un moment.", "comando_etp2", [(assign, "$donnaarbaltt", 1),]],
  [anyone ,"comando_etp2", [],"Alors,saute du toit de la tour vers la rivière et ils seront coincés dans la guerite et on ira les ceuillir a couvert de leur archers dans la guerite meme.", "close_window", []],
  
  
  #SOLDAT ENEMIS
  [anyone,"start", [(eq, "$g_talk_troop", "trp_bourg_entrep_metz8"),
    ],
    "Fiche le camp.", "metz_gardechiouratgo7", []],
  [anyone|plyr ,"metz_gardechiouratgo7", [],  "Je n'ai aucune envie de rester ici.", "close_window", []],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_bourg_entrep_metz7"),
    ],
    "Fiche le camp.", "metz_gardechiouratgo6", []],
  [anyone|plyr ,"metz_gardechiouratgo6", [],  "Je n'ai aucune envie de rester ici.", "close_window", []],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_bourg_entrep_metz6"),
    ],
    "Fiche le camp.", "metz_gardechiouratgo5", []],
  [anyone|plyr ,"metz_gardechiouratgo5", [],  "Je n'ai aucune envie de rester ici.", "close_window", []],
  
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_bourg_entrep_metz5"),
    ],
    "Fiche le camp.", "metz_gardechiouratgo4", []],
  [anyone|plyr ,"metz_gardechiouratgo4", [],  "Je n'ai aucune envie de rester ici.", "close_window", []],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_bourg_entrep_metz4"),
    ],
    "Fiche le camp.", "metz_gardechiouratgo3", []],
  [anyone|plyr ,"metz_gardechiouratgo3", [],  "Je n'ai aucune envie de rester ici.", "close_window", []],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_bourg_entrep_metz3"),
    ],
    "Fiche le camp.", "metz_gardechiouratgo2", []],
  [anyone|plyr ,"metz_gardechiouratgo2", [],  "Je n'ai aucune envie de rester ici.", "close_window", []],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_bourg_entrep_metz2"),
    ],
    "Fiche le camp.", "metz_gardechiouratgo", []],
  [anyone|plyr ,"metz_gardechiouratgo", [],  "Je n'ai aucune envie de rester ici.", "close_window", []],
  
  ########
  #active sentinele!!! lancer combat!!!!!
  [anyone,"start", [(eq, "$g_talk_troop", "trp_bourg_entrep_copie1"),
      #    (check_quest_active, "qst_rebel_entrepmetz"),
    ],
    "Eh la bas! qu'es c'que tu fout ici?", "metz_gardechiouratak", []],
  [anyone|plyr ,"metz_gardechiouratak", [],  "Je n'ai pas le temp de te laisser finire ton dernier repas,j'en suis navré.", "close_window",
    [
      (mission_disable_talk),
      (team_set_relation, 0, 1, 0),
      (team_set_relation, 0, 2, 0),
      (team_set_relation, 0, 3, 1),
      (team_set_relation, 1, 0, 0),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 1, 3, 0),
      (team_set_relation, 2, 0, 0),
      (team_set_relation, 2, 1, 0),
      (team_set_relation, 2, 3, -1),
      (team_set_relation, 3, 0, 1),
      (team_set_relation, 3, 1, 0),
      (team_set_relation, 3, 2, -1),
  ]],
  
  #pas active
  [anyone,"start", [(eq, "$g_talk_troop", "trp_bourg_entrep_metz1"),
      (neg|check_quest_active, "qst_rebel_entrepmetz"),
    ],
    "Fiche le camp manant,ne t'approche pas de l'entrepot.", "metz_gardechiour", []],
  [anyone|plyr ,"metz_gardechiour", [],  "Je n'ai aucune envie de rester ici avec toi,pas d'inquiétude.", "close_window", []],
  
  
  #fossoyeur de calais  recompensse
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_foss"),
      (eq, "$codsecretfosscalaisopen", 1),
      (lt, "$nomaterialfosscalais", 1),
    ],
    "Le bonjour,que puis je pour vous ?", "fossde_calaigiv", []],
  
  [anyone|plyr ,"fossde_calaigiv", [],  "Je viens chercher le materiel des Rebelles je vous prie.", "fossde_calaigivgo", []],
  [anyone|plyr ,"fossde_calaigiv", [],  "Rien,je me promenais tout simplement.", "close_window", []],
  
  [anyone ,"fossde_calaigivgo", [], "Pardon? vous devez faire une ereur.", "fossde_calaigivgo2", []],
  [anyone|plyr ,"fossde_calaigivgo2", [], "Oh,c'est vrais...les anges de Dominique veulent une épée.", "fossde_calaigivgo3", []],
  
  [anyone ,"fossde_calaigivgo3", [], "C'est bon compagnon,laisse moi le temp de déterrer le coffre,voila...il y a la de quois forger des armes,si tu ne sait pas t'y prendre corectement,tu n'as qu'a revendre le tout,j'éspère que ca t'aidera en tout cas.bonne chance.", "fossde_calaigivgo4",
    [
      (troop_add_item, "trp_player", "itm_iron", 0),
      (troop_add_item, "trp_player", "itm_iron", 0),
      (troop_add_item, "trp_player", "itm_tools", 0),
      (troop_add_item, "trp_player", "itm_enclume", 0),
      (troop_add_item, "trp_player", "itm_bois", 0),
      (troop_add_item, "trp_player", "itm_bois", 0),
      (troop_add_item, "trp_player", "itm_cuir", 0),
      (troop_add_item, "trp_player", "itm_cuir", 0),
      (troop_add_item, "trp_player", "itm_plume", 0),
      (troop_add_item, "trp_player", "itm_plume", 0),
      (troop_add_item, "trp_player", "itm_corde", 0),
      (troop_add_item, "trp_player", "itm_corde", 0),
      (troop_add_item, "trp_player", "itm_pier", 0),
      (troop_add_item, "trp_player", "itm_pier", 0),
  ]],
  
  [anyone|plyr ,"fossde_calaigivgo4", [], "Merci pour la marchandise,au plaisir de te revoir...dans un autre endroit.", "close_window", [(assign, "$nomaterialfosscalais", 1),]],#assign
  
  #fossoyeur de calais avant recompensse
  [anyone,"start", [(eq, "$g_talk_troop", "trp_caen_foss"),
    ],
    "Bien le bonjour visiteur,vennez vous vous receuillire sur une tombe?", "fossde_calai3", []],
  
  [anyone|plyr ,"fossde_calai3", [],  "Pas vraiment,je me suit perdu.", "fossde_calai34", []],
  
  [anyone ,"fossde_calai34", [],"Vous feriez mieux de rentrer en ville avant la nuit,les loups rodent par ici,et le soir tombé,l'endroit et assez éffrayant.", "close_window", []],
  
  ######################DIAL acteurs place forte neutre
  ########################################################################################
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pfrebel_neutre6"),
    ],
    "Savez vous si la bierre es arivée Messire? il devaient en faire monter avec le reste du ravitaillement.", "trop_montalravitail",[]],
  [anyone|plyr ,"trop_montalravitail", [],  "Je n'en sait rien soldat,mais ravitailler dans les mongtagnes en temp de guerre ne doit pas etre si simple.", "close_window", []],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pfrebel_neutre5"),
    ],
    "Quel bel endroit,et si bien protégé tactiquement,je me sens en sécurité ici.", "trop_montalpesmon",[]],
  [anyone|plyr ,"trop_montalpesmon", [],  "Un havre de paix en haut des mongtagnes,loing de la guerre,que rever de mieux par les temp qui courent.", "close_window", []],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pfrebel_neutre4"),
    ],
    "Quel paysage magnifique,n'es ce pas?", "trop_montalpeschop",[]],
  [anyone|plyr ,"trop_montalpeschop", [],  "Vraiment éblouissant en effet.", "close_window", []],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pfrebel_neutre3"),
    ],
    "Bien le bonjour,que fait tu ici?", "trop_montalpeschopici",[]],
  [anyone|plyr ,"trop_montalpeschopici", [],  "J'ai moi meme capturé cet endroit,avec une poigné de braves.", "trop_montalpeschopici2", []],
  [anyone ,"trop_montalpeschopici2", [],"Vraiment? je te paye une chope aprés ma garde dans ce cas.", "close_window", []],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pfrebel_neutre2"),
    ],
    "Bien le bonjour,on se promène?", "trop_montalpes",[]],
  [anyone|plyr ,"trop_montalpes", [],  "Cet endroit me rappelle de vieux souvenirs", "trop_montalpes2", []],
  [anyone ,"trop_montalpes2", [],"Ah oui? et bien tu peut rester sans restrictions dans ce cas.", "close_window", []],
  
  ######################chef place forte possibles quetes>>>>>
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pfrebel_neutre1"),
    ],
    "Salutations,c'est moi qui suis responssable de la déffensse de cet endroit,que puis je faire pour toi compagnon?.", "fortep_chef",[]],
  
  [anyone|plyr ,"fortep_chef", [],  "En quois cette place forte sert t'elle la rebelion?", "fortep_chefrebp", []],
  [anyone|plyr ,"fortep_chef", [],  "Rien,je suis juste de passage.", "close_window", []],
  
  [anyone ,"fortep_chefrebp", [],"Nous contribuont a la domination Francaise en causant des domages aux Bourgignions,de plus si les troupes de Charles VII voulaient attaquer Dijon pour forcer le Duc de Bourgogne a areter de servire les intérets du roi d'Angleterre,c'est ici qu'ils prépareraient l'attaque.une sote de poste avancé en teritoire ennemi on ne peut plus...sécurisé et confortable.", "fortep_chefrebp2", []],
  [anyone|plyr ,"fortep_chefrebp2", [],  "Y a t'il du travail pour moi ici?", "fortep_chefrebptaf", []],
  [anyone|plyr ,"fortep_chefrebp2", [],  "Merci du rensseignement,adieu.", "close_window", []],
  
  [anyone ,"fortep_chefrebptaf", [],"Pas pour le moment,nous avons la situation en main,mais merci de ton aide.", "close_window", []],########!!!!! dial de quete place forte aux rebels possible ICIIII !!!!! gorplacef
  
  
  #########################################################################################################
  ###################################dial licorn ###################################
  #tout dernier dial licorne si confess?et redonne lettre
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_licorn"),
      (eq, "$byelicornee", 1),
    ],
    "{playername},qu'il est bon de vous revoir.que faites vous ici ?", "rerencontliccoo",[(play_sound, "snd_maitre_guild"),]],
  [anyone|plyr ,"rerencontliccoo", [],  "J'en suis navré, mais j'ai perdu la lettre de recomandation, en avez vous une autre ?", "rerencontliccoorel", []],
  [anyone|plyr ,"rerencontliccoo", [],  "Je vennais juste me rappeller de tous ces moments.", "close_window", []],
  [anyone ,"rerencontliccoorel", [],"Et bien, ca n'es point commun de perdre une telle chose, j'éspère qu'etre Chevalier es assez important pour vous pour que vous prenniez soin de ce qui en a trait.", "rerencontliccoorel22",[]],#reporter surnom/"la mort noire"assigner variable pour menu stats !!!!!
  [anyone|plyr ,"rerencontliccoorel22", [],  "Mes excuses.", "rerencontliccoorelem", []],
  [anyone ,"rerencontliccoorelem", [],"Tennez, la voici.il manque les enluminures que mon scribe avais réalisé pour vous, le roi n'auras point l'occasion de les admirer, mais en temp de guerre il se suffirais du'un nom gravé sur une pierre pour recruter de nouveaux Chevaliers.", "close_window",
    [
      (troop_add_item, "trp_player", "itm_plis_recomandation", 0),
  ]],
  
  
  
  
  #si pas voulue se conffesser
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_licorn"),
      (eq, "$endetermeretic", 1),
    ],
    "Que faites vous ici heretique ? comment avez vous put reffuser de vous conffesser ?", "erereticqu",[]],
  [anyone|plyr ,"erereticqu", [],  "J'ai d'autres convictions sur les hommes et la religion,adieu.", "close_window", []],
  
  
  #retour conffession win
  #win
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_licorn"),
      (check_quest_succeeded, "qst_conffes_chevalier"),
      (check_quest_active, "qst_conffes_chevalier"),
      (neg|check_quest_failed, "qst_conffes_chevalier"),
      (neg|check_quest_finished, "qst_conffes_chevalier"),
    ],
    "{playername},etes vous purifié de vos pechés ?", "enfinpurifier_oklettre",[(play_sound, "snd_maitre_guild"),]],
  [anyone|plyr ,"enfinpurifier_oklettre", [],  "Je le suis Messire, allez vous me donner cette lettre pour le roi ?", "enfinpurifier_oklettre2",
    [
      #end quest/relation plus faction rebel/plus de renom?
      (call_script, "script_end_quest", "qst_conffes_chevalier"),
  ]],
  [anyone ,"enfinpurifier_oklettre2", [],"Naturelement, tennez la voici. je serais heureux de compter parmis nous un homme noble de coeur et fort d'esprit. toutes fois, meme avec cette lettre, il vous faudra encore gagner les faveurs du roi.devenire Chevalier sans un nom noble es plus difficile que vous ne le penssez.", "close_window",
    [
      #donner lettre
      (troop_add_item, "trp_player", "itm_plis_recomandation", 0),
      (assign, "$byelicornee", 1),
  ]],
  
  #attente avec possible refus et pas de lettre
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_licorn"),
      (check_quest_active, "qst_conffes_chevalier"),
      (neg|check_quest_succeeded, "qst_conffes_chevalier"),
      (neg|check_quest_failed, "qst_conffes_chevalier"),
      (neg|check_quest_finished, "qst_conffes_chevalier"),
    ],
    "{playername},etes vous purifié de vos pechés ?", "attesteretlaverpechh",[(play_sound, "snd_maitre_guild"),]],
  [anyone|plyr ,"attesteretlaverpechh", [],  "Je m'en occuppe Messire.", "close_window", []],
  [anyone|plyr ,"attesteretlaverpechh", [],  "Je ne désire pas me conffesser, j'optiendrais cette lettre autrement.", "attesteretlaverpechheret",
    [
      #failed et variable dernier dialogue
      (call_script, "script_fail_quest", "qst_conffes_chevalier"),
      (call_script, "script_end_quest", "qst_conffes_chevalier"),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -2),
      (assign, "$endetermeretic", 1),
  ]],
  [anyone ,"attesteretlaverpechheret", [],"Comment ? vous etes un heretic ! hors de ma vue.", "close_window",[]],
  
  
  
  
  #possible lettre de recomandation et autres...
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_licorn"),
      (eq, "$endetplusdediallicornee", 1),
    ],
    "{playername},comme il est bon de vous revoir.vous etes devenu un heros le savez vous au moin ?", "ddernieraveclicornn",[(play_sound, "snd_maitre_guild"),]],
  [anyone|plyr ,"ddernieraveclicornn", [],  "Comment cela ?", "ddernieraveclicornne", []],
  [anyone ,"ddernieraveclicornne", [],"N'estes vous point au courant ? les gens du peuple vous appellent la Mort Noire. n'ayez point de hire,les gens ne vous penssent pas pesteux, mais ils entendent par la que ceux qui vous rencontre meurent fatalement.en tous cas generaux et gouverneurs ennemis on triplés leurs gardes et c'est une bonne chose qu'ils es peur.", "ddernieraveclicornne2",[]],#reporter surnom/"la mort noire"assigner variable pour menu stats !!!!!
  
  [anyone|plyr ,"ddernieraveclicornne2", [],  "J'es une faveure a vous mander Messire.", "ddernieraveclicornnez3", []],
  [anyone|plyr ,"ddernieraveclicornne2", [],  "Je doit vous laisser Messire, a une autre fois.", "close_window", []],
  
  #demander des faveures.......
  [anyone ,"ddernieraveclicornnez3", [],"Je vous écoute...", "ddernieraveclicornnez3ok",[]],#reporter surnom/"la mort noire"assigner variable pour menu stats !!!!!
  
  [anyone|plyr ,"ddernieraveclicornnez3ok", [],  "Je désire malgrés tout etre Chevalier, et il me faut pour ca une lettre de recomandation a donner au roi.vous etes noble n'es ce pas, pouvez vous la rédiger a mon nom ?", "ddernieraveclicornnez4", []],
  [anyone|plyr ,"ddernieraveclicornnez3ok", [],  "Non, ca n'es rien...", "close_window", []],
  
  [anyone ,"ddernieraveclicornnez4", [],"Et bien, je reffuserais en temp normal qu'un assasin devienne Chevalier, mais...c'est a cause de moi que vous avez due vous livrer a ces...meurtres, de plus c'etait pour le bien de la France, donc,j'accepte en fermant les yeux sur l'etiquete exeptonnellement.", "ddernieraveclicornnez5",[]],#reporter surnom/"la mort noire"assigner variable pour menu stats !!!!!
  
  [anyone|plyr ,"ddernieraveclicornnez5", [],  "Croyez moi Messire, ce sont les hommes qui font de bons Chevaliers, et non les lois.", "ddernieraveclicornnez6", []],
  
  [anyone ,"ddernieraveclicornnez6", [],"Certes...mais avant tout vous devez vous conffesser,en suite vous aurez ma lettre,et une fois Chevalier par la grace de saint Michel,vous devrez malgrés tout vous tenire aux lois.", "ddernieraveclicornnez8",[]],#reporter surnom/"la mort noire"assigner variable pour menu stats !!!!!
  
  [anyone|plyr ,"ddernieraveclicornnez8", [],  "Ou puis je me conffesser ?", "ddernieraveclicornnez9", []],
  
  [anyone ,"ddernieraveclicornnez9", [],"Au cloitre des Jacobins a Toulouse.ce sont eux qui preparent nos chevaliers a leur purification en vue de preter serment,puissiez vous faire un bon Chevalier {playername}.", "close_window",
    [
      #lancer quete se conffesser
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Licorne m'envoie me conffesser de mes assasinats pour devenire Chevalier au cloitre des Jacobins a Toulouse.il me donneras la lettre de recomandation a donner au roi une fois cette tache effectuée."),
      (call_script, "script_start_quest", "qst_conffes_chevalier", "$g_talk_troop"),
  ]],
  
  ################################
  ##fail/win
  
  
  #win
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_licorn"),
      (check_quest_succeeded, "qst_rebel_manoir"),
      (check_quest_active, "qst_rebel_manoir"),
      (neg|check_quest_failed, "qst_rebel_manoir"),
      (neg|check_quest_finished, "qst_rebel_manoir"),
    ],
    "{playername},Vous etes en vie! comment cela c'est t'il passé ?", "retourtuerbanquierreiim",[(play_sound, "snd_maitre_guild"),]],
  [anyone|plyr ,"retourtuerbanquierreiim", [],  "Le marchand es tombé, victime du poison.", "retourtuerbanquierokok",
    [
      #end quest/relation plus faction rebel/plus de renom?
      (call_script, "script_end_quest", "qst_rebel_manoir"),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", 2),
      (call_script, "script_change_troop_renown", "trp_player", 4),
  ]],
  [anyone ,"retourtuerbanquierokok", [],"Exelente nouvelle! nous allons gagner la guerre, c'est certain! voila votre récompensse,1000 écus,vous allez devenire un homme riche a cette allure, ne changez pas d'idéale pour autant.", "close_window",
    [
      #donner or
      (assign, "$endetplusdediallicornee", 1),
      (troop_add_gold, "trp_player", 1000),
  ]],
  
  #fail
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_licorn"),
      (check_quest_failed, "qst_rebel_manoir"),
      (neg|check_quest_succeeded, "qst_rebel_manoir"),
    ],
    "{playername},Vous etes en vie! comment cela c'est t'il passé ?", "retourtuerbanqperduf",[(play_sound, "snd_maitre_guild"),]],
  [anyone|plyr ,"retourtuerbanqperduf", [],  "Je n'ai pas put l'empoisonner,je m'en excuse.", "retourtuerbanqperduf2", []],
  
  [anyone ,"retourtuerbanqperduf2", [],"Bon, j'imagine que vous avez fait de votre mieux...", "close_window",
    [
      (assign, "$endetplusdediallicornee", 1),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -2),
  ]],
  
  ####attente
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_licorn"),
      (check_quest_active, "qst_rebel_manoir"),
      (neg|check_quest_succeeded, "qst_rebel_manoir"),
      (neg|check_quest_failed, "qst_rebel_manoir"),
      (neg|check_quest_finished, "qst_rebel_manoir"),
    ],
    "{playername},j'éspère que vous n'avez pas changé d'avis pour notre affaire.", "avisavecaffairelicornn",[(play_sound, "snd_maitre_guild"),]],
  [anyone|plyr ,"avisavecaffairelicornn", [],  "Je m'en occuppe Messire.", "close_window", []],
  [anyone|plyr ,"avisavecaffairelicornn", [],  "C'est trop dangereux,je ne veux pas y perdre la vie.", "close_window",
    [
      #failed et variable dernier dialogue
      (call_script, "script_fail_quest", "qst_rebel_manoir"),
      (call_script, "script_end_quest", "qst_rebel_manoir"),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -2),
      (assign, "$endetplusdediallicornee", 1),
  ]],
  
  
  #derniere mission licorne
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_licorn"),
      (eq, "$dernieremisslicornee", 1),
    ],
    "{playername},Il y a une dérnière chose que vous puissiez faire pour moi.", "derniere_meurtelico",[]],
  [anyone|plyr ,"derniere_meurtelico", [],  "Encore un assasinat éhonté ?", "derniere_meurtelicotbar", []],
  
  [anyone ,"derniere_meurtelicotbar", [],"Je le crain.Il est un Bourgignon que nous voullons tous voir disparaitre, il s'agis d'un riche marchand et un homme d'affaires incroyablement riche.Il finance en partie les équipements des troupes Bourgignones, si les braves francais se font arracher la tete sur le champ de bataille par un tir de baliste c'est a lui qu'on le doit.", "derniere_meurtelicotbardoit",[]],
  [anyone|plyr ,"derniere_meurtelicotbardoit", [],  "Ou, quand, et pour combien ?", "derniere_meurtelicomany", []],
  [anyone|plyr ,"derniere_meurtelicotbardoit", [],  "J'ai assez tuer de personnes lachement ne croyez vous pas ?", "close_window", []],
  
  [anyone ,"derniere_meurtelicomany", [],"Allez le trouver dans son Manoire a Metz,il donne des festivités pendant une semaine,lui mort sa fortune reviendra a son jeune fils,qui s'es engagé a ne plus l'utiliser pour l'armement du Duc de Bourgogne...c'est malheureux d'en ariver a telles situations,mais c'est en vérité le fils qui a chercher a rencontrer un groupe de Rebelles pour faire assasiner son père.", "derniere_meurtelicomasom",[]],
  [anyone|plyr ,"derniere_meurtelicomasom", [],  "Vous oubliez la récompensse.", "derniere_meurtesorr", []],
  
  [anyone ,"derniere_meurtesorr", [],"En effet, toutes mes excuses, je suppose que 1000 autres écus devraient suffirent, allez vous vous en charger ? et bien sur ne revélez ni mon nom, ni notre lieux de rendez vous si vous etiez pris, pas meme sous la torture.", "derne_meurtesostart",[]],
  
  [anyone|plyr ,"derne_meurtesostart", [],  "Soit, pour 1000 écus, je relève le defis.", "derne_meurtesostart2", []],
  [anyone|plyr ,"derne_meurtesostart", [],  "Je ne veux pas prendre de tels risques,je tiens a la vie, adieu.", "close_window", []],
  
  [anyone ,"derne_meurtesostart2", [],"Merci, vous me sauvez la vie une fois de plus {playername}.Tennez, prennez cette fiole de poison, si notre homme n'en bois ne serais ce qu'une goutte, il sucomberais dans les minutes.assurez vous qu'il l'avale,et dés qu'il sera a terre, fuyez le plus loing et le plus vite possible.", "close_window",
    [
      #donner posoin
      (troop_add_item, "trp_player", "itm_poison", 0),
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Licorne m'envoie a la mort une foie de plus, il veux que j'enpoisonne un riche marchand Bourgignon qui finance les armées du Duc de Bourgogne.Je le trouverais a sa manoire a Reims, Licorne me verssera 1000 écus dés qu'il apprendra sa mort."),
      (call_script, "script_start_quest", "qst_rebel_manoir", "$g_talk_troop"),
  ]],
  
  ###########################
  
  #win
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_licorn"),
      (check_quest_succeeded, "qst_rebel_asassin_chasse"),
      (check_quest_active, "qst_rebel_asassin_chasse"),
      (neg|check_quest_failed, "qst_rebel_asassin_chasse"),
      (neg|check_quest_finished, "qst_rebel_asassin_chasse"),
    ],
    "{playername},je vous en pris, dites moi que ce satané gouverneur es mort.", "win_killgouv_chass",[(play_sound, "snd_maitre_guild"),]],
  [anyone|plyr ,"win_killgouv_chass", [],  "Le monstre es mort.", "win_killgouv_chass2",
    [
      #end quest/relation plus faction rebel/plus de renom?
      (call_script, "script_end_quest", "qst_rebel_asassin_chasse"),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", 2),
      (call_script, "script_change_troop_renown", "trp_player", 4),
  ]],
  
  [anyone ,"win_killgouv_chass2", [],"J'ai du mal a le croire, je ne saurais comment vous remercier, voila déja la somme convenue, et recevez mes plus sincères remerciements.", "win_killgouv_chass3",
    [
      #donner fric 1000/remove camp de chasse
      (troop_add_gold, "trp_player", 1000),
      (party_set_flags, "p_chasse_camp", pf_always_visible, 0),
      (party_set_flags, "p_chasse_camp", pf_disabled, 1),
  ]],
  [anyone|plyr ,"win_killgouv_chass3", [],  "Ces missions sont pour le moin éprouvantes, des hommes ont perdue la vie pour m'aider, ce sont des heros, veillez a ce que leur famille soit aidée en retour.", "win_killgouv_chass4", []],
  
  [anyone ,"win_killgouv_chass4", [],"C'est malheureux, mais il n'y avais pas d'autres solutions, je veillerais a ce que leur famille recoive des terres et des avantages considérables.croyez moi ils ne sont pas morts pour rien, quand a vous vous allez devenire une légende vivante.", "win_killgouv_chass5",[]],
  [anyone|plyr ,"win_killgouv_chass5", [],  "Je m'en passerais volontier, adieu.", "close_window",
    [
      (assign, "$dernieremisslicornee", 1),
  ]],
  
  
  #fail
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_licorn"),
      (check_quest_failed, "qst_rebel_asassin_chasse"),
      (neg|check_quest_succeeded, "qst_rebel_asassin_chasse"),
    ],
    "{playername},je vous en pris, dites moi que ce satané gouverneur es mort.", "fail_battlegouven",[(play_sound, "snd_maitre_guild"),]],
  [anyone|plyr ,"fail_battlegouven", [],  "Je n'ai rien put faire, ils etaient a cheval et aucune possibilité de trouver une arme.", "fail_battlegouven2", []],
  
  [anyone ,"fail_battlegouven2", [],"C'es un désastre, mais je ne vous en veux pas, nous arions duent préparer ca avec plus d'inspiration, mais le temp nous manquais.", "close_window",
    [
      (assign, "$dernieremisslicornee", 1),
      (party_set_flags, "p_chasse_camp", pf_always_visible, 0),
      (party_set_flags, "p_chasse_camp", pf_disabled, 1),
  ]],
  
  #en attente assasinat chasse
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_licorn"),
      (check_quest_active, "qst_rebel_asassin_chasse"),
      (neg|check_quest_succeeded, "qst_rebel_asassin_chasse"),
      (neg|check_quest_failed, "qst_rebel_asassin_chasse"),
      (neg|check_quest_finished, "qst_rebel_asassin_chasse"),
    ],
    "{playername},je vous en pris, dites moi que ce satané gouverneur es déja mort.", "attent_dechasse_gouv",[(play_sound, "snd_maitre_guild"),]],
  [anyone|plyr ,"attent_dechasse_gouv", [],  "Je m'en occuppe n'ayez point de craintes.", "close_window", []],
  [anyone|plyr ,"attent_dechasse_gouv", [],  "C'est bien trop compliqué, je ne peut pas.", "close_window",
    [
      #failed et variable dernier dialogue
      (call_script, "script_fail_quest", "qst_rebel_asassin_chasse"),
      (call_script, "script_end_quest", "qst_rebel_asassin_chasse"),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -2),
      (assign, "$dernieremisslicornee", 1),
      (party_set_flags, "p_chasse_camp", pf_always_visible, 0),
      (party_set_flags, "p_chasse_camp", pf_disabled, 1),
  ]],
  #
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_licorn"),
      (eq, "$autreassassiatdelico", 1),
    ],
    "{playername},j'ai quelque chose pour vous si vous etes toujours interessé,cela vous rapporteras 1000 écus en tous cas.", "ico_assassinchasse",[]],
  [anyone|plyr ,"ico_assassinchasse", [],  "Je vous écoute.", "ico_assassinchasseok", []],
  [anyone|plyr ,"ico_assassinchasse", [],  "J'ai besoin de temp pour me remetre de ma dérnière mission,peut etre plus tard.", "close_window", []],
  [anyone ,"ico_assassinchasseok", [],"Il s'agit cette fois d'un gouverneur Anglais des plus génants.nominé pour remplacer des seigneurs partis en guerre,il gére les terres a leurs places. le problème es qu'il maltraite la population et les paysans en teritoire occupé et cette situation es devenue insoutenable pour beaucoup de personnes meme pour certains Anglais.", "ico_assassinchassegouv", []],
  [anyone|plyr ,"ico_assassinchassegouv", [],  "Ou et quand dois je l'élliminer?.", "ico_assassinchassegouv2", []],
  [anyone ,"ico_assassinchassegouv2", [],"Il part souvent a la chasse dans la région de Senlis,vous le trouverez tot ou tard dans son camp,mais attention,il s'entoure toujours de sa garde,trouvez un superfuge ou vous ne pourez pas l'approcher, naturelement allez y sans armes ou vous vous feriez areté, fuyez en suite dés que vous l'aurez mortellement touché. ", "ico_assassinchassegouv3", []],
  [anyone|plyr ,"ico_assassinchassegouv3", [],  "Pour 1000 écus,je suis votre homme.", "ico_assassinchassegouvstar",
    [
      #start quest et devoiler partie camp de chasse
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Licorne me payeras 1000 écus si je le débarasse d'un gouverneur Anglois qui chasse pret de senlis,il me faudra trouver un moyen de l'areter car je doit approcher du camp sans armes."),
      (call_script, "script_start_quest", "qst_rebel_asassin_chasse", "$g_talk_troop"),
      (party_set_flags, "p_chasse_camp", pf_disabled, 0),
      (party_set_flags, "p_chasse_camp", pf_always_visible, 1),
      (party_set_flags, "p_chasse_camp", pf_quest_party, 1),
  ]],
  [anyone|plyr ,"ico_assassinchassegouv3", [],  "Ca me semble trop risqué,je reévaluerais la situation plus tard,adieu.", "close_window", []],
  [anyone ,"ico_assassinchassegouvstar", [],"Bien,allez y seul, faites attention a vous, et ne vous découvrez qu'au dérnier moment pour le tuer.", "close_window",[]],
  
  
  ################################
  ## win
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_licorn"),
      (check_quest_active, "qst_rebel_assas_comtcaen"),
      (check_quest_succeeded, "qst_rebel_assas_comtcaen"),
      (neg|check_quest_failed, "qst_rebel_assas_comtcaen"),
    ],
    "Content de vous revoir.qu'en es t'il du comte?", "attent_licotuercomtdeaad",[(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"attent_licotuercomtdeaad", [],  "Le comte n'es plus.", "attent_licotuercomtdeaad2",
    [
      # end quest
      (call_script, "script_end_quest", "qst_rebel_assas_comtcaen"),
  ]],
  
  [anyone ,"attent_licotuercomtdeaad2", [],"Je vous félicite.les choses irons de mieux en mieux maintenant dans la région de Caen.je vours remercie,et voila 1000 écus pour le payement,revenez bientot si vous etes toujours interessé.", "close_window",
    [
      #relation moin rebels assigner prochain dialog et payer
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", 2),
      (troop_add_gold, "trp_player", 1000),
      (assign, "$autreassassiatdelico", 1),
  ]],
  
  
  #fail
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_licorn"),
      (check_quest_active, "qst_rebel_assas_comtcaen"),
      (check_quest_failed, "qst_rebel_assas_comtcaen"),
      (neg|check_quest_succeeded, "qst_rebel_assas_comtcaen"),
    ],
    "Content de vous revoir.qu'en es t'il du comte?", "attent_licotuercomt",[(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"attent_licotuercomt", [],  "Il est toujours en vie,ils etaient trop nombreux et Je n'ai rien put faire.", "attent_licotuercomt2", []],
  [anyone ,"attent_licotuercomt2", [],"C'est facheux,je regrette,mais dans ce cas il n'y a pas de récompensse.je'aurais peut etre bientot une autre mission pour vous,en éspèrant que vous réussirez cette fois.", "close_window",
    [
      #relation moin rebels assigner prochain dialog
      (call_script, "script_end_quest", "qst_rebel_assas_comtcaen"),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -2),
      (assign, "$autreassassiatdelico", 1),
  ]],
  
  
  
  
  
  #####en attente d'avoir tu?le comte et redone des fausses invitations a l'infini
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_licorn"),
      (check_quest_active, "qst_rebel_assas_comtcaen"),
      (neg|check_quest_succeeded, "qst_rebel_assas_comtcaen"),
      (neg|check_quest_failed, "qst_rebel_assas_comtcaen"),
      (neg|check_quest_finished, "qst_rebel_assas_comtcaen"),
    ],
    "Et bien Messire? le...travail,es t'il fait?.", "ico_attenttuercomt",[(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"ico_attenttuercomt", [],  "Je m'y suis engagé Messire,n'ayez craintes.", "close_window", []],
  [anyone|plyr ,"ico_attenttuercomt", [],  "Et bien...il me faut une autre invitation,je l'es perdu.", "ico_attenttuercomtperdu", []],
  [anyone|plyr ,"ico_attenttuercomt", [],  "Je regrètte,je ne peut tuer un homme lachement,je doit refuse.", "ico_attenttuercomtfail", []],
  
  [anyone ,"ico_attenttuercomtperdu", [],"Perdu? faites attention je vous pris,ca n'es pas si simple de refaire ces faux documents,en voila une autre,et gardez la bien cette fois.", "close_window",
    [
      ###redoner lettre
      (troop_add_item, "trp_player","itm_plis_caen",0),
  ]],
  
  [anyone ,"ico_attenttuercomtfail", [],"Pour ne rien vous cacher,je suis assez décu,vous vous etes engagé,de plus vous retardez mes plans.soit,je trouverais un autre assassin.", "close_window",
    [
      ####mission fail/relation rebel moin et variable suite des assassinas
      (call_script, "script_fail_quest", "qst_rebel_assas_comtcaen"),
      (call_script, "script_end_quest", "qst_rebel_assas_comtcaen"),
      (assign, "$autreassassiatdelico", 1),
  ]],
  
  
  ############################################################################################################################################
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_licorn"),
      (eq, "$redialmetlicorn", 1),
    ],
    "Salutations,vous voila enfin a Poitier mon ami.les différents chefs Rebelles m'on compté votre dévotion a notre cause.j'ai besoin de quelqu'un de compétent pour une mission de la plus haute importance et vous semblez etre la bonne personne.", "lico_terpoitier",[(play_sound, "snd_maitre_guild"),]],
  
  [anyone|plyr ,"lico_terpoitier", [],  "Je hais les Anglois et les Bourgignons,je suis votre homme.", "lico_evail", []],
  [anyone|plyr ,"lico_terpoitier", [],  "Votre cause ne m'apporte rien,allez vous me payer pour ce travail?", "lico_evail", []],
  [anyone|plyr ,"lico_terpoitier", [],  "Qui etes vous Messire?", "lico_who", []],
  [anyone|plyr ,"lico_terpoitier", [],  "Toutes mes excuses,mais je suis épuisé par tous ces voyages,pouvons nous reprendre cette converssation plus tard?", "lico_bye", []],
  
  [anyone ,"lico_enedial", [],"Avez vous des questions?", "lico_terpoitier", []],
  
  
  [anyone ,"lico_who", [],"Je ne puis vous réveler mon identité,appellez moi la Licorne,comme tout les chefs que je recois.", "lico_enedial", []],
  
  
  [anyone ,"lico_bye", [],"Naturelement,je vous pris de m'excuser pour mon manque d'hospitalité,mais il va faloir que vous dormiez a la taverne.je ne puis receuillir un Rebelle connu dans mes appartements,cela faillirais a ma couverture,je vous souhaite tout de meme la bonne soiré.", "close_window", []],
  
  [anyone ,"lico_evail", [],"Naturelement je vous rénumererais en écus d'or pour chaques contrats que vous éffectuerez,a condition que vous remplissiez les objectifs définis par la mission.", "lico_rtquestone", []],
  
  [anyone|plyr ,"lico_rtquestone", [],  "Cela me conviens,quelle es la mission?", "lico_enassassina", []],
  [anyone|plyr ,"lico_rtquestone", [],  "J'ai besoin d'y réfléchir,je reviendrais plus tard.", "close_window", []],
  
  
  
  [anyone ,"lico_enassassina", [],"Les petits groupes de Rebelles que je souhaite rassembler,s'affaires a attaquer des convois,a détrousser des paysans Bourgignons,et a voler des paniers de repas.tout ceci ne nous ménera nule part.Il me faut fraper l'envahisseur plus durement,plus radicalement,toutes fois cette besogne es indigne d'un gentilhomme et contraire a l'esprit de chevalerie au quel j'adère.", "lico_enassassina2", []],
  
  [anyone|plyr ,"lico_enassassina2", [],  "Je crains le pire.", "lico_enassassina3", []],
  
  [anyone ,"lico_enassassina3", [],"Il me faut un assassin,quelqu'un cappable d'approcher l'ennemi d'assez pret pour pouvoir lui porter un coup fatal,quelqu'un de rusé et rompu au maniement des armes.mais en meme temp quelqu'un qui n'aspire pas a devenir Chevalier,en contrepartie vous menerez la belle vie avec ce que je vous versserais,qu'en dites vous?.", "lico_enassassina4", []],
  
  
  [anyone|plyr ,"lico_enassassina4", [],  "Je désire etre Chevalier,mais je vivrais avec ce fait,si c'est pour le bien de la France.", "lico_orgold", []],
  [anyone|plyr ,"lico_enassassina4", [],  "Seul l'or m'intérèsse...beaucoup d'or,je suis d'accord.", "lico_orgold", []],
  [anyone|plyr ,"lico_enassassina4", [],  "Je dois reffuser Messire,j'aspire moi meme a cet esprit de courtoisie et de respect envers mes ennemis.", "close_window", []],
  
  [anyone ,"lico_orgold", [],"Fort bien,la première cible es le comte de Caen.c'est un general tres actifs et répressif envers nos sujets francais dans les villes occupées,il nous faut nous débarasser de lui au plus vite,le roi lui meme désire sa mort ardament et secrétement.", "lico_assaenego",
    [
      ###########lancer mission comte de can ici et donner fausse invitation
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Licorne m'a demandé d'assassiner des personnages importants ou des generaux ennemis pour le bien de la cause,je doit le débarasser du comte de Caen en premier.il me faut remettre la fausse invitation au banquet au garde de l'entré,et approcher le compte pour en finire."),
      (call_script, "script_start_quest", "qst_rebel_assas_comtcaen", "$g_talk_troop"),
  ]],
  
  [anyone ,"lico_assaenego", [],"Il donne en ce moment meme et pour quelques jours un banquet au chateau ducale de Caen,voici une fausse invitation a donner aux gardes,avec le sceau du Comte lui meme confectionée par nos scribes.allez au chateau,mellez vous aux invités,et trouvez un moyen de nous débarasser de ce personnage.", "lico_assaenegod",
    [
      ###########donner fausse invitation
      (troop_add_item, "trp_player","itm_plis_caen",0),
  ]],
  [anyone ,"lico_assaenegod", [],"Une fois le comte mort,sautez dans la rue en contrebas,et rejoignez le Rebelle qui devra vous faire sortir de la ville par des racourcis avant que la garde soie alertée,en suite quittez la ville.bonne chance mon ami,nous comptons sur vous.", "close_window",[]],
  
  
  
  #######1er dial gorlicorn####################################################################################################################################
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rebel_licorn"),
      (eq, "$redialmetlicorn", 0),
    ],
    "Salutations,vous voila enfin a Poitier mon ami.les différents chefs Rebelles m'on compté votre dévotion a notre cause.j'ai besoin de quelqu'un de compétent pour une mission de la plus haute importance et vous semblez etre la bonne personne.", "lico_encounterpoitier",
    [
      ##mission accomplie et end "rencontrer licorne"
      (call_script, "script_succeed_quest", "qst_rebel_shearchlico"),
      (call_script, "script_end_quest", "qst_rebel_shearchlico"),
  ]],
  
  [anyone|plyr ,"lico_encounterpoitier", [],  "Je hais les Anglois et les Bourgignons,je suis votre homme.", "lico_encounoktravail", []],
  [anyone|plyr ,"lico_encounterpoitier", [],  "Votre cause ne m'apporte rien,allez vous me payer pour ce travail?", "lico_encounoktravail", []],
  [anyone|plyr ,"lico_encounterpoitier", [],  "Qui etes vous Messire?", "lico_encowho", []],
  [anyone|plyr ,"lico_encounterpoitier", [],  "Toutes mes excuses,mais je suis épuisé par tous ces voyages,pouvons nous reprendre cette converssation plus tard?", "lico_encobye", []],
  
  [anyone ,"lico_encopredial", [],"Avez vous des questions?", "lico_encounterpoitier", []],
  
  
  [anyone ,"lico_encowho", [],"Je ne puis vous réveler mon identité,appellez moi la Licorne,comme tout les chefs que je recois.", "lico_encopredial", []],
  
  
  [anyone ,"lico_encobye", [],"Naturelement,je vous pris de m'excuser pour mon manque d'hospitalité,mais il va faloir que vous dormiez a la taverne.je ne puis receuillir un Rebelle connu dans mes appartements,cela faillirais a ma couverture,je vous souhaite tout de meme la bonne soiré.", "close_window",
    [
      (assign, "$redialmetlicorn", 1),
      (party_set_flags, "p_camp_ofrebels", pf_always_visible, 0),
      (party_set_flags, "p_camp_ofrebels", pf_disabled, 1),
  ]],
  
  [anyone ,"lico_encounoktravail", [],"Naturelement je vous rénumererais en écus d'or pour chaques contrats que vous éffectuerez,a condition que vous remplissiez les objectifs définis par la mission.", "lico_encostartquestone", []],
  
  [anyone|plyr ,"lico_encostartquestone", [],  "Cela me conviens,quelle es la mission?", "lico_encostartassassina", []],
  [anyone|plyr ,"lico_encostartquestone", [],  "J'ai besoin d'y réfléchir,je reviendrais plus tard.", "close_window",
    [
      (assign, "$redialmetlicorn", 1),
      (party_set_flags, "p_camp_ofrebels", pf_always_visible, 0),
      (party_set_flags, "p_camp_ofrebels", pf_disabled, 1),
  ]],
  
  
  
  [anyone ,"lico_encostartassassina", [],"Les petits groupes de Rebelles que je souhaite rassembler,s'affaires a attaquer des convois,a détrousser des paysans Bourgignons,et a voler des paniers de repas.tout ceci ne nous ménera nule part.Il me faut fraper l'envahisseur plus durement,plus radicalement,toutes fois cette besogne es indigne d'un gentilhomme et contraire a l'esprit de chevalerie au quel j'adère.", "lico_assasinpire", []],
  
  [anyone|plyr ,"lico_assasinpire", [],  "Je crains le pire.", "lico_assasinpire2", []],
  
  [anyone ,"lico_assasinpire2", [],"Il me faut un assassin,quelqu'un cappable d'approcher l'ennemi d'assez pret pour pouvoir lui porter un coup fatal,quelqu'un de rusé et rompu au maniement des armes.mais en meme temp quelqu'un qui n'aspire pas a devenir Chevalier,en contrepartie vous menerez la belle vie avec ce que je vous versserais,qu'en dites vous?.", "lico_assasinquestion", []],
  
  
  [anyone|plyr ,"lico_assasinquestion", [],  "Je désire etre Chevalier,mais je vivrais avec ce fait,si c'est pour le bien de la France.", "lico_okforgold", []],
  [anyone|plyr ,"lico_assasinquestion", [],  "Seul l'or m'intérèsse...beaucoup d'or,je suis d'accord.", "lico_okforgold", []],
  [anyone|plyr ,"lico_assasinquestion", [],  "Je dois reffuser Messire,j'aspire moi meme a cet esprit de courtoisie et de respect envers mes ennemis.", "close_window",
    [
      (assign, "$redialmetlicorn", 1),
      (party_set_flags, "p_camp_ofrebels", pf_always_visible, 0),
      (party_set_flags, "p_camp_ofrebels", pf_disabled, 1),
  ]],
  
  [anyone ,"lico_okforgold", [],"Fort bien,la première cible es le comte de Caen.c'est un general tres actifs et répressif envers nos sujets francais dans les villes occupées,il nous faut nous débarasser de lui au plus vite,le roi lui meme désire sa mort ardament et secrétement.", "lico_assasokgenego",
    [
      ###########lancer mission comte de caen ici et donner fausse invitation
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Licorne m'a demandé d'assassiner des personnages importants ou des generaux ennemis pour le bien de la cause,je doit le débarasser du comte de Caen en premier.il me faut remettre la fausse invitation au banquet au garde de l'entré,et approcher le compte pour en finire."),
      (call_script, "script_start_quest", "qst_rebel_assas_comtcaen", "$g_talk_troop"),
  ]],
  
  [anyone ,"lico_assasokgenego", [],"Il donne en ce moment meme et pour quelques jours un banquet au chateau ducale de Caen,voici une fausse invitation a donner aux gardes,avec le sceau du Comte lui meme confectionée par nos scribes.allez au chateau,mellez vous aux invités,et trouvez un moyen de nous débarasser de ce personnage.", "lico_assasokgenego2",
    [
      ###########donner fausse invitation
      (troop_add_item, "trp_player","itm_plis_caen",0),
  ]],
  [anyone ,"lico_assasokgenego2", [],"Une fois le comte mort,sautez dans la rue en contrebas,et rejoignez le Rebelle qui devra vous faire sortir de la ville par des racourcis avant que la garde soie alertée,en suite quittez la ville,bonne chance mon ami,nous comptons sur vous.", "close_window",
    [
      (party_set_flags, "p_camp_ofrebels", pf_always_visible, 0),
      (party_set_flags, "p_camp_ofrebels", pf_disabled, 1),
  ]],
  
  #BANDITS DE VILANDRANDRO CATACOMBES DE PARIS ################################################
  ################################################################################################
  #vilain
  [anyone,"start", [(eq, "$g_talk_troop", "trp_cata_vilain1"),
    ],
    "Je lève mon verre a notre auguste invité,quelles sont les nouvelles du front sire?", "vilain_start", []],
  
  [anyone|plyr ,"vilain_start", [],  "Pardon?", "vilain_start2", []],
  [anyone ,"vilain_start2", [],"Je me foutais de toi,c'est comme ca qu'ils parlent la haut,ou y'a des trucs a prendre je veux dire,les bourgeois anglois quois.", "vilain_start3", []],
  
  [anyone|plyr ,"vilain_start3", [],  "N'avez vous point de remorts a détrousser autruis?", "vilain_start4", []],
  [anyone|plyr ,"vilain_start3", [],  "Je me disais aussi.", "close_window", []],
  
  [anyone ,"vilain_start4", [],"Vous entendez vous autres? ce crétin veux me faire la morale.écoute bien.ce que Je n'ai pas et que les autres ont encore je le prendrais demain,c'est notre devise ici bas.", "close_window", []],
  
  #cata ribaude
  [anyone,"start", [(eq, "$g_talk_troop", "trp_cata_ribaude1"),
    ],
    "Qu'es c'que tu regarde comme ca?", "catrib_stat", []],
  
  [anyone|plyr ,"catrib_stat", [],  "Je me demandais si tu...et bien....", "catrib_statno", []],
  [anyone|plyr ,"catrib_stat", [],  "Que fait une fille comme toi dans cet endroit? veux tu que je te fasse sortire d'ici?.", "catrib_statpriso", []],
  [anyone|plyr ,"catrib_stat", [],  "Rien du tout.", "close_window", []],
  
  [anyone ,"catrib_statno", [],"Uniquement avec Messire Villandrandro,t'as compris? alors passe ton chemin.", "catrib_stat", []],
  [anyone ,"catrib_statpriso", [],"Tu veux rire? la haut il y a la guerre et la famine,ici je vie comme une reine.je suis plus riche que la femme du Duc de Bourgogne.en échange de tout ca j'en es rien a foutre de plus voir le soleil.", "close_window", []],
  
  
  #garde vilandr
  [anyone,"start", [(eq, "$g_talk_troop", "trp_cata_gard2"),
    ],
    "Fait attention,surveille tes gestes qu'on ne les prenne pas pour une attaque envers Messire Villandrandro.", "catta_guardd", []],
  
  [anyone|plyr ,"catta_guardd", [],  "Tu devrais boire et te détendre,personne ne veux tuer ton chef.", "close_window", []],
  
  #garde vilandr2
  [anyone,"start", [(eq, "$g_talk_troop", "trp_cata_gard1"),
    ],
    "Qu'es c'que tu veux?", "catta_guardd22", []],
  
  [anyone|plyr ,"catta_guardd22", [],  "J'admirais ton visage.", "close_window", []],
  
  
  
  #guide entree
  [anyone,"start", [(eq, "$g_talk_troop", "trp_parisvilan_guide"),
    ],
    "Qu'es c'qui y as,t'as vue un fantome?", "guid_tivilandrro", []],
  
  [anyone|plyr ,"guid_tivilandrro", [],  "Ouvre moi,il parait que le chef a du travail pour moi.", "guid_tivilandrroexitwork", []],
  [anyone|plyr ,"guid_tivilandrro", [],  "Fait moi sortire d'ici.", "guid_tivilandrroexit", []],
  [anyone|plyr ,"guid_tivilandrro", [],  "Tres drole,vraiment...", "close_window", []],
  
  [anyone ,"guid_tivilandrroexitwork", [],"Ca va,tu peut passer.prépare toi a rencontrer Messire Villandrandro.", "close_window",
    [
      (jump_to_menu, "mnu_repaire_vilandr"),#passer par menu
      (finish_mission),
  ]],
  
  [anyone ,"guid_tivilandrroexit", [],"Mais bien sur duchésse,Bertrand va tout de suite monter tous les escaliers pour vous ouvrire la porte.c'est la dernière fois que tu me fait monter vilain.", "close_window",
    [
      (try_begin),
        (this_or_next|player_has_item,"itm_torch"),
        (troop_has_item_equipped,"trp_player","itm_torch"),
        (troop_remove_item, "trp_player","itm_torch"),
      (try_end),
      (jump_to_menu, "mnu_town"),
      (finish_mission),
  ]],
  
  #recruteur st julien /passage quartier/cata
  #de retour
  [anyone,"start", [(eq, "$g_talk_troop", "trp_parisvilan_entry"),
      (eq, "$droitpassercatac", 1),
    ],
    "Qu'es c'qu il y a soldat? je n'offre pas mes charmes si c'est ce que tu veux.", "passvin_to_catacomb", []],
  
  [anyone|plyr ,"passvin_to_catacomb", [],  "Enmène moi plutot aux catacombes.", "passvin_to_catacomb2", []],
  [anyone|plyr ,"passvin_to_catacomb", [],  "Tu es vraiment trop laid je préfère une femme qui enpéste la porcherie.", "close_window", []],
  
  [anyone ,"passvin_to_catacomb2", [],"T'en as assez du soleil? tres bien,suis moi et tu connais la régle,met ce sac sur ta tete.", "close_window",
    [
      (troop_add_item, "trp_player", "itm_torch", 0),
      (jump_to_menu, "mnu_catacomb_arived"),
      (finish_mission),
  ]],
  
  #1er dial
  [anyone,"start", [(eq, "$g_talk_troop", "trp_parisvilan_entry"),
    ],
    "Soldat,approche un peut par ici...", "vilain_to_catacomb", []],
  
  [anyone|plyr ,"vilain_to_catacomb", [],  "Si tu veux de l'or,je n'en es pas.", "vilain_to_catacomb2", []],
  [anyone|plyr ,"vilain_to_catacomb", [],  "Non,tu sens trop les ennuis.", "close_window", []],
  
  [anyone ,"vilain_to_catacomb2", [],"Non,tu te trompe,je ne veux pas prendre ton or mais t'en donner au contraire.", "vilain_to_catacomb3", []],
  
  [anyone|plyr ,"vilain_to_catacomb3", [],  "Une oeuvre de charité?", "vilain_to_catacomb4", []],
  
  [anyone ,"vilain_to_catacomb4", [],"C'es exactement ca...en quelque sorte,on cherche moi et quelques braves personnes quelqu'un qui aurais les mains agiles et qui coure vite en cas de problème.", "vilain_to_catacomb5", []],
  
  
  [anyone|plyr ,"vilain_to_catacomb5", [],  "J'ai besoin d'argent,dit m'en plus a tout hasard.", "vilain_to_catacomb6", []],
  # [anyone|plyr ,"dial_camp_base_13", [],  "Je ne suis pas un voleur,va t'en.", "close_window", []],
  
  [anyone ,"vilain_to_catacomb6", [],"Comme tout le monde,on t'en dira plus si tu me suis,je me sens mieux que dans le repaire,j'aime pas trainer dans la rue.", "vilain_to_catacomb7", []],
  
  [anyone|plyr ,"vilain_to_catacomb7", [],  "Si ce n'es que pour parler,on vera par la suite.", "vilain_to_catacombok",
    [
      (troop_add_item, "trp_player", "itm_torch", 0),
  ]],
  [anyone|plyr ,"vilain_to_catacomb7", [],  "Si tu pensse que je vais te suivre jusqu'a ton lieu d'ambuscade,va t'en.", "close_window", []],
  
  [anyone ,"vilain_to_catacombok", [],"Enfin,j'ai mis du temp a trouver quelqu'un...prend cette torche,t'en aura besoin la ou on va,et tant qu'on te connais pas on fera le trajet avec ce sac sur ta tete,hors de question que tu revienne plus tard avec la garde,une fois la bas,t'auras qu'a descendre jusqu'a ce que tu rencontre le chef.on y va...", "close_window",
    [
      (jump_to_menu, "mnu_catacomb_arived"),
      (finish_mission),
      #assigner variable prochain dialogue
      (assign, "$droitpassercatac", 1),
  ]],
  
  ####################################################################################################################
  ####################################################################################################################rododo
  
  
  
  #dernier dial end et fausse lettre de recomandation
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rodrigo_villandrandro"),
      (eq, "$findedialavecrodrig", 1),
    ],
    "Que veux tu ?", "fend_dialrodrigg", []],
  [anyone|plyr ,"fend_dialrodrigg", [],  "Pouvez vous fabriquer de faux documents?", "faux_docsstart",[]],
  [anyone|plyr ,"fend_dialrodrigg", [],  "J'ai besoin d'or encore une fois.", "fend_dialrodriggenco",[]],
  [anyone|plyr ,"fend_dialrodrigg", [],  "Rien, j'ai mieux a faire que de respirer les moisissures.", "close_window",[]],
  
  [anyone ,"fend_dialrodriggenco", [],"Non,il n'y a plus rien pour toi, ta tete es connue, il me faut du sang neuf.", "close_window",[]],
  
  [anyone ,"faux_docsstart", [],"Bien sur, mais il te faudras en payer le prix fort, a quois pensse tu?.", "faux_docsstart2",[]],
  #ajouter possibles faux documents ICI !!!!!!!
  [anyone|plyr ,"faux_docsstart2", [],  "J'aspire a devenire Chevalier, mais il me faut une lettre de recomandation, et...", "faux_docsstart2ok",[]],
  
  [anyone ,"faux_docsstart2ok", [],"Du Duc de Provence, ca iras ? ca te couteras 4 000 écus, mais avec ta future situation tu en gagnera bien plus.marché conclue ?", "faux_docsstart2conc",[]],
  
  
  [anyone|plyr ,"faux_docsstart2conc",
    [
      #si j'ai l or
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 4000),
    ],
    "C'est entendue.", "faux_docsstart2concpay",
    [
      #remove or
      (troop_remove_gold,"trp_player",4000),
  ]],
  [anyone|plyr ,"faux_docsstart2conc", [],  "Je devrais bien pouvoir l'aquerire honnetement, j'y renonce.", "close_window",[]],
  
  [anyone ,"faux_docsstart2concpay", [],"Voila, tu te doute que tu n'es pas le seul a faire ce genre de demandes, mon coffre en es plein.toutes ces lettres sont signées et porte le sceau du Duc, ca n'as pas été facile, mais je savais bien que cela me rapporterais.", "close_window",
    [
      (troop_add_item, "trp_player", "itm_plis_recomandation", 0),
  ]],
  
  ############
  #win
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rodrigo_villandrandro"),
      (player_has_item, "itm_medaille"),
      (neg|check_quest_failed, "qst_kill_mathieu"),
    ],
    "Alors? Nous as tu vengés ?", "attent_winoffarmer", []],
  
  [anyone|plyr ,"attent_winoffarmer", [],  "Oui,ca n'a pas été facile mais lui et sa femme sont morts, voila sa médaille.", "attent_winoffarmer2",
    [
      (troop_remove_item, "trp_player","itm_medaille"),
  ]],
  [anyone ,"attent_winoffarmer2", [],"C'est parfait, une bonne chose de reglée, tiens voila ton or, je vais m'endormir plus facilement maintenant.", "close_window",
    [
      (call_script, "script_end_quest", "qst_kill_mathieu"),
      (call_script, "script_troop_add_gold", "trp_player", 600),
      (assign, "$findedialavecrodrig", 1),
      (party_set_flags, "p_fermemat", pf_always_visible, 0),
      (party_set_flags, "p_fermemat", pf_disabled, 1),
  ]],
  
  
  #fail/win
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rodrigo_villandrandro"),
      (check_quest_failed, "qst_kill_mathieu"),
      (neg|check_quest_succeeded, "qst_kill_mathieu"),
      (neg|check_quest_finished, "qst_kill_mathieu"),
    ],
    "Alors? Nous as tu vengés ?", "attent_defaitefarmer", []],
  
  [anyone|plyr ,"attent_defaitefarmer", [],  "Il se trouve qu'il etait armé d'une arbalete et avais des gardes du corp,Je n'ai put...", "attent_defaitefarmer2", []],
  [anyone ,"attent_defaitefarmer2", [],"Quois? c'est un simple paysan bléssé plein de douleurs, t'es vraiment qu'une merde, hors d'ici.", "close_window",
    [
      (assign, "$findedialavecrodrig", 1),
      (party_set_flags, "p_fermemat", pf_always_visible, 0),
      (party_set_flags, "p_fermemat", pf_disabled, 1),
  ]],
  
  
  
  #en attente
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rodrigo_villandrandro"),
      (check_quest_active, "qst_kill_mathieu"),
      (neg|check_quest_succeeded, "qst_kill_mathieu"),
      (neg|check_quest_failed, "qst_kill_mathieu"),
      (neg|check_quest_finished, "qst_kill_mathieu"),
    ],
    "Alors? tu as du...travail, non?", "attent_killmat", []],
  
  [anyone|plyr ,"attent_killmat", [],  "Je sais, je m'en occupe", "close_window", []],
  [anyone|plyr ,"attent_killmat", [],  "Je ne veux pas tuer un homme qui ne m'as rien fait, j'y renonce.", "attent_killmat2", []],
  [anyone ,"attent_killmat2", [],"Espèce de simplet, fout le camp alors.", "close_window",
    [
      (call_script, "script_fail_quest", "qst_kill_mathieu"),
      (call_script, "script_end_quest", "qst_kill_mathieu"),
      (party_set_flags, "p_fermemat", pf_always_visible, 0),
      (party_set_flags, "p_fermemat", pf_disabled, 1),
      (assign, "$findedialavecrodrig", 1),
      
  ]],
  
  #si plus de medaille
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rodrigo_villandrandro"),
      (check_quest_active, "qst_kill_mathieu"),
    ],
    "Alors? tu as du...travail, non?", "attent_killmats", []],
  
  [anyone|plyr ,"attent_killmats", [],  "Je sais, je m'en occupe", "close_window", []],
  [anyone|plyr ,"attent_killmats", [],  "Je ne veux pas tuer un homme qui ne m'as rien fait, j'y renonce.", "attent_killmat2d", []],
  [anyone ,"attent_killmat2d", [],"Espèce de simplet, fout le camp alors.", "close_window",
    [
      (call_script, "script_fail_quest", "qst_kill_mathieu"),
      (call_script, "script_end_quest", "qst_kill_mathieu"),
      (party_set_flags, "p_fermemat", pf_always_visible, 0),
      (party_set_flags, "p_fermemat", pf_disabled, 1),
      (assign, "$findedialavecrodrig", 1),
  ]],
  
  
  
  #derniere quete
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rodrigo_villandrandro"),
      (eq, "$dernierefingancata", 1),
    ],
    "Viens plus pret, j'ai quelque chose a te demander.", "assacata_roddig", []],
  
  [anyone|plyr ,"assacata_roddig", [],  "Qui a t'il?", "assacata_roddigwtoui", []],
  [anyone|plyr ,"assacata_roddig", [],  "Non, je n'aime pas ca,adieu.", "close_window", []],
  [anyone ,"assacata_roddigwtoui", [],"Quelqu'un m'a vendue, une personne qui travaillais pour moi comme tu le fais a cet instant, je veux la tete de ce judas,je te la paye 600 écus, tu es partant?", "assacata_roddigwtouiou",[]],
  
  [anyone|plyr ,"assacata_roddigwtouiou", [],  "Pour 600 écus? soit...", "assacata_roddigwtouiouok", []],
  [anyone|plyr ,"assacata_roddigwtouiou", [],  "Non...", "close_window", []],
  
  [anyone ,"assacata_roddigwtouiouok", [],"Ce fils de pute s'es refait une vie avec l'or que ma tete lui a apporté,il a une ferme et une famille, il s'es installé prés du village de Rennes,son surnom c'est Mathieu le fileux, retrouve le la bas et fait lui la peau.ramène moi la médaille qu'il porte autour du coup pour preuve et tu sera payé.", "assacata_roddigwtoudepart",[]],
  
  [anyone|plyr ,"assacata_roddigwtoudepart", [],  "D'accord.", "close_window",
    [
      #start quete montrer partie ferme
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Villandrandro m'as comandé de tuer un traitre du surnom de Mathieu le fileux, je le trouverais a la ferme ou il s'es établis pres de Rennes."),
      (call_script, "script_start_quest", "qst_kill_mathieu", "$g_talk_troop"),
      (party_set_flags, "p_fermemat", pf_disabled, 0),
      (party_set_flags, "p_fermemat", pf_always_visible, 1),
      (party_set_flags, "p_fermemat", pf_quest_party, 1),
  ]],
  [anyone|plyr ,"assacata_roddigwtoudepart", [],  "Je ne peut pas faire ca, il a une famille.", "close_window", []],
  
  #fail/win
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rodrigo_villandrandro"),
      (eq, "$okmarchparisforge", 1),
      (eq, "$okmarchparisarm", 1),
      (eq, "$okmarchparisgross", 1),
      (check_quest_active, "qst_extorsion"),
      (neg|check_quest_succeeded, "qst_extorsion"),
      (neg|check_quest_failed, "qst_extorsion"),
      (neg|check_quest_finished, "qst_extorsion"),
    ],
    "Tu as l'or des marchands? je m'inpatiente.", "attent_marchandextorfon", []],
  
  [anyone|plyr ,"attent_marchandextorfon",
    [
      #si j'ai la somme!
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 900),
    ]
    ,  "Voila l'or,il fallait me faire confiance.", "attent_marchandextorfonok",
    [
      #remove or mission accomplie et end
      (troop_remove_gold,"trp_player",900),
      (call_script, "script_succeed_quest", "qst_extorsion"),
      (call_script, "script_end_quest", "qst_extorsion"),
      
  ]],
  [anyone ,"attent_marchandextorfonok", [],"C'est un mot que je ne connais pas, soit tout es la, voila ta part tu peut partire maintenant.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 200),
      (assign, "$dernierefingancata", 1),
  ]],
  [anyone|plyr ,"attent_marchandextorfon", [],  "Je l'es perdu,mais je vais la remplacer je le jure.", "attent_marchandextorfonjugr", []],
  [anyone ,"attent_marchandextorfonjugr", [],"Ca ne va pas du tout ca. tu as trois jours pour trouver 900 écus, tu entend? sans ca je lache mes chien aprés toi, Va maintenant...", "close_window",
    [
      #lancer quete au bout de deux jours sinon scripter une troupe apres moi !!!!!!! variable pour dial a part??? racorder le dialogue tot ou tard avec derniere mission
  ]],
  
  #en attente
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rodrigo_villandrandro"),
      (check_quest_active, "qst_extorsion"),
      (neg|check_quest_succeeded, "qst_extorsion"),
      (neg|check_quest_failed, "qst_extorsion"),
      (neg|check_quest_finished, "qst_extorsion"),
    ],
    "Tu as l'or des marchands? qu'attend tu dans ce cas ?", "attent_marchandextor", []],
  
  [anyone|plyr ,"attent_marchandextor", [],  "C'est justement pour cela que je suis a Paris,je voullais vous le faire savoir.", "close_window", []],
  [anyone|plyr ,"attent_marchandextor", [],  "Je ne veux pas devenire un paria, je reffuse.", "attent_marchandextorno", []],
  [anyone ,"attent_marchandextorno", [],"Tache de ne pas me désobéire,je peut envoyer mes chiens te traquer si tu ne collabore point,rappelle toi en.", "close_window",
    [
      #fail
      (call_script, "script_fail_quest", "qst_extorsion"),
      (call_script, "script_end_quest", "qst_extorsion"),
      (assign, "$dernierefingancata", 1),
  ]],
  
  #prochaine mission rodrigo
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rodrigo_villandrandro"),
      (eq, "$autrequetebrigancata", 1),
    ],
    "Tiens, mais c'est notre apprentis voleur.tu tombe bien je viens de me rappeller que plus personne ne s'occupe de récolter les recettes auprés des marchands de Paris,tu pourais t'en occuper,tu en recevra un pourcentage en retour,qu'en dit tu?", "exto_paris", []],
  
  [anyone|plyr ,"exto_paris", [],  "Quelles recettes?", "exto_pariswt", []],
  [anyone|plyr ,"exto_paris", [],  "Non,pas maintenant.", "close_window", []],
  
  [anyone ,"exto_pariswt", [],"Ce que nous doivent les marchands en échange de notre protection,tu n'as qu'a aller les voir et leur dire qu'ils n'ont pas payé leur du.", "exto_pariswt2",[]],
  
  [anyone|plyr ,"exto_pariswt2", [],  "Si je peut gagner quelque chose en retour, ca semble facile.", "exto_pariswtstar",
    [
      #start quest
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Villandrandro m'as chargé de récolter l'argent qu'il extorque aux marchands de Paris,je doit aller voir le forgeron,l'armurier et le grossiste, et revenire voir Villandrandro avec la somme."),
      (call_script, "script_start_quest", "qst_extorsion", "$g_talk_troop"),
  ]],
  [anyone|plyr ,"exto_pariswt2", [],  "Non,je ne ferais pas ca, adieu.", "close_window",
    [
      (assign, "$dernierefingancata", 1),
  ]],
  
  #
  
  [anyone ,"exto_pariswtstar", [],"On ne peut plus simple,va voir le forgeron,l'armurier et le grossiste,dit leur de payer et fait leur peur si il refuse.etre brutal et rustre, je pensse que c'est a ta porté.", "close_window",[]],
  
  #####################################################cambriolage chateau
  
  #win/fail
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rodrigo_villandrandro"),
      (player_has_item, "itm_chevaliere"),
      (check_quest_active, "qst_cambriolage_chateau"),
      (neg|check_quest_finished, "qst_cambriolage_chateau"),
      (neg|check_quest_succeeded, "qst_cambriolage_chateau"),
      (neg|check_quest_failed, "qst_cambriolage_chateau"),
    ],
    "As tu le bijoux?", "bijchev_star",[]],
  
  [anyone|plyr ,"bijchev_star", [],  "Le voila,il m'a couté bien plus que si je l'avais aqueris honnetement.", "bijchev_starrem",
    [
      #succed et end quest remove chevaliere
      (call_script, "script_succeed_quest", "qst_cambriolage_chateau"),
      (call_script, "script_end_quest", "qst_cambriolage_chateau"),
      (troop_remove_item, "trp_player","itm_chevaliere"),
  ]],
  [anyone ,"bijchev_starrem", [],"Oui! c'est bien lui,magnifique.voila tes 1000 écus,Villandrandro tiens toujours parole.reviens me voir si tu as besoin d'or,j'aurais certainement quelque chose pour toi.", "bijchev_starremnext", []],
  [anyone|plyr ,"bijchev_starremnext", [],  "Nous verons cela.", "close_window",
    [
      (assign, "$autrequetebrigancata", 1),
  ]],
  
  #en attente retour cambriolage chateau
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rodrigo_villandrandro"),
      (check_quest_active, "qst_cambriolage_chateau"),
      (neg|check_quest_succeeded, "qst_cambriolage_chateau"),
      (neg|check_quest_failed, "qst_cambriolage_chateau"),
      (neg|check_quest_finished, "qst_cambriolage_chateau"),
    ],
    "J'éspère que nu te presente pas devans moi sans le bijoux.", "bijou_attente", []],
  
  [anyone|plyr ,"bijou_attente", [],  "Je suis sur cette affaire.", "close_window", []],
  [anyone|plyr ,"bijou_attente", [],  "Je ne peut pas devenire l'ennemi de la France,j'y renonce.", "bijou_attno", []],
  [anyone ,"bijou_attno", [],"Il en es tout autre de devenire mon ennemi,tu l'apprendra a tes dépends.maintenant va fils de la honte.", "close_window",
    [
      #fail
      (call_script, "script_fail_quest", "qst_cambriolage_chateau"),
      (call_script, "script_end_quest", "qst_cambriolage_chateau"),
      (assign, "$autrequetebrigancata", 1),
  ]],
  
  # win avec cle
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rodrigo_villandrandro"),
      (player_has_item, "itm_cle_2"),
      #(check_quest_finished, "qst_rodrig_vol_cle"),
      (check_quest_succeeded, "qst_rodrig_vol_cle"),
      (neg|check_quest_failed, "qst_rodrig_vol_cle"),
    ],
    "Alors,et cette clé?", "cata_aveccle",[]],
  
  [anyone|plyr ,"cata_aveccle", [],  "La voila.", "cata_aveccle2",
    [
      #end quest
      (call_script, "script_end_quest", "qst_rodrig_vol_cle"),
  ]],
  [anyone ,"cata_aveccle2", [],"Parfait,garde la,c'etait un test.je voulais voir si tu avais un minimum de cran.cette clé mon garcon ouvre un coffre dans un chateau de Tours,des bijoux et autres pièces de valeure sont entreposées la bas,raméne moi une bague en or certie d'une pierre bleue,si tu reviens avec,je te l'achéte 1000 écus.qu'en dit tu?", "cata_aveccle2camb",[]],
  [anyone|plyr ,"cata_aveccle2camb", [],  "J'en dit qu'elle vaut bien plus que ca.", "cata_aveccle2camb2",[]],
  
  [anyone ,"cata_aveccle2camb2", [],"Bien sure,mais qu'en ferais tu? c'est un bijoux tres connu en France,je ne peut le revendre qu'a mes seuls contacts toi tu te fera areter avec et finira tes jours en prison.si tu es d'accord,garde la clé du coffre et rend toi au quartier du vieux chateau a Tours,trouve un moyen de pénetrer dans la salle des coffre et ramene moi la bague.", "cata_aveccle2camb23",[]],
  [anyone|plyr ,"cata_aveccle2camb23", [],  "C'est d'accord,je pensse ariver a ne pas me faire prendre.personne ne saura que c'est moi qui es fait le coup.", "cata_aveccle2camstart",
    [
      #start nouvelle quete
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Villandrandro veux que je vole une bague dans la salle des coffres d'un vieux chateau a Tours,je devrais faire attention a ne pas me faire prendre ou le Royaume de France ne me le pardonera jamais."),
      (call_script, "script_start_quest", "qst_cambriolage_chateau", "$g_talk_troop"),
  ]],
  [anyone ,"cata_aveccle2camstart", [],"A la bonne heure,mes prieres t'accompagnent comme disent les jesuites.", "close_window",[]],
  [anyone|plyr ,"cata_aveccle2camb23", [],  "Je doit y réflèchire.", "close_window",[]],
  
  
  # win mais plus de cle
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rodrigo_villandrandro"),
      # (check_quest_finished, "qst_rodrig_vol_cle"),
      (check_quest_succeeded, "qst_rodrig_vol_cle"),
      (neg|check_quest_failed, "qst_rodrig_vol_cle"),
    ],
    "Alors,et cette clé ?.", "cata_retourcleee", []],
  
  [anyone|plyr ,"cata_retourcleee", [],  "Je l'es pedue.", "cata_retourcleee2",[]],
  [anyone ,"cata_retourcleee2", [],"Et tu as perdue avec elle mon éstime et beaucoup d'or,va t'en maintenant vaut rien.", "close_window",
    [(assign, "$autrequetebrigancata", 1),]],
  
  
  #############################
  
  #en attente
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rodrigo_villandrandro"),
      (check_quest_active, "qst_rodrig_vol_cle"),
      (neg|check_quest_succeeded, "qst_rodrig_vol_cle"),
      (neg|check_quest_failed, "qst_rodrig_vol_cle"),
      (neg|check_quest_finished, "qst_rodrig_vol_cle"),
    ],
    "Qu'attend tu? mon signal?...signal...va t'en miserable.", "cata_ro", []],
  
  [anyone|plyr ,"cata_ro", [],  "Ah,tres bien,je....", "close_window", []],
  [anyone|plyr ,"cata_ro", [],  "Je ne peut pas faire ca,je laisse tomber.", "cata_rofail", []],
  [anyone ,"cata_rofail", [],"Alors dégage d'ici vaut rien.", "close_window",
    [
      #fail
      (call_script, "script_fail_quest", "qst_rodrig_vol_cle"),
      (call_script, "script_end_quest", "qst_rodrig_vol_cle"),
      (assign, "$autrequetebrigancata", 1),
  ]],
  
  #rodrigo de villandrandro
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rodrigo_villandrandro"),
    ],
    "Qu'avons nous la? approche,tu semble convenire a l'emploie.tu n'es pas malade au moin,et pensse tu etre assez habile?", "rodro_stratdialo", []],
  
  [anyone|plyr ,"rodro_stratdialo", [],  "Ca dépend,j'ai besoin d'or mais je ne veux tuer personne.", "rodro_stratdialo2", []],
  [anyone|plyr ,"rodro_stratdialo", [],  "Je ne m'engage pas avec des voleurs,adieu.", "close_window", []],
  
  [anyone ,"rodro_stratdialo2", [],"Tu n'auras pas besoin de tuer,si tu es assez agile et malin.j'ai besoin de quelqu'un qui sache faire les poches corectement et sans se faire prendre,il me faut une clé,cette clé es dans le manteau d'un noble et ce noble traine dans le bordel des quartiers chics,rend toi la bas et prend la lui,en suite ramène la moi tu sera payé dés que je l'aurais.", "rodro_stratdialochoi",[]],
  
  [anyone|plyr ,"rodro_stratdialochoi", [],  "Ca semble fesable,c'est d'accord,si j'ai l'or en retour.", "rodro_stratdialookstrat", []],
  [anyone|plyr ,"rodro_stratdialochoi", [],  "Pourquois n'envoyez vous pas un de vos hommes?", "rodro_stratdialowat", []],
  [anyone|plyr ,"rodro_stratdialochoi", [],  "Je regrète,je ne veux pas aller au cachot,adieu.", "close_window", []],
  
  [anyone ,"rodro_stratdialowat", [],"Mes gars sont trop connus,dés qu'un garde les appercevrons ils se retrouverons au cachots,il me faut du sang neuf.", "rodro_stratdialochoi",[]],
  
  [anyone ,"rodro_stratdialookstrat", [],"Tres bien,rend toi ce soir a la maison des deux Sirènes,débrouille toi pour approcher le Chambellan et prend lui cette clé,il la met toujours dans sa poche droite d'aprés mes gars...inutile de te dire de ne pas te saouler et de finire ta nuit dans un lit sans t'etre occupé de cette clé.et une dérnière chose,évite par dessus tout de me trahire.", "close_window",
    [
      #start quest brigand...et le reste
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Rodrigue de Villandrandro veux que je récupere pour lui une clé,je la trouverais dans la poche d'un Noble a Tours,a la maison des trois Sirènes.."),
      (call_script, "script_start_quest", "qst_rodrig_vol_cle", "$g_talk_troop"),
      
  ]],
  
  ############## dials trois sirenes
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sirene_1"),
    ],
    "Approchez mon ami,vous etstes ici chez vous.", "siren_drag1", []],
  
  [anyone|plyr ,"siren_drag1", [],  "Quelle grace Gente Dame,votre cou es luisant comme la plus belle des Soieries.", "siren_drag1cou", []],
  [anyone|plyr ,"siren_drag1", [],  "C'est un lieu de débauche et de pechés,je ne reste un instant de plus,adieu.", "close_window", []],
  
  [anyone ,"siren_drag1cou", [],"Vous me flattez Noble Sire,peut etre aurons nous l'occasion de reparler lorsque la nuit sera plus avancée.", "close_window",[]],
  
  [anyone|plyr ,"siren_drag1", [],  "Je léspère de tout coeur.", "close_window", []],
  
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sirene_2"),
    ],
    "N'este vous pas beau Chevalier,Messire le comte de Caen?", "siren_dragcaen", []],
  
  [anyone|plyr ,"siren_dragcaen", [],  "Si,c'est bien moi.", "siren_dragcaensi", []],
  [anyone|plyr ,"siren_dragcaen", [],  "Vous faites erreur Madame.", "close_window", []],
  
  
  [anyone ,"siren_dragcaensi", [],"J'ai une profonde admiration pour vostre Sire,permetez de vous rejoindre cette nuit.", "siren_dragcaensinuit",[]],
  
  [anyone|plyr ,"siren_dragcaensinuit", [],  "Je penssais plutot que le comte de Caen etait une brute qui affamais ses sujets.", "siren_dragcaensinuitno", []],
  [anyone|plyr ,"siren_dragcaensinuit", [],  "Ce serais mon plaisir Madame.", "close_window", []],
  
  [anyone ,"siren_dragcaensinuitno", [],"...", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sirene_3"),
    ],
    "Quelle belle personne,je suis en admiration Messire.", "siren_dragbours", []],
  
  [anyone|plyr ,"siren_dragbours", [],  "C'est une admiration partagée.", "close_window", []],
  [anyone|plyr ,"siren_dragbours", [],  "Ou peut etre en voulez vous a ma bourse.", "close_window", []],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sirene_client"),
    ],
    "Que voullez vous Messire,pourquois me parlez vous?", "siren_clien", []],
  
  [anyone|plyr ,"siren_clien", [],  "J'ai cru reconaitre quelqu'un.", "close_window", []],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sirene_4"),
    ],
    "Passez vous une bonne soirée mon tendre ami?", "siren_soir", []],
  
  [anyone|plyr ,"siren_soir", [],  "Nous verons.", "close_window", []],
  
  
  
  #retour
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sirene_chambellan"),
      (eq, "$chambellanretoursiren", 1),
    ],
    "Encore vous? que voullez vous?.", "siren_nextchance", []],
  
  [anyone|plyr ,"siren_nextchance", [],  "Chambellan,hum...Messire,je doit vous parler,c'est de la plus haute importance.", "siren_nextchance_dragcaensi", []],
  [anyone|plyr ,"siren_nextchance", [],  "Ou avez vous acheté ce manteau Messire? il m'irais bien.", "siren_chambellansoiez", []],
  [anyone|plyr ,"siren_nextchance", [],  "Pardonnez moi,je me suis trompé de personne.", "close_window", []],
  
  
  [anyone ,"siren_chambellansoiez", [],"Ca alors,quel toupet.j l'es fait faire a Paris,vous n'avez qu'a allez la bas,laissez nous maintenant.", "siren_chambellansoiestopz",[]],
  [anyone|plyr ,"siren_chambellansoiestopz", [],  "Quelle belle soierie,puis je la toucher?.", "siren_chambellannonoff", []],
  [anyone|plyr ,"siren_chambellansoiestopz", [],  "Bien,gardez vos adresses pour vous.", "close_window", []],
  
  [anyone ,"siren_chambellannonoff", [],"Certainement pas,allez vous en ou j'appelle la garde..", "close_window",[]],
  
  [anyone ,"siren_nextchance_dragcaensi", [],"Pourquois venire me voir ici,es ce a ce point urgent?", "siren_nextchance_dragcaensi2",[]],
  
  [anyone|plyr ,"siren_nextchance_dragcaensi2", [],  "Ca l'es mon seigneur,l'heure es grave.", "siren_nextchance_dragcaensi2no", []],
  [anyone|plyr ,"siren_nextchance_dragcaensi2", [],  "Non,cela atendra.finissez vos...affaires.", "close_window", []],
  
  [anyone ,"siren_nextchance_dragcaensi2no", [],"Non! assez de problèmes,qui a t'il encore? mais d'abord qui estes vous?", "siren_nextchance_dragcaensi2who",[]],
  
  [anyone|plyr ,"siren_nextchance_dragcaensi2who", [],  "Je suis envoyé par le roi,il veux que vous me suiviez tout de suite.", "siren_wrong2", []],
  [anyone|plyr ,"siren_nextchance_dragcaensi2who", [],  "Le scribe ne retrouve pas un document,il lui faut tout de suite.veuillez allez a votre cabinet maintenant.", "siren_wrong2", []],
  [anyone|plyr ,"siren_nextchance_dragcaensi2who", [],  "Vennez de suite a l'église avec moi,il vous faut vous conffesser sur le champ.", "siren_wrong2", []],
  [anyone|plyr ,"siren_nextchance_dragcaensi2who", [],  "Votre femme es souffrante,un terible accident mon Seigneur.", "siren_clear2", []],
  
  [anyone ,"siren_wrong2", [],"Qu'es ce que cette histoire? ca n'as pas de sens.", "siren_wrongaction2",[]],
  [anyone|plyr ,"siren_wrongaction2", [],  "(Mettre la main dans la poche du Chambellan.)", "siren_wrongactiondanger2", []],
  [anyone|plyr ,"siren_wrongaction2", [],  "(Vous enfuire.)", "close_window",
    [
      #jump menu town
      (jump_to_menu, "mnu_town"),
      (finish_mission),
  ]],
  
  [anyone ,"siren_wrongactiondanger2", [],"Qu'es ce que vous faites? AU VOLEUR! LA GARDE!.", "close_window",
    [
      #script prison,relation france -2
      (call_script, "script_change_player_relation_with_faction_ex", "fac_kingdom_1", -2),
      (jump_to_menu,"mnu_captivity_start_castle_defeat"),
      (finish_mission,0),
  ]],
  
  [anyone ,"siren_clear2", [],"Ho mon Dieu! es ce grave? je part sur le champ...", "siren_action_clear2",[]],
  [anyone|plyr ,"siren_action_clear2", [],  "(Mettre la main dans la poche du Chambellan.)", "close_window",
    [
      #donner la cl?mission accompli allez voir pour la recompensse,jump menu town
      (troop_add_item, "trp_player", "itm_cle_2", 0),
      (call_script, "script_succeed_quest", "qst_rodrig_vol_cle"),
      (jump_to_menu, "mnu_town"),
      (finish_mission),
  ]],
  [anyone|plyr ,"siren_action_clear2", [],  "Partire sans rien faire.", "close_window",
    [
      (jump_to_menu, "mnu_town"),
      (finish_mission),
  ]],
  
  #1ere tentative
  [anyone,"start", [(eq, "$g_talk_troop", "trp_sirene_chambellan"),
    ],
    "Qui as t'il? mais enfin que me voullez vous,parlez.", "siren_chambellanstart", []],
  
  [anyone|plyr ,"siren_chambellanstart", [],  "Chambellan,hum...Messire,je doit vous parler,c'est de la plus haute importance.", "siren_parlerimp", []],
  [anyone|plyr ,"siren_chambellanstart", [],  "Ou avez vous acheté ce manteau Messire? il m'irais bien.", "siren_chambellansoie", []],
  [anyone|plyr ,"siren_chambellanstart", [],  "Pardonnez moi,je me suis trompé de personne.", "close_window", [(assign, "$chambellanretoursiren", 1),]],
  
  
  
  [anyone ,"siren_chambellansoie", [],"Ca alors,quel toupet.j l'es fait faire a Paris,vous n'avez qu'a allez la bas,laissez nous maintenant.", "siren_chambellansoiestop",[]],
  [anyone|plyr ,"siren_chambellansoiestop", [],  "Quelle belle soierie,puis je la toucher?.", "siren_chambellannono", []],
  [anyone|plyr ,"siren_chambellansoiestop", [],  "Bien,gardez vos adresses pour vous.", "close_window", [(assign, "$chambellanretoursiren", 1),]],
  
  [anyone ,"siren_chambellannono", [],"Certainement pas,allez vous en ou j'appelle la garde..", "close_window",[(assign, "$chambellanretoursiren", 1),]],
  
  [anyone ,"siren_parlerimp", [],"Pourquois venire me voir ici,es ce a ce point urgent?", "siren_parlerimp2",[]],
  
  [anyone|plyr ,"siren_parlerimp2", [],  "Ca l'es mon seigneur,l'heure es grave.", "siren_parlerimp2gr", []],
  [anyone|plyr ,"siren_parlerimp2", [],  "Non,cela atendra.finissez vos...affaires.", "close_window", [(assign, "$chambellanretoursiren", 1),]],
  
  
  
  [anyone ,"siren_parlerimp2gr", [],"Non! assez de problèmes,qui a t'il encore? mais d'abord qui estes vous?", "siren_dragcaensiwho",[]],
  
  
  [anyone|plyr ,"siren_dragcaensiwho", [],  "Je suis envoyé par le roi,il veux que vous me suiviez tout de suite.", "siren_wrong", []],
  [anyone|plyr ,"siren_dragcaensiwho", [],  "Le scribe ne retrouve pas un document,il lui faut tout de suite.veuillez allez a votre cabinet maintenant.", "siren_wrong", []],
  [anyone|plyr ,"siren_dragcaensiwho", [],  "Vennez de suite a l'église avec moi,il vous faut vous conffesser sur le champ.", "siren_wrong", []],
  [anyone|plyr ,"siren_dragcaensiwho", [],  "Votre femme es souffrante,un terible accident mon Seigneur.", "siren_clear", []],
  
  [anyone ,"siren_wrong", [],"Qu'es ce que cette histoire? ca n'as pas de sens.", "siren_wrongaction",[]],
  [anyone|plyr ,"siren_wrongaction", [],  "(Mettre la main dans la poche du Chambellan.)", "siren_wrongactiondanger", []],
  [anyone|plyr ,"siren_wrongaction", [],  "(Vous enfuire.)", "close_window",
    [
      #jump menu town et assigner variable dial 2
      (assign, "$chambellanretoursiren", 1),
      (jump_to_menu, "mnu_town"),
      (finish_mission),
  ]],
  
  [anyone ,"siren_wrongactiondanger", [],"Qu'es ce que vous faites? AU VOLEUR! LA GARDE!.", "close_window",
    [
      #script prison/variable prochain dial,relation france -2
      (assign, "$chambellanretoursiren", 1),
      (call_script, "script_change_player_relation_with_faction_ex", "fac_kingdom_1", -2),
      (jump_to_menu,"mnu_captivity_start_castle_defeat"),
      (finish_mission,0),
  ]],
  
  [anyone ,"siren_clear", [],"Ho mon Dieu! es ce grave? je part sur le champ...", "siren_action_clear",[]],
  [anyone|plyr ,"siren_action_clear", [],  "(Mettre la main dans la poche du Chambellan.)", "close_window",
    [
      #donner la cl?mission accompli allez voir pour la recompensse,jump menu town
      (troop_add_item, "trp_player", "itm_cle_2", 0),
      (call_script, "script_succeed_quest", "qst_rodrig_vol_cle"),
      (jump_to_menu, "mnu_town"),
      (finish_mission),
  ]],
  [anyone|plyr ,"siren_action_clear", [],  "Partire sans rien faire.", "close_window",
    [
      #variable prochain dialog
      (assign, "$chambellanretoursiren", 1),
      (jump_to_menu, "mnu_town"),
      (finish_mission),
  ]],
  
  ##########################################CHATEAU TOURS
  
  #garde
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chateautours_7"),
    ],
    "Quois? que voullez vous?.", "chavienters",[]],
  [anyone|plyr ,"chavienters", [], "Je veux entrer.", "chavientersz",[]],
  [anyone|plyr ,"chavienters", [], "Rien,je m'en vais.", "close_window",[]],
  [anyone ,"chavientersz", [],"Fiche moi le camp,y'a rien pour toi ici.", "chavienterszfin",[]],
  
  [anyone|plyr ,"chavienterszfin", [], "Je n'ai pas de temp a perdre, (tirer son arme).", "close_window",
    [
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 1, 3, 0),
      (team_set_relation, 2, 1, 0),
      (team_set_relation, 2, 3, 0),
      (team_set_relation, 3, 1, 0),
      (team_set_relation, 3, 2, 0),
  ]],
  [anyone|plyr ,"chavienterszfin", [], "On vera.", "close_window",[]],
  
  #team3
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chateautours_6"),
    ],
    "Alerte! un intrus!.", "chavieu_troop7",
    [
      (team_set_relation, 0, 1, 1),
      (team_set_relation, 0, 2, 1),
      (team_set_relation, 0, 3, -1),
      (team_set_relation, 1, 0, 1),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 1, 3, 0),
      (team_set_relation, 2, 0, 1),
      (team_set_relation, 2, 1, 0),
      (team_set_relation, 2, 3, 0),
      (team_set_relation, 3, 0, -1),
      (team_set_relation, 3, 1, 0),
      (team_set_relation, 3, 2, 0),
  ]],
  
  [anyone|plyr ,"chavieu_troop7", [],  "Arierre!...", "close_window",[]],
  
  #team3
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chateautours_4"),
    ],
    "Alerte! un intrus!.", "chavieu_troop5",
    [
      #refaire equipes localis?s assigner variable si besoin ?
      (assign, "$premiernivchateau", 1),
      (team_set_relation, 0, 1, 1),
      (team_set_relation, 0, 2, 1),
      (team_set_relation, 0, 3, -1),
      (team_set_relation, 1, 0, 1),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 1, 3, 0),
      (team_set_relation, 2, 0, 1),
      (team_set_relation, 2, 1, 0),
      (team_set_relation, 2, 3, 0),
      (team_set_relation, 3, 0, -1),
      (team_set_relation, 3, 1, 0),
      (team_set_relation, 3, 2, 0),
  ]],
  
  [anyone|plyr ,"chavieu_troop5", [],  "Arierre!...", "close_window",[]],
  
  
  #team2
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chateautours_2"),
    ],
    "Alerte! un intrus dans l'enceinte du chateau!.", "chavieu_troop3",
    [
      (assign, "$deuxiemnivchateau", 1),
      (team_set_relation, 0, 1, 1),
      (team_set_relation, 0, 2, -1),
      (team_set_relation, 0, 3, 1),
      (team_set_relation, 1, 0, 1),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 1, 3, 0),
      (team_set_relation, 2, 0, -1),
      (team_set_relation, 2, 1, 0),
      (team_set_relation, 2, 3, 0),
      (team_set_relation, 3, 0, 1),
      (team_set_relation, 3, 1, 0),
      (team_set_relation, 3, 2, 0),
  ]],
  
  [anyone|plyr ,"chavieu_troop3", [],  "Non!...", "close_window",[]],
  
  
  #team1
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chateautours_5"),
    ],
    "Alerte! un intrus dans l'enceinte du chateau!.", "chavieu_troop2",
    [
      #refaire equipes localis?s assigner variable si besoin ?
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 0, 2, 1),
      (team_set_relation, 0, 3, 1),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 1, 3, 0),
      (team_set_relation, 2, 0, 1),
      (team_set_relation, 2, 1, 0),
      (team_set_relation, 2, 3, 0),
      (team_set_relation, 3, 0, 1),
      (team_set_relation, 3, 1, 0),
      (team_set_relation, 3, 2, 0),
  ]],
  
  [anyone|plyr ,"chavieu_troop2", [],  "Pas ca...", "close_window",[]],
  
  #team1
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chateautours_1"),
    ],
    "Alerte! un intrus dans l'enceinte du chateau!.", "chavieu_troop1",
    [
      #refaire equipes localis?s assigner variable si besoin ?
      (assign, "$troisiemnivchateau", 1),
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 0, 2, 1),
      (team_set_relation, 0, 3, 1),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 1, 3, 0),
      (team_set_relation, 2, 0, 1),
      (team_set_relation, 2, 1, 0),
      (team_set_relation, 2, 3, 0),
      (team_set_relation, 3, 0, 1),
      (team_set_relation, 3, 1, 0),
      (team_set_relation, 3, 2, 0),
  ]],
  
  [anyone|plyr ,"chavieu_troop1", [],  "Merde.", "close_window",[]],
  
  ############################ dials ferme mathieu
  #mat dernier dial
  [anyone,"start", [(eq, "$g_talk_troop", "trp_femme_farm"),
      (eq, "$findialmathieu", 1),
    ],
    "Allez vous en !", "farm_feeear2", []],
  [anyone|plyr ,"farm_feeear2", [],  "Vous ne me reverais plus.", "close_window", []],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_femme_farm"),
    ],
    "Que...que voullez vous, qui etes vous?", "femme_farm_farmer", []],
  
  [anyone|plyr ,"femme_farm_farmer", [],  "N'ayez craintes, je veux juste parler a votre mari.", "close_window", []],
  [anyone|plyr ,"femme_farm_farmer", [],  "Ne t'occupe pas de ca femme.", "close_window", []],
  
  
  #mat dernier dial
  [anyone,"start", [(eq, "$g_talk_troop", "trp_mathieu_farm"),
      (eq, "$findialmathieu", 1),
    ],
    "Tu devrais partire maintenant.", "farm_endo", []],
  [anyone|plyr ,"farm_endo", [],  "Je m'en vais.", "close_window", []],
  
  #mat
  [anyone,"start", [(eq, "$g_talk_troop", "trp_mathieu_farm"),
    ],
    "Qui etes vous? qu'es ce que vous voullez ?", "farm_feeear", []],
  [anyone|plyr ,"farm_feeear", [],  "Et tu Matieu le fileux?", "farm_feeearoui", []],
  
  [anyone ,"farm_feeearoui", [],"...On ne m'as pas appellé comme ca depuis bien longtemp, j'imagine que ce porc de Villandrandro vous a payé pour me retrouver.", "farm_feeeardac", []],
  
  [anyone|plyr ,"farm_feeeardac", [],  "C'est exact il veux ta tete, rien de personnel...", "close_window",
    [
      #refaire relation equipes/disable dialogue
      (mission_disable_talk),
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 1, 0, -1),
      (assign, "$mortmattieu", 1),
  ]],
  [anyone|plyr ,"farm_feeeardac", [],  "On peut peut etre s'aranger, il veux juste la médaille que tu as autour du coup, donne la moi et tout sera finis.", "farm_feeeardacafe", []],
  
  
  [anyone ,"farm_feeeardacafe", [],"Bon, elle a une grande valeure pour moi, mais j'imagine que Je n'ai pas le choix,tiens, et merci étranger, qui que tu soit.","close_window",
    [
      #donner la chaine/mission accomplie/variable dernier dial/donner chaine
      # (call_script, "script_succeed_quest", "qst_kill_mathieu"),
      (troop_add_item, "trp_player","itm_medaille",0),
      (assign,"$findialmathieu",1),
  ]],
  
  
  
  ############# dials acteurs rebels catas paris
  #sentinel apres parler
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catarebel_dsentinel"),
      (eq, "$pdejaparleesentcatas", 1),
    ],
    "Allez passe...", "passe_resecata", []],
  
  [anyone|plyr ,"passe_resecata", [],  "Le bonjour a toi aussi...", "close_window", []],
  
  #sentinel
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catarebel_dsentinel"),
    ],
    "Pas un pas de plus! que viens tu faire ici ?", "passent_citcata", []],
  
  [anyone|plyr ,"passent_citcata", [],  "Es tu un voleur ? je suis armé, a ta place je réflèchirais deux fois avant de m'attaquer...", "passent_citcata2",[]],
  
  [anyone ,"passent_citcata2", [],"Des voleurs ? non, on es des Rebelles,d'honnetes citoyens, enfin ce qu'il en reste.et toi qui es tu ?", "passent_citcata3",[]],
  
  [anyone|plyr ,"passent_citcata3", [],  "Je suis de votre coté, avez vous un chef ?", "passent_citcatavoirch",[]],
  [anyone|plyr ,"passent_citcata3", [],  "Ca va, je m'en vais, je voulais juste jetter un oeil a l'endroit.", "close_window",[]],
  
  [anyone ,"passent_citcatavoirch", [],"Ben...d'accord, le Chef es en bas, prés du feu, attention , on te surveille.", "close_window",[(assign, "$pdejaparleesentcatas", 1),]],
  ############
  
  #resident 1
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catarebel_redid1"),
    ],
    "Ca alors, c'est étrange de voir de nouvelles tetes, surtout dans un endroit comme celui ci.", "etrange_tete", []],
  
  [anyone|plyr ,"etrange_tete", [],  "Il est étrange également de voir autant de monde vivre sous terre.", "close_window",[]],
  
  
  #resident 2 a table
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catarebel_redid2"),
    ],
    "Dites moi ami, quelle es la situation la haut ?", "citycata_start", []],
  
  [anyone|plyr ,"citycata_start", [],  "Paris es toujours aux Anglois, la situation es délicate.", "citycata_startmauv",[]],
  [anyone|plyr ,"citycata_start", [],  "Paris et Angloise pour le moment, mais ca va bientot changer croyez moi.", "citycata_startesp",[]],
  [anyone|plyr ,"citycata_start", [],  "Paris es liberée ! vous devriez sortire d'ici...", "citycata_startlibr",[]],
  [anyone|plyr ,"citycata_start", [],  "Je n'ai point le temp de pavoiser, adieu.", "close_window",[]],
  
  [anyone ,"citycata_startmauv", [],"Oh...je voie, prions pour que ca change, que nous reste t'il d'autre a faire ?", "close_window",[]],
  [anyone ,"citycata_startesp", [],"Je léspère de tout coeur, je suis pret a me battre pour libérer la ville si il le faut.", "close_window",[]],
  [anyone ,"citycata_startlibr", [],"Quois ?! mais c'est formidable ! je...ca me ferais drole de partire d'ici comme ca, je vais attendre un peut...", "close_window",[]],
  
  #resident vendeur
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catarebel_rvend"),
    ],
    "Bienvenue, qui que tu soit...j'es des choses a vendre si ca t'intérèsse.", "vendeur_catares", []],
  [anyone|plyr,"vendeur_catares", [], "Qu'a tu as vendre ?", "vendeur_cataresvend",[]],
  [anyone|plyr,"vendeur_catares", [], "Non, merci bien.", "close_window",[]],
  
  [anyone,"vendeur_cataresvend", [],"Des armes, et quelques babioles qui trainaient.", "vendeur_cataresvend2",[]],
  [anyone|plyr,"vendeur_cataresvend2", [], "Je suppose que tu n'accepteras pas des écus ?", "vendeur_cataresvend3",[]],
  
  [anyone,"vendeur_cataresvend3", [],"Et bien, je préffèrerais faire du troc avec quelque chose qui se mange, mais soit ca pourais me servire plus tard. tiens, jette un oeil.", "vendeur_cataresvend4",[[change_screen_trade]]],
  
  [anyone,"vendeur_cataresvend4", [],"Autre chose ?", "vendeur_catares",[]],
  
  #resident femme guerriere
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catarebel_womanrebel"),
    ],
    "Je ne veux plus rester ici, je veux me battre, dit leur toi qui viens d'en haut.", "fem_rebelcatas", []],
  [anyone|plyr,"fem_rebelcatas", [], "C'est une mauvaise idée, vous n'etes pas entrainés et vous n'avez aucune protection, vous allez a une mort certaine.", "fem_rebelcataswrong",[]],
  [anyone|plyr,"fem_rebelcatas", [], "Il y a une chance si vous vous unissez a d'autres.", "fem_rebelcatasright",[]],
  [anyone|plyr,"fem_rebelcatas", [], "Ca ne me regarde en rien, désolé.", "close_window",[]],
  
  [anyone ,"fem_rebelcataswrong", [],"Tu ne vaut pas mieux que les autres, hors de ma vue pleutre...", "close_window",[]],
  [anyone ,"fem_rebelcatasright", [],"Je le savais, vous entendez vous autres ? etes vous prets a vous battre ?!", "close_window",[]],
  
  #resident femme apeuree
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catarebel_womanresid"),
    ],
    "Je préfère rester ici en vie, plutot que d'éssayer de me battre et y perdre la vie, ou pire finire torturée dans les donjons de Paris.", "fem_rebfear", []],
  [anyone|plyr,"fem_rebfear", [], "Pourquois ne pas remonter et mener une vie tranquile a Paris ?", "fem_rebfearwhy",[]],
  [anyone|plyr,"fem_rebfear", [], "Ca ne me regarde en rien, désolé.", "close_window",[]],
  
  [anyone ,"fem_rebfearwhy", [],"Impossible, la plupart d'entre nous reffuseraient de servire nos ennemis, de plus nous sommes des hors la loi, nous finirions sur l'echafaud dés qu'on veraient la lumière du jour.", "close_window",[]],
  
  ########################## chef rebel catas catata
  
  #en attente de la fin dernier dial rebel catas
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catarebel_rchef"),
      (eq, "$end_rebelcata", 1),
    ],
    "Nous nous retrouverons a l'extérieur.", "assieg_enddialereb", []],
  [anyone|plyr,"assieg_enddialereb", [], "Tres bien.", "close_window",[]],
  
  
  #rejoindre le siege par exterieur
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catarebel_rchef"),
      (eq, "$readyrebelssiege", 1),
    ],
    "Et bien Ami...allons nous assièger Paris ?", "assieg_depuislcatas", []],
  [anyone|plyr,"assieg_depuislcatas", [], "Oui, maintenant, rejoignez nous au camp de siège a l'extérieur.", "assieg_depuislcatas2",[]],
  [anyone|plyr,"assieg_depuislcatas", [], "Ca n'es pas necéssaire, pas maintenant...", "close_window",[]],
  
  
  [anyone ,"assieg_depuislcatas2", [],"Enfin! nous nous repparlerons une fois dehors, vous etes digne de confiance c'est quelqu'un comme vous qu'il faut a la tête des Rebelles.", "assieg_depuislcatasor",
    [
      (call_script, "script_change_troop_renown", "trp_player", 10),
  ]],
  [anyone ,"assieg_depuislcatasor", [],"Aux armes vous tous! ramassez tout ce qui pourais blésser et sortons, nous allons nous battrent pour Paris !", "close_window",
    [
      #variable dial attente,retrouvons nous dehors et lancer troupe exterieur + faire ses dials de troupes qui rejoignent, + remove from party chef a la fin du dial ???
      (assign, "$end_rebelcata", 1),
      (set_spawn_radius, 2),
      (spawn_around_party, "p_town_1", "pt_catareb"),
      (party_set_flags, reg0, pf_always_visible, 1),
  ]],
  
  
  
  
  #win
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catarebel_rchef"),
      (check_quest_succeeded, "qst_rebel_cataparang"),
      (neg|check_quest_failed, "qst_rebel_cataparang"),
    ],
    "Nous avons réussis, nous avons un peut de temps avant qu'ils n'envoient leure prochaine patrouille.encore merci ami, comme promis viens nous voir lorsque les Francais assiègerons Paris, nous nous joindrons alors a vous.", "crypte_clearrr", []],
  [anyone|plyr,"crypte_clearrr", [], "Ce moment arivera tot ou tard, faites attention a vous.", "close_window",
    [
      #assigner variable possible rejoindre au siege
      (assign, "$readyrebelssiege", 1),
  ]],
  
  
  
  #fail= pas de menu entree
  
  
  
  #attente mission patrouillee
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catarebel_rchef"),
      (check_quest_active, "qst_rebel_cataparang"),
      (neg|check_quest_succeeded, "qst_rebel_cataparang"),
      (neg|check_quest_failed, "qst_rebel_cataparang"),
      (neg|check_quest_finished, "qst_rebel_cataparang"),
    ],
    "Passe par la porte, nous te suivons jusqu'a la crypte...bonne chance.", "crypte_attaq", []],
  [anyone|plyr,"crypte_attaq", [], "Tirez aussi vite que vous le pourrez, je me charge de les achever au corp a corp.", "close_window",[]],
  
  
  #mission 2
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catarebel_rchef"),
      (eq, "$rebelcattravitailok", 1),
    ],
    "Approche ami, maintenant que les autres n'ont plus faim, parlons serieusement ?", "parler_rebelquattt", []],
  [anyone|plyr,"parler_rebelquattt", [], "De quois veux tu parler ?", "parler_rebelquattt2",[]],
  [anyone|plyr,"parler_rebelquattt", [], "Je ne veux pas etre mellé a vos histoires...", "close_window",[]],
  
  
  [anyone ,"parler_rebelquattt2", [],"Je voudrais te parler de notre condition, les Anglois savent que nous sommes quelque part dans les Catacombes et ils envoient régulièrement des patrouilles a notre poursuite. ils ne trouvent jamais cet endroit mais depuis quelques jours nos éclaireurs les ont vue se raprocher dangeuresement et ils sont en ce moment en train de camper dans une crypte non loing d'ici.", "parler_rebelquatttsuit",[]],
  [anyone ,"parler_rebelquatttsuit", [],"Impossible de fermer l'oeil dans ces conditions, il est préfferable que ce soit nous qui les attaquons pendant leur someil. tu as l'air de savoir te battre et nous nous ne somme que de pietres archers, pourait tu te joindre a nous pour l'attaque ?", "parler_rebelquatttsuit2",[]],
  
  [anyone|plyr,"parler_rebelquatttsuit2", [], "Que gagnerais je en retour ?", "parler_rebelquatttsuitpari",[]],
  [anyone|plyr,"parler_rebelquatttsuit2", [], "C'est bien trop dangereux, on y voie meme pas a un metre, c'est non.", "close_window",[]],
  
  [anyone ,"parler_rebelquatttsuitpari", [],"Paris !", "parler_rebelquatttsuitpari3",[]],
  
  [anyone|plyr,"parler_rebelquatttsuitpari3", [], "Pardon ?", "parler_rebelquatttsuitpari4",[]],
  
  [anyone ,"parler_rebelquatttsuitpari4", [],"Rassemble des hommes a l'exterieur ou dit au Dauphin qu'il poura compter sur nous si il assiège la ville, nous ne sommes pas les meilleurs archers mais nous sommes tres nombreux dans ces galleries, si tu te débrouille habilement, ce sera toi qui aura commencé le siege et tu pouras peut etre devenire le Gouverneur de la ville et profiter des richesses qu'elle pourais t'apporter bien entendue, qu'en dit tu ?", "parler_rebelquatttsuitpariok",[]],
  
  [anyone|plyr,"parler_rebelquatttsuitpariok", [], "Il me faudra mettre tout ceci en place, mais certes...allons d'abord nous débarasser de la patrouille.", "parler_rebelquatttsuitpariyes",[]],
  [anyone|plyr,"parler_rebelquatttsuitpariok", [], "Ce sont bien la les paroles démentes d'un homme désesperé. je n'irais pas au cachot avec toi adieu.", "close_window",[]],
  
  [anyone ,"parler_rebelquatttsuitpariyes", [],"Bien! tout le monde es pret. verifie ton equipement et passe par la porte derière moi, nous allons tout droit jusqu'a la crypte ou les Anglois dorment...", "close_window",
    [
      #start quete
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le chef des Rebelles cachés dans les catacombes de Paris m'as demandé de le débarasser de la troupes Angloise qui campe dans une crypte prés du camp Rebelle."),
      (call_script, "script_start_quest", "qst_rebel_cataparang", "$g_talk_troop"),
  ]],
  
  #retour nourit
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catarebel_rchef"),
      (player_has_item, "itm_bread"),
      (player_has_item, "itm_cheese"),
      (check_quest_active, "qst_rebel_catahugry"),
      (neg|check_quest_succeeded, "qst_rebel_catahugry"),
      (neg|check_quest_failed, "qst_rebel_catahugry"),
      (neg|check_quest_finished, "qst_rebel_catahugry"),
    ],
    "As tu de quois manger ami ?", "faim_dernier", []],
  [anyone|plyr,"faim_dernier", [], "Oui, voici, du fromage et du pain.", "take_cheescatares",
    [
      (troop_remove_item, "trp_player","itm_bread"),
      (troop_remove_item, "trp_player","itm_cheese"),
      (call_script, "script_succeed_quest", "qst_rebel_catahugry"),
      (call_script, "script_end_quest", "qst_rebel_catahugry"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",2),
  ]],
  [anyone ,"take_cheescatares", [], "Comment te remercier ? il est bon de voir que tout le monde n'as pas perdu sa pitié en ces temps troublés.", "close_window",
    [
      (assign, "$rebelcattravitailok", 1),
  ]],
  
  #attente nourit
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catarebel_rchef"),
      (check_quest_active, "qst_rebel_catahugry"),
      (neg|check_quest_succeeded, "qst_rebel_catahugry"),
      (neg|check_quest_failed, "qst_rebel_catahugry"),
      (neg|check_quest_finished, "qst_rebel_catahugry"),
    ],
    "Des victuailles je t'en prie, ces gens vont mourire de faim.", "faim_retourrd", []],
  [anyone|plyr,"faim_retourrd", [], "Je vais voir ce que je peut faire.", "close_window",[]],
  
  
  #####
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catarebel_rchef"),
    ],
    "Approche, n'es pas peur. nous sommes des Rebelles, si tu es de notre coté tu n'as rien a craindre, si tu etais un espion par contre, ta peur serais justifiée...", "fem_rebfearss", []],
  [anyone|plyr,"fem_rebfearss", [], "Je suis contre les Anglois en tout cas, que faites vous tous ici sous terre ?", "hung_fearcatastat",[]],
  [anyone|plyr,"fem_rebfearss", [], "Je préfère partire...", "close_window",[]],
  
  [anyone ,"hung_fearcatastat", [],"Nous sommes des hors la loi, nous reffusons de servire les Anglois et leurs amis ces traitres de Bourgignons.Nous restons ici et nous nous préparons comme nous le pouvons a reprendre la ville dés que l'occasion se présenteras.", "hung_fearcatastat2",[]],
  
  [anyone|plyr,"hung_fearcatastat2", [], "Comment faites vous pour survivre ?", "hung_fearcatastat3",[]],
  
  [anyone ,"hung_fearcatastat3", [],"Nous nous nourissons d'insectes et de rats au meilleur des cas, nous sortons que quand nous n'avons rien trouvé pour voller des victuailles, mais c'est plus que risqué et la plupart des volontaires ne sont jamais revenus...nous ne nous connaissont pas mais, pourais tu nous ramener de quois dinner ? je t'en prie, il y a ici des femmes et des personnes faibles.", "hung_fearcatastatfaib",[]],
  
  [anyone|plyr,"hung_fearcatastatfaib", [], "C'es d'accord, je vais voir ce que je peut trouver a Paris.", "hung_fearcatastatfaibok",[]],
  [anyone|plyr,"hung_fearcatastatfaib", [], "Je ne peut pas, je regrette. bonne chance...", "close_window",[]],
  
  [anyone ,"hung_fearcatastatfaibok", [],"Vraiment ? je ne sais pas quois dire...et bien, je pensse que du pain et du fromage devrais suffire, si tu reviens, tu auras vraiment accomplis une bonne action crois moi.", "close_window",
    [
      #start quete
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le chef des Rebelles cachés dans les catacombes de Paris m'as supplié de ramener du pain et du fromage pour ses gens affamés."),
      (call_script, "script_start_quest", "qst_rebel_catahugry", "$g_talk_troop"),
  ]],
  
  ####### dials comando cata
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catacomando_dsentinel"),
    ],
    "Du sang...partout...", "sang_teror", []],
  [anyone|plyr,"sang_teror", [], "Et vous dites vouloire livrer la bataille de Paris.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catacomando_redid1"),
    ],
    "Ils sont morts.", "sang_teror2", []],
  [anyone|plyr,"sang_teror2", [], "En tout cas ils ont déja leur crypte.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catacomando_redid2"),
    ],
    "On les as eu.", "sang_teror3", []],
  [anyone|plyr,"sang_teror3", [], "Nous ne sommes pas a la chasse.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catacomando"),
    ],
    "Tout ce sang...", "sang_teror4", []],
  [anyone|plyr,"sang_teror4", [], "Et vous dites vouloire livrer la bataille de Paris.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_catacomando_womanrebel"),
    ],
    "Ils on eu leur compte.", "sang_teror5", []],
  [anyone|plyr,"sang_teror5", [], "La place d'une femme n'es surement pas dans une crypte a se livrer a la guerre.", "close_window",[]],
  
  
  #dial catherine de fierbois
  #avec l'epee
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pretre_fierbois2"),
    ],
    "Etes vous venue vous receuillire dans notre chapelle mon frère ?", "fierbois_talkpretr", []],
  
  [anyone|plyr,"fierbois_talkpretr", [], "Je suis a la recherche d'une épée.", "fierbois_talkpret2r",[]],
  [anyone|plyr,"fierbois_talkpretr", [], "C'est cela.", "close_window",[]],
  
  [anyone ,"fierbois_talkpret2r", [],"Mon frère, ca n'es point ici que vous en trouverais une, allons donc en ville nous ne sommes pas des forgerons.", "close_window", []],
  
  #avec l'epee
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pretre_fierbois3"),
      (this_or_next|player_has_item,"itm_epee_jeanne_charles"),#ID epee quete
      (troop_has_item_equipped,"trp_player","itm_epee_jeanne_charles"),#
    ],
    "Mais, d'ou sortez vous cette  épée mon frère ?", "fierbois_trouveeeat", []],
  
  [anyone|plyr,"fierbois_trouveeeat", [], "Et bien de votre chapelle, elle es probablement la depuis des temps immémoriaux.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pretre_fierbois3"),
    ],
    "Que puis je faire pour vous mon frère ?", "fierbois_talkautrpret", []],
  
  [anyone|plyr,"fierbois_talkautrpret", [], "Je suis a la recherche d'une épée, en auriez vous vue une par ici ?", "fierbois_talkautrpret2",[]],
  [anyone|plyr,"fierbois_talkautrpret", [], "Rien, merci.", "close_window",[]],
  
  [anyone ,"fierbois_talkautrpret2", [],"Etes vous yvre ? je vous conseille de partir.", "close_window", []],
  
  #avec l'epee
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pretre_fierbois1"),
      (this_or_next|player_has_item,"itm_epee_jeanne_charles"),#ID epee quete
      (troop_has_item_equipped,"trp_player","itm_epee_jeanne_charles"),#
    ],
    "Ca alors, es ce bien la une épée ?", "fierbois_trouveee", []],
  
  [anyone|plyr,"fierbois_trouveee", [], "Ne vous l'avais je pas dit ? Jeane la Loraine m'a demandé de venire la chercher, sans meme etre sur de son existance, ca semble bien etre une relique et elle dit en avoir besoin pour liberer la France.", "fierbois_trouveee2",[]],
  
  [anyone ,"fierbois_trouveee2", [],"Dieu tout puissant! dans ce cas nous prierons pour elle.", "close_window", []],
  
  #en attente si retour
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pretre_fierbois1"),
      (eq, "$attente_epeefierboiss", 1),
    ],
    "Et bien, je ne vois pas d'épée, avez vous terminé vos recherches ?", "fierbois_passageretoure", []],
  
  [anyone|plyr,"fierbois_passageretoure", [], "Je veux retourner a la chapelle, Je n'ai peut etre pas regardé avec assez d'attention.", "fierbois_passageretoureend",[]],
  [anyone|plyr,"fierbois_passageretoure", [], "Oui, pour le moment mais je reviendrais.", "close_window",[]],
  
  [anyone ,"fierbois_passageretoureend", [],"Je m'en doutais, et bien entrez.", "close_window",
    [
      #re passage chapelle
      (jump_to_menu, "mnu_chap_fierboientry"),
      (finish_mission),
  ]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pretre_fierbois1"),
    ],
    "Que la paix soit avec vous vous mon frère, que faites vous parmis nous ?", "fierbois_passagepretr", []],
  
  [anyone|plyr,"fierbois_passagepretr", [], "Je suis a la recherche d'une épée, en avez vous vue une dans les parages ?", "fierbois_passagepretr2",[]],
  [anyone|plyr,"fierbois_passagepretr", [], "Je m'en allais merci, merci.", "close_window",[]],
  
  [anyone ,"fierbois_passagepretr2", [],"Une épée dites vous ? non, nous ne sommes pas armés voyon, pourquois me demandez vous cela ?", "fierbois_passagepretr3", []],
  
  [anyone|plyr,"fierbois_passagepretr3", [], "Puis je chercher a l'intérieur de la chapelle ? c'est tres important.", "fierbois_passagepretr4",[]],
  
  [anyone ,"fierbois_passagepretr4", [],"C'en es assez mon frère, je reffuse, partez maintenant.", "fierbois_passagepretr5", []],
  
  [anyone|plyr,"fierbois_passagepretr5", [], "C'est un ordre du Dauphin Charles lui meme, il se trouve peut etre en ces murs une relique, et je doit la ramener a Jeanne la loraine, si je trouve bien une épée dans cette chapelle, ce sera bien la preuve de mes dires, dans le cas contraire je m'en irais n'ayez craintes.", "fierbois_passagepretr6",[]],
  
  [anyone ,"fierbois_passagepretr6", [],"Rassembler des armes pour les donner a une femme, si vous dites vrais la France es alors perdue.Soit entrez si c'est la le seul  moyen pour que vous aretiez de nous tourmenter.", "close_window",
    [
      #jump menu et scene
      (assign, "$attente_epeefierboiss", 1),
      (jump_to_menu, "mnu_chap_fierboientry"),
      (finish_mission),
  ]],
  
  
  #rouen pour foret
  #garde
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rouen_mercenaire"),
    ],
    "Pas de gestes brusques, ni de parole plus haute que sa seigneurie.", "gardeseigneutri", []],
  
  [anyone|plyr,"gardeseigneutri", [], "Que sa seigneurie se rasure, Je n'ai point envie de parler, ni de frapper.", "close_window",[]],
  
  
  #prhase finale en boucle WIN
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rouen_merchantquest"),
      (eq, "$win_a_rouenfore", 1),
    ],
    "Je ne sais comment vous remerciez, vous avez l'étofe d'un grand chevalier.", "marrr_winess", []],
  [anyone|plyr,"marrr_winess", [], "C'etait la mon devoir.", "close_window",[]],
  [anyone|plyr,"marrr_winess", [], "Ces paroles ne vous coutent rien.", "close_window",[]],
  
  
  #prhase finale en boucle LOOSE
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rouen_merchantquest"),
      (eq, "$loose_a_rouenfore", 1),
    ],
    "Hors de ma vue, vous avez laissé ma fille mourire dans cette forêt.", "marrr_looses", []],
  
  [anyone|plyr,"marrr_looses", [], "Je comprend.", "close_window",[]],
  
  
  
  #win
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rouen_merchantquest"),
      (check_quest_succeeded, "qst_foret_filleroeun"),
      (neg|check_quest_failed, "qst_foret_filleroeun"),
    ],
    "Alors? avez vous retrouvé ma fille ?", "roue_winiifille", []],
  
  [anyone|plyr,"roue_winiifille", [], "Je l'es retrouvé, et elle es en vie, ce sont certains de vos mercenaires qui l'on enlevée ,leur solde tardais a etre verssée et ils ont commis cet acte odieux par révolte.", "roue_winiifille2",
    [
      (call_script, "script_end_quest", "qst_foret_filleroeun"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",8),
      (party_set_flags, "p_rouen_foret", pf_always_visible, 0),
      (party_set_flags, "p_rouen_foret", pf_disabled, 1),
  ]],
  
  [anyone ,"roue_winiifille2", [],"Que dites vous ? miserables... les coupables seront punis de mort, je rassemble au plus tot une armée qui me soit restée fidéle et nous commancons la battue, je ne trouverais le someil qu'aprés leur avoir araché leur tete de mes propres mains.", "roue_winiifille2pay",
    [
      #assign dernier dial loose
      (party_remove_members, "p_main_party", "trp_rouenf_fill", 1),
      (assign, "$win_a_rouenfore", 1),
  ]],
  [anyone ,"roue_winiifille2pay", [],"Quand a vous, et bien, vous vous doutez que je ne puisse vous payer.c'es horible, je suis ruiné et cela a couté la vertue de ma fille, et cela aurais pu lui couter la vie.", "roue_winiifille2pay2", []],
  [anyone ,"roue_winiifille2pay2", [],"Je regréte, mais je vous es mentis, je ne posséde pas 10.000 écus, allez vous me pardonner ou me tuer ?", "roue_winiifille2paychoi", []],
  
  [anyone|plyr,"roue_winiifille2paychoi", [], "Vous n'aviez point le choix, je comprend, vous etes quite Messire.", "roue_winiifille2paychoiend",
    [
      (call_script, "script_change_troop_renown", "trp_player", 1),
  ]],
  
  [anyone|plyr,"roue_winiifille2paychoi", [], "Je risque ma vie pour l'or, trouvez une compenssation sur le champ ou je vous estrille.", "roue_winiifille2paychoiendpay",[]],
  
  
  [anyone ,"roue_winiifille2paychoiend", [],"Vous etes digne des plus grands Chevaliers, que Dieu vous garde Messire.", "close_window", []],
  [anyone ,"roue_winiifille2paychoiendpay", [],"écoutez, je ne peut vous donner que 200 écus, c'es la tout ce qu'il me reste, j'en suis navré.", "close_window",
    [
      #paye 200
      (troop_add_gold, "trp_player", 200),
  ]],
  
  
  
  #fail
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rouen_merchantquest"),
      (check_quest_failed, "qst_foret_filleroeun"),
      (neg|check_quest_succeeded, "qst_foret_filleroeun"),
    ],
    "Alors? avez vous retrouvé ma fille ?", "roue_failfille", []],
  
  [anyone|plyr,"roue_failfille", [], "Malheureseument, j'ai été bléssé en tentant de la sauver.", "roue_failfille2",
    [
      (call_script, "script_end_quest", "qst_foret_filleroeun"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-4),
      (party_set_flags, "p_rouen_foret", pf_always_visible, 0),
      (party_set_flags, "p_rouen_foret", pf_disabled, 1),
  ]],
  [anyone ,"roue_failfille2", [],"Quois ?! miserable...que savez vous, que lui on t'ils fait et qui etaient t'ils ?", "roue_failfillewho", []],
  
  [anyone|plyr,"roue_failfillewho", [], "Ce sont vos mercenaires qui l'on prise en guise de solde pour la violanter.", "roue_failfillewho2", []],
  
  [anyone|plyr,"roue_failfillewho", [], "Malheureusement, Je n'ai pas eu le temps de les voir, ils m'on blessé avec une fléche.", "close_window",
    [
      #assign dernier dial loose
      (assign, "$loose_a_rouenfore", 1),
  ]],
  
  [anyone ,"roue_failfillewho2", [],"Que dites vous ? non! les coupables seront punis de mort, je rassemble au plus tot une armée qui me soit restée fidéle et nous commancons la battue, je ne trouverais le someil qu'aprés leur avoir araché leur tete de mes propres mains.", "close_window",
    [
      #assign dernier dial loose
      (assign, "$loose_a_rouenfore", 1),
  ]],
  
  
  #en attene
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rouen_merchantquest"),
      (check_quest_active, "qst_foret_filleroeun"),
      (neg|check_quest_succeeded, "qst_foret_filleroeun"),
      (neg|check_quest_failed, "qst_foret_filleroeun"),
      (neg|check_quest_finished, "qst_foret_filleroeun"),
    ],
    "Alors? avez vous retrouvé ma fille ?", "roue_attente_nouv", []],
  
  [anyone|plyr,"roue_attente_nouv", [], "Pas encore, mais je suis sur une piste", "close_window",[]],
  [anyone|plyr,"roue_attente_nouv", [], "Je reffuse de m'occuper de ca, trouvez un autre larbin.", "close_window",
    [
      (call_script, "script_fail_quest", "qst_foret_filleroeun"),
      (call_script, "script_end_quest", "qst_foret_filleroeun"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-4),
      (party_set_flags, "p_rouen_foret", pf_always_visible, 0),
      (party_set_flags, "p_rouen_foret", pf_disabled, 1),
  ]],
  
  #marchand rouen
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rouen_merchantquest"),
    ],
    "Vous la! approchez... approchez vous.", "march_rouenapp", []],
  
  [anyone|plyr,"march_rouenapp", [], "Qu'y a t'il ?", "march_rouenapp2",[]],
  [anyone|plyr,"march_rouenapp", [], "Je n'ai point habitude que l'on m'arette comme un cheval qui embarque, Messire.", "close_window",[]],
  
  [anyone ,"march_rouenapp2", [],"Cherchez vous du travail ? vous avez l'air d'un mercenaire.", "march_rouenapp3", []],
  
  [anyone|plyr,"march_rouenapp3", [], "Cela dépend de la solde ?", "march_rouenappsold",[]],
  [anyone|plyr,"march_rouenapp3", [], "Je ne suis pas mercenaire, vous vous trompez.", "close_window",[]],
  
  [anyone ,"march_rouenappsold", [],"Des brigands ont enlés ma bien aimée fille, dieu seul sait ou ils l'ont enmenée, je vous payerais 10.000 écus si vous me la ramenez, qu'en dites vous ?", "march_rouenappsoldchoi", []],
  
  [anyone|plyr,"march_rouenappsoldchoi", [], "Pour une somme pareille, je la retrouverais!", "march_rouenappsoldchoiok",
    [
      #start quest montrer partie et flag quete
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Un riche marchand de Rouen m'offre la somme de 10.000 écus si je parviens a retrouver sa fille enlevée récament, je doit commencer par questioner le tavernier de Rouen a propos des etrangers qu'il a servi le jour de l'enlevement."),
      (call_script, "script_start_quest", "qst_foret_filleroeun", "$g_talk_troop"),
  ]],
  [anyone|plyr,"march_rouenappsoldchoi", [], "Cela cache quelque chose, comme une mort certaine pour moi, c'est non.", "close_window",[]],
  
  [anyone ,"march_rouenappsoldchoiok", [],"Bien, commencez par questioner le tavernier dans notre ville de Rouen, il a servi des étrangers ce jour la, ils dissimulaient leurs visages sous une capuche, mais ne veux rien me dire sur ce sujet, il a sans doute entendue des informations mais il a du etre menacé, menacez le a votre tour pour qu'il vous donne plus d'indices, et revenez avec ma pauvre fille, dieu seul sait ce qu'ils lui on fait.", "march_rouenrancon", []],
  
  [anyone|plyr,"march_rouenrancon", [], "Ont t'ils demandé rancon ?", "march_rouenrancon2",[]],
  
  [anyone ,"march_rouenrancon2", [],"Et bien non, c'est bien cela qui m'inquiete, attez vous dans votre quete je vous en prie.", "close_window",
    [
      
  ]],
  
  #dial acteurs foret
  #en attente de depart
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rouenf_fill"),
      (eq, "$fille_embarqueerouen", 1),
    ],
    "Pourions nous partire? les loups se rapprochent.", "sauveroloups_go", []],
  
  [anyone|plyr ,"sauveroloups_go", [],  "Ne vous inquietez pas pour cela.", "close_window", []],
  
  
  #fillefille secourue
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rouenf_fill"),
      (check_quest_succeeded, "qst_foret_filleroeun"),
      (neg|check_quest_failed, "qst_foret_filleroeun"),
    ],
    "Vous les avez tous tués ! Merci messire, vous etes mon sauveur, mon champion, que grace vous soit rendue.", "sauverouenfor_end", []],
  
  [anyone|plyr ,"sauverouenfor_end", [],  "N'oublions pas les 10.000 écus.", "sauverouenfor_end2", []],
  [anyone|plyr ,"sauverouenfor_end", [],  "C'etait mon devoir madame, rentrons a Rouen.", "close_window",
    [
      #me rejoin dans mon groupe
      (call_script, "script_change_troop_renown", "trp_player", 5),
      (assign,"$fille_embarqueerouen",1),
      (party_add_members, "p_main_party","trp_rouenf_fill",1),
  ]],
  [anyone ,"sauverouenfor_end2", [],"Mon père vous a vraiment promis 10.000 écus? Mais...il est ruiné, il lui es impossible de vous versser le moindre écu, ne soyez pas trop dur avec lui quand vous le reverez je vous en prie, il vous a menti pour me sauver.", "sauverouenfor_end3",
    [
      #me rejoin dans mon groupe
      (call_script, "script_change_troop_renown", "trp_player", 5),
      (assign,"$fille_embarqueerouen",1),
      (party_add_members, "p_main_party","trp_rouenf_fill",1),
  ]],
  [anyone ,"sauverouenfor_end3", [],"Pouvons nous partire a présent ?.", "close_window", []],
  
  
  
  #fille avant
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rouenf_fill"),
      (check_quest_active, "qst_foret_filleroeun"),
      (neg|check_quest_succeeded, "qst_foret_filleroeun"),
      (neg|check_quest_failed, "qst_foret_filleroeun"),
      (neg|check_quest_finished, "qst_foret_filleroeun"),
    ],
    "Qui...qui estes vous ?", "sauvetage_roeunfor", []],
  
  [anyone|plyr ,"sauvetage_roeunfor", [],  "Je suis la pour vous sauver gente Dame, restez a l'ecart pendant le combat.", "sauvetage_roeunfor2", []],
  [anyone|plyr ,"sauvetage_roeunfor", [],  "Ne faites pas attention a moi.", "close_window", []],
  [anyone ,"sauvetage_roeunfor2", [],"Seigneur, des secours enfin, faites attention, ce sont les mercenaires que mon père a engagé et ils savent se battrent.", "close_window", []],
  
  ####### mercenaires traitres
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rouenf_traire1"),
    ],
    "He! qui es tu toi ?", "sauvetage_attachh", []],
  
  [anyone|plyr ,"sauvetage_attachh", [],  "Liberez la fille ou vous allez mourirent.", "sauvetage_attachh2", []],
  [anyone|plyr ,"sauvetage_attachh", [],  "Ne faites pas attention a moi, je voullais juste ramsser du bois.", "close_window", []],
  
  [anyone ,"sauvetage_attachh2", [],"Ha,ha,ha comme c'es touchant, le chevalier viens sauver sa belle, mais tu es seul et on es trois solides gaillards.", "sauvetage_attachh3", []],
  
  [anyone|plyr ,"sauvetage_attachh3", [],  "Vous ne serrez bientot que deux, puis tu sera peut etre le dernier a mourrire.", "sauvetage_attachh4", []],
  
  [anyone ,"sauvetage_attachh4", [],"Montre moi si tu te bat comme tu parle, en garde.", "close_window",
    [
      #equipes disable talk
      (mission_disable_talk),
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 0, 2, 0),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 2, 0, 0),
      (team_set_relation, 2, 1, 0),
  ]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rouenf_traire2"),
    ],
    "Que fait tu ici maraud ? on es occupés ca ne se voie pas ?", "sauvetage_attautre", []],
  
  [anyone|plyr ,"sauvetage_attautre", [],  "Que faites vous ici avec cette dame ?", "sauvetage_attautre2", []],
  [anyone|plyr ,"sauvetage_attautre", [],  "Ne faites pas attention a moi, je voullais juste ramsser du bois.", "close_window", []],
  
  [anyone ,"sauvetage_attautre2", [],"Si tu ne part pas sur le champ, on va te couper la gorge et te jetter dans la riviere.", "sauvetage_attautre3", []],
  
  [anyone|plyr ,"sauvetage_attautre3", [],  "Liberez la fille sur le champ.", "sauvetage_attautre4", []],
  
  [anyone ,"sauvetage_attautre4", [],"Montre moi si tu te bat comme tu parle, en garde.", "close_window",
    [
      #equipes disable talk
      (mission_disable_talk),
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 0, 2, 0),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 2, 0, 0),
      (team_set_relation, 2, 1, 0),
  ]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rouenf_traire3"),
    ],
    "He, mais qu'es c'que tu foure ici ?", "sauvetage_dernier", []],
  
  [anyone|plyr ,"sauvetage_dernier", [],  "Avez vous une dame avec vous ?", "sauvetage_dernier2", []],
  [anyone|plyr ,"sauvetage_dernier", [],  "Ne faites pas attention a moi, je voullais juste ramsser du bois.", "close_window", []],
  
  [anyone ,"sauvetage_dernier2", [],"Ha,ha, non elle n'es pas a vendre, elle es a nous, son pere nous avais engagés comme mercenaire, mais ce fils de porc ne paye plus, alors nous on se payent du bon temps avec sa fille comme ca justice es faite.", "sauvetage_dernier3", []],
  
  [anyone|plyr ,"sauvetage_dernier3", [],  "Je comprend, j'aurais moi meme un payement de 10.000 écus pour vos tetes.", "sauvetage_dernier43", []],
  
  [anyone ,"sauvetage_dernier43", [],"Quois ? tu va creuver sale porc.", "close_window",
    [
      #equipes disable talk
      (mission_disable_talk),
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 0, 2, 0),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 2, 0, 0),
      (team_set_relation, 2, 1, 0),
  ]],
  
  
  #demi- compagnons
  ############################################
  
  #Madeleine montpellier
  #derniere phrase
  [anyone,"start", [(eq, "$g_talk_troop", "trp_dame_jardin"),
      (eq, "$dern_phrasede_damemontpel", 1),
    ],
    "Je vous remercie pour ce que vous avez fait, ne vous inquietez pas pour moi, je vais bien, vraiment.", "damme_finalmontppel", []],
  
  [anyone|plyr ,"damme_finalmontppel", [],  "Bien, je doit vous laisser Madame.", "close_window", []],
  
  #win
  [anyone,"start", [(eq, "$g_talk_troop", "trp_dame_jardin"),
      (check_quest_active, "qst_cata_compagnon"),
      (check_quest_succeeded, "qst_cata_compagnon"),
    ],
    "Ho vous voila! Avez vous retrouvé mon mari ?", "damme_aaretrouvmariss", []],
  
  [anyone|plyr ,"damme_aaretrouvmariss", [],  "Oui, mais j'ai bien peur qu'il ne soit vraiment couppable de trahison, il vous demande de l'oublier.", "damme_retrouvmarissvrai", [(call_script, "script_end_quest", "qst_cata_compagnon"),]],
  [anyone|plyr ,"damme_aaretrouvmariss", [],  "Je l'es retrouvé, et il m'a dit de vous dire qu'il lui faut du temps pour prouver son innocance.", "damme_retrouvmarissfaux", [(call_script, "script_end_quest", "qst_cata_compagnon"),]],
  
  [anyone ,"damme_retrouvmarissvrai", [],"Ca n'es pas possible, etes vous sur ? je...je vais devoir tirer un trait sur mon passé dans ce cas, je vous remercie de votre franchise Messire.", "close_window",
    [
      (assign, "$dern_phrasede_damemontpel", 1),
  ]],
  [anyone ,"damme_retrouvmarissfaux", [],"Quelle bonne nouvelle, je vous en remercie Messire, j'attendrais mon époux toute une vie si il le fallais, merci a vous voyageur.", "close_window",
    [
      (assign, "$dern_phrasede_damemontpel", 1),
  ]],
  
  #attente
  [anyone,"start", [(eq, "$g_talk_troop", "trp_dame_jardin"),
      (check_quest_active, "qst_cata_compagnon"),
      (neg|check_quest_succeeded, "qst_cata_compagnon"),
      (neg|check_quest_failed, "qst_cata_compagnon"),
      (neg|check_quest_finished, "qst_cata_compagnon"),
    ],
    "Allez vous partire a la recherche de mon mari ?", "damme_monptchearchmar", []],
  
  [anyone|plyr ,"damme_monptchearchmar", [],  "J'y travaille Madame.", "close_window", []],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_dame_jardin"),
    ],
    "Veuillez m'excusez Messire mais vous semblez etre un aventurier, voyagez vous beaucoup ?", "damme_monpt", []],
  
  [anyone|plyr ,"damme_monpt", [],  "Ca m'arrive, pourquois cette question ?", "damme_monpt2", []],
  [anyone|plyr ,"damme_monpt", [],  "Je ne suis pas interessé.", "close_window", []],
  
  [anyone ,"damme_monpt2", [],"Et bien, les voyages sont dangereux par les temps qui courent, a cause de la guerre et des nombreux brigands, seulement je doit a tout pris avoir des nouvelles de mon mari. voyez vous il est accusé a tort de trahison par le Dauphin Charles, mais je suis sure qu'il n'en es rien, si il vous arivais dans vos voyages de rencontrer mon époux, dites lui simplement que je vais bien, que j'es toujours crue en son innocance et que j'attendrais son retour dés que le mal entendue sera dissipé.", "damme_monpt3", []],
  [anyone|plyr ,"damme_monpt3", [],  "Que gagnerais je dans tout ca ?", "damme_monpt4", []],
  
  
  [anyone ,"damme_monpt4", [],"Il se trouve...que je suis sans ressources, dites lui de vous versser une petite somme, disons 200 écus pour le message, vous le trouverez a Paris, mais je ne sais pas ou exactement dites lui que c'est sa Madeleine qui vous envoie.", "damme_monptchoi", []],
  
  [anyone|plyr ,"damme_monptchoi", [],  "Soit, si je le croise en allant a Paris, je lui ferais la commission.", "damme_monptchoicom",
    [
      #star quete
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Une dame du nom de Madeleine de montpellier, m'a demandé de retrouver son mari a Paris, elle dit qu'il a été jugé coupable de trahison par le Dauphin Charles de France, et qu'il s'es exillé a Paris, il est brun, porte une moustache et se nomme Bernard, c'est Bernard lui meme qui doit me versser une solde pour la commission."),
      (call_script, "script_start_quest", "qst_cata_compagnon", "$g_talk_troop"),
  ]],
  [anyone|plyr ,"damme_monptchoi", [],  "Je ne ferais pas tout ce chemin pour si peut, adieu madame.", "close_window", []],
  [anyone|plyr ,"damme_monptchoi", [],  "Comment le reconaitrais je ?", "damme_monptrec", []],
  
  [anyone ,"damme_monptrec", [],"Mon mari es brun, jeune, porte une moustache et répond au nom de Bernard.", "damme_monptchoi", []],
  
  [anyone ,"damme_monptchoicom", [],"Soyez en remercié Messire, vous etes un brave homme.", "close_window",[]],
  
  #compagnon catas
  #attente depart
  [anyone,"start", [(eq, "$g_talk_troop", "trp_comp_catas"),
      (check_quest_active, "qst_cata_compagnon"),
      (check_quest_succeeded, "qst_cata_compagnon"),
    ],
    "Qu'attendons nous ?", "compcata_attentefin", []],
  
  [anyone|plyr ,"compcata_attentefin", [],  "Nous partons de ce pas...", "close_window", []],
  
  #quete active
  [anyone,"start", [(eq, "$g_talk_troop", "trp_comp_catas"),
      (check_quest_active, "qst_cata_compagnon"),
      (neg|check_quest_succeeded, "qst_cata_compagnon"),
      (neg|check_quest_failed, "qst_cata_compagnon"),
      (neg|check_quest_finished, "qst_cata_compagnon"),
    ],
    "Que voullez vous? laissez moi seul je vous prie.", "compcata_activqst", []],
  
  [anyone|plyr ,"compcata_activqst", [],  "Etes vous Bernard ?", "compcata_activqst2", []],
  [anyone|plyr ,"compcata_activqst", [],  "Bien...", "close_window", []],
  
  [anyone ,"compcata_activqst2", [],"Qui le demande ?", "compcata_activqst3",
    [
      (call_script, "script_succeed_quest", "qst_cata_compagnon"),
  ]],
  [anyone|plyr ,"compcata_activqst3", [],  "C'est votre femmme Madeleine qui m'envoie, elle dit qu'elle vous crois innocant de votre jugement pour trahison, et elle attend votre retour, elle a dit que vous me donneriez 200 écus pour la commission, et je suis pressé.", "compcata_activqst4", []],
  [anyone ,"compcata_activqst4", [],"Pauvre madeleine, vous savez, je suis vraiment un traitre, je ne la mérite point.dites lui simplement de refaire sa vie...quand a moi je suis brisé.", "compcata_activqst5", []],
  
  [anyone|plyr ,"compcata_activqst5", [],  "Et pour mes 200 écus ?", "compcata_activqst6", []],
  [anyone ,"compcata_activqst6", [],"Je suis sans le sous, vous m'en voyez navré, néanmoin je vous remercie pour cette commission.", "compcata_activqst7", []],
  
  [anyone|plyr ,"compcata_activqst7", [],  "Je vois, et vous, qu'allez vous faire ?", "compcata_activqst8", []],
  [anyone ,"compcata_activqst8", [],"Probablement m'oter la vie, je ne merite pas de vivre aprés avoir trahis ma patrie et ma femme.", "compcata_activqst9", []],
  
  [anyone|plyr ,"compcata_activqst9", [],  "Rejoigner ma troupe, vous pourrez vous vanger des Anglais et peut etre vous racheter qui sait, de plus un guerrier meure au combat, et sans oublier que vous me devez toujours 200 écus.", "compcata_activqst10", []],
  [anyone ,"compcata_activqst10", [],"Soit! j'accepte, je vous suit dans l'éspoire de retrouver ma place au cotés de mon épousée.", "close_window",
    [
      (party_add_members, "p_main_party","trp_comp_catas",1),
      (assign, "$compagnon_catasrejoin", 1),
  ]],
  
  ##sans quete
  [anyone,"start", [(eq, "$g_talk_troop", "trp_comp_catas"),
    ],
    "Que voullez vous? Je désire etre seul, alors partez je vous prie.", "compcata_star", []],
  
  [anyone|plyr ,"compcata_star", [],  "Etes vous un guerrier ?", "compcata_star2", []],
  [anyone|plyr ,"compcata_star", [],  "Bien...", "close_window", []],
  
  [anyone ,"compcata_star2", [],"Je suis chevalier.", "compcata_star3", []],
  [anyone|plyr ,"compcata_star3", [],  "Vous ne ressemblez guerre a un chevalier.", "compcata_star4", []],
  [anyone ,"compcata_star4", [],"Tres bien, merci d'avoir donné votre avis, au revoir.", "close_window", []],
  
  #en attente
  [anyone,"start", [(eq, "$g_talk_troop", "trp_comp_orleans"),
      (eq, "$comp_orleans_avecmoi", 1),
    ],
    "Et bien, qu'attendons nous ? mon arbalete va rouiller.", "comporle_attendre", []],
  
  [anyone|plyr ,"comporle_attendre", [],  "En route.", "close_window", []],
  
  ## compagnon d orleans
  [anyone,"start", [(eq, "$g_talk_troop", "trp_comp_orleans"),
    ],
    "Je suis de mauvaise humeur, aussi evitez de me froisser d'avantage qui que vous soyez.", "comporle_star", []],
  
  [anyone|plyr ,"comporle_star", [],  "Avez quelque ennuie Messire ?", "comporle_star2", []],
  [anyone|plyr ,"comporle_star", [],  "Je préfère ne pas vous adresser la parole dans ce cas, qui que vous soyez.", "close_window", []],
  
  [anyone ,"comporle_star2", [],"Je devais me rendre au tournois d'arbalesterie a Paris, mais sous pretexte que nous somme en guerre, le seigneur de Paris reffuse d'acceuillir des soldats ayant servies contre lui, ca ne sont pas la les régles de l'Archerie, pourquois baffouer de nobles traditions, je vous le demande. d'autant plus que ca n'es point avec de tels agissements que les prétendants au trone de france se rendrons plus légitimes.", "comporle_star3", []],
  
  [anyone|plyr ,"comporle_star3", [],  "Vous avez l'air d'un exelent arbaletier, voudriez vous vous joindre a moi, je paye tres bien mes mercenaires.", "comporle_starok", []],
  [anyone|plyr ,"comporle_star3", [],  "Je vous shouaite bonne chance Messire.", "close_window", []],
  
  [anyone ,"comporle_starok", [],"Fort bien, je ne vous demanderais que 120 écus, et je vous suivrais dans vos campagnes.", "comporle_starchoi", []],
  
  [anyone|plyr ,"comporle_starchoi",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 120),
    ],  "Tres bien, les voici, tachez de ne pas vous faire tuer.", "close_window",
    [
      (troop_remove_gold,"trp_player",120),
      (party_add_members, "p_main_party","trp_comp_orleans",1),
      (assign,"$comp_orleans_avecmoi",1),
  ]],
  [anyone|plyr ,"comporle_starchoi", [],  "Je ne puis payer une telle somme pour un seul mercenaire.", "close_window", []],
  
  
  #en attente
  [anyone,"start", [(eq, "$g_talk_troop", "trp_comp_marseille"),
      (eq, "$comp_marseille_avecmoi", 1),
    ],
    "Pouvons nous nous mettre en route camarade ?", "compmarsa_attendre", []],
  
  [anyone|plyr ,"compmarsa_attendre", [],  "En avant...", "close_window", []],
  
  ## compagnon messager marseille
  [anyone,"start", [(eq, "$g_talk_troop", "trp_comp_marseille"),
    ],
    "Salutations, es tu messager ou as tu une missive a faire parvenire ?", "campmarsss_star", []],
  
  [anyone|plyr ,"campmarsss_star", [],  "Je suis messager, et beaucoup d'autres choses cela dépend des opportunités.", "campmarsss_star2", []],
  [anyone|plyr ,"campmarsss_star", [],  "Rien de tout cela.", "close_window", []],
  
  [anyone ,"campmarsss_star2", [],"Tu as bien raison, par les temps qui courent il faut savoir se recicler pour gagner sa vie, je suis moi meme mercenaire, soldat, boulanger, pécheur, et messager.", "campmarsss_star3", []],
  
  [anyone|plyr ,"campmarsss_star3", [],  "Peut etre voudrais tu rejoindre une armée ? je désire rassembler des hommes pour diversses raisons.", "campmarsss_rass", []],
  [anyone|plyr ,"campmarsss_star3", [],  "C'est inévitable en effet, je doit y aller a présent, bon voyage.", "close_window", []],
  
  [anyone ,"campmarsss_rass", [],"C'est assez tentant, je te suivrais pour seulement 60 écus, et le droit de pillier les cadavres de nos ennemis, qu'en dit tu ?", "campmarsss_rass2", []],
  
  [anyone|plyr ,"campmarsss_rass2",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 60),
    ],  "Un soldat compétent a ce prix ? c'es d'accord, en route.", "close_window",
    [
      (troop_remove_gold,"trp_player",60),
      (party_add_members, "p_main_party","trp_comp_marseille",1),
      (assign,"$comp_marseille_avecmoi",1),
  ]],
  [anyone|plyr ,"campmarsss_rass2", [],  "Je ne puis payer une telle somme pour un seul mercenaire.", "close_window", []],
  
  
  
  #en attente
  [anyone,"start", [(eq, "$g_talk_troop", "trp_comps_bourges"),
      (eq, "$comp_bourgg_avecmoi", 1),
    ],
    "Et bien, qu'attendons nous ?", "depart_debourgslmess", []],
  
  [anyone|plyr ,"depart_debourgslmess", [],  "En avant...", "close_window", []],
  
  ## compagnon messager bourges sl
  [anyone,"start", [(eq, "$g_talk_troop", "trp_comps_bourges"),
    ],
    "Le bonjour, Vous n'etes pas citoyen de Bourges il me semble, qui etes vous je vous prie ?", "comp_bourgslqst", []],
  
  [anyone|plyr ,"comp_bourgslqst", [],  "Je suis {playername} et quelques affaires m'aménes a Bourges.", "comp_bourgslqst2", []],
  [anyone|plyr ,"comp_bourgslqst", [],  "Personne qui puisse vous intéresser.", "close_window", []],
  
  [anyone ,"comp_bourgslqst2", [],"Bien, veuillez me pardonner cette indiscretion, mais je suis de garde devans le post de messagers, un travail des plus ennuyeux croyez le.", "comp_bourgslqst3", []],
  
  [anyone|plyr ,"comp_bourgslqst3", [],  "Si votre travail vous ennuie, pourquois ne pas venir avec moi, je rassemble des hommes pour monter une petite armée, mes intentions sont bonnes, et vous pourriez voir du pays en vous enrichissant.", "comp_bourgslqst4", []],
  [anyone|plyr ,"comp_bourgslqst3", [],  "Bon courage Messire.", "close_window", []],
  
  [anyone ,"comp_bourgslqst4", [],"C'en es assez, je vous suis! a condition d'etre payer a l'avance, disons 100 écus.", "comp_bourgslqstok", []],
  
  [anyone|plyr ,"comp_bourgslqstok",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 100),
    ],  "Je suis ravis de compter un ancien menbre du SansLys dans ma troupe, mais pas d'exes de bravoure pour autant.", "close_window",
    [
      (troop_remove_gold,"trp_player",100),
      (party_add_members, "p_main_party","trp_comps_bourges",1),
      (assign,"$comp_bourgg_avecmoi",1),
  ]],
  [anyone|plyr ,"comp_bourgslqstok", [],  "Je ne puis payer une telle somme, peut etre plus tard.", "close_window", []],
  
  
  #en attente
  [anyone,"start", [(eq, "$g_talk_troop", "trp_comps_dijon"),
      (eq, "$comp_dijon_avecmoi", 1),
    ],
    "Et bien, qu'attendons nous ?", "depart_perededij", []],
  
  [anyone|plyr ,"depart_perededij", [],  "En route mon pere...", "close_window", []],
  
  ## compagnon comps_dijon moine guerrier
  [anyone,"start", [(eq, "$g_talk_troop", "trp_comps_dijon"),
    ],
    "Le bonjour Messire, etes vous un mercenaire ?", "comp_dijtropper", []],
  
  [anyone|plyr ,"comp_dijtropper", [],  "Je suis {playername} et il m'es arrivé d'etre mercenaire en effet.", "comp_dijtropper2", []],
  [anyone|plyr ,"comp_dijtropper", [],  "Je ne me permeterais pas de blaisser les créatures du seigneur mon père, vous devez vous tromper.", "close_window", []],
  
  [anyone ,"comp_dijtropper2", [],"Bien, Je recherche voyez vous une troupe a rejoindre pour perfectioner mes compétences en médecine de premiers soins, il va sans dire que vous n'etes pas un tyran qui envoie ses troupes a une mort dertaine n'es ce pas ? etes vous intéressé ?", "comp_dijtropper3", []],
  
  [anyone|plyr ,"comp_dijtropper3", [],  "Un guerisseur sur le champ de bataille pourais m'etre utile en effet, combien cela va t'il me couter ?", "comp_dijtropperhow", []],
  [anyone|plyr ,"comp_dijtropper3", [],  "J'es besoin de combatants, pas d'un pretre, merci bien...", "close_window", []],
  
  [anyone ,"comp_dijtropperhow", [],"Simplement du pain et de la cervoise pour les bléssés ici présents, faites un bon geste et je vous suivrais, je pourais également m'assurer que j'entrerais au service d'un bon crétien et pas d'une brute.", "comp_dijtropperhowok", []],
  
  [anyone|plyr ,"comp_dijtropperhowok",
    [
      (player_has_item, "itm_bread"),
      (this_or_next|player_has_item, "itm_bier"),
      (player_has_item, "itm_ale"),
    ],  "voila votre pain et votre cervoise mon pere, rejoignez ma troupe si vous etes toujours d'accord.", "close_window",
    [
      (troop_remove_item, "trp_player", "itm_bread"),
      (this_or_next|troop_remove_item, "trp_player", "itm_bier"),
      (troop_remove_item, "trp_player", "itm_ale"),
      (party_add_members, "p_main_party","trp_comps_dijon",1),
      (assign,"$comp_dijon_avecmoi",1),
  ]],
  [anyone|plyr ,"comp_dijtropperhowok", [],  "Je reviens avec la marchandise dans ce cas.", "close_window", []],
  
  
  #en attente
  [anyone,"start", [(eq, "$g_talk_troop", "trp_comps_calais"),
      (eq, "$comp_calais_avecmoi", 1),
    ],
    "Et bien, qu'attendons nous ?", "depart_nobatea", []],
  
  [anyone|plyr ,"depart_nobatea", [],  "Nous partons...", "close_window", []],
  
  ## compagnon comps_calais aventurier
  [anyone,"start", [(eq, "$g_talk_troop", "trp_comps_calais"),
    ],
    "Quelle tristesse que de s'aventurer dans un pays et de se rendre compte que nous l'avons visité d'une cote a l'autre, je prend donc le prochain bateau pour l'angleterre", "comp_callaiss", []],
  
  [anyone|plyr ,"comp_callaiss", [],  "De quel pays etes vous messire, vous n'avez point d'accent.", "comp_callaiss2", []],
  [anyone|plyr ,"comp_callaiss", [],  "Bon voyage dans ce cas.", "close_window", []],
  
  [anyone ,"comp_callaiss2", [],"Je viens de Millan en Italie, je suis parti a l'aventure il y a bien logtemps, et je quitte a présent la france, n'ayant pas trouvé une troupe qui es besoin de mes services.", "comp_callaiss3", []],
  
  [anyone|plyr ,"comp_callaiss3", [],  "Voudriez vous rejoindre ma troupe ? vous avez l'air d'un bon combattant.", "comp_callaissok", []],
  [anyone|plyr ,"comp_callaiss3", [],  "Bonne chance en Angleterre, saluez la reine pour moi.", "close_window", []],
  
  [anyone ,"comp_callaissok", [],"Et bien, on dirais que je ne vais pas quitter cette bonne vielle France si tot, cela vous coutera 150 écus d'avance.", "comp_callaissokpay", []],
  
  [anyone|plyr ,"comp_callaissokpay",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 150),
    ],  "Voila votre or, et tennez bien votre garde sur le champ de bataille je vous prie, je ne veux pas de mort inutile.", "close_window",
    [
      (troop_remove_gold,"trp_player",150),
      (party_add_members, "p_main_party","trp_comps_calais",1),
      (assign,"$comp_calais_avecmoi",1),
  ]],
  [anyone|plyr ,"comp_callaissokpay", [],  "Je ne puis payer une telle somme, peut etre plus tard.", "close_window", []],
  
  
  #en attente
  [anyone,"start", [(eq, "$g_talk_troop", "trp_comps_limoge"),
      (eq, "$comp_limoge_avecmoi", 1),
    ],
    "Et bien, je suis impatient de vous faire une demonstration, quand allons nous voyager et pouvoir rencontrer quelques brigands ?", "depart_atelierat", []],
  
  [anyone|plyr ,"depart_atelierat", [],  "Nous partons Messire, mais tennez cette chose loing de moi...", "close_window", []],
  
  ## compagnon limoge ingenieur
  [anyone,"start", [(eq, "$g_talk_troop", "trp_comps_limoge"),
    ],
    "Messire ?", "comp_ateklier", []],
  
  [anyone|plyr ,"comp_ateklier", [],  "Quel etrange arme avez vous la ?", "comp_ateklier2", []],
  [anyone|plyr ,"comp_ateklier", [],  "Salutations.", "close_window", []],
  
  [anyone ,"comp_ateklier2", [],"Ho, je comprend que vous soyez impressioné, il s'agis d'une arquebuse a main, le mécanisme aproche une flame de la poudre quand je presse ce levier telle une arbalete, et un projectile en métal es expilssé.", "comp_ateklier3", []],
  
  [anyone|plyr ,"comp_ateklier3", [],  "Pourquois ne pas prendre une arbalete dans ce cas ?.", "comp_ateklier4", []],
  [anyone|plyr ,"comp_ateklier3", [],  "C'est tres impressionant, a bientot.", "close_window", []],
  
  [anyone ,"comp_ateklier4", [],"Je voie... vous savez il ne faut pas rejeter le progrés cette arme peut transpercer une armure de bonne épaisseure en restant a distance.", "comp_ateklier5", []],
  
  [anyone|plyr ,"comp_ateklier5", [],  "Telle une arbalete ?", "comp_ateklier6", []],
  [anyone ,"comp_ateklier6", [],"Oui c'est ca, t... ho, mais cessez cela éspèce d'ignorant, laissez moi vous démontrer la puissance de mon arquebuse sur le champ de bataille,vous verrez si elle n'es pas plus puissante qu'une arbalete.", "comp_ateklier7", []],
  
  [anyone|plyr ,"comp_ateklier7",
    [
    ],  "Certes, voyagez quelques temps avec moi et nous verrons.", "close_window",
    [
      (party_add_members, "p_main_party","trp_comps_limoge",1),
      (assign,"$comp_limoge_avecmoi",1),
  ]],
  [anyone|plyr ,"comp_ateklier7", [],  "Hors, de question, ceci ne m'inspire que la peur, adieu.", "close_window", []],
  
  
  
  ######### DIAL GUILD MESSAGERS ###################### quetes reussies/script end uest/add gold BEGIN
  #
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master"),
      (check_quest_active, "qst_messager_qst0"),
      (check_quest_succeeded, "qst_messager_qst0"),
    ],
    "Salutations, J'éspère que la lettre pour Montpellier es bien dans les mains du maistre de la Guilde des Marchands.", "mess_retourde_monpel_terminner", []],
  
  [anyone|plyr ,"mess_retourde_monpel_terminner", [],  "Bien évidament, douteriez vous de moi ?", "mess_retourde_monpel_terminner2",
    [
      (call_script, "script_end_quest", "qst_messager_qst0"),
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  [anyone ,"mess_retourde_monpel_terminner2", [],"Parfait, je pourais mieux dinner et dormire ce soir grace a vous, voici votre salaire, a bientot je l'éspère.", "close_window", []],
  
  #marseille
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master"),
      (check_quest_active, "qst_messager_qst1"),
      (check_quest_succeeded, "qst_messager_qst1"),
    ],
    "Salutations, J'éspère que la lettre pour Marseille es bien dans les mains du maistre de la Guilde des Marchands.", "mess_retourde_marssa", []],
  
  [anyone|plyr ,"mess_retourde_marssa", [],  "Bien sur, c'est fait!", "mess_retourde_marssa2",
    [
      (call_script, "script_end_quest", "qst_messager_qst1"),
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  [anyone ,"mess_retourde_marssa2", [],"Parfait, je peut m'occupper d'autre chose maintenant, cette lettre m'empéchais meme de dormire.", "close_window", []],
  
  #paris
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master"),
      (check_quest_active, "qst_messager_qst2"),
      (check_quest_succeeded, "qst_messager_qst2"),
    ],
    "Salutations, J'éspère que la lettre pour Paris es bien dans les mains du maistre de la Guilde des Marchands.", "mess_retourde_paaris", []],
  
  [anyone|plyr ,"mess_retourde_paaris", [],  "Bien sur, c'est fait!", "mess_retourde_paaris2",
    [
      (call_script, "script_end_quest", "qst_messager_qst2"),
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  [anyone ,"mess_retourde_paaris2", [],"Parfait, je voie que je peut compter sur vous.", "close_window", []],
  
  
  #dijon
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master"),
      (check_quest_active, "qst_messager_qst3"),
      (check_quest_succeeded, "qst_messager_qst3"),
    ],
    "Salutations, J'éspère que la lettre pour Dijon es bien dans les mains du maistre de la Guilde des Marchands.", "mess_retourde_dijon", []],
  
  [anyone|plyr ,"mess_retourde_dijon", [],  "Bien sur, c'est fait!", "mess_retourde_dijonfait",
    [
      (call_script, "script_end_quest", "qst_messager_qst3"),
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  [anyone ,"mess_retourde_dijonfait", [],"Parfait, je voie que je peut compter sur vous.", "close_window", []],
  
  
  #caen
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master"),
      (check_quest_active, "qst_messager_qst4"),
      (check_quest_succeeded, "qst_messager_qst4"),
    ],
    "Le bonjour, J'éspère que la lettre pour Caen es arrivée a déstination.", "mess_retourde_caen", []],
  
  [anyone|plyr ,"mess_retourde_caen", [],  "Bien sur!", "mess_retourde_caen2",
    [
      (call_script, "script_end_quest", "qst_messager_qst4"),
  ]],
  
  [anyone ,"mess_retourde_caen2", [],"Parfait, je suis navré, mais les affaires n'ont pas marchées ces dérniers temps, je ne peut vous versser que seulement 50 écus.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 50),
  ]],
  
  
  #bordeau
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master"),
      (check_quest_active, "qst_messager_qst5"),
      (check_quest_succeeded, "qst_messager_qst5"),
    ],
    "Le bonjour, Avez vous enmené la cargaison a déstination de Bordeau ?", "mess_retourde_boordo", []],
  
  [anyone|plyr ,"mess_retourde_boordo", [],  "C'es fait.", "mess_retourde_boordo2",
    [
      (call_script, "script_end_quest", "qst_messager_qst5"),
  ]],
  
  [anyone ,"mess_retourde_boordo2", [],"Parfait, voila votre argent.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  #paris
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master"),
      (check_quest_active, "qst_messager_qst6"),
      (check_quest_succeeded, "qst_messager_qst6"),
    ],
    "Le bonjour, Avez vous enmené la cargaison a déstination de Paris ?", "mess_retourde_parri", []],
  
  [anyone|plyr ,"mess_retourde_parri", [],  "C'es fait.", "mess_retourde_parri2",
    [
      (call_script, "script_end_quest", "qst_messager_qst6"),
  ]],
  
  [anyone ,"mess_retourde_parri2", [],"Parfait, voila votre argent.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  
  #avignon
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master"),
      (check_quest_active, "qst_messager_qst7"),
      (check_quest_succeeded, "qst_messager_qst7"),
    ],
    "Le bonjour, ne deviez vous pas enmener la cargaison a déstination d'Avignon ?", "mess_retourde_avigno", []],
  
  [anyone|plyr ,"mess_retourde_avigno", [],  "C'es fait.", "mess_retourde_avigno2",
    [
      (call_script, "script_end_quest", "qst_messager_qst6"),
  ]],
  
  [anyone ,"mess_retourde_avigno2", [],"Bien, voila votre argent.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  #reims
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master"),
      (check_quest_active, "qst_messager_qst9"),
      (check_quest_succeeded, "qst_messager_qst9"),
    ],
    "Le bonjour, ne deviez vous pas enmener la cargaison a déstination de Reims ?", "mess_retourde_reimso", []],
  
  [anyone|plyr ,"mess_retourde_reimso", [],  "C'es fait.", "mess_retourde_reimso2",
    [
      (call_script, "script_end_quest", "qst_messager_qst9"),
  ]],
  
  [anyone ,"mess_retourde_reimso2", [],"Bien, voila votre argent.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  ##########
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bourges"),
      (check_quest_active, "qst_messager_qst0b"),
      (check_quest_succeeded, "qst_messager_qst0b"),
    ],
    "Salutations, J'éspère que la lettre pour Montpellier es bien dans les mains du maistre de la Guilde des Marchands.", "bmess_retourde_monpel_terminner", []],
  
  [anyone|plyr ,"bmess_retourde_monpel_terminner", [],  "Bien évidament, douteriez vous de moi ?", "bmess_retourde_monpel_terminner2",
    [
      (call_script, "script_end_quest", "qst_messager_qst0b"),
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  [anyone ,"bmess_retourde_monpel_terminner2", [],"Parfait, je pourais mieux dinner et dormire ce soir grace a vous, voici votre salaire, a bientot je l'éspère.", "close_window", []],
  
  #marseille
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bourges"),
      (check_quest_active, "qst_messager_qst1b"),
      (check_quest_succeeded, "qst_messager_qst1b"),
    ],
    "Salutations, J'éspère que la lettre pour Marseille es bien dans les mains du maistre de la Guilde des Marchands.", "bmess_retourde_marssa", []],
  
  [anyone|plyr ,"bmess_retourde_marssa", [],  "Bien sur, c'est fait!", "bmess_retourde_marssa2",
    [
      (call_script, "script_end_quest", "qst_messager_qst1b"),
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  [anyone ,"bmess_retourde_marssa2", [],"Parfait, je peut m'occupper d'autre chose maintenant, cette lettre m'empéchais meme de dormire.", "close_window", []],
  
  #paris
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bourges"),
      (check_quest_active, "qst_messager_qst2b"),
      (check_quest_succeeded, "qst_messager_qst2b"),
    ],
    "Salutations, J'éspère que la lettre pour Paris es bien dans les mains du maistre de la Guilde des Marchands.", "bmess_retourde_paaris", []],
  
  [anyone|plyr ,"bmess_retourde_paaris", [],  "Bien sur, c'est fait!", "bmess_retourde_paaris2",
    [
      (call_script, "script_end_quest", "qst_messager_qst2b"),
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  [anyone ,"bmess_retourde_paaris2", [],"Parfait, je voie que je peut compter sur vous.", "close_window", []],
  
  
  #dijon
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bourges"),
      (check_quest_active, "qst_messager_qst3b"),
      (check_quest_succeeded, "qst_messager_qst3b"),
    ],
    "Salutations, J'éspère que la lettre pour Dijon es bien dans les mains du maistre de la Guilde des Marchands.", "bmess_retourde_dijon", []],
  
  [anyone|plyr ,"bmess_retourde_dijon", [],  "Bien sur, c'est fait!", "bmess_retourde_dijonfait",
    [
      (call_script, "script_end_quest", "qst_messager_qst3b"),
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  [anyone ,"bmess_retourde_dijonfait", [],"Parfait, je voie que je peut compter sur vous.", "close_window", []],
  
  
  #caen
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bourges"),
      (check_quest_active, "qst_messager_qst4b"),
      (check_quest_succeeded, "qst_messager_qst4b"),
    ],
    "Le bonjour, J'éspère que la lettre pour Caen es arrivée a déstination.", "bmess_retourde_caen", []],
  
  [anyone|plyr ,"bmess_retourde_caen", [],  "Bien sur!", "bmess_retourde_caen2",
    [
      (call_script, "script_end_quest", "qst_messager_qst4b"),
  ]],
  
  [anyone ,"bmess_retourde_caen2", [],"Parfait, je suis navré, mais les affaires n'ont pas marchées ces dérniers temps, je ne peut vous versser que seulement 100 écus.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 50),
  ]],
  
  
  #bordeau
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bourges"),
      (check_quest_active, "qst_messager_qst5b"),
      (check_quest_succeeded, "qst_messager_qst5b"),
    ],
    "Le bonjour, Avez vous enmené la cargaison a déstination de Bordeau ?", "bmess_retourde_boordo", []],
  
  [anyone|plyr ,"bmess_retourde_boordo", [],  "C'es fait.", "bmess_retourde_boordo2",
    [
      (call_script, "script_end_quest", "qst_messager_qst5b"),
  ]],
  
  [anyone ,"bmess_retourde_boordo2", [],"Parfait, voila votre argent.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  #paris
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bourges"),
      (check_quest_active, "qst_messager_qst6b"),
      (check_quest_succeeded, "qst_messager_qst6b"),
    ],
    "Le bonjour, Avez vous enmené la cargaison a déstination de Paris ?", "bmess_retourde_parri", []],
  
  [anyone|plyr ,"bmess_retourde_parri", [],  "C'es fait.", "bmess_retourde_parri2",
    [
      (call_script, "script_end_quest", "qst_messager_qst6b"),
  ]],
  
  [anyone ,"bmess_retourde_parri2", [],"Parfait, voila votre argent.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  
  #avignon
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bourges"),
      (check_quest_active, "qst_messager_qst7b"),
      (check_quest_succeeded, "qst_messager_qst7b"),
    ],
    "Le bonjour, ne deviez vous pas enmener la cargaison a déstination d'Avignon ?", "bmess_retourde_avigno", []],
  
  [anyone|plyr ,"bmess_retourde_avigno", [],  "C'es fait.", "bmess_retourde_avigno2",
    [
      (call_script, "script_end_quest", "qst_messager_qst7b"),
  ]],
  
  [anyone ,"bmess_retourde_avigno2", [],"Bien, voila votre argent.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  #reims
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bourges"),
      (check_quest_active, "qst_messager_qst9b"),
      (check_quest_succeeded, "qst_messager_qst9b"),
    ],
    "Le bonjour, ne deviez vous pas enmener la cargaison a déstination de Reims ?", "bmess_retourde_reimso", []],
  
  [anyone|plyr ,"bmess_retourde_reimso", [],  "C'es fait.", "bmess_retourde_reimso2",
    [
      (call_script, "script_end_quest", "qst_messager_qst9b"),
  ]],
  
  [anyone ,"bmess_retourde_reimso2", [],"Bien, voila votre argent.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  #########
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bordeau"),
      (check_quest_active, "qst_messager_qst0d"),
      (check_quest_succeeded, "qst_messager_qst0d"),
    ],
    "Salutations, J'éspère que la lettre pour Montpellier es bien dans les mains du maistre de la Guilde des Marchands.", "dmess_retourde_monpel_terminner", []],
  
  [anyone|plyr ,"dmess_retourde_monpel_terminner", [],  "Bien évidament, douteriez vous de moi ?", "dmess_retourde_monpel_terminner2",
    [
      (call_script, "script_end_quest", "qst_messager_qst0d"),
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  [anyone ,"dmess_retourde_monpel_terminner2", [],"Parfait, je pourais mieux dinner et dormire ce soir grace a vous, voici votre salaire, a bientot je l'éspère.", "close_window", []],
  
  #marseille
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bordeau"),
      (check_quest_active, "qst_messager_qst1d"),
      (check_quest_succeeded, "qst_messager_qst1d"),
    ],
    "Salutations, J'éspère que la lettre pour Marseille es bien dans les mains du maistre de la Guilde des Marchands.", "dmess_retourde_marssa", []],
  
  [anyone|plyr ,"dmess_retourde_marssa", [],  "Bien sur, c'est fait!", "dmess_retourde_marssa2",
    [
      (call_script, "script_end_quest", "qst_messager_qst1d"),
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  [anyone ,"dmess_retourde_marssa2", [],"Parfait, je peut m'occupper d'autre chose maintenant, cette lettre m'empéchais meme de dormire.", "close_window", []],
  
  #paris
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bordeau"),
      (check_quest_active, "qst_messager_qst2d"),
      (check_quest_succeeded, "qst_messager_qst2d"),
    ],
    "Salutations, J'éspère que la lettre pour Paris es bien dans les mains du maistre de la Guilde des Marchands.", "dmess_retourde_paaris", []],
  
  [anyone|plyr ,"dmess_retourde_paaris", [],  "Bien sur, c'est fait!", "dmess_retourde_paaris2",
    [
      (call_script, "script_end_quest", "qst_messager_qst2d"),
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  [anyone ,"dmess_retourde_paaris2", [],"Parfait, je voie que je peut compter sur vous.", "close_window", []],
  
  
  #dijon
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bordeau"),
      (check_quest_active, "qst_messager_qst3d"),
      (check_quest_succeeded, "qst_messager_qst3d"),
    ],
    "Salutations, J'éspère que la lettre pour Dijon es bien dans les mains du maistre de la Guilde des Marchands.", "dmess_retourde_dijon", []],
  
  [anyone|plyr ,"dmess_retourde_dijon", [],  "Bien sur, c'est fait!", "dmess_retourde_dijonfait",
    [
      (call_script, "script_end_quest", "qst_messager_qst3d"),
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  [anyone ,"dmess_retourde_dijonfait", [],"Parfait, je voie que je peut compter sur vous.", "close_window", []],
  
  
  #caen
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bordeau"),
      (check_quest_active, "qst_messager_qst4d"),
      (check_quest_succeeded, "qst_messager_qst4d"),
    ],
    "Le bonjour, J'éspère que la lettre pour Caen es arrivée a déstination.", "dmess_retourde_caen", []],
  
  [anyone|plyr ,"dmess_retourde_caen", [],  "Bien sur!", "dmess_retourde_caen2",
    [
      (call_script, "script_end_quest", "qst_messager_qst4d"),
  ]],
  
  [anyone ,"dmess_retourde_caen2", [],"Parfait, je suis navré, mais les affaires n'ont pas marchées ces dérniers temps, je ne peut vous versser que seulement 100 écus.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  
  #bordeau
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bordeau"),
      (check_quest_active, "qst_messager_qst5d"),
      (check_quest_succeeded, "qst_messager_qst5d"),
    ],
    "Le bonjour, Avez vous enmené la cargaison a déstination de Bordeau ?", "dmess_retourde_boordo", []],
  
  [anyone|plyr ,"dmess_retourde_boordo", [],  "C'es fait.", "dmess_retourde_boordo2",
    [
      (call_script, "script_end_quest", "qst_messager_qst5d"),
  ]],
  
  [anyone ,"dmess_retourde_boordo2", [],"Parfait, voila votre argent.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  #paris
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bordeau"),
      (check_quest_active, "qst_messager_qst6d"),
      (check_quest_succeeded, "qst_messager_qst6d"),
    ],
    "Le bonjour, Avez vous enmené la cargaison a déstination de Paris ?", "dmess_retourde_parri", []],
  
  [anyone|plyr ,"dmess_retourde_parri", [],  "C'es fait.", "dmess_retourde_parri2",
    [
      (call_script, "script_end_quest", "qst_messager_qst6d"),
  ]],
  
  [anyone ,"dmess_retourde_parri2", [],"Parfait, voila votre argent.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  
  #avignon
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bordeau"),
      (check_quest_active, "qst_messager_qst7d"),
      (check_quest_succeeded, "qst_messager_qst7d"),
    ],
    "Le bonjour, ne deviez vous pas enmener la cargaison a déstination d'Avignon ?", "dmess_retourde_avigno", []],
  
  [anyone|plyr ,"dmess_retourde_avigno", [],  "C'es fait.", "dmess_retourde_avigno2",
    [
      (call_script, "script_end_quest", "qst_messager_qst7d"),
  ]],
  
  [anyone ,"dmess_retourde_avigno2", [],"Bien, voila votre argent.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  #reims
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bordeau"),
      (check_quest_active, "qst_messager_qst9d"),
      (check_quest_succeeded, "qst_messager_qst9d"),
    ],
    "Le bonjour, ne deviez vous pas enmener la cargaison a déstination de Reims ?", "dmess_retourde_reimso", []],
  
  [anyone|plyr ,"dmess_retourde_reimso", [],  "C'es fait.", "dmess_retourde_reimso2",
    [
      (call_script, "script_end_quest", "qst_messager_qst9d"),
  ]],
  
  [anyone ,"dmess_retourde_reimso2", [],"Bien, voila votre argent.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  
  
  #########
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_calais"),
      (check_quest_active, "qst_messager_qst0m"),
      (check_quest_succeeded, "qst_messager_qst0m"),
    ],
    "Salutations, J'éspère que la lettre pour Montpellier es bien dans les mains du maistre de la Guilde des Marchands.", "mmess_retourde_monpel_terminner", []],
  
  [anyone|plyr ,"mmess_retourde_monpel_terminner", [],  "Bien évidament, douteriez vous de moi ?", "mmess_retourde_monpel_terminner2",
    [
      (call_script, "script_end_quest", "qst_messager_qst0m"),
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  [anyone ,"mmess_retourde_monpel_terminner2", [],"Parfait, je pourais mieux dinner et dormire ce soir grace a vous, voici votre salaire, a bientot je l'éspère.", "close_window", []],
  
  #marseille
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_calais"),
      (check_quest_active, "qst_messager_qst1m"),
      (check_quest_succeeded, "qst_messager_qst1m"),
    ],
    "Salutations, J'éspère que la lettre pour Marseille es bien dans les mains du maistre de la Guilde des Marchands.", "mmess_retourde_marssa", []],
  
  [anyone|plyr ,"mmess_retourde_marssa", [],  "Bien sur, c'est fait!", "mmess_retourde_marssa2",
    [
      (call_script, "script_end_quest", "qst_messager_qst1m"),
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  [anyone ,"mmess_retourde_marssa2", [],"Parfait, je peut m'occupper d'autre chose maintenant, cette lettre m'empéchais meme de dormire.", "close_window", []],
  
  #paris
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_calais"),
      (check_quest_active, "qst_messager_qst2m"),
      (check_quest_succeeded, "qst_messager_qst2m"),
    ],
    "Salutations, J'éspère que la lettre pour Paris es bien dans les mains du maistre de la Guilde des Marchands.", "mmess_retourde_paaris", []],
  
  [anyone|plyr ,"mmess_retourde_paaris", [],  "Bien sur, c'est fait!", "mmess_retourde_paaris2",
    [
      (call_script, "script_end_quest", "qst_messager_qst2m"),
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  [anyone ,"mmess_retourde_paaris2", [],"Parfait, je voie que je peut compter sur vous.", "close_window", []],
  
  
  #dijon
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_calais"),
      (check_quest_active, "qst_messager_qst3m"),
      (check_quest_succeeded, "qst_messager_qst3m"),
    ],
    "Salutations, J'éspère que la lettre pour Dijon es bien dans les mains du maistre de la Guilde des Marchands.", "mmess_retourde_dijon", []],
  
  [anyone|plyr ,"mmess_retourde_dijon", [],  "Bien sur, c'est fait!", "mmess_retourde_dijonfait",
    [
      (call_script, "script_end_quest", "qst_messager_qst3m"),
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  [anyone ,"mmess_retourde_dijonfait", [],"Parfait, je voie que je peut compter sur vous.", "close_window", []],
  
  
  #caen
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_calais"),
      (check_quest_active, "qst_messager_qst4m"),
      (check_quest_succeeded, "qst_messager_qst4m"),
    ],
    "Le bonjour, J'éspère que la lettre pour Caen es arrivée a déstination.", "mmess_retourde_caen", []],
  
  [anyone|plyr ,"mmess_retourde_caen", [],  "Bien sur!", "mmess_retourde_caen2",
    [
      (call_script, "script_end_quest", "qst_messager_qst4m"),
  ]],
  
  [anyone ,"mmess_retourde_caen2", [],"Parfait, je suis navré, mais les affaires n'ont pas marchées ces dérniers temps, je ne peut vous versser que seulement 100 écus.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 50),
  ]],
  
  
  #bordeau
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_calais"),
      (check_quest_active, "qst_messager_qst5m"),
      (check_quest_succeeded, "qst_messager_qst5m"),
    ],
    "Le bonjour, Avez vous enmené la cargaison a déstination de Bordeau ?", "mmess_retourde_boordo", []],
  
  [anyone|plyr ,"mmess_retourde_boordo", [],  "C'es fait.", "mmess_retourde_boordo2",
    [
      (call_script, "script_end_quest", "qst_messager_qst5m"),
  ]],
  
  [anyone ,"mmess_retourde_boordo2", [],"Parfait, voila votre argent.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  #paris
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_calais"),
      (check_quest_active, "qst_messager_qst6m"),
      (check_quest_succeeded, "qst_messager_qst6m"),
    ],
    "Le bonjour, Avez vous enmené la cargaison a déstination de Paris ?", "mmess_retourde_parri", []],
  
  [anyone|plyr ,"mmess_retourde_parri", [],  "C'es fait.", "mmess_retourde_parri2",
    [
      (call_script, "script_end_quest", "qst_messager_qst6m"),
  ]],
  
  [anyone ,"mmess_retourde_parri2", [],"Parfait, voila votre argent.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  
  #avignon
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_calais"),
      (check_quest_active, "qst_messager_qst7m"),
      (check_quest_succeeded, "qst_messager_qst7m"),
    ],
    "Le bonjour, ne deviez vous pas enmener la cargaison a déstination d'Avignon ?", "mmess_retourde_avigno", []],
  
  [anyone|plyr ,"mmess_retourde_avigno", [],  "C'es fait.", "mmess_retourde_avigno2",
    [
      (call_script, "script_end_quest", "qst_messager_qst7m"),
  ]],
  
  [anyone ,"mmess_retourde_avigno2", [],"Bien, voila votre argent.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  
  #reims
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_calais"),
      (check_quest_active, "qst_messager_qst9m"),
      (check_quest_succeeded, "qst_messager_qst9m"),
    ],
    "Le bonjour, ne deviez vous pas enmener la cargaison a déstination de Reims ?", "mmess_retourde_reimso", []],
  
  [anyone|plyr ,"mmess_retourde_reimso", [],  "C'es fait.", "mmess_retourde_reimso2",
    [
      (call_script, "script_end_quest", "qst_messager_qst9m"),
  ]],
  
  [anyone ,"mmess_retourde_reimso2", [],"Bien, voila votre argent.", "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 150),
  ]],
  ######### DIAL GUILD MESSAGERS ###################### donne quetes BEGIN  zaza
  
  #maitre de CALAIS
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master"),
    ],
    "Cherchez vous du travail messire ? vous pouriez travailler comme courssier, il n'y a rien de plus simple, je vous donne une lettre ou un paquet et vous devez l'apporter au receveur, qu'en dites vous ?", "mess_calais_start1", []],
  
  [anyone|plyr ,"mess_calais_start1", [],  "Ca m'intéresse,dites m'en plus.", "mess_calais_direp", []],
  [anyone|plyr ,"mess_calais_start1", [],  "Je ne suis pas un simple messager, merci.", "close_window", []],
  
  [anyone ,"mess_calais_direp", [],"Que voullez vous savoir ?", "mess_calais_qa", []],
  
  [anyone|plyr ,"mess_calais_qa", [],  "Combien vais je etre payer ?", "mess_calais_paye", []],
  [anyone|plyr ,"mess_calais_qa", [],  "Avez vous une lettre ou un paquet a remetre ?", "mess_calais_go", []],
  [anyone|plyr ,"mess_calais_qa", [],  "Avez vous des consseils a me donner sur le metier de Messager ?", "mess_calais_cons", []],
  [anyone|plyr ,"mess_calais_qa", [],  "Y a t'il d'autres guildes des Messagers en France ?", "mess_calais_fran", []],
  [anyone|plyr ,"mess_calais_qa", [],  "C'est tout ce que je voulais savoir, merci.", "close_window", []],
  
  
  [anyone ,"mess_calais_paye", [],"Peut importe la distance, vous serez toujours payé 150 écus, c'est le prix d'une course partout en France, qu'une lettre soit pour un sabotier qui attend des nouvelles de sa famille ou qu'elle soit pour le Roi lui meme c'est le meme tarif.", "mess_calais_qa", []],
  [anyone ,"mess_calais_fran", [],"Bien sure, il y en a une a Calais, a Bourges, Bordeau et Marseille, si vous allez remettre une lettre a un client de Marseille, allez voir le representant de la guilde de cette ville pour qu'il vous donne a son tour une course, ainssi vous ne reviendrais pas les mains vides et les courses deviendront rentables, penssez y.", "mess_calais_qa", []],
  [anyone ,"mess_calais_cons", [],"Et bien, apporter une lettre n'es pas difficile en soit, mais parcourire autant de distance le plus vite possible en évitant les groupes de brigands n'es pas des plus aisé, voyager sur des plaines déboisées es souvent plus sur que de traversser des bois, vous ne veriez des bandits en embuscade que bien trop tard.", "mess_calais_cons2", []],
  [anyone ,"mess_calais_cons2", [],"Mais vous ne pouvez point vous permettre non plus d'etre trop regardant sur le trajet, un chemin plus sure es toujours plus long, mais le client attend et cela fait moin d'argent pour vous.de plus je vous conseille de voyager seul ou avec deux ou trois autres compagnons seulement, il vaut mieux etre rapide pour échapper aux brigands que d'etre accompagner d'une escorte qui vous ralentirais, de toute facon, vous ne pouriez pas payer des gardes des mercenaires avec votre revenu, la vie de messager es simple, et faite des voyage de découvertes, mais aussi de dangers alors soyez toujours sur vos gardes.", "mess_calais_cons3", []],
  [anyone ,"mess_calais_cons3", [],"Et pour finire, je vous recommande de trouver une monture rapide, meme si elle es un peut chére, elle représente un bon investissement pour pouvoir faire des courses plus rapidement.le Messager es malin avant tout, évite les piéges et sait tirer partie de chaques situations.", "prmess_calais_qa", []],
  [anyone ,"prmess_calais_qa", [],"Avez vous d'autres questions ?", "mess_calais_qa", []],
  
  [anyone ,"mess_calais_go", [],"Bien sure, voyez vous il y aura toujours plus de lettres ou paquets a porter que de Messagers, j'ai justement quelque chose qui viens d'ariver.", "mess_sort_script",
    [
      (call_script, "script_mesenger_part"),
  ]],
  
  ##### tirage au sort #### begin
  [anyone ,"mess_sort_script", [(eq, "$messager_qst_star", 0),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de montpelier, acceptez vous cette course ?", "mess_calais_direp2", []],
  [anyone|plyr ,"mess_calais_direp2", [],  "Tres bien, je me rendrais a montpelier", "mess_calais_deeprd",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Montpellier."),
      (call_script, "script_start_quest", "qst_messager_qst0", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre0", 0),
  ]],
  [anyone|plyr ,"mess_calais_direp2", [],  "Je regrette, mais je ne peut.", "mess_calais_direp2dd", []],
  [anyone ,"mess_calais_direp2dd", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"mess_calais_deeprd", [],"Bien, faites attention a vous et a la marchandise.", "close_window", []],
  
  #suivant 1
  [anyone ,"mess_sort_script", [(eq, "$messager_qst_star", 1),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de Marseille, pouvez vous aller la bas ?", "mess_marsss_direp2", []],
  [anyone|plyr ,"mess_marsss_direp2", [],  "Tres bien, je me rendrais a Marseille", "mess_marsss_direp2ok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Marseille."),
      (call_script, "script_start_quest", "qst_messager_qst1", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre1", 0),
  ]],
  [anyone|plyr ,"mess_marsss_direp2", [],  "Je regrette, mais Je n'ai pas le temps.", "mess_marsss_direp2non", []],
  [anyone ,"mess_marsss_direp2non", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"mess_marsss_direp2ok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant2PARIS
  [anyone ,"mess_sort_script", [(eq, "$messager_qst_star", 2),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de Paris, pouvez vous aller la bas ?", "mess_parrir_direp2", []],
  [anyone|plyr ,"mess_parrir_direp2", [],  "Tres bien, je me rendrais a Paris", "mess_parrir_direp2ok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Paris."),
      (call_script, "script_start_quest", "qst_messager_qst2", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre2", 0),
  ]],
  [anyone|plyr ,"mess_parrir_direp2", [],  "Je regrette, mais Je n'ai pas le temps.", "mess_parrir_direp2oknon", []],
  [anyone ,"mess_parrir_direp2oknon", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"mess_parrir_direp2ok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant3 DIJON
  [anyone ,"mess_sort_script", [(eq, "$messager_qst_star", 3),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de Dijon, pouvez vous aller la bas ?", "mess_parrir_diijonn", []],
  [anyone|plyr ,"mess_parrir_diijonn", [],  "Tres bien, je me rendrais en Bourgogne.", "mess_parrir_diijonn2",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Dijon."),
      (call_script, "script_start_quest", "qst_messager_qst3", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre3", 0),
  ]],
  [anyone|plyr ,"mess_parrir_diijonn", [],  "Je regrette, mais Je n'ai pas le temps.", "mess_parrir_diijonn2non", []],
  [anyone ,"mess_parrir_diijonn2non", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"mess_parrir_diijonn2", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant4CAEN
  [anyone ,"mess_sort_script", [(eq, "$messager_qst_star", 4),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de Caen, pouvez vous aller la bas ?", "mess_parrir_caaeenn", []],
  [anyone|plyr ,"mess_parrir_caaeenn", [],  "Tres bien, je me rendrais dans le nord.", "mess_parrir_caaeennok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Caen."),
      (call_script, "script_start_quest", "qst_messager_qst4", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre4", 0),
  ]],
  [anyone|plyr ,"mess_parrir_caaeenn", [],  "Je regrette, mais Je n'ai pas le temps.", "mess_parrir_caaeennno", []],
  [anyone ,"mess_parrir_caaeennno", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"mess_parrir_caaeennok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant bordeau
  [anyone ,"mess_sort_script", [(eq, "$messager_qst_star", 5),],"J'ai une caisse a enmener a un marchand de livres a Bordeau, c'est au cartier marchand sainte Catherine, pouvez vous aller la bas ?", "mess_parrir_boordeauu", []],
  [anyone|plyr ,"mess_parrir_boordeauu", [],  "Tres bien, j'irais a Bordeau.", "mess_parrir_boordeauuok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers veux que j'enmène une caisse de livres au marchand de Bordeau au quartier Sainte Catherine."),
      (call_script, "script_start_quest", "qst_messager_qst5", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre5", 0),
  ]],
  [anyone|plyr ,"mess_parrir_boordeauu", [],  "Je regrette, mais Je n'ai pas le temps.", "mess_parrir_boordeauuokno", []],
  [anyone ,"mess_parrir_boordeauuokno", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"mess_parrir_boordeauuok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant  PARIS
  [anyone ,"mess_sort_script", [(eq, "$messager_qst_star", 6),],"J'ai une caisse a enmener a l'armurier de Paris sur la place principale, pouvez vous aller la bas ?", "mess_parrir_parissi", []],
  [anyone|plyr ,"mess_parrir_parissi", [],  "Tres bien, j'irais a Paris.", "mess_parrir_parissiok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers veux que j'enmène une caisse de marchandise a l'armurier de Paris."),
      (call_script, "script_start_quest", "qst_messager_qst6", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre6", 0),
  ]],
  [anyone|plyr ,"mess_parrir_parissi", [],  "Je regrette, mais Je n'ai pas le temps.", "mess_parrir_parissiokno", []],
  [anyone ,"mess_parrir_parissiokno", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"mess_parrir_parissiok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant avignon
  [anyone ,"mess_sort_script", [(eq, "$messager_qst_star", 7),],"J'ai une caisse a enmener a l'armurier d-Avignon sur la place principale, pouvez vous aller la bas ?", "mess_parrir_avignon", []],
  [anyone|plyr ,"mess_parrir_avignon", [],  "Tres bien, j'irais a Avignon.", "mess_parrir_avignonok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers veux que j'enmène une caisse de marchandise a l'armurier d'Avignon."),
      (call_script, "script_start_quest", "qst_messager_qst7", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre7", 0),
  ]],
  [anyone|plyr ,"mess_parrir_avignon", [],  "Je regrette, mais Je n'ai pas le temps.", "mess_parrir_avignonnon", []],
  [anyone ,"mess_parrir_avignonnon", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"mess_parrir_avignonok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant
  [anyone ,"mess_sort_script", [(eq, "$messager_qst_star", 8),],"Non, Je n'ai rien pour le moment, mais ca ne saurais tarder.", "close_window", []],
  
  #suivant reims
  [anyone ,"mess_sort_script", [(eq, "$messager_qst_star", 9),],"Une caisse doit etre livrée au forgeron de Reims, pouvez vous aller la bas ?", "mess_parrir_areims", []],
  [anyone|plyr ,"mess_parrir_areims", [],  "Tres bien, je me rendrais a Paris", "mess_parrir_areimsok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une caisse a remettre au forgeron de Reims."),
      (call_script, "script_start_quest", "qst_messager_qst9", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre9", 0),
  ]],
  [anyone|plyr ,"mess_parrir_areims", [],  "Je regrette, mais Je n'ai pas le temps.", "mess_parrir_areimsnon", []],
  [anyone ,"mess_parrir_areimsnon", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"mess_parrir_areimsok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  
  [anyone ,"mess_sort_script", [(eq, "$messager_qst_star", -1),],"Non, Je n'ai rien pour le moment, mais ca ne saurais tarder.", "close_window", []],
  
  
  
  #maitre de bourges
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bourges"),
    ],
    "Cherchez vous du travail messire ? vous pouriez travailler comme courssier, il n'y a rien de plus simple, je vous donne une lettre ou un paquet et vous devez l'apporter au receveur, qu'en dites vous ?", "bmess_calais_start1", []],
  
  [anyone|plyr ,"bmess_calais_start1", [],  "Ca m'intéresse,dites m'en plus.", "bmess_calais_direp", []],
  [anyone|plyr ,"bmess_calais_start1", [],  "Je ne suis pas un simple messager, merci.", "close_window", []],
  
  [anyone ,"bmess_calais_direp", [],"Que voullez vous savoir ?", "bmess_calais_qa", []],
  
  [anyone|plyr ,"bmess_calais_qa", [],  "Combien vais je etre payer ?", "bmess_calais_paye", []],
  [anyone|plyr ,"bmess_calais_qa", [],  "Avez vous une lettre ou un paquet a remetre ?", "bmess_calais_go", []],
  [anyone|plyr ,"bmess_calais_qa", [],  "Avez vous des consseils a me donner sur le metier de Messager ?", "bmess_calais_cons", []],
  [anyone|plyr ,"bmess_calais_qa", [],  "Y a t'il d'autres guildes des Messagers en France ?", "bmess_calais_fran", []],
  [anyone|plyr ,"bmess_calais_qa", [],  "C'est tout ce que je voulais savoir, merci.", "close_window", []],
  
  
  [anyone ,"bmess_calais_paye", [],"Peut importe la distance, vous serez toujours payé 150 écus, c'est le prix d'une course partout en France, qu'une lettre soit pour un sabotier qui attend des nouvelles de sa famille ou qu'elle soit pour le Roi lui meme c'est le meme tarif.", "bmess_calais_qa", []],
  [anyone ,"bmess_calais_fran", [],"Bien sure, il y en a une a Calais, a Bourges, Bordeau et Marseille, si vous allez remettre une lettre a un client de Marseille, allez voir le representant de la guilde de cette ville pour qu'il vous donne a son tour une course, ainssi vous ne reviendrais pas les mains vides et les courses deviendront rentables, penssez y.", "bmess_calais_qa", []],
  [anyone ,"bmess_calais_cons", [],"Et bien, apporter une lettre n'es pas difficile en soit, mais parcourire autant de distance le plus vite possible en évitant les groupes de brigands n'es pas des plus aisé, voyager sur des plaines déboisées es souvent plus sur que de traversser des bois, vous ne veriez des bandits en embuscade que bien trop tard.", "bmess_calais_cons2", []],
  [anyone ,"bmess_calais_cons2", [],"Mais vous ne pouvez point vous permettre non plus d'etre trop regardant sur le trajet, un chemin plus sure es toujours plus long, mais le client attend et cela fait moin d'argent pour vous.de plus je vous conseille de voyager seul ou avec deux ou trois autres compagnons seulement, il vaut mieux etre rapide pour échapper aux brigands que d'etre accompagner d'une escorte qui vous ralentirais, de toute facon, vous ne pouriez pas payer des gardes des mercenaires avec votre revenu, la vie de messager es simple, et faite des voyage de découvertes, mais aussi de dangers alors soyez toujours sur vos gardes.", "bmess_calais_cons3", []],
  [anyone ,"bmess_calais_cons3", [],"Et pour finire, je vous recommande de trouver une monture rapide, meme si elle es un peut chére, elle représente un bon investissement pour pouvoir faire des courses plus rapidement.le Messager es malin avant tout, évite les piéges et sait tirer partie de chaques situations.", "bprmess_calais_qa", []],
  [anyone ,"bprmess_calais_qa", [],"Avez vous d'autres questions ?", "bmess_calais_qa", []],
  
  [anyone ,"bmess_calais_go", [],"Bien sure, voyez vous il y aura toujours plus de lettres ou paquets a porter que de Messagers, j'ai justement quelque chose qui viens d'ariver.", "bmess_sort_script",
    [
      (call_script, "script_mesenger_part"),
  ]],
  
  ##### tirage au sort #### begin
  [anyone ,"bmess_sort_script", [(eq, "$messager_qst_star", 0),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de montpelier, acceptez vous cette course ?", "bmess_calais_direp2", []],
  [anyone|plyr ,"bmess_calais_direp2", [],  "Tres bien, je me rendrais a montpelier", "bmess_calais_deeprd",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Montpellier."),
      (call_script, "script_start_quest", "qst_messager_qst0b", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre0", 0),
  ]],
  [anyone|plyr ,"bmess_calais_direp2", [],  "Je regrette, mais je ne peut.", "bmess_calais_direp2dd", []],
  [anyone ,"bmess_calais_direp2dd", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"bmess_calais_deeprd", [],"Bien, faites attention a vous et a la marchandise.", "close_window", []],
  
  #suivant 1
  [anyone ,"bmess_sort_script", [(eq, "$messager_qst_star", 1),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de Marseille, pouvez vous aller la bas ?", "bmess_marsss_direp2", []],
  [anyone|plyr ,"bmess_marsss_direp2", [],  "Tres bien, je me rendrais a Marseille", "bmess_marsss_direp2ok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Marseille."),
      (call_script, "script_start_quest", "qst_messager_qst1b", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre1", 0),
  ]],
  [anyone|plyr ,"bmess_marsss_direp2", [],  "Je regrette, mais Je n'ai pas le temps.", "bmess_marsss_direp2non", []],
  [anyone ,"bmess_marsss_direp2non", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"bmess_marsss_direp2ok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant2PARIS
  [anyone ,"bmess_sort_script", [(eq, "$messager_qst_star", 2),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de Paris, pouvez vous aller la bas ?", "bmess_parrir_direp2", []],
  [anyone|plyr ,"bmess_parrir_direp2", [],  "Tres bien, je me rendrais a Paris", "bmess_parrir_direp2ok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Paris."),
      (call_script, "script_start_quest", "qst_messager_qst2b", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre2", 0),
  ]],
  [anyone|plyr ,"bmess_parrir_direp2", [],  "Je regrette, mais Je n'ai pas le temps.", "bmess_parrir_direp2oknon", []],
  [anyone ,"bmess_parrir_direp2oknon", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"bmess_parrir_direp2ok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant3 DIJON
  [anyone ,"bmess_sort_script", [(eq, "$messager_qst_star", 3),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de Dijon, pouvez vous aller la bas ?", "bmess_parrir_diijonn", []],
  [anyone|plyr ,"bmess_parrir_diijonn", [],  "Tres bien, je me rendrais en Bourgogne.", "bmess_parrir_diijonn2",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Dijon."),
      (call_script, "script_start_quest", "qst_messager_qst3b", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre3", 0),
  ]],
  [anyone|plyr ,"bmess_parrir_diijonn", [],  "Je regrette, mais Je n'ai pas le temps.", "bmess_parrir_diijonn2non", []],
  [anyone ,"bmess_parrir_diijonn2non", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"bmess_parrir_diijonn2", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant4CAEN
  [anyone ,"bmess_sort_script", [(eq, "$messager_qst_star", 4),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de Caen, pouvez vous aller la bas ?", "bmess_parrir_caaeenn", []],
  [anyone|plyr ,"bmess_parrir_caaeenn", [],  "Tres bien, je me rendrais dans le nord.", "bmess_parrir_caaeennok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Caen."),
      (call_script, "script_start_quest", "qst_messager_qst4b", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre4", 0),
  ]],
  [anyone|plyr ,"bmess_parrir_caaeenn", [],  "Je regrette, mais Je n'ai pas le temps.", "bmess_parrir_caaeennno", []],
  [anyone ,"bmess_parrir_caaeennno", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"bmess_parrir_caaeennok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant bordeau
  [anyone ,"bmess_sort_script", [(eq, "$messager_qst_star", 5),],"J'ai une caisse a enmener a un marchand de livres a Bordeau, c'est au cartier marchand sainte Catherine, pouvez vous aller la bas ?", "bmess_parrir_boordeauu", []],
  [anyone|plyr ,"bmess_parrir_boordeauu", [],  "Tres bien, j'irais a Bordeau.", "bmess_parrir_boordeauuok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers veux que j'enmène une caisse de livres au marchand de Bordeau au quartier Sainte Catherine."),
      (call_script, "script_start_quest", "qst_messager_qst5b", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre5", 0),
  ]],
  [anyone|plyr ,"bmess_parrir_boordeauu", [],  "Je regrette, mais Je n'ai pas le temps.", "bmess_parrir_boordeauuokno", []],
  [anyone ,"bmess_parrir_boordeauuokno", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"bmess_parrir_boordeauuok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant  PARIS
  [anyone ,"bmess_sort_script", [(eq, "$messager_qst_star", 6),],"J'ai une caisse a enmener a l'armurier de Paris sur la place principale, pouvez vous aller la bas ?", "bmess_parrir_parissi", []],
  [anyone|plyr ,"bmess_parrir_parissi", [],  "Tres bien, j'irais a Paris.", "bmess_parrir_parissiok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers veux que j'enmène une caisse de marchandise a l'armurier de Paris."),
      (call_script, "script_start_quest", "qst_messager_qst6b", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre6", 0),
  ]],
  [anyone|plyr ,"bmess_parrir_parissi", [],  "Je regrette, mais Je n'ai pas le temps.", "bmess_parrir_parissiokno", []],
  [anyone ,"bmess_parrir_parissiokno", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"bmess_parrir_parissiok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant avignon
  [anyone ,"bmess_sort_script", [(eq, "$messager_qst_star", 7),],"J'ai une caisse a enmener a l'armurier d-Avignon sur la place principale, pouvez vous aller la bas ?", "bmess_parrir_avignon", []],
  [anyone|plyr ,"bmess_parrir_avignon", [],  "Tres bien, j'irais a Avignon.", "bmess_parrir_avignonok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers veux que j'enmène une caisse de marchandise a l'armurier d'Avignon."),
      (call_script, "script_start_quest", "qst_messager_qst7b", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre7", 0),
  ]],
  [anyone|plyr ,"bmess_parrir_avignon", [],  "Je regrette, mais Je n'ai pas le temps.", "bmess_parrir_avignonnon", []],
  [anyone ,"bmess_parrir_avignonnon", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"bmess_parrir_avignonok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant
  [anyone ,"bmess_sort_script", [(eq, "$messager_qst_star", 8),],"Non, Je n'ai rien pour le moment, mais ca ne saurais tarder.", "close_window", []],
  
  #suivant reims
  [anyone ,"bmess_sort_script", [(eq, "$messager_qst_star", 9),],"Une caisse doit etre livrée au forgeron de Reims, pouvez vous aller la bas ?", "bmess_parrir_areims", []],
  [anyone|plyr ,"bmess_parrir_areims", [],  "Tres bien, je me rendrais a Reims", "bmess_parrir_areimsok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une caisse a remettre au forgeron de Reims."),
      (call_script, "script_start_quest", "qst_messager_qst9b", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre9", 0),
  ]],
  [anyone|plyr ,"bmess_parrir_areims", [],  "Je regrette, mais Je n'ai pas le temps.", "bmess_parrir_areimsnon", []],
  [anyone ,"bmess_parrir_areimsnon", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"bmess_parrir_areimsok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  
  [anyone ,"bmess_sort_script", [(eq, "$messager_qst_star", -1),],"Non, Je n'ai rien pour le moment, mais ca ne saurais tarder.", "close_window", []],
  
  
  
  #maitre de bordeau
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_bordeau"),
    ],
    "Cherchez vous du travail messire ? vous pouriez travailler comme courssier, il n'y a rien de plus simple, je vous donne une lettre ou un paquet et vous devez l'apporter au receveur, qu'en dites vous ?", "dmess_calais_start1", []],
  
  [anyone|plyr ,"dmess_calais_start1", [],  "Ca m'intéresse,dites m'en plus.", "dmess_calais_direp", []],
  [anyone|plyr ,"dmess_calais_start1", [],  "Je ne suis pas un simple messager, merci.", "close_window", []],
  
  [anyone ,"dmess_calais_direp", [],"Que voullez vous savoir ?", "dmess_calais_qa", []],
  
  [anyone|plyr ,"dmess_calais_qa", [],  "Combien vais je etre payer ?", "dmess_calais_paye", []],
  [anyone|plyr ,"dmess_calais_qa", [],  "Avez vous une lettre ou un paquet a remetre ?", "dmess_calais_go", []],
  [anyone|plyr ,"dmess_calais_qa", [],  "Avez vous des consseils a me donner sur le metier de Messager ?", "dmess_calais_cons", []],
  [anyone|plyr ,"dmess_calais_qa", [],  "Y a t'il d'autres guildes des Messagers en France ?", "dmess_calais_fran", []],
  [anyone|plyr ,"dmess_calais_qa", [],  "C'est tout ce que je voulais savoir, merci.", "close_window", []],
  
  
  [anyone ,"dmess_calais_paye", [],"Peut importe la distance, vous serez toujours payé 150 écus, c'est le prix d'une course partout en France, qu'une lettre soit pour un sabotier qui attend des nouvelles de sa famille ou qu'elle soit pour le Roi lui meme c'est le meme tarif.", "dmess_calais_qa", []],
  [anyone ,"dmess_calais_fran", [],"Bien sure, il y en a une a Calais, a Bourges, Bordeau et Marseille, si vous allez remettre une lettre a un client de Marseille, allez voir le representant de la guilde de cette ville pour qu'il vous donne a son tour une course, ainssi vous ne reviendrais pas les mains vides et les courses deviendront rentables, penssez y.", "dmess_calais_qa", []],
  [anyone ,"dmess_calais_cons", [],"Et bien, apporter une lettre n'es pas difficile en soit, mais parcourire autant de distance le plus vite possible en évitant les groupes de brigands n'es pas des plus aisé, voyager sur des plaines déboisées es souvent plus sur que de traversser des bois, vous ne veriez des bandits en embuscade que bien trop tard.", "dmess_calais_cons2", []],
  [anyone ,"dmess_calais_cons2", [],"Mais vous ne pouvez point vous permettre non plus d'etre trop regardant sur le trajet, un chemin plus sure es toujours plus long, mais le client attend et cela fait moin d'argent pour vous.de plus je vous conseille de voyager seul ou avec deux ou trois autres compagnons seulement, il vaut mieux etre rapide pour échapper aux brigands que d'etre accompagner d'une escorte qui vous ralentirais, de toute facon, vous ne pouriez pas payer des gardes des mercenaires avec votre revenu, la vie de messager es simple, et faite des voyage de découvertes, mais aussi de dangers alors soyez toujours sur vos gardes.", "dmess_calais_cons3", []],
  [anyone ,"dmess_calais_cons3", [],"Et pour finire, je vous recommande de trouver une monture rapide, meme si elle es un peut chére, elle représente un bon investissement pour pouvoir faire des courses plus rapidement.le Messager es malin avant tout, évite les piéges et sait tirer partie de chaques situations.", "dprmess_calais_qa", []],
  [anyone ,"dprmess_calais_qa", [],"Avez vous d'autres questions ?", "mess_calais_qa", []],
  
  [anyone ,"dmess_calais_go", [],"Bien sure, voyez vous il y aura toujours plus de lettres ou paquets a porter que de Messagers, j'ai justement quelque chose qui viens d'ariver.", "dmess_sort_script",
    [
      (call_script, "script_mesenger_part"),
  ]],
  
  ##### tirage au sort #### begin
  [anyone ,"dmess_sort_script", [(eq, "$messager_qst_star", 0),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de montpelier, acceptez vous cette course ?", "dmess_calais_direp2", []],
  [anyone|plyr ,"dmess_calais_direp2", [],  "Tres bien, je me rendrais a montpelier", "dmess_calais_deeprd",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Montpellier."),
      (call_script, "script_start_quest", "qst_messager_qst0d", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre0", 0),
  ]],
  [anyone|plyr ,"dmess_calais_direp2", [],  "Je regrette, mais je ne peut.", "dmess_calais_direp2dd", []],
  [anyone ,"dmess_calais_direp2dd", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"dmess_calais_deeprd", [],"Bien, faites attention a vous et a la marchandise.", "close_window", []],
  
  #suivant 1
  [anyone ,"dmess_sort_script", [(eq, "$messager_qst_star", 1),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de Marseille, pouvez vous aller la bas ?", "dmess_marsss_direp2", []],
  [anyone|plyr ,"dmess_marsss_direp2", [],  "Tres bien, je me rendrais a Marseille", "dmess_marsss_direp2ok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Marseille."),
      (call_script, "script_start_quest", "qst_messager_qst1d", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre1", 0),
  ]],
  [anyone|plyr ,"dmess_marsss_direp2", [],  "Je regrette, mais Je n'ai pas le temps.", "dmess_marsss_direp2non", []],
  [anyone ,"dmess_marsss_direp2non", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"dmess_marsss_direp2ok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant2PARIS
  [anyone ,"dmess_sort_script", [(eq, "$messager_qst_star", 2),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de Paris, pouvez vous aller la bas ?", "dmess_parrir_direp2", []],
  [anyone|plyr ,"dmess_parrir_direp2", [],  "Tres bien, je me rendrais a Paris", "dmess_parrir_direp2ok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Paris."),
      (call_script, "script_start_quest", "qst_messager_qst2d", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre2", 0),
  ]],
  [anyone|plyr ,"dmess_parrir_direp2", [],  "Je regrette, mais Je n'ai pas le temps.", "dmess_parrir_direp2oknon", []],
  [anyone ,"dmess_parrir_direp2oknon", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"dmess_parrir_direp2ok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant3 DIJON
  [anyone ,"dmess_sort_script", [(eq, "$messager_qst_star", 3),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de Dijon, pouvez vous aller la bas ?", "dmess_parrir_diijonn", []],
  [anyone|plyr ,"dmess_parrir_diijonn", [],  "Tres bien, je me rendrais en Bourgogne.", "dmess_parrir_diijonn2",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Dijon."),
      (call_script, "script_start_quest", "qst_messager_qst3d", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre3", 0),
  ]],
  [anyone|plyr ,"dmess_parrir_diijonn", [],  "Je regrette, mais Je n'ai pas le temps.", "dmess_parrir_diijonn2non", []],
  [anyone ,"dmess_parrir_diijonn2non", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"dmess_parrir_diijonn2", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant4CAEN
  [anyone ,"dmess_sort_script", [(eq, "$messager_qst_star", 4),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de Caen, pouvez vous aller la bas ?", "dmess_parrir_caaeenn", []],
  [anyone|plyr ,"dmess_parrir_caaeenn", [],  "Tres bien, je me rendrais dans le nord.", "dmess_parrir_caaeennok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Caen."),
      (call_script, "script_start_quest", "qst_messager_qst4d", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre4", 0),
  ]],
  [anyone|plyr ,"dmess_parrir_caaeenn", [],  "Je regrette, mais Je n'ai pas le temps.", "dmess_parrir_caaeennno", []],
  [anyone ,"dmess_parrir_caaeennno", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"dmess_parrir_caaeennok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant bordeau
  [anyone ,"dmess_sort_script", [(eq, "$messager_qst_star", 5),],"J'ai une caisse a enmener a un marchand de livres a Bordeau, c'est au cartier marchand sainte Catherine, pouvez vous aller la bas ?", "dmess_parrir_boordeauu", []],
  [anyone|plyr ,"dmess_parrir_boordeauu", [],  "Tres bien, j'irais a Bordeau.", "dmess_parrir_boordeauuok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers veux que j'enmène une caisse de livres au marchand de Bordeau au quartier Sainte Catherine."),
      (call_script, "script_start_quest", "qst_messager_qst5d", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre5", 0),
  ]],
  [anyone|plyr ,"dmess_parrir_boordeauu", [],  "Je regrette, mais Je n'ai pas le temps.", "dmess_parrir_boordeauuokno", []],
  [anyone ,"dmess_parrir_boordeauuokno", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"dmess_parrir_boordeauuok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant  PARIS
  [anyone ,"dmess_sort_script", [(eq, "$messager_qst_star", 6),],"J'ai une caisse a enmener a l'armurier de Paris sur la place principale, pouvez vous aller la bas ?", "dmess_parrir_parissi", []],
  [anyone|plyr ,"dmess_parrir_parissi", [],  "Tres bien, j'irais a Paris.", "dmess_parrir_parissiok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers veux que j'enmène une caisse de marchandise a l'armurier de Paris."),
      (call_script, "script_start_quest", "qst_messager_qst6d", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre6", 0),
  ]],
  [anyone|plyr ,"dmess_parrir_parissi", [],  "Je regrette, mais Je n'ai pas le temps.", "dmess_parrir_parissiokno", []],
  [anyone ,"dmess_parrir_parissiokno", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"dmess_parrir_parissiok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant avignon
  [anyone ,"dmess_sort_script", [(eq, "$messager_qst_star", 7),],"J'ai une caisse a enmener a l'armurier d-Avignon sur la place principale, pouvez vous aller la bas ?", "dmess_parrir_avignon", []],
  [anyone|plyr ,"dmess_parrir_avignon", [],  "Tres bien, j'irais a Avignon.", "dmess_parrir_avignonok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers veux que j'enmène une caisse de marchandise a l'armurier d'Avignon."),
      (call_script, "script_start_quest", "qst_messager_qst7d", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre7", 0),
  ]],
  [anyone|plyr ,"dmess_parrir_avignon", [],  "Je regrette, mais Je n'ai pas le temps.", "dmess_parrir_avignonnon", []],
  [anyone ,"dmess_parrir_avignonnon", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"dmess_parrir_avignonok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant
  [anyone ,"dmess_sort_script", [(eq, "$messager_qst_star", 8),],"Non, Je n'ai rien pour le moment, mais ca ne saurais tarder.", "close_window", []],
  
  #suivant reims
  [anyone ,"dmess_sort_script", [(eq, "$messager_qst_star", 9),],"Une caisse doit etre livrée au forgeron de Reims, pouvez vous aller la bas ?", "dmess_parrir_areims", []],
  [anyone|plyr ,"dmess_parrir_areims", [],  "Tres bien, je me rendrais a Reims", "dmess_parrir_areimsok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une caisse a remettre au forgeron de Reims."),
      (call_script, "script_start_quest", "qst_messager_qst9d", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre9", 0),
  ]],
  [anyone|plyr ,"dmess_parrir_areims", [],  "Je regrette, mais Je n'ai pas le temps.", "dmess_parrir_areimsnon", []],
  [anyone ,"dmess_parrir_areimsnon", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"dmess_parrir_areimsok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  
  [anyone ,"dmess_sort_script", [(eq, "$messager_qst_star", -1),],"Non, Je n'ai rien pour le moment, mais ca ne saurais tarder.", "close_window", []],
  
  
  #maitre de marseille
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_messenger_master_calais"),
    ],
    "Cherchez vous du travail messire ? vous pouriez travailler comme courssier, il n'y a rien de plus simple, je vous donne une lettre ou un paquet et vous devez l'apporter au receveur, qu'en dites vous ?", "mmess_calais_start1", []],
  
  [anyone|plyr ,"mmess_calais_start1", [],  "Ca m'intéresse,dites m'en plus.", "mmess_calais_direp", []],
  [anyone|plyr ,"mmess_calais_start1", [],  "Je ne suis pas un simple messager, merci.", "close_window", []],
  
  [anyone ,"mmess_calais_direp", [],"Que voullez vous savoir ?", "mmess_calais_qa", []],
  
  [anyone|plyr ,"mmess_calais_qa", [],  "Combien vais je etre payer ?", "mmess_calais_paye", []],
  [anyone|plyr ,"mmess_calais_qa", [],  "Avez vous une lettre ou un paquet a remetre ?", "mmess_calais_go", []],
  [anyone|plyr ,"mmess_calais_qa", [],  "Avez vous des consseils a me donner sur le metier de Messager ?", "mmess_calais_cons", []],
  [anyone|plyr ,"mmess_calais_qa", [],  "Y a t'il d'autres guildes des Messagers en France ?", "mmess_calais_fran", []],
  [anyone|plyr ,"mmess_calais_qa", [],  "C'est tout ce que je voulais savoir, merci.", "close_window", []],
  
  
  [anyone ,"mmess_calais_paye", [],"Peut importe la distance, vous serez toujours payé 150 écus, c'est le prix d'une course partout en France, qu'une lettre soit pour un sabotier qui attend des nouvelles de sa famille ou qu'elle soit pour le Roi lui meme c'est le meme tarif.", "mmess_calais_qa", []],
  [anyone ,"mmess_calais_fran", [],"Bien sure, il y en a une a Calais, a Bourges, Bordeau et Marseille, si vous allez remettre une lettre a un client de Marseille, allez voir le representant de la guilde de cette ville pour qu'il vous donne a son tour une course, ainssi vous ne reviendrais pas les mains vides et les courses deviendront rentables, penssez y.", "mmess_calais_qa", []],
  [anyone ,"mmess_calais_cons", [],"Et bien, apporter une lettre n'es pas difficile en soit, mais parcourire autant de distance le plus vite possible en évitant les groupes de brigands n'es pas des plus aisé, voyager sur des plaines déboisées es souvent plus sur que de traversser des bois, vous ne veriez des bandits en embuscade que bien trop tard.", "mmess_calais_cons2", []],
  [anyone ,"mmess_calais_cons2", [],"Mais vous ne pouvez point vous permettre non plus d'etre trop regardant sur le trajet, un chemin plus sure es toujours plus long, mais le client attend et cela fait moin d'argent pour vous.de plus je vous conseille de voyager seul ou avec deux ou trois autres compagnons seulement, il vaut mieux etre rapide pour échapper aux brigands que d'etre accompagner d'une escorte qui vous ralentirais, de toute facon, vous ne pouriez pas payer des gardes des mercenaires avec votre revenu, la vie de messager es simple, et faite des voyage de découvertes, mais aussi de dangers alors soyez toujours sur vos gardes.", "mmess_calais_cons3", []],
  [anyone ,"mmess_calais_cons3", [],"Et pour finire, je vous recommande de trouver une monture rapide, meme si elle es un peut chére, elle représente un bon investissement pour pouvoir faire des courses plus rapidement.le Messager es malin avant tout, évite les piéges et sait tirer partie de chaques situations.", "mprmess_calais_qa", []],
  [anyone ,"mprmess_calais_qa", [],"Avez vous d'autres questions ?", "mmess_calais_qa", []],
  
  [anyone ,"mmess_calais_go", [],"Bien sure, voyez vous il y aura toujours plus de lettres ou paquets a porter que de Messagers, j'ai justement quelque chose qui viens d'ariver.", "mmess_sort_script",
    [
      (call_script, "script_mesenger_part"),
  ]],
  
  ##### tirage au sort #### begin
  [anyone ,"mmess_sort_script", [(eq, "$messager_qst_star", 0),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de montpelier, acceptez vous cette course ?", "mmess_calais_direp2", []],
  [anyone|plyr ,"mmess_calais_direp2", [],  "Tres bien, je me rendrais a montpelier", "mmess_calais_deeprd",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Montpellier."),
      (call_script, "script_start_quest", "qst_messager_qst0m", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre0", 0),
  ]],
  [anyone|plyr ,"mmess_calais_direp2", [],  "Je regrette, mais je ne peut.", "mmess_calais_direp2dd", []],
  [anyone ,"mmess_calais_direp2dd", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"mmess_calais_deeprd", [],"Bien, faites attention a vous et a la marchandise.", "close_window", []],
  
  #suivant 1
  [anyone ,"mmess_sort_script", [(eq, "$messager_qst_star", 1),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de Marseille, pouvez vous aller la bas ?", "mmess_marsss_direp2", []],
  [anyone|plyr ,"mmess_marsss_direp2", [],  "Tres bien, je me rendrais a Marseille", "mmess_marsss_direp2ok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Marseille."),
      (call_script, "script_start_quest", "qst_messager_qst1m", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre1", 0),
  ]],
  [anyone|plyr ,"mmess_marsss_direp2", [],  "Je regrette, mais Je n'ai pas le temps.", "mmess_marsss_direp2non", []],
  [anyone ,"mmess_marsss_direp2non", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"mmess_marsss_direp2ok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant2PARIS
  [anyone ,"mmess_sort_script", [(eq, "$messager_qst_star", 2),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de Paris, pouvez vous aller la bas ?", "mmess_parrir_direp2", []],
  [anyone|plyr ,"mmess_parrir_direp2", [],  "Tres bien, je me rendrais a Paris", "mmess_parrir_direp2ok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Paris."),
      (call_script, "script_start_quest", "qst_messager_qst2m", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre2", 0),
  ]],
  [anyone|plyr ,"mmess_parrir_direp2", [],  "Je regrette, mais Je n'ai pas le temps.", "mmess_parrir_direp2oknon", []],
  [anyone ,"mmess_parrir_direp2oknon", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"mmess_parrir_direp2ok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant3 DIJON
  [anyone ,"mmess_sort_script", [(eq, "$messager_qst_star", 3),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de Dijon, pouvez vous aller la bas ?", "mmess_parrir_diijonn", []],
  [anyone|plyr ,"mmess_parrir_diijonn", [],  "Tres bien, je me rendrais en Bourgogne.", "mmess_parrir_diijonn2",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Dijon."),
      (call_script, "script_start_quest", "qst_messager_qst3m", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre3", 0),
  ]],
  [anyone|plyr ,"mmess_parrir_diijonn", [],  "Je regrette, mais Je n'ai pas le temps.", "mmess_parrir_diijonn2non", []],
  [anyone ,"mmess_parrir_diijonn2non", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"mmess_parrir_diijonn2", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant4CAEN
  [anyone ,"mmess_sort_script", [(eq, "$messager_qst_star", 4),],"Oui, j'ai une lettre qui doit parvenire dans les plus brefs delais au maitre de guilde des marchads de Caen, pouvez vous aller la bas ?", "mmess_parrir_caaeenn", []],
  [anyone|plyr ,"mmess_parrir_caaeenn", [],  "Tres bien, je me rendrais dans le nord.", "mmess_parrir_caaeennok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une lettre a remetre au maitre de la guilde des Marchands de Caen."),
      (call_script, "script_start_quest", "qst_messager_qst4m", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre4", 0),
  ]],
  [anyone|plyr ,"mmess_parrir_caaeenn", [],  "Je regrette, mais Je n'ai pas le temps.", "mmess_parrir_caaeennno", []],
  [anyone ,"mmess_parrir_caaeennno", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"mmess_parrir_caaeennok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant bordeau
  [anyone ,"mmess_sort_script", [(eq, "$messager_qst_star", 5),],"J'ai une caisse a enmener a un marchand de livres a Bordeau, c'est au cartier marchand sainte Catherine, pouvez vous aller la bas ?", "mmess_parrir_boordeauu", []],
  [anyone|plyr ,"mmess_parrir_boordeauu", [],  "Tres bien, j'irais a Bordeau.", "mmess_parrir_boordeauuok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers veux que j'enmène une caisse de livres au marchand de Bordeau au quartier Sainte Catherine."),
      (call_script, "script_start_quest", "qst_messager_qst5m", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre5", 0),
  ]],
  [anyone|plyr ,"mmess_parrir_boordeauu", [],  "Je regrette, mais Je n'ai pas le temps.", "mmess_parrir_boordeauuokno", []],
  [anyone ,"mmess_parrir_boordeauuokno", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"mmess_parrir_boordeauuok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant  PARIS
  [anyone ,"mmess_sort_script", [(eq, "$messager_qst_star", 6),],"J'ai une caisse a enmener a l'armurier de Paris sur la place principale, pouvez vous aller la bas ?", "mmess_parrir_parissi", []],
  [anyone|plyr ,"mmess_parrir_parissi", [],  "Tres bien, j'irais a Paris.", "mmess_parrir_parissiok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers veux que j'enmène une caisse de marchandise a l'armurier de Paris."),
      (call_script, "script_start_quest", "qst_messager_qst6m", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre6", 0),
  ]],
  [anyone|plyr ,"mmess_parrir_parissi", [],  "Je regrette, mais Je n'ai pas le temps.", "mmess_parrir_parissiokno", []],
  [anyone ,"mmess_parrir_parissiokno", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"mmess_parrir_parissiok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant avignon
  [anyone ,"mmess_sort_script", [(eq, "$messager_qst_star", 7),],"J'ai une caisse a enmener a l'armurier d-Avignon sur la place principale, pouvez vous aller la bas ?", "mmess_parrir_avignon", []],
  [anyone|plyr ,"mmess_parrir_avignon", [],  "Tres bien, j'irais a Avignon.", "mmess_parrir_avignonok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers veux que j'enmène une caisse de marchandise a l'armurier d'Avignon."),
      (call_script, "script_start_quest", "qst_messager_qst7m", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre7", 0),
  ]],
  [anyone|plyr ,"mmess_parrir_avignon", [],  "Je regrette, mais Je n'ai pas le temps.", "mmess_parrir_avignonnon", []],
  [anyone ,"mmess_parrir_avignonnon", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"mmess_parrir_avignonok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  #suivant
  [anyone ,"mmess_sort_script", [(eq, "$messager_qst_star", 8),],"Non, Je n'ai rien pour le moment, mais ca ne saurais tarder.", "close_window", []],
  
  #suivant reims
  [anyone ,"mmess_sort_script", [(eq, "$messager_qst_star", 9),],"Une caisse doit etre livrée au forgeron de Reims, pouvez vous aller la bas ?", "mmess_parrir_areims", []],
  [anyone|plyr ,"mmess_parrir_areims", [],  "Tres bien, je me rendrais a Reims", "mmess_parrir_areimsok",
    [
      #start quete/add item lettre ou colis
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le maitre de la guilde des Messagers m'a donné une caisse a remettre au forgeron de Reims."),
      (call_script, "script_start_quest", "qst_messager_qst9m", "$g_talk_troop"),
      (troop_add_item, "trp_player", "itm_lettre9", 0),
  ]],
  [anyone|plyr ,"mmess_parrir_areims", [],  "Je regrette, mais Je n'ai pas le temps.", "mmess_parrir_areimsnon", []],
  [anyone ,"mmess_parrir_areimsnon", [],"C'es bien la première fois que je voie un messager reffuser une mission, honte a vous.", "close_window", []],
  [anyone ,"mmess_parrir_areimsok", [],"Bien, alors dépechez vous.", "close_window", []],
  
  
  [anyone ,"mmess_sort_script", [(eq, "$messager_qst_star", -1),],"Non, Je n'ai rien pour le moment, mais ca ne saurais tarder.", "close_window", []],
  
  ##########################################################################################################################################################################   ##############################dial place forte neutre end
  
  
  
  ### DIALOGUES CAMPS
  # 1429 dialogues camps 1
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_1"),
    ],
    "Bon sang,quel froid ! En plus c'est plein de loups par ici...", "dial_camp_base_1", [(play_sound, "snd_capitaine"),]],
  
  [anyone|plyr ,"dial_camp_base_1", [],  "Jouons quelques écus aux dés...", "jeu_descamp_1", []],
  [anyone|plyr ,"dial_camp_base_1", [],  "Si vous avez froid,un peut d'entrainement vous rechaufera.", "entrainement_refus", []],
  [anyone ,"entrainement_refus", [],"Ben,tous comptes faits capitaine,fais pas si froid que ca.", "close_window", []],
  [anyone|plyr ,"dial_camp_base_1", [],  "Restez sur vos gardes...", "close_window", []],
  
  # pile ou face
  
  [anyone,"jeu_descamp_1", [
      ], "J'allais vous le proposer, On allais creuver d'enuie ici. ", "generique_des",[]],
  
  
  # 1429 dialogues camps 2
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_4"),
    ],
    "Je suis un peut a cran car je n'aime pas devoir me battre en forêt.", "dial_camp_base_12", [(play_sound, "snd_capitaine"),]],
  
  [anyone|plyr ,"dial_camp_base_12", [],  "Jouons quelques écus...", "jeu_pile_face_generique_2", []],
  [anyone|plyr ,"dial_camp_base_12", [],  "En forêt ou ailleurs,l'éssentiel es que nous soyons superieurs en nombre ou en qualité.", "foret_combat", []],
  [anyone ,"foret_combat", [],"Bien dit Capitaine ! éspérons que l'on coresponde a un des deux cas.", "close_window", []],
  [anyone|plyr ,"dial_camp_base_12", [],  "Restez prudents,meme si nous sommes cachés dans la forêt,d'autres troupes pourais s'y cacher aussi...", "close_window", []],
  
  # pile ou face v
  
  [anyone,"jeu_pile_face_generique_2", [
      ], "éxéllente idée ! Rien de mieux pour se détendre. ", "generique_des",[]],
  
  
  
  # 1429 dialogues camps 3
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_7"),
    ],
    "Capitaine...vous devriez vous détendre,nous surveillons le camp.Pourquois ne pas faire un tour ?", "dial_camp_base_13", [(play_sound, "snd_capitaine"),]],
  
  [anyone|plyr ,"dial_camp_base_13", [],  "Jouons quelques écus...", "jeu_pile_face_generique_3", []],
  [anyone|plyr ,"dial_camp_base_13", [],  "Vous avez raison,je vais explorer les environs.", "environs_campagne", []],
  [anyone ,"environs_campagne", [],"Tres bien,si on entend des cavaliers on fera soner l'oliphant.", "close_window", []],
  [anyone|plyr ,"dial_camp_base_13", [],  "Nous repartons bientot,inutile de s'atarder.", "close_window", []],
  
  # pile ou face
  
  [anyone,"jeu_pile_face_generique_3", [
      ], "Enfin un peut de détente. ", "generique_des",[]],
  
  # 1429 dialogues camps 4
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_10"),
    ],
    "Quelles belles contrés,n'es ce pas Capitaine ?", "dial_camp_base_14", [(play_sound, "snd_capitaine"),]],
  
  [anyone|plyr ,"dial_camp_base_14", [],  "Jouons quelques écus...", "jeu_pile_face_generique_4", []],
  [anyone|plyr ,"dial_camp_base_14", [],  "Vous etes du coin ?.", "belles_contres", []],
  [anyone ,"belles_contres", [],"Non,mais si je vivais assez longtemp pour avoir assez d'écus pour m'instaler,je rechercherais une terre non loing d'ici. .", "close_window", []],
  [anyone|plyr ,"dial_camp_base_14", [],  "Nous repartons bientot.", "close_window", []],
  
  # pile ou face
  
  [anyone,"jeu_pile_face_generique_4", [
      ], "Bonne idée Capitaine,si vous avez des écus a perdre,moi je n'en aurais jamais assez. ", "generique_des",[]],
  
  ### confident1
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_2"),
    ],
    "Mon seigneur...enfin,Capitaine comme on dit,je ne sais pas trop comment c'est qu'on doit vous appeller,j'etait simplement paysan tantot,et me voila dans les armes...quelle histoire !", "dial_camp_discute_1p", [(play_sound, "snd_capitaine"),]],
  [anyone ,"pre_dial_camp_discute", [],"Autre chose Capitaine ? c'est bien ca (capitaine) ?.", "dial_camp_discute_1p", []],
  
  [anyone|plyr ,"dial_camp_discute_1p", [],  "Appellez moi comme vous le sentirez sur le moment.", "dial_camp_discute_simple", []],
  [anyone|plyr ,"dial_camp_discute_1p", [],  "Capitaine suffira pour l'instant...et comportez vous comme un fantassin.", "dial_camp_discute_captaine", []],
  [anyone|plyr ,"dial_camp_discute_1p", [],  "A plus tard...", "close_window", []],
  
  [anyone ,"dial_camp_discute_simple", [],"Ben ca !...vous etes comme un camarade pour moi Messire.Ho je suivrais vos ordres bien entendu,mais c'est avec admiration que je le ferais,rien de telle qu'une franche camaraderie !.", "dial_camp_discute_simple_2", []],
  
  [anyone|plyr ,"dial_camp_discute_simple_2", [],  "Rien de tel c'est vrais,et si vous me racontiez votre histoire...", "dial_camp_discute_simple_3", []],
  [anyone|plyr ,"dial_camp_discute_simple_2", [],  "Tans mieux,a plus tard,j'ai a faire.", "close_window", []],
  
  [anyone ,"dial_camp_discute_simple_3", [],"Je suis né dans le nord de la France,prés de Caen,je travaille dans les champs depuis que je suis petiot,puis quand les Anglois sont arivés,je suis parti en laissant mon village,j'ai pris un travail dans le village ou vous m'avez vu pour la premiere fois,et je suis la a en parler avec vous...rien de bien interessant,mais je n'aurais jamais cru que je deviendrais soldat.", "dial_camp_discute_simple_4", []],
  [anyone|plyr ,"dial_camp_discute_simple_4", [],  "Rassurez vous,tout va bien se passer.", "pre_dial_camp_discute", []],
  
  [anyone ,"dial_camp_discute_captaine", [],"Ben...bien sur Capitaine,je ferais des efforts...encore des efforts.(marmone quelque chose dans sa barbe).", "pre_dial_camp_discute", []],
  
  
  ### confident2
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_5"),
    ],
    "Capitaine...Je doit m'occupper des chevaux,en suite je doit aiguiser les armes.", "dial_camp_travail", [(play_sound, "snd_capitaine"),]],
  [anyone ,"pre_dial_camp_foret_2", [],"Autre chose a me dire Capitaine ?.", "dial_camp_travail", []],
  
  [anyone|plyr ,"dial_camp_travail", [],  "N'oubliez pas de vous reposer.", "dial_camp_travail_2", []],
  [anyone|plyr ,"dial_camp_travail", [],  "Alors depechez vous un peut.", "dial_camp_tyran_foret", []],
  [anyone|plyr ,"dial_camp_travail", [],  "Conaissez vous une histoire...une anegdote ?.", "dial_camp_discute_histoire", []],
  [anyone|plyr ,"dial_camp_travail", [],  "Continuez dans ce cas.", "close_window", []],
  
  [anyone ,"dial_camp_travail_2", [],"Me reposer ?..en effet Capitaine,c'est important ca aussi,mais comment fermer l'oeil avec le bruit de la foret ?.", "dial_camp_bruit_foret", []],
  
  [anyone|plyr ,"dial_camp_bruit_foret", [],  "Essayez de vous endormir,pourquois pas apres une petite discussion avec vos camarades ?", "dial_camp_bruit_foret_22", []],
  [anyone|plyr ,"dial_camp_bruit_foret", [],  "Dormez le plus possible,j'ai besoin de toutes vos forces,et bas d'excès de boison pour dormir plus facilement.", "close_window", []],
  
  [anyone ,"dial_camp_bruit_foret_22", [],"C'est que...ils ont tous peur de la forêt,et me comunique leur peur,ca ne va pas m'aidder a m'endormir.", "dial_camp_bruit_foret_21", []],
  [anyone|plyr ,"dial_camp_bruit_foret_21", [],  "Penssez a un autre endroit,comme la taverne.", "dial_camp_bruit_foret_23", []],
  [anyone|plyr ,"dial_camp_bruit_foret_21", [],  "Aretez avec ca,vous n'etes plus des enfants.", "pre_dial_camp_foret_2", []],
  [anyone ,"dial_camp_bruit_foret_23", [],"Ho !...c'est une excellente idee Capitaine,vous etes tres fort,bien vu.", "pre_dial_camp_foret_2", []],
  
  [anyone ,"dial_camp_tyran_foret", [],"Bien,bien,je pourais faire plus vite si vous ne m'interompiez pas.", "close_window", []],
  
  [anyone ,"dial_camp_discute_histoire", [],"Si,maintenant que vous m'en parlez,quelqu'un de la troupe m'as dit que non loing de cette foret vie une etrange sorciere,il parait qu'elle fait bouillir des chats pour en faire des potions,quelqu'un du village l'aurais vue,et a peine avait t'il appercue la vielle qu'elle serais devenue un loup noir et elle se serais mise a courir dans les bois !.", "dial_camp_foret_fear", []],
  
  [anyone|plyr ,"dial_camp_foret_fear", [],  "Surtout vous ne racontez pas ca aux autres d'accord ?.", "pre_dial_camp_foret_2", []],
  ### confident3
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_8"),
    ],
    "Vous sentez cette odeur ?..", "dial_camp_campagne", [(play_sound, "snd_capitaine"),]],
  [anyone ,"pre_dial_camp_campagne", [],"J'éspère que nous restons cette nuit,j'aimerais encore profiter des odeurs.", "dial_camp_campagne", []],
  
  [anyone|plyr ,"dial_camp_campagne", [],  "L'odeur de la campagne ?.", "dial_camp_campagne_2", []],
  [anyone|plyr ,"dial_camp_campagne", [],  "Si c'est votre odeur qu'il faut sentir,sachez que je m'en passerais aujourd'hui,et allez donc jusqu'a ce puit pour vous laver.", "dial_camp_tyran_campagne", []],
  [anyone|plyr ,"dial_camp_campagne", [],  "Je doit partir,a plus tard.", "close_window", []],
  
  [anyone ,"dial_camp_campagne_2", [],"Exactement,l'odeur de la terre retournée,les récoltes,les vignes,aucune vie n'es meilleure que celle d'un honete travailleur.", "dial_camp_campagne_honet", []],
  
  [anyone|plyr ,"dial_camp_campagne_honet", [],  "Ca ne doit pas etre si mal en effet.", "dial_camp_vie_camppagne", []],
  [anyone|plyr ,"dial_camp_campagne_honet", [],  "Ca doit etre terible d'etre retenue quelque part,rien de mieu que la libérté au contraire.", "pre_dial_camp_campagne", []],
  
  [anyone ,"dial_camp_vie_camppagne", [],"Ho,c'est vrais vous pouvez me croire,se lever au champ du coq a l'aube,travailler au soleil,et vivre de son labeur.", "dial_camp_vie_camppagne_rep", []],
  [anyone|plyr ,"dial_camp_vie_camppagne_rep", [],  "Une vie simple et paisible.", "dial_camp_campagne_simpl", []],
  [anyone|plyr ,"dial_camp_vie_camppagne_rep", [],  "Travailler encore et encore...je ne sais pas si c'est fait pour moi,je preéfére une vie dangeureuse mais plus passionante.", "pre_dial_camp_campagne", []],
  [anyone ,"dial_camp_campagne_simpl", [],"Une vie paisible oui...puis es venue la guerre,et nous avons du renoncer a nos champs brulés et laisser derière nous les restes de nos fermes brulées,ces chiens nous le payerons a tous,jusqu'au dernier!.", "pre_dial_camp_campagne", []],
  
  [anyone ,"dial_camp_tyran_campagne", [],"Bha,j'y vais si c'est un ordre,mais comme tout le monde sens cette odeur,je ne penssais pas que ca dérangerais qui que ce soit.", "close_window", []],
  
  
  ### confident4
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_11"),
    ],
    "Pourquois camper au bord de la grand route Capitaine ?", "dial_camp_plain", [(play_sound, "snd_capitaine"),]],
  [anyone ,"pre_dial_camp_plain", [],"Tres bien,mais je ne comprend toujours pas pourquois on campes ici,sauf votre respect.", "dial_camp_plain", []],
  
  [anyone|plyr ,"dial_camp_plain", [],  "Pourquois pas ?.", "dial_camp_plain_2", []],
  [anyone|plyr ,"dial_camp_plain", [],  "Me prendriez vous pour un voleur par hasard ? je ne veux nullement attaquer les marchand rassurez vous.", "dial_camp_plain_2", []],
  [anyone|plyr ,"dial_camp_plain", [],  "Nous parlerons de ca plus tard.", "close_window", []],
  
  [anyone ,"dial_camp_plain_2", [],"Non,c'est juste que si l'host ennemie passait par la...", "dial_camp_plainenemi", []],
  
  [anyone|plyr ,"dial_camp_plainenemi", [],  "Et bien si l'ennemi a le droit de prendre la grand route pourquois pas nous ?.", "dial_camp_route", []],
  [anyone|plyr ,"dial_camp_plainenemi", [],  "Ca ne sont pas vos affaires,laissez moi diriger et contentez vous de frapper l'ennemi.", "pre_dial_camp_plain", []],
  
  [anyone ,"dial_camp_route", [],"J'appréci votre courage Capitaine,mais ca reste quand meme tres dangeureux.", "dial_camp_route_2", []],
  [anyone|plyr ,"dial_camp_route_2", [],  "Parfois on es obligés de prendre les chemins les plus courts,ne vous inquitez pas j'ai la situation en mains.", "dial_camp_routefin", []],
  [anyone|plyr ,"dial_camp_route_2", [],  "Camper ici ou ailleurs...l'ennemi es partout vous savez.", "pre_dial_camp_plain", []],
  [anyone ,"dial_camp_routefin", [],"Hum...je suis convaincu Capitaine,nous n'avons pas le choix,pardon d'avoir douté de vous.", "close_window", []],
  [anyone|plyr ,"dial_camp_route_2", [],  "Pardon,mais j'ai a faire.", "close_window", []],
  
  ### chants 1
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_chant_1"),
    ],
    "Pas trop froid Capitaine ?", "dial_camp_chanteur_1", [(play_sound, "snd_capitaine"),]],
  
  [anyone|plyr ,"dial_camp_chanteur_1", [],  "Chantons pour nous réchuffer.", "dial_camp_discute_chantrech", []],
  [anyone|plyr ,"dial_camp_chanteur_1", [],  "Je vais faire un tour pour me réchauffer les jambes.", "dial_camp_discute_jambes", []],
  
  [anyone ,"dial_camp_discute_jambes", [],"Vous feriez aussi bien de marcher sur le feu,bon sang ce qu'il fait froid dans le nord.", "close_window", []],
  
  [anyone ,"dial_camp_discute_chantrech", [],"Exélente idée,je peut vous apprendre une chanson de mon village...que de souvenirs...", "dial_camp_discute_chant_fin",[]],
  [anyone|plyr ,"dial_camp_discute_chant_fin", [],  "Chantons et buvons...", "close_window",
    [
      (play_sound, "snd_chant_1"),
  ]],
  ### chants 2
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_chant_2"),
    ],
    "Je n'aime pas dormir dans les bois,Capitaine.", "dial_camp_chanteur_bois", [(play_sound, "snd_capitaine"),]],
  
  [anyone|plyr ,"dial_camp_chanteur_bois", [],  "Chantez en coeur,comme ca vous n'y penserez plus.", "dial_camp_discute_chantpens", []],
  [anyone|plyr ,"dial_camp_chanteur_bois", [],  "Il n'y a rien de diabolique dans une foret,juste des idiots qui ont peurs.", "dial_camp_discute_foretpeur", []],
  
  [anyone ,"dial_camp_discute_foretpeur", [],"Bha,si vous le dites,vous verez bien ce soir...", "close_window", []],
  
  [anyone ,"dial_camp_discute_chantpens", [],"Si vous voulez,je me rappelle d'une chanson de ma ville natale.", "dial_camp_discute_chantfor_2", []],
  
  [anyone|plyr ,"dial_camp_discute_chantfor_2", [],  "Vous etes sur de ne pas l'avoir entendu dans une taverne ?", "close_window",
    [
      (play_sound, "snd_chant_2"),
  ]],
  ### chants 3
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_chant_3"),
    ],
    "Quel endroit paisible,il semble qu'il n'y es jamais eu la guerre ici.", "dial_camp_chanteur_paix", [(play_sound, "snd_capitaine"),]],
  
  [anyone|plyr ,"dial_camp_chanteur_paix", [],  "Nous chanteriez vous une mélodie ?.", "dial_camp_discute_chant_campagne", []],
  [anyone|plyr ,"dial_camp_chanteur_paix", [],  "Reposez vous,ont se voient plus tard.", "close_window", []],
  
  [anyone ,"dial_camp_discute_chant_campagne", [],"Oui,avec plaisir,j'ai été troubadour.", "dial_camp_discute_chantfor_e2h", []],
  [anyone|plyr ,"dial_camp_discute_chantfor_e2h", [],  "J'avais deviné a votre facon de tenir votre épée.", "close_window",
    [
      (play_sound, "snd_chant_1"),
  ]],
  ### chants 4
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_chant_4"),
    ],
    "Ca fait du bien de s'areter un peut,et de se reposer devans un feu.", "dial_camp_chanteur_feu", [(play_sound, "snd_capitaine"),]],
  
  [anyone|plyr ,"dial_camp_chanteur_feu", [],  "Ca ne vous inspire pas une chanson ?.", "dial_camp_discute_chant_insp", []],
  [anyone|plyr ,"dial_camp_chanteur_feu", [],  "Profitez en,nous partons bientot.", "close_window", []],
  
  [anyone ,"dial_camp_discute_chant_insp", [],"Si bien sur,si ca vous fait plaisir.", "close_window",
    [
      (play_sound, "snd_chant_2"),
  ]],
  
  #### sentinel 1
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_3"),
    ],
    "J'ai pris le premier tour de garde Messire,je surveille les alentours du camp a cause des loups.", "dial_camp_sent_1", [(play_sound, "snd_capitaine"),]],
  
  [anyone|plyr ,"dial_camp_sent_1", [],  "Et que faites vous si une meute rentre dans le camp ?.", "dial_camp_sent_loup", []],
  [anyone|plyr ,"dial_camp_sent_1", [],  "Bon courage.", "close_window", []],
  
  [anyone ,"dial_camp_sent_loup", [],"Capitaine...je ne suis pas idiot,les loups ont peur du feu,de plus si une meute attaquais,j'aurais le temp d'en tuer quelques uns avant d'alerter le camp.", "dial_camp_sentloupok", []],
  
  [anyone|plyr ,"dial_camp_sentloupok", [],  "C'est tres bien,et que feriez vous face a une meute anglaise ?", "dial_camp_sent_anglais", []],
  [anyone ,"dial_camp_sent_anglais", [],"Ben la meme chose,sauf que eux ils n'ont pas peur d'un feu.", "close_window", []],
  
  #### sentinel 2
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_6"),
    ],
    "Vous l'avez vu ?.", "dial_camp_sent_2", [(play_sound, "snd_capitaine"),]],
  
  [anyone|plyr ,"dial_camp_sent_2", [],  "Qui donc ?.", "dial_camp_sent_cerf", []],
  
  [anyone ,"dial_camp_sent_cerf", [],"Un serf ! de toute beauté,j'ai failli le tirer mais il s'est enfuit.", "dial_camp_sentcerfok", []],
  
  [anyone|plyr ,"dial_camp_sentcerfok", [],  "C'etait son jour et pas le votre.", "dial_camp_sent_nocerf", []],
  [anyone ,"dial_camp_sent_nocerf", [],"C'est quand meme domage.", "close_window", []],
  
  #### sentinel 3
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_9"),
    ],
    "Ne vous inquiétez pas,je garde les entrés du camp,vous pouvez dormir tranquile.", "close_window", [(play_sound, "snd_capitaine"),]],
  
  #### sentinel 4
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_12"),
    ],
    "Rien a signaler,la route es calme.", "dial_camp_sent_route", [(play_sound, "snd_capitaine"),]],
  
  [anyone|plyr ,"dial_camp_sent_route", [],  "meme pas un convoi de marchand ?", "dial_camp_sent_marchant", []],
  
  [anyone ,"dial_camp_sent_marchant", [],"Non,j'éspère que l'on as tout ce qu'il faut.", "close_window", []],
  
  #sergeant 1
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_serg_1"),
    ],
    "Capitaine, nous vous attendions. quelles sont les directives ?", "directivescampsserg1", [(play_sound, "snd_capitaine"),]],
  
  [anyone|plyr ,"directivescampsserg1", [],  "Préparons la prochaine bataille...", "dial_batailletent", []],
  [anyone|plyr ,"directivescampsserg1", [],  "Parlez moi de cet endroit.", "dial_tente_comand", []],
  [anyone|plyr ,"directivescampsserg1", [],  "Au repos pour le moment.", "close_window", []],
  
  [anyone ,"dial_tente_comand", [],"Nous sommes sous la tente de comandement, ici nous nous réunissons pour décider des operations, cela semble évident...vous sentez vous bien Messire ?", "directivescampsserg1", []],
  # [anyone|plyr ,"prepa_tente_bat", [],  "Si nous devrons nous battre dans un champ de bataille...", "dial_batailletent", []],
  #[anyone|plyr ,"prepa_tente_bat", [],  "Préparons le prochain siège...", "dial_siegetent", []],
  # [anyone|plyr ,"directivescampsserg1", [],  "Non, ca n'est pas important...", "directivescampsserg1", []],
  
  [anyone ,"dial_batailletent", [],"Que dois je dire aux hommes ?", "start_tenteplanbat", []],#
  [anyone|plyr ,"start_tenteplanbat", [(eq, "$ordre_stop_b", 0),],  "Dites a tous de ne rien tenter et d'attendre en position.", "generique_ordretente_suite", [(assign, "$ordre_stop_b", 1),]],
  [anyone|plyr ,"start_tenteplanbat", [(eq, "$ordre_stop_b", 1),],  "Dites a tout le monde de charger a la vue de l'ennemi.", "generique_ordretente_suite", [(assign, "$ordre_stop_b", 0),]],
  
  
  [anyone|plyr ,"start_tenteplanbat", [],  "Dites aux fantassins...", "av_generique_ordretente_suite_inf", []],
  [anyone|plyr ,"start_tenteplanbat", [],  "Dites aux chevaliers...", "av_generique_ordretente_suite_cav", []],
  [anyone|plyr ,"start_tenteplanbat", [],  "Avertissez les archers...", "av_generique_ordretente_suite_arch", []],
  
  [anyone|plyr ,"start_tenteplanbat", [],  "Reprenons du debut, je suis perdu.", "generique_ordretente_suite",
    [
      (assign, "$ordre_stop_b", 0),
      (assign, "$ordre_stop_i", 0),
      (assign, "$ordre_stop_c", 0),
      (assign, "$ordre_stop_a", 0),
      (assign, "$ordre_stopfire_b", 0),
      (assign, "$ordre_follow_i", 0),
      (assign, "$ordre_follow_c", 0),
      (assign, "$ordre_follow_a", 0),
      (assign, "$ordre_adv_i", 0),
      (assign, "$ordre_adv_c", 0),
      (assign, "$ordre_adv_a", 0),
      (assign, "$ordre_back_i", 0),
      (assign, "$ordre_back_c", 0),
      (assign, "$ordre_back_a", 0),
      (assign, "$ordre_standc_i", 0),
      (assign, "$ordre_standc_c", 0),
      (assign, "$ordre_standc_a", 0),
      (assign, "$ordre_spread_i", 0),
      (assign, "$ordre_spread_c", 0),
      (assign, "$ordre_spread_a", 0),
  ]],
  
  
  [anyone ,"av_generique_ordretente_suite_inf", [],"Oui ?", "generique_ordretente_suite_inf", []],#
  [anyone ,"av_generique_ordretente_suite_cav", [],"Oui ?", "generique_ordretente_suite_cav", []],#
  [anyone ,"av_generique_ordretente_suite_arch", [],"Oui ?", "generique_ordretente_suite_arch", []],#
  
  
  
  
  
  [anyone ,"re_generique_ordretente_suite_inf", [],"Entendu.", "generique_ordretente_suite_inf", []],#
  [anyone ,"re_generique_ordretente_suite_cav", [],"Entendu.", "generique_ordretente_suite_cav", []],#
  [anyone ,"re_generique_ordretente_suite_arch", [],"Entendu.", "generique_ordretente_suite_arch", []],#
  
  #inf
  [anyone|plyr ,"generique_ordretente_suite_inf", [(eq, "$ordre_stop_i", 0),],  "Qu'ils tiennent la position.", "re_generique_ordretente_suite_inf", [(assign, "$ordre_stop_i", 1),]],
  [anyone|plyr ,"generique_ordretente_suite_inf", [(eq, "$ordre_stop_i", 1),],  "Qu'ils chargent a la vue de l'ennemi.", "re_generique_ordretente_suite_inf", [(assign, "$ordre_stop_i", 0),]],
  
  [anyone|plyr ,"generique_ordretente_suite_inf", [(eq, "$ordre_follow_i", 0),],  "Qu'ils doivent me suivre.", "re_generique_ordretente_suite_inf", [(assign, "$ordre_follow_i", 1),]],
  [anyone|plyr ,"generique_ordretente_suite_inf", [(eq, "$ordre_follow_i", 1),],  "Qu'ils arretent de me suivre.", "re_generique_ordretente_suite_inf", [(assign, "$ordre_follow_i", 0),]],
  
  [anyone|plyr ,"generique_ordretente_suite_inf", [(eq, "$ordre_adv_i", 0),],  "Qu'ils avancent devant les archers.", "re_generique_ordretente_suite_inf", [(assign, "$ordre_adv_i", 1),]],
  [anyone|plyr ,"generique_ordretente_suite_inf", [(eq, "$ordre_adv_i", 1),],  "Qu'ils aretent de se mettre devant les archers.", "re_generique_ordretente_suite_inf", [(assign, "$ordre_adv_i", 0),]],
  
  [anyone|plyr ,"generique_ordretente_suite_inf", [(eq, "$ordre_back_i", 0),],  "Qu'ils reculent de dix pas.", "re_generique_ordretente_suite_inf", [(assign, "$ordre_back_i", 1),]],
  [anyone|plyr ,"generique_ordretente_suite_inf", [(eq, "$ordre_back_i", 1),],  "Qu'ils aretent reculer de dix pas.", "re_generique_ordretente_suite_inf", [(assign, "$ordre_back_i", 0),]],
  
  [anyone|plyr ,"generique_ordretente_suite_inf", [(eq, "$ordre_standc_i", 0),],  "Qu'ils doivent resserer leurs rangs.", "re_generique_ordretente_suite_inf", [(assign, "$ordre_standc_i", 1),]],
  [anyone|plyr ,"generique_ordretente_suite_inf", [(eq, "$ordre_standc_i", 1),],  "Qu'ils ne resserent plus leurs rangs.", "re_generique_ordretente_suite_inf", [(assign, "$ordre_standc_i", 0),]],
  
  [anyone|plyr ,"generique_ordretente_suite_inf", [(eq, "$ordre_spread_i", 0),],  "Qu'ils doivent dispersser leur rang.", "re_generique_ordretente_suite_inf", [(assign, "$ordre_spread_i", 1),]],
  [anyone|plyr ,"generique_ordretente_suite_inf", [(eq, "$ordre_spread_i", 1),],  "Qu'ils aretent de dispercer leur rang.", "re_generique_ordretente_suite_inf", [(assign, "$ordre_spread_i", 0),]],
  #RETOUR
  [anyone|plyr ,"generique_ordretente_suite_inf", [],  "Ca sera tout pour l'infanterie.", "dial_batailletent", []],
  
  #cav
  [anyone|plyr ,"generique_ordretente_suite_cav", [(eq, "$ordre_stop_c", 0),],  "Qu'ils tiennent la position.", "re_generique_ordretente_suite_cav", [(assign, "$ordre_stop_c", 1),]],
  [anyone|plyr ,"generique_ordretente_suite_cav", [(eq, "$ordre_stop_c", 1),],  "Qu'ils chargent a la vue de l'ennemi.", "re_generique_ordretente_suite_cav", [(assign, "$ordre_stop_c", 0),]],
  
  [anyone|plyr ,"generique_ordretente_suite_cav", [(eq, "$ordre_follow_c", 0),],  "Qu'ils doivent me suivre.", "re_generique_ordretente_suite_cav", [(assign, "$ordre_follow_c", 1),]],
  [anyone|plyr ,"generique_ordretente_suite_cav", [(eq, "$ordre_follow_c", 1),],  "Qu'ils arretent de me suivre.", "re_generique_ordretente_suite_cav", [(assign, "$ordre_follow_c", 0),]],
  
  [anyone|plyr ,"generique_ordretente_suite_cav", [(eq, "$ordre_adv_c", 0),],  "Qu'ils avancent devant les archers.", "re_generique_ordretente_suite_cav", [(assign, "$ordre_adv_c", 1),]],
  [anyone|plyr ,"generique_ordretente_suite_cav", [(eq, "$ordre_adv_c", 1),],  "Qu'ils aretent de se mettre devant les archers.", "re_generique_ordretente_suite_cav", [(assign, "$ordre_adv_c", 0),]],
  
  [anyone|plyr ,"generique_ordretente_suite_cav", [(eq, "$ordre_back_c", 0),],  "Qu'ils reculent de dix pas.", "re_generique_ordretente_suite_cav", [(assign, "$ordre_back_c", 1),]],
  [anyone|plyr ,"generique_ordretente_suite_cav", [(eq, "$ordre_back_c", 1),],  "Qu'ils aretent reculer de dix pas.", "re_generique_ordretente_suite_cav", [(assign, "$ordre_back_c", 0),]],
  
  [anyone|plyr ,"generique_ordretente_suite_cav", [(eq, "$ordre_standc_c", 0),],  "Qu'ils doivent resserer leurs rangs.", "re_generique_ordretente_suite_cav", [(assign, "$ordre_standc_c", 1),]],
  [anyone|plyr ,"generique_ordretente_suite_cav", [(eq, "$ordre_standc_c", 1),],  "Qu'ils ne resserent plus leurs rangs.", "re_generique_ordretente_suite_cav", [(assign, "$ordre_standc_c", 0),]],
  
  [anyone|plyr ,"generique_ordretente_suite_cav", [(eq, "$ordre_spread_c", 0),],  "Qu'ils doivent se dispersser.", "re_generique_ordretente_suite_cav", [(assign, "$ordre_spread_c", 1),]],
  [anyone|plyr ,"generique_ordretente_suite_cav", [(eq, "$ordre_spread_c", 1),],  "Qu'ils aretent de dispercer leurs rangs.", "re_generique_ordretente_suite_cav", [(assign, "$ordre_spread_c", 0),]],
  
  #RETOUR
  [anyone|plyr ,"generique_ordretente_suite_cav", [],  "Ca sera tout pour la cavalerie.", "dial_batailletent", []],
  
  #arch
  [anyone|plyr ,"generique_ordretente_suite_arch", [(eq, "$ordre_stopfire_b", 0),],  "Qu'ils doivent attendre mon signal pour tirer.", "re_generique_ordretente_suite_arch", [(assign, "$ordre_stopfire_b", 1),]],
  [anyone|plyr ,"generique_ordretente_suite_arch", [(eq, "$ordre_stopfire_b", 1),],  "Qu'il doivent tirer a vue.", "re_generique_ordretente_suite_arch", [(assign, "$ordre_stopfire_b", 0),]],
  
  [anyone|plyr ,"generique_ordretente_suite_arch", [(eq, "$ordre_stop_a", 0),],  "Qu'ils doivent attendre mon signal pour charger.", "re_generique_ordretente_suite_arch", [(assign, "$ordre_stop_a", 1),]],
  [anyone|plyr ,"generique_ordretente_suite_arch", [(eq, "$ordre_stop_a", 1),],  "Qu'il doivent charger a vue.", "re_generique_ordretente_suite_arch", [(assign, "$ordre_stop_a", 0),]],
  
  
  [anyone|plyr ,"generique_ordretente_suite_arch", [(eq, "$ordre_follow_a", 0),],  "Qu'ils doivent me suivre.", "re_generique_ordretente_suite_arch", [(assign, "$ordre_follow_a", 1),]],
  [anyone|plyr ,"generique_ordretente_suite_arch", [(eq, "$ordre_follow_a", 1),],  "Qu'ils doivent aretter de me suivre.", "re_generique_ordretente_suite_arch", [(assign, "$ordre_follow_a", 0),]],
  
  [anyone|plyr ,"generique_ordretente_suite_arch", [(eq, "$ordre_adv_a", 0),],  "Qu'ils doivent avancer de dix pas.", "re_generique_ordretente_suite_arch", [(assign, "$ordre_adv_a", 1),]],
  [anyone|plyr ,"generique_ordretente_suite_arch", [(eq, "$ordre_adv_a", 1),],  "Qu'il ne doivent plus avancer de dix pas.", "re_generique_ordretente_suite_arch", [(assign, "$ordre_adv_a", 0),]],
  
  [anyone|plyr ,"generique_ordretente_suite_arch", [(eq, "$ordre_back_a", 0),],  "Qu'ils doivent reculer de dix pas.", "re_generique_ordretente_suite_arch", [(assign, "$ordre_back_a", 1),]],
  [anyone|plyr ,"generique_ordretente_suite_arch", [(eq, "$ordre_back_a", 1),],  "Qu'il doivent aretter de reculer de dix pas.", "re_generique_ordretente_suite_arch", [(assign, "$ordre_back_a", 0),]],
  
  [anyone|plyr ,"generique_ordretente_suite_arch", [(eq, "$ordre_standc_a", 0),],  "Qu'ils doivent resserer les rangs.", "re_generique_ordretente_suite_arch", [(assign, "$ordre_standc_a", 1),]],
  [anyone|plyr ,"generique_ordretente_suite_arch", [(eq, "$ordre_standc_a", 1),],  "Qu'il doivent aretter de resserer les rangs.", "re_generique_ordretente_suite_arch", [(assign, "$ordre_standc_a", 0),]],
  
  [anyone|plyr ,"generique_ordretente_suite_arch", [(eq, "$ordre_spread_a", 0),],  "Qu'ils doivent ecarter les rangs.", "re_generique_ordretente_suite_arch", [(assign, "$ordre_spread_a", 1),]],
  [anyone|plyr ,"generique_ordretente_suite_arch", [(eq, "$ordre_spread_a", 1),],  "Qu'il doivent aretter d'ecarter les rangs.", "re_generique_ordretente_suite_arch", [(assign, "$ordre_spread_a", 0),]],
  
  #RETOUR
  [anyone|plyr ,"generique_ordretente_suite_arch", [],  "assez parlé des archers.", "dial_batailletent", []],
  
  
  [anyone|plyr ,"start_tenteplanbat", [],  "Passons a autre chose.", "directivescampsserg122", []],
  [anyone ,"generique_ordretente_suite", [],"Bien...", "start_tenteplanbat", []],#
  [anyone ,"directivescampsserg122", [],"Comme vous voudrez...", "directivescampsserg1", []],#
  
  
  
  #sergeant 2
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_serg_2"),
    ],
    "Capitaine, nous vous attendions. quelles sont les directives ?", "directivescampsserg2", [(play_sound, "snd_capitaine"),]],
  
  [anyone|plyr ,"directivescampsserg2", [],  "Préparons la prochaine bataille...", "dial_batailletent", []],
  [anyone|plyr ,"directivescampsserg2", [],  "Parlez moi de cet endroit.", "dial_tente_comand", []],
  [anyone|plyr ,"directivescampsserg2", [],  "Au repos pour le moment.", "close_window", []],
  #sergeant 3
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_serg_3"),
    ],
    "Capitaine, nous vous attendions. quelles sont les directives ?", "directivescampsserg3", [(play_sound, "snd_capitaine"),]],
  
  [anyone|plyr ,"directivescampsserg3", [],  "Préparons la prochaine bataille...", "dial_batailletent", []],
  [anyone|plyr ,"directivescampsserg3", [],  "Parlez moi de cet endroit.", "dial_tente_comand", []],
  [anyone|plyr ,"directivescampsserg3", [],  "Au repos pour le moment.", "close_window", []],
  
  #sergeant 4
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_serg_4"),
    ],
    "Capitaine, nous vous attendions. quelles sont les directives ?", "directivescampsserg4", [(play_sound, "snd_capitaine"),]],
  
  [anyone|plyr ,"directivescampsserg4", [],  "Préparons la prochaine bataille...", "dial_batailletent", []],
  [anyone|plyr ,"directivescampsserg4", [],  "Parlez moi de cet endroit.", "dial_tente_comand", []],
  [anyone|plyr ,"directivescampsserg4", [],  "Au repos pour le moment.", "close_window", []],
  
  #special_1
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_spec_1"),
    ],
    "Capitaine, nous avons établis une liste de descriptions des murs des forteresses les plus intéressentes de France, vous voudriez certainement y jetter un oeil.", "desc_chateau_gen1", [(play_sound, "snd_capitaine"),]],
  
  [anyone|plyr ,"desc_chateau_gen1",
    [
    ],
    "Etudions ces plans.", "ok_infchateautent", []],
  [anyone|plyr ,"desc_chateau_gen1", [],  "Cela m'importe peut.", "close_window", []],
  
  [anyone ,"ok_infchateautent", [],"Quelle place vous intéresse ?", "quel_place_chateautent", []],#
  
  #Ca suffi
  [anyone|plyr ,"quel_place_chateautent", [],  "Ca suffi pour le moment.", "close_window", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Paris", "ren_Paris", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Reims", "ren_Reims", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Nantes", "ren_Angers", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Bourges", "ren_Bourges", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Metz", "ren_Metz", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Dijon", "ren_Dijon", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Montpellier", "ren_Montpellier", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Marseille", "ren_Marseille", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Caen", "ren_Caen", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Limoges", "ren_Limoges", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Calais", "ren_Calais", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Rouen", "ren_Rouen", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Toulouse", "ren_Toulouse", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Bordeaux", "ren_Bordeaux", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Orleans", "ren_Orleans", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Tours", "ren_Tours", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Poitiers", "ren_Poitiers", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Avignon", "ren_Avignon", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Cherbourg", "ren_Cherbourg", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Lyon", "ren_Lyon", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Auxerre", "ren_Auxerre", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Rennes", "ren_Rennes", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Chateau de Cherbourg", "ren_chatCherbourg", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Chateau d'Amiens", "ren_Amiens", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Chateau de Chartres", "ren_Chartres", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Fort de Brest", "ren_Brest", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Fort de Troyes", "ren_Troyes", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Donjon de La_Rochelle", "ren_La_Rochelle", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Chateau d'Angouleme", "ren_Angouleme", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Moulins le Ch?eau", "ren_Moulins", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Fort de Clermont", "ren_Clermont", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Fort de Lyon", "ren_chatLyon", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Forteresse du Mans", "ren_Mans", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Forteresse de Bayonne", "ren_Bayonne", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Chateau d'Auch", "ren_Auch", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Fort de Tarbes", "ren_Tarbes", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Chateau d'Albe", "ren_Albe", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Forteresse de Carcassonne", "ren_Carcassonne", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Donjon de Grenoble", "ren_Grenoble", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Donjon de St.Malo", "ren_Malo", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Chateau d'Antwerp", "ren_Antwerp", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Peronne le Ch?eau", "ren_Peronne", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Forteresse de Verneuilo", "ren_Verneuilo", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "forteresse de Chateauroux", "ren_Chateauroux", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Forteresse de Laval", "ren_Laval", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Chateau de Senlis", "ren_Senlis", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Forteresse de Turenne", "ren_Turenne", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Chateau d'Aurillac", "ren_Aurillac", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Forteresse de Nevers", "ren_Nevers", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Forteresse de Monterean", "ren_Monterean", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Chateau de Dieppe", "ren_Dieppe", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Donjon de Rodez", "ren_Rodez", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Chateau du Puy", "ren_Puy", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Forteresse de Cahors", "ren_Cahors", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Chateau de Nantes", "ren_Nantes", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Fort de Neufchateau", "ren_Neufchateau", []],
  
  [anyone|plyr ,"quel_place_chateautent", [],  "Chateau de Chalons", "ren_Chalons", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Donjon d'Albret", "ren_Albret", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Fort de Montargis", "ren_Montargis", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Chateau de Bruges", "ren_Bruges", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Chateau de Thouars", "ren_Thouars", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Chateau d'Agincourt", "ren_Agincourt", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Mont saint Michel", "ren_MontMichel", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Pont de Poitiers", "ren_PontPoitiers", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Pont de Tours", "ren_PontTours", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Pont de Bordeau", "ren_PontBordeau", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Pont Fortifi?", "ren_PontFortifi", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Pont de Blanzy", "ren_PontBourges", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Pont des Tourelles", "ren_PontTourelles", []],
  [anyone|plyr ,"quel_place_chateautent", [],  "Forteresse de Chinon", "ren_ForteresseChinon", []],
  
  
  [anyone ,"ren_Dieppe", [],"Les murs de Dieppe semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],  [anyone ,"ren_Nevers", [],"Les murs de Nevers semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],  [anyone ,"ren_Laval", [],"Les murs de Laval semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],  [anyone ,"ren_Peronne", [],"Les murs de Peronne semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Reims", [],"Les murs de Reims semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Angers", [],"Les murs de Nantes semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Bourges", [],"Les murs de Bourges semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Metz", [],"Les murs de Metz semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Dijon", [],"Les murs de Dijon semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Montpellier", [],"Les murs de Montpellier semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Marseille", [],"Les murs de Marseille semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Caen", [],"Les murs de Caen semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Limoges", [],"Les murs de Limoges semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Calais", [],"Les murs de Calais semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Rouen", [],"Les murs de Rouen semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Toulouse", [],"Les murs de Toulouse sont trop imposants pour des échéles, il vous faudra construire une tour de siège et cela vous fera perdre un temps précieux.", "generiquequelchateautent", []],#
  [anyone ,"ren_Bordeaux", [],"Les murs de Bordeaux semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Orleans", [],"Les murs d'Orleans semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Tours", [],"Les murs de Tours sont trop imposants pour des échéles, il vous faudra construire une tour de siège et cela vous fera perdre un temps précieux.", "generiquequelchateautent", []],#
  [anyone ,"ren_Poitiers", [],"Les murs de Poitier semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Avignon", [],"Les murs d'Avignon semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Cherbourg", [],"Les murs de Cherbourg semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Lyon", [],"Les murs de Lyon semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Auxerre", [],"Les murs d'Auxerre semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Rennes", [],"Les murs de Rennes semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_chatCherbourg", [],"Les murs du chateau de Cherbourg sont trop imposants pour des échéles, il vous faudra construire une tour de siège et cela vous fera perdre un temps précieux.", "generiquequelchateautent", []],#
  [anyone ,"ren_Amiens", [],"Les murs du chateau d'Amiens sont trop imposants pour des échéles, il vous faudra construire une tour de siège et cela vous fera perdre un temps précieux.", "generiquequelchateautent", []],#
  [anyone ,"ren_Chartres", [],"Les murs du cateau de Chartres semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Brest", [],"Les murs du chateau de Brest sont trop imposants pour des échéles, il vous faudra construire une tour de siège et cela vous fera perdre un temps précieux.", "generiquequelchateautent", []],#
  [anyone ,"ren_Troyes", [],"Les murs du cateau de Troyes semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_La_Rochelle", [],"Les murs du cateau de la Rochelle semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Angouleme", [],"Les murs du chateau d'Angouleme sont trop imposants pour des échéles, il vous faudra construire une tour de siège et cela vous fera perdre un temps précieux.", "generiquequelchateautent", []],#
  [anyone ,"ren_Moulins", [],"Les murs du chateau de Moulins sont trop imposants pour des échéles, il vous faudra construire une tour de siège et cela vous fera perdre un temps précieux.", "generiquequelchateautent", []],#
  [anyone ,"ren_Clermont", [],"Les murs du chateau de Clermont sont trop imposants pour des échéles, il vous faudra construire une tour de siège et cela vous fera perdre un temps précieux.", "generiquequelchateautent", []],#
  [anyone ,"ren_chatLyon", [],"Les murs du Fort de Luon semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Mans", [],"Les murs du chateau du Mans sont trop imposants pour des échéles, il vous faudra construire une tour de siège et cela vous fera perdre un temps précieux.", "generiquequelchateautent", []],#
  [anyone ,"ren_Bayonne", [],"Les murs du cateau de Bayonne semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Auch", [],"Les murs du chateau d'Auch sont trop imposants pour des échéles, il vous faudra construire une tour de siège et cela vous fera perdre un temps précieux.", "generiquequelchateautent", []],#
  [anyone ,"ren_Tarbes", [],"Les murs du cateau de Tarbes semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Albe", [],"Les murs du cateau d'Albe semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Carcassonne", [],"Les murs du cateau de Carcassonne semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Grenoble", [],"Les murs du cateau de Grenoble semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Malo", [],"Les murs du cateau de St Malo semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Antwerp", [],"Les murs du cateau d'Antwerp semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Verneuilo", [],"Les murs du chateau de Verneuilo sont trop imposants pour des échéles, il vous faudra construire une tour de siège et cela vous fera perdre un temps précieux.", "generiquequelchateautent", []],#
  [anyone ,"ren_Chateauroux", [],"Les murs du cateau de Chateauroux semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Senlis", [],"Les murs du cateau de Senlis semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Turenne", [],"Les murs du chateau de Turenne sont trop imposants pour des échéles, il vous faudra construire une tour de siège et cela vous fera perdre un temps précieux.", "generiquequelchateautent", []],#
  [anyone ,"ren_Aurillac", [],"Les murs du cateau d'Aurillac semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Monterean", [],"Les murs du cateau de Monterean semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Rodez", [],"Les murs du cateau de Rodez semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Puy", [],"Les murs du cateau du Puy semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Cahors", [],"Les murs du cateau de Cahors semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Nantes", [],"Les murs du cateau de Nantes semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Neufchateau", [],"Les murs de Neufchateau de Moulins sont trop imposants pour des échéles, il vous faudra construire une tour de siège et cela vous fera perdre un temps précieux.", "generiquequelchateautent", []],#
  [anyone ,"ren_Chalons", [],"Les murs du chateau de Chalons sont trop imposants pour des échéles, il vous faudra construire une tour de siège et cela vous fera perdre un temps précieux.", "generiquequelchateautent", []],#
  [anyone ,"ren_Albret", [],"Les murs du Donjon d'Albert semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Montargis", [],"Les murs du cateau de Montargis semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Bruges", [],"Les murs du chateau de Bruges sont trop imposants pour des échéles, il vous faudra construire une tour de siège et cela vous fera perdre un temps précieux.", "generiquequelchateautent", []],#
  [anyone ,"ren_Thouars", [],"Les murs du cateau de Thouars semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer.", "generiquequelchateautent", []],#
  [anyone ,"ren_Agincourt", [],"Les murs du chateau d'Agincourt sont trop imposants pour des échéles, il vous faudra construire une tour de siège et cela vous fera perdre un temps précieux.", "generiquequelchateautent", []],#
  [anyone ,"ren_MontMichel", [],"Les murs du Mont saint Michel sont trop imposants pour des échéles, il vous faudra construire une tour de siège et cela vous fera perdre un temps précieux.", "generiquequelchateautent", []],#
  [anyone ,"ren_PontPoitiers", [],"Il y as une créte devans le pont de Poirier, si vous agissez rapidement vous pourrez entrer avant qu'ils n'es monté le pont levis dans l'autre cas, vous n'aurrez plus qu'a faire demi tour.", "generiquequelchateautent", []],#
  [anyone ,"ren_PontTours", [],"Il y as une créte devans le pont de Tours, si vous agissez rapidement vous pourrez entrer avant qu'ils n'es monté le pont levis dans l'autre cas, vous n'aurrez plus qu'a faire demi tour.", "generiquequelchateautent", []],#
  [anyone ,"ren_PontBordeau", [],"Il y as une créte devans le pont de Bordeau, si vous agissez rapidement vous pourrez entrer avant qu'ils n'es monté le pont levis dans l'autre cas, vous n'aurrez plus qu'a faire demi tour.", "generiquequelchateautent", []],#
  [anyone ,"ren_PontFortifi", [],"Il y as une créte devans le pont fortifié, si vous agissez rapidement vous pourrez entrer avant qu'ils n'es monté le pont levis dans l'autre cas, vous n'aurrez plus qu'a faire demi tour.", "generiquequelchateautent", []],#
  [anyone ,"ren_PontBourges", [],"Il y as une créte devans le pont de Blanzy, si vous agissez rapidement vous pourrez entrer avant qu'ils n'es monté le pont levis dans l'autre cas, vous n'aurrez plus qu'a faire demi tour.", "generiquequelchateautent", []],#
  [anyone ,"ren_PontTourelles", [],"Il y as une créte devans le pont des tourelles, si vous agissez rapidement vous pourrez entrer avant qu'ils n'es monté le pont levis dans l'autre cas, vous n'aurrez plus qu'a faire demi tour.", "generiquequelchateautent", []],#
  [anyone ,"ren_ForteresseChinon", [],"Les murs du La forteresse de Chinon semblent pouvoir etre franchis par des échéles, cela ne demandera pas une longue préparation, a moin que vous décidiez de tenire un siège pour les affamer, c'est une grande forteresse, il faudra la prendre mètre par mètre.", "generiquequelchateautent", []],#
  #
  [anyone ,"generiquequelchateautent", [],"Avez vous besoin d'autre chose ?", "quel_place_chateautent", []],#
  
  #special_2
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_spec_2"),
    ],
    "Capitaine, nous avons établis une liste de descriptions des murs des forteresses les plus intéressentes de France, vous voudriez certainement y jetter un oeil.", "desc_chateau_gen2", [(play_sound, "snd_capitaine"),]],
  
  [anyone|plyr ,"desc_chateau_gen2",
    [
      
    ],
    "Bien etendu.", "ok_infchateautent", []],
  [anyone|plyr ,"desc_chateau_gen2", [],  "Cela m'importe peut.", "close_window", []],
  
  
  #special_3
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_spec_3"),
    ],
    "Capitaine, nous avons établis une liste de descriptions des murs des forteresses les plus intéressentes de France, vous voudriez certainement y jetter un oeil.", "desc_chateau_gen3", [(play_sound, "snd_capitaine"),]],
  
  [anyone|plyr ,"desc_chateau_gen3",
    [
      
    ],
    "Bien etendu.", "ok_infchateautent", []],
  [anyone|plyr ,"desc_chateau_gen3", [],  "Cela m'importe peut.", "close_window", []],
  
  
  #special_4
  [anyone,"start", [(eq, "$g_talk_troop", "trp_campement_troupe_spec_4"),
    ],
    "Capitaine, nous avons établis une liste de descriptions des murs des forteresses les plus intéressentes de France, vous voudriez certainement y jetter un oeil.", "desc_chateau_gen4", [(play_sound, "snd_capitaine"),]],
  
  [anyone|plyr ,"desc_chateau_gen4",
    [
    ],
    "Bien etendu.", "ok_infchateautent", []],
  [anyone|plyr ,"desc_chateau_gen4", [],  "Cela m'importe peut.", "close_window", []],
  
  
  
  
  
  #### ribaude 1
  [anyone,"start", [(eq, "$g_talk_troop", "trp_ribaude_1"),
    ],
    "Mon beau prince,j'attend vostre venue depuis si longtemp..", "dial_ribaude_cour", [(play_sound, "snd_ribaudes"),]],
  [anyone|plyr ,"dial_ribaude_cour", [],  "On se conait ?", "dial_ribaude_ok", []],
  [anyone|plyr ,"dial_ribaude_cour", [],  "Vous vous trompez de personne,adieu.", "close_window", []],
  
  [anyone ,"dial_ribaude_ok", [],"Non,Pas encore,mais pour 200 écus,on peut faire conaissance dans l'intimité d'une auberge.", "dial_ribaude_auberg", []],
  
  [anyone|plyr ,"dial_ribaude_auberg",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 200),
    ],  "Je pourais etre interessé.", "dial_ribaude_interet",
    [
      (troop_remove_gold,"trp_player",200),
  ]],
  [anyone|plyr ,"dial_ribaude_auberg", [],  "Je n'ai pas de temp pour ca,arière femme!", "close_window", []],
  
  [anyone ,"dial_ribaude_interet", [],"Hum,tu oublira la guerre dans la douceur de mes bras.", "dial_ribaude_player_1", []],
  
  [anyone|plyr ,"dial_ribaude_player_1", [],  "Je ne te promet pas d'etre aussi doux que toi.", "close_window",
    [
      (jump_to_menu, "mnu_courtesan_accept"),
      (finish_mission),
  ]],
  
  #### ribaude 2
  [anyone,"start", [(eq, "$g_talk_troop", "trp_ribaude_2"),
    ],
    "Mon seigneur je vous en prie,j'ai besoin d'argent,je suis prete a tout pour cela.", "dial_ribaude_argen", [(play_sound, "snd_ribaudes"),]],
  [anyone|plyr ,"dial_ribaude_argen", [],  "C'est a dire ?", "dial_ribaude_argentok", []],
  [anyone|plyr ,"dial_ribaude_argen", [],  "Je suis dans le meme cas,mais je ne demande a personne,adieu.", "close_window", []],
  
  [anyone ,"dial_ribaude_argentok", [],"Et bien,j'ai honte a le dire,mais je suis issue d'une noble famille,mon père un riche marchand a été assassiné par des crapules,et Je n'ai personne pour veiller sur moi,et...voila a quois j'en suis réduis pour survivre,j'ai besoin de 300 écus mon Seigneur,je....", "dial_ribaude_survie", []],
  
  [anyone|plyr ,"dial_ribaude_survie",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 300),
    ],  "300 écus pour avoir une dame de la cour,intéréssant..", "dial_ribaude_interetnoble",
    [
      (troop_remove_gold,"trp_player",300),
  ]],
  [anyone|plyr ,"dial_ribaude_survie",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 300),
    ],  "N'ayez crainte gente dame,je vais vous avancer ces 300 écus,ainsi vous n'aurez pas a vous salir.","dial_ribaude_mercy",
    [
      (troop_remove_gold,"trp_player",300),
      (call_script, "script_change_troop_renown", "trp_player", 5),
  ]],
  [anyone ,"dial_ribaude_mercy", [],"Grand merci messire,vous etes un vrais chevalier d'antan,je ne pourais jamais assez vous remercier,tout le monde saura quelle hero vous etes.", "close_window", []],
  
  [anyone|plyr ,"dial_ribaude_survie", [],  "Malheureusement,je ne peut rien pour vous.", "close_window", []],
  [anyone|plyr ,"dial_ribaude_survie", [],  "Je n'aime pas les nobles,adieu.", "close_window", []],
  
  [anyone ,"dial_ribaude_interetnoble", [],"Ho,je ne ment pas vous savez...vous pouvez pensser que je m'invente un passé pour vous réclamer plus d'argent,mais il n'es es rien je vous assure.", "dial_ribaude_player_noble1", []],
  
  [anyone|plyr ,"dial_ribaude_player_noble1", [],  "Je sais que vous etes vraiment noble,vous sentez si bon....", "close_window",
    [
      (jump_to_menu, "mnu_courtesan_accept_2"),
      (finish_mission),
  ]],
  
  #### ribaude 3
  [anyone,"start", [(eq, "$g_talk_troop", "trp_ribaude_3"),
    ],
    "Approche male vigoureux,que dirais tu de visiter les ecuries en ma compagnie,contre 200 ecus naturelement.", "dial_ribaude_ecuuri", [(play_sound, "snd_ribaudes"),]],
  [anyone|plyr ,"dial_ribaude_ecuuri", [],  "Pourquois dans les ecuries ?", "dial_ribaude_ecurie_ok", []],
  [anyone|plyr ,"dial_ribaude_ecuuri", [],  "Pas maintenant.", "close_window", []],
  
  [anyone ,"dial_ribaude_ecurie_ok", [],"Pourquois pas,ce n'es pas loing de la rue et j'aime cet endroit,il fait ressortir l'animal que nous sommes tous.", "dial_ribaude_animal", []],
  
  [anyone|plyr ,"dial_ribaude_animal",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 200),
    ],  "Un animal,hein...", "dial_ribaude_interet_animal",
    [
      (troop_remove_gold,"trp_player",200),
  ]],
  [anyone|plyr ,"dial_ribaude_animal", [],  "Tu es malade femme,va donc mander un guerisseur.", "close_window", []],
  
  [anyone ,"dial_ribaude_interet_animal", [],"Exactement,j'addore faire ca parmis ces betes si puissantes.", "dial_ribaude_player_animall", []],
  
  [anyone|plyr ,"dial_ribaude_player_animall", [],  "Je pensse que tu ferais une bonne bergere.", "close_window",
    [
      (jump_to_menu, "mnu_courtesan_accept_3"),
      (finish_mission),
  ]],
  
  
  #### dials camp chasse
  #garde 1
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chasse_camp_1"),
    ],
    "Silence Maraud, retourne a tes porcs.", "retour_backchasss", []],
  [anyone|plyr ,"retour_backchasss", [],  "Bien mon seigneur.", "close_window", []],
  [anyone|plyr ,"retour_backchasss", [],  "Pourquois aller jusu'au village,si j'ai deux magnifiques porcs en face de moi ?", "retour_backchasssno",[]],
  [anyone ,"retour_backchasssno", [],"Quois ? je vais t'apprendre a respecter tes maitres.", "close_window",
    [
      #refaire les equipes et combats
      (mission_disable_talk),
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 0, 2, -1),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 1),
      (team_set_relation, 2, 0, -1),
      (team_set_relation, 2, 1, 1),
  ]],
  
  
  #garde 2
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chasse_camp_2"),
    ],
    "Va t'en tu empeste misérable.", "retour_backchasss2", []],
  [anyone|plyr ,"retour_backchasss2", [],  "Bien mon seigneur.", "close_window", []],
  [anyone|plyr ,"retour_backchasss2", [],  "Je me demandais moi meme si c'etait vous ou votre cheval qui degagez cette odeure ?", "retour_backchasssno44",[]],
  [anyone ,"retour_backchasssno44", [],"Quois ? je vais t'apprendre a respecter tes maitres.", "close_window",
    [
      #refaire les equipes et combats
      (mission_disable_talk),
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 0, 2, -1),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 1),
      (team_set_relation, 2, 0, -1),
      (team_set_relation, 2, 1, 1),
  ]],
  
  #gouverneur vengeur
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chasse_camp_gouv"),
      (eq, "$revengegouvvv", 1), #relever conclusion dial paysans
    ],
    "C'est fait ? bien...Maintenant qu'on le pende !", "reveng_gouviv", []],
  [anyone|plyr ,"reveng_gouviv", [],  "Vous aviez raison gouverneur...", "reveng_gouviv2", []],
  
  [anyone ,"reveng_gouviv2", [], "Tu commence a m'agacer pouilleux, de quois parle tu encore ?", "reveng_gouvivdie",[]],
  
  [anyone|plyr ,"reveng_gouvivdie", [],  "Quand vous disiez que j'etait un oiseau de mauvaise augure. (se battre avec le gouverneur).", "reveng_gouvivdiestart",[]],
  
  [anyone ,"reveng_gouvivdiestart", [], "Quelle es cette...", "close_window",
    [
      #refaire equipes et combat
      (mission_disable_talk),
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 0, 2, -1),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 1),
      (team_set_relation, 2, 0, -1),
      (team_set_relation, 2, 1, 1),
  ]],
  
  #gouverneur en ettente sacrement
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chasse_camp_gouv"),
      (eq, "$fakesacrement", 1),
    ],
    "Alors, as tu terminé ?", "reattent_fakesacr", []],
  [anyone|plyr ,"reattent_fakesacr", [],  "J'ai besoin de savoir ce qu'as fait cet homme pour le conffésser.", "reattent_fakesacr2", []],
  
  [anyone ,"reattent_fakesacr2", [], "C'est un mauvais rabatteur, et il désobeis aux ordres, de plus il vole ses semblables et s'es rendue coupable de meurtres, cela suffit ?", "reattent_fakesacr2wt",[]],
  
  [anyone|plyr ,"reattent_fakesacr2wt", [],  "Je n'en crois pas un mot, sauf votre respect.", "close_window", []],
  [anyone|plyr ,"reattent_fakesacr2wt", [],  "C'est plus que suffisant Mon Seigneur, vous etes dans votre bon droit cela ne fait aucun doute...", "close_window", []],
  
  
  #gouverneur
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chasse_camp_gouv"),
    ],
    "Qui es cet inssolant ? comment ose tu m'adrésser la parole sans y etre invité ?", "gouviv_starttfakmoi", []],
  [anyone|plyr ,"gouviv_starttfakmoi", [],  "Toutes mes excuses Mon Seigneur,mais que se passe t'il ici ?", "gouviv_starttfakmoi2", []],
  
  [anyone ,"gouviv_starttfakmoi2", [], "Nous allions pendre cet homme,en quois cela te regarde t'il, tu veux peut etre le rejoindre ?", "gouviv_starttfakmoi23",[]],
  
  [anyone|plyr ,"gouviv_starttfakmoi23", [],  "Il se trouve que je suis prêtre Mon Seigneur, laissez moi au moin lui donner les derniers sacrements.", "gouviv_starttfakmoisacrefak", []],
  [anyone|plyr ,"gouviv_starttfakmoi23", [],  "Non, pas du tout, je m'en allais justement reprendre mon chemin, gloire et fortune a mon Seigneur.", "close_window", []],
  
  [anyone ,"gouviv_starttfakmoisacrefak", [], "Va...dépèche toi, j'ai le sentiment que si tu ne le fait pas cela attirera le malheure a ma maison, et tu t'en va dés que tu as terminé oiseau de mauvaise augure.", "close_window",
    [
      #assigner debloquer dials paysans rebels
      (assign, "$fakesacrement", 1),
  ]],
  
  
  #paysan pere apres fake sacre en attent
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chasse_camp_cond"),
      (eq, "$revengegouvvv", 1),
    ],
    "Que fait tu ? donne ton signal, je suis pret a mourire.", "vieu_attensignal", []],
  [anyone|plyr ,"vieu_attensignal", [],  "Bon voyage viel homme, tu sera un heros.", "close_window", []],
  
  
  #paysan pere apres fake sacre
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chasse_camp_cond"),
      (eq, "$fakesacrement", 1),
    ],
    "Que fait tu etranger ? fuit tant qu'il est temps.", "fsacvieu_condamner", []],
  [anyone|plyr ,"fsacvieu_condamner", [],  "Je vais tuer le gouverneur, soutenez moi, battez vous ou mourez en homme libre !", "fsacvieu_condamner2", []],
  
  [anyone ,"fsacvieu_condamner2", [], "Oui...oui, d'accord, en homme libre.", "fsacvieu_condamner3",[]],
  
  [anyone|plyr ,"fsacvieu_condamner3", [],  "Attendez mon signal, et jettez vous sur les cavaliers, par saint Michel battez vous avec coeur.", "fsacvieu_condamnerero", []],
  
  [anyone ,"fsacvieu_condamnerero", [], "Oui, oui!..je suis un homme libre !", "close_window",
    [
      (assign, "$revengegouvvv", 1),
  ]],
  
  
  #paysan pere
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chasse_camp_cond"),
    ],
    "Qui es tu ? part je t'en prie, le gouverneur es plus fou que d'abitude, va au village et dit leur de se Rebeller, pour moi c'est trop tard.", "vieu_condamner", []],
  [anyone|plyr ,"vieu_condamner", [],  "Qu'y a t'il viel homme ?", "vieu_condamner2", []],
  
  [anyone ,"vieu_condamner2", [], "Le gouverneur veux me pendre, juste par ce que je ne cour pas assez vite selon lui, le pire c'est qu'il veux que ca soit mon fils le boureau.", "vieu_condamner23",[]],
  
  [anyone|plyr ,"vieu_condamner23", [],  "Je suis la pour tuer le gouverneur, pretez moi main forte et vous aurez une chance de vivre.", "vieu_condamnerdeadok", []],
  
  [anyone ,"vieu_condamnerdeadok", [], "Et bien, je ne sais pas...je ne peut rien promettre.", "close_window",[]],
  
  #paysan fils
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chasse_camp_bour"),
    ],
    "Que dois je faire, que dois je faire ?!.", "fils_condamner", []],
  [anyone|plyr ,"fils_condamner", [],  "Calme toi, qu'as tu ?", "fils_condamner2", []],
  
  [anyone ,"fils_condamner2", [], "Le gouverneur, il veux que je pende mon père.", "fils_condamner3",[]],
  
  [anyone|plyr ,"fils_condamner3", [],  "Je m'occuppe du gouverneur, aide ton père.", "close_window", []],
  
  
  
  #### dials manoire assasinat
  #retour convive 1
  [anyone,"start", [(eq, "$g_talk_troop", "trp_manoire_conviv_invit1"),
      (eq, "$recucruche", 1)
    ],
    "Quois ?", "retconv_conivsimple1ee", []],
  [anyone|plyr ,"retconv_conivsimple1ee", [],  "De la cervoise Messire ?", "retconv_conivsimple1eerr", []],
  [anyone ,"retconv_conivsimple1eerr", [], "Bien entendue...", "close_window",
    [
      #play sound cervoise
      (play_sound, "snd_cruch")
  ]],
  #CONVIV 1
  [anyone,"start", [(eq, "$g_talk_troop", "trp_manoire_conviv_invit1"),
    ],
    "Que me veux tu maraud ?", "retconv_marr", []],
  [anyone|plyr ,"retconv_marr", [],  "Qui etes vous je vous prie ?", "retconv_marr2", []],
  [anyone|plyr ,"retconv_marr", [],  "Je ne voulais pas vous déranger mon seigneur.", "close_window",[]],
  [anyone ,"retconv_marr2", [], "Quelle inssolance !", "close_window",[]],
  
  #retour convive 2
  [anyone,"start", [(eq, "$g_talk_troop", "trp_manoire_conviv_invit2"),
      (eq, "$recucruche", 1)
    ],
    "Que veux tu ?", "retconv_coniv2", []],
  [anyone|plyr ,"retconv_coniv2", [],  "De la cervoise Messire ?", "retconv_coniv22", []],
  [anyone ,"retconv_coniv22", [], "Enfin,tu en as mis du temp...", "close_window",
    [
      #play sound cervoise
      (play_sound, "snd_cruch")
  ]],
  
  #convive 2
  [anyone,"start", [(eq, "$g_talk_troop", "trp_manoire_conviv_invit2"),
    ],
    "Qu'y as t'il manant, pourquois me dérange tu ?", "retconv_marrinv2", []],
  [anyone|plyr ,"retconv_marrinv2", [],  "Etes vous le maistre de cette maison ?", "retconv_marrinv23", []],
  [anyone|plyr ,"retconv_marrinv2", [],  "Je ne voulais pas vous pérturber mon seigneur.", "close_window",[]],
  [anyone ,"retconv_marrinv23", [], "Va parler de ces affaires avec le cuisinier, il te dira comment servire idiot.", "close_window",[]],
  
  #retour chevalier
  [anyone,"start", [(eq, "$g_talk_troop", "trp_manoire_chevalier"),
      (eq, "$recucruche", 1)
    ],
    "Oui ?", "retconv_cervoismarrichev", []],
  [anyone|plyr ,"retconv_cervoismarrichev", [],  "De la cervoise Messire ?", "retconv_cervoismarrichevyes", []],
  [anyone ,"retconv_cervoismarrichevyes", [], "Naturelement...", "close_window",
    [
      #play sound cervoise
      (play_sound, "snd_cruch")
  ]],
  
  #chevalier
  [anyone,"start", [(eq, "$g_talk_troop", "trp_manoire_chevalier"),
    ],
    "Que regarde tu comme cela ?", "retconv_marrichevalier", []],
  [anyone|plyr ,"retconv_marrichevalier", [],  "Etes vous le maistre dans cette maison ?", "retconv_marrichevalierno", []],
  [anyone|plyr ,"retconv_marrichevalier", [],  "Toutes mes excuses mon seigneur.", "close_window",[]],
  [anyone ,"retconv_marrichevalierno", [], "Non, ca n'es point moi. Je suis Chevalier pas maistre d'hotelerie, va prendre tes ordres auprés du cuisinier je suppose.", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_manoire_halberdier1"),
    ],
    "Du vent...", "retconv_marrihalbard", []],
  [anyone|plyr ,"retconv_marrihalbard", [],  "Qui es le maistre dans cette maison ?", "retconv_marrihalbardno", []],
  [anyone|plyr ,"retconv_marrihalbard", [],  "Mes excuses.", "close_window",[]],
  [anyone ,"retconv_marrihalbardno", [], "Tu n'as pas entendue ? du vent...", "close_window",[]],
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_manoire_halberdier2"),
    ],
    "Ne reste pas planté la maraud, va en cuisine, tu m'enpéche de voir le maistre.", "retconv_marrihalbardautr", []],
  [anyone|plyr ,"retconv_marrihalbardautr", [],  "C'est le quel ton maistre ?", "retconv_marrihalbardautr2", []],
  [anyone|plyr ,"retconv_marrihalbardautr", [],  "Mes excuses.", "close_window",[]],
  [anyone ,"retconv_marrihalbardautr2", [], "Veux tu que je te jéte dans l'allée couverte de boue ?", "close_window",[]],
  
  
  
  #dial entier cuistot
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_manoire_cuistot"),
      (eq, "$recucruche", 1),
    ],
    "Tu as servie la cervoise aux convives ?", "retcuistotfaitservice", []],
  [anyone|plyr ,"retcuistotfaitservice", [],  "Y a t'il autre chose a servire ?", "retcuistotfaitservice2", []],
  [anyone ,"retcuistotfaitservice2", [], "Non, le repas n'es pas pret d'etre servie...rend toi utile en attendant.", "close_window",[]],
  
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_manoire_cuistot"),
    ],
    "Eh la, qui es tu ? es tu entré pour chaparder des victuailles ?", "retcuistot", []],
  [anyone|plyr ,"retcuistot", [],  "Pas du tout, le maistre de Guilde m'envoie vous preter main forte, il m'a dit que vous aviez besoin de servant pour la journée", "retcuistotcomis", []],
  [anyone|plyr ,"retcuistot", [],  "Je m'en vais...", "close_window",[]],
  
  [anyone ,"retcuistotcomis", [], "Hum...ce fou devrais areter de nous envoyer tous ces paysans affamés. puis que tu es la rend toi utile, apporte la boisson aux convives.", "retcuistotcomisfff",[]],
  
  [anyone|plyr ,"retcuistotcomisfff", [],  "Tout le monde va en boire ?", "retcuistotrrrr",[]],
  
  [anyone ,"retcuistotrrrr", [], "Quois, mais de quois parle tu ? non, en fait n'en donne surtout pas au maistre, l'alcool lui es interdit, va servire les autres tu comprend ? tous les convives sauf le Maistre, va...", "close_window",
    [
      #assigner variable dials service aux invit?
      (assign, "$recucruche", 1),
      (display_message, "@Vous avez recu : cruche de Cervoise"),
  ]],
  
  
  #### banquier autre chance de le tuer
  [anyone,"start", [(eq, "$g_talk_troop", "trp_banquier"),
      (eq, "$chaanctuerbanquiier", 1),  #reporter a medecin
    ],
    "Je me sent de mieux en mieux, laisse moi maintenant.", "baplusdechance", []],
  [anyone|plyr ,"baplusdechance", [],  "Bien...si Je n'ai rien d'autre a faire je repart...", "close_window",
    [
      (call_script, "script_fail_quest", "qst_rebel_manoir"),
      (call_script, "script_end_quest", "qst_rebel_manoir"),
  ]],
  
  #### banquier attente effet poison
  [anyone,"start", [(eq, "$g_talk_troop", "trp_banquier"),
      (eq, "$banempois", 1),  #reporter a medecin
    ],
    "Je...ne me sens pas tres bien, ou es ce satané médecin ?", "banquier_attenteffet", []],
  [anyone|plyr ,"banquier_attenteffet", [],  "Je m'en vais le quérire mon Seigneur...", "close_window", []],
  
  
  #banquier avec potion
  [anyone,"start", [(eq, "$g_talk_troop", "trp_banquier"),
      (eq, "$recupotionbanquier", 1),  #reporter a medecin
    ],
    "Quois encore ?", "banquier_recoispotionpois", []],
  [anyone|plyr ,"banquier_recoispotionpois", [],  "J'ai votre potion Messire.", "banquier_recoispotionpoisok", []],
  [anyone|plyr ,"banquier_recoispotionpois", [],  "Je m'en allais...", "close_window",[]],
  [anyone ,"banquier_recoispotionpoisok", [], "Enfin! donne la moi.", "banquier_recoispotionpoismort",[]],
  
  [anyone|plyr ,"banquier_recoispotionpoismort", [],  "(donner la potion)", "banquier_recoispotnopois", [(display_message, "@Objet perdu : Potion pour le Maistre"),]],
  [anyone|plyr ,"banquier_recoispotionpoismort", [],  "(tenter de versser du poison discretement et tendre le verre)", "banquier_recoispotpoison",[(display_message, "@Objet perdu : Potion pour le Maistre"),]],
  
  [anyone ,"banquier_recoispotnopois", [], "Ca a toujours le gout de fiente de porc, j'éspère qu'elle fera effet au moin.", "close_window",
    [
      #assigner variable dial pour combat direct ratrapage
      (assign, "$chaanctuerbanquiier", 1),
  ]],
  [anyone ,"banquier_recoispotpoison", [], "Ca a toujours le gout de fiente de porc, j'éspère qu'elle fera effet au moin.", "banquier_recoiattentedeath",[]],
  [anyone|plyr ,"banquier_recoiattentedeath", [],  "Je l'éspère aussi mon Seigneur...", "close_window",
    [
      #assigner pour lancer temp et empoisonement !!! et dial attente emposisonee
      (assign, "$banempois", 1),
  ]],
  
  
  #banquier avec boisson
  [anyone,"start", [(eq, "$g_talk_troop", "trp_banquier"),
      (eq, "$recucruche", 1),
    ],
    "Quois encore ?", "banquier_noalcool", []],
  [anyone|plyr ,"banquier_noalcool", [],  "De la cervoise franche Messire ?", "banquier_noalcool2", []],
  [anyone|plyr ,"banquier_noalcool", [],  "Je m'en allais...", "close_window",[]],
  [anyone ,"banquier_noalcool2", [], "Enmène ca...je ne puis boire d'alcool, mon médecin reffuserais de me soigner. enmène ca...vite.", "close_window",[]],
  
  
  #  banquier
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_banquier"),
    ],
    "Encore un serviteur ? faut t'il autant de serfs pour servire cette maison ?", "banquier_maison", []],
  [anyone|plyr ,"banquier_maison", [],  "Qui etes vous Messire ?", "banquier_maison2", []],
  [anyone|plyr ,"banquier_maison", [],  "Je m'en allais...", "close_window",[]],
  [anyone ,"banquier_maison2", [], "Quelle éducation as tu donc recue mon garcon ?..", "close_window",[]],
  
  
  # medecin
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_manoire_conviv_medic"),
    ],
    "Ne reste pas a coté de moi, va t'en.", "maismedic_startpotion", []],
  [anyone|plyr ,"maismedic_startpotion", [],  "Que faites vous la Messire ?", "maismedic_startpotion2", []],
  [anyone|plyr ,"maismedic_startpotion", [],  "Je m'en allais...", "close_window",[]],
  [anyone ,"maismedic_startpotion2", [], "Pourquois m'embète tu ? je prépare la potion du Maistre, si je la rate encore je risque de me faire renvoyer comprend tu ?", "maismedic_startpotion23",[]],
  
  [anyone|plyr ,"maismedic_startpotion23", [],  "Quand la potion sera t'elle préte ?", "maismedic_startpotionwhen", []],
  [anyone|plyr ,"maismedic_startpotion23", [],  "Je m'en allais...", "close_window",[]],
  
  [anyone ,"maismedic_startpotionwhen", [], "Et bien, elle es préte, et elle es parfaitement réussie cette fois, oui!", "maismedic_startpotionok",[]],
  
  [anyone|plyr ,"maismedic_startpotionok", [],  "Puis je l'apporter moi meme au Maistre ?", "maismedic_startpotionokmais", []],
  [anyone|plyr ,"maismedic_startpotionok", [],  "Je vous en félicite, adieu.", "close_window",[]],
  
  [anyone ,"maismedic_startpotionokmais", [], "Non! c'est a moi qu'imcombe cette tache.", "maismedic_startpotionokmais2",[]],
  [anyone|plyr ,"maismedic_startpotionokmais2", [],  "Je vous en prie, laissez moi me rendre utile, si je ne travaille pas, ma famille n'aura rien a manger encore ce soir...", "maismedic_startpotionokmais2oknow", []],
  
  [anyone ,"maismedic_startpotionokmais2oknow", [], "Silence! c'est bon, prend la potion, mais juste aprés je ne veux plus t'avoir dans mes pattes c'est compris ?", "close_window",
    [
      #assigner variable dial potion et message vous avez la potion
      (assign, "$recupotionbanquier", 1),
      (display_message, "@Vous avez recu : Potion pour le Maistre"),
  ]],
  
  
  # dial millice ouvreur catas retour
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_cata_miliceparis"),
      (eq, "$dejavucatatorch", 1),
    ],
    "Oh la, mais c'est notre creuseur de galleries...", "catadeparis_nextretour", []],
  [anyone|plyr ,"catadeparis_nextretour", [],  "Je veux y retourner.", "catadeparis_nextretourenc", []],
  [anyone|plyr ,"catadeparis_nextretour", [],  "Je m'en Vais...", "close_window",[]],
  [anyone ,"catadeparis_nextretourenc", [], "Tu es fol, sans aucun doutes d'entrer la dedans, mais soit, cette fois ci ca sera seulement 100 écus.", "catadeparis_nextretmoincher",[]],
  
  [anyone|plyr ,"catadeparis_nextretmoincher",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 100),
    ],
    "Voila...écarte toi maintenant, je suis pressé.", "catadeparis_nextretmoinchergo",
    [
      (troop_remove_gold,"trp_player",100),
  ]],
  [anyone|plyr ,"catadeparis_nextretmoincher", [],  "Je n'ai pas la somme, je reviendrais plus tard.", "close_window",[]],
  
  [anyone ,"catadeparis_nextretmoinchergo", [], "Aprés vous mon Seigneur...Ah,Ah,ah!", "close_window",
    [
      #jump cata
      (troop_add_item, "trp_player", "itm_torch", 0),
      (jump_to_menu, "mnu_cata_suiteparis"),#passer par menu
      (finish_mission),
  ]],
  
  
  
  # dial millice ouvreur catas
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_cata_miliceparis"),
    ],
    "Oh la, on ne va pas plus loing.", "catadeparis_quartierville", []],
  [anyone|plyr ,"catadeparis_quartierville", [],  "Qu'y a t'il dériere cette porte ?", "catadeparis_quartiervillesui", []],
  [anyone|plyr ,"catadeparis_quartierville", [],  "Je m'en Vais...", "close_window",[]],
  [anyone ,"catadeparis_quartiervillesui", [], "Si tu ne le sais pas, ce sont les Catacombes.elle servent depuis toujours de cariere de pierres sous teraine, et l'ossuaire beaucoup plus loing es un cimetiere ou on y entrepose les victimes de la peste, ainsi nous diminuont les risques d'infection a Paris.Ta curiosité es elle satisfaite ? bien, du balais.", "catadeparis_quartiervillesui2",[]],
  
  [anyone|plyr ,"catadeparis_quartiervillesui2", [],  "Je veux quand meme jeter un oeil.", "catadeparis_quartiervillesui2oui", []],
  [anyone|plyr ,"catadeparis_quartiervillesui2", [],  "Ca va, je m'en Vais.", "close_window",[]],
  
  [anyone ,"catadeparis_quartiervillesui2oui", [], "Hors de question, l'entrée es interdite, pourquois suis je ici, aux quatres vents a ton avis ?", "catadeparis_quartiervillesui2ook",[]],
  
  [anyone|plyr ,"catadeparis_quartiervillesui2ook", [],  "Et contre 100 écus, me laisserais tu entrer ?", "catadeparis_quartiervilentrr", []],
  [anyone|plyr ,"catadeparis_quartiervillesui2ook", [],  "Ca va, je m'en Vais.", "close_window",[]],
  
  [anyone ,"catadeparis_quartiervilentrr", [], "200...", "catadeparis_quartiervilmore",[]],
  
  [anyone|plyr ,"catadeparis_quartiervilmore", [],  "150 écus, pas plus.", "catadeparis_quartiervmoin", []],
  
  [anyone ,"catadeparis_quartiervmoin", [], "Tcha! et aprés tout, qu'es ce que j'en es a faire...", "catadeparis_quartiervmoinokk",[]],
  
  [anyone|plyr ,"catadeparis_quartiervmoinokk",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 150),
    ],
    "Voila...en éspèrant ne pas les avoir dépenssés pour rien.", "catadeparis_quartiervstartentr",
    [
      (troop_remove_gold,"trp_player",150),
  ]],
  [anyone|plyr ,"catadeparis_quartiervmoinokk", [],  "Je n'ai pas la somme, je reviendrais plus tard.", "close_window",[]],
  
  [anyone ,"catadeparis_quartiervstartentr", [], "C'est ton affaire...Tiens t'aura besoin de ca, entre vite que l'on ne te voie pas.", "close_window",
    [
      #jump cata
      (assign, "$dejavucatatorch", 1),
      (troop_add_item, "trp_player", "itm_torch", 0),
      (jump_to_menu, "mnu_cata_suiteparis"),#passer par menu
      (finish_mission),
  ]],
  
  
  
  # dial cardinaux paris
  #dial pretres
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_paris_moine_segond"),
    ],
    "Que puis je faire pour vous ?", "moinsui_paris_start", []],
  [anyone|plyr ,"moinsui_paris_start", [],  "Je désire m'entretenire avec une haute autoritée de l'église.", "moinsui_paris_start2", []],
  [anyone|plyr ,"moinsui_paris_start", [],  "Je suis simplement de passage.", "close_window", []],
  
  [anyone ,"moinsui_paris_start2", [], "Et bien le Cardinal es justement a coté de vous, veillez a ne pas l'ennuyer avec des affaires politiques je vous prie.", "close_window",[]],
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_bourges_moine_segond"),
    ],
    "Oui, qu'y a t'il ?", "moinsui_suivant_start", []],
  [anyone|plyr ,"moinsui_suivant_start", [],  "Je désire m'entretenire avec une haute autoritée de l'église.", "moinsui_suivant_start2", []],
  [anyone|plyr ,"moinsui_suivant_start", [],  "Je suis simplement de passage.", "close_window", []],
  
  [anyone ,"moinsui_suivant_start2", [], "Et bien le Cardinal es justement a coté de vous, veillez a ne pas l'ennuyer avec des affaires politiques je vous prie.", "close_window",[]],
  
  
  #
  [anyone,"start", [(this_or_next|eq, "$g_talk_troop", "trp_paris_evec_troop1"),
      (eq, "$g_talk_troop", "trp_bourges_evec_troop1"),
    ],
    "Je n'aime point m'entretenire avec les gens d'armes, mais soit, que me voullez vous ?", "cardin_paris_start", []],
  [anyone|plyr ,"cardin_paris_start", [],  "Monseigneur, je désire versser une donation pour me faire pardonner de mes fautes [controversse].", "catadeparis_contro", []],
  [anyone|plyr ,"cardin_paris_start", [],  "Je désire versser une donation pour que vos prières me rendent victorieu au champ de bataille [renomée].", "catadeparis_renom", []],
  # test
  [anyone|plyr ,"cardin_paris_start",
    [
      #condition, je suis vassal
      (eq, "$quete_jhoan_ready_orleans", 1),# remetre !!!!! 1
      (eq, "$cardinal_diplo", 0),
      (troop_slot_ge, "trp_player", slot_troop_controversy, 0),
    ],
    "Monseigneur, ne pouriez vous pas intervenire auprés des autres factions chrétiennes pour optenire une tréve ? [Diplomacie].", "catadeparis_diplo", []],# A FAIRE !!!!!!!!!!!
  
  
  
  [anyone|plyr ,"cardin_paris_start",
    [
      #condition, je suis vassal
      (eq, "$quete_jhoan_ready_orleans", 1),# remetre !!!!! 2
      (eq, "$cardinal_diplo", 0),
      (troop_slot_ge, "trp_player", slot_troop_controversy, 25),
    ],
    "Monseigneur, ne pouriez vous pas intervenire auprés des autres factions chrétiennes pour optenire une tréve ? [Diplomacie].", "catadeparis_diplono", []],# A FAIRE !!!!!!!!!!!
  
  
  
  # test end
  [anyone|plyr ,"cardin_paris_start", [],  "Je ne vous dérangerais pas d'avantage Monseigneur...", "close_window",[]],
  
  
  
  
  [anyone ,"catadeparis_contro", [], "Si vous ne vous etes pas comporté en bon chrétien mais que votre repentir es sincère, je peut agire pour laver vostre nom. Mais il vous faudra faire un geste envers l'église en retour, verssez une donation de 5000 écus et j'interviendrais en vostre faveur.", "catadeparis_contro_pay",[]],
  
  [anyone|plyr ,"catadeparis_contro_pay",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 3000),
    ],
    "Naturelemnet, voici 3000 écus, puisse cette somme venire en aide a l'église et me faire pardonner pour mes actions.", "close_window",
    [
      (troop_remove_gold,"trp_player",3000),
      (troop_set_slot, "trp_player", slot_troop_controversy, 0),
      (display_message, "@Vous etes pardonné de vos pechés par votre faction !", 0x33DD33),#vert
  ]],
  [anyone|plyr ,"catadeparis_contro_pay", [],  "C'es bien plus cher qu'une rancon !...", "catadeparis_contro_payno",[]],
  
  [anyone ,"catadeparis_contro_payno", [], "Comment osez vous ?!.", "catadeparis_contro_payno_end",[]],
  [anyone|plyr ,"catadeparis_contro_payno_end", [],  "Je vous prie de me pardonner Monseigneur, je reviendrais avec l'argent.", "close_window",[]],
  
  
  
  
  
  [anyone ,"catadeparis_renom", [], "Vous estes un exemple pour tous les chrétiens! combien voullez vous versser aux deniers de la sainte mère église ?", "catadeparis_renomhow",[]],
  
  [anyone|plyr ,"catadeparis_renomhow",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 300),
    ],
    "300 écus.", "catadeparis_renlow",
    [
      (troop_remove_gold,"trp_player",300),
  ]],
  
  [anyone|plyr ,"catadeparis_renomhow",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 800),
    ],
    "800 écus.", "catadeparis_renmedium",
    [
      (troop_remove_gold,"trp_player",800),
  ]],
  
  [anyone|plyr ,"catadeparis_renomhow",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 2000),
    ],
    "2000 écus !", "catadeparis_renhigh",
    [
      (troop_remove_gold,"trp_player",2000),
  ]],
  
  [anyone|plyr ,"catadeparis_renomhow", [],  "Je ne puis pour le moment, mais j'y songe mon Seigneur.", "close_window",[]],
  
  [anyone ,"catadeparis_renlow", [], "Et bien...cela aideras toujours un peut...je vous en remercie, sur ce, mon temps es précieux savez vous...", "close_window",
    [
      (call_script, "script_change_troop_renown", "trp_player", 2),
  ]],
  [anyone ,"catadeparis_renmedium", [], "Vous faites la preuve d'une grande honneteté, vostre dévotion sera connue de tous soyez en certain.", "close_window",
    [
      (call_script, "script_change_troop_renown", "trp_player", 8),
  ]],
  [anyone ,"catadeparis_renhigh", [], "Et bien, je vous remercie Messire, vous etstes un des plus grands donateurs vostre foi es remarcable, le peuple tout entier priera pour vous et vostre nom sera couvert d'éloges soyez en certain !", "close_window",
    [
      (call_script, "script_change_troop_renown", "trp_player", 20),
  ]],
  
  
  # A FAIRE !!!!!!!!!!!    TEST !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
  [anyone ,"catadeparis_diplo",
    [
      # si je suis sans reproches
      (troop_slot_ge, "trp_player", slot_troop_controversy, 0),
      ], "Il est appréciable que vous shouatiez la paix dans ce malheureux pays, a qui penssez vous exactement ?", "catadeparis_diplowho",[]],
  #
  
  [anyone|plyr ,"catadeparis_diplowho", [],  "Nous devrions tenter d'améliorer les relations envers la France et l'Angleterre.", "catadeparis_diplofreng", []],
  [anyone ,"catadeparis_diplofreng", [], "En effet, bien que je doute que ma parole puisse faire avancer les choses, mais nous devons éssayer de nouveau.", "close_window",
    [
      (call_script, "script_troop_change_relation_with_troop", "trp_kingdom_1_lord", "trp_kingdom_2_lord", 30),
      (assign, "$cardinal_diplo", 1),
  ]],
  
  [anyone|plyr ,"catadeparis_diplowho", [],  "Nous devrions tenter d'améliorer les relations envers la France et la Bourgogne.", "catadeparis_diplofrbrg", []],
  [anyone ,"catadeparis_diplofrbrg", [], "L'Angleterre privée de son aliée la Bourgogne risque de réduire ses attaques sur la France, mais le Dauphin Charles ne va t'il pas profiter de cette occasion pour agrésser l'Angleterre ou la Bourgogne a son tour ? je devrais etre prudent et mesuré dans mes paroles, je vais m'entretenire avec le Duc de Bourgogne et voir si il ne peut pas accepter une tréve dans un premier temps, l'idéale serais que les Bourgignons soient neutre dans cette affaire et laissent la France et l'Angleterre régler cette affaire par l'honneur et la diplomacie plutot que par le sang.", "close_window",
    [
      (call_script, "script_troop_change_relation_with_troop", "trp_kingdom_1_lord", "trp_kingdom_3_lord", 40),# 30
      (assign, "$cardinal_diplo", 1),
  ]],
  
  [anyone|plyr ,"catadeparis_diplowho", [],  "Nous devrions tenter d'améliorer les relations envers l'Angleterre et la Bourgogne.", "catadeparis_diploengbgr", []],
  [anyone ,"catadeparis_diploengbgr", [], "Il est préfférable que les Anglais et les Bourgignons ne s'entretuent pas, la situation es délicate, et en temp que représentant des chrétiens je me doit de m'assurer que les deux camps ne se livrent pas a des tueries incontralobles.", "close_window",
    [
      (call_script, "script_troop_change_relation_with_troop", "trp_kingdom_2_lord", "trp_kingdom_3_lord", 30),
      (assign, "$cardinal_diplo", 1),
  ]],
  
  
  
  [anyone|plyr ,"catadeparis_diplowho", [],  "Nous devrions tenter d'améliorer les relations envers la France et la Bretagne.", "catadeparis_diploengbret", []],
  [anyone ,"catadeparis_diploengbret", [], "Il est préfférable que les Armaniacs et les Bretons ne s'entretuent pas, la situation es délicate, et en temp que représentant des chrétiens je me doit de m'assurer que les deux camps ne se livrent pas a des tueries incontralobles.", "close_window",
    [
      (call_script, "script_troop_change_relation_with_troop", "trp_kingdom_1_lord", "trp_kingdom_4_lord", 40),
      (assign, "$cardinal_diplo", 1),
  ]],
  
  
  [anyone|plyr ,"catadeparis_diplowho", [],  "Je ne pensse pas que cela va marcher...", "close_window", []],
  
  
  [anyone ,"catadeparis_diplono",
    [
      #(troop_slot_ge, "trp_player", slot_troop_controversy, 25),
      ], "Comment osez vous parler de paix ? vous n'estes pas la personne la plus a meme de mener d'honnetes négociations...cessez de me faire perdre mon temps je vous prie.", "close_window",[]],
  
  
  
  #banquiers dials
  #si pas pu remboursser
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_Bourges_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_failed, "qst_banque30"),
      (check_quest_finished, "qst_banque30"),
      #(check_quest_failed, "qst_banque60"),
      #(check_quest_failed, "qst_banque90"),
      #(check_quest_failed, "qst_banque14"),
    ],
    "Hors de ma vue fripouille, vous n'optiendrais plus de prets !", "banquierbourg_fail",
    [
      # (troop_set_slot, "$g_talk_troop", slot_troop_controversy, 20),
      # (call_script, "script_change_player_relation_with_faction_ex", "fac_kingdom_1", -4),
  ]],
  #
  [anyone|plyr ,"banquierbourg_fail",
    [],  "Et bien...je m'en vais dans ce cas.", "close_window",
    []],
  
  #si pas pu remboursser
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_paris_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_failed, "qst_banque30"),
      (check_quest_finished, "qst_banque30"),
      #(check_quest_failed, "qst_banque60"),
      #(check_quest_failed, "qst_banque90"),
      #(check_quest_failed, "qst_banque14"),
    ],
    "Hors de ma vue fripouille, vous n'optiendrais plus de prets !", "banquierbourg_failpar",
    [
      #(troop_set_slot, "$g_talk_troop", slot_troop_controversy, 20),
      #(call_script, "script_change_player_relation_with_faction_ex", "fac_kingdom_1", -4),
  ]],
  #
  [anyone|plyr ,"banquierbourg_failpar",
    [],  "Et bien, je...je m'en vais dans ce cas.", "close_window",
    []],
  
  #si pas pu remboursser
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_marseille_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_failed, "qst_banque30"),
      (check_quest_finished, "qst_banque30"),
      # (check_quest_failed, "qst_banque60"),
      #(check_quest_failed, "qst_banque90"),
      #(check_quest_failed, "qst_banque14"),
    ],
    "Hors de ma vue fripouille, vous n'optiendrais plus de prets !", "banquierbourg_failmars",
    [
      #(troop_set_slot, "$g_talk_troop", slot_troop_controversy, 20),
      #(call_script, "script_change_player_relation_with_faction_ex", "fac_kingdom_1", -4),
  ]],
  #
  [anyone|plyr ,"banquierbourg_failmars",
    [],  "Et bien, je...je m'en vais dans ce cas.", "close_window",
    []],
  
  
  #banquiers dials
  #si pas pu remboursser
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_Bourges_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      #(check_quest_failed, "qst_banque30"),
      (check_quest_failed, "qst_banque60"),
      (check_quest_finished, "qst_banque60"),
      #(check_quest_failed, "qst_banque90"),
      #(check_quest_failed, "qst_banque14"),
    ],
    "Hors de ma vue fripouille, vous n'optiendrais plus de prets !", "banquierbourg_fail1",
    [
      #(troop_set_slot, "$g_talk_troop", slot_troop_controversy, 20),
      #(call_script, "script_change_player_relation_with_faction_ex", "fac_kingdom_1", -4),
  ]],
  #
  [anyone|plyr ,"banquierbourg_fail1",
    [],  "Et bien, je...je m'en vais dans ce cas.", "close_window",
    []],
  
  #si pas pu remboursser
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_paris_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_failed, "qst_banque60"),
      (check_quest_finished, "qst_banque60"),
      #(check_quest_failed, "qst_banque60"),
      #(check_quest_failed, "qst_banque90"),
      #(check_quest_failed, "qst_banque14"),
    ],
    "Hors de ma vue fripouille, vous n'optiendrais plus de prets !", "banquierbourg_failpar2",
    [
      #(troop_set_slot, "$g_talk_troop", slot_troop_controversy, 20),
      #(call_script, "script_change_player_relation_with_faction_ex", "fac_kingdom_1", -4),
  ]],
  #
  [anyone|plyr ,"banquierbourg_failpar2",
    [],  "Et bien, je...je m'en vais dans ce cas.", "close_window",
    []],
  
  #si pas pu remboursser
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_marseille_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_failed, "qst_banque60"),
      (check_quest_finished, "qst_banque60"),
      # (check_quest_failed, "qst_banque60"),
      #(check_quest_failed, "qst_banque90"),
      #(check_quest_failed, "qst_banque14"),
    ],
    "Hors de ma vue fripouille, vous n'optiendrais plus de prets !", "banquierbourg_failmars3",
    [
      #(troop_set_slot, "$g_talk_troop", slot_troop_controversy, 20),
      #(call_script, "script_change_player_relation_with_faction_ex", "fac_kingdom_1", -4),
  ]],
  #
  [anyone|plyr ,"banquierbourg_failmars3",
    [],  "Et bien, je...je m'en vais dans ce cas.", "close_window",
    []],
  
  
  
  #banquiers dials
  #si pas pu remboursser
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_Bourges_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      #(check_quest_failed, "qst_banque30"),
      (check_quest_failed, "qst_banque90"),
      (check_quest_finished, "qst_banque90"),
      #(check_quest_failed, "qst_banque90"),
      #(check_quest_failed, "qst_banque14"),
    ],
    "Hors de ma vue fripouille, vous n'optiendrais plus de prets !", "banquierbourg_fail4",
    [
      #(troop_set_slot, "$g_talk_troop", slot_troop_controversy, 20),
      #(call_script, "script_change_player_relation_with_faction_ex", "fac_kingdom_1", -4),
  ]],
  #
  [anyone|plyr ,"banquierbourg_fail4",
    [],  "Et bien, je...je m'en vais dans ce cas.", "close_window",
    []],
  
  #si pas pu remboursser
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_paris_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_failed, "qst_banque90"),
      (check_quest_finished, "qst_banque90"),
      #(check_quest_failed, "qst_banque60"),
      #(check_quest_failed, "qst_banque90"),
      #(check_quest_failed, "qst_banque14"),
    ],
    "Hors de ma vue fripouille, vous n'optiendrais plus de prets !", "banquierbourg_failpar4",
    [
      #(troop_set_slot, "$g_talk_troop", slot_troop_controversy, 20),
      #(call_script, "script_change_player_relation_with_faction_ex", "fac_kingdom_1", -4),
  ]],
  #
  [anyone|plyr ,"banquierbourg_failpar4",
    [],  "Et bien, je...je m'en vais dans ce cas.", "close_window",
    []],
  
  #si pas pu remboursser
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_marseille_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_failed, "qst_banque90"),
      (check_quest_finished, "qst_banque90"),
      # (check_quest_failed, "qst_banque60"),
      #(check_quest_failed, "qst_banque90"),
      #(check_quest_failed, "qst_banque14"),
    ],
    "Hors de ma vue fripouille, vous n'optiendrais plus de prets !", "banquierbourg_failmars4",
    [
      #(troop_set_slot, "$g_talk_troop", slot_troop_controversy, 20),
      #(call_script, "script_change_player_relation_with_faction_ex", "fac_kingdom_1", -4),
  ]],
  #
  [anyone|plyr ,"banquierbourg_failmars4",
    [],  "Et bien, je...je m'en vais dans ce cas.", "close_window",
    []],
  
  
  #banquiers dials
  #si pas pu remboursser
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_Bourges_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      #(check_quest_failed, "qst_banque30"),
      (check_quest_failed, "qst_banque14"),
      (check_quest_finished, "qst_banque14"),
      #(check_quest_failed, "qst_banque90"),
      #(check_quest_failed, "qst_banque14"),
    ],
    "Hors de ma vue fripouille, vous n'optiendrais plus de prets !", "banquierbourg_fail5",
    [
      #(troop_set_slot, "$g_talk_troop", slot_troop_controversy, 20),
      #(call_script, "script_change_player_relation_with_faction_ex", "fac_kingdom_1", -4),
  ]],
  #
  [anyone|plyr ,"banquierbourg_fail5",
    [],  "Et bien, je...je m'en vais dans ce cas.", "close_window",
    []],
  
  #si pas pu remboursser
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_paris_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_failed, "qst_banque14"),
      (check_quest_finished, "qst_banque14"),
      #(check_quest_failed, "qst_banque60"),
      #(check_quest_failed, "qst_banque90"),
      #(check_quest_failed, "qst_banque14"),
    ],
    "Hors de ma vue fripouille, vous n'optiendrais plus de prets !", "banquierbourg_failpar5",
    [
      #(troop_set_slot, "$g_talk_troop", slot_troop_controversy, 20),
      #(call_script, "script_change_player_relation_with_faction_ex", "fac_kingdom_1", -4),
  ]],
  #
  [anyone|plyr ,"banquierbourg_failpar5",
    [],  "Et bien, je...je m'en vais dans ce cas.", "close_window",
    []],
  
  #si pas pu remboursser
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_marseille_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_failed, "qst_banque14"),
      (check_quest_finished, "qst_banque14"),
      # (check_quest_failed, "qst_banque60"),
      #(check_quest_failed, "qst_banque90"),
      #(check_quest_failed, "qst_banque14"),
    ],
    "Hors de ma vue fripouille, vous n'optiendrais plus de prets !", "banquierbourg_failmars5",
    [
      #(troop_set_slot, "$g_talk_troop", slot_troop_controversy, 20),
      #(call_script, "script_change_player_relation_with_faction_ex", "fac_kingdom_1", -4),
  ]],
  #
  [anyone|plyr ,"banquierbourg_failmars5",
    [],  "Et bien, je...je m'en vais dans ce cas.", "close_window",
    []],
  
  ############################################################################################################################
  #si je doit 3300
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_Bourges_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_active, "qst_banque30"),
      (neg|check_quest_succeeded, "qst_banque30"),
    ],
    "Messire ? un instant, vous devez déja de l'argent aux banquiers, jéspère que vous vennez payer.", "banquierbourg_rembours", []],
  #
  [anyone|plyr ,"banquierbourg_rembours",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 3300),
    ],  "Je viens vous remboursser.", "banquierbourg_remboursok",
    [
      (troop_remove_gold,"trp_player",3300),
      (call_script, "script_end_quest", "qst_banque30"),
  ]],
  
  
  [anyone|plyr ,"banquierbourg_rembours", [],  "Je reviendrais avec l'argent, n'ayez crainte.", "close_window", []],
  
  [anyone ,"banquierbourg_remboursok", [], "C'es parfait, c'es un plaisir de faire affaires avec vous Messire, a bientot je l'éspère.", "close_window",
    [
      (assign, "$pret_banque", 0),
  ]],
  #
  #si je doit 6600
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_Bourges_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_active, "qst_banque60"),
      (neg|check_quest_succeeded, "qst_banque60"),
    ],
    "Messire ? un instant, vous devez déja de l'argent aux banquiers, jéspère que vous vennez payer.", "banquierbourg_rembours2", []],
  #
  [anyone|plyr ,"banquierbourg_rembours2",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 6600),
    ],  "Je viens remboursser.", "banquierbourg_remboursok2",
    [
      (troop_remove_gold,"trp_player",6600),
      (call_script, "script_end_quest", "qst_banque60"),
  ]],
  
  
  [anyone|plyr ,"banquierbourg_rembours2", [],  "Je reviendrais avec l'argent, n'ayez crainte.", "close_window", []],
  
  [anyone ,"banquierbourg_remboursok2", [], "C'es parfait, c'es un plaisir de faire affaires avec vous Messire, a bientot je l'éspère.", "close_window",
    [
      (assign, "$pret_banque", 0),
  ]],
  #
  #si je doit 9900
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_Bourges_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_active, "qst_banque90"),
      (neg|check_quest_succeeded, "qst_banque90"),
    ],
    "Messire ? un instant, vous devez déja de l'argent aux banquiers, jéspère que vous vennez payer.", "banquierbourg_rembours3", []],
  #
  [anyone|plyr ,"banquierbourg_rembours3",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 9900),
    ],  "Je viens remboursser.", "banquierbourg_remboursok3",
    [
      (troop_remove_gold,"trp_player",9900),
      (call_script, "script_end_quest", "qst_banque90"),
  ]],
  
  
  [anyone|plyr ,"banquierbourg_rembours3", [],  "Je reviendrais avec l'argent, n'ayez crainte.", "close_window", []],
  
  [anyone ,"banquierbourg_remboursok3", [], "C'es parfait, c'es un plaisir de faire affaires avec vous Messire, a bientot je l'éspère.", "close_window",
    [
      (assign, "$pret_banque", 0),
  ]],
  #
  #si je doit 15.400
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_Bourges_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_active, "qst_banque14"),
      (neg|check_quest_succeeded, "qst_banque14"),
    ],
    "Messire ? un instant, vous devez déja de l'argent aux banquiers, jéspère que vous vennez payer.", "banquierbourg_rembours4", []],
  #
  [anyone|plyr ,"banquierbourg_rembours4",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 15400),
    ],  "Je viens remboursser.", "banquierbourg_remboursok4",
    [
      (troop_remove_gold,"trp_player",15400),
      (call_script, "script_end_quest", "qst_banque14"),
  ]],
  
  
  [anyone|plyr ,"banquierbourg_rembours4", [],  "Je reviendrais avec l'argent, n'ayez crainte.", "close_window", []],
  
  [anyone ,"banquierbourg_remboursok4", [], "C'es parfait, c'es un plaisir de faire affaires avec vous Messire, a bientot je l'éspère.", "close_window",
    [
      (assign, "$pret_banque", 0),
  ]],
  #
  ############################################################################################################################
  #si je doit 3300
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_paris_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_active, "qst_banque30"),
      (neg|check_quest_succeeded, "qst_banque30"),
    ],
    "Messire ? un instant, vous devez déja de l'argent aux banquiers, jéspère que vous vennez payer.", "banquierbourg_rembourspars", []],
  #
  [anyone|plyr ,"banquierbourg_rembourspars",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 3300),
    ],  "Je viens vous remboursser.", "banquierbourg_remboursokpars",
    [
      (troop_remove_gold,"trp_player",3300),
      (call_script, "script_end_quest", "qst_banque30"),
  ]],
  
  
  [anyone|plyr ,"banquierbourg_rembourspars", [],  "Je reviendrais avec l'argent, n'ayez crainte.", "close_window", []],
  
  [anyone ,"banquierbourg_remboursokpars", [], "C'es parfait, c'es un plaisir de faire affaires avec vous Messire, a bientot je l'éspère.", "close_window",
    [
      (assign, "$pret_banque", 0),
  ]],
  #
  #si je doit 6600
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_paris_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_active, "qst_banque60"),
      (neg|check_quest_succeeded, "qst_banque60"),
    ],
    "Messire ? un instant, vous devez déja de l'argent aux banquiers, jéspère que vous vennez payer.", "banquierbourg_rembours2pars", []],
  #
  [anyone|plyr ,"banquierbourg_rembours2pars",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 6600),
    ],  "Je viens remboursser.", "banquierbourg_remboursok2pars",
    [
      (troop_remove_gold,"trp_player",6600),
      (call_script, "script_end_quest", "qst_banque60"),
  ]],
  
  
  [anyone|plyr ,"banquierbourg_rembours2pars", [],  "Je reviendrais avec l'argent, n'ayez crainte.", "close_window", []],
  
  [anyone ,"banquierbourg_remboursok2pars", [], "C'es parfait, c'es un plaisir de faire affaires avec vous Messire, a bientot je l'éspère.", "close_window",
    [
      (assign, "$pret_banque", 0),
  ]],
  #
  #si je doit 9900
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_paris_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_active, "qst_banque90"),
      (neg|check_quest_succeeded, "qst_banque90"),
    ],
    "Messire ? un instant, vous devez déja de l'argent aux banquiers, jéspère que vous vennez payer.", "banquierbourg_rembours3pars", []],
  #
  [anyone|plyr ,"banquierbourg_rembours3pars",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 9900),
    ],  "Je viens remboursser.", "banquierbourg_remboursok3pars",
    [
      (troop_remove_gold,"trp_player",9900),
      (call_script, "script_end_quest", "qst_banque90"),
  ]],
  
  
  [anyone|plyr ,"banquierbourg_rembours3pars", [],  "Je reviendrais avec l'argent, n'ayez crainte.", "close_window", []],
  
  [anyone ,"banquierbourg_remboursok3pars", [], "C'es parfait, c'es un plaisir de faire affaires avec vous Messire, a bientot je l'éspère.", "close_window",
    [
      (assign, "$pret_banque", 0),
  ]],
  #
  #si je doit 15.400
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_paris_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_active, "qst_banque14"),
      (neg|check_quest_succeeded, "qst_banque14"),
    ],
    "Messire ? un instant, vous devez déja de l'argent aux banquiers, jéspère que vous vennez payer.", "banquierbourg_rembours4pars", []],
  #
  [anyone|plyr ,"banquierbourg_rembours4pars",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 15400),
    ],  "Je viens remboursser.", "banquierbourg_remboursok4pars",
    [
      (troop_remove_gold,"trp_player",15400),
      (call_script, "script_end_quest", "qst_banque14"),
  ]],
  
  
  [anyone|plyr ,"banquierbourg_rembours4pars", [],  "Je reviendrais avec l'argent, n'ayez crainte.", "close_window", []],
  
  [anyone ,"banquierbourg_remboursok4pars", [], "C'es parfait, c'es un plaisir de faire affaires avec vous Messire, a bientot je l'éspère.", "close_window",
    [
      (assign, "$pret_banque", 0),
  ]],
  #
  ############################################################################################################################
  #si je doit 3300
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_marseille_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_active, "qst_banque30"),
      (neg|check_quest_succeeded, "qst_banque30"),
    ],
    "Messire ? un instant, vous devez déja de l'argent aux banquiers, jéspère que vous vennez payer.", "banquierbourg_remboursmars", []],
  #
  [anyone|plyr ,"banquierbourg_remboursmars",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 3300),
    ],  "Je viens vous remboursser.", "banquierbourg_remboursokmars",
    [
      (troop_remove_gold,"trp_player",3300),
      (call_script, "script_end_quest", "qst_banque30"),
  ]],
  
  
  [anyone|plyr ,"banquierbourg_remboursmars", [],  "Je reviendrais avec l'argent, n'ayez crainte.", "close_window", []],
  
  [anyone ,"banquierbourg_remboursokmars", [], "C'es parfait, c'es un plaisir de faire affaires avec vous Messire, a bientot je l'éspère.", "close_window",
    [
      (assign, "$pret_banque", 0),
  ]],
  #
  #si je doit 6600
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_marseille_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_active, "qst_banque60"),
      (neg|check_quest_succeeded, "qst_banque60"),
    ],
    "Messire ? un instant, vous devez déja de l'argent aux banquiers, jéspère que vous vennez payer.", "banquierbourg_rembours2mars", []],
  #
  [anyone|plyr ,"banquierbourg_rembours2mars",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 6600),
    ],  "Je viens remboursser.", "banquierbourg_remboursok2mars",
    [
      (troop_remove_gold,"trp_player",6600),
      (call_script, "script_end_quest", "qst_banque60"),
  ]],
  
  
  [anyone|plyr ,"banquierbourg_rembours2mars", [],  "Je reviendrais avec l'argent, n'ayez crainte.", "close_window", []],
  
  [anyone ,"banquierbourg_remboursok2mars", [], "C'es parfait, c'es un plaisir de faire affaires avec vous Messire, a bientot je l'éspère.", "close_window",
    [
      (assign, "$pret_banque", 0),
  ]],
  #
  #si je doit 9900
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_marseille_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_active, "qst_banque90"),
      (neg|check_quest_succeeded, "qst_banque90"),
    ],
    "Messire ? un instant, vous devez déja de l'argent aux banquiers, jéspère que vous vennez payer.", "banquierbourg_rembours3mars", []],
  #
  [anyone|plyr ,"banquierbourg_rembours3mars",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 9900),
    ],  "Je viens remboursser.", "banquierbourg_remboursok3mars",
    [
      (troop_remove_gold,"trp_player",9900),
      (call_script, "script_end_quest", "qst_banque90"),
  ]],
  
  
  [anyone|plyr ,"banquierbourg_rembours3mars", [],  "Je reviendrais avec l'argent, n'ayez crainte.", "close_window", []],
  
  [anyone ,"banquierbourg_remboursok3mars", [], "C'es parfait, c'es un plaisir de faire affaires avec vous Messire, a bientot je l'éspère.", "close_window",
    [
      (assign, "$pret_banque", 0),
  ]],
  #
  #si je doit 15.400
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_marseille_banquier"),
      #si pret en cour  ,remetre a 0 :    (assign, "$pret_banque", 0),
      (eq, "$pret_banque", 1),
      (check_quest_active, "qst_banque14"),
      (neg|check_quest_succeeded, "qst_banque14"),
    ],
    "Messire ? un instant, vous devez déja de l'argent aux banquiers, jéspère que vous vennez payer.", "banquierbourg_rembours4mars", []],
  #
  [anyone|plyr ,"banquierbourg_rembours4mars",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 15400),
    ],  "Je viens remboursser.", "banquierbourg_remboursok4mars",
    [
      (troop_remove_gold,"trp_player",15400),
      (call_script, "script_end_quest", "qst_banque14"),
  ]],
  
  
  [anyone|plyr ,"banquierbourg_rembours4mars", [],  "Je reviendrais avec l'argent, n'ayez crainte.", "close_window", []],
  
  [anyone ,"banquierbourg_remboursok4mars", [], "C'es parfait, c'es un plaisir de faire affaires avec vous Messire, a bientot je l'éspère.", "close_window",
    [
      (assign, "$pret_banque", 0),
  ]],
  #
  
  
  
  #bourges
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_Bourges_banquier"),
      #si pat de pret en cour
      (eq, "$quete_jhoan_ready_orleans", 1),
      
      (eq, "$pret_banque", 0),
    ],
    "Désirez vous un pret Messire ? les intérets sont très tentants vous savez.", "banquierbourg_start", []],
  [anyone|plyr ,"banquierbourg_start", [],  "Je désire empreinter en effet.", "banquierbourg_somes", []],
  [anyone|plyr ,"banquierbourg_start", [],  "Que se passerais t'il si je ne pouvais payer a temps ?", "banquierbourg_impayer", []],
  [anyone|plyr ,"banquierbourg_start", [],  "Je reviendrais.", "close_window", []],
  [anyone ,"banquierbourg_predial", [], "Avez vous une autre question ?", "banquierbourg_start",[]],
  
  [anyone ,"banquierbourg_impayer", [], "Grand Dieu, et bien si vous ne pavennez pas a remboursser, vous risquez les pires ennuis je le crain, vous deviendrez un hors la loi dans vostre pays, et beaucoup de gens vous rejeterons a cause de cela, sans compter que vous ne pouriez plus avoir de prets. croyez moi, il vaudra mieux que vous rembourssiez.", "banquierbourg_predial",[]],
  
  [anyone ,"banquierbourg_somes", [], "De combien avez vous besoin ? j'ai un pret de 3000 écus, il vous faudra alors me remboursser 3300 écus d'interet, ou bien 6000 écus ou 6600 écus avec les interets, 9000 qui feron 9900 et enfin pour un pret de 14.000, il vous faudra remboursser 15.400  écus.", "banquierbourg_somes2",[]],
  
  [anyone|plyr ,"banquierbourg_somes2", [],  "J'ai besoin de 3000 écus.", "pret_3000", [(troop_add_gold, "trp_player", 3000),]],
  [anyone|plyr ,"banquierbourg_somes2", [],  "J'ai besoin de 6000 écus.", "pret_6000", [(troop_add_gold, "trp_player", 6000),]],
  [anyone|plyr ,"banquierbourg_somes2", [],  "J'ai besoin de 9000 écus.", "pret_9000", [(troop_add_gold, "trp_player", 9000),]],
  [anyone|plyr ,"banquierbourg_somes2", [],  "J'ai besoin de 14.000 écus.", "pret_14000", [(troop_add_gold, "trp_player", 14000),]],
  [anyone|plyr ,"banquierbourg_somes2", [],  "Laissez tomber, j'ai changer d'avis.", "close_window", []],
  
  [anyone ,"pret_3000", [], "Bien, voici votre argent, n'oubliez pas, vous avez 100 jours pour me remboursser.", "close_window",
    [
      (setup_quest_text,"qst_banque30"),
      (str_store_string, s2, "@Je doit remboursser la Somme de 3300 écus avant le delai imparti, sans quois je risque de gros ennuis."),
      (call_script, "script_start_quest", "qst_banque30", "$g_talk_troop"),
      (quest_set_slot, "qst_banque30", slot_quest_expiration_days, 100),
      (assign, "$pret_banque", 1),
  ]],
  [anyone ,"pret_6000", [], "Bien, voici votre argent, n'oubliez pas, vous avez 100 jours pour me remboursser.", "close_window",
    [
      (setup_quest_text,"qst_banque60"),
      (str_store_string, s2, "@Je doit remboursser la Somme de 6600 écus avant le delai imparti, sans quois je risque de gros ennuis."),
      (call_script, "script_start_quest", "qst_banque60", "$g_talk_troop"),
      (quest_set_slot, "qst_banque60", slot_quest_expiration_days, 100),
      (assign, "$pret_banque", 1),
  ]],
  [anyone ,"pret_9000", [], "Bien, voici votre argent, n'oubliez pas, vous avez 100 jours pour me remboursser.", "close_window",
    [
      (setup_quest_text,"qst_banque90"),
      (str_store_string, s2, "@Je doit remboursser la Somme de 9900 écus avant le delai imparti, sans quois je risque de gros ennuis."),
      (call_script, "script_start_quest", "qst_banque90", "$g_talk_troop"),
      (quest_set_slot, "qst_banque90", slot_quest_expiration_days, 100),
      (assign, "$pret_banque", 1),
  ]],
  [anyone ,"pret_14000", [], "Bien, voici votre argent, n'oubliez pas, vous avez 100 jours pour me remboursser.", "close_window",
    [
      (setup_quest_text,"qst_banque14"),
      (str_store_string, s2, "@Je doit remboursser la Somme de 15.400 écus avant le delai imparti, sans quois je risque de gros ennuis."),
      (call_script, "script_start_quest", "qst_banque14", "$g_talk_troop"),
      (quest_set_slot, "qst_banque14", slot_quest_expiration_days, 100),
      (assign, "$pret_banque", 1),
  ]],
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_Bourges_banquier"),
      (eq, "$quete_jhoan_ready_orleans", 0),
      #si pat de pret en cour
      (eq, "$pret_banque", 0),
    ],
    "Messire ? nous ne prestons point aux malandrins de vostre rang, partez sur le champ ou devenez quelqu'un de viable.", "banquierbourg_maresnoood", []],
  [anyone|plyr ,"banquierbourg_maresnoood", [],  "Je voie...", "close_window", []],
  
  
  #paris
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_paris_banquier"),
      (eq, "$quete_jhoan_ready_orleans", 1),
      #si pat de pret en cour
      (eq, "$pret_banque", 0),
    ],
    "Désirez vous un pret Messire ? les intérets sont très tentants vous savez.", "banquierbourg_startpar", []],
  [anyone|plyr ,"banquierbourg_startpar", [],  "Je désire empreinter en effet.", "banquierbourg_somespar", []],
  [anyone|plyr ,"banquierbourg_startpar", [],  "Que se passerais t'il si je ne pouvais payer a temps ?", "banquierbourg_impayerpar", []],
  [anyone|plyr ,"banquierbourg_startpar", [],  "Je reviendrais.", "close_window", []],
  [anyone ,"banquierbourg_predialpar", [], "Avez vous une autre question ?", "banquierbourg_startpar",[]],
  
  [anyone ,"banquierbourg_impayerpar", [], "Grand Dieu, et bien si vous ne pavennez pas a remboursser, vous risquez les pires ennuis je le crain, vous deviendrez un hors la loi dans vostre pays, et beaucoup de gens vous rejeterons a cause de cela, sans compter que vous ne pouriez plus avoir de prets. croyez moi, il vaudra mieux que vous rembourssiez.", "banquierbourg_predialpar",[]],
  
  [anyone ,"banquierbourg_somespar", [], "De combien avez vous besoin ? j'ai un pret de 3000 écus, il vous faudra alors me remboursser 3300 écus d'interet, ou bien 6000 écus ou 6600 écus avec les interets, 9000 qui feron 9900 et enfin pour un pret de 14.000, il vous faudra remboursser 15.400  écus.", "banquierbourg_somes2par",[]],
  
  [anyone|plyr ,"banquierbourg_somes2par", [],  "J'ai besoin de 3000 écus.", "pret_3000par", [(troop_add_gold, "trp_player", 3000),]],
  [anyone|plyr ,"banquierbourg_somes2par", [],  "J'ai besoin de 6000 écus.", "pret_6000par", [(troop_add_gold, "trp_player", 6000),]],
  [anyone|plyr ,"banquierbourg_somes2par", [],  "J'ai besoin de 9000 écus.", "pret_9000par", [(troop_add_gold, "trp_player", 9000),]],
  [anyone|plyr ,"banquierbourg_somes2par", [],  "J'ai besoin de 14.000 écus.", "pret_14000par", [(troop_add_gold, "trp_player", 14000),]],
  [anyone|plyr ,"banquierbourg_somes2par", [],  "Laissez tomber, j'ai changer d'avis.", "close_window", []],
  
  [anyone ,"pret_3000par", [], "Bien, voici votre argent, n'oubliez pas, vous avez 100 jours pour me remboursser.", "close_window",
    [
      (setup_quest_text,"qst_banque30"),
      (str_store_string, s2, "@Je doit remboursser la Somme de 3300 écus avant le delai imparti, sans quois je risque de gros ennuis."),
      (call_script, "script_start_quest", "qst_banque30", "$g_talk_troop"),
      (quest_set_slot, "qst_banque30", slot_quest_expiration_days, 100),
      (assign, "$pret_banque", 1),
  ]],
  [anyone ,"pret_6000par", [], "Bien, voici votre argent, n'oubliez pas, vous avez 100 jours pour me remboursser.", "close_window",
    [
      (setup_quest_text,"qst_banque60"),
      (str_store_string, s2, "@Je doit remboursser la Somme de 6600 écus avant le delai imparti, sans quois je risque de gros ennuis."),
      (call_script, "script_start_quest", "qst_banque60", "$g_talk_troop"),
      (quest_set_slot, "qst_banque60", slot_quest_expiration_days, 100),
      (assign, "$pret_banque", 1),
  ]],
  [anyone ,"pret_9000par", [], "Bien, voici votre argent, n'oubliez pas, vous avez 100 jours pour me remboursser.", "close_window",
    [
      (setup_quest_text,"qst_banque90"),
      (str_store_string, s2, "@Je doit remboursser la Somme de 9900 écus avant le delai imparti, sans quois je risque de gros ennuis."),
      (call_script, "script_start_quest", "qst_banque90", "$g_talk_troop"),
      (quest_set_slot, "qst_banque90", slot_quest_expiration_days, 100),
      (assign, "$pret_banque", 1),
  ]],
  [anyone ,"pret_14000par", [], "Bien, voici votre argent, n'oubliez pas, vous avez 100 jours pour me remboursser.", "close_window",
    [
      (setup_quest_text,"qst_banque14"),
      (str_store_string, s2, "@Je doit remboursser la Somme de 15.400 écus avant le delai imparti, sans quois je risque de gros ennuis."),
      (call_script, "script_start_quest", "qst_banque14", "$g_talk_troop"),
      (quest_set_slot, "qst_banque14", slot_quest_expiration_days, 100),
      (assign, "$pret_banque", 1),
  ]],
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_paris_banquier"),
      (eq, "$quete_jhoan_ready_orleans", 0),
      #si pat de pret en cour
      (eq, "$pret_banque", 0),
    ],
    "Messire ? nous ne prestons point aux malandrins de vostre rang, partez sur le champ ou devenez quelqu'un de viable.", "banquierbourg_marsnoood", []],
  [anyone|plyr ,"banquierbourg_marsnoood", [],  "Je voie...", "close_window", []],
  
  
  
  
  
  #marseille
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_marseille_banquier"),
      (eq, "$quete_jhoan_ready_orleans", 1),
      #si pat de pret en cour
      (eq, "$pret_banque", 0),
    ],
    "Désirez vous un pret Messire ? les intérets sont très tentants vous savez.", "banquierbourg_startparmars", []],
  [anyone|plyr ,"banquierbourg_startparmars", [],  "Je désire empreinter en effet.", "banquierbourg_somesparmars", []],
  [anyone|plyr ,"banquierbourg_startparmars", [],  "Que se passerais t'il si je ne pouvais payer a temps ?", "banquierbourg_impayerparmars", []],
  [anyone|plyr ,"banquierbourg_startparmars", [],  "Je reviendrais.", "close_window", []],
  [anyone ,"banquierbourg_predialparmars", [], "Avez vous une autre question ?", "banquierbourg_startparmars",[]],
  
  [anyone ,"banquierbourg_impayerparmars", [], "Grand Dieu, et bien si vous ne pavennez pas a remboursser, vous risquez les pires ennuis je le crain, vous deviendrez un hors la loi dans vostre pays, et beaucoup de gens vous rejeterons a cause de cela, sans compter que vous ne pouriez plus avoir de prets. croyez moi, il vaudra mieux que vous rembourssiez.", "banquierbourg_predialparmars",[]],
  
  [anyone ,"banquierbourg_somesparmars", [], "De combien avez vous besoin ? j'ai un pret de 3000 écus, il vous faudra alors me remboursser 3300 écus d'interet, ou bien 6000 écus ou 6600 écus avec les interets, 9000 qui feron 9900 et enfin pour un pret de 14.000, il vous faudra remboursser 15.400  écus.", "banquierbourg_somes2parmars",[]],
  
  [anyone|plyr ,"banquierbourg_somes2parmars", [],  "J'ai besoin de 3000 écus.", "pret_3000parmars", [(troop_add_gold, "trp_player", 3000),]],
  [anyone|plyr ,"banquierbourg_somes2parmars", [],  "J'ai besoin de 6000 écus.", "pret_6000parmars", [(troop_add_gold, "trp_player", 6000),]],
  [anyone|plyr ,"banquierbourg_somes2parmars", [],  "J'ai besoin de 9000 écus.", "pret_9000parmars", [(troop_add_gold, "trp_player", 9000),]],
  [anyone|plyr ,"banquierbourg_somes2parmars", [],  "J'ai besoin de 14.000 écus.", "pret_14000parmars", [(troop_add_gold, "trp_player", 14000),]],
  [anyone|plyr ,"banquierbourg_somes2parmars", [],  "Laissez tomber, j'ai changer d'avis.", "close_window", []],
  
  [anyone ,"pret_3000parmars", [], "Bien, voici votre argent, n'oubliez pas, vous avez 100 jours pour me remboursser.", "close_window",
    [
      (setup_quest_text,"qst_banque30"),
      (str_store_string, s2, "@Je doit remboursser la Somme de 3300 écus avant le delai imparti, sans quois je risque de gros ennuis."),
      (call_script, "script_start_quest", "qst_banque30", "$g_talk_troop"),
      (quest_set_slot, "qst_banque30", slot_quest_expiration_days, 100),
      (assign, "$pret_banque", 1),
  ]],
  [anyone ,"pret_6000parmars", [], "Bien, voici votre argent, n'oubliez pas, vous avez 100 jours pour me remboursser.", "close_window",
    [
      (setup_quest_text,"qst_banque60"),
      (str_store_string, s2, "@Je doit remboursser la Somme de 6600 écus avant le delai imparti, sans quois je risque de gros ennuis."),
      (call_script, "script_start_quest", "qst_banque60", "$g_talk_troop"),
      (quest_set_slot, "qst_banque60", slot_quest_expiration_days, 100),
      (assign, "$pret_banque", 1),
  ]],
  [anyone ,"pret_9000parmars", [], "Bien, voici votre argent, n'oubliez pas, vous avez 100 jours pour me remboursser.", "close_window",
    [
      (setup_quest_text,"qst_banque90"),
      (str_store_string, s2, "@Je doit remboursser la Somme de 9900 écus avant le delai imparti, sans quois je risque de gros ennuis."),
      (call_script, "script_start_quest", "qst_banque90", "$g_talk_troop"),
      (quest_set_slot, "qst_banque90", slot_quest_expiration_days, 100),
      (assign, "$pret_banque", 1),
  ]],
  [anyone ,"pret_14000parmars", [], "Bien, voici votre argent, n'oubliez pas, vous avez 100 jours pour me remboursser.", "close_window",
    [
      (setup_quest_text,"qst_banque14"),
      (str_store_string, s2, "@Je doit remboursser la Somme de 15.400 écus avant le delai imparti, sans quois je risque de gros ennuis."),
      (call_script, "script_start_quest", "qst_banque14", "$g_talk_troop"),
      (quest_set_slot, "qst_banque14", slot_quest_expiration_days, 100),
      (assign, "$pret_banque", 1),
  ]],
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_marseille_banquier"),
      (eq, "$quete_jhoan_ready_orleans", 0),
      #si pat de pret en cour
      (eq, "$pret_banque", 0),
    ],
    "Messire ? nous ne prestons point aux malandrins de vostre rang, partez sur le champ ou devenez quelqu'un de viable.", "banquierbourg_marsnooo", []],
  [anyone|plyr ,"banquierbourg_marsnooo", [],  "Je voie...", "close_window", []],
  
  
  #dial gardes banques
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_mercenary_bourges"),
    ],
    "Messire ?", "banquguard_bourg", []],
  [anyone|plyr ,"banquguard_bourg", [],  "Bientot la reléve ?", "close_window", []],
  
  #
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_mercenary_paris"),
    ],
    "Tennez vous tranquile.", "banquguard_pari", []],
  [anyone|plyr ,"banquguard_pari", [],  "Vous devriez vous détendre garde.", "close_window", []],
  
  #
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_mercenary_marseille"),
    ],
    "Je vous es a l'oeil.", "banquguard_mars", []],
  [anyone|plyr ,"banquguard_mars", [],  "Je veux juste un pret, pas voller les coffres.", "close_window", []],
  #
  
  
  #dial convoi armes
  
  [anyone,"start",
    [
      (is_between, "$g_talk_troop", "trp_covoy_english_guard", "trp_covoy_english_guard_end"),
      (eq,"$talk_context",tc_party_encounter),
    ],
    "Arrière! ecarte toi du convoi pouilleux.", "ecartepouillconv",
    [(assign, "$enfinendconv",-1),]],
  
  [anyone|plyr, "ecartepouillconv",
    [
      (is_between, "$g_talk_troop", "trp_covoy_english_guard", "trp_covoy_english_guard_end"),
    ],
    "(Donner le signal de l'attaque a mes hommes dissimulés...)", "close_window",[[encounter_attack]]],
  
  [anyone|plyr, "ecartepouillconv",
    [
      (is_between, "$g_talk_troop", "trp_covoy_english_guard", "trp_covoy_english_guard_end"),
      ],"Veuillez me pardoner,je m'en vais...", "close_window",[(assign, "$g_leave_encounter", 1),]],
  
  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_covoy_english_guard", "trp_covoy_english_guard_end"),
      (eq,"$talk_context",tc_hero_defeated),
    ],
    "Epargnez moi,epargnez moi!", "conoyoyepargn",
    []],
  
  [anyone|plyr, "conoyoyepargn",
    [
      (is_between, "$g_talk_troop", "trp_covoy_english_guard", "trp_covoy_english_guard_end"),
    ],
    "Va t'en pouilleux.", "close_window",
    [
      (call_script, "script_succeed_quest", "qst_rebel_attack_c1"),
      (assign, "$g_leave_encounter",1),
      (assign, "$enfinendconv",1),
      
  ]],
  
  #dial quete vilandrandro bourges
  
  [anyone,"start",
    [
      (is_between, "$g_talk_troop", "trp_vilandrandro_quest_fanta", "trp_vilandrandro_quest_fanta_end"),
      (eq,"$talk_context",tc_party_encounter),
    ],
    "Comme c'est aimable a vous de venire nous saluer Messires,avez vous apporté des oeufs et du pain,vous pouriez peut etre vous joindre a nous pour le déjeuné.", "quet_viland_bourgesss",
    []],
  [anyone|plyr, "quet_viland_bourgesss",
    [
      (is_between, "$g_talk_troop", "trp_vilandrandro_quest_fanta", "trp_vilandrandro_quest_fanta_end"),
      ],"Arière malfesants,rendez vous ou mourez!", "quet_viland_bourgesss2",[(assign, "$victoire_viland_quetebourges", -1),]],
  
  [anyone, "quet_viland_bourgesss2",
    [
      (is_between, "$g_talk_troop", "trp_vilandrandro_quest_fanta", "trp_vilandrandro_quest_fanta_end"),
    ],
    "Vous n'etes pas assez nombreux pour nous vaincre,rejoignez plutot nos rangs,et vous vous ferez plus d'écus que vous ne pouriez en compter dans toute une vie.", "quet_viland_bourgesss3",
    []],
  
  [anyone|plyr, "quet_viland_bourgesss3",
    [
      (is_between, "$g_talk_troop", "trp_vilandrandro_quest_fanta", "trp_vilandrandro_quest_fanta_end"),
      ],"Meme si cela implique de violer et de trancher les gorges d'inocants?", "quet_viland_bourgesss34",[]],
  
  [anyone, "quet_viland_bourgesss34",
    [
      (is_between, "$g_talk_troop", "trp_vilandrandro_quest_fanta", "trp_vilandrandro_quest_fanta_end"),
    ],
    "Exactement,c'est notre survie qui en dépend,c'est leur vie ou la notre.", "quet_viland_bourgesss35",
    []],
  
  [anyone|plyr, "quet_viland_bourgesss35",
    [
      (is_between, "$g_talk_troop", "trp_vilandrandro_quest_fanta", "trp_vilandrandro_quest_fanta_end"),
      ],"En garde maraud!", "close_window",[[encounter_attack]]],
  
  
  #
  
  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_vilandrandro_quest_fanta", "trp_vilandrandro_quest_fanta_end"),
      (eq,"$talk_context",tc_hero_defeated),
    ],
    "Sales batards! je vous retrouverais!", "conoyoyepargn",
    []],
  
  [anyone|plyr, "conoyoyepargn",
    [
      (is_between, "$g_talk_troop", "trp_vilandrandro_quest_fanta", "trp_vilandrandro_quest_fanta_end"),
    ],
    "Je te présente ta nouvelle demeure...les cachots de Bourges.", "close_window",
    [
      (call_script, "script_succeed_quest", "qst_sl_viland_troop1"),
      (assign, "$g_leave_encounter",1),
      (assign, "$victoire_viland_quetebourges",1),
  ]],
  
  #
  
  
  
  #dial bandits de rennes tueur de caravaniers
  
  [anyone,"start",
    [
      (is_between, "$g_talk_troop", "trp_tueur_caravane_chef", "trp_tueur_caravane_end"),
      (eq,"$talk_context",tc_party_encounter),
    ],
    "Que fond ces corbeaux noirs sur ma route, dites leur de partir ou on dégagera le passage nous meme.", "corbeaux_noir",
    [
      #(assign, "$enfinendconv",-1),
  ]],
  
  [anyone|plyr, "corbeaux_noir",
    [
      (is_between, "$g_talk_troop", "trp_tueur_caravane_chef", "trp_tueur_caravane_end"),
    ],
    "Nous ne sommes point les proies mais les chasseurs mon bon seigneur.[attaquer]", "close_window",[[encounter_attack]]],
  
  [anyone|plyr, "corbeaux_noir",
    [
      (is_between, "$g_talk_troop", "trp_tueur_caravane_chef", "trp_tueur_caravane_end"),
      ],"Tout compte fait, vous pouvez passer...", "close_window",[(assign, "$g_leave_encounter", 1),]],
  
  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_tueur_caravane_chef", "trp_tueur_caravane_end"),
      (eq,"$talk_context",tc_hero_defeated),
    ],
    "Corbeaux de l'enfer ! soyez emportés par la peste.", "corbeaux_noirwin",
    []],
  
  [anyone|plyr, "corbeaux_noirwin",
    [
      (is_between, "$g_talk_troop", "trp_tueur_caravane_chef", "trp_tueur_caravane_end"),
    ],
    "[L'achever]...", "corbeaux_noirwinend",
    [
      
  ]],
  
  
  
  [anyone|plyr, "corbeaux_noirwinend",
    [
      (is_between, "$g_talk_troop", "trp_tueur_caravane_chef", "trp_tueur_caravane_end"),
    ],
    "Pourquois saigne tu autant sale porc.", "close_window",
    [
      #play sound achever
      (play_sound,"snd_man_die"),
      (call_script, "script_succeed_quest", "qst_vangeance_cravane"),
      (assign, "$g_leave_encounter",1),
      # (assign, "$enfinendconv",1),
      
  ]],
  
  #################################
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  [anyone|auto_proceed, "start",
    [
      (is_between, "$g_talk_troop", "trp_swadian_merchant", "trp_startup_merchants_end"),
      (eq, "$talk_context", tc_town_talk),
    ],
    "{!}.", "merchant_quest_4_start",
    [
  ]],
  
  [anyone, "merchant_quest_4_start",
    [
    ],
    "It's time, lads! Up and at them!", "close_window",
    [
      (try_for_agents, ":agent_no"),
        (agent_get_troop_id, ":agent_troop_id", ":agent_no"),
        (ge, ":agent_troop_id", "trp_looter"),
        (le, ":agent_troop_id", "trp_desert_bandit"),
        (agent_set_team, ":agent_no", 1),
      (try_end),
      
      (get_player_agent_no, ":player_agent"),
      
      (assign, ":minimum_distance", 1000),
      (try_for_agents, ":agent_id_1"),
        (neq, ":agent_id_1", ":player_agent"),
        (agent_get_team, ":agent_team_1", ":agent_id_1"),
        (eq, ":agent_team_1", 0),
        (agent_get_position, pos0, ":agent_id_1"),
        
        (try_for_agents, ":agent_id_2"),
          (agent_get_team, ":agent_team_2", ":agent_id_2"),
          (eq, ":agent_team_2", 1),
          (agent_get_position, pos1, ":agent_id_2"),
          
          (get_distance_between_positions, ":dist", pos0, pos1),
          
          (le, ":dist", ":minimum_distance"),
          (assign, ":minimum_distance", ":dist"),
          (copy_position, pos2, pos1),
        (try_end),
        
        (agent_set_scripted_destination, ":agent_id_1", pos2, 0),
        (agent_set_speed_limit, ":agent_id_1", 10),
      (try_end),
  ]],
  
  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_relative_of_merchant", "trp_relative_of_merchants_end"),
      
      (try_begin),
        (check_quest_active, "qst_save_relative_of_merchant"),
        (call_script, "script_succeed_quest", "qst_save_relative_of_merchant"),
      (try_end),
      
      (str_store_party_name, s9, "$g_starting_town"),
      
      (assign, "$relative_of_merchant_is_found", 1),
    ],
    "Thank you! Thank you, {sir/my lady}, for rescuing me from those fiends. Did my brother in {s9} put you onto their track?", "relative_saved_1a",
    [
  ]],
  
  [anyone|plyr, "relative_saved_1a",
    [],
    "Yes. I told him that I would find you. I advise you to return to your family as quickly as you can -- and be careful on the road.", "close_window",
    [
  ]],
  
  
  
  
  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_sea_raider_leader", "trp_bandit_leaders_end"),
      (eq,"$talk_context",tc_hero_defeated),
    ],
    "Ay! Spare me! Spare my life! Let me go, and I'll go far away from here, and learn an honest trade, and you'll never hear of me again!", "bandit_leader_1a",
    []],
  
  [anyone|plyr, "bandit_leader_1a",
    [
      (is_between, "$g_talk_troop", "trp_sea_raider_leader", "trp_bandit_leaders_end"),
    ],
    "I'll spare your life -- but in exchange, I want information. Either you or your mates kidnapped the brother of a prominent merchant in town. Tell me where you're hiding him, and give me your word that you'll stop troubling the people of these parts, and you can go free.", "bandit_leader_1b",
    []],
  
  
  
  
  
  [anyone,"start",
    [
      (eq,"$talk_context",tc_party_encounter),
      (is_between, "$g_talk_troop", "trp_sea_raider_leader", "trp_bandit_leaders_end"),
    ],
    "What do you want?", "looter_leader_1",
    []],
  
  [anyone|plyr,"looter_leader_1",
    [
      (store_faction_of_party, ":starting_town_faction", "$g_starting_town"),
      (try_begin),
        (eq, ":starting_town_faction", "fac_kingdom_1"),
        (assign, ":troop_of_merchant", "trp_swadian_merchant"),
      (else_try),
        (eq, ":starting_town_faction", "fac_kingdom_2"),
        (assign, ":troop_of_merchant", "trp_vaegir_merchant"),
        #HYW
        #	(else_try),
        #      (eq, ":starting_town_faction", "fac_kingdom_3"),
        #      (assign, ":troop_of_merchant", "trp_khergit_merchant"),
        #    (else_try),
        #      (eq, ":starting_town_faction", "fac_kingdom_4"),
        #      (assign, ":troop_of_merchant", "trp_nord_merchant"),
        #    (else_try),
        #      (eq, ":starting_town_faction", "fac_kingdom_5"),
        #      (assign, ":troop_of_merchant", "trp_rhodok_merchant"),
        #    (else_try),
        #      (eq, ":starting_town_faction", "fac_kingdom_6"),
        #      (assign, ":troop_of_merchant", "trp_sarranid_merchant"),
      (try_end),
      #HYW
      (str_store_troop_name, s9, ":troop_of_merchant"),
    ],
    "I've been looking for you. Tell me where you keep your prisoners, and I'll let you go.", "looter_leader_2",
    []],
  
  [anyone|plyr,"looter_leader_1",
    [],
    "Nothing. We'll leave you in peace.", "close_window",
    [
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone,"looter_leader_2",
    [],
    "Hah! Those prisoners are only going free if you pay their ransom. Did you bring any silver?", "looter_leader_3",
    []],
  
  [anyone|plyr,"looter_leader_3",
    [],
    "No, but I brought steel.", "close_window",
    []],
  
  
  
  [anyone, "bandit_leader_1b",
    [
      (is_between, "$g_talk_troop", "trp_sea_raider_leader", "trp_bandit_leaders_end"),
      
      (assign, ":possible_villages", 0),
      (try_for_range, ":village_no", villages_begin, villages_end),
        (party_slot_eq, ":village_no", slot_village_bound_center, "$g_starting_town"),
        (val_add, ":possible_villages", 1),
      (try_end),
      
      (store_random_in_range, ":random_village", 0, ":possible_villages"),
      (val_add, ":random_village", 1),
      
      (try_for_range, ":village_no", villages_begin, villages_end),
        (party_slot_eq, ":village_no", slot_village_bound_center, "$g_starting_town"),
        (val_sub, ":random_village", 1),
        (eq, ":random_village", 0),
        (assign, "$lair_neighboor_village", ":village_no"),
      (try_end),
      
      (str_store_party_name_link, s9, "$lair_neighboor_village"),
      
      (set_spawn_radius, 4),
      (spawn_around_party, "$lair_neighboor_village", "pt_looter_lair"),
      (party_set_flags, reg0, pf_always_visible, 1),
    ],
    "Oh bless you, {sir/my lady}. Bless you. We've done the lad no harm. We've been keeping him in our hideout near {s9}. I'll describe the area nearby in detail, so there's no mistaking it...", "close_window",
    [
      (call_script, "script_succeed_quest", "qst_learn_where_merchant_brother_is"),
      (call_script, "script_end_quest", "qst_learn_where_merchant_brother_is"),
      
      (store_faction_of_party, ":starting_town_faction", "$g_starting_town"),
      (try_begin),
        (eq, ":starting_town_faction", "fac_kingdom_1"),
        (assign, ":troop_of_merchant", "trp_swadian_merchant"),
      (else_try),
        (eq, ":starting_town_faction", "fac_kingdom_2"),
        (assign, ":troop_of_merchant", "trp_vaegir_merchant"),
        #HYW
        #	(else_try),
        #      (eq, ":starting_town_faction", "fac_kingdom_3"),
        #      (assign, ":troop_of_merchant", "trp_khergit_merchant"),
        #    (else_try),
        #      (eq, ":starting_town_faction", "fac_kingdom_4"),
        #      (assign, ":troop_of_merchant", "trp_nord_merchant"),
        #    (else_try),
        #      (eq, ":starting_town_faction", "fac_kingdom_5"),
        #      (assign, ":troop_of_merchant", "trp_rhodok_merchant"),
        #    (else_try),
        #      (eq, ":starting_town_faction", "fac_kingdom_6"),
        #      (assign, ":troop_of_merchant", "trp_sarranid_merchant"),
        #HYW
      (try_end),
      (str_store_troop_name, s10, ":troop_of_merchant"),
      
      (str_store_string, s2, "str_find_the_lair_near_s9_and_free_the_brother_of_the_prominent_s10_merchant"),
      (call_script, "script_start_quest", "qst_save_relative_of_merchant", ":troop_of_merchant"),
  ]],
  
  
  
  
  [anyone,"start", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
      (check_quest_active, "qst_rescue_prisoner"),
      (check_quest_succeeded, "qst_rescue_prisoner"),
      (quest_slot_eq, "qst_rescue_prisoner", slot_quest_giver_troop, "$g_talk_troop"),
      (quest_get_slot, ":cur_lord", "qst_rescue_prisoner", slot_quest_target_troop),
      (call_script, "script_troop_get_family_relation_to_troop", ":cur_lord", "$g_talk_troop"),
    ],
    "{playername}, you saved him! Thank you ever so much for rescuing my {s11}. " +
    "Please, take this as some small repayment for your noble deed.", "rescue_prisoner_succeed_2",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 8),
      (add_xp_as_reward, 2000),
      (call_script, "script_troop_add_gold", "trp_player", 1500),
      (call_script, "script_end_quest", "qst_rescue_prisoner"),
  ]],#rescuerescue
  [anyone|plyr,"rescue_prisoner_succeed_2", [], "Always an honour to serve, {s65}.", "lord_pretalk",[]],
  
  
  
  #Quest 0 - Alley talk
  [anyone|auto_proceed, "start",
    [
      (is_between, "$g_talk_troop", "trp_swadian_merchant", "trp_startup_merchants_end"),
      (eq, "$talk_context", tc_back_alley),
      (eq, "$talked_with_merchant", 0),
    ],
    "{!}.", "start_up_quest_1_next",
    []],
  
  [anyone, "start_up_quest_1_next",
    [],
    "Are you all right? Well.... I guess you're alive, at any rate. I'm not sure that we can say the same for the other fellow. That's one less thief to trouble our streets at night, although Heaven knows he won't be the last.... Anyway, maybe you can help me with something. Let's talk more inside. Out here, we don't know who's listening", "close_window",
    [
      (assign, "$talked_with_merchant", 1),
      (mission_disable_talk),
  ]],
  
  
  #Quest 1 - Repeating dialog sentence
  [anyone|auto_proceed, "start",
    [
      (is_between, "$g_talk_troop", "trp_swadian_merchant", "trp_startup_merchants_end"),
      (eq, "$talk_context", tc_tavern_talk),
      
      (call_script, "script_party_count_members_with_full_health", "p_main_party"),
      (assign, ":total_party_size", reg0),
      
      (assign, ":continue", 0),
      (try_begin),
        (check_quest_active, "qst_collect_men"),
        (neg|check_quest_succeeded, "qst_collect_men"),
        
        (le, ":total_party_size", 5),
        
        (try_begin),
          (le, ":total_party_size", 1),
          (str_store_string, s11, "str_please_sir_my_lady_go_find_some_volunteers_i_do_not_know_how_much_time_we_have"),
        (else_try),
          (str_store_string, s11, "str_you_need_more_men_sir_my_lady"),
        (try_end),
        (assign, ":continue", 1),
      (else_try),
        (check_quest_active, "qst_learn_where_merchant_brother_is"),
        (neg|check_quest_succeeded, "qst_learn_where_merchant_brother_is"),
        (str_store_string, s11, "str_do_not_waste_time_go_and_learn_where_my_brother_is"),
        (assign, ":continue", 1),
      (try_end),
      (eq, ":continue", 1),
    ],
    "{!}.", "start_up_quest_2_next",
    []],
  
  [anyone, "start_up_quest_2_next",
    [],
    "{!}{s11}", "close_window",
    []],
  
  #Quest 2 - First dialog sentence
  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_swadian_merchant", "trp_startup_merchants_end"),
      (eq, "$talk_context", tc_tavern_talk),
      
      (check_quest_active, "qst_collect_men"),
      (neg|check_quest_succeeded, "qst_duel_for_lady"),
      (call_script, "script_party_count_members_with_full_health", "p_main_party"),
      (ge, reg0, 6),
      
      (str_store_party_name, s9, "$current_town"),
    ],
    "Splendid work. You have hired enough men to take on the bandits. Now -- travellers entering {s9} have told us that there is a small group of robbers lurking on the outside of town. I suspect that they are all from the same band, the one that took my brother. Hunt them down and defeat them, and make them disclose the location of their lair!", "merchant_quest_2a",
    [
      (call_script, "script_succeed_quest", "qst_collect_men"),
      (call_script, "script_end_quest", "qst_collect_men"),
  ]],
  
  #Quest 3 - First dialog sentence/Repeating dialog sentence
  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_swadian_merchant", "trp_startup_merchants_end"),
      (eq, "$talk_context", tc_tavern_talk),
      
      (check_quest_active, "qst_save_relative_of_merchant"),
      (neg|check_quest_succeeded, "qst_save_relative_of_merchant"),
      
      (str_store_party_name, s9, "$current_town"),
    ],
    "So, you've found out where they hid my brother? Splendid work. I flatter myself that I'm a fine judge of character, and you look to be a {man/woman} who can get things done. Now, go out and save his unworthy hide!", "merchant_quest_3a",
    [
  ]],
  
  #Quest 3 - All succeeded - First dialog sentence
  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_swadian_merchant", "trp_startup_merchants_end"),
      (eq, "$talk_context", tc_tavern_talk),
      
      (check_quest_active, "qst_save_relative_of_merchant"),
      (check_quest_succeeded, "qst_save_relative_of_merchant"),
    ],
    "Well... My brother is home safe. I'm not sure what to do with him -- maybe pack him off to a university in Italy. That way, if he gets knocked on the head in a street brawl, no one can say it's my fault. But that's not your problem. Here's the rest of your reward. It was well-earned.", "merchant_quest_3b",
    [
      (call_script, "script_finish_quest", "qst_save_relative_of_merchant", 100),
      (troop_add_gold, "trp_player", 200),
  ]],
  
  [anyone|plyr, "merchant_quest_3b", #was startup
    [
    ],
    "The money is most welcome, and I am glad to have been of service", "merchant_quest_4a",
    [
  ]],
  
  [anyone, "merchant_quest_4a", #was startup
    [
    ],
    "Good! Now... Are you interested in making some more?", "merchant_quest_4b",
    [
  ]],
  
  [anyone|plyr, "merchant_quest_4b",
    [
    ],
    "Possibly. What do you need?", "merchant_quest_4b1",
    [
  ]],
  
  
  [anyone, "merchant_quest_4b1",
    [],
    "Remember how I told you that the bandits had an ally inside the walls? I think I know who it is -- the captain of the watch, no less. Some months ago this captain, seeing the amount of profit we merchants were making from trade across the frontiers, decided to borrow some money to sponsor a caravan. Unfortunately, like many who are new to commerce, he failed to realize that great profit only comes with great risk. So he sank all his money into the most expensive commodities, and of course his caravan was captured and looted, and he lost everything.", "merchant_quest_4b2",
    []],
  
  [anyone, "merchant_quest_4b2",
    [],
    "As a consequence, it seems, our captain turned to villainy to recoup his fortune. I supposed I'd do the same if, the Heavens forbid, I ever faced indebtedness and ruination. Now, any watch captain worth his salary will have a few thieves and robbers on his payroll, to inform on the rest, but our captain decides to employ these bastards wholesale. He brings them into the town, lets them do as they will, and takes a share of their take. You've heard of poachers turning gamekeepers? Well, in the unfortunate land of France, sometimes gamekeepers will turn poacher. Luckily, there's are still a few brave, honest souls in the watch who've told me how he works.", "merchant_quest_4b3",
    []],
  
  [anyone, "merchant_quest_4b3",
    [
      (faction_get_slot, ":local_ruler", "$g_encountered_party_faction", slot_faction_leader),
      (str_store_troop_name, s4, ":local_ruler"),
    ],
    "Now -- here's my plan. I could bring this to the attention of {s4}, lord of the city, but that would mean an inquiry, my word against the captain's, and witnesses can be bought and evidence destroyed, or maybe the whole thing will be forgotten if the enemy comes across the border again, and all I'll get for my trouble is a knife in the ribs. In time of war, you see, a king's eye wanders far from his domain, and his subjects suffer. So I've got another idea. I've got a small group of townsfolk together, some men in my employ and some others who've lost relatives to these bandits, and we'll storm the captain's home and bring him in chains before {s4}, hopefully with a few captured bandits to explain how things stack up.", "merchant_quest_4b4",
    []],
  
  [anyone, "merchant_quest_4b4",
    [
    ],
    "All I need now is someone to lead my little army into battle -- and I can't think of anyone better than you. So, what do you say?", "merchant_quest_4b5",
    [
  ]],
  
  [anyone|plyr, "merchant_quest_4b5",
    [
    ],
    "How do I know that you're telling me the truth?", "merchant_quest_4b6",
    [
  ]],
  
  [anyone, "merchant_quest_4b6",
    [
      (str_store_party_name, s4, "$g_encountered_party"),
    ],
    "Oh, well, I suppose it's possible that I found a dozen bandits who were willing to give their lives to give a passing stranger a false impression of life in old {s4}... Well, I guess you can't really know if my word is good, but I reckon you've learned by now that my money is good, and there's another 100 denars, or maybe a bit more, that's waiting for you if you'll do me this last little favor. So what do you say?", "merchant_quest_4b7",
    [
  ]],
  
  
  [anyone|plyr, "merchant_quest_4b7",
    [
    ],
    "All right. I'll lead your men.", "merchant_quest_4b8",
    [
  ]],
  
  [anyone|plyr, "merchant_quest_4b7",
    [
    ],
    "I'm sorry. This is too much, too fast. I need time to think.", "merchant_quest_4_decline",
    [
  ]],
  
  [anyone, "merchant_quest_4b8",
    [
    ],
    "Splendid. It's been a long time since I staked so much on a single throw of the dice, and frankly I find it exhilarating. My men are ready to move on your word. Are you ready?", "merchant_quest_4b9",
    [
  ]],
  
  [anyone|plyr, "merchant_quest_4b9",
    [
    ],
    "Yes. Give them the sign.", "merchant_quest_4_accept",
    [
  ]],
  
  [anyone|plyr, "merchant_quest_4b9",
    [
    ],
    "Not now. I will need to rest before I can fight again.", "merchant_quest_4_decline",
    [
  ]],
  
  [anyone, "merchant_quest_4_accept",
    [
    ],
    "Good! Now -- strike hard, strike fast, and the captain and his henchmen won't know what hit them. May the heavens be with you!", "close_window",
    [
      (assign, "$current_startup_quest_phase", 3),
      (jump_to_menu, "mnu_start_phase_3"),
      (finish_mission),
  ]],
  
  [anyone, "merchant_quest_4_decline", #was startup
    [
    ],
    "Right. I can keep my men standing by. If you let this go too long, then I suppose that I shall have to finish this affair without you, but I would be most pleased if you could be part of it as well. For now, take what time you need.", "close_window",
    []],
  
  
  
  #QUEST 2 - Learning where prominent's brother is.
  [anyone|plyr, "merchant_quest_2a",
    [
    ],
    "Very well. I shall hunt for bandits.", "close_window",
    [
      (str_store_party_name, s9, "$current_town"),
      (str_store_string, s2, "str_start_up_quest_message_2"),
      (call_script, "script_start_quest", "qst_learn_where_merchant_brother_is", "$g_talk_troop"),
      
      (set_spawn_radius, 2),
      (spawn_around_party, "$current_town", "pt_leaded_looters"),
      (assign, ":spawned_bandits", reg0),
      
      (party_get_position, pos0, "$current_town"),
      (party_set_ai_behavior, ":spawned_bandits", ai_bhvr_patrol_location),
      (party_set_ai_patrol_radius, ":spawned_bandits", 3),
      (party_set_ai_target_position, ":spawned_bandits", pos0),
  ]],
  
  [anyone|plyr, "merchant_quest_2a",
    [
    ],
    "Why don't you come with us?", "merchant_quest_2a_whynotcome",
    [
  ]],
  
  [anyone, "merchant_quest_2a_whynotcome",
    [
    ],
    "Because I'm paying you to go take care of it. That's the short answer. The long answer is that I've got some leads to follow up here in town, and I have just as much chance of getting knocked on my head as you, if that's what you're asking. But I respect your question. Now, what do you say?", "merchant_quest_2a",
    [
  ]],
  
  
  [anyone|plyr, "merchant_quest_2a",
    [
    ],
    "I cannot deal with this matter at this time.", "close_window",
    [
  ]],
  
  #Quest 3 - Saving merchant's brother.
  [anyone|plyr, "merchant_quest_3a",
    [
    ],
    "Very well. I go now to attack the bandits in their lair, and find your brother.", "close_window",
    [
      #no need to below three lines anymore, this quest is auto starting after player learn where bandits are hiding merchant's brother.
      #(str_store_party_name, s9, "$lair_neighboor_village"),
      #(str_store_string, s2, "str_start_up_quest_message_3"),
      #(call_script, "script_start_quest", "qst_save_relative_of_merchant", "$g_talk_troop"),
  ]],
  
  
  
  
  
  [anyone|plyr, "merchant_quest_3a",
    [
    ],
    "I cannot deal with this matter at this time.", "close_window",
    [
      #think about placing end_quest here. Because it is auto-starting. If player do not want this quest he/she should have a way to avoid it.
  ]],
  
  
  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_swadian_merchant", "trp_startup_merchants_end"),
      
      (this_or_next|eq, "$talk_context", tc_tavern_talk),
      (neq, "$dialog_with_merchant_ended", 0),
      
      (assign, ":continue", 0),
      (try_begin),
        (neg|check_quest_succeeded, "qst_collect_men"),
        (neg|check_quest_active, "qst_collect_men"),
        (assign, ":continue", 1),
      (else_try),
        (neg|check_quest_active, "qst_collect_men"),
        (neg|check_quest_succeeded, "qst_learn_where_merchant_brother_is"),
        (neg|check_quest_active, "qst_learn_where_merchant_brother_is"),
        (assign, ":continue", 1),
      (else_try),
        (neg|check_quest_active, "qst_collect_men"),
        (neg|check_quest_active, "qst_learn_where_merchant_brother_is"),
        (neg|check_quest_succeeded, "qst_save_relative_of_merchant"),
        (neg|check_quest_active, "qst_save_relative_of_merchant"),
        (assign, ":continue", 1),
      (try_end),
      
      (eq, ":continue", 1),
    ],
    "You may do as you wish, {sir/my lady}, but I am disappointed. You would do well to reconsider. I am a rich men, and would show you my gratitude in coin.", "merchant_quest_persuasion",
    [
  ]],
  
  [anyone|auto_proceed, "start",
    [
      (is_between, "$g_talk_troop", "trp_swadian_merchant", "trp_startup_merchants_end"),
      
      (this_or_next|eq, "$talk_context", tc_tavern_talk),
      (neq, "$dialog_with_merchant_ended", 0),
      
      (check_quest_finished, "qst_save_relative_of_merchant"),
      (neg|check_quest_succeeded, "qst_save_town_from_bandits"),
      (neg|check_quest_active, "qst_save_town_from_bandits"),
    ],
    "{!}.", "merchant_quest_4b4",
    [
  ]],
  
  [anyone|plyr, "merchant_quest_persuasion",
    [
      (neg|check_quest_finished, "qst_collect_men"),
      (neg|check_quest_active, "qst_collect_men"),
    ],
    "You make a persuasive case. I will help you.", "merchant_quest_1_prologue_3",
    [
  ]],
  
  [anyone|plyr, "merchant_quest_persuasion",
    [
      (check_quest_finished, "qst_collect_men"),
      (neg|check_quest_finished, "qst_learn_where_merchant_brother_is"),
      (neg|check_quest_active, "qst_learn_where_merchant_brother_is"),
    ],
    "You make a persuasive case. I will help you.", "merchant_quest_2",
    [
  ]],
  
  [anyone|plyr, "merchant_quest_persuasion",
    [
      (check_quest_finished, "qst_collect_men"),
      (check_quest_finished, "qst_learn_where_merchant_brother_is"),
      (neg|check_quest_finished, "qst_save_relative_of_merchant"),
      (neg|check_quest_active, "qst_save_relative_of_merchant"),
    ],
    "You make a persuasive case. I will help you.", "merchant_quest_3",
    [
  ]],
  
  [anyone|plyr, "merchant_quest_persuasion",
    [
      (check_quest_finished, "qst_collect_men"),
      (check_quest_finished, "qst_learn_where_merchant_brother_is"),
      (check_quest_finished, "qst_save_relative_of_merchant"),
      (neg|check_quest_finished, "qst_save_town_from_bandits"),
      (neg|check_quest_active, "qst_save_town_from_bandits"),
    ],
    "You make a persuasive case. I will help you.", "merchant_quest_4b8",
    [
  ]],
  
  [anyone|plyr, "merchant_quest_persuasion",
    [
    ],
    "As I say, I have more important business elsewhere.", "close_window",
    [
  ]],
  
  [anyone, "merchant_quest_2",
    [
    ],
    "Now -- go find and defeat that group of bandits.", "merchant_quest_2a",
    [
  ]],
  
  [anyone, "merchant_quest_3",
    [
    ],
    "Now -- go attack that bandit hideout, get my brother back, and show those brigands what happens to those who threaten my household.", "merchant_quest_3a",
    [
  ]],
  
  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_relative_of_merchant", "trp_relative_of_merchant"),
    ],
    "Oh -- thank the heavens... Thank the heavens... Am I safe?", "close_screen",
    []],
  
  
  [anyone,"start",
    [
      (is_between, "$g_talk_troop", "trp_swadian_merchant", "trp_startup_merchants_end"),
      (eq, "$g_do_one_more_meeting_with_merchant", 1),
      (faction_get_slot, ":faction_leader", "$g_encountered_party_faction", slot_faction_leader),
      (str_store_troop_name, s5, ":faction_leader"),
    ],
    "Ah... {playername}. Things didn't go quite so well as I had hoped. {s5} couldn't quite find it in him to overlook my little breach of the peace. Oh, he's grateful enough that I got rid of his crooked captain -- a guard who'll let in bandits will let in an enemy army, if the price is right -- but he can't exactly have me running around here as a lasting reminder of his failure to take care of things himself.", "merchant_closing_statement_2",
    []],
  
  [anyone|plyr,"merchant_closing_statement_2",
    [],
    "That hardly seems fair...", "merchant_closing_statement_3",
    []],
  
  [anyone,"merchant_closing_statement_3",
    [],
    "Fair? This is France, {my boy/my lady}! Kings do what they will, and the rest of us do as they must. He didn't string me up, and instead gave me time to sell my properties -- even put in a word with the other merchants that they best pay me a fair price, too. That's gracious enough, as kings go -- but he's a weak king, as they all are here, and weak kings must always look to their authority first, and justice second. I suppose I'd do the same, in his shoes.", "merchant_closing_statement_4",
    []],
  
  [anyone,"merchant_closing_statement_4",
    [],
    "Anyway, I wouldn't go rubbing your part in this affair in {s5}'s face -- but he's taken note of you, and decided that you're not worth hanging, and that's something to which I'll raise a glass any day of the week. He might even have work for you, further down the road. Or, you can sell your sword to one of his competitors. Anyway, I hope you've learned a bit about what it will take to stay alive in this troubled land, and I suspect that the money you've earned won't go to waste. Good luck.", "close_window",
    [
      (assign, "$g_do_one_more_meeting_with_merchant", 2),
  ]],
  
  [anyone|auto_proceed, "start",
    [
      (is_between, "$g_talk_troop", "trp_swadian_merchant", "trp_startup_merchants_end"),
      (check_quest_finished, "qst_save_town_from_bandits"),
      (eq, "$g_do_one_more_meeting_with_merchant", 2),
    ],
    "{!}.", "merchant_quests_last_word",
    []],
  
  [anyone,"merchant_quests_last_word",
    [
    ],
    "I am preparing to leave town in a short while. It's been an honor to know you. Good luck.", "close_window",
    [
  ]],
  
  
  
  
  
  
  
  [anyone|plyr, "member_intel_liaison", [],
    "What have you discovered?", "member_intel_liaison_results", []],
  
  
  [anyone, "start", [(is_between, "$g_talk_troop", companions_begin, companions_end),
      (eq, "$talk_context", tc_tavern_talk),
      (troop_slot_eq, "$g_talk_troop", slot_troop_current_mission, npc_mission_gather_intel)],
    "Greetings, stranger.", "member_intel_liaison", []],
  
  [anyone|plyr, "member_intel_liaison", [
    ],
    "What have you discovered?", "member_intel_liaison_results", []],
  
  [anyone|plyr, "member_intel_liaison", [],
    "It's time to pull you out. Let's leave town separately, but join me soon after", "close_window", [
      (assign, "$npc_to_rejoin_party", "$g_talk_troop"),
  ]],
  
  [anyone|plyr, "member_intel_liaison", [],
    "You're doing good work. Stay here for a little longer", "close_window", []],
  
  
  
  [anyone, "member_intel_liaison_results", [
      (store_faction_of_party, ":town_faction", "$g_encountered_party"),
      (call_script, "script_update_faction_political_notes", ":town_faction"),
      (assign, ":instability_index", reg0),
      (val_add, ":instability_index", reg0),
      (val_add, ":instability_index", reg1),
      
      (try_for_range, ":lord", active_npcs_begin, active_npcs_end),
        (troop_slot_eq, ":lord", slot_troop_occupation, slto_kingdom_hero),
        (store_faction_of_troop, ":lord_faction", ":lord"),
        (eq, ":lord_faction", ":town_faction"),
        (call_script, "script_update_troop_political_notes", ":lord"),
      (try_end),
      
      (str_store_faction_name, s12, ":town_faction"),
      (try_begin),
        (gt, ":instability_index", 60),
        (str_store_string, s11, "str_the_s12_is_a_labyrinth_of_rivalries_and_grudges_lords_ignore_their_lieges_summons_and_many_are_ripe_to_defect"),
      (else_try),
        (is_between, ":instability_index", 40, 60),
        (str_store_string, s11, "str_the_s12_is_shaky_many_lords_do_not_cooperate_with_each_other_and_some_might_be_tempted_to_defect_to_a_liege_that_they_consider_more_worthy"),
      (else_try),
        (is_between, ":instability_index", 20, 40),
        (str_store_string, s11, "str_the_s12_is_fairly_solid_some_lords_bear_enmities_for_each_other_but_they_tend_to_stand_together_against_outside_enemies"),
      (else_try),
        (lt, ":instability_index", 20),
        (str_store_string, s11, "str_the_s12_is_a_rock_of_stability_politically_speaking_whatever_the_lords_may_think_of_each_other_they_fight_as_one_against_the_common_foe"),
      (try_end),
      
    ],
    "{s11} I notice that you have been keeping some notes about individual lords. I have annotated those with my findings.", "member_intel_liaison", []],
  
  
  
  [anyone,"member_fief_grant_1", [
      ], "Which fief did you have in mind?", "member_fief_grant_2",[]],
  
  [anyone|plyr|repeat_for_parties,"member_fief_grant_2", [
      (store_repeat_object, ":center"),
      (is_between, ":center", centers_begin, centers_end),
      (neq, ":center", "$g_player_court"),
      (store_faction_of_party, ":center_faction", ":center"),
      (eq, ":center_faction", "fac_player_supporters_faction"),
      (neg|party_slot_ge, ":center", slot_town_lord, active_npcs_begin), #ie, owned by player or unassigned
      (str_store_party_name, s11, ":center"),
      
      ], "{s11}", "member_fief_grant_3",[
      (store_repeat_object, "$temp"),
  ]],
  
  [anyone|plyr, "member_fief_grant_2", [
      ], "Never mind -- there is no fief I can offer.", "do_member_trade",[
  ]],
  
  
  [anyone,"member_fief_grant_3", [
      ], "{s5}", "close_window",[
      (call_script, "script_npc_morale", "$g_talk_troop"),
      (assign, ":npc_morale", reg0),
      
      (remove_member_from_party, "$g_talk_troop", "p_main_party"),
      
      
      (try_begin),
        (neg|troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
        
        (assign, ":banner_offset", banners_end_offset),
        (val_sub, ":banner_offset", 1),
        (val_sub, ":banner_offset", "$g_companions_banner_id"),
        (store_add, ":banner_id", banner_scene_props_begin, ":banner_offset"),
        (troop_set_slot, "$g_talk_troop", slot_troop_banner_scene_prop, ":banner_id"),
        (val_add, "$g_companions_banner_id", 1),
        
        (troop_set_slot, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
      (try_end),
      
      (troop_set_faction, "$g_talk_troop", "fac_player_supporters_faction"),
      (call_script, "script_give_center_to_lord", "$temp", "$g_talk_troop", 0),
      (try_begin),
        (faction_slot_eq, "$players_kingdom", slot_faction_political_issue, "$temp"),
        (faction_set_slot, "$players_kingdom", slot_faction_political_issue, -1),
      (try_end),
      
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", slot_troop_original_faction, 0),
        (party_get_slot, ":fief_culture", "$temp", slot_center_original_faction),
        (troop_set_slot, "$g_talk_troop", slot_troop_original_faction, ":fief_culture"),
      (try_end),
      
      (store_character_level, ":renown", "$g_talk_troop"),
      (val_mul, ":renown", 15),
      (val_max, ":renown", 200),
      (troop_set_slot, "$g_talk_troop", slot_troop_renown, ":renown"),
      
      (troop_set_slot, "$g_talk_troop", slot_troop_wealth, 2500), #represents accumulated loot
      #		(troop_set_slot, "$g_talk_troop", slot_troop_readiness_to_join_army, 100),
      #		(troop_set_slot, "$g_talk_troop", slot_troop_readiness_to_follow_orders, 100),
      
      (str_store_troop_name_plural, s12, "$g_talk_troop"),
      (troop_get_type, ":is_female", "$g_talk_troop"),
      (try_begin),
        (eq, "$g_talk_troop", "trp_npc10"),
        (str_store_string, s14, "str_tribune_s12"),
      (else_try),
        (eq, ":is_female", 1),
        (str_store_string, s14, "str_lady_s12"),
      (else_try),
        (str_store_string, s14, "str_lord_s12"),
      (try_end),
      (troop_set_name, "$g_talk_troop", s14),
      (unlock_achievement, ACHIEVEMENT_I_DUB_THEE),
      
      (call_script, "script_check_concilio_calradi_achievement"),
      
      (try_begin),
        (troop_add_item, "$g_talk_troop", "itm_saddle_horse", 0),
        (troop_add_item, "$g_talk_troop", "itm_courser", 0),
        (troop_add_item, "$g_talk_troop", "itm_courtly_outfit",0),
        (troop_add_item, "$g_talk_troop", "itm_heraldic_mail_with_tabard",0),
        (troop_add_item, "$g_talk_troop", "itm_red_gambeson",0),
        (troop_add_item, "$g_talk_troop", "itm_sword_medieval_c",0),
        (troop_add_item, "$g_talk_troop", "itm_tab_shield_kite_cav_b",0),
        (troop_add_item, "$g_talk_troop", "itm_light_lance",0),
      (try_end),
      (troop_equip_items, "$g_talk_troop"),
      
      (store_div, ":relation_boost", ":npc_morale", 3),
      #		(val_add, ":relation_boost", 10),
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", ":relation_boost"),
      
      (str_store_party_name, s17, "$temp"),
      (store_sub, ":npc_no", "$g_talk_troop", "trp_npc1"),
      (store_add, ":speech", "str_npc1_fief_acceptance", ":npc_no"),
      #        (troop_get_slot, ":speech", "$g_talk_troop", slot_troop_fief_acceptance_string),
      (str_store_string, s5, ":speech"),
  ]],
  
  
  
  [anyone, "start", [(is_between, "$g_talk_troop", companions_begin, companions_end),
      (this_or_next|eq, "$talk_context", tc_tavern_talk),
      (eq, "$talk_context", tc_court_talk),
      (main_party_has_troop, "$g_talk_troop")],
    "Let's leave whenever you are ready.", "close_window", []],
  
  [anyone, "start", [(is_between, "$g_talk_troop", companions_begin, companions_end),
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, 0),
      (troop_slot_eq, "$g_talk_troop", slot_troop_turned_down_twice, 1),
    ],
    "Please do not waste any more of my time today, {sir/madame}. Perhaps we shall meet again in our travels.", "close_window", [
  ]],
  
  
  [anyone, "start", [(is_between, "$g_talk_troop", companions_begin, companions_end),
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, 0),
      (eq, "$g_talk_troop_met", 0),
      (troop_get_slot, ":intro", "$g_talk_troop", slot_troop_intro),
      (str_store_string, 5, ":intro"),
      (str_store_party_name, 20, "$g_encountered_party"),
    ],
    "{s5}", "companion_recruit_intro_response", [
      (troop_set_slot, "$g_talk_troop", slot_troop_first_encountered, "$g_encountered_party"),
  ]],
  
  
  [anyone|plyr, "companion_recruit_intro_response", [
      (troop_get_slot, ":intro_response", "$g_talk_troop", slot_troop_intro_response_1),
      (str_store_string, 6, ":intro_response")
      ], "{s6}", "companion_recruit_backstory_a", []],
  
  [anyone|plyr, "companion_recruit_intro_response", [
      (troop_get_slot, ":intro_response", "$g_talk_troop", slot_troop_intro_response_2),
      (str_store_string, 7, ":intro_response")
      ],  "{s7}", "close_window", [
  ]],
  
  [anyone, "companion_recruit_backstory_a", [(troop_get_slot, ":backstory_a", "$g_talk_troop", slot_troop_backstory_a),
      (str_store_string, 5, ":backstory_a"),
      (str_store_string, 19, "str_here_plus_space"),
      (str_store_party_name, 20, "$g_encountered_party"),
    ],
    "{s5}", "companion_recruit_backstory_b", []],
  
  [anyone, "companion_recruit_backstory_b", [(troop_get_slot, ":backstory_b", "$g_talk_troop", slot_troop_backstory_b),
      (str_store_string, 5, ":backstory_b"),
      (str_store_party_name, 20, "$g_encountered_party"),
    ],
    "{s5}", "companion_recruit_backstory_c", []],
  
  [anyone, "companion_recruit_backstory_c", [(troop_get_slot, ":backstory_c", "$g_talk_troop", slot_troop_backstory_c),
      (str_store_string, 5, ":backstory_c"),
    ],
    "{s5}", "companion_recruit_backstory_response", []],
  
  [anyone|plyr, "companion_recruit_backstory_response", [
      (troop_get_slot, ":backstory_response", "$g_talk_troop", slot_troop_backstory_response_1),
      (str_store_string, 6, ":backstory_response")
      ], "{s6}", "companion_recruit_signup", []],
  
  [anyone|plyr, "companion_recruit_backstory_response", [
      (troop_get_slot, ":backstory_response", "$g_talk_troop", slot_troop_backstory_response_2),
      (str_store_string, 7, ":backstory_response")
      ],  "{s7}", "close_window", [
  ]],
  
  [anyone, "companion_recruit_signup", [(troop_get_slot, ":signup", "$g_talk_troop", slot_troop_signup),
      (str_store_string, 5, ":signup"),
      (str_store_party_name, 20, "$g_encountered_party"),
      
    ],
    "{s5}", "companion_recruit_signup_b", []],
  
  [anyone, "companion_recruit_signup_b", [
      (troop_get_slot, ":signup", "$g_talk_troop", slot_troop_signup_2),
      (troop_get_slot, reg3, "$g_talk_troop", slot_troop_payment_request),#
      
      (str_store_string, 5, ":signup"),
      (str_store_party_name, 20, "$g_encountered_party"),
      
    ],
    "{s5}", "companion_recruit_signup_response", []],
  
  [anyone|plyr, "companion_recruit_signup_response", [(neg|hero_can_join, "p_main_party"),], "Unfortunately, I can't take on any more hands in my party right now.", "close_window", [
  ]],
  
  [anyone|plyr, "companion_recruit_signup_response", [
      (hero_can_join, "p_main_party"),
      (troop_get_slot, ":signup_response", "$g_talk_troop", slot_troop_signup_response_1),
      (str_store_string, 6, ":signup_response")
      ], "{s6}", "companion_recruit_payment", []],
  
  [anyone|plyr, "companion_recruit_signup_response", [
      (hero_can_join, "p_main_party"),
      (troop_get_slot, ":signup_response", "$g_talk_troop", slot_troop_signup_response_2),
      (str_store_string, 7, ":signup_response")
      ],  "{s7}", "close_window", [
  ]],
  
  [anyone|auto_proceed, "companion_recruit_payment", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_payment_request, 0),
    ],
    ".", "companion_recruit_signup_confirm", []],
  
  [anyone, "companion_recruit_payment", [
      (store_sub, ":npc_offset", "$g_talk_troop", "trp_npc1"),
      (store_add, ":dialog_line", "str_npc1_payment", ":npc_offset"),
      (str_store_string, s5, ":dialog_line"),
      (troop_get_slot, reg3, "$g_talk_troop", slot_troop_payment_request),
      (str_store_party_name, s20, "$g_encountered_party"),
    ],
    "{s5}", "companion_recruit_payment_response", []],
  
  [anyone|plyr, "companion_recruit_payment_response", [
      (hero_can_join, "p_main_party"),
      (troop_get_slot, ":amount_requested", "$g_talk_troop", slot_troop_payment_request),#
      (store_troop_gold, ":gold", "trp_player"),#
      (ge, ":gold", ":amount_requested"),#
      (assign, reg3, ":amount_requested"),
      (store_sub, ":npc_offset", "$g_talk_troop", "trp_npc1"),
      (store_add, ":dialog_line", "str_npc1_payment_response", ":npc_offset"),
      (str_store_string, s6, ":dialog_line"),
      ], "{s6}", "companion_recruit_signup_confirm", [
      (troop_get_slot, ":amount_requested", "$g_talk_troop", slot_troop_payment_request),#
      (gt, ":amount_requested", 0),#
      (troop_remove_gold, "trp_player", ":amount_requested"),  #
      (troop_set_slot, "$g_talk_troop", slot_troop_payment_request, 0),#
  ]],
  
  [anyone|plyr, "companion_recruit_payment_response", [
      (troop_get_slot, ":signup_response", "$g_talk_troop", slot_troop_signup_response_2),
      (str_store_string, s7, ":signup_response")
      ],  "Sorry. I can't afford that at the moment.", "close_window", [
  ]],
  
  [anyone, "start", [(is_between, "$g_talk_troop", companions_begin, companions_end),
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, 0),
      (troop_slot_eq, "$g_talk_troop", slot_troop_met_previously, 1),
      (troop_slot_eq, "$g_talk_troop", slot_troop_playerparty_history, 0),
      
    ],
    "We meet again.", "companion_recruit_meet_again", [
      (troop_set_slot, "$g_talk_troop", slot_troop_turned_down_twice, 1),
  ]],
  
  [anyone|plyr, "companion_recruit_meet_again", [
      ], "So... What have you been doing since our last encounter?", "companion_recruit_backstory_delayed", []],
  
  [anyone|plyr, "companion_recruit_meet_again", [
      ],  "Good day to you.", "close_window", [
  ]],
  
  
  [anyone, "start", [(is_between, "$g_talk_troop", companions_begin, companions_end),
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, 0),
      (troop_slot_eq, "$g_talk_troop", slot_troop_met_previously, 0),
      (troop_slot_eq, "$g_talk_troop", slot_troop_playerparty_history, 0),
    ],
    "Yes?", "companion_recruit_secondchance", [
      (troop_set_slot, "$g_talk_troop", slot_troop_turned_down_twice, 1),
  ]],
  
  
  [anyone|plyr, "companion_recruit_secondchance", [
      ], "My apologies if I was rude, earlier. What was your story again?", "companion_recruit_backstory_b", []],
  
  [anyone|plyr, "companion_recruit_secondchance", [
      ],  "Never mind.", "close_window", [
  ]],
  
  [anyone, "companion_recruit_backstory_delayed",
    [(troop_get_slot, ":backstory_delayed", "$g_talk_troop", slot_troop_backstory_delayed),
      (str_store_string, 5, ":backstory_delayed")
    ],
    "{s5}", "companion_recruit_backstory_delayed_response", []],
  
  [anyone|plyr, "companion_recruit_backstory_delayed_response", [
      ], "I might be able to use you in my company.", "companion_recruit_signup_b", [
  ]],
  
  [anyone|plyr, "companion_recruit_backstory_delayed_response", [
      ],  "I'll let you know if I hear of anything.", "close_window", [
  ]],
  
  [anyone, "companion_recruit_signup_confirm", [], "Good! Give me a few moments to prepare and I'll be ready to move.", "close_window",
    [(call_script, "script_recruit_troop_as_companion", "$g_talk_troop")]],
  
  ################### steel edition compagnions dialogues camp begin      #############################
  
  #npc1 Perceval de Blois
  [anyone,"start", [(eq, "$g_talk_troop", "trp_npc1"),
      (eq, "$entre_camp", 1),
    ],
    "J'éspére ne pas moisir ici pendant des journées entières, sur ce comment allez vous capitaine ?", "dial_camp_npc1", []],
  
  [anyone|plyr ,"dial_camp_npc1", [],  "Puis que nous avons le temps, voyons votre équipement plus en détail.", "dial_camp_npc1_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"dial_camp_npc1", [],  "Nous devrions parler de vos spécialités, que savez vous faire ?", "dial_camp_npc1_skill", []],###
  [anyone|plyr ,"dial_camp_npc1", [],  "Rappellez moi votre histoire.", "dial_camp_npc1_story", []],###
  [anyone|plyr ,"dial_camp_npc1", [],  "Ca sera tout, a plus tard.", "close_window", []],###
  
  [anyone ,"dial_camp_npc1_skill", [],"Cela dépend, j'ai des préférences, mais vous plairons t'elles.", "dial_camp_npc1_retour", [(change_screen_view_character)]],###
  [anyone ,"dial_camp_npc1_story", [],"Bien que je soit noble ou de petite noblesse, j'ai grandis dans l'exploitation agricole de mes parents a Blois, mais très tôt j'ai préféré l'épée a la fourche.", "dial_camp_npc1_retour", []],###
  
  
  
  [anyone ,"dial_camp_npc1_retour", [],"Autre chose ?", "dial_camp_npc1", []],###
  
  
  #npc2 Roland de Paris
  [anyone,"start", [(eq, "$g_talk_troop", "trp_npc2"),
      (eq, "$entre_camp", 1),
    ],
    "C'est un endroit calme ici, cela ferai du bien de retirer un peut ces armures qui empestent la rouille.", "dial_camp_npc2", []],
  
  [anyone|plyr ,"dial_camp_npc2", [],  "Puis que nous avons le temps, voyons votre équipement plus en détail.", "dial_camp_npc2_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"dial_camp_npc2", [],  "Nous devrions parler de vos spécialités, que savez vous faire ?", "dial_camp_npc2_skill", []],###
  [anyone|plyr ,"dial_camp_npc2", [],  "Rappellez moi votre histoire.", "dial_camp_npc2_story", []],###
  [anyone|plyr ,"dial_camp_npc2", [],  "Ca sera tout, a plus tard.", "close_window", []],###
  
  [anyone ,"dial_camp_npc2_skill", [],"Mais certainement, voyons cela.", "dial_camp_npc2_retour", [(change_screen_view_character)]],###
  [anyone ,"dial_camp_npc2_story", [],"Je suis né a Paris, ou j'y ai passé le plus clair de ma vie, c'est la bas dans les casernes ou j'ai apris le métier des armes. tout petit j'amenais de la cervoise aux soldats en échange de quois, ils me montraient quelques passes a l'épée.", "dial_camp_npc2_retour", []],###
  
  
  [anyone ,"dial_camp_npc2_retour", [],"Avez vous autre chose a me dire?", "dial_camp_npc2", []],###
  
  
  
  #npc3 Enguerrand
  [anyone,"start", [(eq, "$g_talk_troop", "trp_npc3"),
      (eq, "$entre_camp", 1),
    ],
    "N'ayez craintes capitaine, je veille sur vous, si un homme s'approchais discretement je le verrai a temps.", "dial_camp_npc3", []],
  
  [anyone|plyr ,"dial_camp_npc3", [],  "Puis que nous avons le temps, voyons votre équipement plus en détail.", "dial_camp_npc3_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"dial_camp_npc3", [],  "Nous devrions parler de vos spécialités, que savez vous faire ?", "dial_camp_npc3_skill", []],###
  [anyone|plyr ,"dial_camp_npc3", [],  "Rappellez moi votre histoire.", "dial_camp_npc3_story", []],###
  [anyone|plyr ,"dial_camp_npc3", [],  "Ca sera tout, a plus tard.", "close_window", []],###
  
  [anyone ,"dial_camp_npc3_skill", [],"Et bien a vous de me dire ce que vous attendez de moi.", "dial_camp_npc3_retour", [(change_screen_view_character)]],###
  [anyone ,"dial_camp_npc3_story", [],"La Bretagne est ma terre de naissance, j'y ai grandis tel un un chene, je suis de naiscance noble, de par mes deux parents.", "dial_camp_npc3_retour", []],###
  
  
  [anyone ,"dial_camp_npc3_retour", [],"Ca sera tout ?", "dial_camp_npc3", []],###
  
  
  #npc4 Gaspard
  [anyone,"start", [(eq, "$g_talk_troop", "trp_npc4"),
      (eq, "$entre_camp", 1),
    ],
    "Capitaine ?", "dial_camp_npc4", []],
  
  [anyone|plyr ,"dial_camp_npc4", [],  "Puis que nous avons le temps, voyons votre équipement plus en détail.", "dial_camp_npc4_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"dial_camp_npc4", [],  "Nous devrions parler de vos spécialités, que savez vous faire ?", "dial_camp_npc4_skill", []],###
  [anyone|plyr ,"dial_camp_npc4", [],  "Rappellez moi votre histoire.", "dial_camp_npc4_story", []],###
  [anyone|plyr ,"dial_camp_npc4", [],  "Ca sera tout, a plus tard.", "close_window", []],###
  
  [anyone ,"dial_camp_npc4_skill", [],"Je sait me battre, point d'inquiétudes capitaine.", "dial_camp_npc4_retour", [(change_screen_view_character)]],###
  [anyone ,"dial_camp_npc4_story", [],"Je suis Enguerrand, on avait une exploitation prospère, mais ma ferme a été brulée et ma famille masacrée par des militaires. J'ai un grand désir de revanche que je dois assouvir.", "dial_camp_npc4_retour", []],###
  
  
  [anyone ,"dial_camp_npc4_retour", [],"Autre chose ?", "dial_camp_npc4", []],###
  
  
  
  #npc5 Hermance de Bordeaux
  [anyone,"start", [(eq, "$g_talk_troop", "trp_npc5"),
      (eq, "$entre_camp", 1),
    ],
    "Nous devrions songer a toutes les possibilités de nous faire un peut d'or Messire. je ne voudrai point vous ennuyer pendant que vous vous reposez, mais songez a toutes les affaires que nous pourions faire si nous nous préparons a l'avance. marcher nous fait perdre du temps, de ce fait il est bon de regroupper plusieures affaire sur une meme route.", "dial_camp_npc5", []],
  
  [anyone|plyr ,"dial_camp_npc5", [],  "Puis que nous avons le temps, voyons votre équipement plus en détail.", "dial_camp_npc5_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"dial_camp_npc5", [],  "Nous devrions parler de vos spécialités, que savez vous faire ?", "dial_camp_npc5_skill", []],###
  [anyone|plyr ,"dial_camp_npc5", [],  "Rappellez moi votre histoire.", "dial_camp_npc5_story", []],###
  [anyone|plyr ,"dial_camp_npc5", [],  "Ca sera tout, a plus tard.", "close_window", []],###
  
  [anyone ,"dial_camp_npc5_skill", [],"A vrais dire je suis surtout marchand vous savez.", "dial_camp_npc5_retour", [(change_screen_view_character)]],###
  [anyone ,"dial_camp_npc5_story", [],"Je m'appelle Hermance, je viens de Bordeaux, et j'en suis parti animé par la haine de ceux qui m'ont dépossedés et aussi attiré par l'aventure.", "dial_camp_npc5_retour", []],###
  
  
  [anyone ,"dial_camp_npc5_retour", [],"Autre chose ?", "dial_camp_npc5", []],###
  
  
  
  #npc6 Guillaume
  [anyone,"start", [(eq, "$g_talk_troop", "trp_npc6"),
      (eq, "$entre_camp", 1),
    ],
    "Rapide a l'épée et rapide pour vider ma choppe, etes vous venu admirer le travail capitaine ? vous vous joignez a moi ?", "dial_camp_npc6", []],
  
  [anyone|plyr ,"dial_camp_npc6", [],  "Puis que nous avons le temps, voyons votre équipement plus en détail.", "dial_camp_npc6_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"dial_camp_npc6", [],  "Nous devrions parler de vos spécialités, que savez vous faire ?", "dial_camp_npc6_skill", []],###
  [anyone|plyr ,"dial_camp_npc6", [],  "Rappellez moi votre histoire.", "dial_camp_npc6_story", []],###
  [anyone|plyr ,"dial_camp_npc6", [],  "Ca sera tout, a plus tard.", "close_window", []],###
  
  [anyone ,"dial_camp_npc6_skill", [],"Je suis mercenaire de métier capitaine, le combat sera toute ma vie jusqu'a ma mort.", "dial_camp_npc6_retour", [(change_screen_view_character)]],###
  [anyone ,"dial_camp_npc6_story", [],"Je suis Guillaume de Bourges, capitaine. Je m'en veux d'être le seul survivant du massacre de mon ancienne compagnie de mercenaires. Je suis une victime de cette stupide guerre il y as des moments ou j'aurais préféré etre tué au combat plutot que d'etre le seul survivant de la bataille qui as coutée la vie de mes camarades, mais parfois je pense que la vie est une belle chose.", "dial_camp_npc6_retour", []],###
  
  
  [anyone ,"dial_camp_npc6_retour", [],"Autre chose a me dire capitaine ?", "dial_camp_npc6", []],###
  
  
  
  #npc7 Pierrick
  [anyone,"start", [(eq, "$g_talk_troop", "trp_npc7"),
      (eq, "$entre_camp", 1),
    ],
    "Un peut de silence, enfin...seulement le bruit de la nature.", "dial_camp_npc7", []],
  
  [anyone|plyr ,"dial_camp_npc7", [],  "Puis que nous avons le temps, voyons votre équipement plus en détail.", "dial_camp_npc7_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"dial_camp_npc7", [],  "Nous devrions parler de vos spécialités, que savez vous faire ?", "dial_camp_npc7_skill", []],###
  [anyone|plyr ,"dial_camp_npc7", [],  "Rappellez moi votre histoire.", "dial_camp_npc7_story", []],###
  [anyone|plyr ,"dial_camp_npc7", [],  "Ca sera tout, a plus tard.", "close_window", []],###
  
  [anyone ,"dial_camp_npc7_skill", [],"Je suis chasseur et pisteur, ca peut vous etre utile pour retrouver un groupe.", "dial_camp_npc7_retour", [(change_screen_view_character)]],###
  [anyone ,"dial_camp_npc7_story", [],"On m'appelle Pierrick, je viens de Nemours et je suis un chasseur, nomer les ennemis qui tentent de se cacher de vous et je retrouverai leurs traces pour vous.", "dial_camp_npc7_retour", []],###
  
  
  [anyone ,"dial_camp_npc7_retour", [],"Quois d'autre ?", "dial_camp_npc7", []],###
  
  
  
  #npc8 Renaud
  [anyone,"start", [(eq, "$g_talk_troop", "trp_npc8"),
      (eq, "$entre_camp", 1),
    ],
    "Au revoir capitaine, comment ca va ?", "dial_camp_npc8", []],
  
  [anyone|plyr ,"dial_camp_npc8", [],  "Puis que nous avons le temps, voyons votre équipement plus en détail.", "dial_camp_npc8_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"dial_camp_npc8", [],  "Nous devrions parler de vos spécialités, que savez vous faire ?", "dial_camp_npc8_skill", []],###
  [anyone|plyr ,"dial_camp_npc8", [],  "Rappellez moi votre histoire.", "dial_camp_npc8_story", []],###
  [anyone|plyr ,"dial_camp_npc8", [],  "Ca sera tout, a plus tard.", "close_window", []],###
  
  [anyone ,"dial_camp_npc8_skill", [],"Je suis Renaud, Renaud est trés fort, Renaud c'est la mort comme dit le roi d'angleterre, le tavernier de mon village aussi il pense comme moi.", "dial_camp_npc8_retour", [(change_screen_view_character)]],###
  [anyone ,"dial_camp_npc8_story", [],"Ma mère m'a donné la vie en écosse, et elle y est restée avec mon soi-disant père.", "dial_camp_npc8_retour", []],###
  
  
  [anyone ,"dial_camp_npc8_retour", [],"De quois ?", "dial_camp_npc8", []],###
  
  
  
  #npc9 Gael
  [anyone,"start", [(eq, "$g_talk_troop", "trp_npc9"),
      (eq, "$entre_camp", 1),
    ],
    "Ah messire! comment faire pour ne pas perdre son temps d'aprés vous? je veux dire comment ne pas rater sa vie ? comment r?ssir chaques instant et comment vivre chaques secondes du mieux que l'on peut ? je me pose tellement de questions, pas vous ?", "dial_camp_npc9", []],
  
  [anyone|plyr ,"dial_camp_npc9", [],  "Puis que nous avons le temps, voyons votre équipement plus en détail.", "dial_camp_npc9_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"dial_camp_npc9", [],  "Nous devrions parler de vos spécialités, que savez vous faire ?", "dial_camp_npc9_skill", []],###
  [anyone|plyr ,"dial_camp_npc9", [],  "Rappellez moi votre histoire.", "dial_camp_npc9_story", []],###
  [anyone|plyr ,"dial_camp_npc9", [],  "Ca sera tout, a plus tard.", "close_window", []],###
  
  [anyone ,"dial_camp_npc9_skill", [],"Je suis chevalier Capitaine, le l'oubliez point je vous prie, c'est a cheval et avec la lance que le Chevalier se bat pour des causes.", "dial_camp_npc9_retour", [(change_screen_view_character)]],###
  [anyone ,"dial_camp_npc9_story", [],"Je suis Gael de Bourbon, noble de France, chevalier de Toulouse o? je suis né, o? j'ai grandi et fondé de faux éspoirs sur un monde corompu, mais que joie et détermination soit miennes, je suis sur la vrais route de la chevalerie loing de toute corumption, je suis sur la voie de la rédemption.", "dial_camp_npc9_retour", []],###
  
  
  [anyone ,"dial_camp_npc9_retour", [],"Austre chose ?", "dial_camp_npc9", []],###
  
  
  
  
  #npc10 Gauvin
  [anyone,"start", [(eq, "$g_talk_troop", "trp_npc10"),
      (eq, "$entre_camp", 1),
    ],
    "Le tranchant des lames laissent a désirer le saviez vous capitaine ? il serais bon de mettre quelques unes de ces limages au travail d'affutage.", "dial_camp_npc10", []],
  
  [anyone|plyr ,"dial_camp_npc10", [],  "Puis que nous avons le temps, voyons votre équipement plus en détail.", "dial_camp_npc10_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"dial_camp_npc10", [],  "Nous devrions parler de vos spécialités, que savez vous faire ?", "dial_camp_npc10_skill", []],###
  [anyone|plyr ,"dial_camp_npc10", [],  "Rappellez moi votre histoire.", "dial_camp_npc10_story", []],###
  [anyone|plyr ,"dial_camp_npc10", [],  "Ca sera tout, a plus tard.", "close_window", []],###
  
  [anyone ,"dial_camp_npc10_skill", [],"Ma fonction est maistre d'armes, je suis un guerrier avant tout, mais mon role est de transmettre mon savoir aux recrues.", "dial_camp_npc10_retour", [(change_screen_view_character)]],###
  [anyone ,"dial_camp_npc10_story", [],"Je suis né près de Monterean. J'ai été maistre d'armes pour de nombreux seigneurs et chevaliers au chateau  depuis l'âge de vingt ans.", "dial_camp_npc10_retour", []],###
  
  
  [anyone ,"dial_camp_npc10_retour", [],"Autre chose ?", "dial_camp_npc10", []],###
  
  
  
  
  
  #npc11 Florentin
  [anyone,"start", [(eq, "$g_talk_troop", "trp_npc11"),
      (eq, "$entre_camp", 1),
    ],
    "Non je ne dort pas debout Messire, est ce cela que vous alliez me dire ? je me repose un peut voila tout.", "dial_camp_npc11", []],
  
  [anyone|plyr ,"dial_camp_npc11", [],  "Puis que nous avons le temps, voyons votre équipement plus en détail.", "dial_camp_npc11_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"dial_camp_npc11", [],  "Nous devrions parler de vos spécialités, que savez vous faire ?", "dial_camp_npc11_skill", []],###
  [anyone|plyr ,"dial_camp_npc11", [],  "Rappellez moi votre histoire.", "dial_camp_npc11_story", []],###
  [anyone|plyr ,"dial_camp_npc11", [],  "Ca sera tout, a plus tard.", "close_window", []],###
  
  [anyone ,"dial_camp_npc11_skill", [],"Un peut de marchandage de temps a autre, je sait aussi me battre ne vous en faites pas.", "dial_camp_npc11_retour", [(change_screen_view_character)]],###
  [anyone ,"dial_camp_npc11_story", [],"Je suis forgeron, ou du moins je l'était, a présent je suis chasseur de prime, et ce sont les marauds de la pire éspèce que je frappe sur mon enclume.", "dial_camp_npc11_retour", []],###
  
  
  [anyone ,"dial_camp_npc11_retour", [],"Autre chose ?", "dial_camp_npc11", []],###
  
  
  
  #npc12 Nortimer
  [anyone,"start", [(eq, "$g_talk_troop", "trp_npc12"),
      (eq, "$entre_camp", 1),
    ],
    "Messire, il y as quelques cas de bléssures infectées mais nous allons régler cela n'ayez craintes.", "dial_camp_npc12", []],
  
  [anyone|plyr ,"dial_camp_npc12", [],  "Puis que nous avons le temps, voyons votre équipement plus en détail.", "dial_camp_npc12_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"dial_camp_npc12", [],  "Nous devrions parler de vos spécialités, que savez vous faire ?", "dial_camp_npc12_skill", []],###
  [anyone|plyr ,"dial_camp_npc12", [],  "Rappellez moi votre histoire.", "dial_camp_npc12_story", []],###
  [anyone|plyr ,"dial_camp_npc12", [],  "Ca sera tout, a plus tard.", "close_window", []],###
  
  [anyone ,"dial_camp_npc12_skill", [],"Je suis médecin Messire, je vous tirerais vous et vos hommes des griffes de la mort autant de fois que vous ne pourrais les compter, a condition que je me tienne a distance. qui pourais je sauver si je suis moi meme inconscient.", "dial_camp_npc12_retour", [(change_screen_view_character)]],###
  [anyone ,"dial_camp_npc12_story", [],"Je suis Médecin, et ma mission est de sauver tous les patiens quels qu'ils soient atteints de divers fléaux, aux prétres et a Dieu de les juger par la suite.", "dial_camp_npc12_retour", []],###
  
  
  [anyone ,"dial_camp_npc12_retour", [],"De quois voulez vous me parler ?", "dial_camp_npc12", []],###
  
  
  
  
  
  #npc13 Mathieu
  [anyone,"start", [(eq, "$g_talk_troop", "trp_npc13"),
      (eq, "$entre_camp", 1),
    ],
    "A la gloire! a...notre joli camp pour le moment Messire, buvez vous quelque chose avec nous ?", "dial_camp_npc13", []],
  
  [anyone|plyr ,"dial_camp_npc13", [],  "Puis que nous avons le temps, voyons votre équipement plus en détail.", "dial_camp_npc13_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"dial_camp_npc13", [],  "Nous devrions parler de vos spécialités, que savez vous faire ?", "dial_camp_npc13_skill", []],###
  [anyone|plyr ,"dial_camp_npc13", [],  "Rappellez moi votre histoire.", "dial_camp_npc13_story", []],###
  [anyone|plyr ,"dial_camp_npc13", [],  "Ca sera tout, a plus tard.", "close_window", []],###
  
  [anyone ,"dial_camp_npc13_skill", [],"Si vous avez besoin d'un fantassin digne de ce nom, je suis vostre homme capitane.", "dial_camp_npc13_retour", [(change_screen_view_character)]],###
  [anyone ,"dial_camp_npc13_story", [],"Je suis Mathieu, tueur de sang froid, mercenaire et tant d'autres choses qui ne valent pas la peine d'etre citées, et si nous nous contentions seulement de boire avant qu'une lame nous transperce le ventre.", "dial_camp_npc13_retour", []],###
  
  
  [anyone ,"dial_camp_npc13_retour", [],"Autre chose ?", "dial_camp_npc13", []],###
  
  
  
  
  #npc14 Michel
  [anyone,"start", [(eq, "$g_talk_troop", "trp_npc14"),
      (eq, "$entre_camp", 1),
    ],
    "Capitaine, vous n'oubiez pas la cause de la résistance dans tout ceci n'est ce pas ? je vous rappelle juste que c'est pour soutenir la résistance de france que je vous ai rejoins.", "dial_camp_npc14", []],
  
  [anyone|plyr ,"dial_camp_npc14", [],  "Puis que nous avons le temps, voyons votre équipement plus en détail.", "dial_camp_npc14_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"dial_camp_npc14", [],  "Nous devrions parler de vos spécialités, que savez vous faire ?", "dial_camp_npc14_skill", []],###
  [anyone|plyr ,"dial_camp_npc14", [],  "Rappellez moi votre histoire.", "dial_camp_npc14_story", []],###
  [anyone|plyr ,"dial_camp_npc14", [],  "Ca sera tout, a plus tard.", "close_window", []],###
  
  [anyone ,"dial_camp_npc14_skill", [],"Je suis archer la plupart du temps, mais je compte sur vous pour m'apprendre les ficéles du métier de mercenaire.", "dial_camp_npc14_retour", [(change_screen_view_character)]],###
  [anyone ,"dial_camp_npc14_story", [],"Je suis Michel de chartres fils de Simon le forgeron,je suis un Rebel,et je n'aurais de cesse de me battre tant que l'envhaisseur ne sera pas jeté a la mer.", "dial_camp_npc14_retour", []],###
  
  
  [anyone ,"dial_camp_npc14_retour", [],"Autre chose ?", "dial_camp_npc14", []],###
  
  
  
  
  
  
  #npc15 Godefroi de Cherbourg
  [anyone,"start", [(eq, "$g_talk_troop", "trp_npc15"),
      (eq, "$entre_camp", 1),
    ],
    "Capitaine! nous allons enfin pouvoir avoir une conversation. depuis ce matin on m'as parlé de poules et de leurs oeufs, de charpentes qui sont mordues par des insectes et d'un sceau ou le niveau de l'eau as été jugé a un niveau insuffisant, allons nous parler plus sérieusement de guerre sous cette tenture ?", "dial_camp_npc15", []],
  
  [anyone|plyr ,"dial_camp_npc15", [],  "Puis que nous avons le temps, voyons votre équipement plus en détail.", "dial_camp_npc15_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"dial_camp_npc15", [],  "Nous devrions parler de vos spécialités, que savez vous faire ?", "dial_camp_npc15_skill", []],###
  [anyone|plyr ,"dial_camp_npc15", [],  "Rappellez moi votre histoire.", "dial_camp_npc15_story", []],###
  [anyone|plyr ,"dial_camp_npc15", [],  "Ca sera tout, a plus tard.", "close_window", []],###
  
  [anyone ,"dial_camp_npc15_skill", [],"Je suis ingénieur en siège capitaine, aucun chateau ne me résiste, il y as toujours une faille dans les defenses voyez vous, cela prend du temps mais on finis toujours par la trouver et par l'exploiter.", "dial_camp_npc15_retour", [(change_screen_view_character)]],###
  [anyone ,"dial_camp_npc15_story", [],"Je suis né ?Paris et j'ai étudié les engins de guerre modèrnes. J'ai aussi certaines compétences en litérature et en latin.", "dial_camp_npc15_retour", []],###
  
  
  [anyone ,"dial_camp_npc15_retour", [],"Autre chose ?", "dial_camp_npc15", []],###
  
  
  
  
  
  
  #npc16 Blanche
  [anyone,"start", [(eq, "$g_talk_troop", "trp_npc16"),
      (eq, "$entre_camp", 1),
    ],
    "Mon bon Messire ? je ne me moque pas de vous, je suis juste d'humeur jouyeuse, j'en profiterai si j'étais vous.", "dial_camp_npc16", []],
  
  [anyone|plyr ,"dial_camp_npc16", [],  "Puis que nous avons le temps, voyons votre équipement plus en détail.", "dial_camp_npc16_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"dial_camp_npc16", [],  "Nous devrions parler de vos spécialités, que savez vous faire ?", "dial_camp_npc16_skill", []],###
  [anyone|plyr ,"dial_camp_npc16", [],  "Rappellez moi votre histoire.", "dial_camp_npc16_story", []],###
  [anyone|plyr ,"dial_camp_npc16", [],  "Ca sera tout, a plus tard.", "close_window", []],###
  
  [anyone ,"dial_camp_npc16_skill", [],"Je sait manier le couteau et les petites lames aussi bien que ma langue et ce dans le sens propre comme au sens figuré ce qui pourais vous etre utile si vous avez des affaires de diplomacie. je peut tuer un homme de sang froid juste apr? lui avoir dit que je lui offre mon ame.Mais de grace capitaine évitez de m'envoyer a la bataille contre une mongtagne de muscles, avez vous regardé la forme reéle de mes muscles ?", "dial_camp_npc16_retour", [(change_screen_view_character)]],###
  [anyone ,"dial_camp_npc16_story", [],"Et bien capitaine, je m'appelle Blanche, juste Blanche. je suis née dans un village pr? de Peronne, ma mère et mes soeurs étaient servantes dans le chateau d'un noble pervers, jusqu'a ce que je m'en empare a moi toute seule par mes...charmes. ainsi la ou une compagnie n'aurais pas pu prendre ce chateau j'y suit parvenue. on m'as donn?beaucoup de surnoms, mais celui qui me va le mieux est la vipère blanche.", "dial_camp_npc16_retour", []],###
  
  
  [anyone ,"dial_camp_npc16_retour", [],"Autre chose ?", "dial_camp_npc15", []],###
  
  
  ################### steel edition compagnions dialogues camp end ######################################################
  ### Rehire dialogues
  [anyone, "start", [(is_between, "$g_talk_troop", companions_begin, companions_end),
      (neg|troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
      (troop_slot_eq, "$g_talk_troop", slot_troop_playerparty_history, pp_history_indeterminate),
      
      (troop_get_slot, ":prison_center", "$g_talk_troop", slot_troop_prisoner_of_party),
      (lt, ":prison_center", centers_begin),
    ],
    "My offer to rejoin you still stands, if you'll have me.", "companion_rehire", []],
  
  ### If the companion and the player were separated in battle
  [anyone, "start",
    [
      (is_between, "$g_talk_troop", companions_begin, companions_end),
      (neg|troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
      (troop_slot_eq, "$g_talk_troop", slot_troop_playerparty_history, pp_history_scattered),
      
      (this_or_next|eq, "$talk_context", tc_hero_freed),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      
      (neq, "$talk_context", tc_prison_break),
      
      (assign, ":battle_fate", "str_battle_fate_1"),
      (store_random_in_range, ":fate_roll", 0, 5),
      (val_add, ":battle_fate", ":fate_roll"),
      (str_store_string, s6, ":battle_fate"),
      (troop_get_slot, ":honorific", "$g_talk_troop", slot_troop_honorific),
      (str_store_string, s5, ":honorific"),
    ],
    "It is good to see you alive, {s5}! {s6}, and I did not know whether you had been captured, or slain, or got away. I've been roaming around since then, looking for you. Shall I get my gear together and rejoin your company?","companion_rehire",
    [
      (troop_set_slot, "$g_talk_troop", slot_troop_playerparty_history, pp_history_indeterminate),
      (troop_set_slot, "$g_talk_troop", slot_troop_prisoner_of_party, -1),
  ]],
  
  [anyone|plyr,"start",
    [
      (is_between, "$g_talk_troop", companions_begin, companions_end),
      (neg|troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
      (troop_slot_eq, "$g_talk_troop", slot_troop_playerparty_history, pp_history_scattered),
      
      (troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      
      (neq, "$talk_context", tc_prison_break),
      
      (assign, ":battle_fate", "str_battle_fate_1"),
      (store_random_in_range, ":fate_roll", 0, 5),
      (val_add, ":battle_fate", ":fate_roll"),
      (str_store_string, s6, ":battle_fate"),
      (troop_get_slot, ":honorific", "$g_talk_troop", slot_troop_honorific),
      (str_store_string, s5, ":honorific"),
    ],
    "I've come to break you out of here.", "companion_prison_break_chains",[]],
  
  [anyone,"companion_prison_break_chains", [],
    "Thank the heavens you came! However, I'm not going anywhere with these chains on my legs. You'll need to get the key away from the guard somehow.", "close_window",[]],
  
  
  
  
  ### If the player and the companion parted on bad terms
  [anyone, "start", [(is_between, "$g_talk_troop", companions_begin, companions_end),
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, 0),
      (troop_slot_eq, "$g_talk_troop", slot_troop_turned_down_twice, 0),
      (troop_slot_eq, "$g_talk_troop", slot_troop_playerparty_history, pp_history_quit),
      (troop_get_slot, ":speech", "$g_talk_troop", slot_troop_rehire_speech),
      (str_store_string, 5, ":speech"),
    ],
    "{s5}", "companion_rehire", [
      (troop_set_slot, "$g_talk_troop", slot_troop_playerparty_history, pp_history_indeterminate),
  ]],
  
  
  ###If the player and the companion parted on good terms
  [anyone, "start", [(is_between, "$g_talk_troop", companions_begin, companions_end),
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, 0),
      (troop_slot_eq, "$g_talk_troop", slot_troop_playerparty_history, pp_history_dismissed),
      (troop_get_slot, ":honorific", "$g_talk_troop", slot_troop_honorific),
      (str_store_string, 21, ":honorific"),
      (troop_get_slot, ":speech", "$g_talk_troop", slot_troop_backstory_delayed),
      (str_store_string, 5, ":speech"),
    ],
    "It is good to see you, {s21}! To tell you the truth, I had hoped to run into you.",
    "companion_was_dismissed", [
      (troop_set_slot, "$g_talk_troop", slot_troop_playerparty_history, pp_history_indeterminate),
  ]],
  
  [anyone, "companion_was_dismissed", [
      (neg|troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
      (troop_get_slot, ":speech", "$g_talk_troop", slot_troop_backstory_delayed),
      (str_store_string, 5, ":speech"),
    ],
    "{s5}. Would you want me to rejoin your company?", "companion_rehire", [
  ]],
  
  
  [anyone|plyr, "companion_rehire",
    [
      (hero_can_join, "p_main_party"),
      ], "Welcome back, my friend!", "companion_recruit_signup_confirm", []],
  
  [anyone|plyr, "companion_rehire",
    [],
    "Sorry, I can't take on anyone else right now.", "companion_rehire_refused", []],
  
  [anyone, "companion_rehire_refused", [], "Well... Look me up if you change your mind, eh?", "close_window",
    [
      (troop_get_slot, ":current_town_no", "$g_talk_troop", slot_troop_cur_center),
      
      (try_begin),
        (neg|is_between, ":current_town_no", towns_begin, towns_end),
        
        (store_random_in_range, ":town_no", towns_begin, towns_end),
        (troop_set_slot, "$g_talk_troop", slot_troop_cur_center, ":town_no"),
        
        (try_begin),
          (ge, "$cheat_mode", 1),
          (assign, reg1, ":current_town_no"),
          (str_store_party_name, s7, ":town_no"),
          (display_message, "@{!}current town was {reg1}, now moved to {s7}"),
        (try_end),
      (try_end),
  ]],
  
  #Default dialog added - for rehire
  [anyone, "start", [
      (is_between, "$g_talk_troop", companions_begin, companions_end),
      (neg|troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
      
      (troop_get_slot, ":prison_center", "$g_talk_troop", slot_troop_prisoner_of_party),
      (lt, ":prison_center", centers_begin),
    ], "So... Do you want me back yet?", "companion_rehire",
    []],
  #Ministerial issues
  
  
  
  
  [anyone, "minister_issues",
    [
      (check_quest_active, "qst_consult_with_minister"),
      (eq, "$g_minister_notification_quest", "qst_resolve_dispute"),
      
      (setup_quest_text,"qst_resolve_dispute"),
      
      (quest_get_slot, ":lord_1", "qst_resolve_dispute", slot_quest_target_troop),
      (str_store_troop_name, s11, ":lord_1"),
      
      (quest_get_slot, ":lord_2", "qst_resolve_dispute", slot_quest_object_troop),
      (str_store_troop_name, s12, ":lord_2"),
      
      (str_store_string, s2, "str_resolve_the_dispute_between_s11_and_s12"),
      (call_script, "script_start_quest", "qst_resolve_dispute", -1),
      (quest_set_slot, "qst_resolve_dispute", slot_quest_expiration_days, 30),
      (quest_set_slot, "qst_resolve_dispute", slot_quest_giver_troop, "$g_player_minister"),
      (quest_set_slot, "qst_resolve_dispute", slot_quest_target_state, 0),
      (quest_set_slot, "qst_resolve_dispute", slot_quest_object_state, 0),
      
      (quest_get_slot, ":lord_1", "qst_resolve_dispute", slot_quest_target_troop), #this block just to check if the slots work
      (str_store_troop_name, s11, ":lord_1"),
      (quest_get_slot, ":lord_2", "qst_resolve_dispute", slot_quest_object_troop),
      (str_store_troop_name, s12, ":lord_2"),
      
    ],
    "There is a matter which needs your attention. The quarrel between {s11} and {s12} has esclatated to a point where it has become unseemly. If you do intervene, you risk offending one of the lords. However, if you do nothing, you risk appearing weak. Such are the burdens of kingship, {sire/my lady}.", "minister_pretalk",
    [
      (call_script, "script_end_quest", "qst_consult_with_minister"),
  ]],
  
  [anyone, "minister_issues",
    [
      (assign, "$g_center_taken_by_player_faction", -1),
      (try_for_range, ":center_no", centers_begin, centers_end),
        (eq, "$g_center_taken_by_player_faction", -1),
        (store_faction_of_party, ":center_faction", ":center_no"),
        (eq, ":center_faction", "fac_player_supporters_faction"),
        (neg|party_slot_ge, ":center_no", slot_town_lord, 0),
        (assign, "$g_center_taken_by_player_faction", ":center_no"),
      (try_end),
      (is_between, "$g_center_taken_by_player_faction", centers_begin, centers_end),
      (str_store_party_name, s1, "$g_center_taken_by_player_faction"),
    ],
    "{s1} currently does not have a lord. You may wish to keep it this way, as lords will sometimes gravitate towards lieges who have land to offer, but for the time being, no one is collecting any of its rents.", "minister_talk",
    []],
  
  [anyone, "minister_issues",
    [
      (neg|is_between, "$g_player_minister", active_npcs_begin, kingdom_ladies_end),
    ],
    "At this point, there are no particularly urgent matters which need your attention. I should point out though, sire, that I am not very skilled in the ways of politics, and that I am anxious to return to private life. If you wish to issue any but the most basic directives, I suggest appointing a trusted companion in my stead. In the meantime, is there anything you wish done?", "minister_talk",[]],
  
  [anyone, "minister_issues",
    [
      (eq, 1, 0),
    ],
    "{!}[Should not appear - there to prevent error related to center_captured_lord_advice]", "center_captured_lord_advice",[]],
  
  [anyone, "minister_issues",
    [
      (lt, "$player_right_to_rule", 30),
    ],
    "If I may offer you a world of advice, my {lord/lady}, it seems that your right to rule as an independent monarch is not sufficiently recognized, and this may bring us problems further down the road. It may be advisable to find another kingdom with whom you have shared interests and seek its recognition, to establish yourself as an equal with France's other kings.", "minister_talk",[]],
  
  
  [anyone, "minister_issues",
    [],
    "At this point, there are no particularly urgent matters which need your attention. Is there anything you wish done?", "minister_talk",[]],
  
  [anyone, "minister_pretalk",
    [],
    "Is there anything you wish done?", "minister_talk",
    []],
  
  [anyone|plyr,"minister_talk",
    [
      (is_between, "$g_player_minister", active_npcs_begin, kingdom_ladies_end),
    ],
    "Do you have any ideas to strengthen our kingdom's unity?", "combined_political_quests",[
      (call_script, "script_get_political_quest", "$g_talk_troop"),
      (assign, "$political_quest_found", reg0),
      (assign, "$political_quest_target_troop", reg1),
      (assign, "$political_quest_object_troop", reg2),
      
  ]],
  
  
  [anyone|plyr,"minister_talk",
    [
      (assign, "$political_quest_to_cancel", -1),
      (try_begin),
        (check_quest_active, "qst_offer_gift"),
        (quest_slot_eq, "qst_offer_gift", slot_quest_giver_troop, "$g_talk_troop"),
        (assign, "$political_quest_to_cancel", "qst_offer_gift"),
        (str_store_string, s10, "str_offer_gift_description"),
      (else_try),
        (check_quest_active, "qst_resolve_dispute"),
        (quest_slot_eq, "qst_resolve_dispute", slot_quest_giver_troop, "$g_talk_troop"),
        (assign, "$political_quest_to_cancel", "qst_resolve_dispute"),
        (str_store_string, s10, "str_resolve_dispute_description"),
      (try_end),
      (gt, "$political_quest_to_cancel", 0),
    ],
    "Let's abandon our plan to {s10}.", "minister_cancel_political_quest",[
  ]],
  
  [anyone,"minister_cancel_political_quest",
    [],
    "Are you sure you want to drop that idea?", "minister_cancel_political_quest_confirm",[
  ]],
  
  [anyone|plyr,"minister_cancel_political_quest_confirm",
    [],
    "Yes, I am sure. Let's abandon that idea.", "minister_pretalk",[
      (call_script, "script_abort_quest", "$political_quest_to_cancel"),
  ]],
  
  [anyone|plyr,"minister_cancel_political_quest_confirm",
    [],
    "Actually, never mind.", "minister_pretalk",[
  ]],
  
  
  
  [anyone|plyr, "minister_talk",
    [
      (is_between, "$g_player_minister", active_npcs_begin, kingdom_ladies_end),
    ],
    "I wish to dispatch an emissary.", "minister_diplomatic_kingdoms",
    []],
  
  [anyone|plyr, "minister_talk",
    [
      (is_between, "$g_player_minister", active_npcs_begin, kingdom_ladies_end),
    ],
    "I wish to indict a disloyal vassal for treason.", "minister_indict",
    []],
  
  [anyone|plyr, "minister_talk",
    [
      (faction_get_slot, ":current_marshal", "$players_kingdom", slot_faction_marshall),
      (ge, ":current_marshal", 0),
      (try_begin),
        (gt, ":current_marshal", 0),
        (str_store_troop_name, s4, ":current_marshal"),
      (else_try),
        (str_store_string, s4, "str_myself"),
      (try_end),
    ],
    "I wish to replace {s4} as marshal.", "minister_change_marshal",
    []],
  
  [anyone|plyr, "minister_talk",
    [
      (faction_slot_eq,  "$players_kingdom", slot_faction_marshall, -1),
    ],
    "I wish to appoint a new marshal.", "minister_change_marshal",
    []],
  
  [anyone, "minister_change_marshal",
    [
      (store_current_hours, ":hours"),
      (val_sub, ":hours", "$g_player_faction_last_marshal_appointment"),
      (lt, ":hours", 48),
    ],
    "You have just made such an appointment, {sire/my lady}. If you countermand your decree so soon, there will be great confusion. We will need to wait a few days.", "minister_pretalk",
    []],
  
  
  [anyone|plyr, "minister_talk",
    [
      (neg|is_between, "$g_player_minister", active_npcs_begin, active_npcs_end),
    ],
    "I wish for you to retire as minister.", "minister_replace",
    []],
  
  [anyone|plyr, "minister_talk",
    [
      (is_between, "$g_player_minister", active_npcs_begin, active_npcs_end),
      (neg|troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
      
    ],
    "I wish you to rejoin my party.", "minister_replace",
    []],
  
  [anyone|plyr, "minister_talk",
    [
      (is_between, "$g_player_minister", active_npcs_begin, kingdom_ladies_end),
    ],
    "I wish you to grant one of my vassals a fief.", "minister_grant_fief",
    []],
  
  [anyone|plyr, "minister_talk",
    [
      (is_between, "$g_player_minister", active_npcs_begin, kingdom_ladies_end),
      (assign, ":fief_found", -1),
      (try_for_range, ":center", centers_begin, centers_end),
        (eq, ":fief_found", -1),
        (store_faction_of_party, ":center_faction", ":center"),
        (eq, ":center_faction", "fac_player_supporters_faction"),
        (party_get_slot, ":town_lord", ":center", slot_town_lord),
        (try_begin),
          (ge, ":town_lord", active_npcs_begin),
          (store_faction_of_troop, ":town_lord_faction", ":town_lord"),
          (neq, ":town_lord_faction", "fac_player_supporters_faction"),
          (assign, ":town_lord", -1),
        (try_end),
        (lt, ":town_lord", 0),
        (assign, ":fief_found", ":center"),
      (try_end),
      (gt, ":fief_found", -1),
      (str_store_party_name, s4, ":fief_found"),
    ],
    "I wish to make myself lord of {s4}.", "minister_grant_self_fief",
    []],
  
  [anyone, "minister_grant_self_fief",
    [
    ],
    "As you wish. You shall be lord of {s4}.", "minister_pretalk",
    [
      (assign, ":fief_found", -1),
      (try_for_range, ":center", centers_begin, centers_end),
        (eq, ":fief_found", -1),
        (store_faction_of_party, ":center_faction", ":center"),
        (eq, ":center_faction", "fac_player_supporters_faction"),
        (party_get_slot, ":town_lord", ":center", slot_town_lord),
        (try_begin),
          (ge, ":town_lord", active_npcs_begin),
          (store_faction_of_troop, ":town_lord_faction", ":town_lord"),
          (neq, ":town_lord_faction", "fac_player_supporters_faction"),
          (assign, ":town_lord", -1),
        (try_end),
        (lt, ":town_lord", 0),
        (assign, ":fief_found", ":center"),
      (try_end),
      
      
      (call_script, "script_give_center_to_lord", ":fief_found", "trp_player", 0),
      (try_begin),
        (faction_slot_eq, "$players_kingdom", slot_faction_political_issue, ":fief_found"),
        (faction_set_slot, "$players_kingdom", slot_faction_political_issue, -1),
      (try_end),
      (str_store_party_name, s4, ":fief_found"),
      
  ]],
  
  
  
  [anyone|plyr, "minister_talk",
    [],
    "That is all for now.", "close_window",
    []],
  
  
  [anyone, "minister_change_marshal",
    [],
    "Who should be the new marshal?", "minister_change_marshal_choose",
    []],
  
  [anyone|plyr, "minister_change_marshal_choose",
    [],
    "I shall be marshal", "minister_pretalk",
    [
      (call_script, "script_appoint_faction_marshall", "fac_player_supporters_faction", "trp_player"),
      (store_current_hours, ":hours"),
      (assign, "$g_recalculate_ais", 1),
      (assign, "$g_player_faction_last_marshal_appointment", ":hours"),
      
      
      (try_begin),
        (faction_slot_eq, "fac_player_supporters_faction", slot_faction_political_issue, 1),
        
        (faction_set_slot, "fac_player_supporters_faction", slot_faction_political_issue, 0),
        (troop_set_slot, "trp_player",  slot_troop_stance_on_faction_issue, -1),
        (try_for_range, ":active_npc", active_npcs_begin, active_npcs_end),
          (store_faction_of_troop, ":active_npc_faction", ":active_npc"),
          (eq, ":active_npc_faction", "fac_player_supporters_faction"),
          (troop_set_slot, ":active_npc", slot_troop_stance_on_faction_issue, -1),
        (try_end),
      (try_end),
  ]],
  
  [anyone|plyr, "minister_change_marshal_choose",
    [],
    "For a short while, we should have no marshal", "minister_pretalk",
    [
      (call_script, "script_appoint_faction_marshall", "fac_player_supporters_faction", -1),
      (try_begin),
        (faction_slot_eq, "fac_player_supporters_faction", slot_faction_political_issue, 1),
        (faction_set_slot, "fac_player_supporters_faction", slot_faction_political_issue, 0),
        
        (troop_set_slot, "trp_player",  slot_troop_stance_on_faction_issue, -1),
        (try_for_range, ":active_npc", active_npcs_begin, active_npcs_end),
          (store_faction_of_troop, ":active_npc_faction", ":active_npc"),
          (eq, ":active_npc_faction", "fac_player_supporters_faction"),
          (troop_set_slot, ":active_npc", slot_troop_stance_on_faction_issue, -1),
        (try_end),
      (try_end),
      
      (assign, "$g_recalculate_ais", 1),
      
  ]],
  
  [anyone|plyr|repeat_for_troops, "minister_change_marshal_choose",
    [
      (store_repeat_object, ":lord"),
      (is_between, ":lord", active_npcs_begin, active_npcs_end),
      (troop_slot_eq, ":lord", slot_troop_occupation, slto_kingdom_hero),
      (store_faction_of_troop, ":lord_faction", ":lord"),
      (eq, ":lord_faction", "fac_player_supporters_faction"),
      (str_store_troop_name, s4, ":lord"),
    ],
    "{s4}", "minister_pretalk",
    [
      (store_repeat_object, ":lord"),
      (call_script, "script_appoint_faction_marshall", "fac_player_supporters_faction", ":lord"),
      (store_current_hours, ":hours"),
      (assign, "$g_player_faction_last_marshal_appointment", ":hours"),
      (try_begin),
        (faction_slot_eq, "fac_player_supporters_faction", slot_faction_political_issue, 1),
        
        (faction_set_slot, "fac_player_supporters_faction", slot_faction_political_issue, 0),
        
        (troop_set_slot, "trp_player",  slot_troop_stance_on_faction_issue, -1),
        (try_for_range, ":active_npc", active_npcs_begin, active_npcs_end),
          (store_faction_of_troop, ":active_npc_faction", ":active_npc"),
          (eq, ":active_npc_faction", "fac_player_supporters_faction"),
          (troop_set_slot, ":active_npc", slot_troop_stance_on_faction_issue, -1),
        (try_end),
      (try_end),
      (assign, "$g_recalculate_ais", 1),
  ]],
  
  
  [anyone|plyr, "minister_change_marshal_choose",
    [],
    "Never mind", "minister_pretalk",
    []],
  
  
  
  [anyone, "minister_diplomatic_kingdoms",
    [
      (assign, ":companion_found", 0),
      (try_for_range, ":emissary", companions_begin, companions_end),
        (main_party_has_troop, ":emissary"),
        (assign, ":companion_found", 1),
      (try_end),
      (eq, ":companion_found", 1),
      
    ],
    "To whom do you wish to send this emissary?", "minister_diplomatic_kingdoms_select",
    []],
  
  [anyone, "minister_diplomatic_kingdoms",
    [
    ],
    "Unfortunately, there is no one to send right now.", "minister_pretalk",
    []],
  
  
  
  [anyone, "minister_diplomatic_kingdoms",
    [],
    "To whom do you wish to send this emissary?", "minister_diplomatic_kingdoms_select",
    []],
  
  [anyone|plyr|repeat_for_factions, "minister_diplomatic_kingdoms_select",
    [
      (store_repeat_object, ":faction_no"),
      (is_between, ":faction_no", kingdoms_begin, kingdoms_end),
      (neq, ":faction_no", "fac_player_supporters_faction"),
      (faction_slot_eq, ":faction_no", slot_faction_state, sfs_active),
      (faction_get_slot, ":leader_no", ":faction_no", slot_faction_leader),
      (str_store_troop_name, s10, ":leader_no"),
      (str_store_faction_name, s11, ":faction_no"),
      (str_clear, s14),
      #Has/has not recognized us a monarch
    ],
    "{s10} of the {s11}{s14}", "minister_diplomatic_initiative_type",
    [
      (store_repeat_object, "$g_faction_selected"),
  ]],
  
  [anyone, "minister_diplomatic_initiative_type",
    [],
    "What do you wish to tell him?", "minister_diplomatic_initiative_type_select",
    []],
  
  [anyone|plyr, "minister_diplomatic_initiative_type_select",
    [(store_relation, ":relation", "fac_player_supporters_faction", "$g_faction_selected"),
      (lt, ":relation", 0),],
    "That our two kingdoms should enter into truce.", "minister_diplomatic_emissary",
    [(assign, "$g_initiative_selected", npc_mission_peace_request)]],
  
  [anyone|plyr, "minister_diplomatic_initiative_type_select",
    [],
    "That I wish to put myself under his protection, as his vassal.", "minister_diplomatic_emissary",
    [(assign, "$g_initiative_selected", npc_mission_pledge_vassal)]],
  
  [anyone|plyr, "minister_diplomatic_initiative_type_select",
    [(store_relation, ":relation", "fac_player_supporters_faction", "$g_faction_selected"),
      (faction_slot_eq, "$g_faction_selected", slot_faction_recognized_player, 0),
      (ge, ":relation", 0),],
    "That I wish to express my goodwill, as one monarch to another.", "minister_diplomatic_emissary",
    [(assign, "$g_initiative_selected", npc_mission_seek_recognition),]],
  
  [anyone|plyr, "minister_diplomatic_initiative_type_select",
    [(store_relation, ":relation", "fac_player_supporters_faction", "$g_faction_selected"),
      (ge, ":relation", 0),],
    "That I declare war upon him.", "minister_declare_war",
    []],
  
  [anyone|plyr, "minister_diplomatic_initiative_type_select",[], "Never mind", "close_window",[]],
  
  [anyone, "minister_declare_war",
    [(try_begin),
        (call_script, "script_diplomacy_faction_get_diplomatic_status_with_faction", "fac_player_supporters_faction", "$g_faction_selected"),
        (eq, reg0, 1),
        (str_store_string, s12, "str_in_doing_so_you_will_be_in_violation_of_your_truce_is_that_what_you_want"),
      (else_try),
        (call_script, "script_diplomacy_faction_get_diplomatic_status_with_faction", "fac_player_supporters_faction", "$g_faction_selected"),
        (neq, reg0, -1),
        (str_store_string, s12, "str_if_you_attack_without_provocation_some_of_your_vassals_may_consider_you_to_be_too_warlike_is_that_what_you_want"),
      (else_try),
        (str_store_string, s12, "str_our_men_are_ready_to_ride_forth_at_your_bidding_are_you_sure_this_is_what_you_want"),
      (try_end),
    ], "{s12}", "minister_declare_war_confirm",
    []],
  
  [anyone|plyr, "minister_declare_war_confirm",
    [(str_store_faction_name, s12, "$g_faction_selected"),
    ],
    "It is. I wish to make war on {s12}.", "minister_declare_war_confirm_yes",
    [
      (call_script, "script_diplomacy_start_war_between_kingdoms",  "fac_player_supporters_faction", "$g_faction_selected", 1),
  ]],
  
  [anyone|plyr, "minister_declare_war_confirm",
    [(str_store_faction_name, s12, "$g_faction_selected"),
    ],
    "Hmm. Perhaps not.", "minister_pretalk",
    [
  ]],
  
  [anyone, "minister_declare_war_confirm_yes",
    [(str_store_faction_name, s12, "$g_faction_selected"),
    ],
    "As you command. We are now at war with the {s12}. May the heavens grant us victory.", "minister_pretalk",
    [
  ]],
  
  
  [anyone, "minister_diplomatic_emissary",
    [], "Who shall be your emissary? You should choose one whom you trust, but who is also persuasive -- one who can negotiate without giving offense.", "minister_emissary_select",
    []],
  
  [anyone|plyr|repeat_for_troops, "minister_emissary_select",[
      (store_repeat_object, ":emissary"),
      (main_party_has_troop, ":emissary"),
      (is_between, ":emissary", companions_begin, companions_end),
      (troop_slot_eq, ":emissary", slot_troop_prisoner_of_party, -1),
      (is_between, ":emissary", active_npcs_begin, active_npcs_end),
      (str_store_troop_name, s11, ":emissary"),
      ], "{s11}", "minister_emissary_dispatch",[
      (store_repeat_object, "$g_emissary_selected"),
  ]],
  
  [anyone|plyr, "minister_emissary_select",[
      ], "Actually, I can't think of anyone.", "minister_pretalk",[]],
  
  [anyone, "minister_emissary_dispatch",
    [
      (str_store_troop_name, s11, "$g_emissary_selected"),
      (str_store_faction_name, s12, "$g_faction_selected"),
      (try_begin),
        (eq, "$g_initiative_selected", npc_mission_seek_recognition),
        (str_store_string, s14, "str_seek_recognition"),
      (else_try),
        (eq, "$g_initiative_selected", npc_mission_pledge_vassal),
        (str_store_string, s14, "str_seek_vassalhood"),
      (else_try),
        (eq, "$g_initiative_selected", npc_mission_peace_request),
        (str_store_string, s14, "str_seek_a_truce"),
      (try_end),
      ], "Very well -- I shall send {s11} to the {s12} to {s14}.", "minister_diplomatic_dispatch_confirm",[]],
  
  [anyone|plyr, "minister_diplomatic_dispatch_confirm",[], "Yes, do that", "minister_pretalk",[
      (troop_set_slot, "$g_emissary_selected", slot_troop_days_on_mission, 3),
      (troop_set_slot, "$g_emissary_selected", slot_troop_current_mission, "$g_initiative_selected"),
      (troop_set_slot, "$g_emissary_selected", slot_troop_mission_object, "$g_faction_selected"),
      
      (remove_member_from_party, "$g_emissary_selected", "p_main_party"),
  ]],
  
  
  [anyone|plyr, "minister_diplomatic_dispatch_confirm",[], "Actually, hold off on that", "minister_pretalk",[]],
  
  [anyone, "minister_replace",
    [], "Very good. Whom will you appoint in my stead?", "minister_replace_select",
    []],
  
  [anyone|plyr|repeat_for_troops, "minister_replace_select",
    [
      (store_repeat_object, ":troop_no"),
      (is_between, ":troop_no", companions_begin, companions_end),
      (main_party_has_troop, ":troop_no"),
      (troop_slot_eq, ":troop_no", slot_troop_prisoner_of_party, -1),
      (str_store_troop_name, s4, ":troop_no"),
    ], "{s4}", "minister_replace_confirm",
    [
      (store_repeat_object, "$g_player_minister"),
  ]],
  
  [anyone|plyr, "minister_replace_select",
    [
      (troop_get_slot, ":spouse", "trp_player", slot_troop_spouse),
      (gt, ":spouse", 0),
      (troop_get_type, ":is_female", ":spouse"),
      (neg|troop_slot_eq, ":spouse", slot_troop_occupation, slto_kingdom_hero),
      (eq, ":is_female", 1),
      (str_store_troop_name, s4, ":spouse"),
      (neq, ":spouse", "$g_talk_troop"),
      
    ], "My wife, {s4}.", "minister_replace_confirm", #husband disabled, as he's an active lord
    [
      (troop_get_slot, "$g_player_minister", "trp_player", slot_troop_spouse),
  ]],
  
  [anyone|plyr, "minister_replace_select",
    [], "Actually, hold off on that.", "minister_pretalk",
    []],
  
  
  
  
  [anyone, "minister_replace_confirm",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_player_companion),
    ], "Very good. {s9} is your new minister. I shall make ready to rejoin you.", "close_window",
    [
      (str_store_troop_name, s9, "$g_player_minister"),
      (party_add_members, "p_main_party", "$g_talk_troop", 1),
      (assign, "$g_leave_encounter", 1),
      (try_begin),
        (main_party_has_troop, "$g_player_minister"),
        (party_remove_members, "p_main_party", "$g_player_minister", 1),
      (try_end),
      
      (try_for_range, ":minister_quest", all_quests_begin, all_quests_end),
        (quest_slot_eq, ":minister_quest", slot_quest_giver_troop, "$g_talk_troop"),
        (call_script, "script_abort_quest", ":minister_quest"),
      (try_end),
  ]],
  
  [anyone, "minister_replace_confirm",
    [
    ], "Very good. {s9} is your new minister. It has been an honor to serve you.", "close_window",
    [
      (str_store_troop_name, s9, "$g_player_minister"),
      (try_begin),
        (main_party_has_troop, "$g_player_minister"),
        (party_remove_members, "p_main_party", "$g_player_minister", 1),
      (try_end),
      
  ]],
  
  
  
  [anyone, "minister_grant_fief",
    [
      (faction_get_slot, ":fief_on_agenda", "$players_kingdom", slot_faction_political_issue),
      (str_clear, s12),
      (try_begin),
        (is_between, ":fief_on_agenda", centers_begin, centers_end),
        (str_store_party_name, s4, ":fief_on_agenda"),
        (str_store_string, s12, "str_minister_advice_select_fief"),
      (else_try),
        (eq, ":fief_on_agenda", 1),
        (str_store_string, s12, "str_minister_advice_select_fief_wait"),
      (try_end),
    ],
    "Which of your fiefs did you wish to grant?{s12}", "minister_grant_fief_select",
    []],
  
  
  [anyone|plyr|repeat_for_parties, "minister_grant_fief_select",
    [
      (store_repeat_object, ":center_no"),
      (is_between, ":center_no", centers_begin, centers_end),
      (store_faction_of_party, ":center_faction", ":center_no"),
      (eq, ":center_faction", "fac_player_supporters_faction"),
      (neq, ":center_no", "$g_player_court"),
      (party_get_slot, ":town_lord", ":center_no", slot_town_lord),
      (try_begin),
        (ge, ":town_lord", active_npcs_begin),
        (store_faction_of_troop, ":town_lord_faction", ":town_lord"),
        (neq, ":town_lord_faction", "fac_player_supporters_faction"),
        (assign, ":town_lord", -1),
      (try_end),
      (le, ":town_lord", 0),
      
      (str_store_party_name, s1, ":center_no"),
      (str_clear, s12),
      (try_begin),
        (party_slot_eq, ":center_no", slot_town_lord, -1),
        (str_store_string, s12, "str_unassigned_center"),
      (try_end),
      
    ],"{s1}{s12}", "minister_grant_fief_select_recipient",
    [
      (store_repeat_object, "$fief_selected"),
  ]],
  
  [anyone|plyr, "minister_grant_fief_select",
    [
    ],"Never mind", "minister_pretalk",
    []],
  
  [anyone, "minister_grant_fief_select_recipient",
    [
      (str_clear, s12),
      (try_begin),
        (faction_slot_eq, "$players_kingdom", slot_faction_political_issue, "$fief_selected"),
        
        (try_for_range, ":active_npc", active_npcs_begin, active_npcs_end),
          (troop_set_slot, ":active_npc", slot_troop_temp_slot, 0),
        (try_end),
        
        (assign, ":popular_favorite", -1),
        (assign, ":votes_for_popular_favorite", 0),
        (try_for_range, ":active_npc", active_npcs_begin, active_npcs_end),
          (store_faction_of_troop, ":active_npc_faction", ":active_npc"),
          (eq, ":active_npc_faction", "fac_player_supporters_faction"),
          (troop_get_slot, ":selected_npc", ":active_npc", slot_troop_stance_on_faction_issue),
          (ge, ":selected_npc", 0),
          
          (troop_get_slot, ":votes_accumulated", ":selected_npc", slot_troop_temp_slot),
          (val_add, ":votes_accumulated", 1),
          (troop_set_slot, ":selected_npc", slot_troop_temp_slot, ":votes_accumulated"),
          
          (gt, ":votes_accumulated", ":votes_for_popular_favorite"),
          (assign,  ":votes_for_popular_favorite", ":votes_accumulated"),
          (assign, ":popular_favorite", ":selected_npc"),
        (try_end),
        
        (is_between, ":popular_favorite", active_npcs_begin, active_npcs_end),
        (str_store_troop_name, s4, ":popular_favorite"),
        (assign, reg4, ":votes_for_popular_favorite"),
        
        (str_store_string, s12, "str_minister_advice_fief_leading_vassal"),
      (try_end),
      
    ],"And who will you choose to receive the fief?{s12}", "minister_grant_fief_select_recipient_choice",
    []],
  
  [anyone|plyr|repeat_for_troops, "minister_grant_fief_select_recipient_choice",
    [
      (store_repeat_object, ":troop_no"),
      (troop_slot_eq, ":troop_no", slot_troop_occupation, slto_kingdom_hero),
      (is_between, ":troop_no", active_npcs_begin, active_npcs_end),
      (store_faction_of_troop, ":troop_faction", ":troop_no"),
      (eq, ":troop_faction", "fac_player_supporters_faction"),
      (str_store_troop_name, s1, ":troop_no"),
      
      
    ],"{s1}", "minister_grant_fief_complete",
    [
      (store_repeat_object, "$lord_selected"),
  ]],
  
  [anyone|plyr, "minister_grant_fief_select_recipient_choice",
    [
    ],"Never mind", "minister_pretalk",
    []],
  
  [anyone, "minister_grant_fief_complete",
    [
    ],"Very well - {s2} shall receive {s1}.", "minister_pretalk",
    [
      (call_script, "script_give_center_to_lord", "$fief_selected", "$lord_selected", 0),
      (str_store_party_name, s1, "$fief_selected"),
      (str_store_troop_name, s2, "$lord_selected"),
      
      (try_begin),
        (faction_slot_eq, "$players_kingdom", slot_faction_political_issue, "$fief_selected"),
        (faction_set_slot, "$players_kingdom", slot_faction_political_issue, -1),
      (try_end),
      
      (call_script, "script_add_log_entry", logent_castle_given_to_lord_by_player, "trp_player", "$fief_selected", "$lord_selected", "$g_encountered_party_faction"),
  ]],
  
  
  
  
  
  
  [anyone, "minister_indict",
    [], "Grim news, {sire/my lady}. Who do you believe is planning to betray you?", "minister_indict_select",
    []],
  
  [anyone|plyr|repeat_for_troops, "minister_indict_select",
    [
      (store_repeat_object, ":troop_no"),
      (troop_slot_eq, ":troop_no", slot_troop_occupation, slto_kingdom_hero),
      (store_faction_of_troop, ":faction", ":troop_no"),
      (eq, ":faction", "fac_player_supporters_faction"),
      (str_store_troop_name, s11, ":troop_no"),
    ], "{s11}", "minister_indict_confirm",
    [
      (store_repeat_object, "$lord_selected"),
  ]],
  
  [anyone|plyr, "minister_indict_select",
    [], "Never mind.", "minister_pretalk",
    []],
  
  
  [anyone, "minister_indict_confirm",
    [
      (str_store_troop_name, s4, "$lord_selected"),
      (troop_get_type, reg4, "$lord_selected"),
    ], "Think carefully on this, {sire/my lady}. If you indict {s4} for treason unjustly, you may find that others become nervous about serving you. On the other hand, if you truly believe that {reg4?she:he} is about to betray you, then perhaps it is best to move first, to secure control of {reg4?her:his} fortresses.", "minister_indict_confirm_answer",
    []],
  
  [anyone|plyr, "minister_indict_confirm_answer",[], "I have thought long enough. Issue the indictment!", "minister_indict_conclude",[]],
  
  [anyone|plyr, "minister_indict_confirm_answer",[], "Perhaps I should wait a little while longer..", "minister_pretalk",[]],
  
  [anyone, "minister_indict_conclude",
    [], "It has been sent, {sire/my lady}.", "minister_pretalk",
    [
      (call_script, "script_indict_lord_for_treason", "$lord_selected", "fac_player_supporters_faction"),
  ]],
  
  
  
  
  
  
  
  
  
  
  [anyone|plyr|repeat_for_troops, "center_captured_lord_advice",
    [
      (store_repeat_object, ":troop_no"),
      (troop_slot_eq, ":troop_no", slot_troop_occupation, slto_kingdom_hero),
      (neq, "$g_talk_troop", ":troop_no"),
      (neq, "trp_player", ":troop_no"),
      (store_troop_faction, ":faction_no", ":troop_no"),
      (eq, ":faction_no", "fac_player_supporters_faction"),
      (str_store_troop_name, s11, ":troop_no"),
      (call_script, "script_print_troop_owned_centers_in_numbers_to_s0", ":troop_no"),
      
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", slot_lord_recruitment_argument, argument_benefit),
        (str_store_string, s12, "str__promised_fief"),
      (else_try),
        (str_clear, s12),
      (try_end),
      
      (try_begin),
        (eq, reg0, 0),
        (str_store_string, s1, "str_no_fiefss12"),
      (else_try),
        (str_store_string, s1, "str_fiefs_s0s12"),
      (try_end),
    ],
    "{s11}. {s1}", "center_captured_lord_advice_2",
    [
      (store_repeat_object, "$temp"),
  ]],
  
  [anyone|plyr, "center_captured_lord_advice",
    [
      (call_script, "script_print_troop_owned_centers_in_numbers_to_s0", "trp_player"),
      (str_store_party_name, s1, "$g_center_taken_by_player_faction"),
      
      (try_begin),
        (is_between, "$g_talk_troop", pretenders_begin, pretenders_end),
        (str_store_string, s12, "str_please_s65_"),
      (else_try),
        (str_clear, s12),
      (try_end),
    ],
    "{s12}I want to have {s1} for myself. (fiefs: {s0})", "center_captured_lord_advice_2",
    [
      (assign, "$temp", "trp_player"),
  ]],
  
  [anyone|plyr, "center_captured_lord_advice",
    [
      (call_script, "script_print_troop_owned_centers_in_numbers_to_s0", "$g_talk_troop"),
      (str_store_party_name, s1, "$g_center_taken_by_player_faction"),
      (is_between, "$g_talk_troop", pretenders_begin, pretenders_end),
    ],
    "{s66}, you should have {s1} for yourself. (fiefs: {s0})", "center_captured_lord_advice_2",
    [
      (assign, "$temp", "$g_talk_troop"),
  ]],
  
  
  [anyone, "center_captured_lord_advice_2",
    [
      (eq, "$g_talk_troop", "$g_player_minister"),
    ],
    "As you wish, {sire/my lady}. {reg6?I:{reg7?You:{s11}}} will be the new {reg3?lady:lord} of {s1}.", "minister_issues",
    [
      (assign, ":new_owner", "$temp"),
      
      (call_script, "script_give_center_to_lord", "$g_center_taken_by_player_faction", ":new_owner", 0),
      
      (try_begin),
        (faction_slot_eq, "$players_kingdom", slot_faction_political_issue, "$g_center_taken_by_player_faction"),
        (faction_set_slot, "$players_kingdom", slot_faction_political_issue, -1),
      (try_end),
      
      (try_begin),
        (neq, ":new_owner", "trp_player"),
        (try_for_range, ":unused", 0, 4),
          (call_script, "script_cf_reinforce_party", "$g_center_taken_by_player_faction"),
        (try_end),
      (try_end),
      
      (assign, reg6, 0),
      (assign, reg7, 0),
      (try_begin),
        (eq, ":new_owner", "$g_talk_troop"),
        (assign, reg6, 1),
      (else_try),
        (eq, ":new_owner", "trp_player"),
        (assign, reg7, 1),
      (else_try),
        (str_store_troop_name, s11, ":new_owner"),
      (try_end),
      (str_store_party_name, s1, "$g_center_taken_by_player_faction"),
      (troop_get_type, reg3, ":new_owner"),
      (assign, "$g_center_taken_by_player_faction", -1),
  ]],
  
  
  
  [anyone, "center_captured_lord_advice_2",
    [
    ],
    "Hmmm. All right, {playername}. I value your counsel highly. {reg6?I:{reg7?You:{s11}}} will be the new {reg3?lady:lord} of {s1}.", "close_window",
    [
      (assign, ":new_owner", "$temp"),
      
      (troop_set_slot, ":new_owner", slot_lord_recruitment_argument, 0),
      
      (call_script, "script_give_center_to_lord", "$g_center_taken_by_player_faction", ":new_owner", 0),
      (try_begin),
        (faction_slot_eq, "$players_kingdom", slot_faction_political_issue, "$g_center_taken_by_player_faction"),
        (faction_set_slot, "$players_kingdom", slot_faction_political_issue, -1),
      (try_end),
      
      (try_begin),
        (neq, ":new_owner", "trp_player"),
        (try_for_range, ":unused", 0, 4),
          (call_script, "script_cf_reinforce_party", "$g_center_taken_by_player_faction"),
        (try_end),
      (try_end),
      
      (assign, reg6, 0),
      (assign, reg7, 0),
      (try_begin),
        (eq, ":new_owner", "$g_talk_troop"),
        (assign, reg6, 1),
      (else_try),
        (eq, ":new_owner", "trp_player"),
        (assign, reg7, 1),
      (else_try),
        (str_store_troop_name, s11, ":new_owner"),
      (try_end),
      (str_store_party_name, s1, "$g_center_taken_by_player_faction"),
      (troop_get_type, reg3, ":new_owner"),
      (assign, "$g_center_taken_by_player_faction", -1),
  ]],
  
  
  
  [anyone, "event_triggered", [
      (eq, "$g_infinite_camping", 0),
      (store_conversation_troop, "$map_talk_troop"),
      (is_between, "$map_talk_troop", companions_begin, companions_end),
      (eq, "$map_talk_troop", "$npc_is_quitting"),
      (troop_get_slot, ":honorific", "$map_talk_troop", slot_troop_honorific),
      (str_store_string, 5, ":honorific")],
    "Excuse me {s5} -- there is something I need to tell you.", "companion_quitting", [
      (assign, "$npc_is_quitting", 0),
      (assign, "$player_can_persuade_npc", 1),
      (assign, "$player_can_refuse_npc_quitting", 1),
  ]],
  
  ### This is also where the dialogue jumps if the player initiates quitting dialogue and the companion has low morale
  [anyone, "companion_quitting", [
      (store_conversation_troop, "$map_talk_troop"),
      (troop_get_slot, ":speech", "$map_talk_troop", slot_troop_retirement_speech),
      (str_store_string, 5, ":speech")
    ],
    "{s5}", "companion_quitting_2", [
  ]],
  
  ## The companion explains his/her reasons for quitting
  [anyone, "companion_quitting_2", [
      (call_script, "script_npc_morale", "$map_talk_troop"),
    ],
    "To tell you the truth, {s21}", "companion_quitting_response", [
  ]],
  
  [anyone|plyr, "companion_quitting_response", [
      ], "Very well. You be off, then.", "companion_quitting_yes", [
  ]],
  
  [anyone|plyr, "companion_quitting_response", [
      (eq, "$player_can_persuade_npc", 1),
      ], "Perhaps I can persuade you to change your mind.", "companion_quitting_persuasion", [
      (assign, "$player_can_persuade_npc", 0),
  ]],
  
  [anyone, "companion_quitting_persuasion", [
      (store_random_in_range, ":random", -2, 13),
      (store_skill_level, ":persuasion", "skl_persuasion", "trp_player"),
      (le, ":random", ":persuasion"),
    ],
    "Hm. When you put it like that, I suppose I can stay a while longer, see if things improve.", "close_window",
    [
      (troop_get_slot, ":morality_penalties", "$map_talk_troop", slot_troop_morality_penalties),
      (val_div, ":morality_penalties", 2),
      (troop_set_slot, "$map_talk_troop", slot_troop_morality_penalties, ":morality_penalties"),
      
      (troop_get_slot, ":personalityclash_penalties", "$map_talk_troop", slot_troop_personalityclash_penalties),
      (val_div, ":personalityclash_penalties", 2),
      (troop_set_slot, "$map_talk_troop", slot_troop_personalityclash_penalties, ":personalityclash_penalties"),
  ]],
  
  [anyone, "companion_quitting_persuasion", [
    ],
    "I'm sorry, but I don't see your point. I am leaving whether you like it or not.", "companion_quitting_response",
    [
  ]],
  
  [anyone|plyr, "companion_quitting_response", [
      (eq, 1, 0),
      (eq, "$player_can_refuse_npc_quitting", 1),
      ], "We hang deserters in this company.", "companion_quitting_no", [
  ]],
  
  [anyone, "companion_quitting_no", [],
    "Oh... Right... Do you mean that?", "companion_quitting_no_confirm", [
  ]],
  
  [anyone|plyr, "companion_quitting_no_confirm", [],
    "Absolutely. You either leave this company by my command, or are carried out on your shield.", "companion_quitting_no_confirmed", [
  ]],
  
  [anyone|plyr, "companion_quitting_no_confirm", [],
    "No, actually I don't mean that. You are free to leave.", "companion_quitting_yes", [
  ]],
  
  [anyone, "companion_quitting_yes", [
    ],
    "Then this is goodbye. Perhaps I'll see you around, {playername}.", "close_window", [
      (troop_set_slot, "$map_talk_troop", slot_troop_playerparty_history, pp_history_quit),
      (call_script, "script_retire_companion", "$map_talk_troop", 100),
  ]],
  
  [anyone, "companion_quitting_no_confirmed", [
    ],
    "Hm. I suppose I'm staying, then.", "close_window", [
  ]],
  
  
  #Morality objections
  [anyone, "event_triggered", [
      (store_conversation_troop, "$map_talk_troop"),
      (is_between, "$map_talk_troop", companions_begin, companions_end),
      
      (eq, "$map_talk_troop", "$npc_with_grievance"),
      (eq, "$npc_map_talk_context", slot_troop_morality_state),
      
      
      (try_begin),
        (eq, "$npc_grievance_slot", slot_troop_morality_state),
        (troop_get_slot, ":speech", "$map_talk_troop", slot_troop_morality_speech),
      (else_try),
        (troop_get_slot, ":speech", "$map_talk_troop", slot_troop_2ary_morality_speech),
      (try_end),
      (str_store_string, 21, "$npc_grievance_string"),
      (str_store_string, 5, ":speech"),
    ],
    "{s5}", "companion_objection_response", [
      (assign, "$npc_with_grievance", 0),
  ]],
  
  
  
  [anyone|plyr, "companion_objection_response", [
      (eq, "$npc_praise_not_complaint", 1),
      ], "Thanks, I appreciate your support.", "close_window", [
      (troop_set_slot, "$map_talk_troop", "$npc_grievance_slot", tms_acknowledged),
  ]],
  
  [anyone|plyr, "companion_objection_response", [
      (eq, "$npc_praise_not_complaint", 0),
      ], "Hopefully it won't happen again.", "close_window", [
      (troop_set_slot, "$map_talk_troop", "$npc_grievance_slot", tms_acknowledged),
  ]],
  
  [anyone|plyr, "companion_objection_response", [
      (eq, "$npc_praise_not_complaint", 0),
      ],  "Your objection is noted. Now fall back in line.", "close_window", [
      (troop_set_slot, "$map_talk_troop", "$npc_grievance_slot", tms_dismissed),
      (troop_get_slot, ":grievance", "$map_talk_troop", slot_troop_morality_penalties),
      (val_add, ":grievance", 10),
      (troop_set_slot, "$map_talk_troop", slot_troop_morality_penalties, ":grievance"),
  ]],
  
  
  ##  [anyone|plyr, "companion_objection_response", [
  ##      ],  "I prefer my followers to keep their opinions to themselves.", "close_window", [
  ##                    (troop_set_slot, "$map_talk_troop", "$npc_grievance_slot", tms_dismissed),
  ##                    (troop_get_slot, ":grievance", "$map_talk_troop", slot_troop_morality_penalties),
  ##                    (val_add, ":grievance", 10),
  ##                    (troop_set_slot, "$map_talk_troop", slot_troop_morality_penalties, ":grievance"),
  ##                    (assign, "$disable_npc_complaints", 1),
  ##          ]],
  
  
  
  # Personality clash 2 objections
  [anyone, "event_triggered", [
      (store_conversation_troop, "$map_talk_troop"),
      (is_between, "$map_talk_troop", companions_begin, companions_end),
      
      (eq, "$map_talk_troop", "$npc_with_personality_clash_2"),
      (eq, "$npc_map_talk_context", slot_troop_personalityclash2_state),
      
      (troop_get_slot, ":speech", "$map_talk_troop", slot_troop_personalityclash2_speech),
      (troop_get_slot, ":object", "$map_talk_troop", slot_troop_personalityclash2_object),
      (str_store_troop_name, 11, ":object"),
      (str_store_string, 5, ":speech"),
    ],
    "{s5}", "companion_personalityclash2_b", [
      (assign, "$npc_with_personality_clash_2", 0),
      (troop_get_slot, ":grievance", "$map_talk_troop", slot_troop_personalityclash_penalties),
      (val_add, ":grievance", 5),
      (troop_set_slot, "$map_talk_troop", slot_troop_personalityclash_penalties, ":grievance"),
      
      (troop_get_slot, ":object", "$map_talk_troop", slot_troop_personalityclash2_object),
      (call_script, "script_troop_change_relation_with_troop", "$map_talk_troop", ":object", -15),
  ]],
  
  [anyone, "companion_personalityclash2_b", [
      ],  "{s5}", "companion_personalityclash2_response", [
      (troop_get_slot, ":speech", "$map_talk_troop", slot_troop_personalityclash2_speech_b),
      (troop_get_slot, ":object", "$map_talk_troop", slot_troop_personalityclash2_object),
      (str_store_troop_name, 11, ":object"),
      (str_store_string, 5, ":speech"),
  ]],
  
  
  
  [anyone|plyr, "companion_personalityclash2_response", [
      (troop_get_slot, ":object", "$map_talk_troop", slot_troop_personalityclash2_object),
      (str_store_troop_name, s11, ":object"),
      (troop_get_type, reg11, ":object"),
      ],  "{s11} is a valuable member of this company. I don't want you picking any more fights with {reg11?her:him}.", "close_window", [
      (troop_set_slot, "$map_talk_troop", slot_troop_personalityclash2_state, pclash_penalty_to_self),
  ]],
  
  [anyone|plyr, "companion_personalityclash2_response", [
      (troop_get_slot, ":object", "$map_talk_troop", slot_troop_personalityclash2_object),
      (str_store_troop_name, s11, ":object"),
      (troop_get_type, reg11, ":object"),
      ],  "Tell {s11} you have my support in this, and {reg11?she:he} should hold {reg11?her:his} tongue.", "close_window", [
      (troop_set_slot, "$map_talk_troop", slot_troop_personalityclash2_state, pclash_penalty_to_other),
  ]],
  
  [anyone|plyr, "companion_personalityclash2_response", [
      ],  "I don't have time for your petty dispute. Do not bother me with this again.", "close_window", [
      (troop_set_slot, "$map_talk_troop", slot_troop_personalityclash2_state, pclash_penalty_to_both),
  ]],
  
  
  ##  [anyone|plyr, "companion_personalityclash2_response", [
  ##      ],  "Your grievance is noted. Now fall back in line.", "close_window", [
  ##                    (troop_set_slot, "$map_talk_troop", slot_troop_personalityclash2_state, 1),
  ##          ]],
  
  ##  [anyone|plyr, "companion_personalityclash2_response", [
  ##      ],  "I prefer my followers to keep their opinions to themselves.", "close_window", [
  ##                    (troop_set_slot, "$map_talk_troop", slot_troop_personalityclash2_state, 1),
  ##                    (assign, "$disable_npc_complaints", 1),
  ##          ]],
  
  
  
  
  # Personality clash objections
  
  [anyone, "event_triggered", [
      (store_conversation_troop, "$map_talk_troop"),
      (is_between, "$map_talk_troop", companions_begin, companions_end),
      
      (eq, "$map_talk_troop", "$npc_with_personality_clash"),
      (eq, "$npc_map_talk_context", slot_troop_personalityclash_state),
      
      (troop_get_slot, ":speech", "$map_talk_troop", slot_troop_personalityclash_speech),
      (troop_get_slot, ":object", "$map_talk_troop", slot_troop_personalityclash_object),
      (str_store_troop_name, 11, ":object"),
      (str_store_string, 5, ":speech"),
    ],
    "{s5}", "companion_personalityclash_b", [
      (assign, "$npc_with_personality_clash", 0),
      (troop_get_slot, ":grievance", "$map_talk_troop", slot_troop_personalityclash_penalties),
      (val_add, ":grievance", 5),
      (troop_set_slot, "$map_talk_troop", slot_troop_personalityclash_penalties, ":grievance"),
      
      (troop_get_slot, ":object", "$map_talk_troop", slot_troop_personalityclash_object),
      (call_script, "script_troop_change_relation_with_troop", "$map_talk_troop", ":object", -15),
      
  ]],
  
  [anyone, "companion_personalityclash_b", [
      ],  "{s5}", "companion_personalityclash_response", [
      (troop_get_slot, ":speech", "$map_talk_troop", slot_troop_personalityclash_speech_b),
      (troop_get_slot, ":object", "$map_talk_troop", slot_troop_personalityclash_object),
      (str_store_troop_name, 11, ":object"),
      (str_store_string, 5, ":speech"),
  ]],
  
  [anyone|plyr, "companion_personalityclash_response", [
      (troop_get_slot, ":object", "$map_talk_troop", slot_troop_personalityclash_object),
      (str_store_troop_name, s11, ":object"),
      (troop_get_type, reg11, ":object"),
      ],  "{s11} is a capable member of this company. I don't want you picking any more fights with {reg11?her:him}.", "close_window", [
      (troop_set_slot, "$map_talk_troop", slot_troop_personalityclash_state, pclash_penalty_to_self),
  ]],
  
  [anyone|plyr, "companion_personalityclash_response", [
      (troop_get_slot, ":object", "$map_talk_troop", slot_troop_personalityclash_object),
      (str_store_troop_name, s11, ":object"),
      (troop_get_type, reg11, ":object"),
      ],  "Tell {s11} you have my support in this, and {reg11?she:he} should hold {reg11?her:his} tongue.", "close_window", [
      (troop_set_slot, "$map_talk_troop", slot_troop_personalityclash_state, pclash_penalty_to_other),
  ]],
  
  [anyone|plyr, "companion_personalityclash_response", [
      ],  "I don't have time for your petty dispute. Do not bother me with this again.", "close_window", [
      (troop_set_slot, "$map_talk_troop", slot_troop_personalityclash_state, pclash_penalty_to_both),
  ]],
  
  
  ##  [anyone|plyr, "companion_personalityclash_response", [
  ##      ],  "Your grievance is noted. Now fall back in line.", "close_window", [
  ##                    (troop_set_slot, "$map_talk_troop", slot_troop_personalityclash_state, 1),
  ##          ]],
  
  ##  [anyone|plyr, "companion_personalityclash_response", [
  ##      ],  "I prefer my followers to keep their opinions to themselves.", "close_window", [
  ##                    (troop_set_slot, "$map_talk_troop", slot_troop_personalityclash_state, 1),
  ##                    (assign, "$disable_npc_complaints", 1),
  ##          ]],
  
  
  
  # Personality match
  
  [anyone, "event_triggered", [
      (eq, "$npc_map_talk_context", slot_troop_personalitymatch_state),
      (store_conversation_troop, "$map_talk_troop"),
      (is_between, "$map_talk_troop", companions_begin, companions_end),
      
      (eq, "$map_talk_troop", "$npc_with_personality_match"),
      
      (troop_get_slot, ":speech", "$map_talk_troop", slot_troop_personalitymatch_speech),
      (troop_get_slot, ":object", "$map_talk_troop", slot_troop_personalitymatch_object),
      (str_store_troop_name, 11, ":object"),
      (str_store_string, 5, ":speech"),
      
    ],
    "{s5}", "companion_personalitymatch_b", [
      (assign, "$npc_with_personality_match", 0),
      (troop_get_slot, ":object", "$map_talk_troop", slot_troop_personalitymatch_object),
      (call_script, "script_troop_change_relation_with_troop", "$map_talk_troop", ":object", 15),
      
  ]],
  
  [anyone, "companion_personalitymatch_b", [
      (troop_get_slot, ":speech", "$map_talk_troop", slot_troop_personalitymatch_speech_b),
      (troop_get_slot, ":object", "$map_talk_troop", slot_troop_personalitymatch_object),
      (str_store_troop_name, 11, ":object"),
      (str_store_string, 5, ":speech"),
      
    ],
    "{s5}", "companion_personalitymatch_response", [
  ]],
  
  
  [anyone|plyr, "companion_personalitymatch_response", [
      ],  "Very good.", "close_window", [
      (troop_set_slot, "$map_talk_troop", slot_troop_personalitymatch_state, 1),
      
  ]],
  
  
  
  ##  [anyone|plyr, "companion_personalitymatch_response", [
  ##      ],  "I prefer my followers to keep their opinions to themselves.", "close_window", [
  ##                    (troop_set_slot, "$map_talk_troop", slot_troop_personalitymatch_state, 1),
  ##                    (assign, "$disable_npc_complaints", 1),
  ##          ]],
  
  [anyone, "event_triggered", [
      (eq, "$npc_map_talk_context", slot_troop_woman_to_woman_string),
      (store_conversation_troop, "$map_talk_troop"),
      (is_between, "$map_talk_troop", companions_begin, companions_end),
      
      (store_sub, ":npc_no", "$map_talk_troop", "trp_npc1"),
      (store_add, ":speech", "str_npc1_woman_to_woman", ":npc_no"),
      #                     (troop_get_slot, ":speech", "$map_talk_troop", slot_troop_woman_to_woman_string),
      (str_store_string, s5, ":speech"),
    ],
    "{s5}", "companion_sisterly_advice", [
      (troop_set_slot, "$map_talk_troop", slot_troop_woman_to_woman_string, -1),
      (assign, "$npc_with_sisterly_advice", 0),
  ]],
  
  [anyone|plyr, "companion_sisterly_advice", [
      ],  "Thank you.", "close_window", [
  ]],
  
  [anyone|plyr, "companion_sisterly_advice", [
      ],  "I would prefer not to discuss such things.", "close_window", [
      (assign, "$disable_sisterly_advice", 1),
  ]],
  
  
  
  [anyone, "event_triggered", [
      (eq, "$g_infinite_camping", 0),
      (eq, "$npc_map_talk_context", slot_troop_home),
      (store_conversation_troop, "$map_talk_troop"),
      (is_between, "$map_talk_troop", companions_begin, companions_end),
      
      (troop_get_slot, ":speech", "$map_talk_troop", slot_troop_home_intro),
      (str_store_string, s5, ":speech"),
    ],
    "{s5}", "companion_home_description", [
      (troop_set_slot, "$map_talk_troop", slot_troop_home_speech_delivered, 1),
  ]],
  
  [anyone|plyr, "companion_home_description", [
      ],  "Tell me more.", "companion_home_description_2", [
  ]],
  
  [anyone|plyr, "companion_home_description", [
      ],  "We don't have time to chat just now.", "close_window", [
  ]],
  
  [anyone|plyr, "companion_home_description", [
      ],  "I prefer my companions not to bother me with such trivialities.", "close_window", [
      (assign, "$disable_local_histories", 1),
  ]],
  
  
  [anyone, "companion_home_description_2", [
      (troop_get_slot, ":speech", "$map_talk_troop", slot_troop_home_description),
      (str_store_string, 5, ":speech"),
      ],  "{s5}", "companion_home_description_3", [
  ]],
  
  [anyone, "companion_home_description_3", [
      (troop_get_slot, ":speech", "$map_talk_troop", slot_troop_home_description_2),
      (str_store_string, 5, ":speech"),
      ],  "{s5}", "close_window", [
  ]],
  
  [anyone,"event_triggered", [
      (eq, "$talk_context", tc_rebel_thanks),
      (store_conversation_troop, "$g_talk_troop"),
      (is_between, "$g_talk_troop", pretenders_begin, pretenders_end),
      
      (troop_get_slot, ":old_faction", "$g_talk_troop", slot_troop_original_faction),
      (str_store_faction_name, s3, ":old_faction"),
      (str_store_string, s6, "@{playername}, when we started our long walk, few people had the courage to support me. " +
        "And fewer still would be willing to put their lives at risk for my cause. " +
        "But you didn't hesitate for a moment in throwing yourself at my enemies. " +
        "We have gone through a lot together, and there were times I came close to losing all hope. " +
        "But with God's help, we prevailed. It is now time for me to leave your company and take what's rightfully mine. " +
        "From now on, I will carry out the great responsibility of ruling {s3}. " +
        "There still lie many challanges ahead and I count on your help in overcoming those. " +
      "And of course, you will always remain as my foremost vassal."),
    ],
    "{s6}", "rebel_thanks_answer",
    [
      
      (unlock_achievement, ACHIEVEMENT_KINGMAKER),
      (call_script, "script_end_quest", "qst_rebel_against_kingdom"),
  ]],
  
  [anyone|plyr,"rebel_thanks_answer", [], "It was an honour to fight for your cause, {reg65?madame:my lord}.", "rebel_thanks_answer_2", []],
  [anyone|plyr,"rebel_thanks_answer", [], "You will always have my loyal support, {reg65?my lady:sir}.", "rebel_thanks_answer_2", []],
  
  [anyone,"rebel_thanks_answer_2", [], "I will miss living this life of adventure with you, but my duties await me. So... farewell for now, {playername}. " +
    "I hope I'll see you again soon.", "close_window", []],
  
  
  
  [anyone, "event_triggered", [
      (store_conversation_troop, "$map_talk_troop"),
      (is_between, "$map_talk_troop", companions_begin, companions_end),
      
      (eq, "$map_talk_troop", "$npc_with_political_grievance"),
      (eq, "$npc_map_talk_context", slot_troop_kingsupport_objection_state),
      
      (store_sub, ":npc_no", "$g_talk_troop", "trp_npc1"),
      (store_add, ":string", "str_npc1_kingsupport_objection", ":npc_no"),
      #					 (troop_get_slot, ":string", "$map_talk_troop", slot_troop_kingsupport_objection_string),
      (str_store_string, 21, ":string"),
    ],
    "{s21}", "companion_political_grievance_response", [
      (assign, "$npc_with_political_grievance", 0),
      (troop_set_slot, "$map_talk_troop", slot_troop_kingsupport_objection_state, 2),
      
  ]],
  
  [anyone|plyr, "companion_political_grievance_response", [
      #                    (eq, "$npc_praise_not_complaint", 0),
      ],  "Your opinion is noted.", "close_window", [
      (troop_get_slot, ":grievance", "$map_talk_troop", slot_troop_morality_penalties),
      (val_add, ":grievance", 25),
      (troop_set_slot, "$map_talk_troop", slot_troop_morality_penalties, ":grievance"),
  ]],
  
  
  
  [anyone, "event_triggered", [
      (store_conversation_troop, "$map_talk_troop"),
      (is_between, "$map_talk_troop", companions_begin, companions_end),
      
      (eq, "$map_talk_troop", "$npc_to_rejoin_party"),
      (troop_slot_eq, "$map_talk_troop", slot_troop_current_mission, npc_mission_rejoin_when_possible),
      (troop_slot_eq, "$map_talk_troop", slot_troop_occupation, slto_player_companion),
      (troop_get_slot, ":string", "$map_talk_troop", slot_troop_honorific),
      (str_store_string, 21, ":string"),
    ],
    "Greetings, {s21}. Are you ready for me to rejoin you?"	,
    "companion_rejoin_response",
    [
      (assign, "$npc_to_rejoin_party", 0),
  ]],
  
  [anyone, "event_triggered", [
      (store_conversation_troop, "$map_talk_troop"),
      (is_between, "$map_talk_troop", companions_begin, companions_end),
      
      (eq, "$map_talk_troop", "$npc_to_rejoin_party"),
      #                     (eq, "$npc_map_talk_context", slot_troop_days_on_mission),
      (troop_slot_eq, "$g_talk_troop", slot_troop_current_mission, npc_mission_kingsupport),
      
      (troop_get_slot, ":string", "$map_talk_troop", slot_troop_honorific),
      (str_store_string, 21, ":string"),
    ],
    "Well, {s21}, at last I've found you. I've been out spreading the word about your claim, and am now ready to rejoin the company.", "companion_rejoin_response", [
      (assign, "$npc_to_rejoin_party", 0),
      (call_script, "script_change_player_right_to_rule", 3),
      (troop_set_slot, "$g_talk_troop", slot_troop_kingsupport_state, 1),
      
      (try_begin),
        (is_between, "$player_right_to_rule", 10, 15),
        (call_script, "script_add_log_entry", logent_player_claims_throne_1, "trp_player", 0, 0, 0),
      (else_try),
        (is_between, "$player_right_to_rule", 20, 25),
        (call_script, "script_add_log_entry", logent_player_claims_throne_2, "trp_player", 0, 0, 0),
      (try_end),
  ]],
  
  
  [anyone, "event_triggered", [
      (store_conversation_troop, "$map_talk_troop"),
      (is_between, "$map_talk_troop", companions_begin, companions_end),
      (eq, "$map_talk_troop", "$npc_to_rejoin_party"),
      #                     (eq, "$npc_map_talk_context", slot_troop_days_on_mission),
      (troop_slot_eq, "$map_talk_troop", slot_troop_current_mission, npc_mission_gather_intel),
      
      (troop_get_slot, ":string", "$map_talk_troop", slot_troop_honorific),
      (str_store_string, 21, ":string"),
      
      (troop_get_slot, ":town_with_contacts", "$map_talk_troop", slot_troop_town_with_contacts),
      (store_faction_of_party, ":town_faction", ":town_with_contacts"),
      
      (call_script, "script_update_faction_political_notes", ":town_faction"),
      (assign, ":instability_index", reg0),
      (val_add, ":instability_index", reg0),
      (val_add, ":instability_index", reg1),
      
      
      (str_store_faction_name, s12, ":town_faction"),
      (try_begin),
        (gt, ":instability_index", 60),
        (str_store_string, s11, "str_the_s12_is_a_labyrinth_of_rivalries_and_grudges_lords_ignore_their_lieges_summons_and_many_are_ripe_to_defect"),
      (else_try),
        (is_between, ":instability_index", 40, 60),
        (str_store_string, s11, "str_the_s12_is_shaky_many_lords_do_not_cooperate_with_each_other_and_some_might_be_tempted_to_defect_to_a_liege_that_they_consider_more_worthy"),
      (else_try),
        (is_between, ":instability_index", 20, 40),
        (str_store_string, s11, "str_the_s12_is_fairly_solid_some_lords_bear_enmities_for_each_other_but_they_tend_to_stand_together_against_outside_enemies"),
      (else_try),
        (lt, ":instability_index", 20),
        (str_store_string, s11, "str_the_s12_is_a_rock_of_stability_politically_speaking_whatever_the_lords_may_think_of_each_other_they_fight_as_one_against_the_common_foe"),
      (try_end),
      
      (try_for_range, ":lord", active_npcs_begin, active_npcs_end),
        (troop_slot_eq, ":lord", slot_troop_occupation, slto_kingdom_hero),
        (store_faction_of_troop, ":lord_faction", ":lord"),
        (eq, ":lord_faction", ":town_faction"),
        (call_script, "script_update_troop_political_notes", ":lord"),
      (try_end),
      
    ],
    "Well, {s21}, at last I've found you. {s11}. The rest of my report I submit to you in writing.", "companion_rejoin_response", [
  ]],
  
  
  
  [anyone, "event_triggered", [
      (store_conversation_troop, "$map_talk_troop"),
      (is_between, "$map_talk_troop", companions_begin, companions_end),
      
      (eq, "$map_talk_troop", "$npc_to_rejoin_party"),
      #                     (eq, "$npc_map_talk_context", slot_troop_days_on_mission),
      (troop_get_slot, ":mission", "$g_talk_troop", slot_troop_current_mission),
      (this_or_next|eq, ":mission", npc_mission_peace_request),
      (this_or_next|eq, ":mission", npc_mission_pledge_vassal),
      (this_or_next|eq, ":mission", npc_mission_test_waters),
      (this_or_next|eq, ":mission", npc_mission_non_aggression),
      (eq, ":mission", npc_mission_seek_recognition),
      
      (troop_get_slot, ":string", "$map_talk_troop", slot_troop_honorific),
      (str_store_string, 21, ":string"),
      (troop_get_slot, ":mission_object", "$g_talk_troop", slot_troop_mission_object),
      (str_store_faction_name, s31, ":mission_object"),
      
      (call_script, "script_npc_decision_checklist_peace_or_war", ":mission_object", "fac_player_supporters_faction", "$g_talk_troop"),
      (assign, "$g_mission_result", reg0),
      
      
    ],
    "Well, {s21}, at last I've found you. I have returned from my mission to {s31}. In general, I would say, {s14}.","companion_embassy_results", [
  ]],
  
  [anyone, "companion_embassy_results", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_current_mission, npc_mission_seek_recognition),
      (troop_get_slot, ":mission_object", "$g_talk_troop", slot_troop_mission_object),
      
      (this_or_next|ge, "$g_mission_result", 2),
      (faction_slot_eq, ":mission_object", slot_faction_recognized_player, 1),
      
      (is_between, "$g_player_court", centers_begin, centers_end),
      
      (faction_get_slot, ":emissary_object", ":mission_object", slot_faction_leader),
      (str_store_troop_name, s12, ":emissary_object"),
      (neg|party_slot_eq, "$g_player_court", slot_center_original_faction, ":mission_object"),
      (str_store_party_name, s4, "$g_player_court"),
    ],
    "In this letter, {s12} addresses you as {Lord/Lady} of {s4}, which implies some sort of recognition that you are a sovereign and independent monarch.","companion_rejoin_response", [
      (troop_get_slot, ":mission_object", "$g_talk_troop", slot_troop_mission_object),
      (try_begin),
        (faction_slot_eq, ":mission_object", slot_faction_recognized_player, 0),
        (faction_set_slot, ":mission_object", slot_faction_recognized_player, 1),
        (call_script, "script_change_player_right_to_rule", 10),
      (try_end),
  ]],
  
  
  
  [anyone, "companion_embassy_results", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_current_mission, npc_mission_seek_recognition),
      (troop_get_slot, ":mission_object", "$g_talk_troop", slot_troop_mission_object),
      (faction_get_slot, ":emissary_object", ":mission_object", slot_faction_leader),
      (str_store_troop_name, s12, ":emissary_object"),
      
    ],
    "In his letter, {s12} merely refers to you as {playername}, omitting any title. This does not constitute recognition of your right to rule.","companion_rejoin_response", [
  ]],
  
  [anyone, "companion_embassy_results", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_current_mission, npc_mission_peace_request),
      (troop_get_slot, ":mission_object", "$g_talk_troop", slot_troop_mission_object),
      (faction_slot_ge, ":mission_object", slot_faction_truce_days_with_factions_begin, 1),
      (faction_get_slot, ":emissary_object", ":mission_object", slot_faction_leader),
      (str_store_troop_name, s12, ":emissary_object"),
      
    ],
    "{s12} says that your current truce should suffice.","companion_rejoin_response", [
  ]],
  
  
  [anyone, "companion_embassy_results", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_current_mission, npc_mission_peace_request),
      (ge, "$g_mission_result", 1),
      (troop_get_slot, ":mission_object", "$g_talk_troop", slot_troop_mission_object),
      (faction_get_slot, ":emissary_object", ":mission_object", slot_faction_leader),
      (str_store_troop_name, s12, ":emissary_object"),
      
    ],
    "{s12} says that he is willing to consider a truce of forty days.","companion_truce_confirm", [
  ]],
  
  [anyone, "companion_embassy_results", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_current_mission, npc_mission_peace_request),
      (troop_get_slot, ":mission_object", "$g_talk_troop", slot_troop_mission_object),
      (faction_get_slot, ":emissary_object", ":mission_object", slot_faction_leader),
      (str_store_troop_name, s12, ":emissary_object"),
      
    ],
    "{s12} says that he is unwilling to conclude a peace.","companion_rejoin_response", [
  ]],
  
  
  [anyone|plyr, "companion_truce_confirm", [
      (troop_get_slot, ":mission_object", "$g_talk_troop", slot_troop_mission_object),
      (str_store_faction_name, s4, ":mission_object"),
    ],
    "Very well - let this truce with the {s4} be concluded.","companion_rejoin_response", [
      (troop_get_slot, ":mission_object", "$g_talk_troop", slot_troop_mission_object),
      (call_script, "script_diplomacy_start_peace_between_kingdoms", ":mission_object", "$players_kingdom", 1),
      (str_store_faction_name, s4, ":mission_object"),
  ]],
  
  [anyone|plyr, "companion_truce_confirm", [],
    "On second thought, perhaps this is currently not in our interests.","companion_rejoin_response", [
  ]],
  
  
  [anyone, "companion_embassy_results", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_current_mission, npc_mission_pledge_vassal),
      #					(troop_get_slot, ":mission_object", "$g_talk_troop", slot_troop_mission_object),
      (this_or_next|check_quest_active, "qst_join_faction"),
      (is_between, "$players_kingdom", npc_kingdoms_begin, npc_kingdoms_end),
      (troop_get_slot, ":mission_object", "$g_talk_troop", slot_troop_mission_object),
      (faction_get_slot, ":emissary_object", ":mission_object", slot_faction_leader),
      (str_store_troop_name, s12, ":emissary_object"),
      
    ],
    "{s12} says that you are already pledged to another ruler.","companion_rejoin_response", [
  ]],
  
  [anyone, "companion_embassy_results", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_current_mission, npc_mission_pledge_vassal),
      #					(troop_get_slot, ":mission_object", "$g_talk_troop", slot_troop_mission_object),
      (lt, "$g_mission_result", -2),
      (troop_get_slot, ":mission_object", "$g_talk_troop", slot_troop_mission_object),
      (faction_get_slot, ":emissary_object", ":mission_object", slot_faction_leader),
      (str_store_troop_name, s12, ":emissary_object"),
      
    ],
    "{s12} says that he does not believe that you would honor your obligations as a vassal, and suspects that your offer is just a ploy.","companion_rejoin_response", [
  ]],
  
  [anyone, "companion_embassy_results", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_current_mission, npc_mission_pledge_vassal),
      (troop_get_slot, ":mission_object", "$g_talk_troop", slot_troop_mission_object),
      (faction_get_slot, ":emissary_object", ":mission_object", slot_faction_leader),
      (str_store_troop_name, s12, ":emissary_object"),
      
    ],
    "{s12} says that he accepts your offer of vassalage. He will give you 30 days to seek him out, in which time he will refrain from making war on you.","vassalage_offer_confirm", [
  ]],
  
  [anyone|plyr, "vassalage_offer_confirm", [],
    "Tell him that I accept his terms...", "companion_rejoin_response", [
      
      (troop_get_slot, "$g_invite_faction", "$g_talk_troop", slot_troop_mission_object),
      (faction_get_slot, "$g_invite_faction_lord", "$g_invite_faction", slot_faction_leader),
      
      (str_store_troop_name,s1,"$g_invite_faction_lord"),
      (setup_quest_text,"qst_join_faction"),
      
      (str_store_troop_name_link, s3, "$g_invite_faction_lord"),
      (str_store_faction_name_link, s4, "$g_invite_faction"),
      (quest_set_slot, "qst_join_faction", slot_quest_giver_troop, "$g_invite_faction_lord"),
      (quest_set_slot, "qst_join_faction", slot_quest_expiration_days, 30),
      
      (try_begin),
        (store_relation, ":relation", "$g_invite_faction", "fac_player_supporters_faction"),
        (lt, ":relation", 0),
        (call_script, "script_diplomacy_start_peace_between_kingdoms", "$g_invite_faction", "fac_player_supporters_faction", 0),
        (quest_set_slot, "qst_join_faction", slot_quest_failure_consequence, 1),
      (try_end),
      
      (str_store_string, s2, "@Find and speak with {s3} of {s4} to give him your oath of homage."),
      (call_script, "script_start_quest", "qst_join_faction", "$g_invite_faction_lord"),
      (call_script, "script_report_quest_troop_positions", "qst_join_faction", "$g_invite_faction_lord", 3),
  ]],
  
  
  
  
  
  
  
  [anyone|plyr, "companion_rejoin_response", [
      (hero_can_join, "p_main_party"),
      ],  "Welcome back, friend!", "close_window", [
      (party_add_members, "p_main_party", "$map_talk_troop", 1),
      (assign, "$npc_to_rejoin_party", 0),
      (troop_set_slot, "$map_talk_troop", slot_troop_current_mission, 0),
      (troop_set_slot, "$map_talk_troop", slot_troop_days_on_mission, 0),
  ]],
  
  [anyone|plyr, "companion_rejoin_response", [
      ],  "Unfortunately, I cannot take you back just yet.", "companion_rejoin_refused", [
      (troop_set_slot, "$map_talk_troop", slot_troop_current_mission, npc_mission_rejoin_when_possible),
      (troop_set_slot, "$map_talk_troop", slot_troop_days_on_mission, 0),
      (assign, "$npc_to_rejoin_party", 0),
  ]],
  
  [anyone, "companion_rejoin_refused", [
      ],  "As you wish. I will take care of some business, and try again in a few days.", "close_window", [
  ]],
  
  [anyone, "event_triggered", [
      (is_between, "$g_talk_troop", companions_begin, companions_end),
      (neg|troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
      (neg|main_party_has_troop, "$g_talk_troop"),
    ],
    "Would you have me rejoin you?", "companion_rejoin_response", [
  ]],
  
  #caravan merchants
  [anyone, "event_triggered",
    [(eq, "$caravan_escort_state",1),
      (eq, "$g_encountered_party","$caravan_escort_party_id"),
      (le, "$talk_context",tc_party_encounter),
      (store_distance_to_party_from_party, reg0, "$caravan_escort_destination_town", "$caravan_escort_party_id"),
      (lt, reg0, 5),
      (str_store_party_name, s3, "$caravan_escort_destination_town"),
      (assign, reg3, "$caravan_escort_agreed_reward"),
    ],
    "There! I can see the walls of {s3} in the distance. We've made it safely. " +
    "Here, take this purse of {reg3} denars, as I promised. I hope we can travel together again someday.", "close_window",
    [
      (assign,"$caravan_escort_state",0),
      (call_script, "script_troop_add_gold", "trp_player", "$caravan_escort_agreed_reward"),
      (assign,reg(4), "$caravan_escort_agreed_reward"),
      (val_mul,reg(4), 1),
      (add_xp_as_reward,reg(4)),
      (assign, "$g_leave_encounter",1),
  ]],
  
  [anyone, "event_triggered", [
    ],
    "{!}Sorry -- just talking to myself [ERROR- {s51}]", "close_window", [
  ]],
  
  
  
  
  
  
  #KINGDOM LORD DIALOGS BEGINS HERE
  
  
  
  
  #FEMALE PLAYER CHACTER WEDDING (also go to the feast, 'lift a glass' speeches for npc lords)
  #Feast not yet organized
  [anyone, "start", [
      (lt, "$talk_context", tc_siege_commander),
      
      (check_quest_active, "qst_wed_betrothed_female"),
      (quest_slot_eq, "qst_wed_betrothed_female", slot_quest_giver_troop, "$g_talk_troop"),
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_feast),
      
      (store_current_hours, ":hours_since_betrothal"),
      (troop_get_slot, ":betrothal_time", "$g_talk_troop", slot_troop_betrothal_time),
      (val_sub, ":hours_since_betrothal", ":betrothal_time"),
      (lt, ":hours_since_betrothal", 720), #30 days
      (str_clear, s12),
      (try_begin),
        (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_feast),
        (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_default),
        (str_store_string, s12, "@ We will of course need to wait until the realm is no longer on campaign."),
      (try_end),
    ],
    "My lady, I look forward to our marriage, as soon as there is an opportunity to hold a proper feast.{s12}", "lord_start", [
  ]],
  
  #Feast, but not at the venue
  [anyone, "start", [
      (lt, "$talk_context", tc_siege_commander),
      
      (check_quest_active, "qst_wed_betrothed_female"),
      (quest_slot_eq, "qst_wed_betrothed_female", slot_quest_giver_troop, "$g_talk_troop"),
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_feast),
      (faction_get_slot, ":feast_venue", "$g_talk_troop_faction", slot_faction_ai_object),
      (party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_holding_center),
      (party_slot_eq, "$g_talk_troop_party", slot_party_ai_object, ":feast_venue"),
      
      (neq, ":feast_venue", "$g_encountered_party"),
      (str_store_party_name, s4, ":feast_venue"),
    ],
    "My lady, if you wish to marry, we can proceed to the feast at {s4} to exchange vows before the lords of the realm.", "lord_start", [
  ]],
  
  #Over a month, and heading to a center
  [anyone, "start", [
      (lt, "$talk_context", tc_siege_commander),
      
      (check_quest_active, "qst_wed_betrothed_female"),
      (quest_slot_eq, "qst_wed_betrothed_female", slot_quest_giver_troop, "$g_talk_troop"),
      
      (store_current_hours, ":hours_since_betrothal"),
      (troop_get_slot, ":betrothal_time", "$g_talk_troop", slot_troop_betrothal_time),
      (val_sub, ":hours_since_betrothal", ":betrothal_time"),
      (ge, ":hours_since_betrothal", 720), #30 days
      
      (party_get_attached_to, ":attached", "$g_talk_troop_party"),
      (neg|is_between, ":attached", walled_centers_begin, walled_centers_end),
      
      (party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_holding_center),
      (party_get_slot, ":object", "$g_talk_troop_party", slot_party_ai_object),
      (str_store_party_name, s4, ":object"),
    ],
    "My lady, I grow tired of waiting for the lords of this realm to assemble. Come with me to {s4} exchange our vows.", "lord_start", [
  ]],
  
  #Over a month, but not in a center
  [anyone, "start", [
      (lt, "$talk_context", tc_siege_commander),
      (check_quest_active, "qst_wed_betrothed_female"),
      (quest_slot_eq, "qst_wed_betrothed_female", slot_quest_giver_troop, "$g_talk_troop"),
      
      (store_current_hours, ":hours_since_betrothal"),
      (troop_get_slot, ":betrothal_time", "$g_talk_troop", slot_troop_betrothal_time),
      (val_sub, ":hours_since_betrothal", ":betrothal_time"),
      (ge, ":hours_since_betrothal", 0), #30 days
      
      (party_get_attached_to, ":attached", "$g_talk_troop_party"),
      (neg|is_between, ":attached", walled_centers_begin, walled_centers_end),
      
    ],
    "My lady, I grow tired of waiting for the lords of this realm to assemble. Perhaps we should take the first opportunity to marry, in any great hall that is open to us.", "lord_start", [
  ]],
  
  [anyone, "start", [
      (lt, "$talk_context", tc_siege_commander),
      (check_quest_active, "qst_wed_betrothed_female"),
      (quest_slot_eq, "qst_wed_betrothed_female", slot_quest_giver_troop, "$g_talk_troop"),
      (this_or_next|neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_feast),
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_object, "$g_encountered_party"),
    ],
    "My lady, I have grown tired of waiting. Let us proceed with the vows immediately.", "lord_groom_vows", [
  ]],
  
  [anyone, "start", [
      (lt, "$talk_context", tc_siege_commander),
      (check_quest_active, "qst_wed_betrothed_female"),
      (quest_slot_eq, "qst_wed_betrothed_female", slot_quest_giver_troop, "$g_talk_troop"),
    ],
    "My lady, my eyes rejoice to see you. We may proceed with the vows.", "lord_groom_vows", [
  ]],
  
  [anyone, "lord_groom_vows", [
    ],
    "My lady, with this assembly as my witness, I vow to take you as my wife, to honor, cherish, and protect you. My the heavens bless us with health, prosperity, and children.", "female_pc_marriage_vow", [
  ]],
  
  [anyone|plyr, "female_pc_marriage_vow", [
    ],
    "I vow to take you as my husband.", "lord_groom_wedding_complete", [
      (call_script, "script_courtship_event_bride_marry_groom", "trp_player", "$g_talk_troop", 0),
      (call_script, "script_end_quest", "qst_wed_betrothed_female"),
  ]],
  
  [anyone|plyr, "female_pc_marriage_vow", [
    ],
    "Wait -- I need to think about this.", "close_window", [
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone, "lord_groom_wedding_complete", [
    ],
    "We are now husband and wife. Let the festivities commence!", "close_window",
    []],
  
  
  # KINGDOM LORD DUEL OUTCOMES
  [anyone,"start",
    [(eq, "$talk_context", tc_after_duel),
      (check_quest_active, "qst_denounce_lord"),
      (check_quest_succeeded, "qst_denounce_lord"),
      (quest_slot_eq, "qst_denounce_lord", slot_quest_target_troop, "$g_talk_troop"),
    ],
    "Very well. You've made your point. I have nothing more to say.", "close_window", [
      (call_script, "script_change_troop_renown", "trp_player", 10),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone,"start",
    [(eq, "$talk_context", tc_after_duel),
      (check_quest_active, "qst_denounce_lord"),
      (check_quest_failed, "qst_denounce_lord"),
      (quest_slot_eq, "qst_denounce_lord", slot_quest_target_troop, "$g_talk_troop"),
    ],
    "Well, {sir/my lady}! Please, do not trouble yourself to rise from the ground, as I would simply have to knock you down again. I shall take your silence as an apology. Good day to you.", "close_window", [
      (call_script, "script_change_troop_renown", "trp_player", -10),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  
  
  [anyone,"start",
    [(eq, "$talk_context", tc_after_duel),
      (assign, "$temp", 0),
      (try_begin),
        (check_quest_active, "qst_duel_avenge_insult"),
        (check_quest_succeeded, "qst_duel_avenge_insult"),
        (quest_slot_eq, "qst_duel_avenge_insult", slot_quest_target_troop, "$g_talk_troop"),
        (assign, "$temp", 1),
      (else_try),
        (check_quest_active, "qst_duel_for_lady"),
        (check_quest_succeeded, "qst_duel_for_lady"),
        (quest_slot_eq, "qst_duel_for_lady", slot_quest_target_troop, "$g_talk_troop"),
        (assign, "$temp", 2),
      (try_end),
      (gt, "$temp", 0),
    ],
    "Very well. You've made your point. I retract what I said. I hope you have obtained satisfaction.", "close_window", [
      (try_begin),
        (eq, "$temp", 1),
        (call_script, "script_change_troop_renown", "trp_player", 10),
        (call_script, "script_end_quest", "qst_duel_avenge_insult"),
      (try_end),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone,"start",
    [(eq, "$talk_context", tc_after_duel),
      (assign, "$temp", 0),
      (try_begin),
        (check_quest_active, "qst_duel_avenge_insult"),
        (check_quest_failed, "qst_duel_avenge_insult"),
        (quest_slot_eq, "qst_duel_avenge_insult", slot_quest_target_troop, "$g_talk_troop"),
        (assign, "$temp", 1),
      (else_try),
        (check_quest_active, "qst_duel_for_lady"),
        (check_quest_failed, "qst_duel_for_lady"),
        (quest_slot_eq, "qst_duel_for_lady", slot_quest_target_troop, "$g_talk_troop"),
        (assign, "$temp", 2),
      (try_end),
      (gt, "$temp", 0),
    ],
    "Hah! Not so gallant now, are we? Now trouble me no more.", "close_window", [
      (try_begin),
        (eq, "$temp", 1),
        (call_script, "script_change_troop_renown", "trp_player", -10),
        (call_script, "script_end_quest", "qst_duel_avenge_insult"),
      (try_end),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone,"start",
    [(eq, "$talk_context", tc_after_duel),
      (check_quest_active, "qst_duel_courtship_rival"),
      (check_quest_succeeded, "qst_duel_courtship_rival"),
      (quest_slot_eq, "qst_duel_courtship_rival", slot_quest_target_troop, "$g_talk_troop"),
      (quest_get_slot, ":duel_object", "qst_duel_courtship_rival", slot_quest_giver_troop),
      (str_store_troop_name, s10, ":duel_object"),
    ],
    "Very well -- you have won. Let all those present today witness that you have defeated me, and I shall abandon my suit of {s10}. Are you satisfied, you heartless bastard?", "close_window", [
      (quest_get_slot, ":duel_object", "qst_duel_courtship_rival", slot_quest_giver_troop),
      (call_script, "script_courtship_event_lady_break_relation_with_suitor", ":duel_object", "$g_talk_troop"),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  
  [anyone,"start",
    [(eq, "$talk_context", tc_after_duel),
      (check_quest_active, "qst_duel_courtship_rival"),
      (check_quest_failed, "qst_duel_courtship_rival"),
      (quest_slot_eq, "qst_duel_courtship_rival", slot_quest_target_troop, "$g_talk_troop"),
      (quest_get_slot, ":duel_object", "qst_duel_courtship_rival", slot_quest_giver_troop),
      (str_store_troop_name, s10, ":duel_object"),
    ],
    "Get up. Let all those present today witness that I have defeated you, and you are now bound to relinquish your suit of the {s10}. I will permit you one final visit, to make your farewells. After that, if you persist in attempting to see her, everyone shall know that you are a man of scant honor.", "close_window", [
      (assign, "$g_leave_encounter", 1),
  ]],
  
  
  
  [anyone,"start", [(eq, "$talk_context", tc_castle_commander)],
    "What do you want?", "player_siege_castle_commander_1", []],
  [anyone|plyr,"player_siege_castle_commander_1", [],
    "Surrender! Your situation is hopeless!", "player_siege_ask_surrender", []],
  [anyone|plyr,"player_siege_castle_commander_1", [], "Nothing. I'll leave you now.", "close_window", []],
  
  
  [anyone,"player_siege_ask_surrender", [(lt, "$g_enemy_strength", 100), (store_mul,":required_str","$g_enemy_strength",5),(ge, "$g_ally_strength", ":required_str")],
    "Perhaps... Do you give your word of honour that we'll be treated well?", "player_siege_ask_surrender_treatment", []],
  [anyone,"player_siege_ask_surrender", [(lt, "$g_enemy_strength", 200), (store_mul,":required_str","$g_enemy_strength",3),(ge, "$g_ally_strength", ":required_str")],
    "We are ready to leave this castle to you and march away if you give me your word of honour that you'll let us leave unmolested.", "player_siege_ask_leave_unmolested", []],
  [anyone,"player_siege_ask_surrender", [],
    "Surrender? Hah! We can hold these walls until we all die of old age.", "close_window", []],
  
  
  [anyone|plyr,"player_siege_ask_surrender_treatment", [],
    "I give you nothing. Surrender now or prepare to die!", "player_siege_ask_surrender_treatment_reject", []],
  [anyone,"player_siege_ask_surrender_treatment_reject", [],
    "Bastard. We will fight you to the last man!", "close_window", []],
  [anyone|plyr,"player_siege_ask_surrender_treatment", [],
    "You will be ransomed and your soldiers will live. I give you my word.", "player_siege_ask_surrender_treatment_accept", []],
  [anyone,"player_siege_ask_surrender_treatment_accept", [],
    "Very well then. Under those terms, I offer you my surrender.", "close_window", [(assign,"$g_enemy_surrenders",1)]],
  
  [anyone|plyr,"player_siege_ask_leave_unmolested", [],
    "You have my word. You will not come under attack if you leave the castle.", "player_siege_ask_leave_unmolested_accept", []],
  [anyone,"player_siege_ask_leave_unmolested_accept", [],
    "Very well. Then we leave this castle to you. You have won this day. But we'll meet again.", "close_window", [(assign,"$g_castle_left_to_player",1)]],
  [anyone|plyr,"player_siege_ask_leave_unmolested", [],
    "Unacceptable. I want prisoners.", "player_siege_ask_leave_unmolested_reject", []],
  [anyone,"player_siege_ask_leave_unmolested_reject", [],
    "Then we will defend this castle to the death, and this parley is done. Farewell.", "close_window", []],
  
  
  #Prison break
  
  [anyone|plyr,"lord_prison_break", [],
    "I've come to get you out of here", "lord_prison_break_confirm",
    []],
  
  [anyone|plyr,"lord_prison_break", [],
    "Never mind -- just stay quiet", "close_window",
    [
      (troop_set_slot, "$g_talk_troop", slot_troop_mission_participation, mp_stay_out),
      (assign, "$g_reset_mission_participation", 1),
  ]],
  
  [anyone,"lord_prison_break_confirm", [],
    "Thank the heavens! I don't know how long I could have lasted in here", "lord_prison_break_confirm_2",
    []],
  
  [anyone,"lord_prison_break_confirm_2", [],
    "But wait -- how will we escape? We'll be rushed by the garrison the moment we step out that door. I can help you hold them off -- but I'll tell you now, they have fed me nothing but watery porridge and a few scraps, and I'm not as strong as I could be.", "lord_prison_break_confirm_3",
    []],
  
  [anyone|plyr,"lord_prison_break_confirm_3", [],
    "You keep well behind me, and try to stay out of the fighting.", "lord_prison_break_confirm_4",
    [
      (troop_set_slot, "$g_talk_troop", slot_troop_mission_participation, mp_prison_break_stand_back),
      (assign, "$g_reset_mission_participation", 1),
      
  ]],
  
  [anyone|plyr,"lord_prison_break_confirm_3", [],
    "I'll need you to grab a weapon and help me, despite your weakness.", "lord_prison_break_confirm_4",
    [
      (troop_set_slot, "$g_talk_troop", slot_troop_mission_participation, mp_prison_break_fight),
      (assign, "$g_reset_mission_participation", 1),
      (agent_set_team, "$g_talk_agent", 0),
  ]],
  
  [anyone|plyr,"lord_prison_break_confirm_3", [],
    "Actually, don't get involved in this.", "close_window",
    [
      (troop_set_slot, "$g_talk_troop", slot_troop_mission_participation, mp_stay_out),
      (assign, "$g_reset_mission_participation", 1),
  ]],
  
  
  [anyone,"lord_prison_break_confirm_4", [
      
      (str_clear, s14),
      (try_for_range, ":other_prisoner", active_npcs_begin, kingdom_ladies_end),
        (troop_slot_eq, ":other_prisoner", slot_troop_prisoner_of_party, "$g_encountered_party"),
        (neq, ":other_prisoner", "$g_talk_troop"),
        
        (assign, ":granted_parole", 0),
        (try_begin),
          (call_script, "script_cf_prisoner_offered_parole", ":other_prisoner"),
          (assign, ":granted_parole", 1),
        (try_end),
        (eq, ":granted_parole", 0),
        
        (troop_slot_eq, ":other_prisoner", slot_troop_mission_participation, 0),
        
        (str_store_troop_name, s15, ":other_prisoner"),
        
        (troop_get_type, reg4, ":other_prisoner"),
        (str_store_string, s14, "str__s15_is_also_being_held_here_and_you_may_wish_to_see_if_reg4shehe_will_join_us"),
      (try_end),
    ],
    "Let's go!{s14}", "close_window",
    []],
  
  
  
  
  #After battle texts
  
  [anyone,"start", [
      (eq, "$talk_context", tc_hero_freed),
      (troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_hero)],
    "I am in your debt for freeing me, friend.", "freed_lord_answer",
    [
      (try_begin),
        (check_quest_active, "qst_rescue_lord_by_replace"),
        (quest_slot_eq, "qst_rescue_lord_by_replace", slot_quest_target_troop, "$g_talk_troop"),
        (call_script, "script_succeed_quest", "qst_rescue_lord_by_replace"),
        (assign, "$do_not_cancel_quest", 1),
      (try_end),
      
      (try_begin),
        (check_quest_active, "qst_rescue_prisoner"),
        (quest_slot_eq, "qst_rescue_prisoner", slot_quest_target_troop, "$g_talk_troop"),
        (call_script, "script_succeed_quest", "qst_rescue_prisoner"),
        (assign, "$do_not_cancel_quest", 1),
      (try_end),
      
      (call_script, "script_remove_troop_from_prison", "$g_talk_troop"),
      (assign, "$do_not_cancel_quest", 0),
  ]],
  
  [anyone|plyr,"freed_lord_answer", [(lt, "$g_talk_troop_faction_relation", 0)],
    "You're not going anywhere, 'friend'. You're my prisoner now.", "freed_lord_answer_1",
    [#(troop_set_slot, "$g_talk_troop", slot_troop_is_prisoner, 1),
      (troop_set_slot, "$g_talk_troop", slot_troop_prisoner_of_party, "p_main_party"),
      (party_force_add_prisoners, "p_main_party", "$g_talk_troop", 1),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -30),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -2),
      (call_script, "script_event_hero_taken_prisoner_by_player", "$g_talk_troop"),
  ]],#take prisoner
  
  [anyone,"freed_lord_answer_1", [],
    "I'll have your head on a pike for this, you bastard! Someday!", "close_window", []],
  
  [anyone|plyr,"freed_lord_answer", [
    ],
    "You are free to go wherever you want, sir.", "freed_lord_answer_2",
    [(call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 7),
      (call_script, "script_change_player_honor", 2),
      #    (troop_get_slot, ":cur_rank", "$g_talk_troop", slot_troop_kingdom_rank),
      #    (val_mul, ":cur_rank", 1),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", 2)]],
  
  [anyone,"freed_lord_answer_2", [],
    "Thank you, good {sire/lady}. I never forget someone who's done me a good turn.", "close_window",
    [
      (assign, "$g_leave_encounter", 1), #Not sure why this is necessary
  ]],
  
  ##  [anyone|plyr,"freed_lord_answer", [(neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"), #he is not a faction leader!
  ##                                     (call_script, "script_get_number_of_hero_centers", "$g_talk_troop"),
  ##                                     (eq, reg0, 0), #he has no castles or towns
  ##                                     (hero_can_join)],
  ##   "I need capable men like you. Would you like to join me?", "knight_offer_join",
  ##   []],
  ##
  ##  [anyone,"freed_lord_answer_3", [(store_random_in_range, ":random_no",0,2),(eq, ":random_no", 0)],
  ##   "Alright I will join you.", "close_window",
  ##   [
  ###     (troop_set_slot, "$g_talk_troop", slot_troop_is_player_companion, 1),
  ##     (troop_set_slot, "$g_talk_troop", slot_troop_occupation, slto_player_companion),
  ##     (store_conversation_troop, ":cur_troop_id"),
  ##     (party_add_members, "p_main_party", ":cur_troop_id", 1),#join hero
  ##   ]],
  ##
  ##  [anyone,"freed_lord_answer_3", [],
  ##   "No, I want to go on my own.", "close_window", []],
  
  
  #Troop commentary changes begin
  [anyone,"start", [(eq,"$talk_context",tc_hero_defeated),
      (troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_hero)],
    "{s43}", "defeat_lord_answer",
    [(troop_set_slot, "$g_talk_troop", slot_troop_leaded_party, -1),
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_surrender_offer_default"),
  ]],
  
  [anyone|plyr,"defeat_lord_answer", [],
    "You are my prisoner now.", "defeat_lord_answer_1",
    [
      #(troop_set_slot, "$g_talk_troop", slot_troop_is_prisoner, 1),
      (troop_set_slot, "$g_talk_troop", slot_troop_prisoner_of_party, "p_main_party"),
      (party_force_add_prisoners, "p_main_party", "$g_talk_troop", 1),#take prisoner
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -3),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -3),
      (call_script, "script_event_hero_taken_prisoner_by_player", "$g_talk_troop"),
      (call_script, "script_add_log_entry", logent_lord_captured_by_player, "trp_player",  -1, "$g_talk_troop", "$g_talk_troop_faction"),
  ]],
  
  [anyone,"defeat_lord_answer_1", [],
    "I am at your mercy.", "close_window", []],
  
  [anyone|plyr,"defeat_lord_answer", [],
    "You have fought well. You are free to go.", "defeat_lord_answer_2",
    [(call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 5),
      (call_script, "script_change_player_honor", 3),
      (call_script, "script_add_log_entry", logent_lord_defeated_but_let_go_by_player, "trp_player",  -1, "$g_talk_troop", "$g_talk_troop_faction")]],
  
  [anyone,"defeat_lord_answer_2", [],
    "{s43}", "close_window", [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_prisoner_released_default"),
  ]],
  #Troop commentary changes end
  
  #Troop commentaries changes begin
  [anyone,"start", [(eq,"$talk_context",tc_party_encounter),
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
      (lt,"$g_encountered_party_relation",0),
      (encountered_party_is_attacker),
      (eq, "$g_talk_troop_met", 1),                    ],
    "{playername}!", "party_encounter_lord_hostile_attacker", [
  ]],
  
  [anyone,"start", [(eq,"$talk_context",tc_party_encounter),
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
      (lt,"$g_encountered_party_relation",0),
      (encountered_party_is_attacker),                ],
    "Halt!", "party_encounter_lord_hostile_attacker", [
  ]],
  
  [anyone,"party_encounter_lord_hostile_attacker", [
      (gt, "$g_comment_found", 0),
    ],
    "{s42}", "party_encounter_lord_hostile_attacker", [
      (try_begin),
        (neq, "$log_comment_relation_change", 0),
        (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", "$log_comment_relation_change"),
      (try_end),
      (assign, "$g_comment_found", 0),
  ]],
  
  #Troop commentaries changes end
  [anyone,"party_encounter_lord_hostile_attacker", [
    ],
    "{s43}", "party_encounter_lord_hostile_attacker_2",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_surrender_demand_default"),
  ]],
  
  [anyone|plyr,"party_encounter_lord_hostile_attacker_2", [
    ],
    "We will fight you to the end!", "close_window", []],
  
  [anyone|plyr,"party_encounter_lord_hostile_attacker_2", [
      (is_between, "$g_talk_troop", active_npcs_begin, active_npcs_end),
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
    ],
    "Stay your hand! There is something I must tell you in private.", "lord_recruit_1_relation", []],
  
  [anyone|plyr,"party_encounter_lord_hostile_attacker_2", [
    ],
    "Is there no way to avoid this battle? I don't want to fight with you.", "party_encounter_offer_dont_fight", []],
  
  #TODO: Add a verification step.
  [anyone|plyr,"party_encounter_lord_hostile_attacker_2", [
    ],
    "Don't attack! We surrender.", "close_window", [(assign,"$g_player_surrenders",1)]],
  
  [anyone, "party_encounter_offer_dont_fight", [(gt, "$g_talk_troop_effective_relation", 30),
      #TODO: Add adition conditions, lord personalities, battle advantage, etc...
    ],
    "I owe you a favor, don't I. Well... all right then. I will let you go just this once.", "close_window", [
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop", -7),
      (store_current_hours,":protected_until"),
      (val_add, ":protected_until", 72),
      (party_set_slot,"$g_encountered_party",slot_party_ignore_player_until,":protected_until"),
      (party_ignore_player, "$g_encountered_party", 72),
      (assign, "$g_leave_encounter",1)
  ]],
  
  [anyone, "party_encounter_offer_dont_fight", [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_lord_declines_negotiation_offer_default"),
    ],
    "{s43}", "close_window", []],
  
  ##  [anyone,"start", [(eq,"$talk_context",tc_party_encounter),
  ##                    (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
  ##                    (lt,"$g_encountered_party_relation",0),
  ##                    (neg|encountered_party_is_attacker),
  ##                    ],
  ##   "What do you want?", "party_encounter_lord_hostile_defender",
  ##   []],
  
  
  #  [anyone|plyr,"party_encounter_lord_hostile_defender", [],
  #   "Nothing. We'll leave you in peace.", "close_window", [(assign, "$g_leave_encounter",1)]],
  
  
  
  
  #Betrayal texts should go here
  
  
  ##  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_hero),
  ##                     (troop_slot_eq,"$g_talk_troop",slot_troop_last_quest_betrayed, 1),
  ##                     (troop_slot_eq,"$g_talk_troop",slot_troop_last_quest, "qst_deliver_message_to_lover"),
  ##                     (le,"$talk_context",tc_siege_commander),
  ##                     ],
  ##   "I had trusted that letter to you, thinking you were a {man/lady} of honor, and you handed it directly to the girl's father.\
  ## I should have known you were not to be trusted. Anyway, I have learned my lesson and I won't make that mistake again.", "close_window",
  ##   [(call_script, "script_clear_last_quest", "$g_talk_troop")]],
  
  
  #Lord to be recruited
  
  [anyone ,"start",
    [
      (eq, "$g_talk_troop_faction", "fac_player_supporters_faction"),
      (is_between, "$g_talk_troop", active_npcs_begin, active_npcs_end),
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_inactive),
      (neq, "$g_talk_troop", "$g_player_minister"),
      (troop_get_slot, ":original_faction", "$g_talk_troop", slot_troop_original_faction),
      (faction_get_slot, ":original_faction_leader", ":original_faction", slot_faction_leader),
      (str_store_troop_name, s10, ":original_faction_leader"),
      (str_store_string, s9, "str_lord_indicted_dialog_approach"),
    ],
    #Greetings, {my lord/my lady}. You may have heard of my ill treatment at the hands of {s10}. You have a reputation as one who treats {his/her} vassals well, and if you will have me, I would be honored to pledge myself as your vassal.
    "{s9}", "lord_requests_recruitment", []],
  
  [anyone|plyr ,"lord_requests_recruitment",
    [
      (str_store_string, s9, "str_lord_indicted_dialog_approach_yes"),
    ], #And I would be honored to accept your pledge.
    "{s9}", "close_window", [
      (troop_set_slot, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
      #This should be enough, scriptwise, but if there is a string somewhere to confirm the pledge, I should link
  ]],
  
  [anyone|plyr ,"lord_requests_recruitment",
    [
      (str_store_string, s9, "str_lord_indicted_dialog_approach_no"),
    ], #I'm sorry. Your service is not required.
    "{s9}", "lord_requests_recruitment_refuse", []],
  
  [anyone ,"lord_requests_recruitment_refuse",
    [
      (str_store_string, s9, "str_lord_indicted_dialog_rejected"),
    ], #Indeed? Well, perhaps your reputation is misleading. Good day, {my lord/my lady} -- I go to see if another ruler in Calradia is more appreciative of my talents.
    "{s9}", "close_window", [
      #Seek alternative liege
      (assign, "$g_leave_encounter", 1),
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", -10),
      (call_script, "script_lord_find_alternative_faction", "$g_talk_troop"),
      (assign, ":new_faction", reg0),
      
      (try_begin),
        (is_between, ":new_faction", kingdoms_begin, kingdoms_end),
        (troop_get_slot, ":old_faction", "$g_talk_troop", slot_troop_original_faction),
        (str_store_troop_name, s1, "$g_talk_troop"),
        (str_store_faction_name, s2, ":new_faction"),
        (str_store_faction_name, s3, ":old_faction"),
        
        (call_script, "script_change_troop_faction", "$g_talk_troop", ":new_faction"),
        
        (troop_get_type, reg4, "$g_talk_troop"),
        (display_message, "str_lord_defects_ordinary"),
      (else_try),
        (call_script, "script_change_troop_faction", "$g_talk_troop", "fac_outlaws"),
      (try_end),
  ]],
  
  
  
  
  
  #Rebellion changes begin
  [anyone ,"start",
    [
      (is_between, "$g_talk_troop", pretenders_begin, pretenders_end),
      (eq, "$g_talk_troop", "$supported_pretender"),
    ],
    "I await your counsel, {playername}.", "supported_pretender_talk", [
  ]],
  
  [anyone ,"start",
    [
      (is_between, "$g_talk_troop", pretenders_begin, pretenders_end),
      (neg|troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
      (assign, "$pretender_told_story", 0),
      (eq, "$g_talk_troop_met", 0),
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
    ],
    "Do I know you?.", "pretender_intro_1", []],
  [anyone|plyr ,"pretender_intro_1", [], "My name is {playername}. At your service.", "pretender_intro_2", []],
  [anyone|plyr ,"pretender_intro_1", [], "I am {playername}. Perhaps you have heard of my exploits.", "pretender_intro_2", []],
  
  [anyone ,"pretender_intro_2", [(troop_get_slot, ":rebellion_string", "$g_talk_troop", slot_troop_original_faction),
      (val_sub, ":rebellion_string", "fac_kingdom_1"),
      (val_add, ":rebellion_string", "str_swadian_rebellion_pretender_intro"),
      (str_store_string, 48, ":rebellion_string"),],
    "{s48}", "pretender_intro_3", []],
  
  [anyone|plyr ,"pretender_intro_3", [(troop_get_slot, ":original_faction", "$g_talk_troop", slot_troop_original_faction),
      (str_store_faction_name, s12, ":original_faction"),
      (faction_get_slot, ":original_ruler", ":original_faction", slot_faction_leader),
      (str_store_troop_name, s11, ":original_ruler"),],
    "I thought {s12} was ruled by {s11}?", "pretender_rebellion_cause_1", [
      (troop_set_slot, "$g_talk_troop", slot_troop_discussed_rebellion, 1)
  ]],
  
  [anyone ,"start",
    [
      (is_between, "$g_talk_troop", pretenders_begin, pretenders_end),
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
      (neg|troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
    ],
    "Greetings, {playername}", "pretender_start", [(assign, "$pretender_told_story", 0)]],
  
  [anyone|plyr ,"pretender_start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_discussed_rebellion, 1),
      (eq, "$pretender_told_story", 0)
    ],
    "What was your story again, {reg65?my lady:sir}?", "pretender_rebellion_cause_prelim", [
  ]],
  
  [anyone,"pretender_rebellion_cause_prelim", [],
    "I shall tell you.", "pretender_rebellion_cause_1", [
  ]],
  
  
  [anyone,"pretender_rebellion_cause_1", [],
    "{s48}", "pretender_rebellion_cause_2", [
      (assign, "$pretender_told_story", 1),
      (troop_get_slot, ":rebellion_string", "$g_talk_troop", slot_troop_original_faction),
      (val_sub, ":rebellion_string", "fac_kingdom_1"),
      (val_add, ":rebellion_string", "str_swadian_rebellion_pretender_story_1"),
      (str_store_string, 48, ":rebellion_string"),
  ]],
  
  [anyone,"pretender_rebellion_cause_2", [],
    "{s48}", "pretender_rebellion_cause_3", [
      (troop_get_slot, ":rebellion_string", "$g_talk_troop", slot_troop_original_faction),
      (val_sub, ":rebellion_string", "fac_kingdom_1"),
      (val_add, ":rebellion_string", "str_swadian_rebellion_pretender_story_2"),
      (str_store_string, 48, ":rebellion_string"),
  ]],
  
  [anyone,"pretender_rebellion_cause_3", [],
    "{s48}", "pretender_start", [
      (troop_get_slot, ":rebellion_string", "$g_talk_troop", slot_troop_original_faction),
      (val_sub, ":rebellion_string", "fac_kingdom_1"),
      (val_add, ":rebellion_string", "str_swadian_rebellion_pretender_story_3"),
      (str_store_string, 48, ":rebellion_string"),
  ]],
  
  [anyone|plyr ,"pretender_start", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_discussed_rebellion, 1),
    ],
    "I want to take up your cause and help you reclaim your throne!", "pretender_discuss_rebellion_1", [
  ]],
  
  [anyone|plyr ,"pretender_start", [
    ],
    "I must leave now.", "pretender_end", [
  ]],
  
  
  [anyone ,"pretender_discuss_rebellion_1", [(troop_get_slot, ":original_faction", "$g_talk_troop", slot_troop_original_faction),
      (faction_get_slot, ":original_ruler", ":original_faction", slot_faction_leader),
      (str_store_troop_name, s11, ":original_ruler")],
    "Are you sure you will be up to the task, {playername}? Reclaiming my throne will be no simple matter. " +
    "The lords of our realm have all sworn oaths of homage to {s11}. " +
    "Such oaths to a usurper are of course invalid, and we can expect some of the lords to side with us, but it will be a very tough and challenging struggle ahead.", "pretender_discuss_rebellion_2a", []],
  
  [anyone ,"pretender_discuss_rebellion_2a",[
      (troop_get_slot, ":original_faction", "$g_talk_troop", slot_troop_original_faction),
      (faction_get_slot, ":original_ruler", ":original_faction", slot_faction_leader),
      (str_store_troop_name, s12, ":original_ruler"),
      (call_script, "script_evaluate_realm_stability", ":original_faction"),
      (assign, ":instability_index", reg0),
      (val_add, ":instability_index", reg0),
      (val_add, ":instability_index", reg1),
      (try_begin),
        (gt, ":instability_index", 60),
        (str_store_string, s11, "str_one_thing_in_our_favor_is_that_s12s_grip_is_very_shaky_he_rules_over_a_labyrinth_of_rivalries_and_grudges_lords_often_fail_to_cooperate_and_many_would_happily_seek_a_better_liege"),
      (else_try),
        (is_between, ":instability_index", 40, 60),
        (str_store_string, s11, "str_thankfully_s12s_grip_is_fairly_shaky_many_lords_do_not_cooperate_with_each_other_and_some_might_be_tempted_to_seek_a_better_liege"),
      (else_try),
        (is_between, ":instability_index", 20, 40),
        (str_store_string, s11, "str_unfortunately_s12s_grip_is_fairly_strong_until_we_can_shake_it_we_may_have_to_look_long_and_hard_for_allies"),
      (else_try),
        (lt, ":instability_index", 20),
        (str_store_string, s11, "str_unfortunately_s12s_grip_is_very_strong_unless_we_can_loosen_it_it_may_be_difficult_to_find_allies"),
      (try_end),
    ],
    "{s11}", "pretender_discuss_rebellion_2", []],
  
  
  
  [anyone|plyr ,"pretender_discuss_rebellion_2", [],  "I am ready for this struggle.", "pretender_discuss_rebellion_3", []],
  [anyone|plyr ,"pretender_discuss_rebellion_2", [],  "You are right. Perhaps, I should think about this some more.", "pretender_end", []],
  
  
  [anyone ,"pretender_discuss_rebellion_3", [(this_or_next|neg|faction_slot_eq, "fac_player_supporters_faction", slot_faction_state, sfs_active),
      (neg|faction_slot_eq, "fac_player_supporters_faction", slot_faction_leader, "trp_player"),
      (neg|troop_slot_ge, "trp_player",slot_troop_renown, 200),
      (troop_get_slot, ":original_faction", "$g_talk_troop", slot_troop_original_faction),
      (faction_get_slot, ":original_ruler", ":original_faction", slot_faction_leader),
      (str_store_troop_name, s11, ":original_ruler")],
    "I have no doubt that your support for my cause is heartfelt, {playername}, and I am grateful to you for it. " +
    "But I don't think we have much of a chance of success. " +
    "If you can gain renown in the battlefield and make a name for yourself as a great commander, then our friends would not hesitate to join our cause, " +
    "and our enemies would be wary to take up arms against us. When that time comes, I will come with you gladly. " +
    "But until that time, it will be wiser not to openly challange the usurper, {s11}.", "close_window", []],
  
  [anyone ,"pretender_discuss_rebellion_3", [(this_or_next|neg|faction_slot_eq, "fac_player_supporters_faction", slot_faction_state, sfs_active),
      (neg|faction_slot_eq, "fac_player_supporters_faction", slot_faction_leader, "trp_player"),
      (gt, "$supported_pretender", 0),
      (str_store_troop_name, s17, "$supported_pretender")],
    "Haven't you already taken up the cause of {s17}? " +
    "You must have a very strong sense of justice, indeed. " +
    "But no, thank you. I will not be part of your game.", "close_window", []],
  
  [anyone ,"pretender_discuss_rebellion_3", [(this_or_next|neg|faction_slot_eq, "fac_player_supporters_faction", slot_faction_state, sfs_active),
      (neg|faction_slot_eq, "fac_player_supporters_faction", slot_faction_leader, "trp_player"),
      (gt, "$players_kingdom", 0),
      (neq, "$players_kingdom", "fac_player_supporters_faction"),
      (neq, "$players_kingdom", "fac_player_faction"),
      (troop_get_slot, ":original_faction", "$g_talk_troop", slot_troop_original_faction),
      (neq, "$players_kingdom", ":original_faction"),
      (eq, "$player_has_homage", 1),
      
      (str_store_faction_name, s16, "$players_kingdom"),
      (faction_get_slot, ":player_ruler", "$players_kingdom", slot_faction_leader),
      (str_store_troop_name, s15, ":player_ruler"),
      (str_store_faction_name, s17, ":original_faction"),
    ],
    "{playername}, you are already oath-bound to serve {s15}. " +
    "As such, I cannot allow you to take up my cause, and let my enemies claim that I am but a mere puppet of {s16}. " +
    "No, if I am to have the throne of {s17}, I must do it due to the righteousness of my cause and the support of my subjects alone. " +
    "If you want to help me, you must first free yourself of your oath to {s15}.", "close_window", []],
  
  [anyone ,"pretender_discuss_rebellion_3", [(faction_slot_eq, "fac_player_supporters_faction", slot_faction_state, sfs_active),
      (faction_slot_eq, "fac_player_supporters_faction", slot_faction_leader, "trp_player")],
    "You are a monarch in your own right, {sir/my lady}. If you were to back me, I would be merely your puppet.", "close_window", []],
  
  
  [anyone ,"pretender_discuss_rebellion_3", [(troop_get_slot, ":original_faction", "$g_talk_troop", slot_troop_original_faction),
      (str_store_faction_name, s12, ":original_faction"),
      (faction_get_slot, ":original_ruler", ":original_faction", slot_faction_leader),
      (str_store_troop_name, s11, ":original_ruler")],
    "You are a capable warrior, {playername}, and I am sure with your renown as a commander, and my righteous cause, the nobles and the good people of {s12} will flock to our support. " +
    "The time is ripe for us to act! I will come with you, and together, we will topple the usurper {s11} and take the throne from his bloodied hands. " +
    "But first, you must give me your oath of homage and accept me as your liege {reg65?lady:lord}.", "pretender_rebellion_ready", []],
  
  
  [anyone|plyr ,"pretender_rebellion_ready", [
      (troop_get_type, reg3, "$g_talk_troop"),
    ],
    "I am ready to pledge myself to your cause, {reg3?my lady:sir}.", "lord_give_oath_2", [
  ]],
  
  [anyone|plyr ,"pretender_rebellion_ready", [
    ],
    "Let us bide our time a little longer.", "pretender_end", [
  ]],
  
  [anyone ,"lord_give_conclude_2", [(is_between, "$g_talk_troop", pretenders_begin, pretenders_end),
      (neg|troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
    ],
    "Forward, then! Our first task is to take hold of a fortress and persuade other lords to join us. You lead the way!", "close_window", [
      
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 50), #should be higher
      (faction_set_slot, "$g_talk_troop_faction", slot_faction_state, sfs_active),
      ##            (faction_set_slot, "$g_talk_troop_faction", slot_faction_ai_state, sfai_nascent_rebellion),
      
      (party_force_add_members, "p_main_party", "$supported_pretender", 1),
      (troop_set_slot, "$supported_pretender", slot_troop_cur_center, 0),
      (troop_set_auto_equip, "$supported_pretender",0),
      (str_store_troop_name_link, s6, "$supported_pretender"),
      (display_message, "@{s6} has joined your party."),
      
      #            (faction_get_slot, ":location", "$g_talk_troop_faction", slot_faction_inactive_leader_location),
      #            (faction_set_slot, "$g_talk_troop_faction", slot_faction_inactive_leader_location, 0),
      
      #            (call_script, "script_create_kingdom_hero_party", "$g_talk_troop", ":location"),
      #            (party_set_slot, "$pout_party", slot_party_commander_party, "p_main_party"),
      #            (call_script, "script_party_decide_next_ai_state_under_command", "$pout_party"),
      #            (store_current_hours, ":follow_until_time"),
      #            (store_add, ":follow_period", 60, "$g_talk_troop_relation"),
      #            (val_div, ":follow_period", 2),
      #            (val_add, ":follow_until_time", ":follow_period"),
      #            (party_set_slot, "$pout_party", slot_party_follow_player_until_time, ":follow_until_time"),
      #            (party_set_slot, "$pout_party", slot_party_following_player, 1),
      
      
      
      
      #            (assign, ":rebellion_target", "$supported_pretender_old_faction"),
      (store_relation, ":reln", "$supported_pretender_old_faction", "fac_player_supporters_faction"),
      (val_min, ":reln", -50),
      (call_script, "script_set_player_relation_with_faction", "$supported_pretender_old_faction", ":reln"),
      (faction_get_slot, ":adjective_string", "$supported_pretender_old_faction", slot_faction_adjective),
      (str_store_string, s1, ":adjective_string"),
      
      (faction_set_name, "fac_player_supporters_faction", "@{s1} Rebels"),
      (faction_set_color, "fac_player_supporters_faction", 0xFF0000),
      
      ## Let us handle relation with other kingdoms later.
      ##            (try_for_range, ":existing_kingdom", kingdoms_begin, kingdoms_end),
      ##                (store_relation, ":relation", ":existing_kingdom", ":rebellion_target"),
      ##                (store_sub, ":relation_w_rebels", 0, ":relation"),
      ##                (store_relation, ":player_relation", ":existing_kingdom", "fac_player_supporters_faction"),
      ##                (val_div, ":player_relation", 3),
      ##                (val_add, ":relation_w_rebels", ":player_relation"),
      ##				  #WARNING: Never use set_relation!
      ##                (set_relation, ":existing_kingdom", "$g_talk_troop_faction", ":relation_w_rebels"),
      ##            (try_end),
      
      # we have alrady joined.
      ##            (str_store_faction_name, 4, "$g_talk_troop_faction"),
      ##            (display_message, "@Player joins {s4}"),
      ##            (call_script, "script_player_join_faction", "$g_talk_troop_faction"),
      (call_script, "script_update_all_notes"),
  ]],
  
  
  
  
  
  [anyone ,"pretender_end", [
    ],
    "Farewell for now, then.", "close_window", [
  ]],
  
  
  
  # Events....
  # Choose friend.
  #Post 0907 changes begin
  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_hero),
      (neq, "$g_talk_troop_met", 0),
      (gt, "$g_time_since_last_talk", 24),
      (gt, "$g_talk_troop_relation", -10),
      (store_random_in_range, ":random_num", 0, 100),
      (lt, ":random_num", 30),
      (eq,"$talk_context",tc_town_talk),
      (call_script, "script_cf_troop_get_random_enemy_troop_with_occupation", "$g_talk_troop", slto_kingdom_hero),
      (assign, ":other_lord",reg0),
      (troop_get_slot, ":other_lord_relation", ":other_lord", slot_troop_player_relation),
      (ge, ":other_lord_relation", 20),
      (str_store_troop_name, s6, ":other_lord"),
      (assign, "$temp", ":other_lord"),
    ],
    "I heard that you have befriended that {s43} called {s6}. " +
    "Believe me, you can't trust that man. " +
    "You should end your dealings with him.", "lord_event_choose_friend", [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_lord_insult_default"),
      
  ]],
  
  [anyone|plyr ,"lord_event_choose_friend", [],  "I assure you, {s65}, I am no friend of {s6}.", "lord_event_choose_friend_renounce", [
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",5),
      (call_script, "script_change_player_relation_with_troop","$temp",-10),
  ]],
  
  [anyone ,"lord_event_choose_friend_renounce", [],  "Glad news, {playername}. I would fear for your safety otherwise. " +
    "If you do encounter {s6}, be on your guard and don't believe a word.", "lord_pretalk", []],
  
  [anyone|plyr ,"lord_event_choose_friend", [],  "{s6} is an honourable man, you've no right to speak of him thus.", "lord_event_choose_friend_defend", [
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-10),
      (call_script, "script_change_player_relation_with_troop","$temp",5),
  ]],
  [anyone ,"lord_event_choose_friend_defend", [],  "As you like, {playername}. " +
    "A fool you might be, but a loyal fool at the least. {s6}'s loyalty may not be so steadfast, however...", "lord_pretalk", []],
  #Post 0907 changes end
  
  [anyone|plyr ,"lord_event_choose_friend", [],  "I don't want to be involved in your quarrel with {s6}.", "lord_event_choose_friend_neutral", [
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-2),
      (call_script, "script_change_player_relation_with_troop","$temp",-3),
  ]],
  
  [anyone ,"lord_event_choose_friend_neutral", [],  "Hmph. As you wish, {playername}. " +
    "Just remember that a {man/woman} needs friends in this world, and you'll never make any if you never stand with anyone.", "lord_pretalk", []],
  
  #Meeting.
  [anyone ,"start", [(troop_slot_eq, "$g_talk_troop",slot_troop_occupation, slto_kingdom_hero),
      (troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop"),
    ],
    "Yes, my wife?", "lord_start",
    []],
  
  
  [anyone ,"start", [(faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "trp_player"),
      (troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_hero),
      (le,"$talk_context",tc_siege_commander),
    ],
    "Yes, {sire/my lady}?", "lord_start",
    []],
  
  
  [anyone ,"start", [(is_between, "$g_talk_troop", companions_begin, companions_end),
      (troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_hero),
      (le,"$talk_context",tc_siege_commander),
    ],
    "It is good to see you, old friend", "lord_start",
    []],
  
  
  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_hero),
      (check_quest_active, "qst_join_faction"),
      (eq, "$g_invite_faction_lord", "$g_talk_troop"),
      (eq, "$players_kingdom", "fac_player_supporters_faction"),
    ],
    #TODO: change conversations according to relation.
    "Well, {playername}. I am willing to forgive your impudence in proclaiming yourself {king/queen}, and will welcome you into my realm with full honor, as one of my vassals. Shall we proceed to the oath of allegiance?", "lord_invite_player_monarch_1",
    []],
  
  [anyone|plyr ,"lord_invite_player_monarch_1", [],  "Yes... my lord.", "lord_invite_2",  []],
  [anyone|plyr ,"lord_invite_player_monarch_1", [],  "No. That oath sticks in my throat.", "lord_enter_service_reject",  []],
  
  
  
  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_hero),
      (check_quest_active, "qst_join_faction"),
      (eq, "$g_invite_faction_lord", "$g_talk_troop"),
      (try_begin),
        (gt, "$g_invite_offered_center", 0),
        (store_faction_of_party, ":offered_center_faction", "$g_invite_offered_center"),
        (neq, ":offered_center_faction", "$g_talk_troop_faction"),
        (call_script, "script_get_poorest_village_of_faction", "$g_talk_troop_faction"),
        (assign, "$g_invite_offered_center", reg0),
      (try_end),
    ],
    #TODO: change conversations according to relation.
    "{playername}, I've been expecting you. Word has reached my ears of your exploits. " +
    "Why, I keep hearing such tales of prowess and bravery that my mind was quickly made up. " +
    "I knew that I had found someone worthy of becoming my vassal.", "lord_invite_1",
    []],
  
  
  [anyone|plyr ,"lord_invite_1", [],  "Thank you, {s65}, you honour me with your offer.", "lord_invite_2",  []],
  [anyone|plyr ,"lord_invite_1", [],  "It is good to have my true value recognised.", "lord_invite_2",  []],
  
  [anyone ,"lord_invite_2", [],  "Aye. Let us dispense with the formalities, {playername}; are you ready to swear homage to me?", "lord_invite_3",  []],
  
  [anyone|plyr ,"lord_invite_3", [],  "Yes, {s65}.", "lord_give_oath_2",  []],
  [anyone|plyr ,"lord_invite_3", [],  "No, {s65}. I cannot serve you right now.", "lord_enter_service_reject",  []],
  
  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_met, 2),
      (gt, "$g_talk_troop_relation", 10),
      (gt, "$g_time_since_last_talk", 3),
      (troop_get_type, ":is_female", "trp_player"),
      (eq, ":is_female", 1),
      (troop_slot_eq, "trp_player", slot_troop_spouse, -1),
      (troop_slot_eq, "trp_player", slot_troop_betrothed, -1),
      (troop_slot_eq, "$g_talk_troop", slot_troop_spouse, -1),
      (troop_slot_eq, "$g_talk_troop", slot_troop_betrothed, -1),
      (call_script, "script_npc_decision_checklist_marry_female_pc", "$g_talk_troop"),
      (ge, reg0, 1),
    ],
    "My lady, I have been giving much thought to our recent conversation. It is time for me to ask. Would you do me the honor of becoming my wife?", "lord_female_pc_marriage_proposal",  [
  ]],
  
  [anyone|plyr ,"lord_female_pc_marriage_proposal", [],  "Yes. I would.", "lord_marriage_proposal_female_pc_next_step",  []],
  [anyone|plyr ,"lord_female_pc_marriage_proposal", [],  "Let me think about this some more.", "lord_female_pc_marriage_proposal_postponed",  []],
  [anyone|plyr ,"lord_female_pc_marriage_proposal", [],  "No. I have decided that it would not be appropriate", "lord_female_pc_marriage_proposal_rejected",  []],
  
  [anyone ,"lord_female_pc_marriage_proposal_postponed", [],  "Of course, my lady. Take all the time you need.", "lord_start",  []],
  
  [anyone ,"lord_female_pc_marriage_proposal_rejected", [],  "Do you mean to reject my suit outright, my lady?", "lord_female_pc_marriage_proposal_rejected_confirm",  []],
  
  [anyone|plyr ,"lord_female_pc_marriage_proposal_rejected_confirm", [],  "Yes. I do.", "lord_female_pc_marriage_proposal_rejected_confirm_yes",  []],
  [anyone|plyr ,"lord_female_pc_marriage_proposal_rejected_confirm", [],  "No, you misunderstand. I just need some more time to think", "lord_female_pc_marriage_proposal_postponed",  []],
  
  [anyone ,"lord_female_pc_marriage_proposal_rejected_confirm_yes", [
      (this_or_next|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_debauched),
      (this_or_next|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_selfrighteous),
      (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_quarrelsome),
      ],  "Well, in that case, let me tell you something -- with those harsh words, you have removed the scales from my eyes. I would agree that it would not be appropriate for me to marry one such as you. Good day, my lady.", "close_window",  [
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", -20),
      (troop_set_slot, "$g_talk_troop", slot_troop_met, 4),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone ,"lord_female_pc_marriage_proposal_rejected_confirm_yes", [],  "Such is your right, my lady. If you ever wished to reconsider, I would be overwhelmed with joy.", "close_window",  [
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", -5),
      (troop_set_slot, "$g_talk_troop", slot_troop_met, 4),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  
  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_met, 2),
      (gt, "$g_time_since_last_talk", 24),
      (gt, "$g_talk_troop_relation", 0),
      (troop_get_type, ":is_female", "trp_player"),
      (eq, ":is_female", 1),
      (troop_slot_eq, "trp_player", slot_troop_spouse, -1),
      (troop_slot_eq, "trp_player", slot_troop_betrothed, -1),
      (troop_slot_eq, "$g_talk_troop", slot_troop_spouse, -1),
      (troop_slot_eq, "$g_talk_troop", slot_troop_betrothed, -1),
    ],
    "My lady, it brings my heart great joy to see you again...", "lord_start",  [
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", 2),
  ]],
  
  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_met, 2),
      (gt, "$g_talk_troop_relation", 0),
      (troop_get_type, ":is_female", "trp_player"),
      (eq, ":is_female", 1),
    ],
    "My lady, I am always your humble servant", "lord_start",  [
  ]],
  
  
  
  
  
  
  
  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_hero),
      (neq, "$g_talk_troop_met", 0),
      (gt, "$g_time_since_last_talk", 24),
      (gt, "$g_talk_troop_relation", 50),
      (gt, "$g_talk_troop_faction_relation", 10),
      (le,"$talk_context",tc_siege_commander),
      (eq, "$g_talk_troop", "trp_knight_1_5"),
    ],
    "If it isn't my brave champion, {playername}...", "lord_start",  [(play_sound, "snd_jeanne_epee"),]],
  
  
  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_hero),
      (neq, "$g_talk_troop_met", 0),
      (gt, "$g_time_since_last_talk", 24),
      (gt, "$g_talk_troop_relation", 50),
      (gt, "$g_talk_troop_faction_relation", 10),
      (le,"$talk_context",tc_siege_commander),
      
    ],
    "If it isn't my brave champion, {playername}...", "lord_start",  [(play_sound, "snd_lords_greetings"),]],#pas jeanne
  
  
  
  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_hero),
      (neq, "$g_talk_troop_met", 0),
      (gt, "$g_time_since_last_talk", 24),
      (gt, "$g_talk_troop_relation", 10),
      (le,"$talk_context",tc_siege_commander),
      (eq, "$g_talk_troop", "trp_knight_1_5"),
    ],
    "Good to see you again {playername}...", "lord_start", [(play_sound, "snd_jeanne_epee"),]],
  
  
  
  
  
  
  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_hero),
      (neq, "$g_talk_troop_met", 0),
      (gt, "$g_time_since_last_talk", 24),
      (gt, "$g_talk_troop_relation", 10),
      (le,"$talk_context",tc_siege_commander),
    ],
    "Good to see you again {playername}...", "lord_start", [(play_sound, "snd_lords_greetings"),]],#pas jeanne
  
  
  
  
  
  
  
  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_hero),
      (neq, "$g_talk_troop_met", 0),
      (gt, "$g_time_since_last_talk", 24),
      #                     (lt, "$g_talk_troop_faction_relation", 0),
      (le,"$talk_context",tc_siege_commander),
      (eq, "$g_talk_troop", "trp_knight_1_5"),
    ],
    "Nous nous rencontrons a nouveau, {playername}...", "lord_start", [(play_sound, "snd_jeanne_epee"),]],
  
  
  
  
  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_hero),
      (neq, "$g_talk_troop_met", 0),
      (gt, "$g_time_since_last_talk", 24),
      #                     (lt, "$g_talk_troop_faction_relation", 0),
      (le,"$talk_context",tc_siege_commander),
    ],
    "Nous nous retrouvons, {playername}...", "lord_start", [(play_sound, "snd_lords_greetings"),]],#pas jeanne
  
  #1429 jeanne
  
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_knight_1_5"),
      (eq, "$g_talk_troop_met", 0),
      (ge, "$g_talk_troop_faction_relation", 0),
      (le,"$talk_context",tc_siege_commander),
    ],
    "Qui etes vous ? un chevalier ?", "lord_meet_neutral_jeanne", [(play_sound, "snd_jeanne_greetings_debut"),]],
  
  [anyone|plyr ,"lord_meet_neutral_jeanne", [],  "Je suis {playername}.", "lord_intro_jeanne", []],
  
  [anyone|plyr ,"lord_meet_neutral_jeanne", [],  "Je suis {playername},Madame...pour vous servire.", "lord_intro_jeanne", []],
  
  [anyone|plyr ,"lord_meet_neutral_jeanne", [],  "Je suis {playername},et je ne suis pas vraiment ca...", "lord_intro_jeanne", []],
  
  
  #si je ne suis pas encore vassal
  [anyone ,"lord_intro_jeanne",
    [
      #si je ne suis pas encore vassal a l'intro reporter plus tard zazaza 1
      (eq, "$quete_jhoan_ready_orleans", 0),
    ],
    "Je sais que vous serrez un jour un grand Chevalier, vennez me voir quand vous parviendrez a vous faire adouber, j'ai de grands projets pour vous, pour la france.", "lordnolord_jeanne", []],
  
  [anyone|plyr ,"lordnolord_jeanne", [],  "Cela me semble...parllons d'autres choses je vous prie.", "lord_start", [(assign, "$passuivisssjarc", 1),]],
  
  
  
  [anyone ,"lord_intro_jeanne",
    [
      #si je suis deja vassal a l'intro reporter plus tard zazaza 2
      (eq, "$quete_jhoan_ready_orleans", 1),
    ],
    "La France a besoin d'hardis hommes de guerre telle que vostre personne, entendez la voix des cieux et rejoignez cette banière,enssembles nous libererons ce pays et tous ces gens qui souffres,agissons pressement.", "lord_jeanne", [(play_sound, "snd_jeanne_gueroyer"),]],
  
  [anyone|plyr ,"lord_jeanne", [],  "Etes vous cette bergère dont tout le monde parle,Jeanne de Domrémy ?.", "lord_intro_jeanne_ber", []],
  
  [anyone|plyr ,"lord_jeanne", [],  "Je suis ma propre banière ou celle du roi.", "lord_start", [(assign, "$passuivisssjarc", 1),]],
  
  [anyone ,"lord_intro_jeanne_ber", [],"Et bien,si je n'etais pas une bergère j'aurais put m'offenser n'es ce pas ?", "lord_introjj", []],
  [anyone|plyr ,"lord_introjj", [],  "Avez vous une action a sugèrer ?", "lord_introjj2", []],
  
  [anyone|plyr ,"lord_introjj", [],  "J'ai d'autres taches plus urgentes a mes yeux.", "lord_start", [(assign, "$passuivisssjarc", 1),]],
  
  [anyone ,"lord_introjj2", [],"J'entend des voix,elles proviènes de saint Michel, il me dit mener le peuple de France a la victoire et de boutter les Anglois hors de nostre pays, rejoignez moi dans mon combat et je vous ménerais a une grande victoire.", "lord_introjj2quest", []],
  
  [anyone|plyr ,"lord_introjj2quest", [],  "Je suis avec vous Madame, ce serais un honneur de combattre a vos cotés.", "lord_introjj2quest2",
    [
      (assign, "$plus_dequete_donneejeanne", 1),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",10), #####test
      (call_script, "script_change_troop_renown", "trp_player", 10),#####test lalala
      (call_script, "script_enable_jeanne_autority"),
      (assign, "$quete_epee_offjeanne", 1),
  ]],
  
  [anyone ,"lord_introjj2quest2", [],"Dieu soit loué, soyez pret, je vous ferais mander losque j'aurais besoin de vous.", "close_window",
    [
      (assign, "$g_leave_encounter",1)
  ]],
  
  
  
  #  [anyone|plyr ,"lord_introjj2quest", [],  "Pardon, mais vous semblez etre folle Madame, je vous souhaite chance et réusite dans votre entreprise, puissez vous trouver quelqu'un d'aussi fol que vous.", "lord_intro", []],
  [anyone|plyr ,"lord_introjj2quest", [],  "Pardon, mais vous semblez etre folle Madame, je vous souhaite chance et réusite dans votre entreprise, puissez vous trouver quelqu'un d'aussi fou que vous.", "close_window",[(assign, "$passuivisssjarc", 1),(assign, "$g_leave_encounter",1)]],
  
  
  # CHARLES7
  
  
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_kingdom_1_lord"),
      (eq, "$g_talk_troop_met", 0),
      (ge, "$g_talk_troop_faction_relation", 0),
      (le,"$talk_context",tc_siege_commander),
    ],
    "Qui diable etes vous,un espion a la solde des anglais ?", "lord_meet_neutral_charles", [(play_sound, "snd_charles_greetings_debut"),]],
  
  [anyone|plyr ,"lord_meet_neutral_charles", [],  "Je suis {playername},mon noble Roi.", "lord_intro_charles", []],
  
  [anyone|plyr ,"lord_meet_neutral_charles", [],  "Je me nome {playername},Sire...je ne suis point un espion,mais un simple combatant.", "lord_intro_charles", []],
  
  [anyone|plyr ,"lord_meet_neutral_charles", [],  "Je suis {playername},vaillant combatant pour ma propre gloire...", "lord_intro_charles", []],
  
  [anyone ,"lord_intro_charles", [],"Fort bien...nous avons besoin de combatants competents,que vous depenssiez votre solde en boisson ou que vous vous batiez dans les regles de la chevalerie,l'essentelle es que vous soyez pret a tuer des anglais", "lord_intro", []],
  
  
  
  
  #HENRY5
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_kingdom_2_lord"),
      (eq, "$g_talk_troop_met", 0),
      (ge, "$g_talk_troop_faction_relation", 0),
      (le,"$talk_context",tc_siege_commander),
    ],
    "Qu'avons nous la ? un Francais,un Bourgignon ? ou peut etre un de ces soldats louant leur patriotisme au plus offrant ?...parlez.", "lord_meet_neutral_henry", [(play_sound, "snd_henry_greetings_debut"),]],
  
  
  [anyone|plyr ,"lord_meet_neutral_henry", [],  "Je suis {playername},mon Seigneur, un sujet de la courone d'Angleterre.", "lord_intro_henry", []],
  
  [anyone|plyr ,"lord_meet_neutral_henry", [],  "Je me nome {playername}.", "lord_intro_henry", []],
  
  [anyone|plyr ,"lord_meet_neutral_henry", [],  "Je suis {playername},et vous etes ?", "lord_intro_henryusurpateur",
    [(call_script, "script_change_player_relation_with_troop","$g_talk_troop",-10),]],
  
  [anyone|plyr ,"lord_meet_neutral_henry", [],  "Je suis {playername},vaillant combatant pour ma propre gloire, et je loue mes services en effet.", "lord_intro_henry", []],
  
  
  [anyone ,"lord_intro_henry", [],"Certes...", "lord_intro", []],
  
  [anyone ,"lord_intro_henryusurpateur", [],"Surveillez vos manieres miserable geux, savez vous seulement a qui vous vous adressez ?", "lord_intro_henry", []],
  
  
  #DUC
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_kingdom_3_lord"),
      (eq, "$g_talk_troop_met", 0),
      (ge, "$g_talk_troop_faction_relation", 0),
      (le,"$talk_context",tc_siege_commander),
    ],
    "Un Bourgignon que je ne connais pas...presentez vos respets a votre Duc.", "lord_meet_neutral_duc", [(play_sound, "snd_duc_greetings_debut"),]],
  
  
  [anyone|plyr ,"lord_meet_neutral_duc", [],  "Je me nome {playername},Puissant Duc.", "lord_intro_duc", []],
  
  [anyone|plyr ,"lord_meet_neutral_duc", [],  "Je suis {playername},et vous vous meprenez Duc,je ne suis pas Bourgignon.", "lord_intro_Ducnorespet",
    [(call_script, "script_change_player_relation_with_troop","$g_talk_troop",-3),]],
  
  [anyone|plyr ,"lord_meet_neutral_duc", [],  "Je suis {playername}.", "lord_intro_Ducnorespet",
    [(call_script, "script_change_player_relation_with_troop","$g_talk_troop",-3),]],
  
  [anyone ,"lord_intro_duc", [],"Je suppose que vous etes un de ces mercenaires que j'ai enrolé pour combattre ces chiens de francais...", "lord_intro_insultduc", []],
  
  [anyone ,"lord_intro_Ducnorespet", [],"D'habitude seuleument deux categories de soldats s'adresse a moi,mes alliés et mes enemis...dans laquelle vous rangez vous ?", "lord_introducreponsse", []],
  
  [anyone|plyr ,"lord_introducreponsse", [],  "Mais je suis avec vous grand Duc...", "lord_intro", []],
  
  [anyone|plyr ,"lord_introducreponsse", [],  "Je cherche juste du travail,je ne suis pas vraiment soldat et je ne ferais pas d'histoire.", "lord_intro",
    [(call_script, "script_change_player_relation_with_troop","$g_talk_troop",-1),]],
  
  [anyone|plyr ,"lord_introducreponsse", [],  "Je travail pour le plus offrant.", "lord_intro", []],
  
  [anyone|plyr ,"lord_intro_insultduc", [],  "Je pourais bien etre Mercenaire,et travailler pour les Francais.", "lord_intro_insultduc2",
    [(call_script, "script_change_player_relation_with_troop","$g_talk_troop",-10),]],
  
  [anyone|plyr ,"lord_intro_insultduc", [],  "C'est cela mon seigneur...", "lord_intro", []],
  
  [anyone ,"lord_intro_insultduc2", [],"Quelle insolance...les soldats de votre éspéce ne sont que des charognes qui pillent les cadavres sur les champs de bataille,pour s'abreuver dans les tavernes...cepandant puis que vos vies ont un prix et que j'ai besoin de vautours tel que vous,je ferais la sourde oreille.", "lord_intro", []],
  
  #
  
  
  # #pour le duc! begin
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_kingdom_4_lord"),
      (eq, "$g_talk_troop_met", 0),
      (ge, "$g_talk_troop_faction_relation", 0),
      (le,"$talk_context",tc_siege_commander),
    ],
    "Qui etes vous manant ?", "lord_meet_neutral_ducb", [(play_sound, "snd_duc_greetings_debut"),]],
  
  [anyone|plyr ,"lord_meet_neutral_ducb", [],  "Je suis {playername} Messire Duc, un mercenaire, le meilleur que vous ne puissiez trouver.", "lord_intro_ducbmsduc", []],
  
  [anyone|plyr ,"lord_meet_neutral_ducb", [],  "Je suis {playername},et je ne suis point un manant.", "lord_intro_pasmanant", []],
  
  
  [anyone ,"lord_intro_ducbmsduc",[],"Messire Duc ? et bien ca n'est point tout a fait le protocole mais certes je me contenterais de ceci en guise de salutations, bien que vous n'ayez meme point de droits a me saluer de la sorte aux vues de ma condition, un mercenaire dites vous ?...hum, et d'ou estes vous ?", "lord_intro_ducbmsduc2", []],
  [anyone ,"lord_intro_pasmanant",[],"Vraiment...et d'ou vennez vous donc ?", "lord_intro_ducbmsduc2", []],
  
  [anyone|plyr ,"lord_intro_ducbmsduc2", [],  "D'un peut partout mon seigneur, je voyage jusqu'a trouver une cause ou de l'or, ou les deux.", "lord_intro_ducbmsduc3d", []],
  [anyone ,"lord_intro_ducbmsduc3d",[],"C'est très bien, j'ai besoin d'un mercenaire aux qualités que vous décrivez, vous serez fort bien payé pour un travail de la plus haute importance ou bien vous mourrez, estes vous pret a prendre mes directives mercenaire ?", "lord_intro_ducbmsduc3", []],
  
  [anyone|plyr ,"lord_intro_ducbmsduc3", [],  "Mon épée est a vous mon seigneur.", "lord_intro_ducbmsducstart", []],
  [anyone|plyr ,"lord_intro_ducbmsduc3", [],  "Tout compte fait...cela semble etre une mort certaine, je doit reconsidérer la question.", "lord_intro_ducbmsducend", []],
  
  [anyone ,"lord_intro_ducbmsducend",[],"Et bien cessez de me faire perdre mon temps dans ce cas.", "close_window",
    [
      (assign, "$g_leave_encounter",1),
  ]],
  
  
  [anyone ,"lord_intro_ducbmsducstart",[],"Bien, avant tout j'ai besoin d'un mercenaire qui ne soit point de Bretagne car je n'ai guère confiance pour le moindre de mes sujets a présent. La maison de Penthièvre de Bretagne veux ma perte, mon titre et mes possessions, pas moins. Etienne  est a l'origine de tout ceci, il as fait former des millices alors qu'il siegais a ma cour comme si de rien n'étais, puis un jour il fut pret a mettre son plan a execution.", "lord_intro_ducbmsducstart2",
    [
      
      
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le Duc de Bretagne m'a chargé d'enqueter sur les agissement de son rival, je doit comprendre comment les troupes irrégulière d'Etienne de Penthièvre arrivent a passer le cordon qui est censsé les empécher de continuer a réduire l'économie et le pouvoir du Duc de Bretagne."),
      (call_script, "script_start_quest", "qst_pour_le_duc", "$g_talk_troop"),
      
      
      (str_store_string, s2, "@Le Duc de Bretagne m'a chargé d'enqueter sur les agissement de son rival Etienne de Penthièvre, je doit aller voir pour l'instant pourquois la mine du Duc ne produit plus."),
      (call_script, "script_start_quest", "qst_fer_pour_la_guerre", "$g_talk_troop"),
      (assign, "$duc_donnee_quete_minefer", 1),
      (party_set_flags, "p_foret_lorges", pf_quest_party, 1),
      
  ]],
  
  [anyone ,"lord_intro_ducbmsducstart2",[],"Ses troupes de choc brullent les récoltes et les paysans dans le lits avec le bétail dans les granges, tandis que d'autres de ses agents s'empréssent d'aller raconter dans les tavernes des villages voisins que l'actuel duc ne fait rien pour eux, inutile de vous en dire plus n'est ce pas ? ses troupes de chocs ont été localisées dans la foret de Lorges, je l'ai fait encerclée mais ils continuent leurs méfaits, est ce la coruption des gardes qui les assiègent qui leur permet de passer malgrès tout le cordon, ou est ce austre chose...a vous de le découvrir en mon nom.", "lord_intro_ducbmsducstart3", []],
  
  [anyone ,"lord_intro_ducbmsducstart3",[],"Actuelement, plus aucune ressources ne me parviennent de ma mine de fer au coeur de la foret, rendez vous la bas et découvrez pourquois, revennez vivant et vous serez payé au dela de vos reves les plus fous. Avez vous bien compris mercenaire ?", "lord_intro_ducbmsducfin", []],
  
  [anyone|plyr ,"lord_intro_ducbmsducfin", [],  "Prfaitement...Messire...Duc.", "lord_intro_ducbmsducfinfin", []],
  [anyone ,"lord_intro_ducbmsducfinfin",[],"Oui...bon, voila un lassé passé qui vous permettra d'entre dans la foret de Lorges. A vous de jouer maintenant, et ne vous meprennez point, vous n'estes point le seul mercenaire que j'ai envoyé, d'ailleurs aucun n'est revenu.", "close_window",
    [
      (troop_add_item, "trp_player", "itm_laisse_passer_lorges", 0),
      (assign, "$g_leave_encounter",1)
  ]],
  #pour le duc! end
  
  
  
  
  # SEIGNEUR
  
  
  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_hero),
      (eq, "$g_talk_troop_met", 0),
      (ge, "$g_talk_troop_faction_relation", 0),
      (le,"$talk_context",tc_siege_commander),
    ],
    "Do I know you?", "lord_meet_neutral", [(play_sound, "snd_lords_greetings_debut"),]],
  [anyone|plyr ,"lord_meet_neutral", [],  "I am {playername}.", "lord_intro", []],
  [anyone|plyr ,"lord_meet_neutral", [],  "My name is {playername}. At your service sir.", "lord_intro", []],
  
  #
  [anyone ,"lord_intro", [
      #   (lt, "$g_talk_troop", "trp_knight_1_5"),
    ],# pas jeanne d'arc overide
    "{s11}", "lord_start", [
      (faction_get_slot, ":faction_leader", "$g_talk_troop_faction", slot_faction_leader),
      (str_store_faction_name, s6, "$g_talk_troop_faction"),
      (assign, reg4, 0),
      (str_store_troop_name, s4, "$g_talk_troop"),
      (try_begin),
        (eq, ":faction_leader", "$g_talk_troop"),
        (str_store_string, s9, "@I am {s4}, the ruler of {s6}", 0),
      (else_try),
        (str_store_string, s9, "@I am {s4}, a vassal of {s6}", 0),
      (try_end),
      (assign, ":num_centers", 0),
      (str_clear, s8),
      (try_for_range_backwards, ":cur_center", centers_begin, centers_end),
        (party_slot_eq, ":cur_center", slot_town_lord, "$g_talk_troop"),
        (try_begin),
          (eq, ":num_centers", 0),
          (str_store_party_name, s8, ":cur_center"),
        (else_try),
          (eq, ":num_centers", 1),
          (str_store_party_name, s7, ":cur_center"),
          (str_store_string, s8, "@{s7} and {s8}"),
        (else_try),
          (str_store_party_name, s7, ":cur_center"),
          (str_store_string, s8, "@{!}{s7}, {s8}"),
        (try_end),
        (val_add, ":num_centers", 1),
      (try_end),
      (assign, reg5, ":num_centers"),
      (str_store_string, s11, "@{s9}{reg5? and the lord of {s8}.:.", 0),
  ]],
  
  #  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_hero),
  #                     (eq, "$g_talk_troop_met", 0),
  #                     (ge, "$g_talk_troop_faction_relation", 0),
  #                     (le,"$talk_context",tc_siege_commander),
  #                     ],
  #   "Who is this then?", "lord_meet_ally", []],ggggggggggggggggggggggggggggggggggggggg
  #  [anyone|plyr ,"lord_meet_ally", [],  "I am {playername} sir. A warrior of {s4}.", "lord_start", []],
  #  [anyone|plyr ,"lord_meet_ally", [],  "I am but a soldier of {s4} sir. My name is {playername}.", "lord_start", []],
  
  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_hero),
      (eq, "$g_talk_troop_met", 0),
      (lt, "$g_talk_troop_faction_relation", 0),
      #                     (str_store_faction_name, s4,  "$players_kingdom"),
      (le,"$talk_context",tc_siege_commander),
    ],
    "{s43}", "lord_meet_enemy", [
      (play_sound, "snd_enemi_greetings"),
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_enemy_meet_default"),
  ]],
  [anyone|plyr ,"lord_meet_enemy", [],  "I am {playername}, {s65}.", "lord_intro", []],  #A warrior of {s4}.
  [anyone|plyr ,"lord_meet_enemy", [],  "They know me as {playername}. Mark it down, you shall be hearing of me a lot.", "lord_intro", []],
  #  [anyone, "lord_meet_enemy_2", [],  "{playername} eh? Never heard of you. What do want?", "lord_talk", []],
  
  
  
  
  
  
  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_hero),
      (le,"$talk_context",tc_siege_commander),
      (try_begin),
        (this_or_next|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_debauched),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_quarrelsome),
        (lt, "$g_talk_troop_relation", -15),
        (str_store_string, s8, "str_playername_come_to_plague_me_some_more_have_you"),
      (else_try),
        (lt, "$g_talk_troop_relation", -5),
        (str_store_string, s8, "str_ah_it_is_you_again"),
      (else_try),
        (str_store_string, s8, "str_well_playername"),
      (try_end),
    ],
    "{s8}", "lord_start",
    []],
  
  
  #verifier seigneurs allentours
  
  [anyone,"lord_start", [(gt, "$g_comment_found", 0), #changed to s32 from s62 because overlaps with setup_talk_info strings
      (str_store_string, s1, "$g_last_comment_copied_to_s42"),
      (try_begin),
        (eq, "$cheat_mode", 1),
        (display_message, "str_comment_found_s1"),
      (try_end),
      
      ],  "{s42}", "lord_start", [
      #                         (store_current_hours, ":cur_time"),
      #                         (troop_set_slot, "$g_talk_troop", slot_troop_last_comment_time, ":cur_time"),
      (try_begin),
        (neq, "$log_comment_relation_change", 0),
        (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", "$log_comment_relation_change"),
      (try_end),
      
      
      (assign, "$g_comment_has_rejoinder", 0),
      (try_begin),
        (gt, "$g_rejoinder_to_last_comment", 0),
        (try_begin),
          (eq, "$cheat_mode", 1),
          (display_message, "str_rejoinder_noted"),
        (try_end),
        (assign, "$g_comment_has_rejoinder", 1),
      (try_end),
      
      (assign, "$g_comment_found", 0),
  ]],
  
  
  #
  [anyone|auto_proceed,"lord_start",
    [
      (check_quest_active, "qst_destroy_bandit_lair"),
      (check_quest_succeeded, "qst_destroy_bandit_lair"),
      (quest_slot_eq, "qst_destroy_bandit_lair", slot_quest_giver_troop, "$g_talk_troop"),
    ], "{!}.", "lair_quest_intermediate_1",
    [
  ]],
  
  [anyone,"lair_quest_intermediate_1",
    [
    ], "Splendid work, {playername} -- your audacious attack is the talk of the realm. No doubt they, or others like them, will soon be back, but for a short while you have bought this land a small respite. We are most grateful to you.", "lord_pretalk",
    [
      (quest_get_slot, ":quest_gold_reward", "qst_destroy_bandit_lair", slot_quest_gold_reward),
      (call_script, "script_troop_add_gold", "trp_player", ":quest_gold_reward"),
      (assign, ":xp_reward", ":quest_gold_reward"),
      (val_mul, ":xp_reward", 2),
      (add_xp_as_reward, ":xp_reward"),
      (call_script, "script_change_troop_renown", "trp_player", 3),
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", 4),
      (call_script, "script_end_quest", "qst_destroy_bandit_lair"),
      (assign, reg5, ":quest_gold_reward"),
  ]],
  
  [anyone|auto_proceed,"lord_start",
    [
      (check_quest_active, "qst_destroy_bandit_lair"),
      (check_quest_failed, "qst_destroy_bandit_lair"),
      (quest_slot_eq, "qst_destroy_bandit_lair", slot_quest_giver_troop, "$g_talk_troop"),
    ], "{!}.", "lair_quest_intermediate_2",
    []],
  
  [anyone,"lair_quest_intermediate_2",
    [], "Well, {playername}, I guess that at least some of those brigands eluded you -- and of course, it will be the peaceful travellers of this land who will pay the price. Still, it was good of you to try.", "lord_pretalk",
    [
      
      (call_script, "script_end_quest", "qst_destroy_bandit_lair"),
  ]],
  
  ##############################################################################################################################################
  
  
  
  
  #epee trouvee win
  
  [anyone,"lord_start", [
      (eq, "$g_talk_troop", "trp_knight_1_5"),
      (this_or_next|player_has_item,"itm_epee_jeanne_charles"),#ID epee quete
      (troop_has_item_equipped,"trp_player","itm_epee_jeanne_charles"),#ID epee quete
      (check_quest_active, "qst_find_epeepour_jeanne"),
      (neg|check_quest_succeeded, "qst_find_epeepour_jeanne"),
      (neg|check_quest_failed, "qst_find_epeepour_jeanne"),
      (neg|check_quest_finished, "qst_find_epeepour_jeanne"),
      
    ],
    "Avez vous l'épée mon ami ? le temps presse.", "take_itemjeannesword",[(play_sound, "snd_jeanne_epee"),]],
  
  
  [anyone|plyr, "take_itemjeannesword", [],"La voici Jeanne.", "take_itemjeanneswordok",
    [
      #enlever epee jouer et donner a jeane
      (troop_remove_item, "trp_player","itm_epee_jeanne_charles"),
      (troop_add_item, "trp_knight_1_5", "itm_epee_jeanne_charles", 0),
      (call_script, "script_succeed_quest", "qst_find_epeepour_jeanne"),
      (call_script, "script_end_quest", "qst_find_epeepour_jeanne"),
      
  ]],
  [anyone|plyr, "take_itemjeannesword", [],"Je ne la trouve pas.", "take_itemjeanneswordgarder",[]],
  
  
  
  [anyone,"take_itemjeanneswordgarder", [], "C'est impossible, les voix ne peuvent se tromper, retournez la bas et cherchez encore, telle es votre tache.", "lord_pretalk",[]],
  
  
  [anyone,"take_itemjeanneswordok", [], "Oui, c'est bien ca, telle que les voix me l'ont décrite, je vous remercie de tout coeur mon Ami, puissiez vous me rejoindre dans les batailles qu'il me reste a livrer, c'est la la dérnière mission que je vous confie si vous l'acceptez.", "lord_pretalk",
    [
      (party_set_flags, "p_fierbois", pf_always_visible, 0),
      (party_set_flags, "p_fierbois", pf_disabled, 1),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",4),
  ]],
  
  
  
  #en attente
  [anyone,"lord_start", [
      (eq, "$g_talk_troop", "trp_knight_1_5"),
      (check_quest_active, "qst_find_epeepour_jeanne"),
      (neg|check_quest_succeeded, "qst_find_epeepour_jeanne"),
      (neg|check_quest_failed, "qst_find_epeepour_jeanne"),
      (neg|check_quest_finished, "qst_find_epeepour_jeanne"),
      
    ],
    "Avez vous l'épée mon ami ? le temps presse, les Anglois finirons par marcher jusqu'au sud de la France.", "avez_itemjeannesword",[(play_sound, "snd_jeanne_epee"),]],
  
  [anyone|plyr, "avez_itemjeannesword", [],"Je ne la trouve pas.", "avez_itemjeanneswordencore",[]],
  [anyone|plyr, "avez_itemjeannesword", [],"Je n'ai plus de temps a perdre avec ca, je ne puis m'en occuper d'avantage.", "avez_itemjeanneswordenno",[]],
  
  
  [anyone,"avez_itemjeanneswordencore", [], "C'est impossible, les voix ne peuvent se tromper, retournez la bas et cherchez encore, telle es votre tache.", "lord_pretalk",[]],
  
  [anyone,"avez_itemjeanneswordenno", [], "Bon, je trouverais quelqu'un d'autre, mais sachez que mes voix m'ont dites de vous le demander personnelement.", "lord_pretalk",
    [
      (call_script, "script_fail_quest", "qst_find_epeepour_jeanne"),
      (call_script, "script_end_quest", "qst_find_epeepour_jeanne"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-2),
      (party_set_flags, "p_fierbois", pf_always_visible, 0),
      (party_set_flags, "p_fierbois", pf_disabled, 1),
  ]],
  
  
  ###jeanne derniere quete epee
  
  [anyone,"lord_start", [
      (eq, "$g_talk_troop", "trp_knight_1_5"),
      #
      (eq, "$quete_epee_offjeanne", 1),
      #
    ],
    "{playername}, j'ai un service a vous demander.", "eppe_dejeanne_start",
    [(play_sound, "snd_jeanne_epee"),]],
  [anyone|plyr ,"eppe_dejeanne_start", [],  "Boutter le feu d'une bombarde, prendre d'assaut une muraille pleine d'archers ?", "eppe_dejeanne_start2",[]],
  
  [anyone ,"eppe_dejeanne_start2", [],"Ne craignez rien de tout cela, vous ne risquez point de trépasser, il s'agis simplement de récuperer quelque chose et de me le ramener, cepandant c'est tres important ne risquez pas de vous faire prendre la livraison par les brigands.", "eppe_dejeanne_start3",[]],
  
  [anyone|plyr ,"eppe_dejeanne_start3", [],  "Dites m'en plus.", "eppe_dejeanne_start3ok",[]],
  [anyone|plyr ,"eppe_dejeanne_start3", [],  "Le temps me manque, j'en suis navré, mais je ne puis effectuer cette course.", "lord_pretalk",[]],
  
  [anyone ,"eppe_dejeanne_start3ok", [],"Il s'agis d'une épée, je ne suis pas sure, mais vous devriez pouvoir retrouver cette épée a la chapelle de Sainte Catherine de Fierbois au sud de Tours.", "eppe_dejeanne_start3sure",[]],
  
  [anyone|plyr ,"eppe_dejeanne_start3sure", [],  "Vous n'en etes pas sure ?", "eppe_dejeanne_start3sureoui",[]],
  [anyone ,"eppe_dejeanne_start3sureoui", [],"Non, je veux dire...bien entendue que j'en suis sure, allez simplement a la chapelle et rapportez moi cette épée, je vous en prie.", "eppe_dejeanne_where",[]],
  
  [anyone|plyr ,"eppe_dejeanne_where", [],  "Ou la trouverais je exactement ?", "eppe_dejeanne_where2",[]],
  [anyone ,"eppe_dejeanne_where2", [],"Et bien...je ne sais pas, improvisez, mais ramenez la moi.", "eppe_dejeanne_whereyes",[]],
  
  
  [anyone|plyr ,"eppe_dejeanne_whereyes", [],  "Bien, si c'est possible, je la raménerais Jeanne.", "eppe_dejeanne_whereyes22",
    [
      #lancer quete trouver epee
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Jeanne m'a demandé de retrouver une épée spéciale et de la lui ramener, je devrais la chercher a la chapelle de Sainte Catherine de Fierbois au sud de Tours."),
      (call_script, "script_start_quest", "qst_find_epeepour_jeanne", "$g_talk_troop"),
      (assign, "$quete_epee_offjeanne", 0),
  ]],
  
  [anyone ,"eppe_dejeanne_whereyes22", [],"Merci, je savais que je pouvais compter sur vous.", "lord_pretalk",
    [
      (party_set_flags, "p_fierbois", pf_disabled, 0),
      (party_set_flags, "p_fierbois", pf_always_visible, 1),
      (party_set_flags, "p_fierbois", pf_quest_party, 1),
  ]],
  
  [anyone|plyr ,"eppe_dejeanne_whereyes", [],  "Le temps me manque, j'en suis navré, mais je ne puis effectuer cette course.", "lord_pretalk",[]],
  
  
  
  
  #deuxieme chance quete ####################################################################################################################
  
  [anyone,"lord_start", [
      (eq, "$g_talk_troop", "trp_knight_1_5"),
      (eq, "$plus_dequete_donneejeanne", 0),
      (eq, "$passuivisssjarc", 1),
      #si je suis vassal de france zazaza 3
      (eq, "$quete_jhoan_ready_orleans", 1),
    ],
    "La France a besoin d'hardis hommes de guerre telle que vostre personne, entendez la voix des cieux et rejoignez cette banière,enssembles nous libererons ce pays et tous ces gens qui souffres.", "quest_Jranneattendrorrff",
    [(play_sound, "snd_jeanne_gueroyer"),]],
  
  [anyone|plyr ,"quest_Jranneattendrorrff", [],  "Je suis avec vous Madame, ce serais un honneur de combattre a vos cotés.", "lord_introjj2questgg2",
    [
      #lancer quete
      (assign, "$plus_dequete_donneejeanne", 1),
      #(play_sound,"snd_start_quest"),
      #(str_store_string, s2, "@L'étrange bergere qui dit etre un messager de Dieu, m'as demandé de l'accompagner aux tourelles d'Orléans afin d'y faire partir les Anglois qui coupent le ravitaillement de la ville.pour une raison qui m'échape j'ai accepté, j'éspère qu'elle es vraiment ce qu'elle dit etre et non une pauvre femme rendue folle par les souffrances de la guerre."),
      # (call_script, "script_start_quest", "qst_jeanne_siegorl", "$g_talk_troop"),
      #
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",10), #####test
      (call_script, "script_change_troop_renown", "trp_player", 10),#####test
      #lalala
      (call_script, "script_enable_jeanne_autority"),
      (assign, "$quete_epee_offjeanne", 1),
      
  ]],
  
  [anyone ,"lord_introjj2questgg2", [],"Dieu soit loué, soyez pret, je vous ferais mander losque j'aurais besoin de vous, et une dérnière chose... appellez moi simplement Jeanne.", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  
  #  [anyone|plyr ,"lord_introjj2quest", [],  "Pardon, mais vous semblez etre folle Madame, je vous souhaite chance et réusite dans votre entreprise, puissez vous trouver quelqu'un d'aussi fol que vous.", "lord_intro", []],
  [anyone|plyr ,"quest_Jranneattendrorrff", [],  "C'est une idée fixe, vous feriez mieux de retourner a vos taches ménagères et de laisser les champs de batailles aux hommes.", "lord_pretalk",[]],
  
  
  ##################### jeanne end
  
  ##########deuxieme chance duc bretagne
  
  
  
  
  
  
  [anyone ,"lord_start", [(eq, "$g_talk_troop", "trp_kingdom_4_lord"),
      (eq, "$duc_donnee_quete_minefer", 0),
      (ge, "$g_talk_troop_faction_relation", 0),
      (le,"$talk_context",tc_siege_commander),
    ],
    "Et bien mercenaire, avez vous repensé a ma proposition ?", "deu_chance_queteduc_bret", [(play_sound, "snd_lords_greetings"),]],
  
  [anyone|plyr ,"deu_chance_queteduc_bret", [],  "Je suis avec vous noble Duc.", "deu_chance_queteduc_bretok", []],
  
  [anyone|plyr ,"deu_chance_queteduc_bret", [],  "Je suis navré Messire Duc, mais je ne pense pas etre encore pret.", "lord_pretalk", []],
  
  
  
  [anyone ,"deu_chance_queteduc_bretok",[],"Bien, avant tout j'ai besoin d'un mercenaire qui ne soit point de Bretagne car je n'ai guère confiance en le moindre de mes sujets a présent. La maison de Penthièvre de Bretagne veux ma perte, mon titre et mes possessions, pas moins. Etienne de Penthièvre est a l'origine de tout ceci, il as fait former des millices alors qu'il siegais a ma cour comme si de rien n'étais, puis un jour il fut pret a mettre son plan a execution.", "deu_chance_queteduc_bretok2",
    [
      
      
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le Duc de Bretagne m'a chargé d'enqueter sur les agissement de son rival, je doit comprendre comment les troupes irrégulière d'Etienne de Penthièvre arrivent a passer le cordon qui est censsé les empécher de continuer a réduire l'économie et le pouvoir du Duc de Bretagne."),
      (call_script, "script_start_quest", "qst_pour_le_duc", "$g_talk_troop"),
      
      
      (str_store_string, s2, "@Le Duc de Bretagne m'a chargé d'enqueter sur les agissement de son rival Etienne de Penthièvre, je doit aller voir pour l'instant pourquois la mine du Duc ne produit plus."),
      (call_script, "script_start_quest", "qst_fer_pour_la_guerre", "$g_talk_troop"),
      (assign, "$duc_donnee_quete_minefer", 1),
      (party_set_flags, "p_foret_lorges", pf_quest_party, 1),
      
  ]],
  
  [anyone ,"deu_chance_queteduc_bretok2",[],"Ses troupes de choc brullent les récoltes et les paysans dans le lits avec le bétail dans les granges, tandis que d'autres de ses agents s'empréssent d'aller raconter dans les tavernes des villages voisins que l'actuel duc n'as point de compassion pour eux, inutile de vous en dire plus n'est ce pas ? ses troupes de chocs ont été localisées dans la foret de Lorges, je l'ai fait encerclée mais ils continuent leurs méfaits, est ce la coruption des gardes qui les assiègent qui leur permet de passer malgrès tout le cordon, ou est ce austre chose...a vous de le découvrir en mon nom.", "deu_chance_queteduc_bretok3", []],
  
  [anyone ,"deu_chance_queteduc_bretok3",[],"Actuelement, plus aucune ressources ne me parviennent de ma mine de fer au coeur de la foret, rendez vous la bas et découvrez pourquois, revennez vivant et vous serez payé au dela de vos reves les plus fous. Avez vous bien compris mercenaire ?", "deu_chance_queteduc_bretok4", []],
  
  [anyone|plyr ,"deu_chance_queteduc_bretok4", [],  "Parfaitement...Messire...Duc.", "deu_chance_queteduc_bretok5", []],
  [anyone ,"deu_chance_queteduc_bretok5",[],"Oui...bon, voila un lassé passé qui vous permettra d'entre dans la foret de Lorges. A vous de jouer maintenant, et ne vous meprennez point, vous n'estes point le seul mercenaire que j'ai envoyé, d'ailleurs aucun n'est revenu.", "close_window",
    [
      (troop_add_item, "trp_player", "itm_laisse_passer_lorges", 0),
      (assign, "$g_leave_encounter",1)
  ]],
  ##########deuxieme chance duc bretagne END
  #################
  
  #steel edition win
  
  #steel edition loose
  
  #en attente
  
  ###lancer quete
  
  
  
  
  ### SUITE ########
  #mettre ici win "pour le duc" (j'ai trouv?le passage des grottes!) et faire partir les quetes suivantes, par ex maintenant le port de nantes...
  
  ### j'ai tue panthievre j'ai la bague
  [anyone ,"lord_start", [(eq, "$g_talk_troop", "trp_kingdom_4_lord"),
      (player_has_item, "itm_preuve_mort_pantievre"),
      
      
      (ge, "$g_talk_troop_faction_relation", 0),
      (le,"$talk_context",tc_siege_commander),
    ],
    "Et bien messire, que me vaux cette visite ?", "duc_mort_de_pant", [(play_sound, "snd_lords_greetings"),]],
  
  [anyone|plyr ,"duc_mort_de_pant", [],  "Mon seigneur, je doit vous annoncer qu'Etienne de Panthièvre est mort de mes mains, je viens toucher la prime. J'ai récuperré sa chevaliere a ses armoiries pour preuve, la voici.", "duc_mort_de_pant2", []],
  
  [anyone ,"duc_mort_de_pant2",[],"Vraiment ?? Oui! c'est bien sa bague! comment est ce possible ? Messire, vous venez de sauver mon nom. la prime vous reviens, et je parlerais de vous comme étant l'homme de toutes les situations.", "lord_pretalk",
    [
      (troop_remove_item, "trp_player","itm_preuve_mort_pantievre"),
      (troop_add_gold, "trp_player", 25000),
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", 10),
      (call_script, "script_change_troop_renown", "trp_player", 10),
  ]],
  
  
  
  ###
  
  
  
  [anyone ,"lord_start", [(eq, "$g_talk_troop", "trp_kingdom_4_lord"),
      
      (check_quest_active, "qst_pour_le_duc"),
      (check_quest_succeeded, "qst_pour_le_duc"),
      (neg|check_quest_failed, "qst_pour_le_duc"),
      (neg|check_quest_finished, "qst_pour_le_duc"),
      (ge, "$g_talk_troop_faction_relation", 0),
      (le,"$talk_context",tc_siege_commander),
    ],
    "Et bien mercenaire, ou en estes vous dans notre affaire ?", "duc_queteferwinp_ducfin", [(play_sound, "snd_lords_greetings"),]],
  
  [anyone|plyr ,"duc_queteferwinp_ducfin", [],  "Mon seigneur, j'ai trouvé comment les troupes de Penthièvre passent le cordon, ils empreintaient un chemin sous les mongtagnes et passaient ainsi sous la foret et sous vos gardes pour ressortir par la grande route nord.", "duc_queteferwinp_ducfin2", []],
  [anyone ,"duc_queteferwinp_ducfin2",[],"Impréssionnant, vraiment impréssionnant mon ami, vous m'avez retiré une sacrée épine du pied. Voici pour vous, et sachez que je vous considère comme mon meilleur homme a présent, nous aurons urement d'autres affaires en commun, en attendant mes troupes vont pouvoir se livrer a une petite extermination dans cette foret.", "lord_pretalk",
    [
      
      (call_script, "script_end_quest", "qst_pour_le_duc"),
      (call_script, "script_end_quest", "qst_fer_pour_la_guerre"),
      (assign, "$fer_pour_la_guerrefini",1),
      (troop_add_gold, "trp_player", 3000),
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", 10),
  ]],
  
  
  [anyone ,"duc_queteferwinp_ducfin", [],"Tout ceci ne fait pas vraiment bonne impression...tennez en voila un autre, tachez d'y faire attention.", "lord_pretalk",
    [
      (troop_add_item, "trp_player", "itm_laisse_passer_lorges", 0),
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", -1),
  ]],
  
  
  
  
  
  
  
  
  #attente suite et fin apres mine de fer win
  
  [anyone ,"lord_start", [(eq, "$g_talk_troop", "trp_kingdom_4_lord"),
      (eq, "$fer_pour_la_guerrefini", 1),
      (neg|check_quest_finished, "qst_pour_le_duc"),
      (ge, "$g_talk_troop_faction_relation", 0),
      (le,"$talk_context",tc_siege_commander),
    ],
    "Et bien mercenaire, comment avance notre affaire ?", "info_duc_queteferencor", [(play_sound, "snd_lords_greetings"),]],
  
  [anyone|plyr ,"info_duc_queteferencor", [],  "J'y travaille...Messire Duc.", "lord_pretalk", []],
  [anyone|plyr ,"info_duc_queteferencor", [],  "Mon seigneur, j'ai bien peur d'avoir perdu le laissé passé pour entrer dans la foret de Lorges.", "info_duc_queteferencorperd", []],
  
  [anyone ,"info_duc_queteferencorperd", [],"Tout ceci ne fait pas vraiment bonne impression...tennez en voila un autre, tachez d'y faire attention.", "lord_pretalk",
    [
      (troop_add_item, "trp_player", "itm_laisse_passer_lorges", 0),
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", -1),
  ]],
  
  ##### mine de fer loose
  #refaire la quete dans la mine est possible##
  # [anyone ,"start", [(eq, "$g_talk_troop", "trp_kingdom_4_lord"),
  
  #                     (check_quest_active, "qst_fer_pour_la_guerre"),
  #                     (neg|check_quest_succeeded, "qst_fer_pour_la_guerre"),
  #                     (check_quest_failed, "qst_fer_pour_la_guerre"),
  #                     (neg|check_quest_finished, "qst_fer_pour_la_guerre"),
  #                     (ge, "$g_talk_troop_faction_relation", 0),
  #                     (le,"$talk_context",tc_siege_commander),
  #                     ],
  #   "Et bien mercenaire, ou en estes vous dans notre affaire ?", "info_duc_queteferloose", [(play_sound, "snd_lords_greetings"),]],
  
  #  [anyone|plyr ,"info_duc_queteferloose", [],  "Mon seigneur, j'ai le plaisir de vous annoncer que la production de votre mine va repartir, les malandrins de Penthièvre avais ordonné auxcerfs de cesser toute activité.", "info_duc_queteferloose2", []],
  #  [anyone ,"info_duc_queteferloose2",[],"Ce cher Etienne de Penthièvre...comme c'est étonnant. Je payerais cher pour voir sa tete a cet instant, mais nous avons d'austres detes sur lesquels s'aquitter n'est ce pas ? tennez voici pour vous mercenaire. Vous avez encore du travail pour moi il me semble, bon alors retournez la bas.", "lord_pretalk",
  #   [
  #    (call_script, "script_end_quest", "qst_fer_pour_la_guerre"),
  #      (assign, "$fer_pour_la_guerrefini",1),
  #   (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", -3),
  #      ]],
  
  
  
  
  ##### mine de fer win
  
  [anyone ,"lord_start", [(eq, "$g_talk_troop", "trp_kingdom_4_lord"),
      
      (check_quest_active, "qst_fer_pour_la_guerre"),
      (check_quest_succeeded, "qst_fer_pour_la_guerre"),
      (neg|check_quest_failed, "qst_fer_pour_la_guerre"),
      (neg|check_quest_finished, "qst_fer_pour_la_guerre"),
      (ge, "$g_talk_troop_faction_relation", 0),
      (le,"$talk_context",tc_siege_commander),
    ],
    "Et bien mercenaire, ou en estes vous dans notre affaire ?", "info_duc_queteferwin", [(play_sound, "snd_lords_greetings"),]],
  
  [anyone|plyr ,"info_duc_queteferwin", [],  "Mon seigneur, j'ai le plaisir de vous annoncer que la production de votre mine va repartir, les malandrins de Penthièvre avaient ordonné aux cerfs de cesser toute activité.", "info_duc_queteferwin2", []],
  [anyone ,"info_duc_queteferwin2",[],"Ce cher Etienne de Penthièvre...comme c'est étonnant. Je payerais cher pour voir sa tete a cet instant, mais nous avons d'austres detes sur lesquels s'aquitter n'est ce pas ? tennez voici pour vous mercenaire. Vous avez encore du travail il me semble, alors retournez la bas.", "lord_pretalk",
    [
      (call_script, "script_end_quest", "qst_fer_pour_la_guerre"),
      (assign, "$fer_pour_la_guerrefini",1),
      (troop_add_gold, "trp_player", 800),
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", 3),
  ]],
  
  
  
  
  
  #attente mine de fer duc bretagne
  
  [anyone ,"lord_start", [(eq, "$g_talk_troop", "trp_kingdom_4_lord"),
      
      (check_quest_active, "qst_fer_pour_la_guerre"),
      (neg|check_quest_succeeded, "qst_fer_pour_la_guerre"),
      (neg|check_quest_failed, "qst_fer_pour_la_guerre"),
      (neg|check_quest_finished, "qst_fer_pour_la_guerre"),
      (ge, "$g_talk_troop_faction_relation", 0),
      (le,"$talk_context",tc_siege_commander),
    ],
    "Et bien mercenaire, ou en estes vous dans notre affaire ?", "info_duc_quetefer", [(play_sound, "snd_lords_greetings"),]],
  
  [anyone|plyr ,"info_duc_quetefer", [],  "J'y travaille...Messire le Duc.", "lord_pretalk", []],
  [anyone|plyr ,"info_duc_quetefer", [],  "Mon seigneur, j'ai bien peur d'avoir perdu le laissé passé pour entrer dans la foret de Lorges.", "info_duc_queteferprdulp", []],
  
  [anyone ,"info_duc_queteferprdulp", [],"Tout ceci ne fait pas vraiment bonne impression...tennez en voila un autre, tachez d'y faire attention.", "lord_pretalk",
    [
      (troop_add_item, "trp_player", "itm_laisse_passer_lorges", 0),
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", -1),
  ]],
  
  
  
  ##########duc bretagne END
  
  ###### soldat bretons cordon
  
  
  #autres gardes cordon
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_cordon_breton_guard2"),
    ],
    "Halte! cessez de regarder ces murs et disparaissez d'ici.", "alt_cordon_troopautres_passnoentry", [(play_sound, "snd_alt"),]],
  
  [anyone|plyr ,"alt_cordon_troopautres_passnoentry", [],  "Entendu.", "close_window", []],
  
  
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_cordon_breton_guard3"),
    ],
    "Halte! cessez de regarder ces murs et disparaissez d'ici.", "alt_cordon_troopautres_passnoentry2", [(play_sound, "snd_alt"),]],
  
  [anyone|plyr ,"alt_cordon_troopautres_passnoentry2", [],  "Entendu.", "close_window", []],
  
  
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_cordon_breton_guard4"),
    ],
    "Halte! cessez de regarder ces murs et disparaissez d'ici.", "alt_cordon_troopautres_passnoentry3", [(play_sound, "snd_alt"),]],
  
  [anyone|plyr ,"alt_cordon_troopautres_passnoentry3", [],  "Entendu.", "close_window", []],
  
  #garde cordon passage rapide sans laisse passe
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_cordon_breton_guard1"),
      (eq, "$passage_debloquee_entree_lorges", 1),
    ],
    "Halte! Oh c'est vous...", "alt_cordon_troopautres_pass1", [(play_sound, "snd_alt"),]],
  
  [anyone|plyr ,"alt_cordon_troopautres_pass1", [],  "Je voudrais passer.", "alt_cordon_troopautres_pass2", []],
  [anyone|plyr ,"alt_cordon_troopautres_pass1", [],  "Attendez, j'ai encore a faire.", "close_window", []],
  
  [anyone ,"alt_cordon_troopautres_pass2", [],"Oui, oui...faites attention a vous d'accord ? je ne voudrai pas etre obligé d'entrer la dedans pour vous rechercher si vous disparaissez.", "close_window",
    [
      (call_script, "script_rpg_foret2"),
  ]],
  
  
  #
  
  
  
  
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_cordon_breton_guard1"),
      (player_has_item, "itm_laisse_passer_lorges"),
    ],
    "Halte! on ne passe pas sur ordre du Duc Jean V de Bretagne.", "alt_cordon_troop1", [(play_sound, "snd_alt"),]],
  
  [anyone|plyr ,"alt_cordon_troop1", [],  "Quelle concidence, j'ai justement un laissé passé signé de sa main.", "alt_cordon_troop1suit", []],
  [anyone|plyr ,"alt_cordon_troop1", [],  "Très bien, je m'en vais.", "close_window", []],
  
  [anyone ,"alt_cordon_troop1suit", [],"Hum...c'est bon, passez, mais vous seul, les ordres sont clairs, pas d'entrées ni de sorties a part les porteurs d'un laissé passé, si vous voullez faire entrer une armée, il leur faudra un laissé passé a chaqun.", "close_window",
    [
      (troop_remove_item, "trp_player","itm_laisse_passer_lorges"),
      (assign, "$passage_debloquee_entree_lorges", 1),
      (assign, "$dial_town_walker_entree_foret", 0),
      (call_script, "script_rpg_foret2"),
  ]],
  
  
  
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_cordon_breton_guard1"),
    ],
    "Halte! on ne passe pas sur ordre du Duc Jean V de Bretagne.", "alt_cordon_troop1ff", [(play_sound, "snd_alt"),]],
  
  [anyone|plyr ,"alt_cordon_troop1ff", [],  "Très bien, je m'en vais.", "close_window", []],
  
  
  
  
  #### garde entree auberge plus quetes ##########################
  
  
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_dial_Penthiv_troop1"),
      (neg|check_quest_active, "qst_tuer_mercenaire"),
      (check_quest_succeeded, "qst_tuer_mercenaire"),
      (neg|check_quest_failed, "qst_tuer_mercenaire"),
      (check_quest_finished, "qst_tuer_mercenaire"),
      
    ],
    "Ouais ouais, j'ai pas le temps de parler, tu peut entrer a l'auberge.", "degage_auberge",
    [
      #(assign, "$porte_de_auberge", 1),#####retirer CA cette ligne juste pour le test 2
  ]],
  
  
  [anyone|plyr ,"degage_auberge", [],  "Bien...", "close_window", []],
  
  
  
  
  
  
  ### j'ai tu?l'aventurier et mission win
  
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_dial_Penthiv_troop1"),
      (check_quest_active, "qst_tuer_mercenaire"),
      (check_quest_succeeded, "qst_tuer_mercenaire"),
      (neg|check_quest_failed, "qst_tuer_mercenaire"),
      (neg|check_quest_finished, "qst_tuer_mercenaire"),
    ],
    "Alors, ce maraud est mort ?", "tuee_marraud",
    [
      #(assign, "$porte_de_auberge", 1),#####retirer CA cette ligne juste pour le test 2
  ]],
  
  
  [anyone|plyr ,"tuee_marraud", [],  "Oui, il ne viendra plus.", "tuee_marraud2",
    [
      (call_script, "script_end_quest", "qst_tuer_mercenaire"),
      
  ]],
  
  [anyone ,"tuee_marraud2", [],"Et ben, on dirais que tu ment pas, je ne voie plus sa tete de porc fouiner partout. C'est bon, entre et va voir le chef a l'étage, on t'éxpliquera la situation.", "close_window",
    [
      (assign, "$porte_de_auberge", 1),
      (display_message, "@La porte est déverouillée."),
      (play_sound, "snd_porte_fermee"),
  ]],
  
  
  
  
  ### en attente de tuer l'aventurier
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_dial_Penthiv_troop1"),
      (check_quest_active, "qst_tuer_mercenaire"),
      (neg|check_quest_succeeded, "qst_tuer_mercenaire"),
      (neg|check_quest_failed, "qst_tuer_mercenaire"),
      (neg|check_quest_finished, "qst_tuer_mercenaire"),
    ],
    "Alors, ce maraud est mort ?", "where_marraud",
    [
      #(assign, "$porte_de_auberge", 1),#####retirer CA cette ligne juste pour le test 2
  ]],
  
  
  [anyone|plyr ,"where_marraud", [],  "Ou puis je trouver cet type exactement ?", "where_marraud2", []],
  
  [anyone ,"where_marraud2", [],"Qu'est c'que j'en sait...cherche le dans la foret, un nigaud avec une capuche et une veste de cuir et mailles, il as aussi une sacrée tete de con, tu peut pas l'rater.", "close_window",[]],
  
  
  
  #########
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_dial_Penthiv_troop1"),
      #(eq, "$sssssssssssssssss", 1),
    ],
    "Eh la ! ou crois tu aller ?", "prem_dial_garde_pore_aubmine",
    [(play_sound, "snd_alt"),
      #(assign, "$porte_de_auberge", 1),#####retirer CA cette ligne juste pour le test 2
  ]],
  
  
  [anyone|plyr ,"prem_dial_garde_pore_aubmine", [],  "Je veux...du travail, je voudrai vous rejoindre pour pouvoir porter cette cotte de mailles moi aussi.", "prem_dial_garde_pore_aubmine2", []],
  
  [anyone ,"prem_dial_garde_pore_aubmine2", [],"Ah oui ?...hum, dans ce cas, je pourais te présenter au chef, mais faut que tu fasse tes preuves avant, pourrais tu tuer un homme si il ne t'as rien fait ?", "prem_dial_garde_pore_aubmine3",[]],
  
  [anyone|plyr ,"prem_dial_garde_pore_aubmine3", [],  "Si je peut tuer pour de la boisson et de l'or ? bien entendu !", "prem_dial_garde_pore_aubminoktuer", []],
  [anyone|plyr ,"prem_dial_garde_pore_aubmine3", [],  "Pourquois diable ?", "prem_dial_garde_pore_aubmindiab", []],
  [anyone ,"prem_dial_garde_pore_aubmindiab", [],"C'est bien ce que je penssais, dégage d'ici ou je te montre comment on fait pour tuer quelqu'un.", "close_window",[]],
  
  [anyone ,"prem_dial_garde_pore_aubminoktuer", [],"Bonne réponse, voila ce que j'aime a entendre ahah! écoute, y'as un sale type qui viens et qui pose des questions aux geux et aux femmes de mineurs, retrouve le et fait lui la peau ce type est louche, il doit etre envoyé par le Duc ou un des ses ésclaves nobles, tu le tue et tu pourra entrer voir le chef, c'est le moment d'agir après de belles paroles, va.", "close_window",
    [
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Je doit aller voir l'Echanson du Duc qui est a l'auberge du village de la mine dans la foret de Lorges pour en apprendre plus, mais l'entrée de l'auberge est défendue par un garde, il me demande de tuer un aventurier qui pose des questions aux mineurs du village, et le garde pense qu'il est contre eux. Il di qu'il me laissera entrer si je tue l'aventurier."),
      (call_script, "script_start_quest", "qst_tuer_mercenaire", "$g_talk_troop"),
      
  ]],
  
  ####################################
  #### garde entree auberge deuxieme garde
  
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_dial_Penthiv_troop2"),
    ],
    "Qu'est ce que vous foutez la ? du balai.", "dial_garde_aunbmine_bali",
    [
  ]],
  
  
  [anyone|plyr ,"dial_garde_aunbmine_bali", [],  "Je m'en vais.", "close_window", []],
  
  
  ########dial maire village ###############################################################
  ###########################################################################################
  
  #si quete terrier d hermines de fer WIN, lance autres quetes ICI !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
  
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_maire_auberge_broceliand"),
      
      
      # ?#  (check_quest_active, "qst_terrier"),
      (check_quest_succeeded, "qst_terrier"),
      (neg|check_quest_failed, "qst_terrier"),
      #?#   (neg|check_quest_finished, "qst_terrier"),
      
    ],
    "Et bien Messire, avez vous trouvé ce que vous cherchiez ?", "attente_pour_terrierwin",
    [
      
  ]],
  
  
  [anyone|plyr ,"attente_pour_terrierwin", [],  "Oui, c'est bien ce que vous m'aviez dit, mes remerciements messire.", "close_window",
    
    [
      (call_script, "script_end_quest", "qst_terrier"),
  ]],
  
  ########raccorder !!!!!!!!>>>>>>>
  ########  [anyone ,"attente_pour_terrierwin2", [],"Un instant mercenaire, nous aurrions besoin de vous ici...", "attente_pour_terrierwin3",[],
  
  
  
  
  
  #si quete active terrier d hermines de fer en attente
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_maire_auberge_broceliand"),
      
      
      (check_quest_active, "qst_terrier"),
      (neg|check_quest_succeeded, "qst_terrier"),
      (neg|check_quest_failed, "qst_terrier"),
      (neg|check_quest_finished, "qst_terrier"),
      
    ],
    "Et bien Messire, avez vous trouvé ce que vous cherchiez ?", "attente_pour_terrier",
    [
  ]],
  
  
  [anyone|plyr ,"attente_pour_terrier", [],  "Pas encore, mais je suis sur cette affaire.", "close_window",[]],
  
  
  
  
  
  
  ########dial maire village mine QUETE MINE WIN
  
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_maire_auberge_broceliand"),
      
      
      (check_quest_active, "qst_expedition_mine"),
      (check_quest_succeeded, "qst_expedition_mine"),
      (neg|check_quest_failed, "qst_expedition_mine"),
      (neg|check_quest_finished, "qst_expedition_mine"),
      
    ],
    "Et bien ? que s'est t-il passé ?", "win_pour_miine",
    [
      (call_script, "script_end_quest", "qst_expedition_mine"),
  ]],
  
  
  [anyone|plyr ,"win_pour_miine", [],  "Vous pouvez vous détendre Messire, les mineurs sont saufs, ont ne peut pas en dire autant de leurs ravisseurs.", "win_pour_miine2",[]],
  
  [anyone ,"win_pour_miine2", [],"Comment vous remercier ? vous estes vraiment précieux mercenaire!", "win_pour_miine3",[]],
  
  [anyone ,"win_pour_miine3", [],"Et bien vous pouvez m'aider, le Duc m'a aussi chargé de découvrir comment les troupes de De Penthièvre font pour passer le cordon et sortir de la foret pour réaliser leurs méfaits, avez vous une idée ?", "win_pour_miine4",[]],
  
  
  [anyone ,"win_pour_miine4", [],"J'ai bien une idée mais je ne suit pas sur, les mineurs avaient remarqués que les manteaux de fer rodaient dans l'ancienne exploitation minière, jusqu'a present nous avons cru qu'ils s'étaient trompés d'endroit avant de trouver l'entrée de la mine active.", "win_pour_miine5",[]],
  [anyone ,"win_pour_miine5", [],"Mais maintenant tout est clair! ils doivent avoir trouvé un passage pour sortir de la foret par les tunels, allez vous en assurer. L'entrée de l'ancienne mine est a gauche en entrant a la croisée par le sud, vous devriez voir un panneau au sol qui indiquais l'ancienne exploitation.", "win_pour_miine6",[]],
  
  [anyone ,"win_pour_miine6", [],"Si vous trouvez des manteaux de fer la bas, rappellez leur nostre bon souvenir.", "close_window",
    [
      ##REMETTRE CA PAR VOIX NORMALE !!! pas loose
      
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@L'Echanson du Duc pense avoir découvert comment les troupes de De Penthièvre font pour sortir du cordon, si cela s'avère exact j'aurais remplis ma mission, Je touche peut etre au but."),
      (call_script, "script_start_quest", "qst_terrier", "$g_talk_troop"),
      
      (assign, "$grottes_can_spawn", 1),
  ]],
  
  
  
  
  
  ########dial maire village mine attente de volontaires ?hou? = temps limite pass?24 h
  
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_maire_auberge_broceliand"),
      #si quete active trouver volontaires
      
      (check_quest_active, "qst_volntaires_mine"),
      (check_quest_failed, "qst_volntaires_mine"),
      (neg|check_quest_succeeded, "qst_volntaires_mine"),
      (neg|check_quest_finished, "qst_volntaires_mine"),
      
    ],
    "Bon sang, mais qu'avez vous fait !? Il est trop tard, les ouvriers ont tous été tués et leurs boureaux se sont enfuits dans la foret.", "fail_pour_miine",
    [
      (call_script, "script_end_quest", "qst_volntaires_mine"),
  ]],
  
  
  [anyone|plyr ,"fail_pour_miine", [],  "Je suis on ne peut plus navré, j'ai fait de mon mieux... il faut leur faire payer, le Duc m'a aussi chargé de découvrir comment les troupes de De Penthièvre font pour passer le cordon et sortir de la foret pour réaliser leurs méfaits, avez vous une idée ?", "fail_pour_miine2",[]],
  
  
  
  [anyone ,"fail_pour_miine2", [],"J'ai bien une idée mais je ne suit pas sur, les mineurs avaient remarqués que les manteaux de fer rodaient dans l'ancienne exploitation minière, jusqu'a present nous avons cru qu'ils s'étaient trompés d'endroit avant de trouver l'entrée de la mine active.", "fail_pour_miine3",[]],
  [anyone ,"fail_pour_miine3", [],"Mais maintenant tout est clair! ils doivent avoir trouvé un passage pour sortir de la foret par les tunels, allez vous en assurer. L'entrée de l'ancienne mine est a gauche en entrant a la croisée par le sud, vous devriez voire un panneau au sol qui indiquais l'ancienne exploitation.", "fail_pour_miine4",[]],
  [anyone ,"fail_pour_miine4", [],"Si vous trouvez des manteaux de fer la bas, rappellez leur le bon souvenir de nos enfants perdus.", "close_window",
    [
      ##REMETTRE CA PAR VOIX NORMALE !!! pas loose
      
      
  ]],
  
  
  
  
  ########dial maire village mine attente de retour mine quete expedition active  ################################
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_maire_auberge_broceliand"),
      #si quete active trouver volontaires
      
      (check_quest_active, "qst_expedition_mine"),
      (neg|check_quest_succeeded, "qst_expedition_mine"),
      (neg|check_quest_failed, "qst_expedition_mine"),
      (neg|check_quest_finished, "qst_expedition_mine"),
      
    ],
    "Avez vous retrouvé les mineurs ? hatez vous je vous prie.", "attpret_pour_miine",[]],
  
  
  
  [anyone|plyr ,"attpret_pour_miine", [],  "Je m'en occuppe.", "close_window", []],
  
  
  
  
  ###################################
  
  
  
  ########dial maire village mine attente de volontaires, peut deja lancer la quete et a tout moment  ################################
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_maire_auberge_broceliand"),
      #si quete active trouver volontaires
      
      (check_quest_active, "qst_volntaires_mine"),
      (neg|check_quest_succeeded, "qst_volntaires_mine"),
      (neg|check_quest_failed, "qst_volntaires_mine"),
      (neg|check_quest_finished, "qst_volntaires_mine"),
      
    ],
    "Etes vous pret a descendre ? hatez vous je vous prie.", "pret_pour_miine",[]],
  
  
  [anyone|plyr ,"pret_pour_miine", [],  "Nous sommes assez nombreux, descendons dans les tunels!", "pret_pour_miinego",
    [
      (call_script, "script_succeed_quest", "qst_volntaires_mine"),
      (call_script, "script_end_quest", "qst_volntaires_mine"),
      
      
  ]],
  [anyone|plyr ,"pret_pour_miine", [],  "Pas encore, mais je reviendrais avant demain, quite a descendre seul.", "close_window", []],
  
  [anyone ,"pret_pour_miinego", [],"Pafait! avec un peut de chance ils n'aurons pas remarqué que leur chef n'est plus la. Faites attention a vous Messires je vous en prie ! prennez ces torches et préparez vous avant de descendre, tachez de ramener tout le monde vivant.", "pret_pour_miinego2",
    [
      #donner une torche
      #lancer la quete : dans la mine
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Mon expedition est prete a descendre dans les tunels de la mine, nous devrons tuer tous les soldats que nous croiserons et surtout libérer les mineurs."),
      (call_script, "script_start_quest", "qst_expedition_mine", "$g_talk_troop"),
      (quest_set_slot, "qst_expedition_mine", slot_quest_expiration_days, 1),
      (troop_add_item, "trp_player", "itm_torch", 0),
  ]],
  
  
  [anyone ,"pret_pour_miinego2", [],"Prennez aussi la clé de la mine, n'oubliez pas, nous comprons sur vous. Que Dieu accompagne le bras qui tiens votre épée.", "close_window",
    [
      #donner une torche donner variable debloque porte et donner symbolique clef
      (assign, "$porte_de_mine", 1),
      (troop_add_item, "trp_player", "itm_cle_mine", 0),
      
  ]],
  
  
  
  
  
  
  
  
  ########dial maire village mine lance la quete trouver volontaires ################################
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_maire_auberge_broceliand"),
      (eq, "$no_spawn_garde_ent_auberge_mine", 1),
    ],
    "Qu'avez vous fait ? ces soldats ne sont pas les seuls, il y en as d'autre plein la mine qui gardent les ouvriers, si ils n'ont point de nouvelles de leur chef ils vont executer tout le monde en bas !", "maire_aubermin_quete_voltr",
    [
      #(assign, "$no_spawn_garde_ent_auberge_mine", 1),#####retirer CA cette ligne juste pour le test
  ]],
  
  
  [anyone|plyr ,"maire_aubermin_quete_voltr", [],  "Merci de m'avoir aidé avec ces brutes...Je viens quand meme vous aider, je suis mendé par votre Duc, que faut t-il faire pour empécher ce massacre ?", "maire_aubermin_quete_voltr2", []],
  
  
  [anyone ,"maire_aubermin_quete_voltr2", [],"le Duc ! Dieu soit loué, il vous faut trouver des volontaire dans la région au plus vite ils sont nombreux la dessous, en suite dirigez vous dans les tunels et prions pour que vous puissiez tuer les gardes avant qu'il n'égorgent les notres.", "maire_aubermin_quete_voltr3",[]],
  [anyone|plyr ,"maire_aubermin_quete_voltr3", [],  "Avez vous une idée des endroits ou je pourais trouver des volontaires ?", "maire_aubermin_quete_voltr4", []],
  
  
  [anyone ,"maire_aubermin_quete_voltr4", [],"Non je ne sait pas, parcourez la foret et ramennez tout ceux que vous trouverez le plus vite possible, d'ici demain ils auront tué tout le monde, allez prestement mon ami.", "close_window",
    [
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@L'Echanson du Duc m'as revelé que les mineurs sont prisoniers des troupes de De penthièvre au fond de la mine, je doit rassembler des volontaires pour partir a la recherche des survivants dans les tunels sérieusement gardés pour les libérer et faire repartir la production de la mine pour le compte du Duc."),
      (call_script, "script_start_quest", "qst_volntaires_mine", "$g_talk_troop"),
      (quest_set_slot, "qst_volntaires_mine", slot_quest_expiration_days, 1),
  ]],
  
  
  
  
  ############dial maire village mine premier dial
  [anyone ,"start", [(eq, "$g_talk_troop", "trp_maire_auberge_broceliand"),
      #(eq, "$sssssssssssssssss", 1),
    ],
    "Qui que vous soyez, Faites attention avant de vous mellez de certaines affaires, ces gens sont dangereux.", "maire_aubermin_dang",
    [(play_sound, "snd_maitre_guild"),
      #(assign, "$no_spawn_garde_ent_auberge_mine", 1),#####retirer CA cette ligne juste pour le test
  ]],
  
  
  [anyone|plyr ,"maire_aubermin_dang", [],  "N'ayez craintes.", "close_window", []],
  
  
  
  
  
  
  
  
  #####dial tuer l'aventuruier
  [anyone,"start", [(eq, "$g_talk_troop", "trp_mercenair_aventurier"),
    ],
    "Me suivez vous messire ?", "tuer_aventmercenair", []],
  
  [anyone|plyr ,"tuer_aventmercenair", [],  "Cela se pourrais, etes vous celui qui enquete sur le village de la mine et ses habitants ?", "tuer_aventmercenair2", []],
  
  [anyone ,"tuer_aventmercenair2", [],"Peut etre.", "tuer_aventmercenair3",[]],
  [anyone|plyr ,"tuer_aventmercenair3", [],  "Je suis mandé par le Duc de Bretagne pour moi meme enqueté sur la mine.", "tuer_aventmercenair4", []],
  
  [anyone ,"tuer_aventmercenair4", [],"Tout comme moi.", "tuer_aventmercenair5",[]],
  [anyone|plyr ,"tuer_aventmercenair5", [],  "Bien ! alors il faudrais que vous disparaissiez un moment, le garde de l'auberge me laissera passer si je lui dit que je vous ai...fait parir, et nous pourrons continuer a enqueter, qu'en dites vous ?", "tuer_aventmercenair6", []],
  
  [anyone ,"tuer_aventmercenair6", [],"Vous foutez vous de moi ? hors de question, et si vous disparaissiez vous ? j'irais voir le garde en disant que MOI je vous ai tué.", "tuer_aventmercenair7",[]],
  [anyone|plyr ,"tuer_aventmercenair7", [],  "Ca risque de ne pas marcher, c'est vous que le garde soupconne et c'est moi qu'il attend avec une telle information.", "tuer_aventmercenair8", []],
  
  [anyone ,"tuer_aventmercenair8", [],"Et vous voulmlez me tuer sottard ??", "tuer_aventmercenair9",[]],
  
  [anyone|plyr ,"tuer_aventmercenair9", [],  "Pas du tout, vous pourriez...bon.", "close_window",
    [
      (mission_disable_talk),
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 1, 0, -1),
      (play_sound, "snd_man_warcry"),
  ]],
  
  
  
  
  
  
  
  #####dial aubergiste nouveau
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_aubergiste_auberge_broceliand"),
      (eq, "$fin_dial_aubergistemine", 1),###
    ],
    "Encore en vie ? ca alors, c'est toujours un plaisir de vous voire passer cette porte.", "xxnewaub_ofre_unverrmine",
    [
      
  ]],
  
  
  [anyone|plyr ,"xxnewaub_ofre_unverrmine", [],  "Qu'avez vous a vendre ?", "xxnewaub_ofre_unverrminevent", []],
  [anyone|plyr ,"xxnewaub_ofre_unverrmine", [],  "Que pouvez vous me dire sur le village de la mine.", "xxnewaub_ofre_unverrminetalkmine", []],
  [anyone|plyr ,"xxnewaub_ofre_unverrmine", [],  "Je reviendrai.", "xxnexaub_ofre_unverrmine33", []],
  
  [anyone ,"xxnewaub_ofre_unverrminevent", [],"Vous n'allez pas vous mettre a boire et tout casser comme les mineurs hein.", "xxnewaub_ofre_unverrminretour",[change_screen_trade]],
  
  
  [anyone ,"xxnewaub_ofre_unverrminretour", [],"Autre chose ?", "xxnewaub_ofre_unverrmine",[]],
  
  
  [anyone ,"xxnewaub_ofre_unverrminetalkmine", [],"C'est le village des mineurs, ils travaillent dur pour éxtraire le fer pour le compte du Duc, quois que nous fassions nous les geux on finis toujours par payer pour les erreurs des autres", "xxnewaub_ofre_unverrminetalkmine2",[]],
  [anyone|plyr ,"xxnewaub_ofre_unverrminetalkmine2", [],  "Et la mine ?", "xxnewaub_ofre_unverrminetalkmine3", []],
  [anyone ,"xxnewaub_ofre_unverrminetalkmine3", [],"Je n'y ai jamais mis les pieds, mais il parait qu'elle descend sur trois niveaux et qu'on y voie comme a travers une pelle...a vrais dire sans vous offenser, je m'en fiche plutot bien de cette mine.", "xxnewaub_ofre_unverrminretour",[]],
  
  
  
  [anyone ,"xxnexaub_ofre_unverrmine33", [],"Ca pour sur, c'est ce qu'ils disent tous.", "close_window",
    [
      
  ]],
  
  #####################
  #win porte lac
  [anyone,"start", [(eq, "$g_talk_troop", "trp_aubergiste_auberge_broceliand"),
      
      (check_quest_active, "qst_port_lac"),
      (check_quest_succeeded, "qst_port_lac"),
      (neg|check_quest_failed, "qst_port_lac"),
      (neg|check_quest_finished, "qst_port_lac"),
      
    ],
    "Content de vous revoir, la porte du lac est t-elle libre ?", "win_portelac",
    [
      
  ]],
  
  
  [anyone|plyr ,"win_portelac", [],  "La porte est grande ouverte, les marchands vont bientot le savoir.", "win_portelac2", []],
  
  
  [anyone ,"win_portelac2", [],"Grande nouvelle ! voici pour vous, des victuailles comme promis.", "close_window",
    [
      
      (assign, "$fin_dial_aubergistemine", 1),
      (call_script, "script_end_quest", "qst_port_lac"),
      
      (troop_add_item, "trp_player", "itm_choppe_bier", 0),
      (troop_add_item, "trp_player", "itm_choppe_bier", 0),
      (troop_add_item, "trp_player", "itm_sausc", 0),
      (troop_add_item, "trp_player", "itm_bread", 0),
  ]],
  
  
  
  
  #en attente porte lac libre
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_aubergiste_auberge_broceliand"),
      
      (check_quest_active, "qst_port_lac"),
      (neg|check_quest_succeeded, "qst_port_lac"),
      (neg|check_quest_failed, "qst_port_lac"),
      (neg|check_quest_finished, "qst_port_lac"),
      
    ],
    "Content de vous revoir, la porte du lac est t-elle libre ?", "attente_portelac",
    [
      
  ]],
  
  
  [anyone|plyr ,"attente_portelac", [],  "J'y travaille.", "attente_portelacsrvice", []],
  
  
  [anyone ,"attente_portelacsrvice", [],"Vous vouliez autre chose ?", "attente_portelacstart",[]],
  
  
  [anyone|plyr ,"attente_portelacstart", [],  "Qu'avez vous a boire et a manger ?", "attente_portelacmanger", []],
  [anyone|plyr ,"attente_portelacstart", [],  "Pas pour le moment, mais je reviendrai.", "attente_portelacdisnttous", []],
  
  
  [anyone ,"attente_portelacmanger", [],"Vous n'allez pas vous mettre a boire et tout casser comme les mineurs hein.", "attente_portelacsrvice",[change_screen_trade]],
  
  
  [anyone ,"attente_portelacdisnttous", [],"Pour sur, ils reviennent tous.", "close_window",[]],
  
  ####
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_aubergiste_auberge_broceliand"),
      (eq, "$new_dial_aubergistemine", 1),
    ],
    "Messire, j'ai un service a vous demander.", "newaub_ofre_unverrmine",
    [
      
  ]],
  
  
  [anyone|plyr ,"newaub_ofre_unverrmine", [],  "De quois avez vous besoin ?", "newaub_ofre_unverrminevent", []],
  [anyone|plyr ,"newaub_ofre_unverrmine", [],  "Pas pour le moment.", "close_window", []],
  
  [anyone ,"newaub_ofre_unverrminevent", [],"Plus aucune marchandise ne nous parvient et ce a cause du blocus de la porte du lac, si vous arriviez a libérer la porte les marchands pourraient passer de nouveau et nous serions ravitaill?, nous vous en serons reconnaissants et vous aurrez des vivres en récompense. qu'en dites vous ?", "newaub_ofre_portelac",[]],
  
  
  [anyone|plyr ,"newaub_ofre_portelac", [],  "C'est entendu, j'irai voir ce qu'il se passe la bas.", "newaub_ofre_portelacstart",
    [
      #(assign, "$fin_dial_aubergistemine", 1),
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@L'aubergiste de l'auberge du village de la mine dans la foret de Lorges, m'as demandé de lever le blocus de la porte du lac pour que les marchandises puissent parvenir de nouveau au village, il me donnera des vivres en retour."),
      (call_script, "script_start_quest", "qst_port_lac", "$g_talk_troop"),
      
  ]],
  [anyone|plyr ,"newaub_ofre_portelac", [],  "Je ne peut pas pour le moment.", "newaub_ofre_unverrminretour", []],
  
  [anyone ,"newaub_ofre_portelacstart", [],"Merci beaucoup, nous croyons en vous.", "newaub_ofre_unverrminretour",[]],
  
  
  
  
  
  [anyone ,"newaub_ofre_unverrminretour", [],"Vous vouliez autre chose ?", "newaub_ofre_unverrmine2",[]],
  
  
  [anyone|plyr ,"newaub_ofre_unverrmine2", [],  "Qu'avez vous a boire et a manger ?", "aanewaub_ofre_unverrminemange", []],
  [anyone|plyr ,"newaub_ofre_unverrmine2", [],  "Pas pour le moment.", "close_window", []],
  
  
  
  [anyone ,"aanewaub_ofre_unverrminemange", [],"Vous n'allez pas vous mettre a boire et tout casser comme les mineurs hein.", "newaub_ofre_unverrminretour",[change_screen_trade]],
  
  
  
  
  
  #####dial aubergiste
  [anyone,"start", [(eq, "$g_talk_troop", "trp_aubergiste_auberge_broceliand"),
      (eq, "$no_spawn_garde_ent_auberge_mine", 1),
    ],
    "Mais voila notre sauveur ! je vous offre un verre mais il faudra payer les autres d'accord ?", "aub_ofre_unverrmine",
    [
      (troop_add_item, "trp_player", "itm_choppe_bier", 0),
  ]],
  
  [anyone|plyr ,"aub_ofre_unverrmine", [],  "Merci pour le verre.", "aub_ofre_unverrminethx", []],
  [anyone|plyr ,"aub_ofre_unverrmine", [],  "Qu'avez vous a vendre ?", "aub_ofre_unverrminevent", []],
  [anyone|plyr ,"aub_ofre_unverrmine", [],  "Que pouvez vous me dire sur le village de la mine.", "aub_ofre_unverrminetalkmine", []],
  [anyone|plyr ,"aub_ofre_unverrmine", [],  "Je reviendrai.", "aub_ofre_unverrmine33", []],
  
  [anyone ,"aub_ofre_unverrminethx", [],"C'est la moindre des choses.", "aub_ofre_unverrmine",[]],
  [anyone ,"aub_ofre_unverrminevent", [],"Pas grand chose par les temps qui courent, surtout de la bierre a vrai dire, a en croire que les mineurs ne boivent plus que ce qu'ils mangent.", "aub_ofre_unverrminretour",[change_screen_trade]],
  
  
  [anyone ,"aub_ofre_unverrminretour", [],"Autre chose ?", "aub_ofre_unverrmine",[]],
  
  
  [anyone ,"aub_ofre_unverrminetalkmine", [],"C'est le village des mineurs, ils travaillent dur pour éxtraire le fer pour le compte du Duc, quois que nous fassions nous les geux on finis toujours par payer pour les erreurs des autres", "aub_ofre_unverrminetalkmine2",[]],
  [anyone|plyr ,"aub_ofre_unverrminetalkmine2", [],  "Et la mine ?", "aub_ofre_unverrminetalkmine3", []],
  [anyone ,"aub_ofre_unverrminetalkmine3", [],"Je n'y ai jamais mis les pieds, mais il parait qu'elle descend sur trois niveaux et qu'on y voie comme a travers une pelle...a vrais dire sans vous offenser, je m'en fiche plutot bien de cette mine.", "aub_ofre_unverrminretour",[]],
  
  
  
  [anyone ,"aub_ofre_unverrmine33", [],"Ca pour sur, ils reviennent tous.", "close_window",
    [
      (assign, "$new_dial_aubergistemine", 1),
  ]],
  
  
  ###premier dial aubergiste
  [anyone,"start", [(eq, "$g_talk_troop", "trp_aubergiste_auberge_broceliand"),
    ],
    "Sauvez nous messire, qui que vous soyez.", "sauv_aubergg", []],
  
  [anyone|plyr ,"sauv_aubergg", [],  "Restez a l'écart.", "close_window", []],
  
  
  
  
  
  
  
  
  
  
  
  
  ######### dials otages mineurs
  
  ##chef mineur j'ai tu?tout le monde = mission win
  [anyone,"start", [(eq, "$g_talk_troop", "trp_otage_mineur1"),
      (eq, "$mine_fer_broceliand_lvl_3_clear", 1),
    ],
    "A l'aide, faites nous sortir d'ici. Nous ne sommes pas remontés depuis je ne sait quand, je n'ai jamais eu le gosier aussi sec.", "otage_mine_fin",
    [
      (call_script, "script_succeed_quest", "qst_expedition_mine"),
      
  ]],
  
  
  [anyone|plyr ,"otage_mine_fin", [],  "Il n'y as plus rien a craindre vous etes libres.", "close_window", []],
  
  
  ##chef mineur reste des troops ennemies
  [anyone,"start", [(eq, "$g_talk_troop", "trp_otage_mineur1"),
      
    ],
    "A l'aide, faites nous sortir d'ici. faites attention, il y en as d'autres.", "otage_mine_autre",
    [
      
  ]],
  
  
  [anyone|plyr ,"otage_mine_autre", [],  "Restez ici, je m'occuppe d'eux.", "close_window", []],
  
  ##mineur
  [anyone,"start", [(eq, "$g_talk_troop", "trp_otage_mineur2"),
      
    ],
    "A l'aide, sortez nous d'ici.", "ssotage_mine_autre",
    [
      
  ]],
  
  
  [anyone|plyr ,"ssotage_mine_autre", [],  "Calmez vous.", "close_window", []],
  
  
  ##mineur
  [anyone,"start", [(eq, "$g_talk_troop", "trp_otage_mineur3"),
      
    ],
    "A l'aide.", "osstage_mine_autre",
    [
      
  ]],
  
  
  [anyone|plyr ,"osstage_mine_autre", [],  "Vous allez vous en sortir.", "close_window", []],
  
  
  ##mineur
  [anyone,"start", [(eq, "$g_talk_troop", "trp_otage_mineur4"),
      
    ],
    "Faites nous remonter.", "jjotage_mine_autre",
    [
      
  ]],
  
  
  [anyone|plyr ,"jjotage_mine_autre", [],  "C'est bientot fini.", "close_window", []],
  
  
  #dial chasseur perdu arbalete auberge
  
  #apres quete win
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chasseur_auberge"),
      (neg|check_quest_active, "qst_bois_descerfs"),
      (check_quest_succeeded, "qst_bois_descerfs"),
      (neg|check_quest_failed, "qst_bois_descerfs"),
      (check_quest_finished, "qst_bois_descerfs"),
    ],
    "Merci d'avoir retrouver mon arbalète messire.", "chasseur_aub_queterewinof",
    [
      
  ]],
  
  
  [anyone|plyr ,"chasseur_aub_queterewinof",[],"Merci pour le gibier avarié.", "close_window",[]],
  
  
  
  #win j'ai l'arbalete
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chasseur_auberge"),
      
      (player_has_item, "itm_quest_sniper_crossbow"),
    ],
    "Avez vous retrouvé mon arbalète messire ?", "chasseur_aub_queterewin",
    [
      
  ]],
  
  
  [anyone|plyr ,"chasseur_aub_queterewin",[],"Je l'ai, la voici.", "chasseur_aub_queterewindone",
    [
      (troop_remove_item, "trp_player","itm_quest_sniper_crossbow"),
  ]],
  [anyone|plyr ,"chasseur_aub_queterewin",[],"Je ne l'ai pas retrouvée, vous allez devoir apprendre a vivre sans elle.", "chasseur_aub_queterenowin",
    [
      (call_script, "script_fail_quest", "qst_bois_descerfs"),
      (call_script, "script_end_quest", "qst_bois_descerfs"),
  ]],
  
  
  [anyone ,"chasseur_aub_queterenowin", [],"C'est une mauvaise nouvelle, mais je ne laisserais point tomber, merci d'avoir quand meme éssayé.", "close_window",
    [
  ]],
  
  [anyone ,"chasseur_aub_queterewindone", [],"Mon arbalète ! je vous remercie de tout coeur messire, prennez ce gibier pour vous remercier.", "chasseur_aub_queterewindone2",
    [
      (troop_add_item, "trp_player", "itm_fesan", 0),
      (troop_add_item, "trp_player", "itm_fesan", 0),
      (call_script, "script_succeed_quest", "qst_bois_descerfs"),
      (call_script, "script_end_quest", "qst_bois_descerfs"),
  ]],
  
  [anyone|plyr ,"chasseur_aub_queterewindone2",[],"Du gibier faisandé avec tout le mal que je me suit donné ? quelle générosité.", "close_window",
    [
      
  ]],
  
  #quete failed
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chasseur_auberge"),
      (neg|check_quest_active, "qst_bois_descerfs"),
      (neg|check_quest_succeeded, "qst_bois_descerfs"),
      (check_quest_failed, "qst_bois_descerfs"),
      (check_quest_finished, "qst_bois_descerfs"),
    ],
    "Comment vais je retrouver cette arbalète...", "chasseur_aub_queterefini",
    [
      
  ]],
  
  
  [anyone|plyr ,"chasseur_aub_queterefini",[],"Je vous shouaite bonne chance.", "close_window",[]],
  
  
  
  
  #quete active on peut la desactiver et failed en parlant au chasseur
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chasseur_auberge"),
      (check_quest_active, "qst_bois_descerfs"),
      (neg|check_quest_succeeded, "qst_bois_descerfs"),
      (neg|check_quest_failed, "qst_bois_descerfs"),
      (neg|check_quest_finished, "qst_bois_descerfs"),
    ],
    "Avez vous retrouvé mon arbalète ? Je suis certain de l'avoir perdu quelque part dans le bois aux cerfs.", "chasseur_aub_queterelanc",
    [
      
  ]],
  
  [anyone|plyr ,"chasseur_aub_queterelanc",[],"Ou sont ces bois des cerfs ?", "chasseur_aub_quetewhere",[]],
  [anyone|plyr ,"chasseur_aub_queterelanc",[],"J'ai bien peur de ne pas pouvoir m'en occupper.", "chasseur_aub_queteend",[]],
  [anyone|plyr ,"chasseur_aub_queterelanc",[],"Je m'en occuppe.", "close_window",[]],
  
  
  
  [anyone ,"chasseur_aub_queteend", [],"Je comprend, et bien tant pis je devrais trouver quelqu'un d'autre.", "close_window",
    [
      (call_script, "script_fail_quest", "qst_bois_descerfs"),
      (call_script, "script_end_quest", "qst_bois_descerfs"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-2),
  ]],
  [anyone ,"chasseur_aub_quetewhere", [],"Le mieux est de trouver un guide pour vous y conduire.", "chasseur_aub_queterelanc",
    [
  ]],
  
  
  
  #premier_dial
  [anyone,"start", [(eq, "$g_talk_troop", "trp_chasseur_auberge"),
      
    ],
    "Messire, je sait que vous parcourez la foret, vous me rendriez un grand service si dans vos explorations vous pouviez retrouver mon arbalète, je l'ai perdu en pistant une bete. Je suis certain de l'avoir perdu quelque part dans le bois aux cerfs.", "chasseur_aub_quete",
    [
      
  ]],
  
  [anyone|plyr ,"chasseur_aub_quete",[],"C'est entendu, j'ouvrirais l'oeil.", "chasseur_aub_quetestart",[]],
  [anyone|plyr ,"chasseur_aub_quete",[],"Je n'ai point le temps.", "close_window",[]],
  
  [anyone ,"chasseur_aub_quetestart", [],"Merci infiniement mon bon messire, je compte sur vous, cette arbalète a une grande valeure pour moi.", "close_window",
    [
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Un chasseur dans l'auberge de la foret de Lorges m'as demandé de retrouver son arbalète perdue dans le bois des cerfs, il me faut retrouver ce secteur de la foret et l'arbalète de grande valeure."),
      (call_script, "script_start_quest", "qst_bois_descerfs", "$g_talk_troop"),
      
      
  ]],
  
  
  
  ##guide auberge
  [anyone,"start", [(eq, "$g_talk_troop", "trp_guide_auberge"),
      (eq, "$dans_bois_des_cerfs", 1),
    ],
    "Que voullez vous faire ?", "guide_retour_auberge",
    [
      
  ]],
  
  [anyone|plyr ,"guide_retour_auberge",[],"Rentrons a l'auberge.", "guide_retour_aubergeend",[]],
  [anyone|plyr ,"guide_retour_auberge",[],"Je n'ai pas terminé.", "close_window",[]],
  
  [anyone ,"guide_retour_aubergeend", [],"Restez bien dérière moi.", "close_window",
    [
      (call_script, "script_rpg_auberge_mine_entre_liberee"),
  ]],
  
  
  
  
  #premiere phrase a l'auberge
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_guide_auberge"),
      
    ],
    "Avez vous besoin d'un guide ? Je connait le moindre recoin de la foret.", "guide_aubforet",
    [
      
  ]],
  
  [anyone|plyr ,"guide_aubforet",
    [
      (check_quest_active, "qst_bois_descerfs"),
      (neg|check_quest_succeeded, "qst_bois_descerfs"),
      (neg|check_quest_failed, "qst_bois_descerfs"),
      (neg|check_quest_finished, "qst_bois_descerfs"),
      
    ],
    "Pouvez vous m'amenner aux bois des cerfs ?", "aub_boiscerfs",
    [
      
  ]],
  
  [anyone ,"aub_boiscerfs", [],"Narurellement, ca vous coutera 20 écus payables d'avance.", "aub_coutboiscerf",[]],
  
  
  [anyone|plyr ,"aub_coutboiscerf",
    [
      (store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", 20),
    ],
    "Bien sur...voila.", "aub_coutboiscerf2",
    [
      (troop_remove_gold,"trp_player",20),
  ]],
  
  [anyone|plyr ,"aub_coutboiscerf", [],  "Je craint de ne pas pouvoir.", "close_window", []],
  
  
  
  [anyone|plyr ,"guide_aubforet", [],  "Peut etre plus tard.", "close_window", []],
  
  
  [anyone ,"aub_coutboiscerf2", [],"En route.", "close_window",
    [
      (assign, "$entre_auberg", 0),
      (call_script, "script_rpg_bois_des_cerfs"),
      
  ]],
  
  
  
  
  
  
  
  #gardes porte lac
  #si quete active
  [anyone,"start", [(eq, "$g_talk_troop", "trp_penthiv_troopporte_lac1"),
      
      (check_quest_active, "qst_port_lac"),
      (neg|check_quest_succeeded, "qst_port_lac"),
      (neg|check_quest_failed, "qst_port_lac"),
      (neg|check_quest_finished, "qst_port_lac"),
      
    ],
    "Demi tour, dites vous que cette porte n'est pas une porte, du vent.", "demitourte_portelac",
    [
      
  ]],
  
  
  [anyone|plyr ,"demitourte_portelac", [],  "Il me semble que c'est a vous de vous en éloigner si vous ne voullez pas mourrir.", "demitourte_portelacstartfight", []],
  [anyone|plyr ,"demitourte_portelac", [],  "J'avais cru.", "close_window", []],
  
  [anyone ,"demitourte_portelacstartfight", [],"Tu va regretter !", "close_window",
    [
      (mission_disable_talk),
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 1, 0, -1),
      (play_sound, "snd_man_warcry"),
      
  ]],
  
  
  
  #
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_penthiv_troopporte_lac1"),
    ],
    "Demi tour, dites vous que cette porte n'est pas une porte, du vent", "attente_portelacdeb",
    [
      
  ]],
  
  
  [anyone|plyr ,"attente_portelacdeb", [],  "J'avais cru.", "close_window", []],
  
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_penthiv_troopporte_lac2"),
    ],
    "Qu'est c'que tu fout encore la ?", "attente_portelacdeb2",
    [
      
  ]],
  
  
  [anyone|plyr ,"attente_portelacdeb2", [],  "J'allais partir.", "close_window", []],
  
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_penthiv_troopporte_lac3"),
    ],
    "On ne passe pas, dégage.", "attente_portelacdeb3",
    [
      
  ]],
  
  
  [anyone|plyr ,"attente_portelacdeb3", [],  "Je m'en vais pour le moment.", "close_window", []],
  
  
  
  
  
  ########## pnj perdu auberge eneigee
  
  #si me suit et quet accomplie
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pnj_mort_df"),
      
      #    (check_quest_active, "qst_pnj_perdu_foretaub"),
      (check_quest_succeeded, "qst_pnj_perdu_foretaub"),
      (neg|check_quest_failed, "qst_pnj_perdu_foretaub"),
      (neg|check_quest_finished, "qst_pnj_perdu_foretaub"),
      
    ],
    "Mon Dieu, nous allons mourrir de froid.", "mort_froid_queteaub",
    [
      
  ]],
  
  
  [anyone|plyr ,"mort_froid_queteaub", [],  "Gardons notre calme et suivons un chemin.", "close_window", []],
  
  
  
  
  
  
  #premier dial
  [anyone,"start", [(eq, "$g_talk_troop", "trp_pnj_mort_df"),
      
    ],
    "A l'aide ! sortez nous de la ou on va mourrir de froid !", "aide_sortez_dla",
    [
      (call_script, "script_succeed_quest", "qst_pnj_perdu_foretaub"),
      (agent_set_team, "$g_talk_agent", 0),
      (assign, "$pnj_mort_de_froid", 1),
      
  ]],
  
  [anyone|plyr ,"aide_sortez_dla",[],"Suivez moi, courrez.", "close_window",[]],
  
  
  
  
  
  ######################################## CRANE DE FER BEGIN ################################################################################
  
  
  #capitaine fach?plus de dials / fach?si : j'ai perdu au chateau et donc tent?l'assaut, si j'ai gagn?la prime en tuant penthievre donc j'ai la grosse somme d'argent mais plus de contrats chez le capitaine
  ###
  ##
  #!!!! assigner>  (assign, "$captain_fache", 1),   si je tue le comte et d?ob?s! juste ca au mission template + menu ou autre..."le comte de penthievre est mort! vous touchez la prime de 10.000 ecus ordonn? par le duc pour l'avoir tu?
  
  #plus de contrat mais je peut recruter
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop1"),
      
      (eq, "$captain_plusdetaf", 1),
      
      (try_begin),
        (eq, "$premier_dial_cdf", 0),
        (call_script, "script_nombre_crane_de_fer"),
      (try_end),
    ],
    "Que puis je pour vous ?", "capit_camp_dials_end",
    [
  ]],
  
  
  
  
  
  
  
  [anyone|plyr ,"capit_camp_dials_end",
    [
      # (eq, "$cd_fer_embauchee", 0),
      (store_current_hours,":cur_hours"),
      (val_sub, ":cur_hours", 48),
      (gt, ":cur_hours", "$temp_attente_6"),
    ],
    "Je voudrais personellement recruter des mercenaires de la compagnie, j'ai de quois payer.", "capit_camp_dials_endrecrut", []],
  
  
  
  
  
  [anyone ,"capit_camp_dials_endrecrut", [],"Nous disposons de {reg3} soldats en attente de contrat, ils serons ?vous pour la somme de {reg5} écus.", "capit_camp_dials_endrecrut2",[(assign, "$premier_dial_cdf", 1),]],
  
  
  [anyone|plyr,"capit_camp_dials_endrecrut2",
    [
      #si j'ai la somme et place equipe
      
      (party_get_free_companions_capacity, ":free_capacity", "p_main_party"),
      (ge,":free_capacity",reg3),
      
      (store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", reg5),
      
      
      
    ],
    "C'est parfait, je les recrute tous, voici {reg5} écus.", "capit_camp_dials_endrecrut2retour",
    [
      (troop_remove_gold,"trp_player",reg5),
      (party_add_members, "p_main_party", "trp_crane_de_fer_mercenaire", reg3),
      # (assign, "$cd_fer_embauchee", 1),
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_6", ":cur_hours"),
  ]],
  
  [anyone|plyr,"capit_camp_dials_endrecrut2", [], "Actuellement, je ne peux pas me permettre de recruter autant de mercenaires.", "capit_camp_dials_endrecrut2retour",[]],
  
  
  
  
  [anyone ,"capit_camp_dials_endrecrut2retour", [],"Avez vous besoin d'autre chose ?", "capit_camp_dials_end",[]],
  
  
  [anyone|plyr ,"capit_camp_dials_end", [],"Je doit vous quitter capitaine.", "close_window",[(assign, "$ccdf_dial", 1),]],
  
  
  ############################################################
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop1"),
      
      (eq, "$captain_fache", 1),
      
      
    ],
    "Hors de ma vue, comment avez vous le courrage de vous prèsenter encore devans moi alors que vous avez tenté l'assaut du chateau de Quintin pour avoir la prime sur le comte de penthièvre et de ce fait avez désobei a mes ordres ?", "capit_camp_ahorvue",
    [
  ]],
  
  [anyone|plyr ,"capit_camp_ahorvue", [],  "Je regrette que nous en soyons la capitaine.", "close_window", []],
  
  
  
  
  
  
  
  #capitaine fach?plus de dials
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop1"),
      
      (check_quest_active, "qst_siege_penthievre"),
      (check_quest_succeeded, "qst_siege_penthievre"),
      (neg|check_quest_failed, "qst_siege_penthievre"),
      (neg|check_quest_finished, "qst_siege_penthievre"),
      
      
    ],
    "Avez vous terminé le siège de Quintin ?", "capit_camp_attentequintinwiin",
    [
      (call_script, "script_end_quest", "qst_siege_penthievre"),
      (party_set_flags, "p_quintin", pf_always_visible, 0),
      (party_set_flags, "p_quintin", pf_disabled, 1),
      
      
  ]],
  
  [anyone|plyr ,"capit_camp_attentequintinwiin", [],  "Il est terminé capitaine, vu que le comte est mort lui et sa famille.", "capit_camp_attentequintinwiin2", []],
  [anyone ,"capit_camp_attentequintinwiin2", [],"Dois je comprendre que c'est vous qui avez pris ce chateau sans attendre les troupes régulieres du Duc de Bretagne ? ceci va m'ettre reproché pendant longtemps. gardez donc votre prime et fichez le camp que je ne vous revoie plus.", "close_window",
    [
      (assign, "$captain_fache", 1),
  ]],
  
  
  
  ###chateau quintin win = pas d?obeis ; mais plus de travail
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop1"),
      
      (check_quest_active, "qst_siege_penthievre"),
      (check_quest_succeeded, "qst_siege_penthievre"),
      (neg|check_quest_failed, "qst_siege_penthievre"),
      (neg|check_quest_finished, "qst_siege_penthievre"),
      
      
    ],
    "Avez vous terminé le siège de Quintin ?", "capit_camp_attentequintinwiin",
    [
      (call_script, "script_end_quest", "qst_siege_penthievre"),
      (party_set_flags, "p_quintin", pf_always_visible, 0),
      (party_set_flags, "p_quintin", pf_disabled, 1),
  ]],
  
  [anyone|plyr ,"capit_camp_attentequintinwiin", [],  "Il est terminé capitaine, nous avons été relevés par l'armée du Duc de Bretagne.", "capit_camp_attentequintinwiin2", []],
  [anyone ,"capit_camp_attentequintinwiin2", [],"Beau travail soldat, voila la solde.", "close_window",
    [
      (troop_add_gold, "trp_player", 300),
      (assign, "$captain_plusdetaf", 1),
  ]],
  
  
  
  ###chateau quintinloose = je n'ai plus de contrat pour vous
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop1"),
      
      (check_quest_active, "qst_siege_penthievre"),
      (neg|check_quest_succeeded, "qst_siege_penthievre"),
      (check_quest_failed, "qst_siege_penthievre"),
      (neg|check_quest_finished, "qst_siege_penthievre"),
      
      
    ],
    "Avez vous terminé le siège de Quintin ?", "capit_camp_attentequintinloose",
    [
      (call_script, "script_end_quest", "qst_siege_penthievre"),
      (party_set_flags, "p_quintin", pf_always_visible, 0),
      (party_set_flags, "p_quintin", pf_disabled, 1),
  ]],
  
  [anyone|plyr ,"capit_camp_attentequintinloose", [],  "Nous avons...été vaincus capitaine.", "capit_camp_attentequintinloose2", []],
  [anyone ,"capit_camp_attentequintinloose2", [],"Comment diable peut on batailler en tenant un siège et perdre par dessus le marché, ventre diable ne me dites pas que vous et quelques misérables avez tentés de prendre le chateaux pour la prime sur le comte, hors de ma vu, vous avez eu ce que vous meritez.", "close_window",
    [
      (assign, "$captain_fache", 1),
  ]],
  
  
  
  
  
  
  ###en attente retour siege chateau  quintin
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop1"),
      
      (check_quest_active, "qst_siege_penthievre"),
      (neg|check_quest_succeeded, "qst_siege_penthievre"),
      (neg|check_quest_failed, "qst_siege_penthievre"),
      (neg|check_quest_finished, "qst_siege_penthievre"),
      
      
    ],
    "Avez vous terminé le siège de Quintin ?", "capit_camp_attentequintin",
    [
      
  ]],
  
  [anyone|plyr ,"capit_camp_attentequintin", [],  "Les troupes de la relève ne sont pas encore arrivées capitaine.", "capit_camp_attentequintin2", []],
  [anyone ,"capit_camp_attentequintin2", [],"Dans ce cas, ne vous demandez pas vous meme pourquois vous etes ici et pas au siège qu'il ne faut absolument pas quitter ??", "close_window",
    [
      
  ]],
  
  
  
  ###################
  #en ettente accepter prochain contrat siege chateau
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop1"),
      
      (eq, "$proch_contratsiegechateau", 1),###<<<<<<<<<<<<<<<<<<<<<<<
      (try_begin),
        (eq, "$premier_dial_cdf", 0),
        (call_script, "script_nombre_crane_de_fer"),
      (try_end),
    ],
    "Que puis je pour vous ?", "capit_camp_win_crennesintro",
    [
      
  ]],
  
  
  
  #win rue des dames
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop1"),
      
      (check_quest_active, "qst_surveillance1"),
      (check_quest_succeeded, "qst_surveillance1"),
      (neg|check_quest_failed, "qst_surveillance1"),
      (neg|check_quest_finished, "qst_surveillance1"),
      (try_begin),
        (eq, "$premier_dial_cdf", 0),
        (call_script, "script_nombre_crane_de_fer"),
      (try_end),
      
    ],
    "Avez vous rempli ce contrat pour le comte de Rennes ?", "capit_camp_win_crennes",
    [
      (call_script, "script_end_quest", "qst_surveillance1"),
      (assign, "$proch_contratsiegechateau", 1),
  ]],
  
  [anyone|plyr ,"capit_camp_win_crennes", [],  "Cette mission est un succés capitaine.", "capit_camp_win_crennes2", []],
  [anyone ,"capit_camp_win_crennes2", [],"Exelente nouvelle, pourquois ne pas allez profiter de cette solde en ville, je vous ferais mander si j'ai besoin de vous.", "capit_camp_win_crennesintro",
    [
      (troop_add_gold, "trp_player", 400),
      
  ]],
  
  [anyone|plyr ,"capit_camp_win_crennesintro", [],"Capitaine, je demande un nouveau contrat.", "capit_camp_win_contartde_siegechateau",[]],
  
  
  [anyone ,"capit_camp_win_contartde_siegechateau", [],"N'allez pas vous tuer a la tache soldat, ceci dit j'ai quelque chose qui convient a votre fougue.vous pouriez rejoindre les rangs qui donnent l'assaut du chateau d'un noble que le Duc a rendu résponsable de trahison.", "capit_camp_win_contartde_siegechateau2",[]],
  [anyone ,"capit_camp_win_contartde_siegechateau2", [],"La félonie du comte de Penthievre ne doit point rester impunie, le Duc as mis sa tete a prix et assiegé son donjon, nous somes chargés de tenir le siège ou le Duc s'est retranché avec sa famille en attendant le gros de l'armé du Duc qui donnera l'assaut. il parait qu'il y as une somme colossale pour la tete du Comte, mais nous devons uniquement tenir le siège et empécher le moindre de ses sujet de sortir, est ce compris ?", "capit_camp_win_contartde_siegechateau3",[]],
  
  [anyone|plyr ,"capit_camp_win_contartde_siegechateau3", [],"Je voudrais tenir le siège capitaine.", "capit_camp_win_contartde_siegechateau4",
    [
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le Capitaine de la compagnie des mercenaires des Cranes de Fer de Bretagne m'envoie tenir le siége du donjon du comte de Penthièvre a Quintin, il faut empécher que les troupes du Comte puisse sortire. J'ai entendu dire qu'il y avais une somme énorme pour qui tuerais le Comte, je voudrais voir si je peut l'approcher lui et sa famille quite a désobeir au Capitaine des Cranes de Fer."),
      (call_script, "script_start_quest", "qst_siege_penthievre", "$g_talk_troop"),
      
  ]],
  [anyone|plyr ,"capit_camp_win_contartde_siegechateau3", [],"Je doit vous quitter pour le moment capitaine, je verai plus tard si ce contrat vaut encore.", "close_window",[(assign, "$proch_contratsiegechateau", 1),]],
  
  #assigner au close windows de ce topic !!! > (assign, "$proch_contratsiegechateau", 1),
  [anyone ,"capit_camp_win_contartde_siegechateau4", [],"Trés bien, rejoignez le chateau de Quintin dans ce cas, et revenez quand les troupes du Duc vous releverons pour venir toucher votre solde ici, ne tentez rien de stupide surtout.", "close_window",
    [
      ##faire aparaitre icone chateau quitin
      (party_set_flags, "p_quintin", pf_disabled, 0),
      (party_set_flags, "p_quintin", pf_always_visible, 1),
      (party_set_flags, "p_quintin", pf_quest_party, 1),
  ]],
  
  
  
  
  [anyone|plyr ,"capit_camp_win_crennesintro",
    [
      # (eq, "$cd_fer_embauchee", 0),
      (store_current_hours,":cur_hours"),
      (val_sub, ":cur_hours", 48),
      (gt, ":cur_hours", "$temp_attente_6"),
    ],
    "Je voudrais personellement recruter des mercenaires de la compagnie, j'ai de quois payer.", "capit_camp_win_crennesintrorecrut", []],
  
  
  
  
  
  [anyone ,"capit_camp_win_crennesintrorecrut", [],"Nous disposons de {reg3} soldats en attente de contrat, ils serons ?vous pour la somme de {reg5} écus.", "capit_camp_win_crennesintrorecrut2",[(assign, "$premier_dial_cdf", 1),]],
  
  
  [anyone|plyr,"capit_camp_win_crennesintrorecrut2",
    [
      #si j'ai la somme et place equipe
      
      (party_get_free_companions_capacity, ":free_capacity", "p_main_party"),
      (ge,":free_capacity",reg3),
      
      (store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", reg5),
      
      
      
    ],
    "C'est parfait, je les recrute tous, voici {reg5} écus.", "capit_camp_win_crennesintrorecrut2retour",
    [
      (troop_remove_gold,"trp_player",reg5),
      (party_add_members, "p_main_party", "trp_crane_de_fer_mercenaire", reg3),
      # (assign, "$cd_fer_embauchee", 1),
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_6", ":cur_hours"),
  ]],
  
  [anyone|plyr,"capit_camp_win_crennesintrorecrut2", [], "Actuellement, je ne peux pas me permettre de recruter autant de mercenaires.", "capit_camp_win_crennesintrorecrut2retour",[]],
  
  
  
  
  [anyone ,"capit_camp_win_crennesintrorecrut2retour", [],"Avez vous besoin d'autre chose ?", "capit_camp_win_crennesintro",[]],
  
  
  [anyone|plyr ,"capit_camp_win_crennesintro", [],  "Je doit partir.", "close_window", [(assign, "$ccdf_dial", 1), ]],
  
  
  #failed rue des dames attentat
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop1"),
      
      (check_quest_active, "qst_surveillance1"),
      (neg|check_quest_succeeded, "qst_surveillance1"),
      (check_quest_failed, "qst_surveillance1"),
      (neg|check_quest_finished, "qst_surveillance1"),
      
      
    ],
    "Avez vous rempli de contrat pour le comte de Rennes ?", "capit_camp_fail_crennes",
    [
      (call_script, "script_end_quest", "qst_surveillance1"),
  ]],
  
  
  [anyone|plyr ,"capit_camp_fail_crennes", [],  "Je n'ai pas pu honorer le contrat capitaine, la foule m'as débordé.", "capit_camp_fail_crennes2", []],
  
  [anyone ,"capit_camp_fail_crennes2", [],"Voila qui est ennuyeux, très ennuyeux.", "capit_camp_fail_crennessuit",[]],
  
  [anyone|plyr ,"capit_camp_fail_crennessuit", [],  "Auriez vous un autre contrat pour moi capitaine, je sait que je peut refaire ma réputation, je ne faillirais point !", "capit_camp_fail_lance_contrat", []],
  [anyone ,"capit_camp_fail_lance_contrat", [],"Vraiment ?...et bien peut etre que vous pouriez rejoindre les rangs qui donnent l'assaut du chateau d'un noble que le Duc a rendu résponsable de trahison.", "capit_camp_fail_lance_contrat2",[]],
  
  
  #assigner au close windows de ce topic !!! > (assign, "$proch_contratsiegechateau", 1),
  
  
  
  
  [anyone ,"capit_camp_fail_lance_contrat2", [],"La félonie du comte de Penthievre ne doit point rester impunie, le Duc as mis sa tete a prix et assiegé son donjon, nous somes chargés de tenir le siège ou le Duc s'est retranché avec sa famille en attendant le gros de l'armé du Duc qui donnera l'assaut. il parait qu'il y as une somme colossale pour la tete du Comte, mais nous devons uniquement tenir le siège et empécher le moindre de ses sujet de sortir, est ce compris ?", "capit_camp_fail_lance_contrat3",[]],
  
  [anyone|plyr ,"capit_camp_fail_lance_contrat3", [],"Je voudrais tenir le siège capitaine.", "capit_camp_fail_lance_contra4",
    [
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le Capitaine de la compagnie des mercenaires des Cranes de Fer de Bretagne m'envoie tenir le siége du donjon du comte de Penthièvre a Quintin, il faut empécher que les troupes du Comte puisse sortire. J'ai entendu dire qu'il y avais une somme énorme pour qui tuerais le Comte, je voudrais voir si je peut l'approcher lui et sa famille quite a désobeir au Capitaine des Cranes de Fer."),
      (call_script, "script_start_quest", "qst_siege_penthievre", "$g_talk_troop"),
      
  ]],
  [anyone|plyr ,"capit_camp_fail_lance_contrat3", [],"Je doit vous quitter pour le moment capitaine.", "close_window",[(assign, "$proch_contratsiegechateau", 1),]],
  
  [anyone ,"capit_camp_fail_lance_contra4", [],"Trés bien, rejoignez le chateau de Quintin dans ce cas, et revenez quand les troupes du Duc vous releverons pour venir toucher votre solde ici, ne tentez rien de stupide surtout.", "close_window",
    [
      ##faire aparaitre icone chateau quitin
      (party_set_flags, "p_quintin", pf_disabled, 0),
      (party_set_flags, "p_quintin", pf_always_visible, 1),
      (party_set_flags, "p_quintin", pf_quest_party, 1),
  ]],
  
  
  ###################
  #en ettente contrat rue des dames
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop1"),
      
      (check_quest_active, "qst_surveillance1"),
      (neg|check_quest_succeeded, "qst_surveillance1"),
      (neg|check_quest_failed, "qst_surveillance1"),
      (neg|check_quest_finished, "qst_surveillance1"),
      
      (try_begin),
        (eq, "$premier_dial_cdf", 0),
        (call_script, "script_nombre_crane_de_fer"),
      (try_end),
      
    ],
    "Avez vous rempli de contrat pour le comte de Rennes ?", "capit_camp_attente_crennes",
    [
      
  ]],
  
  
  
  [anyone|plyr ,"capit_camp_attente_crennes", [],  "J'y travaille capitaine.", "capit_camp_attente_crennes2", []],
  [anyone ,"capit_camp_attente_crennes2", [],"N'oubliez point.", "close_window",[]],
  
  [anyone|plyr ,"capit_camp_attente_crennes", [],  "Je ne peut m'en occupper capitaine.", "capit_camp_attente_crennesfix", []],
  [anyone ,"capit_camp_attente_crennesfix", [],"Je voie, ca fait plaisir de pouvoir compter sur ses troupes.", "close_window",
    [
      
      (call_script, "script_fail_quest", "qst_surveillance1"),
  ]],
  
  
  
  
  
  ###################
  #en ettente accepter prochain contrat rue des dames
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop1"),
      
      (eq, "$proch_contratruedame", 1),
      (try_begin),
        (eq, "$premier_dial_cdf", 0),
        (call_script, "script_nombre_crane_de_fer"),
      (try_end),
      
    ],
    "Que puis je pour vous ?", "capit_camp_cran_caravanwinintro",
    [
      
  ]],
  
  
  
  
  
  
  #capitaine tueur de caravaniers win
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop1"),
      
      (check_quest_active, "qst_vangeance_cravane"),
      (check_quest_succeeded, "qst_vangeance_cravane"),
      (neg|check_quest_failed, "qst_vangeance_cravane"),
      (neg|check_quest_finished, "qst_vangeance_cravane"),
      
      (try_begin),
        (eq, "$premier_dial_cdf", 0),
        (call_script, "script_nombre_crane_de_fer"),
      (try_end),
      
    ],
    "Ou en etes vous avec sces bandits, sont ils tous morts ?", "capit_camp_cran_caravanwin",
    [
      (call_script, "script_end_quest", "qst_vangeance_cravane"),
  ]],
  
  
  
  [anyone|plyr ,"capit_camp_cran_caravanwin", [],  "Ils sont morts capitaine, pas un des leurs n'as survecu.", "capit_camp_cran_caravanwin2", []],
  [anyone ,"capit_camp_cran_caravanwin2", [],"C'est parfait, voila votre solde pour ce travail.", "capit_camp_cran_caravanwinintro",
    [
      (troop_add_gold, "trp_player", 300),
  ]],
  
  
  
  [anyone|plyr ,"capit_camp_cran_caravanwinintro", [],  "Avez vous un autre contrat pour moi capitaine ?", "capit_camp_cran_caravanquetsuit", []],
  [anyone ,"capit_camp_cran_caravanquetsuit", [],"Vous m'avez prouvé votre valeur en revenant vivant de votre dérnière mission, oui j'ai quelque chose, il faut garder l'entrée d'un manoir pour un noble Breton qui as été victime de menaces. pas d'étas d'ame il faut empécher que le client se fasse tuer, ne serais ce que pour qu'il nous paye demain.", "capit_camp_cran_caravanquetsuit2",[]],
  
  [anyone|plyr ,"capit_camp_cran_caravanquetsuit2", [],  "Je ne refuse pas de contrat capitaine, je suis partant.", "capit_camp_cran_caravanquetsuit2ok",
    [
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le Capitaine de la compagnie des mercenaires des Cranes de Fer de Bretagne m'as donné un contrat qui consiste a surveiller l'entrée du manoir d'un noble Breton a Rennes qui as recu des menaces de mort, je doit etre son garde du corp quelques temps dans la journée pour empécher qu'il soit tué."),
      (call_script, "script_start_quest", "qst_surveillance1", "$g_talk_troop"),
      
      
  ]],
  [anyone|plyr ,"capit_camp_cran_caravanquetsuit2", [],  "Rester debout pendant des heures ? c'est n'est point pour moi j'en suis navré.", "close_window", [(assign, "$proch_contratruedame", 1),]],
  
  
  [anyone ,"capit_camp_cran_caravanquetsuit2ok", []," Bien, rendez vous a Rennes a les rue des Dames et prennez votre affectation aupré du comte, ne vous déconcentrez pas surtout, bon courrage.", "close_window",[]],
  
  
  
  
  [anyone|plyr ,"capit_camp_cran_caravanwinintro",
    [
      # (eq, "$cd_fer_embauchee", 0),
      (store_current_hours,":cur_hours"),
      (val_sub, ":cur_hours", 48),
      (gt, ":cur_hours", "$temp_attente_6"),
    ],
    "Je voudrais recruter personellement des mercenaires de la compagnie, j'ai de quois payer.", "capit_camp_cran_caravanwinintro2", []],
  
  [anyone|plyr ,"capit_camp_cran_caravanwinintro", [],  "Je doit partir capitaine.", "close_window", [(assign, "$proch_contratruedame", 1),]],
  
  
  
  
  [anyone ,"capit_camp_cran_caravanwinintro2", [],"Nous disposons de {reg3} soldats en attente de contrat, ils serons ?vous pour la somme de {reg5} écus..", "capit_camp_cran_caravanwinintro3",[(assign, "$premier_dial_cdf", 1),]],
  
  
  [anyone|plyr,"capit_camp_cran_caravanwinintro3",
    [
      #si j'ai la somme et place equipe
      
      (party_get_free_companions_capacity, ":free_capacity", "p_main_party"),
      (ge,":free_capacity",reg3),
      
      (store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", reg5),
      
      
      
    ],
    "C'est parfait, je les recrute tous, voici {reg5} écus.", "capit_camp_cran_caravanwinretour",
    [
      (troop_remove_gold,"trp_player",reg5),
      (party_add_members, "p_main_party", "trp_crane_de_fer_mercenaire", reg3),
      # (assign, "$cd_fer_embauchee", 1),
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_6", ":cur_hours"),
  ]],
  
  [anyone|plyr,"capit_camp_cran_caravanwinintro3", [], "Actuellement, je ne peux pas me permettre de recruter autant de mercenaires.", "capit_camp_cran_caravanwinretour",[]],
  
  
  
  
  [anyone ,"capit_camp_cran_caravanwinretour", [],"Avez vous besoin d'autre chose ?", "capit_camp_cran_caravanwinintro",[]],
  
  
  [anyone|plyr ,"capit_camp_cran_caravanwinintro", [],  "Je doit partir.", "close_window", [(assign, "$ccdf_dial", 1), ]],
  
  
  
  
  
  
  
  
  
  
  
  #capitaine tueur de caravaniers failed
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop1"),
      
      (check_quest_active, "qst_vangeance_cravane"),
      (neg|check_quest_succeeded, "qst_vangeance_cravane"),
      (check_quest_failed, "qst_vangeance_cravane"),
      (neg|check_quest_finished, "qst_vangeance_cravane"),
      
      #                     (eq, "$premier_dial_cdf", 0),
      # (call_script, "script_nombre_crane_de_fer"),
      
    ],
    "Ou en etes vous avec sces bandits, sont ils tous morts ?", "capit_camp_cran_caravanloose",
    [
      
  ]],
  
  
  
  [anyone|plyr ,"capit_camp_cran_caravanloose", [],  "Ils nous on eu capitaine, j'en suis navré.", "capit_camp_cran_caravanloose2", []],
  
  [anyone ,"capit_camp_cran_caravanloose2", [],"Pas tant que moi.", "close_window",
    [
      
      (call_script, "script_end_quest", "qst_vangeance_cravane"),
  ]],
  
  
  #capitaine attente tueur de caravaniers
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop1"),
      
      (check_quest_active, "qst_vangeance_cravane"),
      (neg|check_quest_succeeded, "qst_vangeance_cravane"),
      (neg|check_quest_failed, "qst_vangeance_cravane"),
      (neg|check_quest_finished, "qst_vangeance_cravane"),
      
      (try_begin),
        (eq, "$premier_dial_cdf", 0),
        (call_script, "script_nombre_crane_de_fer"),
      (try_end),
      
    ],
    "Ou en etes vous avec sces bandits, sont ils tous morts ?", "capit_camp_cran_attente_tcaravan",
    [
      
  ]],
  
  
  
  [anyone|plyr ,"capit_camp_cran_attente_tcaravan", [],  "J'y travaille capitaine.", "capit_camp_cran_attente_tcaravan2", []],
  
  [anyone ,"capit_camp_cran_attente_tcaravan2", [],"Je Compte sur vous soldat.", "close_window",[]],
  
  
  
  [anyone|plyr ,"capit_camp_cran_attente_tcaravanintro",
    [
      # (eq, "$cd_fer_embauchee", 0),
      (store_current_hours,":cur_hours"),
      (val_sub, ":cur_hours", 48),
      (gt, ":cur_hours", "$temp_attente_6"),
    ],
    "Je voudrais recruter des mercenaires de votre compagnie, j'ai de quois payer.", "capit_camp_cran_fer_paycaravan", []],
  
  [anyone|plyr ,"capit_camp_cran_attente_tcaravanintro", [],  "Je doit partir capitaine.", "close_window", []],
  
  
  
  
  [anyone ,"capit_camp_cran_fer_paycaravan", [],"Je dispose de {reg3} soldats en attente de contrat, ils serons ?vous pour la somme de {reg5} écus..", "capit_camp_cran_fer_paycaravan2",[(assign, "$premier_dial_cdf", 1),]],
  
  
  [anyone|plyr,"capit_camp_cran_fer_paycaravan2",
    [
      #si j'ai la somme et place equipe
      
      (party_get_free_companions_capacity, ":free_capacity", "p_main_party"),
      (ge,":free_capacity",reg3),
      
      (store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", reg5),
      
      
      
    ],
    "C'est parfait, je les recrute tous, voici {reg5} écus.", "capit_camp_cran_fer_payretour",
    [
      (troop_remove_gold,"trp_player",reg5),
      (party_add_members, "p_main_party", "trp_crane_de_fer_mercenaire", reg3),
      # (assign, "$cd_fer_embauchee", 1),
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_6", ":cur_hours"),
  ]],
  
  [anyone|plyr,"capit_camp_cran_fer_paycaravan2", [], "Actuellement, je ne peux pas me permettre de recruter autant de mercenaires.", "capit_camp_cran_fer_payretour",[]],
  
  
  
  
  [anyone ,"capit_camp_cran_fer_payretour", [],"Ca sera tout ?", "capit_camp_cran_attente_tcaravanintro",[]],
  
  
  
  
  
  
  
  
  
  #capitaine premier dial
  #assigner variable, dial raccourcis menu capitaine depuis le menu > (assign, "$ccdf_dial", 1),
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop1"),
      (try_begin),
        (eq, "$premier_dial_cdf", 0),
        (call_script, "script_nombre_crane_de_fer"),
      (try_end),
      
    ],
    "Que puis je pour vous messire ?", "capit_camp_cran_fer_intro",
    [
      
  ]],
  
  
  [anyone|plyr ,"capit_camp_cran_fer_intro",
    [
      # (eq, "$cd_fer_embauchee", 0),
      (store_current_hours,":cur_hours"),
      (val_sub, ":cur_hours", 48),
      (gt, ":cur_hours", "$temp_attente_6"),
    ],
    "Je voudrais recruter des mercenaires de votre compagnie, j'ai de quois payer.", "capit_camp_cran_fer_pay", []],
  
  [anyone|plyr ,"capit_camp_cran_fer_intro", [],  "Avez vous besoin de soldats ? je sait me servire d'une arme et suivre les ordres.", "capit_camp_cran_fer_emploie", []],
  [anyone|plyr ,"capit_camp_cran_fer_intro", [],  "Je doit partir capitaine.", "close_window", [(assign, "$ccdf_dial", 1),]],
  
  
  
  
  [anyone ,"capit_camp_cran_fer_pay", [],"Je dispose de {reg3} soldats en attente de contrat, ils serons ?vous pour la somme de {reg5} écus..", "capit_camp_cran_fer_pay2",[(assign, "$premier_dial_cdf", 1),]],
  
  
  [anyone|plyr,"capit_camp_cran_fer_pay2",
    [
      #si j'ai la somme et place equipe
      
      (party_get_free_companions_capacity, ":free_capacity", "p_main_party"),
      (ge,":free_capacity",reg3),
      
      (store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", reg5),
      
      
      
    ],
    "C'est parfait, je les recrute tous, voici {reg5} écus.", "capit_camp_cran_fer_retour",
    [
      (troop_remove_gold,"trp_player",reg5),
      (party_add_members, "p_main_party", "trp_crane_de_fer_mercenaire", reg3),
      # (assign, "$cd_fer_embauchee", 1),
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_6", ":cur_hours"),
  ]],
  
  [anyone|plyr,"capit_camp_cran_fer_pay2", [], "Actuellement, je ne peux pas me permettre de recruter autant de mercenaires.", "capit_camp_cran_fer_retour",[]],
  
  
  
  
  [anyone ,"capit_camp_cran_fer_retour", [],"Ca sera tout ?", "capit_camp_cran_fer_intro",[]],
  
  
  
  
  [anyone ,"capit_camp_cran_fer_emploie", [],"En effet, nous sommes toujours a la recherche de soldats pret a se battre pour de l'or ou pour ce qu'ils voudrons tant que les ordres seront respectés. j'ai justement une affectation qui conviendrais ce qui vous permetterez de faire vos preuves.", "capit_camp_cran_fer_emploie2",[]],
  [anyone ,"capit_camp_cran_fer_emploie2", [],"D'habitude, chasser les bandits de la région ne fait point parti de nos contrats, mais la caravane d'un marchand noble Breton veux récupérer la marchandise qui lui as été volée et donner une lecon a ces brigands. vous serez payé bien entendu.", "capit_camp_cran_fer_emploie3",[]],
  
  [anyone|plyr,"capit_camp_cran_fer_emploie3", [], "Je serais dans la troupe d'interception Capitaine !", "capit_camp_cran_fer_emploie4",
    [
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le Capitaine de la compagnie des mercenaires des Cranes de Fer de Bretagne m'as donné mon premier contrat, intercepter des bandits qui ont attaqués une caravane et tué tous les marchands et leur éscorte."),
      (call_script, "script_start_quest", "qst_vangeance_cravane", "$g_talk_troop"),
      
      
  ]],
  [anyone|plyr,"capit_camp_cran_fer_emploie3", [], "Je regrette, j'ai des bléssures a soigner pour le moment.", "close_window",[(assign, "$ccdf_dial", 1),]],
  [anyone ,"capit_camp_cran_fer_emploie4", [],"Parfait, ces hommes vont se joindre a vous pour le raid, tuez les sans pitié jusqu'au dérnier, pas de survivants. Prennez cette armure aux couleures de la compagnie avant de partir, portez la fierement.", "close_window",
    [
      (troop_add_item, "trp_player", "itm_corrazina_breton", 0),
      (party_get_free_companions_capacity, ":free_capacity", "p_main_party"),
      (ge,":free_capacity",9),
      (party_add_members, "p_main_party", "trp_crane_de_fer_mercenaire", 5),
      (set_spawn_radius, 3),
      (spawn_around_party, "p_town_22", "pt_bandits_rennes"),
      (party_set_flags, reg0, pf_always_visible, 1),
      #  (assign, "$bandits_derennes", 1),
      (assign, "$ccdf_dial", 1),
  ]],
  
  # [anyone ,"sssssssss", [],"La tente du Capitaine est au fond du camp.", "close_window",[(assign, "$ccdf_dial", 1),]],
  
  ###############################
  
  # troupes du camp sous une tente2
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop13"),
      
    ],
    "Que faut il faire pour rester tranquile sous sa tente, dois je aller la planter la bas sous les arbres ?", "camp_cran_fer_sort",
    [
      
  ]],
  
  
  [anyone|plyr  ,"camp_cran_fer_sort", [],"Je ne voulais pas déranger.", "close_window",[]],
  
  # troupes du camp sous une tente
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop12"),
      
    ],
    "Salutations...", "camp_cran_fer_hello",
    [
      
  ]],
  
  
  [anyone|plyr  ,"camp_cran_fer_hello", [],"Le Bonjour.", "close_window",[]],
  [anyone|plyr ,"camp_cran_fer_hello", [],"...", "close_window",[]],
  
  
  
  
  # troupes du camp devans un petit feu entree
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop11"),
      
    ],
    "J'ai entendu que le Duc de Bretagne cherchais des volontaires pour une mission dangereuse, mais il ne veux pas de nos gars, ca veux dire quois tout ca ?", "camp_cran_fer_ducrec",
    [
      
  ]],
  
  
  [anyone|plyr ,"camp_cran_fer_ducrec", [],"C'est bon a savoir.", "close_window",[]],
  
  
  # troupes du camp entree 2
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop10"),
      
    ],
    "Qui va la ?", "camp_cran_fer_entrr2",
    [
      
  ]],
  
  
  [anyone|plyr ,"camp_cran_fer_entrr2", [],  "Je voudrais recruter des mercenaires parmis vous, j'ai de quois payer.", "camp_cran_travv2", []],
  [anyone|plyr ,"camp_cran_fer_entrr2", [],  "Je cherche du travail dans vos rangs, je sait me battre.", "camp_cran_travv2", []],
  [anyone|plyr ,"camp_cran_fer_entrr2", [],  "J'ai bien peur de m'ettre perdu, je repart.", "close_window", []],
  
  [anyone ,"camp_cran_travv2", [],"La tente du Capitaine est au fond du camp.", "close_window",[]],
  
  
  
  # troupes du camp entree
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop9"),
      
    ],
    "Que viens tu faire ici ?", "camp_cran_fer_entrr",
    [
      
  ]],
  
  
  [anyone|plyr ,"camp_cran_fer_entrr", [],  "Je voudrais recruter des mercenaires parmis vous, j'ai de quois payer.", "camp_cran_travv", []],
  [anyone|plyr ,"camp_cran_fer_entrr", [],  "Je cherche du travail dans vos rangs, je sait me battre.", "camp_cran_travv", []],
  [anyone|plyr ,"camp_cran_fer_entrr", [],  "J'ai bien peur de m'ettre perdu, je repart.", "close_window", []],
  
  [anyone ,"camp_cran_travv", [],"La tente du Capitaine est au fond du camp.", "close_window",[]],
  
  
  
  
  # troupes du camp a cote chevaux
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop8"),
      
    ],
    "Des beaux chevaux pour sur.", "camp_cran_fer_chevaux",
    [
      
  ]],
  
  
  [anyone|plyr ,"camp_cran_fer_chevaux", [],  "Il y en as a vendre ?", "camp_cran_fer_chevaux2", []],
  
  [anyone ,"camp_cran_fer_chevaux2", [],"Sur que non, la compagnie se déplace toujours a pied, ces chevaux sont au capitaine et il ne les vend pas, ce sont des cadeaux du Duc.", "close_window",[]],
  
  
  
  
  # troupes du camp patrouilleur
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop7"),
      
    ],
    "Je suis de patrouille, pas le temps de discuter.", "camp_cran_fer_patrouille",
    [
      
  ]],
  
  
  [anyone|plyr ,"camp_cran_fer_patrouille", [],  "Bonne patrouille l'ami.", "close_window", []],
  
  
  
  
  
  # troupes du camp pret du feu
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop6"),
      
    ],
    "Pas mal hein ? j'ai tiré ces deux lapins moi meme, j'aurrais bien partagé mais...finalement non.", "camp_cran_fer_lapin",
    [
      
  ]],
  
  
  [anyone|plyr ,"camp_cran_fer_lapin", [],  "Je te les laisse, j'ai mieux.", "close_window", []],
  
  
  
  # troupes du camp troop detente table2
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop5"),
      
    ],
    "Rien de tel que la cuite du soir histoire de feter le fait qu'on est encore en vie, pas vrai ?", "camp_cran_fer_evie",
    [
      
  ]],
  
  
  [anyone|plyr ,"camp_cran_fer_evie", [],  "C'est un jeu pour toi ?", "camp_cran_fer_evie2", []],
  [anyone|plyr ,"camp_cran_fer_evie", [],  "Peut etre.", "close_window", []],
  
  
  [anyone ,"camp_cran_fer_evie2", [],"Bien sur il faut gagner son paim, mais autant rendre les choses plus agréables, et je préfére voir le verre a moitié plein qu'a moitié vide, bien que j'aime encore mieux un verre plein.", "close_window",[]],
  
  
  
  
  
  
  
  
  
  
  
  # troupes du camp troop detente table1
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop4"),
      
    ],
    "Que dirais tu d'une partie de dés l'ami ?", "camp_cran_fer_jeu1",
    [
      
  ]],
  
  
  [anyone|plyr ,"camp_cran_fer_jeu1", [],  "C'est pas de refus...", "camp_cran_fer_jeuok", []],
  [anyone|plyr ,"camp_cran_fer_jeu1", [],  "J'aimerais avoir rien a faire comme toi, mais ca n'est pas le cas.", "close_window", []],
  
  
  [anyone ,"camp_cran_fer_jeuok", [],"Enfin quelqu'un a plumer.", "generique_des",[]],
  
  # troupes du camp armurerie
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop3"),
      
    ],
    "Ne touche pas aux coffres c'est compris ?", "camp_cran_fer_coffre",
    [
      
  ]],
  
  
  [anyone|plyr ,"camp_cran_fer_coffre", [],  "Ai je l'air d'un voleur ?", "camp_cran_fer_coffre2", []],
  
  [anyone ,"camp_cran_fer_coffre2", [],"Oui.", "close_window",[]],
  
  # troupes du camp garde netree tente capitaine
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_crane_de_fercamp_troop2"),
      
    ],
    "Ou va tu donc ? c'est la tente du capitaine.", "camp_cran_perm",
    [
      
  ]],
  
  
  [anyone|plyr ,"camp_cran_perm", [],  "Je voudrais voir le capitaine.", "camp_cran_perm2", []],
  [anyone|plyr ,"camp_cran_perm", [],  "Je craint de m'ettre égaré.", "close_window", []],
  
  [anyone ,"camp_cran_perm2", [],"Pour quois faire ?", "camp_cran_perm3",[]],
  
  [anyone|plyr ,"camp_cran_perm3", [],  "Je voudrais recruter des mercenaires parmis vous, j'ai de quois payer.", "camp_cran_permok", []],
  [anyone|plyr ,"camp_cran_perm3", [],  "Je cherche du travail dans vos rangs, je sait me battre.", "camp_cran_permok", []],
  
  [anyone ,"camp_cran_permok", [],"Permission accodrée.", "close_window",[]],
  
  ######################################## CRANE DE FER END
  
  
  
  
  #################################################### dials siege chateau panthievre
  
  
  
  
  
  
  
  
  
  ################################################################################
  
  
  [anyone,"lord_start",
    [
      (store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_lend_surgeon"),
      (quest_slot_eq, "qst_lend_surgeon", slot_quest_giver_troop, "$g_talk_troop")
    ], "Your surgeon managed to convince my friend and made the operation.  The matter is in God's hands now,, and all we can do is pray for his recovery. " +
    "Anyway, I thank you for lending your surgeon to me {sir/madam}. You have a noble spirit. I will not forget it.", "lord_generic_mission_completed",
    [
      (call_script, "script_finish_quest", "qst_lend_surgeon", 100),
      (troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1),
  ]],
  
  ##### TODO: QUESTS COMMENT OUT BEGIN
  
  ##
  ##  [anyone,"lord_start", [(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                         (store_partner_quest,":lords_quest"),
  ##                         (eq,":lords_quest","qst_bring_prisoners_to_enemy"),
  ##                         (quest_slot_eq, "qst_bring_prisoners_to_enemy", slot_quest_current_state, 0),
  ##                         (check_quest_succeeded, "qst_bring_prisoners_to_enemy"),
  ##                         (quest_get_slot, ":quest_target_amount", "qst_bring_prisoners_to_enemy", slot_quest_target_amount),
  ##                         (assign, reg1, ":quest_target_amount")],
  ##   "TODO: You have brought the prisoners and received {reg1} denars. Give me the money now.", "lord_bring_prisoners_complete_2",[]],
  ##
  ##  [anyone,"lord_start", [(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                         (store_partner_quest,":lords_quest"),
  ##                         (eq,":lords_quest","qst_bring_prisoners_to_enemy"),
  ##                         (quest_slot_eq, "qst_bring_prisoners_to_enemy", slot_quest_current_state, 1),#Some of them were brought only
  ##                         (check_quest_succeeded, "qst_bring_prisoners_to_enemy"),
  ##                         (quest_get_slot, ":quest_target_amount", "qst_bring_prisoners_to_enemy", slot_quest_target_amount),
  ##                         (assign, reg1, ":quest_target_amount")],
  ##   "TODO: You have brought the prisoners but some of them died during your expedition. Give me the full money of {reg1} denars.", "lord_bring_prisoners_complete_2",[]],
  ##
  ##
  ##  [anyone|plyr,"lord_bring_prisoners_complete_2", [(store_troop_gold, ":cur_gold", "trp_player"),
  ##                                                   (quest_get_slot, ":quest_target_amount", "qst_bring_prisoners_to_enemy", slot_quest_target_amount),
  ##                                                   (ge, ":cur_gold", ":quest_target_amount")],
  ##   "TODO: Here it is.", "lord_generic_mission_thank", [(quest_get_slot, ":quest_target_amount", "qst_bring_prisoners_to_enemy", slot_quest_target_amount),
  ##                                                  (troop_remove_gold, "trp_player", ":quest_target_amount"),
  ##                                                  (call_script, "script_finish_quest", "qst_bring_prisoners_to_enemy", 100)]],
  ##
  ##  [anyone|plyr,"lord_bring_prisoners_complete_2", [(store_troop_gold, ":cur_gold", "trp_player"),
  ##                                                   (quest_get_slot, ":quest_target_amount", "qst_bring_prisoners_to_enemy", slot_quest_target_amount),
  ##                                                   (lt, ":cur_gold", ":quest_target_amount")],
  ##   "TODO: I'm afraid I spent some of it, I don't have that much money with me.", "lord_bring_prisoners_no_money", [(quest_get_slot, ":quest_target_amount", "qst_bring_prisoners_to_enemy", slot_quest_target_amount),
  ##                                                                                                                   (call_script, "script_change_debt_to_troop", "$g_talk_troop", ":quest_target_amount"),#Adding the taken money as a debt
  ##                                                                                                                   (call_script, "script_finish_quest", "qst_bring_prisoners_to_enemy", 100)]],
  ##
  ##  [anyone,"lord_bring_prisoners_no_money", [],
  ##   "TODO: You owe me that money!", "lord_pretalk", []],
  ##
  ##
  
  
  
  #MALE PLAYER CHARACTER WEDDING
  #wedding allowed
  [anyone ,"lord_start", [(troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_hero),
      (check_quest_active, "qst_wed_betrothed"),
      
      (quest_slot_eq, "qst_wed_betrothed", slot_quest_giver_troop, "$g_talk_troop"),
      (quest_get_slot, ":bride", "qst_wed_betrothed", slot_quest_target_troop),
      (troop_slot_eq, ":bride", slot_troop_cur_center, "$g_encountered_party"),
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_feast),
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_object, "$g_encountered_party"),
      
      (call_script, "script_troop_get_family_relation_to_troop", ":bride", "$g_talk_troop"),
      (str_store_troop_name, s4, ":bride"),
    ],
    "May the heavens witness that I am ready to give you my {s11} {s4}, to have in marriage...", "wedding_ceremony_bride_vow",
    [
      (quest_get_slot, "$g_player_bride", "qst_wed_betrothed", slot_quest_target_troop),
  ]],
  
  
  [anyone, "lord_start", [ (check_quest_active, "qst_wed_betrothed"),
      (quest_slot_eq, "qst_wed_betrothed", slot_quest_giver_troop, "$g_talk_troop"),
      (quest_get_slot, ":expiration_days", "qst_wed_betrothed", slot_quest_expiration_days),
      (lt, ":expiration_days", 362),
      (eq, "$g_done_wedding_comment", 0),
      (str_clear, s12),
      (try_begin),
        (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_feast),
        (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_default),
        (str_store_string, s12, "@ We will of course need to wait until the realm is no longer on campaign."),
      (try_end),
      
    ],
    "It is good to see you, {playername}. We look forward to the wedding, as soon as we can all gather together for the feast.{s12}", "lord_wedding_reschedule",
    [
      (assign, "$g_done_wedding_comment", 1),
  ]],
  
  
  
  [anyone|plyr, "lord_wedding_reschedule", [],
    "It is no problem. I can wait.", "lord_start",
    [
  ]],
  
  [anyone|plyr, "lord_wedding_reschedule", [],
    "I have no faith that this wedding will be concluded. Please return my dower.", "lord_return_dower", #add in new dialog
    []],
  
  [anyone, "lord_return_dower", [],
    "Well, that is your right, if you indeed have no confidence in our family's commitments. Take your money.", "close_window",
    [
      (quest_get_slot, ":bride", "qst_wed_betrothed", slot_quest_target_troop),
      (fail_quest, "qst_wed_betrothed"),
      (call_script, "script_end_quest", "qst_wed_betrothed"),
      
      (troop_set_slot, "trp_player", slot_troop_betrothed, -1),
      (troop_set_slot, ":bride", slot_troop_betrothed, -1),
      
      (assign, "$marriage_dowry", 0),
      (troop_add_gold, "trp_player", "$marriage_dower"),
      (assign, "$marriage_dower", 0),
      
      
      (assign, "$g_leave_encounter", 1),
  ]],
  
  
  
  
  
  
  [anyone,"lord_start", [(store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_incriminate_loyal_commander"),
      (check_quest_succeeded, "qst_incriminate_loyal_commander"),
      (quest_get_slot, ":quest_target_troop", "qst_incriminate_loyal_commander", slot_quest_target_troop),
      (str_store_troop_name, s3, ":quest_target_troop"),
      (quest_get_slot, reg5, "qst_incriminate_loyal_commander", slot_quest_gold_reward),
    ],
    "Hah! Our little plot against {s3} worked perfectly, {playername}. " +
    "The fool has lost one of his most valuable retainers, and we are one step closer to bringing him to his knees. " +
    "Here, this purse contains {reg5} denars, and I wish you to have it. You deserve every copper. " +
    "And, need I remind you, there could be much more to come if you've a mind to earn it...", "lord_generic_mission_completed",[
      (call_script, "script_end_quest", "qst_incriminate_loyal_commander"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",5),
      (call_script, "script_change_player_honor", -10),
  ]],
  
  [anyone,"lord_start", [(store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_incriminate_loyal_commander"),
      (check_quest_failed, "qst_incriminate_loyal_commander")],
    "You werent't able to complete a simple task. I had set up everything. " +
    "The only thing you needed to do was sacrifice a messenger, and we would be celebrating now. " +
    "But no, you were too damned honorable, weren't you?", "close_window",[
      (call_script, "script_end_quest", "qst_incriminate_loyal_commander"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-5),
      (call_script, "script_change_player_honor", 3),
  ]],
  #TODO: NO GENERIC MISSION FAILED ANYMORE!!!!
  
  
  [anyone,"lord_start", [(store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_meet_spy_in_enemy_town"),
      (check_quest_succeeded, "qst_meet_spy_in_enemy_town"),
    ],
    "Have you brought me any news about that task I gave you? You know the one I mean...", "quest_meet_spy_in_enemy_town_completed",
    []],
  
  [anyone|plyr, "quest_meet_spy_in_enemy_town_completed", [],
    "I have the reports you wanted right here.", "quest_meet_spy_in_enemy_town_completed_2",[]],
  
  [anyone, "quest_meet_spy_in_enemy_town_completed_2", [],
    "Ahh, well done. It's good to have competent {men/people} on my side. Here is the payment I promised you.", "lord_pretalk",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 3),
      (add_xp_as_reward, 500),
      (quest_get_slot, ":gold", "qst_meet_spy_in_enemy_town", slot_quest_gold_reward),
      (call_script, "script_troop_add_gold", "trp_player", ":gold"),
      (call_script, "script_end_quest", "qst_meet_spy_in_enemy_town"),
  ]],
  
  [anyone,"lord_start", [(store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_cause_provocation"),
      (check_quest_succeeded, "qst_cause_provocation"),
      (quest_get_slot, ":quest_target_faction", "qst_cause_provocation", slot_quest_target_faction),
      (str_store_faction_name, s13, ":quest_target_faction"),
    ],
    "Brilliant work, {playername}! Whatever you did, the nobles of the {s13} are clamoring for war! " +
    "Soon, the time will come for us to reap the benefits of our hard work, from fields ripe for plunder. " +
    "This war is going to make us rich, mark my words!", "lord_pretalk",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 10),
      (try_for_range, ":vassal", active_npcs_begin, active_npcs_end),
        (troop_slot_eq, ":vassal", slot_troop_occupation, slto_kingdom_hero),
        (store_troop_faction, ":vassal_fac", ":vassal"),
        (eq, ":vassal_fac", "$players_kingdom"),
        (neq,  ":vassal", "$g_talk_troop"),
        (store_random_in_range, ":rel_change", -5, 4),
        (call_script, "script_change_player_relation_with_troop", ":vassal", ":rel_change"),
      (try_end),
      #TODO: Add gold reward notification before the quest is given. 500 gold is not mentioned anywhere.
      (call_script, "script_troop_add_gold", "trp_player", 500),
      (add_xp_as_reward, 2000),
      (call_script, "script_change_player_honor", -5),
      (call_script, "script_end_quest", "qst_cause_provocation")
  ]],
  
  #  [anyone,"lord_start", [(store_partner_quest, ":lords_quest"),
  #                        (eq, ":lords_quest", "qst_raid_caravan_to_start_war"),
  #                       (check_quest_failed, "qst_raid_caravan_to_start_war"),
  #                      ],
  #"You incompetent buffoon!\
  #What in Hell made you think that getting yourself captured while trying to start a war was a good idea?\
  #These plans took months to prepare, and now everything's been ruined! I will not forget this, {playername}.\
  #Oh, be assured that I will not.", "lord_pretalk",
  #  [
  #  (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -10),
  #  (call_script, "script_end_quest", "qst_raid_caravan_to_start_war")
  #  ]],
  
  [anyone,"lord_start", [(store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_collect_debt"),
      (quest_slot_eq, "qst_collect_debt", slot_quest_current_state, 1),
      (quest_get_slot, ":target_troop", "qst_collect_debt", slot_quest_target_troop),
      (str_store_troop_name, s7, ":target_troop"),
      (quest_get_slot, ":total_collected","qst_collect_debt",slot_quest_target_amount),
      (store_div, reg3, ":total_collected", 5),
      (store_sub, reg4, ":total_collected", reg3)],
    "I'm told that you've collected the money owed me from {s7}. Good, it's past time I had it back. " +
    "I believe I promised to give you one-fifth of it all, eh? " +
    "Well, that makes {reg3} denars, so if you give me my share -- that's {reg4} denars -- you can keep the rest.", "lord_collect_debt_completed", []],
  
  
  [anyone|plyr,"lord_collect_debt_completed", [(store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", reg4)],
    "Of course, {s65}. {reg4} denars, all here.", "lord_collect_debt_pay",[]],
  
  [anyone,"lord_collect_debt_pay", [],
    "I must admit I'm impressed, {playername}. I had lost hope of ever getting this money back. " +
    "Please accept my sincere thanks.", "lord_pretalk",[
      (troop_remove_gold, "trp_player", reg4),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop", 2),
      (add_xp_as_reward, 100),
      (call_script, "script_end_quest", "qst_collect_debt")
  ]],
  
  [anyone|plyr,"lord_collect_debt_completed", [], "I am afraid I don't have the money with me sir.", "lord_collect_debt_no_pay",[]],
  [anyone,"lord_collect_debt_no_pay", [], "Is this a joke? " +
    "I know full well that {s7} gave you the money, and I want every denar owed to me, {sir/madam}. " +
    "As far as I'm concerned, I hold you personally in my debt until I see that silver.", "close_window",[
      (call_script, "script_change_debt_to_troop", "$g_talk_troop", reg4),
      (call_script, "script_end_quest", "qst_collect_debt"),
      
      (call_script, "script_objectionable_action", tmt_honest, "str_squander_money"),
  ]],
  
  [anyone,"lord_start", [(store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_kill_local_merchant"),
      (check_quest_succeeded, "qst_kill_local_merchant"),
      (quest_slot_eq, "qst_kill_local_merchant", slot_quest_current_state, 1)],
    "I heard you got rid of that poxy merchant that was causing me so much grief. " +
    "I can see you're not afraid to get your hands dirty, eh? I like that in a {man/woman}. " +
    "Here's your reward. Remember, {playername}, stick with me and we'll go a long, long way together.", "close_window",
    [ (call_script, "script_troop_add_gold", "trp_player", 600),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",4),
      (add_xp_as_reward, 300),
      (call_script, "script_end_quest", "qst_kill_local_merchant"),
      
      (call_script, "script_objectionable_action", tmt_humanitarian, "str_murder_merchant"),
      
      (assign, "$g_leave_encounter", 1)]],
  
  [anyone,"lord_start", [(store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_kill_local_merchant"),
      (check_quest_failed, "qst_kill_local_merchant")],
    "Oh, it's you. Enlighten me, how exactly does one lose a simple fight to some poxy, lowborn merchant? " +
    "Truly, if I ever need my guardsmen to take a lesson in how to lay down and die, I'll be sure to come to you. " +
    "Just leave me be, {playername}, I have things to do.", "close_window",
    [(call_script, "script_end_quest", "qst_kill_local_merchant"),
      (assign, "$g_leave_encounter", 1)]],
  
  [anyone,"lord_start", [(store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_kill_local_merchant"),
      (check_quest_succeeded, "qst_kill_local_merchant"),
      (quest_slot_eq, "qst_kill_local_merchant", slot_quest_current_state, 2)],
    "You! Do you have sawdust between your ears? Did you think that when I said to kill the merchant, " +
    "I meant you to have a nice chat with him and then let him go?! What possessed you?", "lord_kill_local_merchant_let_go",[]],
  
  [anyone|plyr,"lord_kill_local_merchant_let_go", [],
    "Sir, I made sure he will not act against you.", "lord_kill_local_merchant_let_go_2",[]],
  
  [anyone,"lord_kill_local_merchant_let_go_2", [],
    "Piffle. You were supposed to remove him, not give him a sermon and send him on his way. " +
    "He had better do as you say, or you'll both regret it. " +
    "Here, this is half the money I promised you. Don't say a word, {playername}, you're lucky to get even that. " +
    "I have little use for {men/people} who cannot follow orders.", "lord_pretalk",
    [(call_script, "script_troop_add_gold", "trp_player", 300),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",2),
      (add_xp_as_reward, 500),
      (call_script, "script_end_quest", "qst_kill_local_merchant"),
      (assign, "$g_leave_encounter", 1)
  ]],
  
  ##  [anyone,"lord_start", [(store_partner_quest,":lords_quest"),
  ##                         (eq,":lords_quest","qst_hunt_down_raiders"),
  ##                         (check_quest_failed, "qst_hunt_down_raiders")],
  ##   "I heard that those raiders you were after have got away. Do you have an explanation?", "quest_hunt_down_raiders_failed",[]],
  ##  [anyone|plyr,"quest_hunt_down_raiders_failed", [],  "They were too quick for us my lord. But next time we'll get them", "quest_hunt_down_raiders_failed_2",[]],
  ##  [anyone|plyr,"quest_hunt_down_raiders_failed", [],  "They were too strong and well armed my lord. But we'll be ready for them next time.", "quest_hunt_down_raiders_failed_2",[]],
  ##
  ##  [anyone|plyr,"quest_hunt_down_raiders_failed", [],  "Well, it was a long call anyway. Next time do make sure that you are better prepared.",
  ##   "lord_pretalk",[(call_script, "script_end_quest", "qst_hunt_down_raiders")]],
  ##
  ##
  ##
  ##  [anyone,"lord_start", [(store_partner_quest,":lords_quest"),
  ##                         (eq,":lords_quest","qst_hunt_down_raiders"),
  ##                         (check_quest_succeeded, "qst_hunt_down_raiders")],
  ##   "I heard that you have given those raiders the punishment they deserved. Well done {playername}.\
  ## ", "lord_generic_mission_completed",[(call_script, "script_finish_quest", "qst_hunt_down_raiders", 100),
  ##                                      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",3)]],
  ##
  
  
  ##  [anyone,"lord_start", [(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                         (store_partner_quest,":lords_quest"),
  ##                         (eq,":lords_quest","qst_defend_nobles_against_peasants"),
  ##                         (this_or_next|check_quest_succeeded, "qst_defend_nobles_against_peasants"),
  ##                         (check_quest_failed, "qst_defend_nobles_against_peasants"),
  ##                         (assign, ":num_saved", "$qst_defend_nobles_against_peasants_num_nobles_saved"),
  ##                         (party_count_companions_of_type, ":num_nobles", "p_main_party", "trp_noble_refugee"),
  ##                         (val_add, ":num_saved", ":num_nobles"),
  ##                         (party_count_companions_of_type, ":num_nobles", "p_main_party", "trp_noble_refugee_woman"),
  ##                         (val_add, ":num_saved", ":num_nobles"),
  ##                         (assign, "$qst_defend_nobles_against_peasants_num_nobles_saved", ":num_saved"),
  ##                         (eq, ":num_saved", "$qst_defend_nobles_against_peasants_num_nobles_to_save")],
  ##   "TODO: You have saved all of them. Good boy.", "lord_generic_mission_completed",
  ##   [(party_remove_members, "p_main_party", "trp_noble_refugee", "$qst_defend_nobles_against_peasants_num_nobles_saved"),
  ##    (party_remove_members, "p_main_party", "trp_noble_refugee_woman", "$qst_defend_nobles_against_peasants_num_nobles_saved"),
  ##    (call_script, "script_finish_quest", "qst_defend_nobles_against_peasants", 100)]],
  ##
  ##  [anyone,"lord_start", [(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                         (store_partner_quest,":lords_quest"),
  ##                         (eq,":lords_quest","qst_defend_nobles_against_peasants"),
  ##                         (this_or_next|check_quest_succeeded, "qst_defend_nobles_against_peasants"),
  ##                         (check_quest_failed, "qst_defend_nobles_against_peasants"),
  ##                         (assign, ":num_saved", "$qst_defend_nobles_against_peasants_num_nobles_saved"),
  ##                         (party_count_companions_of_type, ":num_nobles", "p_main_party", "trp_noble_refugee"),
  ##                         (val_add, ":num_saved", ":num_nobles"),
  ##                         (party_count_companions_of_type, ":num_nobles", "p_main_party", "trp_noble_refugee_woman"),
  ##                         (val_add, ":num_saved", ":num_nobles"),
  ##                         (assign, "$qst_defend_nobles_against_peasants_num_nobles_saved", ":num_saved"),
  ##                         (lt, ":num_saved", "$qst_defend_nobles_against_peasants_num_nobles_to_save"),
  ##                         (gt, "$qst_defend_nobles_against_peasants_num_nobles_saved", 0)],
  ##   "TODO: You have saved some of them. Half good boy.", "lord_capture_conspirators_half_completed",
  ##   [(party_remove_members, "p_main_party", "trp_noble_refugee", "$qst_defend_nobles_against_peasants_num_nobles_saved"),
  ##    (party_remove_members, "p_main_party", "trp_noble_refugee_woman", "$qst_defend_nobles_against_peasants_num_nobles_saved"),
  ##    (assign, ":ratio", 100),
  ##    (val_mul, ":ratio", "$qst_defend_nobles_against_peasants_num_nobles_saved"),
  ##    (val_div, ":ratio", "$qst_defend_nobles_against_peasants_num_nobles_to_save"),
  ##    (call_script, "script_finish_quest", "qst_defend_nobles_against_peasants", ":ratio")]],
  ##
  ##  [anyone,"lord_start", [(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                         (store_partner_quest,":lords_quest"),
  ##                         (eq,":lords_quest","qst_defend_nobles_against_peasants"),
  ##                         (this_or_next|check_quest_succeeded, "qst_defend_nobles_against_peasants"),
  ##                         (check_quest_failed, "qst_defend_nobles_against_peasants"),
  ##                         (assign, ":num_saved", "$qst_defend_nobles_against_peasants_num_nobles_saved"),
  ##                         (party_count_companions_of_type, ":num_nobles", "p_main_party", "trp_noble_refugee"),
  ##                         (val_add, ":num_saved", ":num_nobles"),
  ##                         (party_count_companions_of_type, ":num_nobles", "p_main_party", "trp_noble_refugee_woman"),
  ##                         (val_add, ":num_saved", ":num_nobles"),
  ##                         (eq, ":num_saved", 0)],
  ##   "TODO: You have saved none of them. Bad boy.", "lord_generic_mission_failed", []],
  ##
  ##
  ##  [anyone,"lord_start", [(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                         (store_partner_quest,":lords_quest"),
  ##                         (eq,":lords_quest","qst_capture_conspirators"),
  ##                         (this_or_next|check_quest_succeeded, "qst_capture_conspirators"),
  ##                         (check_quest_failed, "qst_capture_conspirators"),
  ##                         (party_count_prisoners_of_type, ":num_conspirators", "p_main_party", "trp_conspirator"),
  ##                         (party_count_prisoners_of_type, ":num_conspirator_leaders", "p_main_party", "trp_conspirator_leader"),
  ##                         (store_add, ":sum_captured", ":num_conspirators", ":num_conspirator_leaders"),
  ##                         (ge, ":sum_captured", "$qst_capture_conspirators_num_troops_to_capture")],
  ##   "TODO: You have captured all of them. Good boy.", "lord_generic_mission_completed",
  ##   [(party_remove_prisoners, "p_main_party", "trp_conspirator_leader", "$qst_capture_conspirators_num_troops_to_capture"),
  ##    (party_remove_prisoners, "p_main_party", "trp_spy_partner", "$qst_capture_conspirators_num_troops_to_capture"),
  ##    (call_script, "script_finish_quest", "qst_capture_conspirators", 100)]],
  ##
  ##  [anyone,"lord_start", [(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                         (store_partner_quest,":lords_quest"),
  ##                         (eq,":lords_quest","qst_capture_conspirators"),
  ##                         (this_or_next|check_quest_succeeded, "qst_capture_conspirators"),
  ##                         (check_quest_failed, "qst_capture_conspirators"),
  ##                         (party_count_prisoners_of_type, ":num_conspirators", "p_main_party", "trp_conspirator"),
  ##                         (party_count_prisoners_of_type, ":num_conspirator_leaders", "p_main_party", "trp_conspirator_leader"),
  ##                         (store_add, ":sum_captured", ":num_conspirators", ":num_conspirator_leaders"),
  ##                         (lt, ":sum_captured", "$qst_capture_conspirators_num_troops_to_capture"),
  ##                         (gt, ":sum_captured", 0)],
  ##   "TODO: You have captured some of them. Half good boy.", "lord_capture_conspirators_half_completed",
  ##   [(assign, ":sum_removed", 0),
  ##    (party_remove_prisoners, "p_main_party", "trp_conspirator_leader", "$qst_capture_conspirators_num_troops_to_capture"),
  ##    (val_add, ":sum_removed", reg0),
  ##    (party_remove_prisoners, "p_main_party", "trp_conspirator", "$qst_capture_conspirators_num_troops_to_capture"),
  ##    (val_add, ":sum_removed", reg0),
  ##    (val_mul, ":sum_removed", 100),
  ##    (val_div, ":sum_removed", "$qst_capture_conspirators_num_troops_to_capture"),
  ##    (call_script, "script_finish_quest", "qst_capture_conspirators", ":sum_removed")]],
  ##
  ##  [anyone,"lord_start", [(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                         (store_partner_quest,":lords_quest"),
  ##                         (eq,":lords_quest","qst_capture_conspirators"),
  ##                         (this_or_next|check_quest_succeeded, "qst_capture_conspirators"),
  ##                         (check_quest_failed, "qst_capture_conspirators"),
  ##                         (party_count_prisoners_of_type, ":num_conspirators", "p_main_party", "trp_conspirator"),
  ##                         (party_count_prisoners_of_type, ":num_conspirator_leaders", "p_main_party", "trp_conspirator_leader"),
  ##                         (store_add, ":sum_captured", ":num_conspirators", ":num_conspirator_leaders"),
  ##                         (eq, ":sum_captured", 0)],
  ##   "TODO: You have captured none of them. Bad boy.", "lord_generic_mission_failed", []],
  ##
  ##  [anyone|plyr,"lord_capture_conspirators_half_completed", [],
  ##   "TODO: That's all I can do.", "lord_pretalk", []],
  
  
  [anyone,"lord_start", [#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_follow_spy"),
      (eq, "$qst_follow_spy_no_active_parties", 1),
      (party_count_prisoners_of_type, ":num_spies", "p_main_party", "trp_spy"),
      (party_count_prisoners_of_type, ":num_spy_partners", "p_main_party", "trp_spy_partner"),
      (gt, ":num_spies", 0),
      (gt, ":num_spy_partners", 0)],
    "Beautiful work, {playername}! You captured both the spy and his handler, just as I'd hoped, " +
    "and the pair are now safely ensconced in my dungeon, waiting to be questioned. " +
    "My torturer shall be busy tonight! Anyway, I'm very pleased with your success, {playername}, and I give you " +
    "this purse as a token of my appreciation.", "lord_follow_spy_completed",
    [(party_remove_prisoners, "p_main_party", "trp_spy", 1),
      (party_remove_prisoners, "p_main_party", "trp_spy_partner", 1),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",4),
      (call_script, "script_troop_add_gold", "trp_player", 2000),
      (add_xp_as_reward, 4000),
      (call_script, "script_end_quest", "qst_follow_spy")]],
  
  [anyone,"lord_start", [#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_follow_spy"),
      (eq, "$qst_follow_spy_no_active_parties", 1),
      (party_count_prisoners_of_type, ":num_spies", "p_main_party", "trp_spy"),
      (party_count_prisoners_of_type, ":num_spy_partners", "p_main_party", "trp_spy_partner"),
      (gt, ":num_spies", 0),
      (eq, ":num_spy_partners", 0),],
    "Blast and damn you! I wanted TWO prisoners, {playername} -- what you've brought me is one step short of " +
    "useless! I already know everything the spy knows, it was the handler I was after. " +
    "Here, half a job gets you half a reward. Take it and begone.", "lord_follow_spy_half_completed",
    [(party_remove_prisoners, "p_main_party", "trp_spy", 1),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-1),
      (call_script, "script_troop_add_gold", "trp_player", 1000),
      (add_xp_as_reward, 400),
      (call_script, "script_end_quest", "qst_follow_spy")]],
  
  [anyone,"lord_start", [#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_follow_spy"),
      (eq, "$qst_follow_spy_no_active_parties", 1),
      (party_count_prisoners_of_type, ":num_spies", "p_main_party", "trp_spy"),
      (party_count_prisoners_of_type, ":num_spy_partners", "p_main_party", "trp_spy_partner"),
      (eq, ":num_spies", 0),
      (gt, ":num_spy_partners", 0),
    ],
    "I asked you for two prisoners, {playername}, not one. Two. Still, I suppose you did capture the spy's handler, " +
    "the more important one of the pair. The spy will not dare return here and will prove quite useless to " +
    "whatever master he served. 'Tis better than nothing. " +
    "However, you'll understand if I pay you half the promised reward for what is but half a success.", "lord_follow_spy_half_completed",
    [(party_remove_prisoners, "p_main_party", "trp_spy_partner", 1),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",1),
      (call_script, "script_troop_add_gold", "trp_player", 1000),
      (add_xp_as_reward, 400),
      (call_script, "script_end_quest", "qst_follow_spy")]],
  
  [anyone,"lord_start", [(store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_follow_spy"),
      (eq, "$qst_follow_spy_no_active_parties", 1),
      (party_count_prisoners_of_type, ":num_spies", "p_main_party", "trp_spy"),
      (party_count_prisoners_of_type, ":num_spy_partners", "p_main_party", "trp_spy_partner"),
      (eq, ":num_spies", 0),
      (eq, ":num_spy_partners", 0),
    ],
    "Truly, {playername}, you are nothing short of totally incompetent. " +
    "Failing to capture both the spy AND his handler plumbs astonishing new depths of failure. " +
    "Forget any reward I offered you. You've done nothing to earn it.", "lord_follow_spy_failed",
    [
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-2),
      (call_script, "script_end_quest", "qst_follow_spy"),
  ]],
  
  [anyone|plyr,"lord_follow_spy_half_completed", [],
    "I did my best, {s65}.", "lord_pretalk", []],
  
  [anyone|plyr,"lord_follow_spy_completed", [],
    "Thank you, {s65}.", "lord_pretalk", []],
  
  [anyone|plyr,"lord_follow_spy_failed", [],
    "Hrm. As you like, {s65}.", "lord_pretalk", []],
  
  
  [anyone,"lord_start", [(store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_bring_back_runaway_serfs"),
      (check_quest_succeeded, "qst_bring_back_runaway_serfs")],
    "Splendid work, {playername}. All the serfs are back, properly cowed, and they're busy preparing for the harvest. " +
    "You certainly earned your reward. Here, take it, with my compliments.", "lord_generic_mission_completed",
    [(call_script, "script_change_player_relation_with_troop","$g_talk_troop", 2),
      (call_script, "script_troop_add_gold", "trp_player", 300),
      (add_xp_as_reward, 300),
      (call_script, "script_end_quest", "qst_bring_back_runaway_serfs"),
      (call_script, "script_objectionable_action", tmt_humanitarian, "str_round_up_serfs"),
  ]],
  
  [anyone,"lord_start", [(store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_bring_back_runaway_serfs"),
      (check_quest_failed, "qst_bring_back_runaway_serfs"),],
    "{playername}. I have been waiting patiently for my serfs, yet none have returned. Have you an explanation? " +
    "Were you outwitted by simple fieldhands, or are you merely incompetent? " +
    "Or perhaps you are plotting with my enemies, intending to ruin me...", "lord_bring_back_runaway_serfs_failed", []],
  [anyone|plyr,"lord_bring_back_runaway_serfs_failed", [],
    "Forgive me, {s65}, those serfs were slippery as eels.", "lord_bring_back_runaway_serfs_failed_1a", []],
  [anyone|plyr,"lord_bring_back_runaway_serfs_failed", [],
    "Perhaps if you had treated them better...", "lord_bring_back_runaway_serfs_failed_1b", []],
  [anyone,"lord_bring_back_runaway_serfs_failed_1a", [],
    "Hmph, that is hardly an excuse for failure, {playername}. " +
    "Now if you will excuse me, I need to recruit new men to work these fields before we all starve.", "lord_pretalk",
    [(call_script, "script_change_player_relation_with_troop","$g_talk_troop",-1),
      (call_script, "script_end_quest", "qst_bring_back_runaway_serfs")]],
  [anyone,"lord_bring_back_runaway_serfs_failed_1b", [],
    "Hah, now you reveal your true colours, traitor! Your words match your actions all too well. I should never have trusted you.", "close_window",
    [(call_script, "script_change_player_relation_with_troop","$g_talk_troop",-10),
      (quest_get_slot, ":home_village", "qst_bring_back_runaway_serfs", slot_quest_object_center),
      (call_script, "script_change_player_relation_with_center",":home_village",6),
      (call_script, "script_end_quest", "qst_bring_back_runaway_serfs"),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone,"lord_start", [(store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_bring_back_runaway_serfs"),
      (check_quest_concluded, "qst_bring_back_runaway_serfs"),
      (assign, reg17, "$qst_bring_back_runaway_serfs_num_parties_returned")],
    "You disappoint me, {playername}. There were 3 groups of serfs that I charged you to return. 3. Not {reg17}. " +
    "I suppose the ones who did come back shall have to work twice as hard to make up for those that got away. " +
    "As for your reward, {playername}, I'll only pay you for the serfs you returned, not the ones you let fly. " +
    "Here. Take it, and let this business be done.", "lord_runaway_serf_half_completed",
    [(store_mul, ":reward", "$qst_bring_back_runaway_serfs_num_parties_returned", 100),
      (val_div, ":reward", 2),
      #	(store_div, ":relation_boost", "$qst_bring_back_runaway_serfs_num_parties_returned", 1),
      #    (call_script, "script_change_player_relation_with_troop","$g_talk_troop", ":relation_boost"),
      (call_script, "script_troop_add_gold", "trp_player", ":reward"),
      (add_xp_as_reward, ":reward"),
      
      
      (call_script, "script_objectionable_action", tmt_humanitarian, "str_round_up_serfs"),
      
      (call_script, "script_end_quest", "qst_bring_back_runaway_serfs"),
  ]],
  
  [anyone|plyr,"lord_runaway_serf_half_completed", [],
    "Thank you, {s65}. You are indeed generous.", "lord_pretalk", []],
  [anyone|plyr,"lord_runaway_serf_half_completed", [],
    "Bah, this proved to be a waste of my time.", "lord_pretalk", []],
  
  [anyone,"lord_start", [(store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_deal_with_bandits_at_lords_village"),
      (check_quest_succeeded, "qst_deal_with_bandits_at_lords_village")],
    "{playername}, I was told that you have crushed the bandits at my village of {s5}. Please know that I am most grateful to you for that. " +
    "Please, let me pay the expenses of your campaign. Here, I hope these {reg14} denars will be adequate.", "lord_deal_with_bandits_completed",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 3),
      (store_character_level, ":level", "trp_player"),
      (store_mul, ":reward", ":level", 20),
      (val_add, ":reward", 300),
      (call_script, "script_troop_add_gold", "trp_player", ":reward"),
      (add_xp_as_reward, 350),
      (call_script, "script_end_quest", "qst_deal_with_bandits_at_lords_village"),
      (assign, reg14, ":reward"),
      (quest_get_slot, ":village", "qst_deal_with_bandits_at_lords_village", slot_quest_target_center),
      (str_store_party_name, s5, ":village"),
  ]],
  
  [anyone|plyr, "lord_deal_with_bandits_completed", [],
    "Not a problem, {s65}.", "lord_pretalk",[]],
  [anyone|plyr, "lord_deal_with_bandits_completed", [],
    "Glad to be of service.", "lord_pretalk",[]],
  [anyone|plyr, "lord_deal_with_bandits_completed", [],
    "It was mere child's play.", "lord_pretalk",[]],
  
  [anyone,"lord_start", [(store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_deal_with_bandits_at_lords_village"),
      (check_quest_concluded, "qst_deal_with_bandits_at_lords_village")],
    "Damn it, {playername}. I heard that you were unable to drive off the bandits from my village of {s5}, and thanks to you, my village now lies in ruins. " +
    "Everyone said that you were a capable warrior, but appearently, they were wrong.", "lord_pretalk",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -5),
      (call_script, "script_end_quest", "qst_deal_with_bandits_at_lords_village"),
      (quest_get_slot, ":village", "qst_deal_with_bandits_at_lords_village", slot_quest_target_center),
      (str_store_party_name, s5, ":village"),
  ]],
  
  
  [anyone,"lord_start", [(store_partner_quest,":lords_quest"),
      (eq, ":lords_quest", "qst_deliver_cattle_to_army"),
      (check_quest_succeeded, "qst_deliver_cattle_to_army"),
      (quest_get_slot, reg13, "qst_deliver_cattle_to_army", slot_quest_target_amount),
    ],
    "Ah, {playername}. My quartermaster has informed me of your delivery, {reg13} heads of cattle, as I requested. I'm impressed.", "lord_deliver_cattle_to_army_thank",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 2),
      (quest_get_slot, ":quest_target_amount", "qst_deliver_cattle_to_army", slot_quest_target_amount),
      #TODO: Change reward
      (store_mul, ":reward", ":quest_target_amount", 100),
      (call_script, "script_troop_add_gold", "trp_player", ":reward"),
      (val_div, ":reward", 5),
      (add_xp_as_reward, ":reward"),
      (call_script, "script_end_quest", "qst_deliver_cattle_to_army"),
      #Reactivating follow army quest
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (setup_quest_text, "qst_follow_army"),
      (str_store_string, s2, "str_follow_army_quest_brief_2"),
      (call_script, "script_start_quest", "qst_follow_army", "$g_talk_troop"),
      (assign, "$g_player_follow_army_warnings", 0),
  ]],
  
  [anyone|plyr, "lord_deliver_cattle_to_army_thank", [],
    "Not a problem, {s65}.", "lord_pretalk",[]],
  [anyone|plyr, "lord_deliver_cattle_to_army_thank", [],
    "Glad to be of service.", "lord_pretalk",[]],
  [anyone|plyr, "lord_deliver_cattle_to_army_thank", [],
    "Mere child's play.", "lord_pretalk",[]],
  
  [anyone,"lord_start", [(store_partner_quest,":lords_quest"),
      (eq, ":lords_quest", "qst_scout_waypoints"),
      (check_quest_succeeded, "qst_scout_waypoints"),
      (str_store_party_name, s13, "$qst_scout_waypoints_wp_1"),
      (str_store_party_name, s14, "$qst_scout_waypoints_wp_2"),
      (str_store_party_name, s15, "$qst_scout_waypoints_wp_3"),
    ],
    "You make a good scout, {playername}. My runner just brought me your reports of the mission to {s13}, {s14} and {s15}. Well done.", "lord_scout_waypoints_thank",
    [
      #TODO: Change reward
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      #     (call_script, "script_troop_add_gold", "trp_player", 100),
      (add_xp_as_reward, 100),
      (try_begin),
        (eq, "$freelancer_state", 2), #Mission
        (store_faction_of_troop, ":commander_faction", "$enlisted_lord"),
        (faction_get_slot, ":freelancer_rank", ":commander_faction", slot_freelancer_rank),
        (try_begin),
          (le, ":freelancer_rank", 2),
          (add_xp_as_reward, 25),
        (else_try),
          (le, ":freelancer_rank", 4),
          (add_xp_as_reward, 55),
          (call_script, "script_troop_add_gold", "trp_player", 100),
        (else_try),
          (add_xp_as_reward, 85),
          (call_script, "script_troop_add_gold", "trp_player", 200),
        (try_end),
      (try_end),
      (call_script, "script_end_quest", "qst_scout_waypoints"),
      #Reactivating follow army quest - Edited for use by Freelancer Missions - Kham
      (try_begin),
        (neq, "$freelancer_state", 2),
        (str_store_troop_name_link, s9, "$g_talk_troop"),
        (setup_quest_text, "qst_follow_army"),
        (str_store_string, s2, "str_follow_army_quest_brief_2"),
        (call_script, "script_start_quest", "qst_follow_army", "$g_talk_troop"),
        (assign, "$g_player_follow_army_warnings", 0),
      (try_end),
  ]],
  
  [anyone|plyr, "lord_scout_waypoints_thank", [],
    "A simple task, {s65}.", "lord_pretalk",[]],
  [anyone|plyr, "lord_scout_waypoints_thank", [],
    "Nothing I couldn't handle.", "lord_pretalk",[]],
  [anyone|plyr, "lord_scout_waypoints_thank", [],
    "My pleasure, {s65}.", "lord_pretalk",[]],
  
  
  
  [anyone, "lord_start",
    [
      (check_quest_active, "qst_follow_army"),
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_marshall, "$g_talk_troop"),
      (eq, "$g_random_army_quest", "qst_deliver_cattle_to_army"),
      (quest_get_slot, ":quest_target_amount", "$g_random_army_quest", slot_quest_target_amount),
      (assign, reg3, ":quest_target_amount"),
    ],
    "The army's supplies are dwindling too quickly, {playername}. I need you to bring me {reg3} heads of cattle so I can keep the troops fed. I care very little about where you get them, just bring them to me as soon as you can.", "lord_mission_told_deliver_cattle_to_army",
    [
    ]
  ],
  
  [anyone|plyr,"lord_mission_told_deliver_cattle_to_army", [], "Very well, I can find you some cattle.", "lord_mission_told_deliver_cattle_to_army_accepted",[]],
  [anyone|plyr,"lord_mission_told_deliver_cattle_to_army", [], "Sorry, sir, I have other plans.", "lord_mission_told_deliver_cattle_to_army_rejected",[]],
  
  [anyone,"lord_mission_told_deliver_cattle_to_army_accepted", [], "Excellent! You know what to do, {playername}, now get to it. I need that cattle sooner rather than later.", "close_window",
    [
      (call_script, "script_end_quest", "qst_follow_army"),
      (quest_get_slot, ":quest_target_amount", "$g_random_army_quest", slot_quest_target_amount),
      (str_store_troop_name_link, s13, "$g_talk_troop"),
      (assign, reg3, ":quest_target_amount"),
      (setup_quest_text, "$g_random_army_quest"),
      (str_store_string, s2, "@{s13} asked you to gather {reg3} heads of cattle and deliver them back to him."),
      (call_script, "script_start_quest", "$g_random_army_quest", "$g_talk_troop"),
      #TODO: Change this value
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      (assign, "$g_leave_encounter",1),
  ]],
  
  [anyone, "lord_mission_told_deliver_cattle_to_army_rejected", [], "That . . . is unfortunate, {playername}. I shall have to find someone else who's up to the task. Please go now, I've work to do.", "close_window",
    [(troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1),
      (assign, "$g_leave_encounter",1),]],
  
  
  [anyone,"lord_start",[(check_quest_active,"qst_report_to_army"),
      (quest_slot_eq, "qst_report_to_army", slot_quest_target_troop, "$g_talk_troop"),
      (assign, ":kingdom_at_war", 0),
      (try_for_range, ":kingdom", kingdoms_begin, kingdoms_end),
        (store_relation, ":relation", ":kingdom", "$players_kingdom"),
        (lt, ":relation", 0),
        (assign, ":kingdom_at_war", 1),
      (try_end),
      (eq, ":kingdom_at_war", 0),
    ],
    "Thank you for answering the summons, {playername}. However, as we are now at peace, we do not need your services. You may attend to your other business.", "lord_pretalk",
    [
      (call_script, "script_end_quest", "qst_report_to_army"),
      (quest_set_slot, "qst_report_to_army", slot_quest_giver_troop, "$g_talk_troop"),
      #TODO: Change this value
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
  ]],
  
  [anyone,"lord_start",[
      (check_quest_active,"qst_report_to_army"),
      (quest_slot_eq, "qst_report_to_army", slot_quest_target_troop, "$g_talk_troop"),
    ],
    "Ah, you have arrived at last, {playername}. We've been expecting you. I hope you have brought with you troops of sufficient number and experience.", "lord_report_to_army_asked",
    []],
  
  [anyone|plyr,"lord_report_to_army_asked", [(quest_get_slot, ":quest_target_amount", "qst_report_to_army", slot_quest_target_amount),
      (call_script, "script_party_count_fit_for_battle", "p_main_party"),
      (gt, reg0, ":quest_target_amount"), # +1 for player
    ],
    "I have a company of good, hardened soldiers with me. We are ready to join you.", "lord_report_to_army_completed",
    []],
  
  [anyone|plyr,"lord_report_to_army_asked", [],
    "I don't have the sufficient number of troops yet. I will need some more time.", "lord_report_to_army_continue",
    []],
  
  [anyone,"lord_report_to_army_completed", [], "Excellent. We'll be moving soon. Now -- you are a {man/warrior} of sound judgement, and we trust that you will do what is necessary to support our campaign. I do not require you to remain close at hand, and I will not count it against you if you believe that your forces would be of better use elsewhere. But if you do choose to remain with me, to support me in battle, that would be appreciated. I may also have additional tasks for you to perform.", "close_window",[
      (call_script, "script_end_quest", "qst_report_to_army"),
      (quest_set_slot, "qst_report_to_army", slot_quest_giver_troop, "$g_talk_troop"),
      #TODO: Change this value
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      #Activating follow army quest
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (setup_quest_text, "qst_follow_army"),
      (str_store_string, s2, "@{s9} wants you to follow his army until further notice."),
      (call_script, "script_start_quest", "qst_follow_army", "$g_talk_troop"),
      (assign, "$g_player_follow_army_warnings", 0),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone,"lord_report_to_army_continue", [], "Then you'd better hurry. We'll be moving out soon against the enemy and I need every able hand we can muster.", "close_window",
    [(assign, "$g_leave_encounter",1),
      #Must be closed because of not letting player to terminate this quest on the general conversation
  ]],
  
  
  [anyone, "lord_start",
    [
      (check_quest_active, "qst_follow_army"),
      (faction_slot_eq, "$players_kingdom", slot_faction_marshall, "$g_talk_troop"),
      (eq, "$g_random_army_quest", "qst_scout_waypoints"),
      (str_store_party_name, s13, "$qst_scout_waypoints_wp_1"),
      (str_store_party_name, s14, "$qst_scout_waypoints_wp_2"),
      (str_store_party_name, s15, "$qst_scout_waypoints_wp_3"),
    ],
    "{playername}, I need a volunteer to scout the area. We're sorely lacking on information, " +
    "and I simply must have a better picture of the situation before we can proceed. " +
    "I want you to go to {s13}, {s14} and {s15} and report back whatever you find.", "lord_mission_told_scout_waypoints",
    [
  ]],
  
  [anyone|plyr, "lord_mission_told_scout_waypoints", [], "You've found your volunteer, sir.", "lord_mission_told_scout_waypoints_accepted",[]],
  [anyone|plyr, "lord_mission_told_scout_waypoints", [], "I fear I must decline.", "lord_mission_told_scout_waypoints_rejected",[]],
  
  [anyone,"lord_mission_told_scout_waypoints_accepted", [], "Good {man/lass}! Simply pass near {s13}, {s14} and {s15} and check out what's there. Make a note of anything you find and return to me as soon as possible.", "close_window",
    [
      (call_script, "script_end_quest", "qst_follow_army"),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_party_name_link, s13, "$qst_scout_waypoints_wp_1"),
      (str_store_party_name_link, s14, "$qst_scout_waypoints_wp_2"),
      (str_store_party_name_link, s15, "$qst_scout_waypoints_wp_3"),
      (setup_quest_text, "$g_random_army_quest"),
      (str_store_string, s2, "@{s9} asked you to scout {s13}, {s14} and {s15}, then report back."),
      (call_script, "script_start_quest", "$g_random_army_quest", "$g_talk_troop"),
      #TODO: Change this value
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      (assign, "$g_leave_encounter",1),
  ]],
  
  [anyone,"lord_mission_told_scout_waypoints_rejected", [], "Hm. I'm disappointed, {playername}. Very disappointed. We'll talk later, I need to go and find somebody to scout for us.", "lord_pretalk",
    [(troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1)]],
  
  
  
  
  ##
  ##  [anyone,"lord_start",[(check_quest_active,"qst_rescue_lady_under_siege"),
  ##                        (quest_slot_eq, "qst_rescue_lady_under_siege", slot_quest_target_troop, "$g_talk_troop"),
  ##                        (quest_slot_eq, "qst_rescue_lady_under_siege", slot_quest_current_state, 1)],
  ##   "I heard that you have rescued my {s7} from the siege of {s5} and brought her to safety.\
  ## I am in your debt for this {playername}. Thank you.", "lord_generic_mission_completed",
  ##   [(quest_get_slot, ":quest_object_troop", "qst_rescue_lady_under_siege", slot_quest_object_troop),
  ##    (try_begin),
  ##      (troop_slot_eq, "$g_talk_troop", slot_troop_daughter, ":quest_object_troop"),
  ##      (str_store_string, s7, "str_daughter"),
  ##    (else_try),
  ##      (str_store_string, s7, "str_wife"),
  ##    (try_end),
  ##    (remove_member_from_party, ":quest_object_troop"),
  ##    (try_begin),
  ##      (is_between, "$g_encountered_party", centers_begin, centers_end),#Lord might be in wilderness
  ##      (troop_set_slot, ":quest_object_troop", slot_troop_cur_center, "$g_encountered_party"),
  ##    (try_end),
  ##    (call_script, "script_finish_quest", "qst_rescue_lady_under_siege", 100),
  ##    (call_script, "script_change_player_relation_with_troop","$g_talk_troop", 4),
  ##    ]],
  ##
  ##### TODO: QUESTS COMMENT OUT END
  [anyone,"lord_generic_mission_thank", [],
    "You have been most helpful, {playername}. My thanks.", "lord_generic_mission_completed",[]],
  
  [anyone|plyr,"lord_generic_mission_completed", [],
    "It was an honour to serve.", "lord_pretalk",[]],
  
  ##  [anyone|plyr,"lord_generic_mission_failed", [],
  ##   "I'm sorry I failed you sir. It won't happen again.", "lord_pretalk",
  ##   [(store_partner_quest,":lords_quest"),
  ##    (call_script, "script_finish_quest", ":lords_quest"),
  ##    ]],
  
  [anyone,"lord_start", [#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (troop_get_slot, ":cur_debt", "$g_talk_troop", slot_troop_player_debt),
      (gt, ":cur_debt", 0),
      (assign, reg1, ":cur_debt")],
    "I think you owe me {reg1} denars, {playername}. Do you intend to pay your debt anytime soon?", "lord_pay_debt_2",[]],
  
  [anyone|plyr, "lord_pay_debt_2", [(troop_get_slot, ":cur_debt", "$g_talk_troop", slot_troop_player_debt),
      (store_troop_gold, ":cur_gold", "trp_player"),
      (le, ":cur_debt", ":cur_gold")],
    "That is why I came, {s65}. Here it is, every denar I owe you.", "lord_pay_debt_3_1", [(troop_get_slot, ":cur_debt", "$g_talk_troop", slot_troop_player_debt),
      (troop_remove_gold, "trp_player", ":cur_debt"),
      (troop_set_slot, "$g_talk_troop", slot_troop_player_debt, 0)]],
  
  [anyone|plyr, "lord_pay_debt_2", [],
    "Alas, I don't have sufficient funds, {s65}. But I'll pay you soon enough.", "lord_pay_debt_3_2", []],
  
  [anyone, "lord_pay_debt_3_1", [],
    "Ah, excellent. You are a {man/woman} of honour, {playername}. I am satisfied. Your debt to me has been paid in full.", "lord_pretalk", []],
  
  [anyone, "lord_pay_debt_3_2", [],
    "Well, don't keep me waiting much longer.", "lord_pretalk", []],
  
  ##  [anyone,"lord_start", [(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                         (is_between,"$g_talk_troop_faction_relation",0,3),
  ###                         (eq,"$players_kingdom",0),
  ##                         ],
  ##   "Why don't you join us in our cause? You seem to be an able fighter.\
  ## We need {men/people} like you who will take part in our glory and share the spoils of our victory.", "lord_talk",[]],
  
  
  #Claim center begin
  ##  [anyone,"lord_start", [(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                         (eq,"$g_talk_troop_faction","$players_kingdom"),
  ##                         (faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
  ##                         (call_script, "script_get_number_of_unclaimed_centers_by_player"),
  ##                         (gt, reg1, 0),
  ##                         (assign, "$center_to_be_claimed", reg1),
  ##                         (str_store_party_name, s4, "$center_to_be_claimed"),
  ##                         ],
  ##   "I heard that your forces have taken {s4}. I commend you for your victory {playername}.\
  ## But we need to decide what to do with this new castle now.", "lord_claim_center_begin", []],
  
  
  ##  [anyone,"lord_start", [(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                         (ge,"$g_talk_troop_faction_relation",0),
  ##                         (call_script, "script_get_number_of_unclaimed_centers_by_player"),
  ##                         (gt, reg1, 0),
  ##                         (assign, "$center_wanted_to_be_bought", reg1),
  ##                         (str_store_party_name, s4, "$center_wanted_to_be_bought"),
  ##                         (call_script, "script_get_number_of_hero_centers", "$g_talk_troop"),
  ##                         (assign, ":no_of_owned_centers", reg0),
  ##                         (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
  ##                         (lt, ":no_of_owned_centers", 2),
  ##                         (troop_get_slot, ":wealth", "$g_talk_troop", slot_troop_wealth),
  ##                         (ge, ":wealth", 6000)],
  ##   "I heard that your forces have taken {s4}. I applaud your victory {playername}, but you know as well as I do that\
  ## as a person of low rank and status you cannot be permitted to hold that castle for yourself.\
  ## It is to your benefit to sell it to a Lord like myself who can hold and protect the castle and the surrounding estates.\
  ## Anyway, I am ready to make you an offer of 5000 denars, should you decide to sell that castle.", "lord_buy_center", []],
  ##
  ##
  ##  [anyone|plyr,"lord_buy_center", [],
  ##   "I accept your offer sir. The castle is yours for 5000 denars.", "lord_buy_center_accept", []],
  ##  [anyone|plyr,"lord_buy_center", [],
  ##   "I am afraid I can't accept that offer.", "lord_buy_center_deny", []],
  ##
  ##  [anyone,"lord_buy_center_accept", [],
  ##   "Excellent, {playername}! You have decided wisely.\
  ## Why bother yourself with the necessities of keeping a castle while you can leave all those boring details to noble Lords like me?\
  ## I am sure money will be much more useful to you than a castle would.", "lord_buy_center_accept_2", []],
  ##
  ##  [anyone|plyr,"lord_buy_center_accept_2", [],
  ##   "One day sir, one day I'll have my own castle.", "lord_buy_center_accept_3", []],
  ##  [anyone|plyr,"lord_buy_center_accept_2", [],
  ##   "Everyone needs money sir. I can take another castle anytime.", "lord_buy_center_accept_3", []],
  ##
  ##  [anyone,"lord_buy_center_accept_3", [],
  ##   "Of course, of course, {playername}.  Then let us conclude our deal. Here's the 5000 denars I offered you.\
  ## I'll have my clerk handle the necessary details.\
  ## I guess from now on, {s4} belongs to me. Well, that worked very well for both of us, I guess.", "lord_pretalk",
  ##   [(troop_get_slot, ":wealth", "$g_talk_troop", slot_troop_wealth),
  ##    (val_sub, ":wealth", 6000),
  ##    (troop_set_slot, "$g_talk_troop", slot_troop_wealth, ":wealth"),
  ##    (call_script, "script_troop_add_gold", "trp_player", 5000),
  ##    (party_set_slot, "$center_wanted_to_be_bought", slot_town_lord, "$g_talk_troop"),
  ##    #Changing center faction
  ##    (party_set_faction, "$center_wanted_to_be_bought", "$g_talk_troop_faction"),
  ##    (set_spawn_radius, 1),
  ##    (spawn_around_party, "$center_wanted_to_be_bought", "pt_old_garrison"),
  ##    (assign, ":new_party", reg0),
  ##    (party_set_ai_behavior, ":new_party", ai_bhvr_attack_party),
  ##    (party_set_ai_object, ":new_party", "p_main_party"),
  ##    (party_set_flags, ":new_party", pf_default_behavior, 0),
  ##    (call_script, "script_party_copy", ":new_party", "$center_wanted_to_be_bought"),
  ##    (party_clear, "$center_wanted_to_be_bought"),
  ##
  ##    (faction_get_slot, ":reinforcement_template_archers", "$g_talk_troop_faction", slot_faction_reinforcements_archers),
  ##    (faction_get_slot, ":reinforcement_template_infantry", "$g_talk_troop_faction", slot_faction_reinforcements_infantry),
  ##    (party_add_template, "$center_wanted_to_be_bought", ":reinforcement_template_archers"),
  ##    (party_add_template, "$center_wanted_to_be_bought", ":reinforcement_template_infantry"),
  ##    ]],
  ##
  ##  [anyone,"lord_buy_center_deny", [],
  ##   "As you wish {playername}. But don't forget, the great lords of the country won't like a low born {man/woman} like you holding such an estate without their consent.\
  ## It is the nature of this world {playername}. Everyone should know their place.", "lord_pretalk", []],
  
  
  [anyone,"lord_start",[
      (eq, "$g_romantic_comment_made", 0),
      (ge, "$g_talk_troop_relation", 20),
      (troop_slot_ge, "trp_player", slot_troop_renown, 250),
      (neg|troop_slot_ge, "trp_player", slot_troop_spouse, kingdom_ladies_begin),
      
      (troop_get_type, ":is_female", "trp_player"),
      (eq, ":is_female", 0),
      
      (assign, ":third_party_introduce", 0),
      
      (try_for_range, ":lady", kingdom_ladies_begin, kingdom_ladies_end),
        (troop_slot_eq, ":lady", slot_troop_spouse, -1),
        (troop_slot_eq, ":lady", slot_troop_betrothed, -1),
        (troop_slot_eq, ":lady", slot_troop_cur_center, "$g_encountered_party"),
        (neg|troop_slot_ge, ":lady", slot_troop_met, 4),
        
        (call_script, "script_get_kingdom_lady_social_determinants", ":lady"),
        (eq, reg0, "$g_talk_troop"),
        
        (assign, "$marriage_candidate", ":lady"),
        (call_script, "script_npc_decision_checklist_male_guardian_assess_suitor", "$g_talk_troop", "trp_player"),
        (gt, reg0, 0),
        
        (assign, ":third_party_introduce", ":lady"),
      (try_end),
      (gt, ":third_party_introduce", 0),
      (troop_slot_eq, ":third_party_introduce", slot_troop_met, 0),
      
      (call_script, "script_troop_get_family_relation_to_troop", ":third_party_introduce", "$g_talk_troop"),
      (str_store_troop_name, s14, ":third_party_introduce"),
    ],
    "By the way, I hope you get a chance to meet my {s11}, {s14}.  ", "lord_start",
    [
      (troop_set_slot, "$g_talk_troop", slot_lord_granted_courtship_permission, 1),
      (assign, "$g_romantic_comment_made", 1),
  ]],
  
  
  [anyone,"lord_start",[
      (eq, "$g_romantic_comment_made", 0),
      (ge, "$g_talk_troop_relation", 20),
      (troop_slot_ge, "trp_player", slot_troop_renown, 250),
      (assign, ":third_party_introduce", 0),
      
      (neg|troop_slot_ge, "trp_player", slot_troop_spouse, kingdom_ladies_begin),
      (troop_get_type, ":is_female", "trp_player"),
      (eq, ":is_female", 0),
      
      (try_for_range, ":lady", kingdom_ladies_begin, kingdom_ladies_end),
        (troop_slot_eq, ":lady", slot_troop_spouse, -1),
        (troop_slot_eq, ":lady", slot_troop_betrothed, -1),
        (troop_slot_eq, ":lady", slot_troop_cur_center, "$g_encountered_party"),
        (neg|troop_slot_ge, ":lady", slot_troop_met, 4),
        
        (call_script, "script_get_kingdom_lady_social_determinants", ":lady"),
        (eq, reg0, "$g_talk_troop"),
        
        (assign, "$marriage_candidate", ":lady"),
        (call_script, "script_npc_decision_checklist_male_guardian_assess_suitor", "$g_talk_troop", "trp_player"),
        (gt, reg0, 0),
        
        (troop_slot_ge, ":lady", slot_troop_met, 1),
        
        (store_current_hours, ":hours"),
        (troop_get_slot, ":lady_last_met_hour", ":lady", slot_troop_last_talk_time),
        (val_sub, ":hours", ":lady_last_met_hour"),
        (ge, ":hours", 24),
        
        (assign, ":third_party_introduce", ":lady"),
      (try_end),
      
      (gt, ":third_party_introduce", 0),
      (call_script, "script_troop_get_family_relation_to_troop", ":third_party_introduce", "$g_talk_troop"),
      (str_store_troop_name, s14, ":third_party_introduce"),
      
    ],
    "By the way, I am sure that my {s11}, {s14}, would be delighted were you to pay her a visit. She awaits you in her chambers.", "lord_start",
    [
      (troop_set_slot, "$g_talk_troop", slot_lord_granted_courtship_permission, 1),
      (assign, "$g_romantic_comment_made", 1),
      
  ]],
  
  
  
  [anyone,"lord_start", [(party_slot_eq, "$g_encountered_party",slot_town_lord, "$g_talk_troop"),#we are talking to Town's Lord.
      (ge,"$g_talk_troop_faction_relation",0),
      (neq, "$g_ransom_offer_rejected", 1),
      (lt, "$g_encountered_party_2", 0), #town is not under siege
      (hero_can_join_as_prisoner, "$g_encountered_party"),
      (store_random_in_range, ":random_no", 0, 100),
      (lt, ":random_no", 10),#start this conversation with a 10% chance
      (party_get_num_prisoner_stacks,":num_prisoner_stacks","p_main_party"),
      (assign, "$prisoner_lord_to_buy", -1),
      (try_for_range,":i_pris_stack",0,":num_prisoner_stacks"),
        (party_prisoner_stack_get_troop_id, ":t_id", "p_main_party", ":i_pris_stack"),
        (troop_slot_eq, ":t_id", slot_troop_occupation, slto_kingdom_hero),
        (store_troop_faction, ":fac", ":t_id"),
        (store_relation, ":rel", ":fac", "$g_talk_troop_faction"),
        (lt,  ":rel", 0),
        (assign, "$prisoner_lord_to_buy", ":t_id"),
      (try_end),
      (gt, "$prisoner_lord_to_buy", 0), #we have a prisoner lord.
      (assign, ":continue", 1),
      (try_begin),
        (check_quest_active, "qst_capture_enemy_hero"),
        (store_troop_faction, ":prisoner_faction", "$prisoner_lord_to_buy"),
        (quest_slot_eq, "qst_capture_enemy_hero", slot_quest_target_faction, ":prisoner_faction"),
        (assign, ":continue", 0),
      (try_end),
      (eq, ":continue", 1),
      (str_store_troop_name, s3, "$prisoner_lord_to_buy"),
      (assign, reg5, "$prisoner_lord_to_buy"),
      (call_script, "script_calculate_ransom_amount_for_troop", "$prisoner_lord_to_buy"),
      (assign, reg6, reg0),
      (val_div, reg6, 2),
      (assign, "$temp", reg6),
    ],
    "I heard that you have captured our enemy {s3} and he is with you at the moment. " +
    "I can pay you {reg6} denars for him if you want to get rid of him. " +
    "You can wait for his family to pay his ransom of course, but there is no telling how long that will take, eh? " +
    "", "lord_buy_prisoner", []],
  
  [anyone|plyr,"lord_buy_prisoner", [],
    "I accept your offer. I'll leave {s3} to you for {reg6} denars.", "lord_buy_prisoner_accept", []],
  [anyone|plyr,"lord_buy_prisoner", [],
    "I fear I can't accept your offer.", "lord_buy_prisoner_deny", [(assign, "$g_ransom_offer_rejected", 1),]],
  
  [anyone,"lord_buy_prisoner_accept", [],
    "Excellent! Here's your {reg6} denars. " +
    "I'll send some men to take him to our prison with due haste.", "lord_pretalk", [
      (remove_troops_from_prisoners,  "$prisoner_lord_to_buy", 1),
      (call_script, "script_troop_add_gold", "trp_player", "$temp"),
      (party_add_prisoners, "$g_encountered_party", "$prisoner_lord_to_buy", 1),
      #(troop_set_slot, "$prisoner_lord_to_buy", slot_troop_is_prisoner, 1),
      (troop_set_slot, "$prisoner_lord_to_buy", slot_troop_prisoner_of_party, "$g_encountered_party"),
  ]],
  
  [anyone,"lord_buy_prisoner_deny", [],
    "Mmm. As you wish, {playername}, but you'll not get a better offer. Take it from me.", "lord_pretalk", []],
  
  
  
  [anyone,"lord_start", [
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_feast),
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_object, "$g_encountered_party"),
      
      (check_quest_active, "qst_organize_feast"),
      (quest_slot_eq, "qst_organize_feast", slot_quest_target_center, "$g_encountered_party"),
      
      
      (try_begin),
        #HYW
        #		(eq, "$g_talk_troop_faction", "fac_kingdom_4"),
        #		(str_store_string, s5, "str_flagon_of_mead"),
        #	(else_try),
        #		(store_mod, ":mode", "$g_talk_troop", 2),
        #		(eq, ":mode", 0),
        #		(eq, "$g_talk_troop_faction", "fac_kingdom_3"),
        #		(str_store_string, s5, "str_skin_of_kumis"),
        #	(else_try),
        #HYW
        (store_mod, ":mode", "$g_talk_troop", 2),
        (eq, ":mode", 0),
        (eq, "$g_talk_troop_faction", "fac_kingdom_2"),
        (str_store_string, s5, "str_mug_of_kvass"),
      (else_try),
        (str_store_string, s5, "str_cup_of_wine"),
      (try_end),
      
      
      
    ],
    "I lift a {s5} to your health, {playername}! You are most gracious to host us on this occasion. Now, what is it?", "lord_talk",[
      (call_script, "script_internal_politics_rate_feast_to_s9", "trp_household_possessions", 120, "$players_kingdom", 0),
      (assign, ":quality_of_feast", reg0),
      
      (try_begin),
        (ge, ":quality_of_feast", 20),
        (ge, "$g_time_since_last_talk", 24),
        (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", 1),
      (try_end),
  ]],
  
  
  
  [anyone,"lord_start", [
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "trp_player"),
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_feast),
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_object, "$g_encountered_party"),
      
    ],
    "To your health, {sire/your Highness}. Long may you reign. What is your bidding?", "lord_talk",[
      (try_begin),
        (this_or_next|party_slot_eq, "$g_encountered_party", slot_town_lord, "trp_player"),
        (party_slot_eq, "$g_encountered_party", slot_town_lord, "$g_talk_troop"),
        (ge, "$g_time_since_last_talk", 24),
        (ge, "$g_talk_troop_relation", 0),
        (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", 1),
      (try_end),
      
  ]],
  
  
  
  [anyone,"lord_start", [
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "trp_player"),
    ],
    "What is your bidding?", "lord_talk",[]],
  
  [anyone,"lord_start", [
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_feast),
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_object, "$g_encountered_party"),
      (ge, "$g_encountered_party_relation", 0),
      (party_slot_eq, "$g_encountered_party", slot_town_lord, "$g_talk_troop"),
      (neq, "$talk_context", tc_castle_gate),
    ],
    "I wish to welcome you to my hall on this auspicious occasion. Now, what is it?", "lord_talk",[
      (try_begin),
        (is_between, "$g_talk_troop_relation", 0, 10),
        (ge, "$g_time_since_last_talk", 24),
        (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", 2),
      (try_end),
  ]],
  
  
  [anyone,"lord_start", [
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_feast),
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_object, "$g_encountered_party"),
      (ge, "$g_encountered_party_relation", 0),
      (party_get_slot, ":town_lord", "$g_encountered_party", slot_town_lord),
      (str_store_troop_name, s4, ":town_lord"),
      
      (neq, "$talk_context", tc_castle_gate),
      
      #HYW
      (try_begin),
        #		(eq, "$g_talk_troop_faction", "fac_kingdom_4"),
        #		(str_store_string, s5, "str_flagon_of_mead"),
        #	(else_try),
        #		(store_mod, ":mode", "$g_talk_troop", 2),
        #		(eq, ":mode", 0),
        #		(eq, "$g_talk_troop_faction", "fac_kingdom_3"),
        #		(str_store_string, s5, "str_skin_of_kumis"),
        #	(else_try),
        (store_mod, ":mode", "$g_talk_troop", 2),
        (eq, ":mode", 0),
        (eq, "$g_talk_troop_faction", "fac_kingdom_2"),
        (str_store_string, s5, "str_mug_of_kvass"),
      (else_try),
        (str_store_string, s5, "str_cup_of_wine"),
      (try_end),
      
    ],
    "Let us lift a {s5} to the health of our host, {s4}. Now, what is it?", "lord_talk",[]],
  
  
  
  
  #  [anyone,"lord_start_2", [],
  #   "Yes?", "lord_talk",[]],
  
  
  #Player lord_talk responses begin
  
  #Political quests begin
  [anyone|plyr,"lord_talk", [
      (check_quest_active, "qst_offer_gift"),
      (quest_slot_eq, "qst_offer_gift", slot_quest_giver_troop, "$g_talk_troop"),
      
      (quest_get_slot, ":target_troop", "qst_offer_gift", slot_quest_target_troop),
      (str_store_troop_name, s4, ":target_troop"),
      (player_has_item, "itm_furs"),
      (player_has_item, "itm_velvet"),
    ],
    "I have the materials for {s4}'s gift.", "offer_gift_quest_complete",[
  ]],
  
  [anyone,"offer_gift_quest_complete", [
      (quest_get_slot, ":target_troop", "qst_offer_gift", slot_quest_target_troop),
      (troop_get_type, reg4, ":target_troop"),
    ],
    "Ah, let me take those. Hopefully this will mend the quarrel between you two. You may wish to speak to {reg4?her:him}, and see if I had any success.", "close_window",[
      (quest_set_slot, "qst_offer_gift", slot_quest_current_state, 2),
      (troop_remove_item, "trp_player", "itm_furs"),
      (troop_remove_item, "trp_player", "itm_velvet"),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  
  
  [anyone|plyr,"lord_talk", [
      (check_quest_active, "qst_intrigue_against_lord"),
      (neg|check_quest_succeeded, "qst_intrigue_against_lord"),
      (neg|check_quest_failed, "qst_intrigue_against_lord"),
      
      (quest_get_slot, ":target_troop", "qst_intrigue_against_lord", slot_quest_target_troop), #was qst_offer_gift
      (store_faction_of_troop, ":target_troop_faction", ":target_troop"),
      (faction_slot_eq, ":target_troop_faction", slot_faction_leader, "$g_talk_troop"),
    ],
    "My lord -- there is something I wish to tell you in confidence, about one of your vassals.", "intrigue_quest_state_complaint",[
  ]],
  
  [anyone,"intrigue_quest_state_complaint", [
      (assign, ":continue", 1),
      (try_begin),
        (call_script, "script_cf_troop_can_intrigue", "$g_talk_troop", 1),
        (assign, ":continue", 0),
      (try_end),
      (eq, ":continue", 1),
    ],
    "Whatever you have to say, I would ask you to wait until we are alone.", "lord_pretalk",[
  ]],
  
  [anyone,"intrigue_quest_state_complaint", [
    ],
    "What is it? I value your opinion, although I hope that you are not trying to sew dissension among my vassals? ", "intrigue_quest_state_complaint_plyr",[
      
      (quest_get_slot, ":target_troop", "qst_intrigue_against_lord", slot_quest_target_troop),
      (call_script, "script_troop_get_relation_with_troop", ":target_troop", "$g_talk_troop"),
      (assign, reg4, reg0),
      (str_store_troop_name, s4, ":target_troop"),
      (assign, reg5, "$g_talk_troop_effective_relation"),
      
      (try_begin),
        (eq, "$cheat_mode", 1),
        (str_store_string, s12, "str_intrigue_success_chance"),
        (display_message, "str_s12"),
      (try_end),
  ]],
  
  
  
  [anyone|plyr,"intrigue_quest_state_complaint_plyr", [
      (check_quest_active, "qst_intrigue_against_lord"),
      (quest_get_slot, ":target_troop", "qst_intrigue_against_lord", slot_quest_target_troop),
      (str_store_troop_name, s4, ":target_troop"),
      (troop_get_slot, ":reputation_string", ":target_troop", slot_lord_reputation_type),
      (val_add, ":reputation_string", "str_lord_derogatory_default"),
      (str_store_string, s5, ":reputation_string"),
    ],
    "My liege -- {s4} is widely held by your vassals to be {s5}, and a liability to your realm", "lord_intrigue_quest_complaint_stated",[
  ]],
  
  [anyone|plyr,"intrigue_quest_state_complaint_plyr", [
    ],
    "Actually, my liege, never mind.", "lord_pretalk",[
      (call_script, "script_fail_quest", "qst_intrigue_against_lord"),
  ]],
  
  [anyone,"lord_intrigue_quest_complaint_stated", [
      (store_random_in_range, ":random", -50, 50),
      (store_add, ":score", "$g_talk_troop_effective_relation", ":random"),
      
      (quest_get_slot, ":target_troop", "qst_intrigue_against_lord", slot_quest_target_troop),
      (call_script, "script_troop_get_relation_with_troop", ":target_troop", "$g_talk_troop"),
      (ge, ":score", reg0),
      
    ],
    "Hmm... This is troubling to hear. Although I do not encourage my vassals to speak ill of each other, I value your opinion. Perhaps I should think twice about granting {s4} any further fiefs or offices...", "lord_pretalk",[
      (quest_get_slot, ":target_troop", "qst_intrigue_against_lord", slot_quest_target_troop),
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", ":target_troop", -10),
      (call_script, "script_succeed_quest", "qst_intrigue_against_lord"),
  ]],
  
  [anyone,"lord_intrigue_quest_complaint_stated", [
    ],
    "Sew discord among my vassals, will you? With everything else going on, do you think I appreciate my nobles turning on each other like quarreling dogs? Let me ask you this -- did someone put you up this?", "intrigue_quest_state_complaint_failed",[
      (call_script, "script_fail_quest", "qst_intrigue_against_lord"),
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", -5),
  ]],
  
  [anyone|plyr,"intrigue_quest_state_complaint_failed", [
    ],
    "I stand by my words, my liege.", "intrigue_quest_state_accept_blame",[
      (call_script, "script_change_player_honor", 1),
  ]],
  
  [anyone|plyr,"intrigue_quest_state_complaint_failed", [
      (quest_get_slot, ":giver_troop", "qst_intrigue_against_lord", slot_quest_giver_troop),
      (quest_get_slot, ":target_troop", "qst_intrigue_against_lord", slot_quest_target_troop),
      
      (str_store_troop_name, s4, ":giver_troop"),
      (str_store_troop_name, s5, ":target_troop"),
    ],
    "Yes, sire -- {s4} put me up to denouncing {s5}!", "intrigue_quest_state_deflect_blame",[
      (quest_get_slot, ":giver_troop", "qst_intrigue_against_lord", slot_quest_giver_troop),
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", ":giver_troop", -5),
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", 4),
      (call_script, "script_change_player_honor", -2),
  ]],
  
  [anyone,"intrigue_quest_state_accept_blame", [
    ],
    "Indeed. You may stand by your words, but keep them to yourself. I will not have you undercutting my faithful follower {s4}.", "lord_pretalk",[
  ]],
  
  [anyone,"intrigue_quest_state_deflect_blame", [
    ],
    "I thought as much. Here's some advice for you, {lad/lassie} -- don't meddle in the quarrels of others. Now, enough of this.", "lord_pretalk",[
  ]],
  
  [anyone|plyr,"lord_talk", [
      (check_quest_active, "qst_denounce_lord"),
      (neg|check_quest_succeeded, "qst_denounce_lord"),
      (neg|check_quest_failed, "qst_denounce_lord"),
      
      (quest_slot_eq, "qst_denounce_lord", slot_quest_target_troop, "$g_talk_troop"),
      
      
      (troop_get_slot, ":reputation_string", "$g_talk_troop", slot_lord_reputation_type),
      (val_add, ":reputation_string", "str_lord_derogatory_default"),
      (str_store_string, s4, ":reputation_string"),
    ],
    "I want to tell you something -- we have had enough of your {s4} ways", "lord_denounce_1",[
  ]],
  
  [anyone,"lord_denounce_1", [
    ],
    "I'm sorry... What did you say?", "lord_denounce_2",[
  ]],
  
  [anyone|plyr,"lord_denounce_2", [
      
      (troop_get_slot, ":reputation_string", "$g_talk_troop", slot_lord_reputation_type),
      (val_add, ":reputation_string", "str_lord_derogatory_result"),
      (str_store_string, s4, ":reputation_string"),
      
    ],
    "You heard me. You will {s4}", "lord_denounce_3",[
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", -15),
      
      
      (store_div, ":impact", "$g_talk_troop_relation", 10),
      (val_add, ":impact", 1),
      (val_max, ":impact", 1),
      (val_mul, ":impact", -1),
      
      #Change his respect level, slightly.  In the future game, there should be more sophisticated metrics for this
      (try_for_range, ":other_lord", active_npcs_begin, active_npcs_end),
        (neq, "$g_talk_troop", ":other_lord"),
        (store_faction_of_troop, ":other_lord_faction",":other_lord"),
        (eq, ":other_lord_faction", "$g_talk_troop_faction"),
        (call_script, "script_troop_get_relation_with_troop", ":other_lord", "$g_talk_troop"),
        (lt, reg0, 15),
        (call_script, "script_troop_change_relation_with_troop", ":other_lord", "$g_talk_troop", ":impact"),
      (try_end),
      
      
      
  ]],
  
  [anyone|plyr,"lord_denounce_2", [
    ],
    "Never mind. You must have misheard me.", "lord_pretalk",[
  ]],
  
  
  [anyone,"lord_denounce_3", [
      (ge, "$g_talk_troop_relation", 10),
      (this_or_next|neg|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_quarrelsome),
      (neg|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_martial),
    ],
    "Why would you say such a thing? To insult me like this, in spite of our friendship -- how much crueler is a knife in my back from an erstwhile friends, than the sword of a sworn foe. I do not know what game you are playing, but I want no part of it. Go away. I do not want to look at you.", "close_window",[
      (call_script, "script_succeed_quest", "qst_denounce_lord"),
  ]],
  
  [anyone,"lord_denounce_3", [
      (troop_slot_ge, "trp_player", slot_troop_renown, 300),
      (this_or_next|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_cunning),
      (this_or_next|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_upstanding),
      (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_goodnatured),
    ],
    "Hmf. Really? Is that your opinion, or did one of my rivals put those words in your mouth? Never mind. I will not play your game. Go away, and take your intrigues with you.", "close_window",[
      (call_script, "script_succeed_quest", "qst_denounce_lord"),
  ]],
  
  [anyone,"lord_denounce_3", [
      (this_or_next|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_martial),
      (this_or_next|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_cunning),
      (this_or_next|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_upstanding),
      (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_goodnatured),
    ],
    "I will not have you shame me in public, {sir/my lady}. Retract your words, or meet me on the duelling ground.", "lord_denounce_4",[
  ]],
  
  [anyone,"lord_denounce_3", [
    ],
    "Is that so? Well, hear this -- you're a snake, and a knave, and -- if you don't meet me on the duelling ground -- a coward. What say you to that? Do you retract your words, or shall we cross swords?", "lord_denounce_4",[
  ]],
  
  [anyone|plyr,"lord_denounce_4", [
    ],
    "It would be a pleasure to fight you.", "lord_respond_to_insult_challenge_duel_confirm",[
  ]],
  
  [anyone|plyr,"lord_denounce_4", [
    ],
    "I spoke rashly. I retract my words.", "lord_denounce_retract",[
      (call_script, "script_fail_quest", "qst_denounce_lord"),
      
  ]],
  
  [anyone,"lord_denounce_retract", [
    ],
    "I thought as much. Now, be gone from here.", "lord_pretalk",[
  ]],
  
  
  
  
  
  
  [anyone|plyr,"lord_talk", [
      (eq, "$g_comment_has_rejoinder", 1),
      (assign, "$g_comment_has_rejoinder", 0),
      (str_store_string, s9, "$g_rejoinder_to_last_comment"),
    ],
    "{s9}", "lord_respond_to_insult",[
      (unlock_achievement, ACHIEVEMENT_SASSY),
  ]],
  
  
  #lord recruitment changes begin
  [anyone,"lord_pretalk", [
      (lt, "$g_encountered_party_relation", 0),
      (encountered_party_is_attacker),
    ],
    "But enough talking - yield or fight!", "party_encounter_lord_hostile_attacker_2",[]],
  #lord recruitment changes end
  
  
  
  
  [anyone,"lord_pretalk", [],
    "Anything else?", "lord_talk",[]],
  
  
  
  [anyone,"hero_pretalk", [],
    "Anything else?", "lord_talk",[]],
  
  ##### TODO: QUESTS COMMENT OUT BEGIN
  
  
  #lord recruitment changes begin
  [anyone|plyr,"lord_talk",[
      (check_quest_active, "qst_resolve_dispute"),
      (quest_get_slot, ":lord_1", "qst_resolve_dispute", slot_quest_target_troop),
      (quest_get_slot, ":lord_2", "qst_resolve_dispute", slot_quest_object_troop),
      
      (assign, ":other_lord", 0),
      (try_begin),
        (eq, ":lord_1", "$g_talk_troop"),
        (quest_slot_eq, "qst_resolve_dispute", slot_quest_target_state, 0),
        (assign, "$g_other_lord", ":lord_2"),
        (assign, ":other_lord", ":lord_2"),
        
      (else_try),
        (eq, ":lord_2", "$g_talk_troop"),
        (quest_slot_eq, "qst_resolve_dispute", slot_quest_object_state, 0),
        (assign, "$g_other_lord", ":lord_1"),
        (assign, ":other_lord", ":lord_1"),
        
      (try_end),
      (gt, ":other_lord", 0),
      (str_store_troop_name, s11, "$g_other_lord"),
    ],
    "I wish to address your quarrel with {s11}", "lord_quarrel_intervention_1",
    []],
  
  
  
  [anyone|plyr,"lord_talk",[#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (encountered_party_is_attacker),
      (neg|is_between, "$g_talk_troop", pretenders_begin, pretenders_end),
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
      
    ],
    "Stay your hand! There is something I must say to you in private.", "lord_recruit_1_relation",
    []],
  
  
  [anyone|plyr,"lord_talk",
    [(check_quest_active, "qst_track_down_bandits"),
      (neg|check_quest_succeeded, "qst_track_down_bandits"),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 1),
      
      
      ], "I am hunting a group of bandits with the following description... Have you seen them?", "lord_bandit_information",[]],
  [anyone,"lord_bandit_information", [
      (call_script, "script_get_manhunt_information_to_s15", "qst_track_down_bandits"),
      ], "{s15}", "lord_pretalk",[]],
  
  
  [anyone|plyr,"lord_talk",[#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (eq, "$g_talk_troop_faction", "$players_kingdom"),
      (faction_slot_eq, "$players_kingdom", slot_faction_political_issue, 1),
    ],
    "Who do you think should be made the marshal of our realm?", "lord_internal_politics_cur_stance",
    []],
  
  [anyone|plyr,"lord_talk",[#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (eq, "$g_talk_troop_faction", "$players_kingdom"),
      (faction_get_slot, ":political_issue", "$players_kingdom", slot_faction_political_issue),
      (is_between, ":political_issue", centers_begin, centers_end),
      (str_store_party_name, s4, ":political_issue"),
    ],
    "Whom do you think should receive the fief of {s4}?", "lord_internal_politics_cur_stance",
    []],
  
  
  [anyone|plyr,"lord_talk",[(troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop"),
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
      (is_between, "$players_kingdom", kingdoms_begin, kingdoms_end),
      (neq, "$g_talk_troop_faction", "$players_kingdom"),
      (faction_slot_eq, "fac_player_supporters_faction", slot_faction_state, sfs_active),
      #							(faction_slot_eq, "fac_player_supporters_faction", slot_faction_leader, "trp_player"),
      (faction_get_slot, ":faction_leader", "$g_talk_troop_faction", slot_faction_leader),
      (str_store_troop_name, s4, ":faction_leader"),
      (str_store_faction_name, s5, "$players_kingdom"),
    ],
    "I need you to renounce your allegiance to {s4} and join the {s5} now, my husband.", "lord_husband_auto_recruit",
    []],
  
  
  [anyone,"lord_husband_auto_recruit",
    [
      (is_between, "$g_encountered_party", centers_begin, centers_end),
      (neg|party_slot_eq, "$g_encountered_party", slot_town_lord, "$g_talk_troop"),
    ],
    "Ask me again when we are outside of these walls, my wife.", "lord_pretalk",
    []],
  
  
  [anyone,"lord_husband_auto_recruit",
    [],
    "As you wish, my wife.", "close_window",
    [
      (assign, "$g_leave_encounter", 1),
      (call_script, "script_change_troop_faction", "$g_talk_troop", "$players_kingdom"),
      
      (try_begin), #Actually, perhaps do provocation rather than war
        (store_relation, ":relation", "$players_kingdom", "$g_talk_troop_faction"),
        (ge, ":relation", 0),
        
        (try_begin),
          (eq, "$cheat_mode", 1),
          (display_message, "str_lord_recruitment_provokes_home_faction"),
        (try_end),
        
        (call_script, "script_add_log_entry", logent_border_incident_troop_suborns_lord, "trp_player", -1, "$g_talk_troop","$g_talk_troop_faction"),
        (store_add, ":slot_provocation_days", "$players_kingdom", slot_faction_provocation_days_with_factions_begin),
        (val_sub, ":slot_provocation_days", kingdoms_begin),
        (faction_set_slot, "$g_talk_troop_faction", ":slot_provocation_days", 30),
        
        (faction_get_slot, ":other_liege", "$g_talk_troop_faction", slot_faction_leader),
        (call_script, "script_troop_change_relation_with_troop", "trp_player", ":other_liege", -3),
      (try_end),
      
      (try_begin),
        (faction_slot_eq, "$players_kingdom", slot_faction_leader, "trp_player"),
        (call_script, "script_change_player_right_to_rule", 5),
      (try_end),
  ]],
  
  
  
  [anyone|plyr,"lord_talk",[#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop"),
    ],
    "There is a matter which I would like to discuss in private.", "lord_recruit_1_relation",
    []],
  
  
  
  [anyone|plyr,"lord_talk",[#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (neg|encountered_party_is_attacker),
      (neg|is_between, "$g_talk_troop", pretenders_begin, pretenders_end),
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
      (neg|troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop"),
      (neq, "$g_talk_troop_faction", "fac_player_supporters_faction"),
      #other requirements
    ],
    "There is something which I would like to discuss with to you in private.", "lord_recruit_1_relation",
    []],
  
  
  [anyone|plyr,"lord_talk",[#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (troop_slot_ge, "$g_talk_troop", slot_troop_intrigue_impatience, 1),
      (eq, "$cheat_mode", 1),
      
      #other requirements
      
    ],
    "CHEAT -- Reset lord decision seed and intrigue impatience", "lord_talk",
    [
      (troop_set_slot, "$g_talk_troop", slot_troop_intrigue_impatience, 0),
      (store_random_in_range, ":random", 0, 9999),
      (troop_set_slot, "$g_talk_troop", slot_troop_temp_decision_seed, ":random"),
  ]],
  
  [anyone|plyr,"lord_talk",[(eq, "$cheat_mode", 1),
    ],
    "CHEAT -- Let's duel (insult)", "lord_respond_to_insult_challenge_duel",
    [
  ]],
  
  
  
  #Respond to insult
  [anyone,"lord_respond_to_insult", [
      (eq, "$g_last_comment_copied_to_s42", "str_comment_intro_female_sadistic_admiring"),
      ], "Hah! I admire a quick tongue. Perhaps some day I shall remove it, with tongs, to admire it at greater leisure, but today, at least, I shall salute your wit and courage.", "lord_pretalk", [
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", 5),
      (call_script, "script_change_troop_renown", "trp_player", 2),
  ]],
  
  
  [anyone,"lord_respond_to_insult", [
      (this_or_next|eq, "$g_last_comment_copied_to_s42", "str_comment_intro_female_pitiless_admiring"),
      (this_or_next|eq, "$g_last_comment_copied_to_s42", "str_comment_intro_female_common_upstanding"),
      (this_or_next|eq, "$g_last_comment_copied_to_s42", "str_comment_intro_female_noble_upstanding"),
      (this_or_next|eq, "$g_last_comment_copied_to_s42", "str_comment_intro_female_common_martial"),
      (eq, "$g_last_comment_copied_to_s42", "str_comment_intro_female_badtempered_admiring"),
      ], "I meant no offense, madame.", "lord_pretalk", [
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", -2),
      (call_script, "script_change_troop_renown", "trp_player", 2),
  ]],
  
  
  [anyone,"lord_respond_to_insult", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_leaded_party, "$g_encountered_party"),
      (store_party_size_wo_prisoners, ":lord_party_size", "$g_talk_troop_party"),
      (store_party_size_wo_prisoners, ":player_party_size", "p_main_party"),
      (val_mul, ":player_party_size", 3),
      (val_div, ":player_party_size", 2),
      (gt, ":lord_party_size", ":player_party_size"),
      (neq, "$players_kingdom",  "$g_talk_troop_faction"),
    ], "Are you trying to provoke me? Well, I would have you know that I am under no obligation to duel women, commoners, rebels, or brigands. I could, however, order my men to seize you and horsewhip you. Would you like them to do that?", "lord_respond_to_insult_challenge_battle",
    [
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", -10),
      (call_script, "script_change_troop_renown", "trp_player", 2),
  ]],
  
  [anyone,"lord_respond_to_insult", [
    ], "Are you trying to provoke me? Well, I would have you know that I am under no obligation to duel women, commoners, rebels, or brigands. However, in your case, I would be delighted to make an exception. Are you ready for a lesson in deference to your betters, {varlot/girl}?", "lord_respond_to_insult_challenge_duel",
    [
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", -10),
      (call_script, "script_change_troop_renown", "trp_player", 2),
  ]],
  
  [anyone,"lord_respond_to_insult", [
    ], "Are you trying to provoke me? Well, I would have you know that I am under no obligation to duel women, commoners, rebels, or brigands. You are lucky that I am in a good mood, because I am perfectly within my rights to order my men to seize you and horsewhip you. Now begone -- I have had enough of you.", "close_window",
    [
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", -10),
      (call_script, "script_change_troop_renown", "trp_player", 2),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  
  [anyone|plyr,"lord_respond_to_insult_challenge_battle", [
    ], "I would like to see them try.", "lord_respond_to_insult_challenge_battle_confirm",
    [
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", -10),
      (call_script, "script_change_troop_renown", "trp_player", 3),
  ]],
  
  [anyone|plyr,"lord_respond_to_insult_challenge_battle", [
    ], "This is not worth the shedding of blood.", "close_window",
    [
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone,"lord_respond_to_insult_challenge_battle_confirm", [
    ], "Enough of your insolence! At {him/her}, lads!", "close_window",
    [
      (assign, "$g_private_battle_with_troop", "$g_talk_troop"),
      (assign, "$cant_leave_encounter", 1),
      (assign, "$encountered_party_friendly", 0),
      (jump_to_menu, "mnu_simple_encounter"),
  ]],
  
  [anyone|plyr,"lord_respond_to_insult_challenge_duel", [
    ], "I am ready to teach you one.", "lord_respond_to_insult_challenge_duel_confirm",
    [
      (str_store_troop_name_link, s13, "$g_talk_troop"),
      (setup_quest_text, "qst_duel_avenge_insult"),
      (str_store_string, s2, "str_you_intend_to_challenge_s13_to_force_him_to_retract_an_insult"),
      
      (call_script, "script_start_quest", "qst_duel_avenge_insult", "$g_talk_troop"),
      (quest_set_slot, "qst_duel_avenge_insult", slot_quest_target_troop, "$g_talk_troop"),
      
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", -10),
  ]],
  
  [anyone|plyr,"lord_respond_to_insult_challenge_duel", [
    ], "This is not worth the shedding of blood.", "close_window",
    [
      (assign, "$g_leave_encounter", 1),
  ]],
  
  
  [anyone,"lord_respond_to_insult_challenge_duel_confirm", [
    ], "So be it. Defend yourself!", "close_window",
    [
      (call_script, "script_set_up_duel_with_troop", "$g_talk_troop"),
  ]],
  
  
  
  [anyone,"lord_quarrel_intervention_1", [
      
      (str_store_string, s14, "str_general_quarrel"),
      (assign, "$temp", "$g_other_lord"),
      
      (assign, ":specific_quarrel_found", 0),
      (store_add, ":log_entries_plus_one", "$num_log_entries", 1),
      (try_for_range, ":log_entry_no", 1, ":log_entries_plus_one"),
        (troop_slot_eq, "trp_log_array_entry_type", ":log_entry_no", logent_ruler_intervenes_in_quarrel),
        (troop_slot_eq, "trp_log_array_troop_object", ":log_entry_no", "$temp"),
        (troop_slot_eq, "trp_log_array_center_object", ":log_entry_no", "$g_talk_troop"),
        (troop_slot_eq, "trp_log_array_faction_object", ":log_entry_no", "$g_talk_troop_faction"),
        
        (call_script, "script_get_relevant_comment_for_log_entry", ":log_entry_no"),
        (str_store_string, s14, reg0),
        (assign, ":specific_quarrel_found", 1),
      (else_try),
        (troop_slot_eq, "trp_log_array_entry_type", ":log_entry_no", logent_lord_protests_marshall_appointment),
        (troop_slot_eq, "trp_log_array_actor", ":log_entry_no", "$g_talk_troop"),
        (troop_slot_eq, "trp_log_array_center_object", ":log_entry_no", "$temp"),
        (call_script, "script_get_relevant_comment_for_log_entry", ":log_entry_no"),
        (str_store_string, s14, reg0),
        (assign, ":specific_quarrel_found", 1),
      (else_try),
        (troop_slot_eq, "trp_log_array_entry_type", ":log_entry_no", logent_lord_blames_defeat),
        (troop_slot_eq, "trp_log_array_actor", ":log_entry_no", "$g_talk_troop"),
        (troop_slot_eq, "trp_log_array_center_object", ":log_entry_no", "$temp"),
        (call_script, "script_get_relevant_comment_for_log_entry", ":log_entry_no"),
        (str_store_string, s14, reg0),
        (assign, ":specific_quarrel_found", 1),
      (else_try),
        (troop_slot_eq, "trp_log_array_entry_type", ":log_entry_no", logent_troop_feels_cheated_by_troop_over_land),
        (troop_slot_eq, "trp_log_array_actor", ":log_entry_no", "$g_talk_troop"),
        (troop_slot_eq, "trp_log_array_troop_object", ":log_entry_no",  "$temp"),
        (call_script, "script_get_relevant_comment_for_log_entry", ":log_entry_no"),
        (str_store_string, s14, reg0),
        (assign, ":specific_quarrel_found", 1),
      (else_try),
        (troop_slot_eq, "trp_log_array_entry_type", ":log_entry_no", logent_lords_quarrel_over_woman),
        (troop_slot_eq, "trp_log_array_actor", ":log_entry_no", "$g_talk_troop"),
        (troop_slot_eq, "trp_log_array_center_object", ":log_entry_no", "$temp"),
        (call_script, "script_get_relevant_comment_for_log_entry", ":log_entry_no"),
        (str_store_string, s14, reg0),
        (assign, ":specific_quarrel_found", 1),
      (else_try),
        (troop_slot_eq, "trp_log_array_entry_type",  ":log_entry_no", logent_lords_quarrel_over_woman),
        (troop_slot_eq, "trp_log_array_actor", ":log_entry_no", "$temp"),
        (troop_slot_eq, "trp_log_array_center_object", ":log_entry_no", "$g_talk_troop"),
        (call_script, "script_get_relevant_comment_for_log_entry", ":log_entry_no"),
        (str_store_string, s14, reg0),
        (assign, ":specific_quarrel_found", 1),
      (try_end),
      
      (try_begin),
        (eq, ":specific_quarrel_found", 0),
        (call_script, "script_troop_describes_quarrel_with_troop_to_s14", "$g_talk_troop", "$temp"),
      (try_end),
      
    ],
    "{s14}", "lord_quarrel_intervention_2",
    []],
  
  
  [anyone|plyr,"lord_quarrel_intervention_2",[],
    "Ah, well. It sounds like you're in the right, then.", "lord_quarrel_intervention_3a",
    [
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_other_lord", -20),
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", 10),
      (try_begin),
        (faction_slot_eq, "fac_player_supporters_faction", slot_faction_leader, "trp_player"),
        (call_script, "script_add_log_entry", logent_ruler_intervenes_in_quarrel, "trp_player",  "$g_other_lord", "$g_talk_troop", "fac_player_supporters_faction"),
      (try_end),
      (call_script, "script_end_quest", "qst_resolve_dispute"),
      
  ]],
  
  [anyone|plyr,"lord_quarrel_intervention_2",[
      (faction_slot_eq, "$players_kingdom", slot_faction_leader, "trp_player"),
    ],
    "Whatever your differences, I want you to settle them.", "lord_quarrel_intervention_3b",
    []],
  
  [anyone|plyr,"lord_quarrel_intervention_2",[
      (neg|faction_slot_eq, "$players_kingdom", slot_faction_leader, "trp_player"),
    ],
    "Could you not be convinced to settle your differences?", "lord_quarrel_intervention_3b",
    []],
  
  
  [anyone|plyr,"lord_quarrel_intervention_2",[],
    "On second thought, I want nothing to do with this.", "lord_pretalk",
    [
      (call_script, "script_abort_quest", "qst_resolve_dispute", 0),
      
  ]],
  
  [anyone,"lord_quarrel_intervention_3a", [
    ], "I'm glad that you think so.", "lord_pretalk",
    []],
  
  [anyone,"lord_quarrel_intervention_3b", [
      (store_random_in_range, ":random", 0, 21),
      (le, ":random", "$g_talk_troop_effective_relation"),
      (str_store_troop_name, s11, "$g_other_lord"),
      
    ], "For the sake of our friendship, I defer to your judgment. I will try to make amends with {s11}.", "lord_quarrel_intervention_4",
    [
      (try_begin),
        (quest_slot_eq, "qst_resolve_dispute", slot_quest_target_troop, "$g_talk_troop"),
        (quest_set_slot, "qst_resolve_dispute", slot_quest_target_state, 1),
      (else_try),
        (quest_slot_eq, "qst_resolve_dispute", slot_quest_object_troop, "$g_talk_troop"),
        (quest_set_slot, "qst_resolve_dispute", slot_quest_object_state, 1),
      (try_end),
  ]],
  
  [anyone,"lord_quarrel_intervention_3b", [
      #fails reconciliation test
      (str_store_troop_name, s11, "$g_other_lord"),
    ], "I will not reconcile with {s11}. I know my rights.", "lord_pretalk",
    [
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", -15),
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_other_lord", 10),
      (try_begin),
        (eq, "$players_kingdom", "fac_player_supporters_faction"),
        (call_script, "script_add_log_entry", logent_ruler_intervenes_in_quarrel, "trp_player",  "$g_talk_troop", "$g_other_lord", "fac_player_supporters_faction"),
      (try_end),
      (call_script, "script_end_quest", "qst_resolve_dispute"),
  ]],
  
  [anyone,"lord_quarrel_intervention_4", [
      (quest_slot_eq, "qst_resolve_dispute", slot_quest_object_state, 1),
      (quest_slot_eq, "qst_resolve_dispute", slot_quest_target_state, 1),
    ], "Let it be as though our quarrel never occurred.", "lord_pretalk",
    [
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "$g_other_lord", 20),
      (call_script, "script_succeed_quest", "qst_resolve_dispute"),
      (call_script, "script_end_quest", "qst_resolve_dispute"),
      (call_script, "script_change_player_honor", 3),
      (call_script, "script_change_troop_renown", "trp_player",  25),
      (add_xp_as_reward, 500),
      
  ]],
  
  [anyone,"lord_quarrel_intervention_4", [
      (str_store_troop_name, s11, "$g_other_lord"),
    ], "I suppose that you should speak to {s11}, and see if he will do the same for me.", "lord_pretalk",
    [
  ]],
  
  
  [anyone,"lord_internal_politics_cur_stance", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_stance_on_faction_issue, "trp_player"),
    ],
    "I had already made up my mind to support you.", "lord_internal_politics_cur_stance_plyr_response",
    [
  ]],
  
  
  
  [anyone,"lord_internal_politics_cur_stance", [
      (call_script, "script_npc_decision_checklist_take_stand_on_issue", "$g_talk_troop"),
      (eq, reg0, -1),
    ],
    "I am unable to decide at this time", "lord_internal_politics_cur_stance_plyr_response",
    [
  ]],
  
  
  [anyone,"lord_internal_politics_cur_stance", [
    ],
    "I support {s15}. {s10}", "lord_internal_politics_cur_stance_plyr_response",
    [
      (call_script, "script_npc_decision_checklist_take_stand_on_issue", "$g_talk_troop"),
      (assign, ":supported_candidate", reg0),
      (assign, ":explainer_string", reg1),
      (troop_set_slot, "$g_talk_troop", slot_troop_stance_on_faction_issue, ":supported_candidate"),
      
      (str_store_string, s10, ":explainer_string"),
      (try_begin),
        (eq, ":supported_candidate", "$g_talk_troop"),
        (str_clear, s10),
      (try_end),
      (call_script, "script_troop_describes_troop_to_s15", "$g_talk_troop", ":supported_candidate"),
      
  ]],
  
  [anyone|plyr,"lord_internal_politics_cur_stance_plyr_response", [
      (troop_slot_eq, "trp_player", slot_troop_stance_on_faction_issue, -1),
      (eq, "$player_has_homage", 1),
    ],
    "Let me tell you whom I support...", "lord_internal_politics_plyr_choose_candidate",
    [
      
  ]],
  
  [anyone|plyr,"lord_internal_politics_cur_stance_plyr_response", [
      (eq, "$cheat_mode", 1),
      (eq, "$player_has_homage", 1),
    ],
    "CHEAT -- Reset support", "lord_internal_politics_cur_stance_plyr_response",
    [
      (troop_set_slot, "trp_player", slot_troop_stance_on_faction_issue, -1),
  ]],
  
  
  [anyone,"lord_internal_politics_plyr_choose_candidate", [
    ],
    "Whom do you support?", "lord_internal_politics_plyr_choose_candidate_select",
    [
  ]],
  
  [anyone|plyr,"lord_internal_politics_plyr_choose_candidate_select", [
    ],
    "I would like to nominate myself for that honor", "lord_internal_politics_pretalk",
    [
      (troop_set_slot, "trp_player", slot_troop_stance_on_faction_issue, "trp_player"),
  ]],
  
  [anyone|plyr,"lord_internal_politics_plyr_choose_candidate_select", [
      (troop_get_slot, ":spouse", "trp_player", slot_troop_spouse),
      (neq, ":spouse", "$g_talk_troop"),
      
      (is_between, ":spouse", active_npcs_begin, active_npcs_end),
      (troop_slot_eq, ":spouse", slot_troop_occupation, slto_kingdom_hero),
      (store_faction_of_troop, ":spouse_faction", ":spouse"),
      (eq, ":spouse_faction", "$players_kingdom"),
      (str_store_troop_name, s4, ":spouse"),
      
    ],
    "I support my husband, {s4}", "lord_internal_politics_pretalk",
    [
      (troop_get_slot, ":spouse", "trp_player", slot_troop_spouse),
      
      (troop_set_slot, "trp_player", slot_troop_stance_on_faction_issue, ":spouse"),
  ]],
  
  [anyone|plyr,"lord_internal_politics_plyr_choose_candidate_select", [
      (str_store_troop_name, s4, "$g_talk_troop"),
    ],
    "I would support you, {s4}", "lord_internal_politics_support_acknowledge",
    [
  ]],
  
  [anyone|plyr,"lord_internal_politics_plyr_choose_candidate_select", [
      
      (troop_get_slot, ":talk_troop_choice", "$g_talk_troop", slot_troop_stance_on_faction_issue),
      (is_between, ":talk_troop_choice", active_npcs_begin, active_npcs_end),
      (str_store_troop_name, s4, ":talk_troop_choice"),
      (neq, ":talk_troop_choice", "$g_talk_troop"),
    ],
    "I would support your choice, {s4}", "lord_internal_politics_support_same_acknowledge",
    [
  ]],
  
  [anyone|plyr,"lord_internal_politics_plyr_choose_candidate_select", [
    ],
    "Never mind", "lord_pretalk",
    [
  ]],
  
  
  
  [anyone,"lord_internal_politics_support_acknowledge", [
      (troop_get_slot, ":supported_candidate", "$g_talk_troop", slot_troop_stance_on_faction_issue),
      (neq, "$g_talk_troop", ":supported_candidate"),
      
    ],
    "That is most gracious of you, but I do not seek the honor, and I decline your support.", "lord_pretalk",
    [
      (troop_set_slot, "trp_player", slot_troop_stance_on_faction_issue, -1),
  ]],
  
  
  [anyone,"lord_internal_politics_support_acknowledge", [
      (lt, "$g_talk_troop_effective_relation", -5),
    ],
    "I do not trust you, and I do not need your support.", "lord_pretalk",
    [
      (troop_set_slot, "trp_player", slot_troop_stance_on_faction_issue, -1),
  ]],
  
  [anyone,"lord_internal_politics_support_acknowledge", [
    ],
    "That is most gracious of you", "lord_pretalk",
    [
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", 3),
      (troop_set_slot, "trp_player", slot_troop_stance_on_faction_issue, "$g_talk_troop"),
  ]],
  
  
  
  [anyone,"lord_internal_politics_support_same_acknowledge", [
      (lt, "$g_talk_troop_effective_relation", -5),
    ],
    "You may tell him that yourself. I do not trust you, and I will have no part in any game which you are playing.", "lord_pretalk",
    [
      (troop_set_slot, "trp_player", slot_troop_stance_on_faction_issue, -1),
  ]],
  
  [anyone,"lord_internal_politics_support_same_acknowledge", [
      (troop_get_slot, ":talk_troop_choice", "$g_talk_troop", slot_troop_stance_on_faction_issue),
      (call_script, "script_troop_get_relation_with_troop", "trp_player", ":talk_troop_choice"),
      (lt, reg0,  -5),
      (str_store_troop_name, s4, ":talk_troop_choice"),
    ],
    "Given your relation with {s4}, I do not think that he would welcome your support.", "lord_pretalk",
    [
      (troop_set_slot, "trp_player", slot_troop_stance_on_faction_issue, -1),
  ]],
  
  [anyone,"lord_internal_politics_support_same_acknowledge", [
      (troop_get_slot, ":talk_troop_choice", "$g_talk_troop", slot_troop_stance_on_faction_issue),
      (str_store_troop_name, s4, ":talk_troop_choice"),
    ],
    "I will tell {s4}. He will no doubt be grateful for your support.", "lord_pretalk",
    [
      (troop_get_slot, ":talk_troop_choice", "$g_talk_troop", slot_troop_stance_on_faction_issue),
      (call_script, "script_troop_change_relation_with_troop", "trp_player", ":talk_troop_choice", 2),
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", 1),
      (troop_set_slot, "trp_player", slot_troop_stance_on_faction_issue, ":talk_troop_choice"),
      
  ]],
  
  
  
  
  [anyone|plyr|repeat_for_troops,"lord_internal_politics_plyr_choose_candidate_select", [
      (store_repeat_object, ":candidate"),
      (eq, 1, 0),
      (troop_slot_eq, ":candidate", slot_troop_occupation, slto_kingdom_hero),
      (store_faction_of_troop, ":candidate_faction", ":candidate"),
      (eq, ":candidate_faction", "$players_kingdom"),
      (neg|troop_slot_eq, "trp_player", slot_troop_spouse, ":candidate"),
      (str_store_troop_name, s4, ":candidate"),
    ],
    "I support {s4}", "lord_internal_politics_pretalk",
    [
      (store_repeat_object, ":candidate"),
      (troop_set_slot, "trp_player", slot_troop_stance_on_faction_issue, ":candidate"),
  ]],
  
  
  [anyone,"lord_internal_politics_pretalk", [
    ],
    "Ah. Most interesting.", "lord_internal_politics_cur_stance_plyr_response",
    [
  ]],
  
  
  
  [anyone|plyr,"lord_internal_politics_cur_stance_plyr_response", [
      (eq, "$player_has_homage" ,1),
      (neg|troop_slot_eq, "$g_talk_troop", slot_troop_stance_on_faction_issue, "$g_talk_troop"),
      (neg|troop_slot_ge, "trp_player", slot_troop_stance_on_faction_issue, active_npcs_begin),
      (neg|troop_slot_eq, "$g_talk_troop", slot_troop_stance_on_faction_issue, "trp_player"),
    ],
    "Can I convince you to support me instead?", "lord_internal_politics_plyr_request_support",
    [
  ]],
  
  [anyone|plyr,"lord_internal_politics_cur_stance_plyr_response", [
    ],
    "Anyway, enough of politics for the time being.", "lord_pretalk",
    [
  ]],
  
  
  [anyone,"lord_internal_politics_plyr_request_support", [
      (troop_slot_ge, "trp_player", slot_troop_controversy, 25),
      (this_or_next|faction_slot_eq, "$players_kingdom", slot_faction_political_issue, 1),
      (troop_slot_ge, "trp_player", slot_troop_controversy, 50),
    ],
    "You have engendered too much controversy to be a viable candidate right now. I would advise you to wait a little while before seeking any further honors for yourself.", "lord_pretalk",
    [
  ]],
  
  [anyone,"lord_internal_politics_plyr_request_support", [
      (troop_get_slot, ":current_candidate", "$g_talk_troop", slot_troop_stance_on_faction_issue),
      (gt, ":current_candidate", 0),
      (str_store_troop_name, s4, ":current_candidate"),
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", ":current_candidate"),
      (ge, reg0, "$g_talk_troop_effective_relation"),
    ],
    "I am sorry. I would not wish to strain my relationship with {s4}", "lord_pretalk",
    [
  ]],
  
  [anyone,"lord_internal_politics_plyr_request_support", [
      (faction_get_slot, ":faction_issue", "$players_kingdom", slot_faction_political_issue),
      (is_between, ":faction_issue", centers_begin, centers_end),
      (troop_get_slot, ":player_renown", "trp_player", slot_troop_renown),
      (assign, ":total_faction_renown", ":player_renown"),
      
      (try_for_range, ":active_npc", active_npcs_begin, active_npcs_end),
        (store_faction_of_troop, ":active_npc_faction", ":active_npc"),
        (eq, ":active_npc_faction", "$players_kingdom"),
        
        (troop_get_slot, ":renown", ":active_npc", slot_troop_renown),
        (val_add, ":total_faction_renown", ":renown"),
      (try_end),
      
      (assign, ":total_faction_center_value", 0),
      (assign, ":center_points_held_by_player", 0),
      (try_for_range, ":center", centers_begin, centers_end),
        (store_faction_of_party, ":center_faction", ":center"),
        (eq, ":center_faction", "$players_kingdom"),
        
        (assign, ":center_value", 1),
        (try_begin),
          (is_between, ":center", towns_begin, towns_end),
          (assign, ":center_value", 2),
        (try_end),
        
        (val_add, ":total_faction_center_value", ":center_value"),
        
        (party_slot_eq, ":center", slot_town_lord, "trp_player"),
        (val_add, ":center_points_held_by_player", ":center_value"),
      (try_end),
      (val_max, ":total_faction_center_value", 1),
      (val_max, ":center_points_held_by_player", 1),
      
      (store_div, ":average_renown_per_center_point", ":total_faction_renown", ":total_faction_center_value"),
      (store_div, ":player_renown_per_center_point", ":player_renown", ":center_points_held_by_player"),
      
      (store_mul, ":threshhold", ":average_renown_per_center_point", 3),
      (val_div, ":threshhold", 4),
      (lt, ":player_renown_per_center_point", ":threshhold"),
      
    ],
    "You have already been well-rewarded with fiefs appropriate to your accomplishments, I would say.", "lord_pretalk",
    [
  ]],
  
  [anyone,"lord_internal_politics_plyr_request_support", [
      (faction_slot_eq, "$players_kingdom", slot_faction_political_issue, 1),
      (troop_get_slot, ":player_renown", "trp_player", slot_troop_renown),
      (lt, ":player_renown", 400),
    ],
    "I think you would need to prove yourself further before you are eligible for that position.", "lord_pretalk",
    [
  ]],
  
  #You already have too many holdings
  [anyone,"lord_internal_politics_plyr_request_support", [
      (lt, "$g_talk_troop_effective_relation", 10),
    ],
    "Hmm... That is too much to ask, given the state of our relationship. ", "lord_pretalk",
    [
  ]],
  
  [anyone,"lord_internal_politics_plyr_request_support", [
    ],
    "I would support you with pleasure. ", "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", slot_troop_stance_on_faction_issue, "trp_player"),
  ]],
  
  
  
  
  
  [anyone,"lord_internal_politics_plyr_request_support", [
    ],
    "{!}[Placeholder - sorry, not yet]", "lord_pretalk",
    [
  ]],
  
  
  
  
  
  [anyone,"lord_recruit_1_relation", [
      (troop_slot_ge, "$g_talk_troop", slot_troop_intrigue_impatience, 100),
    ],
    "I am a bit weary of talking politics. Perhaps at a later date", "lord_pretalk",
    [
      (troop_get_slot, reg3, "$g_talk_troop", slot_troop_intrigue_impatience),
      (try_begin),
        (eq, "$cheat_mode", 1),
        (display_message, "str_intrigue_impatience=_reg3_must_be_less_than_100"),
      (try_end),
  ]],
  
  #lord proximity
  [anyone,"lord_recruit_1_relation", [ #can't use the nearby scripts, because it would include the player party
      (assign, ":continue", 1),
      (try_begin),
        (call_script, "script_cf_troop_can_intrigue", "$g_talk_troop", 1),
        (assign, ":continue", 0),
      (try_end),
      
      (eq, ":continue", 1),
      
      (str_store_string, s12, "str_youll_have_to_speak_to_me_at_some_other_time_then"),
      (try_begin),
        (lt,"$g_encountered_party_relation",0),
        (encountered_party_is_attacker),
        (str_store_string, s12, "str_this_is_no_time_for_words"),
      (try_end),
      (try_begin),
        (eq, "$cheat_mode", 1),
        (display_message, "str_lord_not_alone"),
      (try_end),
    ],
    "{s12}", "lord_pretalk",[]],
  
  
  
  [anyone,"lord_recruit_1_relation", [
      
      (is_between, "$supported_pretender", pretenders_begin, pretenders_end),
      (troop_slot_eq, "$supported_pretender", slot_troop_original_faction, "$g_talk_troop_faction"),
      (troop_get_type, reg3, "$supported_pretender"),
      (str_store_troop_name, s16, "$supported_pretender"),
      (eq, "$skip_lord_assumes_argument", 0),
      
    ],
    "You have raised the standard of rebellion on behalf of {s16}. Have you come to plead {reg3?her:his} case?", "lord_recruit_pretender",[
  ]],
  
  [anyone|plyr,"lord_recruit_pretender", [
    ],
    "I have", "lord_recruit_3_dilemma_1",[
      (troop_set_slot, "$g_talk_troop", slot_lord_recruitment_candidate, "$supported_pretender"),
  ]],
  
  [anyone|plyr,"lord_recruit_pretender", [
    ],
    "No, that's not it. There's another issue I wish to discuss.", "lord_recruit_1_relation",[
      (assign, "$skip_lord_assumes_argument", 1),
  ]],
  
  
  
  
  
  #relation
  [anyone,"lord_recruit_1_relation",
    [
      (try_begin),
        (troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop"),
        
        (assign, ":willingness_to_intrigue", 20),
        
        (str_store_string, s13, "str_of_course_my_wife"),
        (str_store_string, s14, "str_perhaps_not_our_marriage_has_become_a_bit_strained_dont_you_think"),
        (str_store_string, s15, "str_why_is_that_my_wife_actually_our_marriage_has_become_such_that_i_prefer_to_have_a_witness_for_all_of_our_converations"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_quarrelsome),
        
        (assign, ":willingness_to_intrigue", 6),
        
        (str_store_string, s13, "str_all_right_then_what_do_you_have_to_say_out_with_it"),
        (str_store_string, s14, "str_bah__im_in_no_mood_for_whispering_in_the_corner"),
        (str_store_string, s15, "str_bah_i_dont_like_you_that_much_im_not_going_to_go_plot_with_you_in_some_corner"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_debauched),
        (assign, ":willingness_to_intrigue", 8),
        
        (str_store_string, s13, "str_well__now_what_do_you_have_to_propose"),
        (str_store_string, s14, "str_trying_our_hand_at_intrigue_are_we_i_think_not"),
        (str_store_string, s15, "str_hah_i_trust_you_as_a_i_would_a_serpent_i_think_not"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_upstanding),
        (assign, ":willingness_to_intrigue", -10),
        
        (str_store_string, s13, "str_i_do_not_like_to_conduct_my_business_in_the_shadows_but_sometimes_it_must_be_done_what_do_you_have_to_say"),
        (str_store_string, s14, "str_i_would_prefer_to_conduct_our_affairs_out_in_the_open"),
        (str_store_string, s15, "str_do_not_take_this_amiss_but_with_you_i_would_prefer_to_conduct_our_affairs_out_in_the_open"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_cunning),
        (assign, ":willingness_to_intrigue", 4),
        
        (str_store_string, s13, "str_hmm_you_have_piqued_my_interest_what_do_you_have_to_say"),
        (str_store_string, s14, "str_em_lets_keep_our_affairs_out_in_the_open_for_the_time_being"),
        (str_store_string, s15, "str_em_lets_keep_our_affairs_out_in_the_open_for_the_time_being"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_selfrighteous),
        (assign, ":willingness_to_intrigue", 0),
        
        (str_store_string, s13, "str_thats_sensible__the_world_is_full_of_churls_who_poke_their_noses_into_their_betters_business_now_tell_me_what_it_is_that_you_have_to_say"),
        (str_store_string, s14, "str_what_do_you_take_me_for_a_plotter"),
        (str_store_string, s15, "str_hah_i_trust_you_as_a_i_would_a_serpent_i_think_not"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_goodnatured),
        (assign, ":willingness_to_intrigue", -10),
        
        (str_store_string, s13, "str_well_i_normally_like_to_keep_things_out_in_the_open_but_im_sure_someone_like_you_would_not_want_to_talk_in_private_unless_heshe_had_a_good_reason_what_is_it"),
        (str_store_string, s14, "str_surely_we_can_discuss_whatever_you_want_to_discuss_out_here_in_the_open_cant_we"),
        (str_store_string, s15, "str_surely_we_can_discuss_whatever_you_want_to_discuss_out_here_in_the_open_cant_we"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_martial),
        (assign, ":willingness_to_intrigue", -5),
        
        (str_store_string, s13, "str_im_a_simple__man_not_one_for_intrigue_but_id_guess_that_you_have_something_worthwhile_to_say_what_is_it"),
        (str_store_string, s14, "str_forgive_me_but_im_not_one_for_going_off_in_corners_to_plot"),
        (str_store_string, s15, "str_please_do_not_take_this_amiss_but_i_do_not_trust_you"),
      (else_try),
        (troop_slot_ge, "$g_talk_troop", slot_lord_reputation_type, lrep_roguish),
        (assign, ":willingness_to_intrigue", 10),
        
        (str_store_string, s13, "str_certainly_playername_what_is_it"),
        (str_store_string, s14, "str_forgive_me_but_id_prefer_to_keep_our_conversations_in_the_open"),
        (str_store_string, s15, "str_please_do_not_take_this_amiss_but_im_not_sure_you_and_i_are_still_on_those_terms"),
      (try_end),
      
      (assign, ":continue", 0),
      (store_skill_level, ":persuasion", "skl_persuasion", "trp_player"),
      
      (try_begin),
        (lt, "$g_talk_troop_relation", -5),
        (try_begin),
          (eq, "$cheat_mode", 1),
          (display_message, "str_persuasion__relation_less_than_5"),
        (try_end),
        (str_store_string, s12, "str_s15"),
      (else_try),
        (store_add, ":score", ":persuasion", "$g_talk_troop_relation"),
        (val_add, ":score", ":willingness_to_intrigue"),
        
        (game_get_reduce_campaign_ai, ":reduce_campaign_ai"),
        (try_begin),
          (eq, ":reduce_campaign_ai", 0), #hard
          (val_sub, ":score", 5),
        (else_try),
          (eq, ":reduce_campaign_ai", 1), #medium
        (else_try),
          (eq, ":reduce_campaign_ai", 2), #easy
          (val_add, ":score", 5),
        (try_end),
        
        (lt, ":score", 10),
        
        (str_store_string, s12, "str_s14"),
        (try_begin),
          (eq, "$cheat_mode", 1),
          (display_message, "str_persuasion__2__lord_reputation_modifier__relation_less_than_10"),
        (try_end),
        
        (str_store_string, s12, "str_s14"),
      (else_try),
        (str_store_string, s12, "str_s13"),
        (assign, ":continue", 1),
      (try_end),
      
      (eq, ":continue", 0),
    ],
    "{s12}", "lord_pretalk",[]],
  
  [anyone,"lord_recruit_1_relation", [],
    "{s12}", "lord_recruit_2",[]],
  
  #check for discontent
  
  [anyone|plyr,"lord_recruit_2", [
    ],
    "What do you think, in general terms, about kings, lords, and politics?", "lord_recruit_2_philosophy",[
  ]],
  
  
  
  
  [anyone|plyr,"lord_recruit_2", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_spouse, "trp_player"),
      (neq, "$players_kingdom", "fac_player_supporters_faction"),
      (troop_get_type, ":type", "$g_talk_troop"),
      (eq, ":type", 0),
      (faction_get_slot, ":faction_leader", "$g_encountered_party_faction", slot_faction_leader),
      (str_store_troop_name, s11, ":faction_leader"),
    ],
    "My husband, I believe that you should rethink you allegiance to {s11}", "lord_spouse_leave_faction",[
  ]],
  
  [anyone,"lord_spouse_leave_faction", [
      (faction_get_slot, ":faction_liege", "$g_talk_troop_faction", slot_faction_leader),
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", ":faction_liege"),
      (gt, reg0, 25),
      (str_store_troop_name, s9, ":faction_liege"),
    ],
    "{s9} has always been a good liege to me, but I will hear you out. What do you suggest we do?", "lord_spouse_leave_faction_2",[]],
  
  [anyone,"lord_spouse_leave_faction", [
      (faction_get_slot, ":faction_liege", "$g_talk_troop_faction", slot_faction_leader),
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", ":faction_liege"),
      (gt, reg0, -5),
      (str_store_troop_name, s9, ":faction_liege"),
    ],
    "I see no particular reason to abandon {s9}, but I will heed your advice. What do you suggest we do?", "lord_spouse_leave_faction_2",[]],
  
  [anyone,"lord_spouse_leave_faction", [
      (faction_get_slot, ":faction_liege", "$g_talk_troop_faction", slot_faction_leader),
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", ":faction_liege"),
      (str_store_troop_name, s9, ":faction_liege"),
    ],
    "Yes -- as a liege, {s9} is a great disappointment. What do you suggest we do?", "lord_spouse_leave_faction_2",[]],
  
  
  #  [anyone|plyr,"lord_spouse_leave_faction_2", [
  #  ],
  #   "Perhaps we should find another liege", "lord_spouse_leave_faction_other_liege",[]],
  
  [anyone|plyr,"lord_spouse_leave_faction_2", [
    ],
    "I believe you should be king, my husband!", "lord_spouse_leave_faction_husband_king",[]],
  
  [anyone|plyr,"lord_spouse_leave_faction_2", [
    ],
    "I am the rightful queen of France", "lord_spouse_leave_faction_proclaim_queen",[]],
  
  [anyone|plyr,"lord_spouse_leave_faction_2", [
    ],
    "Never mind", "lord_pretalk",[]],
  
  [anyone,"lord_spouse_leave_faction_husband_king", [
      (assign, ":lord_has_fortress", 0),
      (try_for_range, ":walled_center", walled_centers_begin, walled_centers_end),
        (this_or_next|party_slot_eq, ":walled_center", slot_town_lord, "trp_player"),
        (party_slot_eq, ":walled_center", slot_town_lord, "$g_talk_troop"),
        (assign, ":lord_has_fortress", 1),
      (try_end),
      (eq, ":lord_has_fortress", 0),
    ],
    "Perhaps some day, my wife -- but before I declare myself king, I should like for one of us to hold a fortress which could serve as our court before we declare ourselves publically.",
    "lord_pretalk",[]],
  
  [anyone,"lord_spouse_leave_faction_proclaim_queen", [
      (assign, ":lord_has_fortress", 0),
      (try_for_range, ":walled_center", walled_centers_begin, walled_centers_end),
        (this_or_next|party_slot_eq, ":walled_center", slot_town_lord, "trp_player"),
        (party_slot_eq, ":walled_center", slot_town_lord, "$g_talk_troop"),
        (assign, ":lord_has_fortress", 1),
      (try_end),
      (eq, ":lord_has_fortress", 0),
    ],
    "While I do not contest your claim, my wife, I should like for one of us to hold a fortress which could serve as our court before we declare ourselves publically.", "lord_pretalk",[]],
  
  
  #Proclaim yourself queen
  [anyone,"lord_spouse_leave_faction_proclaim_queen", [
      (assign, ":player_has_enough_right", 0),
      (try_begin),
        (le, "$player_right_to_rule", 5),
        (str_store_string, s11, "str_really_well_this_is_the_first_i_have_heard_of_it_unless_you_build_up_support_for_that_claim_you_may_find_it_difficult_to_find_allies_however_whenever_you_see_fit_to_declare_yourself_publically_as_queen_i_should_be_honored_to_be_your_consort"),
        (assign, "$player_right_to_rule", 5),
      (else_try),
        (lt, "$player_right_to_rule", 20),
        (str_store_string, s11, "str_yes_i_have_heard_such_talk_while_it_is_good_that_you_are_building_up_your_support_i_do_not_think_that_you_are_quite_ready_to_proclaim_yourself_yet_however_i_will_let_you_be_the_judge_of_that_and_when_you_decide_i_should_be_honored_to_be_your_consort"),
      (else_try),
        (str_store_string, s11, "str_yes_and_many_others_in_calradia_think_so_as_well_perhaps_it_is_time_that_you_declared_yourself_and_we_shall_ride_forth_together_to_claim_your_throne_i_should_be_honored_to_be_your_consort"),
        (assign, ":player_has_enough_right", 1),
      (try_end),
      (eq, ":player_has_enough_right", 1),
    ],
    "{s11}", "lord_spouse_leave_faction_proclaim_queen_confirm",[]],
  
  [anyone,"lord_spouse_leave_faction_proclaim_queen", [
    ],
    "{s11}", "lord_pretalk",[]],
  
  [anyone|plyr,"lord_spouse_leave_faction_proclaim_queen_confirm", [
    ],
    "I am ready now, my husband. Let us go forth to seek our throne.", "close_window",[
      (call_script, "script_activate_player_faction", "trp_player"),
      (call_script, "script_change_troop_faction", "$g_talk_troop", "fac_player_supporters_faction"),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone|plyr,"lord_spouse_leave_faction_proclaim_queen_confirm", [
    ],
    "Perhaps I am not yet ready.", "lord_pretalk",[]],
  
  
  
  
  #Declare husband as pretender
  [anyone,"lord_spouse_leave_faction_husband_king", [
      (eq, "$players_kingdom", "fac_player_supporters_faction"),
      (gt, "$supported_pretender", 0),
      (str_store_troop_name, s4, "$supported_pretender"),
    ],
    "Perhaps, but I would need your full support to press that claim. You would want to resolve {s4}'s rebellion before pushing this any further.", "lord_pretalk",[]],
  
  [anyone,"lord_spouse_leave_faction_husband_king", [
      (faction_get_slot, ":talk_troop_liege", "$g_talk_troop_faction", slot_faction_leader),
      (str_store_troop_name, s4, ":talk_troop_liege"),
    ],
    "Most of the great families of this land have a claim to the throne... Given the recent issues with the succession, I should be as legitimate a king as {s4}. ", "lord_spouse_leave_faction_husband_king_2",[]],
  
  [anyone,"lord_spouse_leave_faction_husband_king_2", [
    ],
    "While king, I will defer to your judgment in the appointment of ministers, the conduct of diplomacy, and other such matters.", "lord_spouse_leave_faction_husband_king_3",[]],
  
  [anyone|plyr,"lord_spouse_leave_faction_husband_king_3", [
    ],
    "Very well, my husband. Let us ride forth to press your claim! ", "close_window",[
      (call_script, "script_change_troop_faction", "$g_talk_troop", "fac_player_supporters_faction"),
      (call_script, "script_activate_player_faction", "$g_talk_troop"),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone|plyr,"lord_spouse_leave_faction_husband_king_3", [
    ],
    "Actually, let us bide out time for a bit.", "lord_pretalk",[
  ]],
  
  
  [anyone,"lord_recruit_2_philosophy", [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_political_philosophy_default"),
    ],
    "{s43} Did you wish to speak of anything else?", "lord_recruit_2",[]],
  
  [anyone|plyr,"lord_recruit_2", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_recruitment_random, 0),
      (faction_get_slot, ":leader", "$g_talk_troop_faction", slot_faction_leader),
      (neq, "$g_talk_troop", ":leader"),
      (neq, "trp_player", ":leader"),
      (str_store_troop_name, s15, ":leader"),
    ],
    "How do you feel about {s15}?", "lord_recruit_2_discontent",[
  ]],
  
  [anyone|plyr,"lord_recruit_2", [
      #(troop_slot_ge, "$g_talk_troop", slot_troop_recruitment_candidate, 1),
      (troop_slot_ge, "$g_talk_troop", slot_lord_recruitment_argument, 1),
      (neq, "$g_talk_troop_faction", "$players_kingdom"),
    ],
    "Do you remember what I had told you earlier?", "lord_recruit_3_a",[
  ]],
  
  [anyone|plyr|repeat_for_troops,"lord_recruit_2", [
      (store_repeat_object, ":troop_no"),
      (is_between, ":troop_no", active_npcs_begin, active_npcs_end),
      (store_faction_of_troop, ":faction", ":troop_no"),
      (eq, ":faction", "$g_talk_troop_faction"),
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, ":troop_no"), #yields wrong string
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", ":troop_no"),
      (lt, reg0, -9),
      (str_store_troop_name, s16, ":troop_no"),
    ],
    "I have heard that you have quarreled with {s16}", "lord_recruit_quarrel_describe",[
      (store_repeat_object, "$temp"),
  ]],
  
  [anyone,"lord_recruit_quarrel_describe",
    [
      (assign, ":specific_quarrel_found", 0),
      (store_add, ":log_entries_plus_one", "$num_log_entries", 1),
      (try_for_range, ":log_entry_no", 1, ":log_entries_plus_one"),
        (troop_slot_eq, "trp_log_array_entry_type", ":log_entry_no", logent_ruler_intervenes_in_quarrel),
        (troop_slot_eq, "trp_log_array_troop_object", ":log_entry_no", "$temp"),
        (troop_slot_eq, "trp_log_array_center_object", ":log_entry_no", "$g_talk_troop"),
        (troop_slot_eq, "trp_log_array_faction_object", ":log_entry_no", "$g_talk_troop_faction"),
        
        (call_script, "script_get_relevant_comment_for_log_entry", ":log_entry_no"),
        (str_store_string, s14, reg0),
        (assign, ":specific_quarrel_found", 1),
      (else_try),
        (troop_slot_eq, "trp_log_array_entry_type", ":log_entry_no", logent_lord_protests_marshall_appointment),
        (troop_slot_eq, "trp_log_array_actor", ":log_entry_no", "$g_talk_troop"),
        (troop_slot_eq, "trp_log_array_center_object", ":log_entry_no", "$temp"),
        (call_script, "script_get_relevant_comment_for_log_entry", ":log_entry_no"),
        (str_store_string, s14, reg0),
        (assign, ":specific_quarrel_found", 1),
      (else_try),
        (troop_slot_eq, "trp_log_array_entry_type", ":log_entry_no", logent_lord_blames_defeat),
        (troop_slot_eq, "trp_log_array_actor", ":log_entry_no", "$g_talk_troop"),
        (troop_slot_eq, "trp_log_array_center_object", ":log_entry_no", "$temp"),
        (call_script, "script_get_relevant_comment_for_log_entry", ":log_entry_no"),
        (str_store_string, s14, reg0),
        (assign, ":specific_quarrel_found", 1),
      (else_try),
        (troop_slot_eq, "trp_log_array_entry_type", ":log_entry_no", logent_troop_feels_cheated_by_troop_over_land),
        (troop_slot_eq, "trp_log_array_actor", ":log_entry_no", "$g_talk_troop"),
        (troop_slot_eq, "trp_log_array_troop_object", ":log_entry_no",  "$temp"),
        (call_script, "script_get_relevant_comment_for_log_entry", ":log_entry_no"),
        (str_store_string, s14, reg0),
        (assign, ":specific_quarrel_found", 1),
      (else_try),
        (troop_slot_eq, "trp_log_array_entry_type", ":log_entry_no", logent_lords_quarrel_over_woman),
        (troop_slot_eq, "trp_log_array_actor", ":log_entry_no", "$g_talk_troop"),
        (troop_slot_eq, "trp_log_array_center_object", ":log_entry_no", "$temp"),
        (call_script, "script_get_relevant_comment_for_log_entry", ":log_entry_no"),
        (str_store_string, s14, reg0),
        (assign, ":specific_quarrel_found", 1),
      (else_try),
        (troop_slot_eq, "trp_log_array_entry_type",  ":log_entry_no", logent_lords_quarrel_over_woman),
        (troop_slot_eq, "trp_log_array_actor", ":log_entry_no", "$temp"),
        (troop_slot_eq, "trp_log_array_center_object", ":log_entry_no", "$g_talk_troop"),
        (call_script, "script_get_relevant_comment_for_log_entry", ":log_entry_no"),
        (str_store_string, s14, reg0),
        (assign, ":specific_quarrel_found", 1),
      (try_end),
      
      (try_begin),
        (eq, ":specific_quarrel_found", 0),
        (call_script, "script_troop_describes_quarrel_with_troop_to_s14", "$g_talk_troop", "$temp"),
      (try_end),
      
      (call_script, "script_add_rumor_string_to_troop_notes", "$g_talk_troop", "$temp", 14),
    ],
    "It is no secret. {s14}", "lord_recruit_2",[
  ]],
  
  [anyone|plyr,"lord_recruit_2", [
    ],
    "Never mind", "lord_pretalk",[]],
  
  [anyone,"lord_recruit_2_discontent", [
      (faction_get_slot, ":leader", "$g_talk_troop_faction", slot_faction_leader),
      
      (call_script, "script_calculate_troop_political_factors_for_liege", "$g_talk_troop", ":leader"),
      (assign, ":result_for_political", reg3),
      
      (try_begin),
        (eq, "$cheat_mode", 1),
        (display_message, "@{!}DEBUG : result_for_political is {reg3}"),
      (try_end),
      
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", ":leader"),
      (assign, ":liege_relation", reg0),
      
      (str_store_troop_name, s15, ":leader"),
      (troop_get_type, reg15, ":leader"),
      
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_upstanding),
        (assign, ":intrigue_willingness", -5),
        (str_store_string, s12, "str_i_am_disturbed_about_my_lord_s15s_choice_of_companions"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_martial),
        (assign, ":intrigue_willingness", -1),
        (str_store_string, s12, "str_well_ill_be_honest_i_feel_that_sometimes_s15_overlooks_my_rights_and_extends_his_protection_to_the_unworthy"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_quarrelsome),
        (assign, ":intrigue_willingness", 5),
        (str_store_string, s12, "str_heh_one_thing_that_ill_say_about_s15_is_that_he_has_a_ripe_batch_of_bastards_in_his_court"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_goodnatured),
        (assign, ":intrigue_willingness", -4),
        (str_store_string, s12, "str_well_sometimes_i_have_to_say_that_i_question_s15s_judgment_regarding_those_who_he_keeps_in_his_court"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_selfrighteous),
        (assign, ":intrigue_willingness", 1),
        (str_store_string, s12, "str_s15_is_a_weak_man_who_too_easily_lends_his_ear_to_evil_council_and_gives_his_protection_to_some_who_have_done_me_wrong"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_cunning),
        (assign, ":intrigue_willingness", 3),
        (str_store_string, s12, "str_i_will_confess_that_sometimes_i_worry_about_s15s_judgment_particularly_in_the_matter_of_the_counsel_that_he_keeps"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_debauched),
        (assign, ":intrigue_willingness", 5),
        (str_store_string, s12, "str_what_do_i_think_i_think_that_s15_is_a_vile_pretender_a_friend_to_the_flatterer_and_the_hypocrite"),
      (else_try),
        (troop_slot_ge, "$g_talk_troop", slot_lord_reputation_type, lrep_roguish),
        (assign, ":intrigue_willingness", 5),
        (str_store_string, s12, "str_well_s15_is_not_like_you_ill_say_that_much"),
      (try_end),
      
      #is there a specific quarrel?
      (store_add, ":log_entries_plus_one", "$num_log_entries", 1),
      (try_for_range, ":log_entry_no", 1, ":log_entries_plus_one"),
        (troop_slot_eq, "trp_log_array_entry_type", ":log_entry_no", logent_ruler_intervenes_in_quarrel),
        (troop_slot_eq, "trp_log_array_actor", ":log_entry_no", ":leader"),
        (troop_slot_eq, "trp_log_array_center_object", ":log_entry_no", "$g_talk_troop"),
        (call_script, "script_get_relevant_comment_for_log_entry", ":log_entry_no"),
        (str_store_string, s12, reg0),
      (else_try),
        (troop_slot_eq, "trp_log_array_entry_type", ":log_entry_no", logent_lord_protests_marshall_appointment),
        (troop_slot_eq, "trp_log_array_actor", ":log_entry_no", "$g_talk_troop"),
        (troop_slot_eq, "trp_log_array_troop_object", ":log_entry_no",  ":leader"),
        (call_script, "script_get_relevant_comment_for_log_entry", ":log_entry_no"),
        (str_store_string, s12, reg0),
      (else_try),
        (troop_slot_eq, "trp_log_array_entry_type", ":log_entry_no", logent_lord_blames_defeat),
        (troop_slot_eq, "trp_log_array_actor", ":log_entry_no", "$g_talk_troop"),
        (troop_slot_eq, "trp_log_array_troop_object", ":log_entry_no", ":leader"),
        (call_script, "script_get_relevant_comment_for_log_entry", ":log_entry_no"),
        (str_store_string, s12, reg0),
      (else_try),
        (troop_slot_eq, "trp_log_array_entry_type", ":log_entry_no", logent_troop_feels_cheated_by_troop_over_land),
        (troop_slot_eq, "trp_log_array_actor", ":log_entry_no", "$g_talk_troop"),
        (troop_slot_eq, "trp_log_array_faction_object", ":log_entry_no", "$g_talk_troop_faction"),
        (call_script, "script_get_relevant_comment_for_log_entry", ":log_entry_no"),
        (str_store_string, s12, reg0),
      (try_end),
      
      (val_mul, ":intrigue_willingness", 2), #-10 to 10
      
      (assign, "$lord_might_open_up", 0),
      (try_begin),
        (gt, ":result_for_political", 12),
        (gt, ":liege_relation", 0),
        (str_store_string, s12, "str_s15_long_may_he_live"),
      (else_try),
        (ge, ":result_for_political", ":intrigue_willingness"),
        (str_store_string, s12, "str_he_is_my_liege_that_is_all_that_i_will_say_on_this_matter"),
        (assign, "$lord_might_open_up", 1),
      (try_end),
      
      (lt, ":result_for_political", ":intrigue_willingness"),
      
      (call_script, "script_add_rumor_string_to_troop_notes", "$g_talk_troop", ":leader", 12),
    ],
    "{s12}", "lord_recruit_2_discontent_b",[
  ]],
  
  [anyone, "lord_recruit_2_discontent", [
    ],
    "{s12}", "lord_recruit_hesitant", []],
  
  [anyone, "lord_recruit_2_discontent_b", [  ],
    "Sometimes, I do worry about the state of the realm.", "lord_recruit_3", []],
  
  [anyone|plyr,"lord_recruit_hesitant",
    [
      (eq, "$lord_might_open_up", 1),
    ],
    "Can't I persuade you to say a little more?", "lord_recruit_hesitant_persuade",[
  ]],
  
  [anyone|plyr,"lord_recruit_hesitant", [],
    "Ah. Very good.", "lord_pretalk", []],
  
  [anyone, "lord_recruit_hesitant_persuade",
    [
      (faction_get_slot, ":leader", "$g_talk_troop_faction", slot_faction_leader),
      (call_script, "script_calculate_troop_political_factors_for_liege", "$g_talk_troop", ":leader"),
      (assign, ":result_for_political", reg3),
      (store_sub, ":open_up_desire", 12, ":result_for_political"),
      (assign, reg3, ":open_up_desire"),
      (val_div, ":open_up_desire", 3),
      
      #(store_random_in_range, ":random", -2, ":max_random_value"),
      (store_sub, ":max_random_value", 14, ":open_up_desire"),
      (troop_get_slot, ":temp_ai_seed", "$g_talk_troop", slot_troop_temp_decision_seed),
      (store_mod, ":random", ":temp_ai_seed", ":max_random_value"),
      (val_sub, ":random", 2), #random changes between -2 to (14 - (":result_for_political" div 3))
      
      #(val_sub, ":random", 20), #open this line when you want to 100% pass this step and remove again after making tests.
      (store_skill_level, ":persuasion_skill", "skl_persuasion", "trp_player"),
      (lt, ":random", ":persuasion_skill"),
    ],
    "If you put it that way, I admit that I do sometimes worry about the state of the realm.", "lord_recruit_3", []],
  
  [anyone, "lord_recruit_hesitant_persuade", [
      (troop_set_slot, "$g_talk_troop", slot_troop_intrigue_impatience, 100),
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", -1),
    ],
    "You try my patience. I said that I have nothing to say.", "lord_pretalk", []],
  
  [anyone|plyr,"lord_recruit_3", [
    ],
    "Well, I have something to tell you.", "lord_recruit_3_a",[
  ]],
  
  [anyone|plyr,"lord_recruit_3", [
    ],
    "Well, that's interesting to know. But enough about politics.", "lord_pretalk",[
  ]],
  
  
  [anyone, "lord_recruit_3_a", [
      (troop_slot_ge, "$g_talk_troop", slot_lord_recruitment_argument, 1),
      
      (troop_get_slot, ":candidate", "$g_talk_troop", slot_lord_recruitment_candidate),
      (str_store_troop_name, s14, ":candidate"),
      
      (try_begin),
        (eq, ":candidate", "trp_player"),
        (str_store_string, s14, "@you"),
      (try_end),
      
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", slot_lord_recruitment_argument, argument_claim),
        (eq, ":candidate", "trp_player"),
        (str_store_string, s12, "str_that_you_are_the_rightful_heir_to_the_throne_of_calradia"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_recruitment_argument, argument_claim),
        (str_store_troop_name, s14, ":candidate"),
        (str_store_string, s12, "str_that_s14_is_the_rightful_ruler_of_calradia"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_recruitment_argument, argument_ruler),
        (str_store_string, s12, "str_that_s14_will_rule_this_land_justly"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_recruitment_argument, argument_lords),
        (str_store_string, s12, "str_that_s14_will_protect_our_rights_as_nobles"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_recruitment_argument, argument_victory),
        (str_store_string, s12, "str_that_s14_will_unify_this_land_and_end_this_war"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_recruitment_argument, argument_benefit),
        (str_store_string, s12, "str_that_s14_will_reward_me_with_a_fief"),
      (try_end),
    ],
    "{s12}", "lord_recruit_3_reset_claim", []],
  
  
  [anyone|plyr, "lord_recruit_3_reset_claim", [  ],
    "Yes, that's it.", "lord_recruit_3_claim", [
      
  ]],
  
  [anyone|plyr, "lord_recruit_3_reset_claim", [  ],
    "Let me phrase that a little differently.", "lord_recruit_3_a_reset", []],
  
  
  [anyone, "lord_recruit_3_a",
    [
      #(display_message, "str_prior_arguments"),
      #(assign, reg3, "$claim_arguments_made"),
      #(display_message, "str_legal_reg3"),
      
      #(assign, reg3, "$ruler_arguments_made"),
      #(display_message, "str_just_king_reg3"),
      
      #(assign, reg3, "$victory_arguments_made"),
      #(display_message, "str_bring_peace_reg3"),
      
      #(assign, reg3, "$lords_arguments_made"),
      #(display_message, "str_only_best_counsel_reg3"),
      
      #(assign, reg3, "$benefit_arguments_made"),
      #(display_message, "str_reward_lords_reg3"),
    ],
    "Yes?", "lord_recruit_3_b", []],
  
  [anyone, "lord_recruit_3_a_reset", [],
    "Yes?", "lord_recruit_3_b", []],
  
  
  [anyone|plyr, "lord_recruit_3_b", [
      (faction_get_slot, ":players_liege", "$players_kingdom", slot_faction_leader),
      (eq, ":players_liege", "trp_player"),
    ],
    "I ask for your support for the throne of France", "lord_recruit_3_why",
    [
      (troop_set_slot, "$g_talk_troop", slot_lord_recruitment_candidate, "trp_player"),
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", slot_troop_recruitment_random, 0),
        
        #(store_random_in_range, ":random", 1, 101), #replaced with below 3 lines to provide a constant history (not changable by save-loads).
        (troop_get_slot, ":temp_ai_seed", "$g_talk_troop", slot_troop_temp_decision_seed),
        (store_div, ":random", ":temp_ai_seed", 100),  #I used div instead of mod to have a different random value, value generated from (mod 100) will be used in next steps. These two values should be non-related.
        (val_add, ":random", 1),
        
        (troop_set_slot, "$g_talk_troop", slot_troop_recruitment_random, ":random"),
      (try_end),
  ]],
  
  
  [anyone|plyr, "lord_recruit_3_b", [
      (faction_get_slot, ":players_liege", "$players_kingdom", slot_faction_leader),
      (neq, ":players_liege", "trp_player"),
      (neq, "$players_kingdom", "$g_talk_troop_faction"),
      (str_store_troop_name, s45, ":players_liege"),
      
    ],
    "I ask you to pledge allegiance to my liege, {s45}, as monarch of all France", "lord_recruit_3_why",
    [
      (faction_get_slot, ":players_liege", "$players_kingdom", slot_faction_leader),
      (troop_set_slot, "$g_talk_troop", slot_lord_recruitment_candidate, ":players_liege"),
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", slot_troop_recruitment_random, 0),
        
        #(store_random_in_range, ":random", 1, 101), #replaced with below 3 lines to provide a constant history (not changable by save-loads).
        (troop_get_slot, ":temp_ai_seed", "$g_talk_troop", slot_troop_temp_decision_seed),
        (store_div, ":random", ":temp_ai_seed", 100),  #I used div instead of mod to have a different random value, value generated from (mod 100) will be used in next steps. These two values should be non-related.
        (val_add, ":random", 1),
        
        (troop_set_slot, "$g_talk_troop", slot_troop_recruitment_random, ":random"),
      (try_end),
  ]],
  
  [anyone|plyr, "lord_recruit_3_b", [
    ],
    "Never mind", "lord_pretalk",
    [
  ]],
  
  [anyone, "lord_recruit_3_dilemma_1", [ #explain the political dilemma
      (troop_get_slot, ":players_liege", "$g_talk_troop", slot_lord_recruitment_candidate),
      (str_store_troop_name, s45, ":players_liege"),
      (troop_get_type, reg3, ":players_liege"),
      
      (faction_get_slot, ":current_liege", "$g_talk_troop_faction", slot_faction_leader),
      (str_store_troop_name, s46, ":current_liege"),
      
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_rebellion_dilemma_default"),
    ], "{s43}", "lord_recruit_3_dilemma_2",
    []],
  
  [anyone, "lord_recruit_3_dilemma_2", [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_rebellion_dilemma_2_default"),
    ], "{s43}", "lord_recruit_3_why",
    []],
  
  
  
  [anyone, "lord_recruit_3_why",
    [
      (troop_slot_eq, "$g_talk_troop", slot_lord_recruitment_candidate, "trp_player"),
      
      (assign, ":one_fortress_found", 0),
      (try_for_range, ":walled_center", walled_centers_begin, walled_centers_end),
        (this_or_next|party_slot_eq, ":walled_center", slot_town_lord, "$g_talk_troop"),
        (party_slot_eq, ":walled_center", slot_town_lord, "trp_player"),
        (assign, ":one_fortress_found", 1),
      (try_end),
      (eq, ":one_fortress_found", 0),
      
    ],
    "Neither of us has so much as a single fortress to our name. Would you rule your kingdom from an outlaw's den in the woods?", "lord_pretalk",
    [
  ]],
  
  
  
  
  [anyone, "lord_recruit_3_why",
    [
      (troop_get_slot, ":recruitment_candidate", "$g_talk_troop", slot_lord_recruitment_candidate),
      (try_begin),
        (eq, ":recruitment_candidate", "trp_player"),
        (str_store_string, s44, "@you"),
      (else_try),
        (str_store_troop_name, s44, ":recruitment_candidate"),
      (try_end),
    ],
    "Why should I support {s44}?", "lord_recruit_3_d",
    [
      (troop_get_slot, ":recruitment_candidate", "$g_talk_troop", slot_lord_recruitment_candidate),
      (try_begin),
        (troop_get_type, ":is_female", ":recruitment_candidate"),
        (str_store_string, s45, "str_he"),
        (str_store_string, s47, "str_king"),
        
        (try_begin),
          (eq, ":is_female", 1),
          (str_store_string, s45, "str_she"),
          (str_store_string, s47, "str_queen"),
        (try_end),
        #HYW
        #       (try_begin),
        #         (eq, ":recruitment_candidate", "$supported_pretender"),
        #         (eq, "$supported_pretender_old_faction", "fac_kingdom_3"),
        #         (str_store_string, s47, "str_khan"),
        #       (try_end),
        #HYW
        (try_begin),
          (eq, ":recruitment_candidate", "trp_player"),
          (str_store_string, s45, "str_i"),
        (try_end),
      (try_end),
  ]],
  
  [anyone|plyr,"lord_recruit_3_d",
    [
      (troop_get_slot, ":recruitment_candidate", "$g_talk_troop", slot_lord_recruitment_candidate),
      
      (str_store_string, s43, "str_according_to_the_ancient_law_and_custom_of_the_calradians_s45_should_be_s47"),
      (try_begin),
        (gt, "$supported_pretender", 0),
        (eq, ":recruitment_candidate", "$supported_pretender"),
        (str_store_faction_name, s46, "$supported_pretender_old_faction"),
        (str_store_string, s43, "str_because_s44_is_the_rightful_s47_of_the_s46"),
      (try_end),
    ],
    "{s43}", "lord_recruit_3_claim",
    [
      (troop_set_slot, "$g_talk_troop", slot_lord_recruitment_argument, argument_claim),
      (val_add, "$claim_arguments_made", 1),
      (assign, "$opposed_arguments_made", "$victory_arguments_made"),
  ]],
  
  [anyone|plyr,"lord_recruit_3_d",
    [],
    "If {s45} were {s47}, {s45} would deal with all men fairly and uphold the rights of the commons.", "lord_recruit_3_claim",
    [
      (troop_set_slot, "$g_talk_troop", slot_lord_recruitment_argument, argument_ruler),
      (val_add, "$ruler_arguments_made", 1),
      (assign, "$opposed_arguments_made", "$lords_arguments_made"),
  ]],
  
  [anyone|plyr,"lord_recruit_3_d",
    [],
    "If {s45} were {s47}, {s45} would uphold your ancient rights as a noble of this land.", "lord_recruit_3_claim",
    [
      (troop_set_slot, "$g_talk_troop", slot_lord_recruitment_argument, argument_lords),
      (val_add, "$lords_arguments_made", 1),
      (assign, "$opposed_arguments_made", "$ruler_arguments_made"),
  ]],
  
  [anyone|plyr,"lord_recruit_3_d",
    [],
    "Because {s45} can unify France and end this discord.", "lord_recruit_3_claim",
    [
      (troop_set_slot, "$g_talk_troop", slot_lord_recruitment_argument, argument_victory),
      (val_add, "$victory_arguments_made", 1),
      (assign, "$opposed_arguments_made", "$claim_arguments_made"),
  ]],
  
  [anyone|plyr,"lord_recruit_3_d",
    [],
    "Because {s45} will reward you with lands.", "lord_recruit_3_claim",[
      (troop_set_slot, "$g_talk_troop", slot_lord_recruitment_argument, argument_benefit),
      (val_add, "$benefit_arguments_made", 1),
  ]],
  
  [anyone|plyr,"lord_recruit_3_d",
    [],
    "Never mind", "lord_pretalk",[
      (troop_set_slot, "$g_talk_troop", slot_troop_recruitment_random, 0),
  ]],
  
  [anyone,"lord_recruit_3_claim", [
      (neg|troop_slot_eq, "$g_talk_troop", slot_lord_recruitment_argument, argument_benefit),
      
      (gt, "$opposed_arguments_made", 0),
      (troop_get_slot, ":recruitment_random", "$g_talk_troop", slot_troop_recruitment_random),
      (store_mul, ":opposed_number", "$opposed_arguments_made", 10),
      (val_add, ":opposed_number", ":recruitment_random"),
      (gt, ":opposed_number", 100),
      
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", slot_lord_recruitment_argument, argument_claim),
        (str_store_string, s12, "str_you_speak_of_claims_and_legalities_yet_to_others_you_talk_of_bringing_peace_by_force"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_recruitment_argument, argument_victory),
        (str_store_string, s12, "str_you_speak_of_bringing_peace_by_force_yet_to_others_you_make_legal_claims"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_recruitment_argument, argument_commons),
        (str_store_string, s12, "str_you_speak_to_some_of_upholding_the_rights_of_the_commons_yet_you_speak_to_others_of_uphold_the_rights_of_nobles_what_if_those_rights_are_in_conflict"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_recruitment_argument, argument_lords),
        (str_store_string, s12, "str_you_speak_to_me_of_upholding_my_rights_as_a_lord_but_to_others_you_talk_of_upholding_the_rights_of_all_commons_what_if_those_rights_come_into_conflict"),
      (try_end),
    ],
    "Do you perhaps tell each person what you think they most want to hear? {s12}", "lord_recruit_3_claim",
    [
      (assign, "$opposed_arguments_made", -1),
  ]],
  
  #Is the candidate  worthy of being king?
  [anyone,"lord_recruit_3_claim", [
      
      (assign, "$g_persuasion_trump_used", 0),
      
      (troop_get_slot, ":recruitment_candidate", "$g_talk_troop", slot_lord_recruitment_candidate),
      
      (assign, ":continue", 0),
      
      (str_store_string, s12, "str_a_claim_should_be_strong_indeed_before_one_starts_talking_about_it"),
      
      (try_begin), #non-player candidates are automatically considered worthy
        (neq, ":recruitment_candidate", "trp_player"),
        
        (str_store_string, s12, "str_indeed_please_continue"),
        (assign, ":continue", 1),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_martial),
        
        (str_store_string, s12, "str_a_claim_should_be_strong_indeed_before_one_starts_talking_about_it"),
        
        #(assign, reg0, "$player_right_to_rule"),
        #(assign, reg1, ":recruitment_candidate"),
        #(troop_get_slot, reg2, ":recruitment_candidate", slot_troop_renown),
        #(display_message, "@{!}DEBUG : player_right_to_rule = {reg0}"),
        #(display_message, "@{!}DEBUG : recruitment_candidate = {reg1}"),
        #(display_message, "@{!}DEBUG : renown = {reg2}"),
        
        (ge, "$player_right_to_rule", 10),
        
        (str_store_string, s12, "str_a_king_should_prove_his_valor_beyond_any_doubt_before_he_starts_talking_about_a_claim_to_the_throne"),
        (troop_slot_ge, ":recruitment_candidate", slot_troop_renown, 400),
        
        (assign, ":continue", 1),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_goodnatured),
        
        (str_store_string, s12, "str_you_must_prove_yourself_a_great_warrior_before_men_will_follow_you_as_king"),
        (troop_slot_ge, ":recruitment_candidate", slot_troop_renown, 200),
        
        (assign, ":continue", 1),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_upstanding),
        
        (str_store_string, s12, "str_a_claim_to_the_throne_should_be_strong_indeed_before_one_presses_it"),
        (ge, "$player_right_to_rule", 20),
        
        (str_store_string, s12, "str_indeed_but_a_man_must_also_prove_himself_a_great_warrior_before_men_will_follow_you_as_king"),
        (troop_slot_ge, ":recruitment_candidate", slot_troop_renown, 200),
        
        (assign, ":continue", 1),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_quarrelsome),
        
        (str_store_string, s12, "str_my_pigherd_can_declare_himself_king_if_he_takes_he_fancy_i_think_you_need_to_break_a_few_more_heads_on_tbe_battlefield_before_men_will_follow_you"),
        (troop_slot_ge, ":recruitment_candidate", slot_troop_renown, 200),
        
        (assign, ":continue", 1),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_selfrighteous),
        
        (str_store_string, s12, "str_if_you_do_not_wish_to_die_on_a_scaffold_like_so_many_failed_pretenders_before_you_i_would_suggest_that_you_to_build_your_claim_on_stronger_foundations_so_that_men_will_follow_you"),
        (ge, "$player_right_to_rule", 10),
        
        (str_store_string, s12, "str_if_you_do_not_wish_to_die_on_a_scaffold_like_so_many_failed_pretenders_before_you_i_would_advise_you_prove_yourself_on_the_field_of_battle_so_that_men_will_follow_you"),
        (troop_slot_ge, ":recruitment_candidate", slot_troop_renown, 200),
        
        (assign, ":continue", 1),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_debauched),
        
        (str_store_string, s12, "str_talk_is_for_heralds_and_lawyers_real_kings_prove_themselves_with_their_swords"),
        (troop_slot_ge, ":recruitment_candidate", slot_troop_renown, 200),
        
        (assign, ":continue", 1),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_cunning),
        
        (str_store_string, s12, "str_i_were_you_i_would_try_to_prove_myself_a_bit_more_before_i_went_about_pressing_my_claim"),
        (troop_slot_ge, ":recruitment_candidate", slot_troop_renown, 400),
        
        (assign, ":continue", 1),
      (try_end),
      
      #Trump to overlook player unworthiness
      (str_clear, s14),
      (try_begin),
        (eq, ":continue", 1),
        (str_store_string, s12, "str_indeed_please_continue"),
        
      (else_try),
        (eq, ":continue", 0),
        (eq, "$g_persuasion_trump_used", 0),
        (assign, "$g_persuasion_trump_used", 1),
        #persuasion check
        (store_skill_level, ":persuasion_skill", "skl_persuasion", "trp_player"),
        
        (troop_get_slot, ":persuasion_random", "$g_talk_troop", slot_troop_recruitment_random),
        
        (try_begin),
          (eq, "$cheat_mode", 1),
          #(assign, reg3, ":persuasion_skill"),
          #(assign, reg4, ":persuasion_random"),
          #(display_message, "str_trump_check_random_reg4_skill_reg3"),
        (try_end),
        
        (val_mul, ":persuasion_skill", 7),
        (ge, ":persuasion_skill", ":persuasion_random"),
        
        (assign, ":continue", 1),
        
        (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_changed_my_mind_default"),
        (str_store_string, s14, "str_s12_s43"),
        (str_store_string, s12, s14),
      (try_end),
      
      (eq, ":continue", 1),
      
    ],
    "{s12}", "lord_recruit_4",[
  ]],
  
  
  #the lord refuses. s12 is set by the previous
  [anyone,"lord_recruit_3_claim",  [
    ],
    "{s12}", "lord_pretalk",[
  ]],
  
  
  [anyone|plyr,"lord_recruit_4", [
      (troop_get_slot, ":recruitment_candidate", "$g_talk_troop", slot_lord_recruitment_candidate),
      (str_store_troop_name, s16,  ":recruitment_candidate"),
      
      (try_begin),
        (eq,  ":recruitment_candidate", "trp_player"),
        (str_store_string, s16, "str_me"),
      (try_end),
    ],
    "I ask you to pledge your allegiance to {s16}.", "lord_recruit_4_objective_conditions",[]],
  
  [anyone|plyr,"lord_recruit_4", [
      (troop_set_slot, "$g_talk_troop", slot_troop_recruitment_random, 0),
    ],
    "Never mind.", "lord_pretalk",[]],
  
  [anyone,"lord_recruit_4_objective_conditions", [
      (troop_get_slot, ":recruitment_candidate", "$g_talk_troop", slot_lord_recruitment_candidate),
      
      (call_script, "script_calculate_troop_political_factors_for_liege", "$g_talk_troop", ":recruitment_candidate"),
      (str_store_string, s33, s14),
      
      (assign, ":result_for_security", reg2),
      (assign, ":result_for_political", reg4),
      
      #this will store
      (try_begin),
        (eq, "$cheat_mode", 1),
        (display_message, "str_preliminary_result_for_political_=_reg4"),
      (try_end),
      
      #			(assign, ":result_for_ideological", reg6),
      #			(assign, ":result_for_material", reg8),
      (assign, ":change_penalty", reg10),
      (assign, ":result_for_new_liege", reg0),
      
      (faction_get_slot, ":cur_liege", "$g_talk_troop_faction", slot_faction_leader),
      (call_script, "script_calculate_troop_political_factors_for_liege", "$g_talk_troop", ":cur_liege"),
      
      (store_sub, ":result_for_security_comparative", ":result_for_security", reg2),
      (store_sub, ":result_for_political_comparative", ":result_for_political", reg4),
      #			(store_sub, ":result_for_ideological_comparative", ":result_for_ideological", reg6), #to be used if NPC lords ever have different ideologies
      #			(store_sub, ":result_for_material_comparative", ":result_for_material", reg8), #result for material (meaning, promised new fiefs or bribes) currently disabled
      (assign, ":result_for_old_liege", reg0),
      
      (try_begin),
        (eq, "$cheat_mode", 1),
        (assign, reg31, ":result_for_new_liege"),
        (assign, reg32, ":result_for_old_liege"),
        
        (display_message, "@{!}DEBUG : result_for_new_liege : {reg31}"),
        (display_message, "@{!}DEBUG : result_for_old_liege : {reg32}"),
      (try_end),
      
      (store_sub, "$pledge_chance", ":result_for_new_liege", ":result_for_old_liege"),
      (val_add, "$pledge_chance", 50),
      (val_div, "$pledge_chance", 2),
      
      (try_begin),
        (lt, ":result_for_political", 0),
        
        (try_begin),
          (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_upstanding),
          (str_store_string, s31, "str_i_worry_about_those_with_whom_you_have_chosen_to_surround_yourself" ),
        (else_try),
          (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_martial),
          (str_store_string, s31, "str_there_are_some_outstanding_matters_between_me_and_some_of_your_vassals_"),
          (try_begin),
            (assign, reg41, ":result_for_political"),
            (display_message, "str_result_for_political_=_reg41"),
          (try_end),
        (else_try),
          (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_quarrelsome),
          (str_store_string, s31, "str_my_liege_has_his_faults_but_i_dont_care_for_your_toadies"),
        (else_try),
          (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_goodnatured),
          (str_store_string, s31, "str_i_think_youre_a_good_man_but_im_worried_that_you_might_be_pushed_in_the_wrong_direction_by_some_of_those_around_you"),
        (else_try),
          (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_selfrighteous),
          (str_store_string, s31, "str_i_am_loathe_to_fight_alongside_you_so_long_as_you_take_under_your_wing_varlots_and_base_men"),
        (else_try),
          (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_cunning),
          (str_store_string, s31, "str_ill_be_honest__with_some_of_those_who_follow_you_i_think_id_be_more_comfortable_fighting_against_you_than_with_you"),
        (else_try),
          (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_debauched),
          (str_store_string, s31, "str_i_say_that_you_can_judge_a_man_by_the_company_he_keeps_and_you_have_surrounded_yourself_with_vipers_and_vultures"),
        (else_try),
          (troop_slot_ge, "$g_talk_troop", slot_lord_reputation_type, lrep_roguish),
          (str_store_string, s31, "str_you_know_that_i_have_always_had_a_problem_with_some_of_our_companions"),
        (try_end),
      (else_try),
        (lt, ":result_for_political_comparative", 0),
        (str_store_string, s31, "str_politically_i_would_be_a_better_position_in_the_court_of_my_current_liege_than_in_yours"),
      (else_try),
        (str_store_string, s31, "str_i_am_more_comfortable_with_you_and_your_companions_than_with_my_current_liege"),
      (try_end),
      #end political string
      
      #end
      (try_begin),
        (lt, ":result_for_security", 10),
        
        (try_begin),
          (this_or_next|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_cunning),
          (troop_slot_ge, "$g_talk_troop", slot_lord_reputation_type, lrep_roguish),
          (str_store_string, s32, "str_militarily_youre_in_no_position_to_protect_me_should_i_be_attacked_id_be_reluctant_to_join_you_until_you_could"),
        (else_try),
          (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_upstanding),
          (str_store_string, s32, "str_militarily_when_i_consider_the_lay_of_the_land_i_realize_that_to_pledge_myself_to_you_now_would_endanger_my_faithful_retainers_and_my_family"),
        (else_try),
          (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_martial),
          (str_store_string, s32, "str_militarily_youre_in_no_position_to_come_to_my_help_if_someone_attacked_me_i_dont_mind_a_good_fight_but_i_like_to_have_a_chance_of_winning"),
        (else_try),
          (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_goodnatured),
          (str_store_string, s32, "str_militarily_youre_in_no_position_to_come_to_my_help_if_someone_attacked_me_i_dont_mind_a_good_fight_but_i_like_to_have_a_chance_of_winning"),
        (else_try),
          (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_debauched),
          (str_store_string, s32, "str_militarily_you_would_have_me_join_you_only_to_find_myself_isolated_amid_a_sea_of_enemies"),
        (else_try),
          (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_selfrighteous),
          (str_store_string, s32, "str_militarily_you_would_have_me_join_you_only_to_find_myself_isolated_amid_a_sea_of_enemies"),
        (else_try),
          (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_quarrelsome),
          (str_store_string, s32, "str_militarily_youre_in_no_position_to_come_to_my_help_if_someone_attacked_me_youd_let_me_be_cut_down_like_a_dog_id_bet"),
        (try_end),
      (else_try),
        (lt, ":result_for_security_comparative", 0),
        (str_store_string, s32, "str_militarily_i_wouldnt_be_any_safer_if_i_joined_you"),
      (else_try),
        (str_store_string, s32, "str_militarily_i_might_be_safer_if_i_joined_you"),
      (try_end),
      
      (try_begin),
        (gt, ":change_penalty", 40),
        (str_store_string, s34, "str_finally_there_is_a_cost_to_ones_reputation_to_change_sides_in_this_case_the_cost_would_be_very_high"),
      (else_try),
        (gt, ":change_penalty", 20),
        (str_store_string, s34, "str_finally_there_is_a_cost_to_ones_reputation_to_change_sides_in_this_case_the_cost_would_be_significant"),
      (else_try),
        (str_store_string, s34, "str_finally_there_is_a_cost_to_ones_reputation_to_change_sides_in_this_case_however_many_men_would_understand"),
      (try_end),
    ],
    "Let me think...", "lord_recruit_5_security",[
  ]],
  
  [anyone,"lord_recruit_5_security",  [
    ],
    "{s32}", "lord_recruit_5_political",
    []],
  
  
  [anyone,"lord_recruit_5_political",  [
    ],
    "{s31}", "lord_recruit_5_ideological",
    []],
  
  #    [anyone,"lord_recruit_5_material",  [
  
  #	],
  #	"{!}[Anticipated material gains currently not counted]", "lord_recruit_5_ideological",
  #	[]],
  
  [anyone,"lord_recruit_5_ideological",  [
    ],
    "{s33}", "lord_recruit_5_change_sides",
    [
      
  ]],
  
  [anyone,"lord_recruit_5_change_sides",  [
    ],
    "{s34}", "lord_recruit_6",
    [
      (try_begin),
        (eq, "$cheat_mode", 1),
        (assign, reg1, "$pledge_chance"),
        (display_message, "str_chance_of_success_=_reg1"),
      (try_end),
  ]],
  
  [anyone|plyr,"lord_recruit_6",[
    ],
    "It is time for you to make a decision.", "lord_recruit_6_reaction",
    [
  ]],
  
  [anyone|plyr,"lord_recruit_6",[
    ],
    "No need to decide anything -- we can speak of this at a later time.", "lord_pretalk",
    [
  ]],
  
  
  [anyone,"lord_recruit_6_reaction",
    [
    ],
    "Very well...", "lord_recruit_7_decision",
    [
      (troop_set_slot, "$g_talk_troop", slot_troop_recruitment_random, 0),
  ]],
  
  
  [anyone,"lord_recruit_7_decision",
    [
      #(store_random_in_range, ":random", 0, 100),
      (troop_get_slot, ":temp_ai_seed", "$g_talk_troop", slot_troop_temp_decision_seed),
      (store_mod, ":random", ":temp_ai_seed", 100),
      
      (try_begin),
        (eq, "$cheat_mode", 1),
        (assign, reg3, ":random"),
        (display_message, "str_random_=_reg3"),
      (try_end),
      
      (faction_get_slot, ":leader", "$g_talk_troop_faction", slot_faction_leader),
      (str_store_troop_name, s14, ":leader"),
      
      (assign, ":continue_to_pledge", 0),
      
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_selfrighteous),
        (gt, ":random", "$pledge_chance"),
        (str_store_string, s12, "str_i_will_not_have_it_be_said_about_me_that_i_am_a_traitor_that_is_my_final_decision_i_have_nothing_more_to_say_on_this_matter"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_martial),
        (gt, ":random", "$pledge_chance"),
        
        (str_store_string, s12, "str_i_am_pledged_to_defend_s14_i_am_sorry_though_we_may_meet_on_the_battlefield_i_hope_that_we_will_still_be_friends"),
      (else_try),
        (this_or_next|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_goodnatured),
        (troop_slot_ge, "$g_talk_troop", slot_lord_reputation_type, lrep_roguish),
        (gt, ":random", "$pledge_chance"),
        
        (str_store_string, s12, "str_i_really_cannot_bring_myself_to_renounce_s14_i_am_sorry_please_lets_not_talk_about_this_any_more"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_upstanding),
        (gt, ":random", "$pledge_chance"),
        
        (str_store_string, s12, "str_however_i_have_decided_that_i_must_remain_loyal_to_s14_i_am_sorry"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_debauched),
        (gt, ":random", "$pledge_chance"),
        
        (str_store_string, s12, "str_however_i_will_not_let_you_lead_me_into_treason_do_not_talk_to_me_of_this_again"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_cunning),
        (gt, ":random", "$pledge_chance"),
        
        (str_store_string, s12, "str_its_not_good_to_get_a_reputation_as_one_who_abandons_his_liege_that_is_my_decision_let_us_speak_no_more_of_this_matter"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_quarrelsome),
        (gt, ":random", "$pledge_chance"),
        
        (str_store_string, s12, "str_ive_decided_to_stick_with_s14_i_dont_want_to_talk_about_this_matter_any_more"),
      (else_try),
        (assign, ":continue_to_pledge", 1),
      (try_end),
      
      (eq, ":continue_to_pledge", 0),
    ],
    "{s12}", "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", slot_troop_intrigue_impatience, 500),
  ]],
  
  [anyone,"lord_recruit_7_decision",
    [
      (troop_get_slot, ":recruitment_candidate", "$g_talk_troop", slot_lord_recruitment_candidate),
      (str_store_troop_name, s4, ":recruitment_candidate"),
      
      (try_begin),
        (eq, "$cheat_mode", 1),
        (display_message, "str_lord_pledges_to_s4"),
      (try_end),
    ],
    "Very well -- I am ready to pledge myself to {s4} as my {reg4?queen:king}.", "lord_recruit_pledge",
    [
      (troop_get_slot, ":recruitment_candidate", "$g_talk_troop", slot_lord_recruitment_candidate),
      
      (try_begin),
        (eq, ":recruitment_candidate", "trp_player"),
        (faction_slot_eq, "fac_player_supporters_faction", slot_faction_state, sfs_inactive),
        (call_script, "script_activate_player_faction", "trp_player"),
      (try_end),
      
      (assign, "$lord_expects_fief", 0),
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", slot_lord_recruitment_argument, argument_benefit),
        (assign, "$lord_expects_fief", 1),
      (try_end),
      
      (call_script, "script_change_troop_faction", "$g_talk_troop", "$players_kingdom"),
      
      (try_begin), #Actually, perhaps do provocation rather than war
        (store_relation, ":relation", "$players_kingdom", "$g_talk_troop_faction"),
        (ge, ":relation", 0),
        
        (try_begin),
          (eq, "$cheat_mode", 1),
          (display_message, "str_lord_recruitment_provokes_home_faction"),
        (try_end),
        
        (call_script, "script_add_log_entry", logent_border_incident_troop_suborns_lord, "trp_player", -1, "$g_talk_troop","$g_talk_troop_faction"),
        (store_add, ":slot_provocation_days", "$players_kingdom", slot_faction_provocation_days_with_factions_begin),
        (val_sub, ":slot_provocation_days", kingdoms_begin),
        (faction_set_slot, "$g_talk_troop_faction", ":slot_provocation_days", 30),
        
        (faction_get_slot, ":other_liege", "$g_talk_troop_faction", slot_faction_leader),
        (call_script, "script_troop_change_relation_with_troop", "trp_player", ":other_liege", -3),
      (try_end),
      
      (troop_get_type, reg4, ":recruitment_candidate"),
      (try_begin),
        (eq, ":recruitment_candidate", "trp_player"),
        (str_store_string, s4, "@you"),
        (call_script, "script_change_player_right_to_rule", 5),
      (else_try),
        (str_store_troop_name, s4, ":recruitment_candidate"),
      (try_end),
  ]],
  
  
  [anyone,"lord_recruit_pledge",
    [
      (eq, "$lord_expects_fief", 1),
    ],
    "Remember. You have promised me a fief. I will hold you to that promise.", "lord_recruit_pledge",
    [
      (assign, "$lord_expects_fief", 0),
      (troop_set_slot, "$g_talk_troop", slot_lord_recruitment_argument, 0),
      (call_script, "script_add_log_entry", logent_liege_promises_fief_to_vassal, "trp_player", 0, "$g_talk_troop", "$players_kingdom"),
      (troop_set_slot, "$g_talk_troop", slot_troop_promised_fief, 1),
  ]],
  
  [anyone,"lord_recruit_pledge",
    [
      (troop_get_slot, ":recruitment_candidate", "$g_talk_troop", slot_lord_recruitment_candidate),
      (eq, ":recruitment_candidate", "trp_player"),
    ],
    "So be it -- I pledge allegiance to you as your faithful vassal. I shall stand at your side to fight your enemies should you need my sword, and uphold your claims and those of your legitimate heirs. I expect in turn that you will protect me and recognize my rights as your vassal.", "lord_recruit_pledge_conclude",
    [
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone,"lord_recruit_pledge",  [
      (troop_get_slot, ":recruitment_candidate", "$g_talk_troop", slot_lord_recruitment_candidate),
      (str_store_troop_name, s4, ":recruitment_candidate"),
    ],
    "So be it -- you may inform {s4} that I am now {reg4?her:him} faithful vassal, that I will follow {reg4?her:him} as long as my breath remains, and I will be at {reg4?her:his} side to fight your enemies should you need my sword, and that I uphold your lawful claims and those of your legitimate heirs. In turn, I expect his protection and his recognition of my rights as his vassal.", "lord_recruit_pledge_conclude",
    []],
  
  [anyone,"lord_recruit_pledge_conclude",  [
    ],
    "Now... It is a momentous step I have taken. I will take my leave, as I may need some time prepare myself for what comes next.", "close_window",
    []],
  #lord recruitment changes end
  
  
  #POLITICAL QUESTS RESOLUTIONS
  [anyone, "lord_start",   [
      
      (check_quest_active, "qst_offer_gift"),
      (quest_slot_eq, "qst_offer_gift", slot_quest_target_troop, "$g_talk_troop"),
      (quest_slot_eq, "qst_offer_gift", slot_quest_current_state, 2),
      
      (this_or_next|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_upstanding),
      (this_or_next|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_goodnatured),
      (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_martial),
      (store_random_in_range, ":random", 3),
      (eq, ":random", 0),
      
      (quest_get_slot, ":giver_troop", "qst_offer_gift", slot_quest_giver_troop),
      (str_store_troop_name, s10, ":giver_troop"),
      (call_script, "script_troop_get_family_relation_to_troop", ":giver_troop",  "$g_talk_troop"),
    ],
    "I received the gift, presented to me through my {s11} {s10}. It was a noble gesture, {sir/my lady}, and I regret that we ever quarreled.", "close_window",
    [
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", "trp_player"),
      (store_sub, ":difference", 0, reg0),
      (val_add, ":difference", 5),
      (val_max, ":difference", 5),
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", ":difference"),
      (call_script, "script_end_quest", "qst_offer_gift"),
      (assign, "$g_leave_encounter", 1),
      
  ]],
  
  
  
  [anyone,"lord_start",[
      (check_quest_active, "qst_offer_gift"),
      (quest_slot_eq, "qst_offer_gift", slot_quest_target_troop, "$g_talk_troop"),
      (quest_slot_eq, "qst_offer_gift", slot_quest_current_state, 2),
      
      (store_random_in_range, ":random", 3),
      (neq, ":random", 0),
      
      (quest_get_slot, ":giver_troop", "qst_offer_gift", slot_quest_giver_troop),
      (str_store_troop_name, s10, ":giver_troop"),
      (call_script, "script_troop_get_family_relation_to_troop", ":giver_troop",  "$g_talk_troop"),
      
    ],
    "I received the gift, presented to me through my {s11} {s10}. For {reg4?her:his} sake, I am willing to let bygones be bygones.", "close_window",	[
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", "trp_player"),
      (store_sub, ":difference", 0, reg0),
      (val_max, ":difference", 2),
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", ":difference"),
      (call_script, "script_end_quest", "qst_offer_gift"),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone,"lord_start",[
      (check_quest_active, "qst_offer_gift"),
      (quest_slot_eq, "qst_offer_gift", slot_quest_target_troop, "$g_talk_troop"),
      (quest_slot_eq, "qst_offer_gift", slot_quest_current_state, 2),
      
      (this_or_next|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_quarrelsome),
      (this_or_next|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_debauched),
      (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_selfrighteous),
      
      (quest_get_slot, ":giver_troop", "qst_offer_gift", slot_quest_giver_troop),
      (str_store_troop_name, s10, ":giver_troop"),
      (call_script, "script_troop_get_family_relation_to_troop", ":giver_troop",  "$g_talk_troop"),
      
    ],
    "I received the gift, presented to me through my {s11} {s10}. Bah! Do you think you can buy my friendship?", "close_window",	[
      (call_script, "script_end_quest", "qst_offer_gift"),
      (assign, "$g_leave_encounter", 1),
      
  ]],
  
  
  
  [anyone,"lord_start",[
      (check_quest_active, "qst_offer_gift"),
      (quest_slot_eq, "qst_offer_gift", slot_quest_target_troop, "$g_talk_troop"),
      (quest_slot_eq, "qst_offer_gift", slot_quest_current_state, 2),
      
      (quest_get_slot, ":giver_troop", "qst_offer_gift", slot_quest_giver_troop),
      (str_store_troop_name, s10, ":giver_troop"),
      (call_script, "script_troop_get_family_relation_to_troop", ":giver_troop",  "$g_talk_troop"),
      
    ],
    "I received the gift, presented to me through my {s11} {s10}. As dear as {reg?she:he} is to me, however, I cannot forget our differences.", "close_window",
    [
      (assign, "$g_leave_encounter", 1),
      (call_script, "script_end_quest", "qst_offer_gift"),
  ]],
  
  
  
  [anyone|plyr,"lord_talk",[
      (check_quest_active, "qst_denounce_lord"),
      (quest_slot_eq, "qst_denounce_lord", slot_quest_giver_troop, "$g_talk_troop"),
      (this_or_next|check_quest_succeeded, "qst_denounce_lord"),
      (check_quest_failed, "qst_denounce_lord"),
      (quest_get_slot, ":target_troop", "qst_denounce_lord", slot_quest_giver_troop),
      (str_store_troop_name, s4, ":target_troop"),
    ],
    "I did as you suggested, and denounced {s4}", "denounce_lord_results"  ,
    [
  ]],
  
  
  [anyone,"denounce_lord_results",[
      (check_quest_succeeded, "qst_denounce_lord"),
      (faction_get_slot, ":faction_leader", "$g_talk_troop_faction", slot_faction_leader),
      (str_store_troop_name, s4, ":faction_leader"),
      
    ],
    "Yes, and hopefully now {s4} will think twice before entrusting him with any additional fiefs, honors, or offices. We are grateful to you.", "lord_pretalk",
    [
      (call_script, "script_succeed_quest", "qst_denounce_lord"),
      (call_script, "script_end_quest", "qst_denounce_lord"),
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", 8),
      (add_xp_as_reward, 1000),
  ]],
  
  
  [anyone,
    "denounce_lord_results",[
      #	(check_quest_failed, "qst_denounce_lord"),
    ],
    "So you did -- and we have heard that he forced you to retract your words, and thus emerged from this affair looking stronger than before. You will forgive me, {sir/my lady}, if my gratitude to you is somewhat muted.", "close_window",
    [
      (call_script, "script_end_quest", "qst_denounce_lord"),
      
  ]],
  
  
  
  [anyone|plyr,"lord_talk",[
      (check_quest_active, "qst_intrigue_against_lord"),
      (quest_slot_eq, "qst_intrigue_against_lord", slot_quest_giver_troop, "$g_talk_troop"),
      
      (this_or_next|check_quest_succeeded, "qst_intrigue_against_lord"),
      (check_quest_failed, "qst_intrigue_against_lord"),
      
      (quest_get_slot, ":target_troop", "qst_intrigue_against_lord", slot_quest_target_troop),
      (str_store_troop_name, s4, ":target_troop"),
      (faction_get_slot, ":liege", "$players_kingdom", slot_faction_leader),
      (str_store_troop_name, s5, ":liege"),
      
      
    ],
    "I did as you asked, and spoke to {s5} about the danger posed by {s4}.", "lord_quest_intrigue_result"  ,
    [
  ]],
  
  [anyone,"lord_quest_intrigue_result",[
      (check_quest_succeeded, "qst_intrigue_against_lord"),
    ],
    "So we hear. Hopefully now {s5} will think twice before entrusting him with any additional fiefs, honors, or offices. We are grateful to you.", "lord_pretalk"  ,
    [
      (call_script, "script_end_quest", "qst_intrigue_against_lord"),
      (quest_set_slot, "qst_intrigue_against_lord", slot_quest_dont_give_again_remaining_days, 30),
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", 8),
      (add_xp_as_reward, 500),
  ]],
  
  [anyone,"lord_quest_intrigue_result",[
      (check_quest_failed, "qst_intrigue_against_lord"),
    ],
    "So we hear -- but alas, {s5} seems not to have listened. Still, we are grateful to you for trying.", "close_window"  ,
    [
      (call_script, "script_end_quest", "qst_intrigue_against_lord"),
      (quest_set_slot, "qst_intrigue_against_lord", slot_quest_dont_give_again_remaining_days, 30),
      #	(call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", 2),
  ]],
  
  
  
  [anyone|plyr,"lord_talk",[#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (check_quest_active,"qst_lend_companion"),
      (quest_slot_eq, "qst_lend_companion", slot_quest_giver_troop, "$g_talk_troop"),
      (store_current_day, ":cur_day"),
      (quest_get_slot, ":quest_target_amount", "qst_lend_companion", slot_quest_target_amount),
      (ge, ":cur_day", ":quest_target_amount"),
      (quest_get_slot, ":quest_target_troop", "qst_lend_companion", slot_quest_target_troop),
      (str_store_troop_name,s14,":quest_target_troop"),
      (troop_get_type, reg3, ":quest_target_troop"),
    ],
    "I should like {s14} returned to me, {s65}, if you no longer require {reg3?her:his} services.", "lord_lend_companion_end",
    []],
  
  [anyone,"lord_lend_companion_end",[(neg|hero_can_join, "p_main_party")],
    "You've too many men in your company already, {playername}. You could not lead any more at the moment.", "lord_pretalk",
    []],
  
  [anyone,"lord_lend_companion_end",[],
    "Certainly, {playername}. {reg3?She:He} is a bright {reg3?girl:fellow}, you're a lucky {man/woman} to have such worthy companions.", "lord_pretalk",
    [(quest_get_slot, ":quest_target_troop", "qst_lend_companion", slot_quest_target_troop),
      (party_add_members, "p_main_party", ":quest_target_troop", 1),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 3),
      (add_xp_as_reward, 100),
      (call_script, "script_end_quest", "qst_lend_companion"),
      (str_store_troop_name,s14,":quest_target_troop"),
      (troop_get_type, reg3, ":quest_target_troop"),
  ]],
  
  [anyone|plyr,"lord_talk",[(check_quest_active,"qst_collect_debt"),
      (quest_slot_eq,  "qst_collect_debt", slot_quest_current_state, 0),
      (quest_get_slot, ":quest_target_troop", "qst_collect_debt", slot_quest_target_troop),
      (eq,"$g_talk_troop",":quest_target_troop"),
      (quest_get_slot, ":quest_giver_troop", "qst_collect_debt", slot_quest_giver_troop),
      (str_store_troop_name,1,":quest_giver_troop")],
    "I've come to collect the debt you owe to {s1}.", "lord_ask_to_collect_debt",
    [(assign, "$g_convince_quest", "qst_collect_debt")]],
  
  [anyone,"lord_ask_to_collect_debt", [],  "Oh. Well, {s1} did lend me some silver a ways back, " +
    "but I've done him many favours in the past and I consider that money as my due payment.", "lord_ask_to_collect_debt_2",[]],
  [anyone|plyr,"lord_ask_to_collect_debt_2", [],  "{s1} considers it a debt. He asked me to speak to you on his behalf.", "convince_begin",[]],
  [anyone|plyr,"lord_ask_to_collect_debt_2", [],  "Then I will not press the matter any further.", "lord_pretalk",[]],
  
  
  [anyone,"convince_accept",[(check_quest_active, "qst_collect_debt"),
      (quest_slot_eq, "qst_collect_debt", slot_quest_target_troop, "$g_talk_troop"),
      (quest_get_slot, ":quest_giver_troop", "qst_collect_debt", slot_quest_giver_troop),
      (str_store_troop_name,s8,":quest_giver_troop"),
      (quest_get_slot, reg10, "qst_collect_debt", slot_quest_target_amount)],
    "My debt to {s8} has long been overdue and was a source of great discomfort to me. " +
    "Thank you for accepting to take the money to him. " +
    "Please give him these {reg10} denars and thank him on my behalf.", "close_window",
    [(call_script, "script_troop_add_gold", "trp_player", reg10),
      (quest_set_slot,  "qst_collect_debt", slot_quest_current_state, 1),
      (call_script, "script_succeed_quest", "qst_collect_debt"),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  
  [anyone|plyr,"lord_talk",[(check_quest_active,"qst_persuade_lords_to_make_peace"),
      (quest_get_slot, ":quest_target_troop", "qst_persuade_lords_to_make_peace", slot_quest_target_troop),
      (quest_get_slot, ":quest_object_troop", "qst_persuade_lords_to_make_peace", slot_quest_object_troop),
      (this_or_next|eq, ":quest_target_troop", "$g_talk_troop"),
      (eq, ":quest_object_troop", "$g_talk_troop"),
      (quest_get_slot, ":quest_target_faction", "qst_persuade_lords_to_make_peace", slot_quest_target_faction),
      (quest_get_slot, ":quest_object_faction", "qst_persuade_lords_to_make_peace", slot_quest_object_faction),
      (str_store_faction_name, s12, ":quest_target_faction"),
      (str_store_faction_name, s13, ":quest_object_faction"),
    ],
    "Please, {s64}, it's time to end this war between {s12} and {s13}.", "lord_ask_to_make_peace",
    [(assign, "$g_convince_quest", "qst_persuade_lords_to_make_peace")]],
  
  [anyone,"lord_ask_to_make_peace", [], "Eh? I'm not sure I heard you right, {playername}. " +
    "War is not easily forgotten by either side of the conflict, and I have a very long memory. " +
    "Why should I take any interest in brokering peace with those dogs?", "lord_ask_to_make_peace_2",[]],
  
  [anyone|plyr,"lord_ask_to_make_peace_2", [],  "Perhaps I can talk you into it...", "convince_begin",[]],
  [anyone|plyr,"lord_ask_to_make_peace_2", [],  "Never mind, peace can wait for now.", "lord_pretalk",[]],
  
  [anyone,"convince_accept",[(check_quest_active, "qst_persuade_lords_to_make_peace"),
      (this_or_next|quest_slot_eq, "qst_persuade_lords_to_make_peace", slot_quest_target_troop, "$g_talk_troop"),
      (quest_slot_eq, "qst_persuade_lords_to_make_peace", slot_quest_object_troop, "$g_talk_troop"),
      (quest_get_slot, ":quest_object_faction", "qst_persuade_lords_to_make_peace", slot_quest_object_faction),
      (quest_get_slot, ":quest_target_faction", "qst_persuade_lords_to_make_peace", slot_quest_target_faction),
      (str_store_faction_name, s12, ":quest_object_faction"),
      (str_store_faction_name, s13, ":quest_target_faction"),
      (try_begin), # store name of other faction
        (eq,":quest_object_faction","$g_talk_troop_faction"),
        (str_store_faction_name, s14, ":quest_target_faction"),
      (else_try),
        (str_store_faction_name, s14, ":quest_object_faction"),
      (try_end),
    ],
    "You... have convinced me, {playername}. Very well then, you've my blessing to bring a peace offer to {s14}. I cannot guarantee they will accept it, but on the off-chance they do, I will stand by it.", "close_window",
    [(store_mul, ":new_value", "$g_talk_troop", -1),
      (try_begin),
        (quest_slot_eq, "qst_persuade_lords_to_make_peace", slot_quest_target_troop, "$g_talk_troop"),
        (quest_set_slot, "qst_persuade_lords_to_make_peace", slot_quest_target_troop, ":new_value"),
      (else_try),
        (quest_set_slot, "qst_persuade_lords_to_make_peace", slot_quest_object_troop, ":new_value"),
      (try_end),
      (quest_set_slot, "qst_persuade_lords_to_make_peace", slot_quest_convince_value, 1500),#reseting convince value for the second persuasion
      (assign, "$g_leave_encounter", 1),
      (neg|quest_slot_ge, "qst_persuade_lords_to_make_peace", slot_quest_target_troop, 0),
      (neg|quest_slot_ge, "qst_persuade_lords_to_make_peace", slot_quest_object_troop, 0),
      (call_script, "script_succeed_quest", "qst_persuade_lords_to_make_peace"),
  ]],
  
  
  ##
  ##
  ##  [anyone|plyr,"lord_talk",[(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                            (check_quest_active,"qst_bring_reinforcements_to_siege"),
  ##                             (quest_get_slot, ":quest_target_troop", "qst_bring_reinforcements_to_siege", slot_quest_target_troop),
  ##                             (eq,"$g_talk_troop",":quest_target_troop"),
  ##                             (quest_get_slot, ":quest_giver_troop", "qst_bring_reinforcements_to_siege", slot_quest_giver_troop),
  ##                             (quest_get_slot, ":quest_target_amount", "qst_bring_reinforcements_to_siege", slot_quest_target_amount),
  ##                             (quest_get_slot, ":quest_object_troop", "qst_bring_reinforcements_to_siege", slot_quest_object_troop),
  ##                             (party_count_companions_of_type, ":num_companions", "p_main_party", ":quest_object_troop"),
  ##                             (ge, ":num_companions", ":quest_target_amount"),
  ##                             (str_store_troop_name,1,":quest_giver_troop"),
  ##                             (assign, reg1, ":quest_target_amount"),
  ##                             (str_store_troop_name,2,":quest_object_troop")],
  ##   "Sir, {s1} ordered me to bring {reg1} {s2} to reinforce your siege.", "lord_reinforcement_brought",
  ##   [(quest_get_slot, ":quest_target_amount", "qst_bring_reinforcements_to_siege", slot_quest_target_amount),
  ##    (quest_get_slot, ":quest_target_party", "qst_bring_reinforcements_to_siege", slot_quest_target_party),
  ##    (quest_get_slot, ":quest_object_troop", "qst_bring_reinforcements_to_siege", slot_quest_object_troop),
  ##    (party_remove_members, "p_main_party", ":quest_object_troop", ":quest_target_amount"),
  ##    (party_add_members, ":quest_target_party", ":quest_object_troop", ":quest_target_amount"),
  ##    (call_script, "script_finish_quest", "qst_bring_reinforcements_to_siege", 100),
  ##    ]],
  ##
  ##  [anyone|plyr,"lord_talk",[(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                            (check_quest_active,"qst_bring_reinforcements_to_siege"),
  ##                             (quest_get_slot, ":quest_target_troop", "qst_bring_reinforcements_to_siege", slot_quest_target_troop),
  ##                             (eq,"$g_talk_troop",":quest_target_troop"),
  ##                             (quest_get_slot, ":quest_giver_troop", "qst_bring_reinforcements_to_siege", slot_quest_giver_troop),
  ##                             (quest_get_slot, ":quest_target_amount", "qst_bring_reinforcements_to_siege", slot_quest_target_amount),
  ##                             (quest_get_slot, ":quest_object_troop", "qst_bring_reinforcements_to_siege", slot_quest_object_troop),
  ##                             (party_count_companions_of_type, ":num_companions", "p_main_party", ":quest_object_troop"),
  ##                             (lt, ":num_companions", ":quest_target_amount"),
  ##                             (gt, ":num_companions", 0),
  ##                             (str_store_troop_name,1,":quest_giver_troop"),
  ##                             (assign, reg1, ":quest_target_amount"),
  ##                             (str_store_troop_name,2,":quest_object_troop")],
  ##   "Sir, {s1} ordered me to bring {reg1} {s2} as a reinforcement to your siege, but unfortunately I lost some of them during my expedition.", "lord_reinforcement_brought_some",
  ##   [(quest_get_slot, ":quest_target_amount", "qst_bring_reinforcements_to_siege", slot_quest_target_amount),
  ##    (quest_get_slot, ":quest_target_party", "qst_bring_reinforcements_to_siege", slot_quest_target_party),
  ##    (quest_get_slot, ":quest_object_troop", "qst_bring_reinforcements_to_siege", slot_quest_object_troop),
  ##    (party_count_companions_of_type, ":num_companions", "p_main_party", ":quest_object_troop"),
  ##    (party_remove_members, "p_main_party", ":quest_object_troop", ":num_companions"),
  ##    (party_add_members, ":quest_target_party", ":quest_object_troop", ":num_companions"),
  ##    (assign, ":percentage_completed", 100),
  ##    (val_mul, ":percentage_completed", ":num_companions"),
  ##    (val_div, ":percentage_completed", ":quest_target_amount"),
  ##    (call_script, "script_finish_quest", "qst_bring_reinforcements_to_siege", ":percentage_completed"),
  ##     ]],
  ##
  ##  [anyone,"lord_reinforcement_brought", [], "Well done {playername}. These men will no doubt be very useful. I will speak to {s1} of your help.", "lord_pretalk",[]],
  ##  [anyone,"lord_reinforcement_brought_some", [], "That's not quite good enough {playername}. But I suppose it is better than no reinforcements at all. Whatever, I'll tell {s1} you tried your best.", "lord_pretalk",[]],
  ##
  
  [anyone|plyr,"lord_talk",
    [
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (check_quest_active,"qst_duel_for_lady"),
      (neg|check_quest_concluded,"qst_duel_for_lady"),
      (quest_slot_eq, "qst_duel_for_lady", slot_quest_target_troop, "$g_talk_troop"),
      (quest_get_slot, ":quest_giver_troop", "qst_duel_for_lady", slot_quest_giver_troop),
      (str_store_troop_name, s1, ":quest_giver_troop")
    ],
    "I want you to take back your accusations against {s1}.", "lord_challenge_duel_for_lady", []],
  
  [anyone,"lord_challenge_duel_for_lady", [], "What accusations? " +
    "Everyone knows that she beds her stable boys and anyone else she can lay hands on while her husband is away. " +
    "I merely repeat the words of many.", "lord_challenge_duel_for_lady_2",[]],
  [anyone|plyr,"lord_challenge_duel_for_lady_2", [], "You will recant these lies, sirrah, or prove them against my sword!", "lord_challenge_duel",[]],
  [anyone|plyr,"lord_challenge_duel_for_lady_2", [], "If you say so...", "lord_pretalk",[]],
  
  [anyone,"lord_challenge_duel",
    [
      (str_store_string, s15, "str_error__wrong_quest_type"),
      (try_begin),
        (check_quest_active,"qst_duel_for_lady"),
        (neg|check_quest_concluded,"qst_duel_for_lady"),
        (quest_slot_eq, "qst_duel_for_lady", slot_quest_target_troop, "$g_talk_troop"),
        (str_store_string, s15, "@You are challenging me to a duel? How droll! " +
        "As you wish, {playername}, it will be good sport to bash your head in."),
      (else_try),
        (check_quest_active,"qst_duel_courtship_rival"),
        (neg|check_quest_concluded,"qst_duel_courtship_rival"),
        (quest_slot_eq, "qst_duel_courtship_rival", slot_quest_target_troop, "$g_talk_troop"),
        (str_store_string, s15, "str_call_me_coward_very_well_you_leave_me_no_choice"),
      (try_end),
    ], "{s15}", "close_window",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -15),
      (call_script, "script_set_up_duel_with_troop", "$g_talk_troop"),
  ]],
  
  [anyone|plyr,"lord_talk",[#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (check_quest_active,"qst_duel_courtship_rival"),
      (neg|check_quest_concluded,"qst_duel_courtship_rival"),
      (quest_slot_eq, "qst_duel_courtship_rival", slot_quest_target_troop, "$g_talk_troop"),
      (quest_get_slot, ":quest_giver_troop", "qst_duel_courtship_rival", slot_quest_giver_troop),
      (str_store_troop_name, s5, ":quest_giver_troop")],
    "Relinquish your suit of {s5}!", "lord_challenge_courtship_rival", []],
  
  [anyone,"lord_challenge_courtship_rival",[], "Or what? Do you intend to duel over a lady? I'll let you know -- our liege frowns on this sort of hot-headed challenge, when every man must stand together against the foreign foe.", "lord_challenge_courtship_rival_2",[]],
  
  [anyone|plyr,"lord_challenge_courtship_rival_2", [], "Do you fear to fight me?", "lord_challenge_duel",[]],
  [anyone|plyr,"lord_challenge_courtship_rival_2", [], "My pardon. I have spoken rashly...", "lord_pretalk",[
      (call_script, "script_end_quest", "qst_duel_courtship_rival"),
  ]],
  
  
  
  
  [anyone|plyr,"lord_talk",[(check_quest_active,"qst_deliver_message"),
      (quest_get_slot, ":quest_target_troop", "qst_deliver_message", slot_quest_target_troop),
      (eq,"$g_talk_troop",":quest_target_troop"),
      (quest_get_slot, ":quest_giver_troop", "qst_deliver_message", slot_quest_giver_troop),
      (str_store_troop_name,s9,":quest_giver_troop")],
    "I bring a message from {s9}.", "lord_message_delivered",
    []],
  
  [anyone,"lord_message_delivered", [], "Oh? Let me see that... " +
    "Well, well, well! It was good of you to bring me this, {playername}. Take my seal as proof that I've received it, " +
    "and give my regards to {s9} when you see him again.", "lord_pretalk",[
      (call_script, "script_end_quest", "qst_deliver_message"),
      (quest_get_slot, ":quest_giver", "qst_deliver_message", slot_quest_giver_troop),
      (str_store_troop_name,s9,":quest_giver"),
      (call_script, "script_change_player_relation_with_troop", ":quest_giver", 1),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
  ]],
  
  [anyone|plyr,"lord_talk",[(check_quest_active,"qst_deliver_message_to_enemy_lord"),
      (quest_get_slot, ":quest_target_troop", "qst_deliver_message_to_enemy_lord", slot_quest_target_troop),
      (eq,"$g_talk_troop",":quest_target_troop"),
      (quest_get_slot, ":quest_giver_troop", "qst_deliver_message_to_enemy_lord", slot_quest_giver_troop),
      (str_store_troop_name,s9,":quest_giver_troop")],
    "I bring a message from {s9}.", "lord_message_delivered_enemy",
    []],
  
  
  [anyone,"lord_message_delivered_enemy", [], "Oh? Let me see that... " +
    "Hmmm. It was good of you to bring me this, {playername}. Take my seal as proof that I've received it, " +
    "with my thanks.", "close_window",[
      (call_script, "script_end_quest", "qst_deliver_message_to_enemy_lord"),
      (quest_get_slot, ":quest_giver", "qst_deliver_message_to_enemy_lord", slot_quest_giver_troop),
      (call_script, "script_change_player_relation_with_troop", ":quest_giver", 1),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  
  
  [anyone|plyr,"lord_talk", [(check_quest_active,"qst_deliver_message_to_prisoner_lord"),
      (quest_slot_eq, "qst_deliver_message_to_prisoner_lord", slot_quest_target_troop, "$g_talk_troop"),
      (quest_get_slot, ":quest_giver_troop", "qst_deliver_message_to_prisoner_lord", slot_quest_giver_troop),
      (str_store_troop_name, s11, ":quest_giver_troop")],
    "I bring a message from {s11}.", "lord_deliver_message_prisoner",
    [
      #TODO: Add reward
      (call_script, "script_end_quest", "qst_deliver_message_to_prisoner_lord"),
  ]],
  
  [anyone,"lord_deliver_message_prisoner", [], "Can it be true? " +
    "Oh, thank you kindly, {playername}! You have brought hope and some small ray of light to these bleak walls. " +
    "Perhaps one day I will be able to repay you.", "lord_deliver_message_prisoner_2",[]],
  [anyone|plyr,"lord_deliver_message_prisoner_2", [], " 'Twas the least I could do, {s65}.", "lord_deliver_message_prisoner_2a",[]],
  [anyone,"lord_deliver_message_prisoner_2a", [], "You've no idea how grateful I am, {playername}. A thousand thanks and more.", "close_window",[]],
  [anyone|plyr,"lord_deliver_message_prisoner_2", [], "Worry not, {s65}. You'll have ample opportunity once you are free again.", "lord_deliver_message_prisoner_2b",[]],
  [anyone,"lord_deliver_message_prisoner_2b", [], "Hah, of course, {playername}. My eternal thanks go with you.", "close_window",[]],
  
  [anyone|plyr,"lord_talk", [#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 1),
      (troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (check_quest_active,"qst_rescue_lord_by_replace"),
      (quest_slot_eq, "qst_rescue_lord_by_replace", slot_quest_target_troop, "$g_talk_troop"),
      (neg|check_quest_succeeded, "qst_rescue_lord_by_replace")],
    "Fear not, I am here to rescue you.", "lord_rescue_by_replace_offer",[]],
  
  [anyone,"lord_rescue_by_replace_offer", [],
    "By God, are you serious? What is your plan?", "lord_rescue_by_replace_offer_2",[]],
  [anyone|plyr,"lord_rescue_by_replace_offer_2", [],
    "A simple ruse, {s65}. If we exchange garments, I shall take your place here in prison, " +
    "while you make your escape disguised as myself. " +
    "I paid the guards a handsome bribe, with which I am sure they have already purchased half the wine stocks of the nearest tavern. " +
    "With some luck they'll soon get so drunk they'd have trouble " +
    "recognising their own mothers, let alone telling one of us from the other. " +
    "At least not until you are safely away.", "lord_rescue_by_replace_offer_3",[]],
  [anyone,"lord_rescue_by_replace_offer_3", [],
    "Hmm, it might just work... But what of you, my {friend/lady}? The guards won't take kindly to this trickery. " +
    "You may end up spending some time in this cell yourself.", "lord_rescue_by_replace_offer_4",[]],
  [anyone|plyr,"lord_rescue_by_replace_offer_4", [],
    "Not to worry, {s65}. The place is already starting to grow on me.", "lord_rescue_by_replace_offer_5a",[]],
  [anyone|plyr,"lord_rescue_by_replace_offer_4", [],
    "I shall be fine as long there is an ample reward waiting at the end.", "lord_rescue_by_replace_offer_5b",[]],
  [anyone,"lord_rescue_by_replace_offer_5a",[],
    "You are a brave soul indeed. I won't forget this.", "lord_rescue_by_replace_offer_6",[]],
  [anyone,"lord_rescue_by_replace_offer_5b",[],
    "Of course, my {friend/lady}, of course! Come to me when you have regained your freedom, " +
    "and perhaps I shall be able to repay the debt I owe you.", "lord_rescue_by_replace_offer_6",[]],
  [anyone|plyr,"lord_rescue_by_replace_offer_6",[],
    "Quickly, {s65}, let us change garments. It is past time you were away from here.", "close_window",
    [(call_script, "script_succeed_quest", "qst_rescue_lord_by_replace"),
      (quest_get_slot, ":quest_target_troop", "qst_rescue_lord_by_replace", slot_quest_target_troop),
      (quest_get_slot, ":quest_target_center", "qst_rescue_lord_by_replace", slot_quest_target_center),
      (party_remove_prisoners, ":quest_target_center", ":quest_target_troop", 1),
      #(troop_set_slot, ":quest_target_troop", slot_troop_is_prisoner, 0),
      (troop_set_slot, ":quest_target_troop", slot_troop_prisoner_of_party, -1),
      (assign, "$auto_menu", -1),
      (assign, "$capturer_party", "$g_encountered_party"),
      (jump_to_menu, "mnu_captivity_rescue_lord_taken_prisoner"),
      (finish_mission),
  ]],
  
  ##
  ##  [anyone|plyr,"lord_talk", [(check_quest_active, "qst_deliver_message_to_lover"),
  ##                             (troop_get_slot, ":cur_daughter", "$g_talk_troop", slot_troop_daughter),
  ##                             (quest_slot_eq, "qst_deliver_message_to_lover", slot_quest_target_troop, ":cur_daughter"),
  ##                             (quest_get_slot, ":troop_no", "qst_deliver_message_to_lover", slot_quest_giver_troop),
  ##                             (str_store_troop_name, 3, ":troop_no"),
  ##                             (str_store_troop_name, 4, ":cur_daughter")],
  ##   "My lord, {s3} asked me to give this letter to your daughter, but I think you should read it first.", "lord_deliver_message_to_lover_tell_father",[]],
  ##
  ##  [anyone,"lord_deliver_message_to_lover_tell_father", [],
  ##   "That swine called {s3} is trying to approach my daughter eh? You have made the right decision by bringing this letter to me. I'll have a long talk with {s4} about it.", "lord_pretalk",
  ##   [(add_xp_as_reward, 200),
  ##    (call_script, "script_troop_add_gold", "trp_player", 1000),
  ##    (quest_get_slot, ":quest_giver", "qst_deliver_message_to_lover", slot_quest_giver_troop),
  ##    (quest_get_slot, ":target_troop", "qst_deliver_message_to_lover", slot_quest_target_troop),
  ##    (call_script, "script_change_player_relation_with_troop", ":quest_giver", -20),
  ##    (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 10),
  ##    (call_script, "script_change_player_relation_with_troop", ":target_troop", -10),
  ##    (call_script, "script_end_quest", "qst_deliver_message_to_lover"),
  ##    #Adding betrayal to the quest giver
  ##    (troop_set_slot, ":quest_giver", slot_troop_last_quest, "qst_deliver_message_to_lover"),
  ##    (troop_set_slot, ":quest_giver", slot_troop_last_quest_betrayed, 1)]],
  ##
  ##
  ##### TODO: QUESTS COMMENT OUT END
  
  
  
  ##  [anyone|plyr,"lord_talk", [(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                             (ge,"$g_talk_troop_faction_relation",0),
  ##                             (party_slot_eq, "$g_encountered_party", slot_party_type, spt_castle),
  ##                             (party_slot_eq, "$g_encountered_party", slot_town_lord, "$g_talk_troop"),
  ##                             (eq, "$g_permitted_to_center",0),
  ##                             (party_get_num_companions, reg7, "p_main_party"),
  ##                             (val_sub, reg7, 1),
  ##                             ],
  ##   "{reg7?Me and my men:I} need shelter for the night my lord. Can we rest in your castle for a while?", "lord_castle_let_in",[]],
  ##
  ##  [anyone, "lord_castle_let_in", [(lt,"$g_talk_troop_relation",-10)],
  ##   "What? Do I look like I am running an inn here? I have no place here for {reg7?you and your lot:you}. Now get off my lands...", "close_window",[(assign, "$g_permitted_to_center",1)]],
  ##  [anyone, "lord_castle_let_in", [(lt,"$g_talk_troop_relation",2), (lt, "$g_talk_troop_faction_relation", 10),(assign, reg6, 100)],
  ##   "I'll give you shelter if you pay a toll of {reg6} denars.", "lord_castle_let_in_toll",[]],
  ##  [anyone|plyr,"lord_castle_let_in_toll", [(store_troop_gold, ":gold", "trp_player"),(gt,":gold",reg6)], "Of course sir. I'll pay the toll.", "lord_castle_let_in_toll_pay",
  ##   [(troop_remove_gold, "trp_player",reg6)]],
  ##  [anyone, "lord_castle_let_in_toll_pay", [(str_store_party_name, s1, "$g_encountered_party")],
  ##   "Then you are welcome to {s1}.", "close_window",[(assign, "$g_permitted_to_center",1),(jump_to_menu, "mnu_town")]],
  ##  [anyone|plyr,"lord_castle_let_in_toll", [], "I can't pay that sum sir.", "lord_castle_let_in_toll_nopay",[]],
  ##  [anyone,"lord_castle_let_in_toll_nopay", [], "Then you are out of luck, I guess.", "lord_pretalk",[]],
  ##
  ##  [anyone, "lord_castle_let_in", [(str_store_party_name, s1, "$g_encountered_party")],
  ##   "Of course {playername}. You are welcome here. You may rest at {s1} as long as you wish.", "close_window",[(assign, "$g_permitted_to_center",1)]],
  
  [anyone|plyr,"lord_talk", [#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (eq, "$players_oath_renounced_against_kingdom", "$g_talk_troop_faction"),
      (str_store_faction_name, s4, "$g_talk_troop_faction"),],
    "{s66}, I wish to restore my old oath to {s4}.", "lord_ask_pardon_after_oath_renounced",[]],
  
  [anyone,"lord_ask_pardon_after_oath_renounced",
    [
      (faction_get_slot, ":faction_leader", "$g_talk_troop_faction", slot_faction_leader),
      (neq, ":faction_leader", "$g_talk_troop"),
      (str_store_troop_name, s4, ":faction_leader"),
      ], "That is too great a matter for me to decide, {playername}. You should seek out {s4}. Such clemency is his alone to grant or deny.", "lord_pretalk",[]],
  
  [anyone,"lord_ask_pardon_after_oath_renounced",
    [
      (assign, ":num_centers_captured_by_player"),
      (try_for_range, ":cur_center", walled_centers_begin, walled_centers_end),
        (store_faction_of_party, ":cur_center_faction", ":cur_center"),
        (eq, ":cur_center_faction", "fac_player_supporters_faction"),
        (party_slot_eq, ":cur_center", slot_center_faction_when_oath_renounced, "$g_talk_troop_faction"),
        (val_add, ":num_centers_captured_by_player", 1),
      (try_end),
      (store_mul, ":peace_score", ":num_centers_captured_by_player", 500),
      (store_current_hours, ":cur_hours"),
      (val_sub, ":cur_hours", "$players_oath_renounced_begin_time"),
      (val_add, ":peace_score", ":cur_hours"),
      (try_begin),
        (gt, ":peace_score", 800),
        #Do not agree to give any centers but agree to make peace
        (assign, ":given_center", -1),
        (try_begin),
          (gt, ":peace_score", 1500),
          (try_begin),
            #Agree to give one center
            (eq, "$players_oath_renounced_given_center", 0),
            (store_random_in_range, ":given_center", 0, ":num_centers_captured_by_player"),
          (try_end),
        (else_try),
          (assign, "$players_oath_renounced_given_center", 0),
        (try_end),
        (assign, ":num_centers_written", 0),
        (try_for_range, ":cur_center", walled_centers_begin, walled_centers_end),
          (store_faction_of_party, ":cur_center_faction", ":cur_center"),
          (eq, ":cur_center_faction", "fac_player_supporters_faction"),
          (party_slot_eq, ":cur_center", slot_center_faction_when_oath_renounced, "$g_talk_troop_faction"),
          (try_begin),
            (eq, ":given_center", 0),
            (assign, "$players_oath_renounced_given_center", ":cur_center"),
          (else_try),
            (neq, "$players_oath_renounced_given_center", ":cur_center"),
            (try_begin),
              (eq, ":num_centers_written", 0),
              (str_store_party_name, s17, ":cur_center"),
            (else_try),
              (eq, ":num_centers_written", 1),
              (str_store_party_name, s16, ":cur_center"),
              (str_store_string, s17, "@{s16} and {s17}"),
            (else_try),
              (str_store_party_name, s16, ":cur_center"),
              (str_store_string, s17, "@{!}{s16}, {s17}"),
            (try_end),
            (val_add, ":num_centers_written", 1),
          (try_end),
          (val_sub, ":given_center", 1),
        (try_end),
        (try_begin),
          (eq, ":num_centers_written", 0),#white peace
          (str_store_string, s11, "@Very well, I will accept you back into my ranks, if you're ready to swear your solemn oath once more."),
          (assign, "$players_oath_renounced_terms_state", 1),
        (else_try),
          (str_store_string, s11, "@A pardon will only be possible if you are willing to cede {s17} to me. Do you agree my terms?"),
          (assign, "$players_oath_renounced_terms_state", 2),
        (try_end),
      (else_try),
        #Do not agree to make peace
        (str_store_string, s11, "@No. There is no chance of peace between us, I am not interested."),
        (assign, "$players_oath_renounced_terms_state", 0),
      (try_end),
      ], "{s11}.", "lord_ask_pardon_terms",[]],
  
  
  [anyone|plyr,"lord_ask_pardon_terms",
    [(eq, "$players_oath_renounced_terms_state", 0),
    ],
    "As you like, {s65}. I will accept your judgment.", "lord_pretalk",[]],
  [anyone|plyr,"lord_ask_pardon_terms",
    [(eq, "$players_oath_renounced_terms_state", 0),
    ],
    "A shame, {s65}. A shame.", "lord_pretalk",[]],
  [anyone|plyr,"lord_ask_pardon_terms",
    [(eq, "$players_oath_renounced_terms_state", 0),
    ],
    "Very well, go and die without me.", "lord_pretalk",[]],
  
  [anyone|plyr,"lord_ask_pardon_terms",
    [(eq, "$players_oath_renounced_terms_state", 1),
    ],
    "Aye, I am ready.", "lord_ask_pardon_after_renounce_peace",[]],
  
  [anyone|plyr,"lord_ask_pardon_terms",
    [(eq, "$players_oath_renounced_terms_state", 1),
    ],
    "On second thought, no. I don't wish to be in your service again.", "lord_ask_pardon_terms_rejected",[]],
  
  [anyone|plyr,"lord_ask_pardon_terms",
    [(eq, "$players_oath_renounced_terms_state", 2),
    ],
    "Aye, I agree to those terms.", "lord_ask_pardon_after_renounce_peace",[]],
  
  [anyone|plyr,"lord_ask_pardon_terms",
    [(eq, "$players_oath_renounced_terms_state", 2),
    ],
    "That is too high a price, {s65}. I must decline.", "lord_ask_pardon_terms_rejected",[]],
  
  
  [anyone,"lord_ask_pardon_after_renounce_peace",
    [], "Excellent. Though you strayed from us, {playername}, it gladdens all our hearts that you have found your way back to the right path. I hereby restore your homage to me. Rise once more as an honoured {man/warrior} in my service.", "lord_pretalk",
    [
      (try_for_range, ":cur_center", walled_centers_begin, walled_centers_end),
        (store_faction_of_party, ":cur_center_faction", ":cur_center"),
        (eq, ":cur_center_faction", "fac_player_supporters_faction"),
        (party_slot_eq, ":cur_center", slot_center_faction_when_oath_renounced, "$g_talk_troop_faction"),
        (neq, ":cur_center", "$players_oath_renounced_given_center"),
        (call_script, "script_give_center_to_faction", ":cur_center", "$g_talk_troop_faction"),
      (try_end),
      
      (call_script, "script_player_join_faction", "$g_talk_troop_faction"),
      (assign, "$player_has_homage", 1),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 3),
  ]],
  
  
  [anyone,"lord_ask_pardon_terms_rejected",
    [], "Then get out of my sight, traitor! Begone with you, and do not come back!", "close_window",
    [
      (assign, "$g_leave_encounter", 1),
      #TODO: Add relation drop. $players_oath_renounced_begin_time can also be reset to current time for worse conditions in the next conversation.
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -5),
  ]],
  
  
  [anyone|plyr,"lord_talk", [#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (lt, "$g_talk_troop_faction_relation", 0),
      
      (store_relation, ":players_kingdom_relation", "$g_talk_troop_faction", "$players_kingdom"),
      
      (this_or_next|ge, ":players_kingdom_relation", 0),
      (this_or_next|eq, "$players_kingdom", 0),
      (eq, "$players_kingdom", "fac_player_supporters_faction"),
      
      
      (neq, "$players_oath_renounced_against_kingdom", "$g_talk_troop_faction"),
      (assign, ":continue", 1),
      (try_begin),
        (gt, "$supported_pretender", 0),
        (eq, "$supported_pretender_old_faction", "$g_talk_troop_faction"),
        (assign, ":continue", 0),
      (try_end),
      (eq, ":continue", 1),
      (is_between, "$g_talk_troop_faction", kingdoms_begin, kingdoms_end),
      (str_store_faction_name, s4, "$g_talk_troop_faction"),],
    "I wish to make peace with the {s4}.", "lord_ask_pardon",[]],
  
  [anyone,"lord_ask_pardon", [(lt, "$g_talk_troop_relation", -10)], "Do you indeed, {playername}? Then go and trip on your sword. Give us all peace.", "lord_pretalk",[]],
  
  [anyone,"lord_ask_pardon",
    [
      (faction_slot_eq, "fac_player_supporters_faction", slot_faction_leader, "trp_player"),
      (assign, ":has_center", 0),
      (try_for_range, ":cur_center", centers_begin, centers_end),
        (store_faction_of_party, ":cur_center_faction", ":cur_center"),
        (eq, ":cur_center_faction", "fac_player_supporters_faction"),
        (assign, ":has_center", 1),
      (try_end),
      (eq, ":has_center", 1),
      (lt, "$player_right_to_rule", 10),
      
    ], "{playername}, you are a {lord/lady} without a master, holding lands in your name, with only the barest scrap of a claim to legitimacy. " +
    "No king in France would accept a lasting peace with you.", "lord_pretalk",[]],
  
  [anyone,"lord_ask_pardon",
    [
      (assign, ":has_center", 0),
      (try_for_range, ":cur_center", centers_begin, centers_end),
        (store_faction_of_party, ":cur_center_faction", ":cur_center"),
        (eq, ":cur_center_faction", "fac_player_supporters_faction"),
        (assign, ":has_center", 1),
      (try_end),
      (eq, ":has_center", 1),
      (encountered_party_is_attacker),
      
      ], "Make peace when I have you at an advantage? I think not.", "lord_pretalk",[]],
  
  #If the player faction is active
  [anyone,"lord_ask_pardon",
    [
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
      
      (assign, ":has_center", 0),
      (try_for_range, ":cur_center", centers_begin, centers_end),
        (store_faction_of_party, ":cur_center_faction", ":cur_center"),
        (eq, ":cur_center_faction", "fac_player_supporters_faction"),
        (assign, ":has_center", 1),
      (try_end),
      (eq, ":has_center", 1),
      
      (call_script, "script_npc_decision_checklist_peace_or_war", "$g_encountered_party_faction", "fac_player_supporters_faction", "trp_player"),
      (lt, reg0, 0),
      ], "I do not see it as being in my current interest to make peace.", "lord_pretalk",[]],
  
  [anyone,"lord_ask_pardon",
    [
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
      (assign, ":has_center", 0),
      (try_for_range, ":cur_center", centers_begin, centers_end),
        (store_faction_of_party, ":cur_center_faction", ":cur_center"),
        (eq, ":cur_center_faction", "fac_player_supporters_faction"),
        (assign, ":has_center", 1),
      (try_end),
      (eq, ":has_center", 1),
      ], "Yes... I am weary of fighting you. I could offer you a truce of forty days. If you keep your word and do not molest my lands and subjects, we may talk again...", "lord_truce_offer",[]],
  
  [anyone|plyr,"lord_truce_offer",
    [
      (call_script, "script_diplomacy_start_peace_between_kingdoms", "$g_encountered_party_faction", "$players_kingdom", 1),
      ], "I accept. Let us stop making war upon each other, for the time being anyway", "close_window",[]],
  
  [anyone|plyr,"lord_truce_offer",
    [], "On second thought, such an accord would not be in my interests.", "lord_pretalk",[]],
  
  [anyone,"lord_ask_pardon", [
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
      (faction_slot_eq, "fac_player_supporters_faction", slot_faction_leader, "trp_player"),
      (assign, ":has_center", 0),
      (try_for_range, ":cur_center", centers_begin, centers_end),
        (store_faction_of_party, ":cur_center_faction", ":cur_center"),
        (eq, ":cur_center_faction", "fac_player_supporters_faction"),
        (assign, ":has_center", 1),
      (try_end),
      (eq, ":has_center", 0),
      
      (store_sub, ":hostility", 4, "$g_talk_troop_faction_relation"),
      (val_mul, ":hostility", ":hostility"), #square it
      (store_mul, reg16, ":hostility", 10),
      (str_store_faction_name, s4, "$g_talk_troop_faction"),
    ], "Hmm. I could use my considerable influence to arrange a pardon for you, {playername}, " +
    "but there are some who see you as an enemy and will not be satisfied unless you pay tribute. " +
    "All in all, you'd need to bring no less than {reg16} denars to make any friends in {s4}.", "lord_ask_pardon_2",[]],
  
  [anyone,"lord_ask_pardon",
    [
      (faction_get_slot, ":faction_leader", "$g_talk_troop_faction", slot_faction_leader),
      (neq, "$g_talk_troop", ":faction_leader"),
      (str_store_troop_name, s7, ":faction_leader"),
      ], "I am in no position to offer you anything. You must speak to {s7}.", "lord_pretalk",[]],
  
  [anyone,"lord_ask_pardon",
    [
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
      (neg|faction_slot_ge, "fac_player_supporters_faction", slot_faction_leader, 1),
      
      (store_sub, ":hostility", 4, "$g_talk_troop_faction_relation"),
      (val_mul, ":hostility", ":hostility"), #square it
      (store_mul, reg16, ":hostility", 10),
      
      (str_store_faction_name, s4, "$g_talk_troop_faction"),
      ], "Yes... I have bigger worries than you or your followers. However, you have wronged my subjects, and wrongs demand compensation. For the sume of {reg16} denars, I suppose that I could agree to grant you a pardon. What do you say?", "lord_ask_pardon_2",[
  ]],
  
  [anyone,"lord_ask_pardon",
    [
      ], "I am sorry. I am in no position to offer you a pardon", "lord_pretalk",[
  ]],
  
  
  
  
  
  [anyone|plyr,"lord_ask_pardon_2", [(store_troop_gold, ":gold","trp_player"),(ge, ":gold", reg16)], "I have the money here. {reg16} denars.", "lord_ask_pardon_tribue_accept",[]],
  [anyone|plyr,"lord_ask_pardon_2", [], "I fear I cannot pay that much.", "lord_ask_pardon_tribue_deny",[]],
  
  [anyone,"lord_ask_pardon_tribue_accept", [
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
    ], "Excellent, {playername}. " +
    "I will use this to make amends to those you have wronged, and I will let it be known that you are no longer an enemy of the {s4}.", "close_window",
    [
      (troop_remove_gold, "trp_player", reg16),
      (store_relation, ":players_kingdom_relation", "$g_talk_troop_faction", "$players_kingdom"),
      
      (try_begin),
        (this_or_next|eq, "$players_kingdom", 0),
        (ge, ":players_kingdom_relation", 0),
        (call_script, "script_set_player_relation_with_faction", "$g_talk_troop_faction", 0),
      (try_end),
      (assign,"$g_leave_town_outside",1),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone,"lord_ask_pardon_tribue_accept", [], "Excellent, {playername}. " +
    "I'll use the coin to smooth the feathers of those that can oppose your pardon, and I'm sure that word will soon spread that you are no longer an enemy of {s4}.", "close_window",
    [
      (troop_remove_gold, "trp_player", reg16),
      (store_relation, ":players_kingdom_relation", "$g_talk_troop_faction", "$players_kingdom"),
      
      (try_begin),
        (this_or_next|eq, "$players_kingdom", 0),
        (ge, ":players_kingdom_relation", 0),
        (call_script, "script_set_player_relation_with_faction", "$g_talk_troop_faction", 0),
      (else_try),
        (call_script, "script_diplomacy_start_peace_between_kingdoms", "$g_talk_troop_faction", "$players_kingdom", 1),
      (try_end),
      (assign,"$g_leave_town_outside",1),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone,"lord_ask_pardon_tribue_deny", [], "Then there's nothing I can do for you, {playername}. No silver, no pardon.", "lord_pretalk",[]],
  
  
  # mettre quete roi justze au dessus rpg!
  
  ###################1429DIPLOMACY#######################################################################################################################################
  #!!!!!!! REMETRE EN PLACE :  (val_sub, ":cur_hours", 4), A   72 /  retirer "plus de relation" //???%%666S678JN!!!!!!!!!!!!!!!!!!!!!!!
  
  [anyone|plyr,"lord_talk", [
      (eq, "$g_talk_troop", "trp_kingdom_1_lord"),
      (gt, "$g_talk_troop_effective_relation", 30),
      ##    (ge, "$g_talk_troop_faction_relation", 30),
      # ajoutter temps requis depuis la derniere demande...
      (store_current_hours,":cur_hours"),
      (val_sub, ":cur_hours", 72),# 72 REMETTRE ========================
      (gt, ":cur_hours", "$gamble_last_time"),
    ],
    "Mon seigneur, Puis je vous soumettre mon humble avis a propos d'affaires concernant le Royaume ?", "diplo_roy_start",[]],
  
  
  
  
  [anyone,"diplo_roy_start",
    [
      #segond test relation a 40
      (gt, "$g_talk_troop_effective_relation", 40),
    ],
    "Et bien...soit pourquois pas, je vous écoute de quois s'agit il ?", "diplo_roy_startwin",[]],
  
  
  [anyone,"diplo_roy_start",
    [
      #si test relation a echou?ou laisser comme ca
      
    ],
    "Pour qui vous prennez vous {playername} ? Veillez a rester a vostre place, qui deumeure celle d'un combattant et non d'un consseillé, j'ai bien assez de felons pour m'entourer. Je me suis peut etre fait une mauvaise idée sur vous, ainsi vous estes donc comme les autres...regrettable.", "diplo_roy_startfail",
    [
      #retirer un peut de relation -3
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop", -3),
  ]],
  [anyone|plyr,"diplo_roy_startfail", [], "Ca n'est rien Sire, pardon de vous avoir enuyé avec cela.", "lord_pretalk",[(store_current_hours,":cur_hours"),(assign, "$gamble_last_time", ":cur_hours"),]],
  
  
  
  
  
  [anyone|plyr,"diplo_roy_startwin", [], "A propos des Bourguignons.", "diplo_roy_startwinbrg",[]],#AJOUTTER A LA FIN ! : (store_current_hours,":cur_hours"),
  [anyone|plyr,"diplo_roy_startwin", [], "Au sujet des Anglois.", "diplo_roy_startwinang",[]],#AJOUTTER A LA FIN ! : (store_current_hours,":cur_hours"),
  #rajouter conspiration ici
  [anyone|plyr,"diplo_roy_startwin", [], "Ca n'est rien Sire, pardon de vous avoir enuyé avec cela.", "lord_pretalk",[(store_current_hours,":cur_hours"),(assign, "$gamble_last_time", ":cur_hours"),]],
  
  # # # # # # # # # # # # # # # # # # # #
  
  [anyone|plyr,"diplo_roy_startwinbrg",
    [
      #Si pas deja en guerre
      (store_relation, ":cur_relation", "$g_talk_troop_faction", "fac_kingdom_3"),
      (ge, ":cur_relation", 0),        #(ge, ":relation", -40),
    ],
    "Nous devrions rompre la trève etles attaquer les Bourguignons, sans leur aliés les Anglois n'ont aucune chance. bien entendu, je suis pret a vous soutenire avec mes hommes Monseigneur.", "diplo_roy_startwinbrg3",[]],#AJOUTTER A LA FIN ! : (store_current_hours,":cur_hours"),
  
  [anyone|plyr,"diplo_roy_startwinbrg", [], "Pardonnez moi Sire, mais je doit reconsidérer cette question.", "diplo_roy_startwin",[]],#
  
  
  [anyone,"diplo_roy_startwinbrg3", [], "Rompre la trève dites vous ? n'estes vous seulement pas animé par des ambitions personnelles ?", "win_dialroi_guerre",
    [
  ]],
  
  
  [anyone|plyr,"win_dialroi_guerre", [], "Naturellement non Sire, je m'éforce a oeuvrer pour le bien du Royaume.", "win_dialroi_guerre2",[]],#
  
  
  [anyone,"win_dialroi_guerre2", [], "Soit...Vous n'estes point le premier a me dire cela, et je ne puis hésiter d'avantage. Mais il faudra frapper fort et etre disciplinés me suis je fait comprendre ? les trompettes du jugement dernier vont bientot se faire entendre, je vous suggère de faire bénire les pauvres bougres qui vous servent d'armée d'ici la.", "lord_pretalk",
    [
      (call_script, "script_diplomacy_start_war_between_kingdoms", "$g_talk_troop_faction", "fac_kingdom_3", 1),
      #    (set_relation, "$g_talk_troop_faction", "fac_kingdom_3", -80),
      (store_current_hours,":cur_hours"),(assign, "$gamble_last_time", ":cur_hours"),
  ]],
  
  
  # # # # # # # # # # # # # # # # # # # # #
  
  [anyone|plyr,"diplo_roy_startwinang",
    [
      #Si pas deja en guerre
      (store_relation, ":cur_relation", "$g_talk_troop_faction", "fac_kingdom_2"),
      (ge, ":cur_relation", 0),        #(ge, ":relation", -40),
    ],
    "Nous devrions rompre la trève etles attaquer avant qu'ils ne se rassemblent Sire, je suis pret a vous soutenire avec mes hommes.", "diplo_roy_startwinang3",[]],#AJOUTTER A LA FIN ! :
  
  [anyone|plyr,"diplo_roy_startwinang", [], "Pardonnez moi Sire, mais je doit reconsidérer cette question.", "diplo_roy_startwin",[]],#
  
  
  [anyone,"diplo_roy_startwinang3", [], "Rompre la trève dites vous ? Soit...Vous n'estes point le premier a me dire cela, et je ne puis hésiter d'avantage.Mais il faudra frapper fort et etre disciplinés me suis je fait comprendre ? soyez pret a temps ou vous regretterez vos paroles croyez moi.", "lord_pretalk",
    [
      (call_script, "script_diplomacy_start_war_between_kingdoms", "$g_talk_troop_faction", "fac_kingdom_2", 1),
      # (set_relation, "$g_talk_troop_faction", "fac_kingdom_2", -80),
      (store_current_hours,":cur_hours"),(assign, "$gamble_last_time", ":cur_hours"),
  ]],
  
  
  
  
  
  
  
  
  #(call_script, "script_troop_change_relation_with_troop", "trp_kingdom_1_lord", "trp_kingdom_3_lord", -80),
  
  
  
  
  
  
  
  #####################################################################################################################################
  
  [anyone|plyr,"lord_talk", [(store_partner_quest,":lords_quest"),
      (ge,":lords_quest",0),
    ],
    "About the task you gave me...", "lord_active_mission_1",[]],
  
  # This is done automatically now.
  ##  [anyone|plyr,"lord_talk", [(faction_slot_eq,"$g_talk_troop_faction",slot_faction_leader, "$g_talk_troop"),
  ##                             (eq, "$players_kingdom", "$g_talk_troop_faction"),
  ##                             (eq, "$player_has_homage", 0),
  ##                             (gt, "$mercenary_service_accumulated_pay", 0),
  ##                             ],
  ##   "{s67}, I humbly request the weekly payment for my service.", "lord_pay_mercenary",[]],
  ##
  ##  [anyone,"lord_pay_mercenary", [(assign, reg8, "$mercenary_service_accumulated_pay")],
  ##   "Hmm, let me see... According to my ledgers, we owe you {reg8} denars for your work. Here you are.", "lord_pay_mercenary_2",
  ##   [(troop_add_gold, "trp_player", "$mercenary_service_accumulated_pay"),
  ##    (assign, "$mercenary_service_accumulated_pay", 0)]],
  ##
  ##  [anyone|plyr,"lord_pay_mercenary_2", [], "Thank you, sir.", "lord_pretalk", []],
  
  [anyone|plyr,"lord_talk", [#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop"),
    ],
    "Let us discuss matters related to our household.", "lord_switch_to_spouse",[]],
  
  [anyone,"lord_switch_to_spouse", [
      (assign, ":feast_venue", -1),
      (try_begin),
        (is_between, "$g_encountered_party", walled_centers_begin, walled_centers_end),
        (this_or_next|party_slot_eq, "$g_encountered_party", slot_town_lord, "trp_player"),
        (party_slot_eq, "$g_encountered_party", slot_town_lord, "$g_talk_troop"),
        (assign, ":feast_venue", "$g_encountered_party"),
      (else_try),
        (try_for_range, ":center", walled_centers_begin, walled_centers_end),
          (eq, ":feast_venue", -1),
          (this_or_next|party_slot_eq, ":center", slot_town_lord, "trp_player"),
          (party_slot_eq, ":center", slot_town_lord, "$g_talk_troop"),
          (assign, ":feast_venue", ":center"),
        (try_end),
      (else_try),
        (is_between, "$g_encountered_party", walled_centers_begin, walled_centers_end),
        (assign, ":feast_venue", "$g_encountered_party"),
      (try_end),
      (gt, ":feast_venue", -1),
    ],
    "Let us wait until we are in a hall, my wife, as it is difficult to deal with household inventories and such matters in the field.", "lord_pretalk",[]],
  
  [anyone,"lord_switch_to_spouse", [],
    "Certainly, my wife", "spouse_talk",[]],
  
  
  
  
  [anyone|plyr,"lord_talk", [#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (ge, "$g_talk_troop_faction_relation", 0),
      (store_partner_quest,":lords_quest"),
      (lt,":lords_quest",0),
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "trp_player"),
      (neg|troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop"),
      #                             (eq,"$g_talk_troop_faction","$players_kingdom")
      (eq,  "$freelancer_state", 0), #Freelancer
    ],
    "Do you have any tasks for me?", "lord_request_mission_ask",[]],
  
  [anyone|plyr,"lord_talk",
    [
      (eq, "$g_talk_troop_faction", "$players_kingdom"),
      (eq, "$player_has_homage", 1),
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "trp_player"),
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
      
    ],
    "Do you think we can work together to advance our standings in this realm?", "combined_political_quests",[
      (call_script, "script_get_political_quest", "$g_talk_troop"),
      (assign, "$political_quest_found", reg0),
      (assign, "$political_quest_target_troop", reg1),
      (assign, "$political_quest_object_troop", reg2),
  ]],
  
  [anyone,"combined_political_quests", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
      (lt, "$g_talk_troop_effective_relation", -5),
    ],
    "I do not imagine that you and I have many mutual interests.", "lord_pretalk",[
  ]],
  
  
  [anyone,"combined_political_quests", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
      (gt, "$political_quest_found", 0),
      (assign, ":continue", 1),
      (try_begin),
        (call_script, "script_cf_troop_can_intrigue", "$g_talk_troop", 1),
        (assign, ":continue", 0),
      (try_end),
      (eq, ":continue", 1),
    ],
    "Hmm.. Perhaps we can discuss this matter in a more private setting, at a later date.", "lord_pretalk",[
  ]],
  
  [anyone,"combined_political_quests", [
      (this_or_next|eq, "$political_quest_found", "qst_intrigue_against_lord"),
      (eq, "$political_quest_found", "qst_denounce_lord"),
      
      (troop_slot_ge, "trp_player", slot_troop_controversy, 30),
      
    ],
    "Hmm.. I do have an idea, but it would require you that you be free of controversy. If you were to wait some time without getting into any arguments with the other lords of our realm, perhaps we could proceed further.", "lord_pretalk",[
  ]],
  
  
  [anyone|plyr,"lord_talk", [(le,"$talk_context", tc_party_encounter),
      (faction_slot_eq, "$players_kingdom", slot_faction_leader, "$g_talk_troop"),
      (faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"),
    ],
    "I wish to resign the marshalship", "lord_ask_resign_marshalship",[]],
  
  [anyone,"lord_ask_resign_marshalship", [],
    "So be it. I shall have to find someone else.", "lord_pretalk",[
      (assign, ":faction_no", "$players_kingdom"),
      (faction_set_slot, ":faction_no", slot_faction_political_issue, 1), #Appointment of marshal
      (store_current_hours, ":hours"),
      (val_max, ":hours", 0),
      (faction_set_slot, ":faction_no", slot_faction_political_issue_time, ":hours"), #Appointment of marshal
      
      (faction_get_slot, ":old_marshall", ":faction_no", slot_faction_marshall),
      (try_begin),
        (ge, ":old_marshall", 0),
        (troop_get_slot, ":old_marshall_party", ":old_marshall", slot_troop_leaded_party),
        (party_is_active, ":old_marshall_party"),
        (party_set_marshall, ":old_marshall_party", 0),
      (try_end),
      
      (faction_set_slot, ":faction_no", slot_faction_marshall, -1),
      
      (try_for_range, ":active_npc", active_npcs_begin, active_npcs_end),
        (store_faction_of_troop, ":active_npc_faction", ":active_npc"),
        (eq, ":active_npc_faction", ":faction_no"),
        (troop_set_slot, ":active_npc", slot_troop_stance_on_faction_issue, -1),
      (try_end),
      (try_begin),
        (eq, "$players_kingdom", ":faction_no"),
        (troop_set_slot, "trp_player", slot_troop_stance_on_faction_issue, -1),
      (try_end),
      (call_script, "script_add_notification_menu", "mnu_notification_relieved_as_marshal", 0, 0),
  ]],
  
  
  #1429 vassal
  [anyone|plyr,"lord_talk", [(le,"$talk_context", tc_party_encounter),
      (ge, "$g_talk_troop_faction_relation", 0),
      #(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
      (neq, "$players_kingdom", "$g_talk_troop_faction"),
      (store_partner_quest, ":lords_quest"),
      (neq, ":lords_quest", "qst_join_faction"),
      (eq,  "$freelancer_state", 0), #Freelancer
    ],
    "{s66}, I have come to offer you my sword in vassalage!", "lord_ask_enter_service",[]],###
  
  
  [anyone|plyr,"lord_talk", [(le,"$talk_context", tc_party_encounter),
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
      (eq, "$players_kingdom", "$g_talk_troop_faction"),
      (eq, "$player_has_homage", 0),
      (store_partner_quest, ":lords_quest"),
      (neq, ":lords_quest", "qst_join_faction"),
      (eq,  "$freelancer_state", 0), #Freelancer
    ],
    "{s66}, I wish to become your sworn {man/woman} and fight for your honour.", "lord_ask_enter_service",[]],
  
  [anyone|plyr,"lord_talk", [(le,"$talk_context", tc_party_encounter),
      (ge, "$g_talk_troop_faction_relation", 0),
      #(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
      (eq, "$players_kingdom", "$g_talk_troop_faction"),
      (eq, "$player_has_homage", 1),
    ],
    "{s66}, I wish to be released from my oath to you.", "lord_ask_leave_service",[]],
  
  ##  [anyone|plyr,"lord_talk", [(le,"$talk_context", tc_party_encounter),
  ##                             (ge, "$g_talk_troop_faction_relation", 0),
  ##                             (troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                             (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
  ##                             (eq, "$players_kingdom", 0),
  ##                             (eq,1,0)],
  ##   "TODO2:I want to fight alongside you against your enemies.", "close_window",[]],
  
  [anyone|plyr,"lord_talk", [(eq, 1, 0),(le,"$talk_context", tc_party_encounter),(ge, "$g_talk_troop_faction_relation", 0)],
    "I have an offer for you.", "lord_talk_preoffer",[]],
  
  
  [anyone|plyr,"lord_talk", [(eq, "$g_talk_troop_faction", "fac_player_supporters_faction"),
      #(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
    ],
    "I want to give some troops to you.", "lord_give_troops",[]],
  
  [anyone,"lord_give_troops", [],
    "Well, I could use some good soldiers. Thank you.", "lord_pretalk",
    [
      (change_screen_give_members, "$g_talk_troop_party"),
  ]],
  
  
  
  
  
  [anyone|plyr,"lord_talk",
    [
      (eq, "$g_talk_troop_faction", "$players_kingdom"),
      (faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"),
      #(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
    ],
    "I have a new task for you.", "lord_give_order_ask",[]],
  
  
  [anyone|plyr,"lord_talk",
    [
      (eq, "$g_talk_troop_faction", "$players_kingdom"),
      (neg|faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"),
      #(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
    ],
    "May I suggest a course of action?", "lord_give_suggestion_ask",[]],
  
  
  [anyone,"lord_give_order_ask", [],
    "Yes?", "lord_give_order",[]],
  
  [anyone,"lord_give_suggestion_ask", [
      (faction_slot_eq, "$players_kingdom", slot_faction_leader, "trp_player"),
    ],
    "I will gladly follow your direction, {sire/your Highness}. If you intend to direct an extensive campaign, however, you may also wish to declare yourself marshal, so there is no cause for confusion.", "lord_give_order",[]],
  
  
  [anyone,"lord_give_suggestion_ask", [
      (lt, "$g_talk_troop_effective_relation", 5), #was five
    ],
    "My apologies. I don't know you well enough to take your advice.", "lord_pretalk",[]],
  
  [anyone,"lord_give_suggestion_ask", [
    ],
    "What is it?", "lord_give_order",[
  ]],
  
  [anyone|plyr,"lord_give_order", [
      (faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"),
    ],
    "Follow me.", "lord_give_order_answer",
    [
      (assign, "$temp", spai_accompanying_army),
      (assign, "$temp_2", "p_main_party"),
      
      (store_current_hours, ":hours"),
      (party_set_slot, "$g_talk_troop_party", slot_party_following_orders_of_troop, "trp_kingdom_heroes_including_player_begin"),
      (party_set_slot, "$g_talk_troop_party", slot_party_orders_type, "$temp"),
      (party_set_slot, "$g_talk_troop_party", slot_party_orders_object, "$temp_2"),
      (party_set_slot, "$g_talk_troop_party", slot_party_orders_time, ":hours"),
  ]],
  
  [anyone|plyr,"lord_give_order", [
      (neg|faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"),
    ],
    "Will you follow me? I have a plan...", "lord_give_order_answer",
    [
      (assign, "$temp", spai_accompanying_army),
      (assign, "$temp_2", "p_main_party"),
      
      (store_current_hours, ":hours"),
      (party_set_slot, "$g_talk_troop_party", slot_party_following_orders_of_troop, "trp_kingdom_heroes_including_player_begin"),
      (party_set_slot, "$g_talk_troop_party", slot_party_orders_type, "$temp"),
      (party_set_slot, "$g_talk_troop_party", slot_party_orders_object, "$temp_2"),
      (party_set_slot, "$g_talk_troop_party", slot_party_orders_time, ":hours"),
  ]],
  
  [anyone|plyr,"lord_give_order", [
      (faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"),
      
    ],
    "Go to...", "lord_give_order_details_ask",
    [
      (assign, "$temp", spai_holding_center),
  ]],
  
  
  [anyone|plyr,"lord_give_order", [
      (faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"),
      
    ],
    "Raid around the village of...", "lord_give_order_details_ask",
    [
      (assign, "$temp", spai_raiding_around_center),
  ]],
  
  [anyone|plyr,"lord_give_order", [
      (faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"),
      
    ],
    "Patrol around...", "lord_give_order_details_ask",
    [
      (assign, "$temp", spai_patrolling_around_center),
  ]],
  
  #only as suggestion
  [anyone|plyr,"lord_give_order", [
      (party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_besieging_center),
      (party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
      (party_slot_eq, ":ai_object", slot_center_is_besieged_by, "$g_talk_troop_party"),
      (party_slot_eq, ":ai_object", slot_village_state, svs_under_siege),
      (str_store_party_name, s11, ":ai_object"),
    ],
    "Together, you and I can take {s11}. You should assault immediately...", "lord_give_order_assault",
    [
      #for this one and another one, if the $g_talk_troop is a _t
      #     (assign, "$temp", spai_patrolling_around_center),
  ]],
  
  #only as suggestion
  [anyone|plyr,"lord_give_order", [
      (neg|faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"), #not an order,  only a suggestion
      
    ],
    "We are under attack, but the enemy can be repulsed. You should ride towards...", "lord_give_order_details_ask",
    [
      (assign, "$temp", spai_patrolling_around_center),
  ]],
  
  #only as suggestion
  [anyone|plyr,"lord_give_order", [
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_marshall, "$g_talk_troop"),
      
    ],
    "We are under attack, but the enemy can be repulsed. You should assemble the army and march to...", "lord_give_order_details_ask",
    [
      (assign, "$temp", spai_patrolling_around_center),
  ]],
  
  
  [anyone,"lord_give_order_assault", [
      (party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
      (party_get_slot, ":besieging_party", ":ai_object", slot_center_is_besieged_by),
      (neq, ":besieging_party", "$g_talk_troop_party"),
      (party_stack_get_troop_id, ":siege_commander", ":besieging_party", 0),
      (str_store_troop_name, s4, ":siege_commander"),
      (troop_get_type, reg4, ":siege_commander"),
    ],
    "{s4} is directing this siege. I suggest you speak to {reg4?her:him}", "lord_pretalk",
    []],
  
  
  [anyone,"lord_give_order_assault", [
      (party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
      (party_get_slot, ":siege_begun", ":ai_object", slot_center_siege_begin_hours),
      (store_current_hours, ":cur_hour"),
      (store_sub, ":hours_of_siege", ":cur_hour", ":siege_begun"),
      
      (try_begin),
        (assign, ":hours_required", 9),
      (try_end),
      (val_sub, ":hours_required", ":hours_of_siege"),
      (gt, ":hours_required", 0),
      (try_begin),
        (gt, ":hours_required", 1),
        (assign, reg3, ":hours_required"),
        (str_store_string, s11, "str_reg3_hours"),
      (else_try),
        (str_store_string, s11, "str_hour"),
      (try_end),
    ],
    "Our preparations are not yet ready. We need another {s11}", "lord_pretalk",
    [
  ]],
  
  
  [anyone,"lord_give_order_assault", [
    ],
    "Very well -- to the walls!", "close_window",
    [
      (party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
      (call_script, "script_begin_assault_on_center", ":ai_object"),
      
      (party_set_slot, "$g_talk_troop_party", slot_party_under_player_suggestion, spai_besieging_center),
      (assign, "$g_leave_encounter", 1),
      
  ]],
  
  
  
  
  #only as suggestion
  [anyone|plyr,"lord_give_order", [
      (neg|faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"), #not an order,  only a suggestion
    ],
    "There is a fortress which can easily be taken. Go to..", "lord_give_order_details_ask",
    [
      (assign, "$temp", spai_besieging_center),
  ]],
  
  [anyone|plyr,"lord_give_order", [
      #    (neg|faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"),
    ],
    "The enemy is coming in force. Flee in the direction of...", "lord_give_order_details_ask",
    [
      (assign, "$temp", spai_retreating_to_center),
  ]],
  
  
  
  
  
  [anyone|plyr,"lord_give_order",
    [
      (faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"),
      #    (neg|troop_slot_eq, "$g_talk_troop", slot_troop_player_order_state, spai_undefined),
    ],
    "I won't need you for some time. You are free to do as you like.", "lord_give_order_stop",
    []],
  
  [anyone|plyr,"lord_give_order",
    [
      (neg|faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"),
      (party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_accompanying_army),
      (party_slot_eq, "$g_talk_troop_party", slot_party_ai_object, "p_main_party"),
    ],
    "You no longer need to accompany me.", "lord_give_order_stop",
    []],
  
  
  
  [anyone|plyr,"lord_give_order", [],
    "Never mind.", "lord_pretalk",
    []],
  
  
  [anyone,"lord_give_order_details_ask", [
      (neg|faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"),
      (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_martial),
      (eq, "$temp", spai_retreating_to_center),
      
    ],
    "It is not my way to turn tail and run, without even laying eyes on the enemy.", "lord_pretalk",[]],
  
  [anyone,"lord_give_order_details_ask", [
      (neg|faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"),
      (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_debauched),
      (eq, "$temp", spai_besieging_center),
      
    ],
    "You want me to shed my blood outside a fortress while others stand by and watch? I think not.", "lord_pretalk",[]],
  
  [anyone,"lord_give_order_details_ask", [],
    "Where?", "lord_give_order_details",[]],
  
  [anyone|plyr|repeat_for_parties, "lord_give_order_details",
    [
      (store_repeat_object, ":party_no"),
      (store_faction_of_party, ":party_faction", ":party_no"),
      (store_relation, ":relation", ":party_faction", "$players_kingdom"),
      (assign, ":continue", 0),
      (try_begin),
        (this_or_next|eq, "$temp", spai_retreating_to_center),
        (eq, "$temp", spai_holding_center),
        (try_begin),
          (this_or_next|party_slot_eq, ":party_no", slot_party_type, spt_castle),
          (party_slot_eq, ":party_no", slot_party_type, spt_town),
          (eq, ":party_faction", "$players_kingdom"),
          (assign, ":continue", 1),
        (try_end),
      (else_try),
        (eq, "$temp", spai_raiding_around_center),
        (try_begin),
          (party_slot_eq, ":party_no", slot_party_type, spt_village),
          (lt, ":relation", 0),
          (assign, ":continue", 1),
        (try_end),
      (else_try),
        (eq, "$temp", spai_besieging_center),
        (try_begin),
          (this_or_next|party_slot_eq, ":party_no", slot_party_type, spt_castle),
          (party_slot_eq, ":party_no", slot_party_type, spt_town),
          (party_slot_eq, ":party_no", slot_center_is_besieged_by, -1),
          (lt, ":relation", 0),
          (assign, ":continue", 1),
        (try_end),
      (else_try),
        (eq, "$temp", spai_patrolling_around_center),
        (try_begin),
          (eq, ":party_faction", "$players_kingdom"),
          (is_between, ":party_no", centers_begin, centers_end),
          (assign, ":continue", 1),
        (else_try),
          (is_between, ":party_no", centers_begin, centers_end),
          (store_distance_to_party_from_party, ":distance", ":party_no", "p_main_party"),
          (le, ":distance", 25),
          (assign, ":continue", 1),
        (try_end),
      (try_end),
      (eq, ":continue", 1),
      (neq, ":party_no", "$g_encountered_party"),
      (str_store_party_name, s1, ":party_no")],
    "{s1}", "lord_give_order_answer",
    [
      (store_repeat_object, "$temp_2"),
      (store_current_hours, ":hours"),
      (party_set_slot, "$g_talk_troop_party", slot_party_following_orders_of_troop, "trp_kingdom_heroes_including_player_begin"),
      (party_set_slot, "$g_talk_troop_party", slot_party_orders_type, "$temp"),
      (party_set_slot, "$g_talk_troop_party", slot_party_orders_object, "$temp_2"),
      (party_set_slot, "$g_talk_troop_party", slot_party_orders_time, ":hours"),
  ]],
  
  [anyone|plyr, "lord_give_order_details",
    [], "Never mind.", "lord_pretalk",[]],
  
  #Simple stop order
  [anyone,"lord_give_order_stop", [],
    "All right. I will stop here.", "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop_party", slot_party_orders_type, spai_undefined),
      (troop_set_slot, "$g_talk_troop_party", slot_party_orders_object, -1),
      #this is not set above, so should be set here
      (store_current_hours, ":hours"),
      (val_sub, ":hours", 36),
      (val_max, ":hours", 0),
      
      (party_set_slot, "$g_talk_troop_party", slot_party_following_orders_of_troop, "trp_kingdom_heroes_including_player_begin"),
      (party_set_slot, "$g_talk_troop_party", slot_party_orders_type, spai_undefined),
      (party_set_slot, "$g_talk_troop_party", slot_party_orders_object, -1),
      (party_set_slot, "$g_talk_troop_party", slot_party_orders_time, ":hours"),
      
      #same variable as above
      (troop_get_slot, ":party_no", "$g_talk_troop", slot_troop_leaded_party),
      (try_begin),
        (gt, ":party_no", 0),
        (call_script, "script_party_set_ai_state", ":party_no", spai_undefined, -1),
        (party_set_slot, ":party_no", slot_party_commander_party, -1),
      (try_end),
  ]],
  
  [anyone,"lord_give_order_answer",
    [
      (eq, "$temp", spai_accompanying_army),
      
      (neg|faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"),
      (neg|faction_slot_eq, "$players_kingdom", slot_faction_leader, "trp_player"),
      
      (call_script, "script_troop_get_player_relation", "$g_talk_troop"),
      (assign, ":player_relation", reg0),
      
      (troop_get_slot, ":troop_renown", "$g_talk_troop", slot_troop_renown),
      (troop_get_slot, ":player_renown", "trp_player", slot_troop_renown),
      #(val_mul, ":troop_renown", 3),
      #(val_div, ":troop_renown", 4),
      #(this_or_next|lt, ":player_renown", ":troop_renown"),
      #(lt, ":player_relation", 0),
      
      (store_skill_level, ":player_persuasion_level", "skl_persuasion", "trp_player"),
      (store_div, ":player_relation_div_5", ":player_relation", 5),
      (val_min, ":player_relation_div_5", 10),
      (store_add, ":player_persuasion_power", ":player_relation_div_5", ":player_persuasion_level"),
      
      (store_sub, ":needed_lowest_renown", 20, ":player_persuasion_power"),
      (val_mul, ":needed_lowest_renown", ":troop_renown"),
      (val_div, ":needed_lowest_renown", 10),
      
      (this_or_next|lt, ":player_renown", ":needed_lowest_renown"),
      (lt, ":player_relation", 0),
    ],
    "That would hardly be proper. It would be more appropriate for you to follow me instead. Did you have any other ideas?", "lord_give_order",
    [
      (party_set_slot, "$g_talk_troop_party", slot_party_following_orders_of_troop, 0),
      (party_set_slot, "$g_talk_troop_party", slot_party_orders_type, 0),
      (party_set_slot, "$g_talk_troop_party", slot_party_orders_object, 0),
      (party_set_slot, "$g_talk_troop_party", slot_party_orders_time, 0),
  ]],
  
  #More complicated order
  [anyone,"lord_give_order_answer",
    [
      (call_script, "script_npc_decision_checklist_party_ai", "$g_talk_troop"),
      
      (eq, reg0, "$temp"),
      (eq, reg1, "$temp_2"),
      
      (str_clear, s12),
      (try_begin),
        (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_marshall, "trp_player"),
        (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "trp_player"),
        (str_store_string, s12, "str_but_if_this_goes_badly"),
      (try_end),
    ],
    "All right. I will do that.{s12}", "lord_pretalk",
    [
      (call_script, "script_party_set_ai_state", "$g_talk_troop_party", "$temp", "$temp_2"),
      (str_clear, s12),
      (try_begin),
        (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_marshall, "trp_player"),
        (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "trp_player"),
        (str_store_string, s12, "str_but_if_this_goes_badly"),
      (try_end),
      #Set courage and aggressiveness in party_set_ai_astate
      (assign, "$g_leave_encounter", 1),
  ]],
  
  #Recalculated orders do not match
  [anyone,"lord_give_order_answer", [],
    "I am sorry. I need to attend my own business at the moment.", "lord_pretalk",
    [
      (call_script, "script_npc_decision_checklist_party_ai", "$g_talk_troop"),
      (call_script, "script_party_set_ai_state", "$g_talk_troop_party", reg0, reg1),
  ]],
  
  #generic lord comments - must be far down  LORDODA
  [anyone,"lord_start", [],
    "What is it?", "lord_talk",[]],
  
  
  [anyone|plyr,"lord_talk",
    [
      (eq, "$g_talk_troop_faction", "$players_kingdom"),
      (faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"),
      #(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (this_or_next|faction_slot_eq, "$players_kingdom", slot_faction_ai_state, sfai_default),
      (faction_slot_eq, "$players_kingdom", slot_faction_ai_state, sfai_feast),
    ],
    "I want to start a new campaign. Let us assemble the army here.", "lord_give_order_call_to_arms_verify",
    []],
  
  [anyone,"lord_give_order_call_to_arms_verify", [],
    "You wish to summon all lords for a new campaign?", "lord_give_order_call_to_arms_verify_2",[]],
  
  [anyone|plyr,"lord_give_order_call_to_arms_verify_2", [], "Yes. We must gather all our forces before we march on the enemy.", "lord_give_order_call_to_arms",[]],
  [anyone|plyr,"lord_give_order_call_to_arms_verify_2", [], "On second thought, it won't be necessary to summon everyone.", "lord_pretalk",[]],
  
  [anyone,"lord_give_order_call_to_arms",
    [],
    "All right then. I will send messengers and tell everyone to come here.", "lord_pretalk",
    [
      (assign, "$player_marshal_ai_state", sfai_gathering_army),
      (assign, "$player_marshal_ai_object", "p_main_party"),
      (call_script, "script_decide_faction_ai", "$players_kingdom"),
      (assign, "$g_recalculate_ais", 1),
  ]],
  
  [anyone|plyr,"lord_talk",
    [
      (eq, "$g_talk_troop_faction", "$players_kingdom"),
      (faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"),
      #(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (neg|faction_slot_eq, "$players_kingdom", slot_faction_ai_state, sfai_default),
      (neg|faction_slot_eq, "$players_kingdom", slot_faction_ai_state, sfai_feast),
    ],
    "I want to end the campaign and let everyone return home.", "lord_give_order_disband_army_verify", []],
  
  [anyone,"lord_give_order_disband_army_verify", [],
    "You want to end the current campaign and release all lords from duty?", "lord_give_order_disband_army_2",[]],
  
  [anyone|plyr,"lord_give_order_disband_army_2", [], "Yes. We no longer need all our forces here.", "lord_give_order_disband_army",[]],
  [anyone|plyr,"lord_give_order_disband_army_2", [], "On second thought, it will be better to stay together for now.", "lord_pretalk",[]],
  
  [anyone,"lord_give_order_disband_army",
    [],
    "All right. I will let everyone know that they are released from duty.", "lord_pretalk",
    [
      (assign, "$player_marshal_ai_state", sfai_default),
      (assign, "$player_marshal_ai_object", -1),
      (call_script, "script_decide_faction_ai", "$players_kingdom"),
      (assign, "$g_recalculate_ais", 1),
  ]],
  
  [anyone|plyr,"lord_talk", [
      (ge,"$g_encountered_party_relation",0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
    ],
    "I wish to ask you something.", "lord_talk_ask_something",[]],
  
  [anyone,"lord_talk_ask_something", [],
    "Aye? What is it?", "lord_talk_ask_something_2",[]],
  
  [anyone,"lord_talk_ask_something_again", [],
    "Is there anything else?", "lord_talk_ask_something_2",[]],
  
  
  [anyone|plyr,"lord_talk_ask_something_2", [#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
    ],
    "I want to know the location of someone.", "lord_talk_ask_location",[]],
  
  [anyone|plyr,"lord_talk_ask_something_2", [
      (neg|troop_slot_eq, "$g_talk_troop", slot_troop_leaded_party, -1)
    ],
    "What are you and your men doing?", "lord_tell_objective",[
      (party_get_slot, ":ai_behavior", "$g_talk_troop_party", slot_party_ai_state),
      (party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
      
      (try_begin),
        (eq, "$cheat_mode", 1),
        (party_get_ai_initiative, reg4, "$g_talk_troop_party"),
        (party_get_helpfulness, reg5, "$g_talk_troop_party"),
        (display_message, "@{!}DEBUG : Initiative {reg4}, helpfulness {reg5}"),
      (try_end),
      
      (str_clear, s14),
      (str_clear, s15),
      (str_clear, s16),
      
      (try_begin),
        (call_script, "script_npc_decision_checklist_party_ai", "$g_talk_troop"),
        (eq, reg0, ":ai_behavior"),
        (eq, reg1, ":ai_object"),
      (else_try),
        (call_script, "script_party_set_ai_state", "$g_talk_troop_party", reg0, reg1),
        (str_store_string, s14, "str_however_circumstances_have_changed_since_we_made_that_decision_and_i_may_reconsider_shortly_s16"),
        (try_begin),
          (ge, "$cheat_mode", 1),
          (display_message, "@{!}DEBUG -- ai behavior: {reg0}, ai object: {reg1}"),
        (try_end),
      (try_end),
  ]],
  
  [anyone|plyr,"lord_talk_ask_something_2", [
      #(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      
    ],
    "What is the realm doing?", "lord_talk_ask_about_strategy",[]],
  
  [anyone,"lord_talk_ask_about_strategy", [
      (eq, "$players_kingdom", "$g_talk_troop_faction"),
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_marshall, "trp_player"),
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_feast),
    ],
    "You should decide that, as you are the marshal.", "lord_pretalk",[]],
  
  
  
  [anyone|plyr,"lord_talk_ask_something_2", [#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
    ],
    "How goes the war?", "lord_talk_ask_about_war",[]],
  
  #Marriage proposal
  [anyone|plyr,"lord_talk_ask_something_2",[
      (check_quest_active, "qst_formal_marriage_proposal"),
      (neg|check_quest_failed, "qst_formal_marriage_proposal"),
      (neg|check_quest_succeeded, "qst_formal_marriage_proposal"),
      
      (neg|troop_slot_ge, "trp_player", slot_troop_spouse, active_npcs_begin),
      
      (quest_slot_eq, "qst_formal_marriage_proposal", slot_quest_target_troop, "$g_talk_troop"),
      (quest_get_slot, ":bride", "qst_formal_marriage_proposal", slot_quest_giver_troop),
      
      (str_store_troop_name, s10, ":bride"),
      (call_script, "script_troop_get_family_relation_to_troop", ":bride", "$g_talk_troop"),
      
      (call_script, "script_troop_get_relation_with_troop", "trp_player", ":bride"),
      
      (try_begin),
        (gt, reg0, 20),
        (str_store_string, s19, "str_i_wish_to_marry_your_s11_s10_i_ask_for_your_blessing"),
      (else_try),
        (str_store_string, s19, "str_i_wish_to_marry_your_s11_s10_i_ask_for_your_help"),
      (try_end),
      
    ],
    "{s19}", "lord_marriage_permission",
    [
      
  ]],
  
  #no permission
  [anyone,"lord_marriage_permission", [
      (neg|troop_slot_eq, "$g_talk_troop", slot_lord_granted_courtship_permission, 1),
    ],
    "Great heaven, man -- if I haven't given you permission to see her, do you think I'm going to give you permission to marry her?", "lord_pretalk",[
      (fail_quest, "qst_formal_marriage_proposal"),
  ]],
  
  #unwilling bride -- failed due to lord personality
  [anyone,"lord_marriage_permission", [
      (troop_slot_eq, "$g_talk_troop", slot_lord_granted_courtship_permission, 1),
      (quest_get_slot, ":bride", "qst_formal_marriage_proposal", slot_quest_giver_troop),
      (call_script, "script_troop_get_relation_with_troop", "trp_player", ":bride"),
      (lt, reg0, 20),
      (neg|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_debauched),
      (neg|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_selfrighteous),
      (neg|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_quarrelsome),
      
      (call_script, "script_troop_get_family_relation_to_troop", ":bride", "$g_talk_troop"),
    ],
    "It is not my way to push my {s11} to marry against her will or her better judgment", "lord_pretalk",[
      (fail_quest, "qst_formal_marriage_proposal"),
  ]],
  
  
  #unwilling bride -- failed due to competitor
  [anyone,"lord_marriage_permission", [
      (troop_slot_eq, "$g_talk_troop", slot_lord_granted_courtship_permission, 1),
      (quest_get_slot, ":bride", "qst_formal_marriage_proposal", slot_quest_giver_troop),
      (call_script, "script_troop_get_relation_with_troop", "trp_player", ":bride"),
      (lt, reg0, 20),
      (assign, ":highest_competitor_score", "$g_talk_troop_relation"),
      (try_for_range, ":competitor", lords_begin, lords_end),
        (this_or_next|troop_slot_eq, ":competitor", slot_troop_love_interest_1, ":bride"),
        (this_or_next|troop_slot_eq, ":competitor", slot_troop_love_interest_2, ":bride"),
        (troop_slot_eq, ":competitor", slot_troop_love_interest_3, ":bride"),
        (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", ":competitor"),
        (gt, reg0, ":highest_competitor_score"),
        (assign, ":highest_competitor_score", reg0),
        
        (str_store_troop_name, s12, ":competitor"),
      (try_end),
      (gt, ":highest_competitor_score", "$g_talk_troop_relation"),
      (call_script, "script_troop_get_family_relation_to_troop",  ":bride", "$g_talk_troop"),
      
    ],
    "Sorry, lad -- I'm not going to make my {s11} marry you, when I'd rather see her married to {s12}", "lord_pretalk",[
      (fail_quest, "qst_formal_marriage_proposal"),
  ]],
  
  
  #Permission granted
  [anyone,"lord_marriage_permission", [
      (quest_get_slot, ":bride", "qst_formal_marriage_proposal", slot_quest_giver_troop),
      (str_store_troop_name, s11, ":bride"),
    ],
    "Splendid news, my young man -- I shall be proud to have you in our family. Now, let us talk the terms of the marriage. As per our custom, the two of us must make sure that {s11} has sufficient finances to support herself, in the event of any unforeseen circumstances..", "lord_marriage_permission_endowment",[
      (troop_get_slot, ":player_renown", "trp_player", slot_troop_renown),
      (troop_get_slot, ":guardian_renown", "$g_talk_troop", slot_troop_renown),
      
      (store_mul, "$marriage_dowry", ":player_renown", 20),
      (val_min, "$marriage_dowry", 20000),
      
      (store_mul, "$marriage_dower", ":guardian_renown", 20),
      (val_min, "$marriage_dower", 20000),
  ]],
  
  
  [anyone,"lord_marriage_permission_endowment", [
      (assign, reg3, "$marriage_dower"),
      (assign, reg4, "$marriage_dowry"),
    ],
    "I would say that, taking into consideration the prestige of our two houses, that you can provide a dower of {reg3} denars, while I will supply a dowry of {reg4} denars. This shall be her ladyship's property, as a security, lest for any reason you are unable to provide for her. What say you to that?", "lord_marriage_permission_endowment_answer",[
  ]],
  
  [anyone|plyr,"lord_marriage_permission_endowment_answer", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", "$marriage_dower"),
    ],
    "Very well -- so let it be.", "lord_marriage_permission_engagement_date",[
  ]],
  
  [anyone|plyr,"lord_marriage_permission_endowment_answer", [],
    "I cannot afford that right now.", "lord_marriage_permission_endowment_answer_delay",[
  ]],
  
  [anyone|plyr,"lord_marriage_permission_endowment_answer", [
      (eq, 1, 0),
    ],
    "That is too much to pay.", "lord_marriage_permission_endowment_answer_no",[
  ]],
  
  [anyone,"lord_marriage_permission_endowment_answer_no", [],
    "Well. I cannot in all decency allow my daughter to marry without some security, can I? Let me know if you change your mind.", "close_window",[
      (assign, "$g_leave_encounter", 1),
  ]],
  
  
  [anyone,"lord_marriage_permission_engagement_date", [
      (quest_get_slot, ":bride", "qst_formal_marriage_proposal", slot_quest_giver_troop),
      (call_script, "script_get_kingdom_lady_social_determinants", ":bride"),
      (assign, ":venue", reg1),
      (is_between, ":venue", walled_centers_begin, walled_centers_end),
      (party_slot_eq, ":venue", slot_village_state, svs_normal),
      (str_store_party_name, s24, ":venue"),
    ],
    "Splendid! You two may now consider yourselves offically betrothed. Very well -- I shall plan to hold a great feast in {s24}, as soon as circumstances permit. We will be sure to notify you when the day comes.", "close_window",
    [
      (quest_get_slot, ":bride", "qst_formal_marriage_proposal", slot_quest_giver_troop),
      (troop_set_slot, "trp_player", slot_troop_betrothed, ":bride"),
      (troop_set_slot, ":bride", slot_troop_betrothed, "trp_player"),
      
      (call_script, "script_end_quest", "qst_formal_marriage_proposal"),
      
      
      (troop_remove_gold, "trp_player", "$marriage_dower"),
      (call_script, "script_get_kingdom_lady_social_determinants", ":bride"),
      (assign, ":venue", reg1),
      
      (str_store_troop_name, s3, ":bride"),
      (str_store_troop_name, s4, "$g_talk_troop"),
      (str_store_party_name, s5, ":venue"),
      
      (setup_quest_text, "qst_wed_betrothed"),
      (str_store_string, s2, "str_you_plan_to_marry_s3_at_a_feast_hosted_by_s4_in_s5_you_should_be_notifed_of_the_feast_as_soon_as_it_is_held"),
      
      (call_script, "script_start_quest", "qst_wed_betrothed", "$g_talk_troop"),
      
      (quest_set_slot, "qst_wed_betrothed", slot_quest_expiration_days, 365),
      (quest_set_slot, "qst_wed_betrothed", slot_quest_giver_troop, "$g_talk_troop"),
      (quest_set_slot, "qst_wed_betrothed", slot_quest_target_troop, ":bride"),
      
      (try_begin),
        (eq,"$talk_context",tc_party_encounter),
        (assign, "$g_leave_encounter", 1),
      (try_end),
      
  ]],
  
  
  [anyone,"lord_marriage_permission_engagement_date", [],
    "Unfortunately, there is one final complication -- there is no safe place to hold the wedding. Let us hold off on finalizing this, for the time being.", "close_window",
    []],
  
  [anyone,"lord_marriage_permission_endowment_answer_delay", [],
    "No matter -- take the time you need to raise the money. I want her ladyship to be well looked after.", "lord_pretalk",[
  ]],
  
  [anyone,"lord_marriage_permission_endowment_answer_delay", [],
    "That is a shame, but I would be remiss in my duty if I allowed her ladyship to face an uncertain future.", "lord_pretalk",[
      (fail_quest, "qst_formal_marriage_proposal"),
  ]],
  
  
  
  #courtship
  [anyone|plyr,"lord_talk_ask_something_2",[
      (neg|troop_slot_eq, "$g_talk_troop", slot_lord_granted_courtship_permission, 1),
      
      (assign, "$marriage_candidate", 0),
      (try_for_range, ":lady", kingdom_ladies_begin, kingdom_ladies_end),
        (eq, "$marriage_candidate", 0),
        (troop_slot_ge, ":lady", slot_troop_courtship_state, 2),
        (neg|troop_slot_eq, ":lady", slot_troop_courtship_state, 4),
        (neg|troop_slot_ge, ":lady", slot_troop_spouse, 0),
        (call_script, "script_get_kingdom_lady_social_determinants", ":lady"),
        (eq, reg0, "$g_talk_troop"),
        
        (assign, "$marriage_candidate", ":lady"),
        
        (str_clear, s14),
        (call_script, "script_troop_get_family_relation_to_troop", ":lady", "$g_talk_troop"),
        (gt, reg0, 0),
        (str_store_string, s14, "str_your_s11_"),
      (try_end),
      (gt, "$marriage_candidate", 0),
      (str_store_troop_name, s12, "$marriage_candidate"),
      
      (str_clear, s10),
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", slot_lord_granted_courtship_permission, -1),
        (str_store_string, s10, "str_i_ask_again_may"),
      (else_try),
        (str_store_string, s10, "str_may"),
      (try_end),
    ],
    "{s10} I have the honor of visiting with {s14}{s12}?", "lord_courtship_permission",
    []],
  
  
  [anyone,"lord_courtship_permission", [
      (troop_slot_ge, "$marriage_candidate", slot_troop_met, 2),
      (neg|troop_slot_eq, "$marriage_candidate", slot_troop_met, 4),
      (this_or_next|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_debauched),
      (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_quarrelsome),
      
      (call_script, "script_troop_get_relation_with_troop", "$marriage_candidate", "trp_player"),
      (gt, reg0, 0),
    ],
    "From what I hear, you have already spoken to her -- without my permission. Let me tell you this: I am her lord and guardian, and I have plans for her. I will not be mocked behind my back as a man who cannot control the women of his household. I would ask you not to discuss this matter with me again.", "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", slot_lord_granted_courtship_permission, -1),
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", -1),
  ]],
  
  
  [anyone,"lord_courtship_permission", [
      (call_script, "script_npc_decision_checklist_male_guardian_assess_suitor", "$g_talk_troop", "trp_player"),
      (lt, reg0, 1),
      (str_store_string, s14, reg1),
    ],
    "{s14}", "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", slot_lord_granted_courtship_permission, -1),
  ]],
  
  
  [anyone,"lord_courtship_permission", [
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_goodnatured),
        (str_store_string, s12, "str_very_well_as_far_as_im_concerned_i_suppose_she_can_see_most_anyone_she_likes__within_reason_of_course"),
      (else_try),
        (this_or_next|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_debauched),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_quarrelsome),
        (str_store_string, s12, "str_very_well_an_alliance_with_you_could_be_valuable_go_chat_with_her_and_see_if_you_can_get_her_to_take_a_fancy_to_you_if_she_doesnt_and_if_we_still_want_to_conclude_this_business_then_i_can_make_her_see_reason"),
      (else_try),
        (str_store_string, s12, "str_you_have_my_blessing_to_pay_suit_to_her__so_long_as_your_intentions_are_honorable_of_course_depending_on_how_things_proceed_between_you_two_we_may_have_more_to_discuss_at_a_later_date"),
      (try_end),
    ],
    "{s12}", "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", slot_lord_granted_courtship_permission, 1),
  ]],
  
  #Ask for marriage, following courtship, both with or against lady's wishes
  
  [anyone|plyr,"lord_talk_ask_something_2", [
      (neg|troop_slot_eq, "$g_talk_troop", slot_lord_granted_courtship_permission, 1),
      (neg|troop_slot_ge, "trp_player", slot_troop_spouse, active_npcs_begin),
      (troop_get_type, ":is_female", "$g_talk_troop"),
      (neq, ":is_female", 1),
    ],
    "What would it take to cement a lasting alliance with your house?", "lord_talk_ask_marriage_1",[]],
  
  
  #1429 REBELS
  #
  
  [anyone|plyr,"lord_talk", [(eq, "$g_talk_troop", "trp_knight_1_5"),
    ],
    "Que pensez vous des Rebels?", "lord_jeanne_rebell", []],
  [anyone ,"lord_jeanne_rebell", [],"Ce sont les enfants de la France,c'est pour eux que je me bat et endure tout ceci.", "lord_talk", []],
  
  #
  
  [anyone|plyr,"lord_talk", [(eq, "$g_talk_troop", "trp_knight_1_5"),
    ],
    "Que pensez vous de vos enemis les Anglais?", "lord_jeanne_angll", []],
  [anyone ,"lord_jeanne_angll", [],"J'ai grande pitié d'eux,ils n'obeissent pas au Roi du Ciel,ils perdrons toutes les batailles avant de perdre leur ame.", "lord_talk", []],
  
  #sl
  
  [anyone|plyr,"lord_talk", [(eq, "$g_talk_troop", "trp_knight_1_5"),
    ],
    "Que pouvez vous me dire sur les mercenaires de la compagnie des SansLys ?", "lord_jeanne_slys", []],
  [anyone ,"lord_jeanne_slys", [],"Ce sont de tres bons soldats,je prie pour que le Dauphin es toujours de quois les payer,si les Anglois venaient a mander leur service nous serions en mauvaise posture.", "lord_talk", []],
  
  
  #
  
  [anyone|plyr,"lord_talk", [(eq, "$g_talk_troop", "trp_kingdom_1_lord"),
    ],
    "Que pensez vous des Rebels?", "lord_chharl_rebell", []],
  [anyone ,"lord_chharl_rebell", [],"Qu'ils s'engagent dans notre host,ils menent un combat parallele,ils donnent parfois l'impression de se battre aussi contre nous.mais tant qu'ils genent les anglais et les bourgignons ils seront utiles a nos plans.", "lord_talk", []],
  #
  
  [anyone|plyr,"lord_talk", [(eq, "$g_talk_troop", "trp_kingdom_1_lord"),
    ],
    "Que pensez vous du Duché de Bretagne?", "lord_chharl_bretagne", []],
  [anyone ,"lord_chharl_bretagne", [],"Nous éspérons améliorer nos relations avec le Duché de Bretagne, mais tant qu'ils s'opposerons a certaines de nos revendications nous sommes obligés de les combattre.", "lord_talk", []],
  
  #
  
  [anyone|plyr,"lord_talk", [(eq, "$g_talk_troop", "trp_kingdom_1_lord"),
    ],
    "Puis je vous demander votre avis sur la compagnie des SansLys, Sire?", "lord_chharl_slys", []],
  [anyone ,"lord_chharl_slys", [],"Ce sont mes meilleures troupes d'hommes a pied,les plus braves et les plus téméraires des mercenaires.si l'or venais a manquer,je ne puis pensser qu'ils resteraient quand meme a mon service,mais ca n'es pas le cas pour le moment.", "lord_talk", []],
  
  
  #
  
  [anyone|plyr,"lord_talk", [(eq, "$g_talk_troop", "trp_kingdom_2_lord"),
    ],
    "Que pensez vous des Rebels?", "lord_hennryy_rebell", []],
  [anyone ,"lord_hennryy_rebell", [],"Hum...Ils donnent l'impression au peuple que ce sont des heros romantiques,mais la réalité en es toute autre,il ne s'agit que de vagabonds et de voleurs pouilleux,j'en aurais bientot fini avec eux,je ne veux pas continuer a dépensser mon or a entretenir les troupes une fois que nous aurons gagné la guerre,car meme vaincus ces chiens continuerons a m'enpecher de trouver le someil.", "lord_talk", []],
  
  #
  
  [anyone|plyr,"lord_talk", [(eq, "$g_talk_troop", "trp_knight_1_1"),
    ],
    "Que pensez vous des Rebels?", "lord_kniiight1_rebell", []],
  [anyone ,"lord_kniiight1_rebell", [],"Que voullez vous dire? ce sont des francais et il se battent de nostre coté,toute aide es la bienvenue,bien que je ne comprene pas pourquois ils ne rejoigne pas l'armée du Dauphin? peut etre penssent t'ils qu'ils seront sacrifiés,ce qui ne sera pas le cas,ils seront dirigés plus éfficacement au contraire...du moin je l'éspère.", "lord_talk", []],
  
  
  #
  
  [anyone|plyr,"lord_talk", [(eq, "$g_talk_troop", "trp_knight_1_1"),
    ],
    "Que pensez vous des Mercenaires du SansLys ?", "lord_kniiight1_slys", []],
  [anyone ,"lord_kniiight1_slys", [],"C'est la mailleure troupe du Dauphin,des hommes tres competents,et de braves soldats,tres disciplinés.ce qu'ils font en dehors des combats ne me regarde pas.", "lord_talk", []],
  
  
  #
  
  [anyone|plyr,"lord_talk", [(eq, "$g_talk_troop", "trp_knight_1_2"),
    ],
    "Que pensez vous des Rebels?", "lord_hiirre_rebell", []],
  [anyone ,"lord_hiirre_rebell", [],"Entre nous...je pensse qu'ils ne sont pas idiots,ils savent qu'ils auraient un meilleur équipement si ils s'enrollaient dans l'host.mais ces paysans savent aussi qu'ils constituerais la première ligne de dèffensse.je pensse surtout qu'ils sont dirigès par des personnes plus malines qu'eux.", "lord_talk", []],
  
  
  #
  
  [anyone|plyr,"lord_talk", [(eq, "$g_talk_troop", "trp_knight_1_2"),
    ],
    "Que pensez vous de la troupe du SansLys ?", "lord_hiirre_lyys", []],
  [anyone ,"lord_hiirre_lyys", [],"J'ai combattu a leurs cotés a la bataille de Verneuil,ce sont de formidables soldats,meme si nous l'avons pas emporté ce jour la,mais la situation es en train de changer.", "lord_talk", []],
  
  
  #
  
  [anyone|plyr,"lord_talk", [(eq, "$g_talk_troop", "trp_knight_1_4"),
    ],
    "Que pensez vous des Rebels?", "lord_alleencon_rebell", []],
  [anyone ,"lord_alleencon_rebell", [],"Cette piétaille désorganisée ne sert strictement a rien,ils avances par les chemins tel du betail pour se faire prendre et executer juste apres par les patrouilles...quel gachis.", "lord_talk", []],
  
  
  #
  
  [anyone|plyr,"lord_talk", [(eq, "$g_talk_troop", "trp_knight_1_4"),
    ],
    "Que pensez vous de la compagnie de mercenaires du SansLys ?", "lord_alleencon_slys", []],
  [anyone ,"lord_alleencon_slys", [],"Cette compagnie es la meilleure que l'on puisse s'offrire,a condition d'etre fortuné,leur prix es égale a leur service.mais cette troupe vaux sa solde,leur devise es de ne jamais lacher leur posistion,et leur chef leur interdit de mourire,c'est quelque part amusant,mais ils sont respectables nous en convenons bien.", "lord_talk", []],
  
  
  
  #
  
  [anyone|plyr,"lord_talk", [(eq, "$g_talk_troop", "trp_knight_1_3"),
    ],
    "Que pensez vous des Rebels?", "lord_alleencon_rebell", []],
  [anyone ,"lord_alleencon_rebell", [],"Aucun interet...une autre question?", "lord_talk", []],
  
  #
  
  [anyone|plyr,"lord_talk", [(eq, "$g_talk_troop", "trp_knight_1_3"),
    ],
    "Que pensez vous du SansLys...les mercenaires ?", "lord_alleencon_lyis", []],
  [anyone ,"lord_alleencon_lyis", [],"J'ai l'impression pafois qu'ils se prennent pour des nobles,uniquement par ce qu'ils on une baniere personnele.le dauphin devrais reformer tout ca et renvoyer la moitié de ses troupes les plus incompetentes,je le lui rappelle incessamment.ceci dit le SansLys es une compagnie importante et indispenssable,tous les sujets du Royaume en convienent.", "lord_talk", []],
  
  
  
  
  
  [anyone|plyr,"lord_talk_ask_something_2", [],
    "Never mind.", "lord_pretalk",[]],
  
  [anyone,"lord_talk_ask_location", [],
    "Very well, I may or may not have an answer for you. About whom do you wish to hear?", "lord_talk_ask_location_2",[]],
  
  [anyone|plyr|repeat_for_troops,"lord_talk_ask_location_2", [(store_repeat_object, ":troop_no"),
      (neq, "$g_talk_troop", ":troop_no"),
      (is_between, ":troop_no", active_npcs_begin, kingdom_ladies_end),
      (neq, ":troop_no", "trp_player"),
      (this_or_next|troop_slot_eq, ":troop_no", slot_troop_occupation, slto_kingdom_hero),
      (troop_slot_eq, ":troop_no", slot_troop_occupation, slto_kingdom_lady),
      (store_troop_faction, ":faction_no", ":troop_no"),
      (eq, "$g_encountered_party_faction", ":faction_no"),
      (str_store_troop_name, s1, ":troop_no"),
      (try_begin),
        (faction_slot_eq, "$players_kingdom", slot_faction_marshall, ":troop_no"),
        (str_store_string, s1, "@Our marshal, {s1}"),
      (try_end),
      
    ],
    "{s1}", "lord_talk_ask_location_3",[(store_repeat_object, "$hero_requested_to_learn_location")]],
  
  [anyone|plyr,"lord_talk_ask_location_2", [
      (is_between, "$g_talk_troop", kingdom_ladies_begin, kingdom_ladies_end),
      ], "Never mind.", "lady_pretalk",[]],
  
  [anyone|plyr,"lord_talk_ask_location_2", [
      (neg|is_between, "$g_talk_troop", kingdom_ladies_begin, kingdom_ladies_end),
      ], "Never mind.", "lord_pretalk",[]],
  
  [anyone,"lord_talk_ask_location_3",
    [
      (is_between, "$g_talk_troop", kingdom_ladies_begin, kingdom_ladies_end),
      (call_script, "script_update_troop_location_notes", "$hero_requested_to_learn_location", 1),
      (call_script, "script_get_information_about_troops_position", "$hero_requested_to_learn_location", 0),
    ],
    "{s1}", "lady_pretalk",[]],
  
  
  
  [anyone,"lord_talk_ask_location_3",
    [
      (call_script, "script_update_troop_location_notes", "$hero_requested_to_learn_location", 1),
      (call_script, "script_get_information_about_troops_position", "$hero_requested_to_learn_location", 0),
    ],
    "{s1}", "lord_pretalk",[]],
  
  [anyone,"lord_talk_ask_about_war", [],
    "{s12}", "lord_talk_ask_about_war_2",[
      (assign, ":num_enemies", 0),
      (try_for_range_backwards, ":cur_faction", kingdoms_begin, kingdoms_end),
        (faction_slot_eq, ":cur_faction", slot_faction_state, sfs_active),
        (store_relation, ":cur_relation", ":cur_faction", "$g_talk_troop_faction"),
        (lt, ":cur_relation", 0),
        (try_begin),
          (eq, ":num_enemies", 0),
          (str_store_faction_name_link, s12, ":cur_faction"),
        (else_try),
          (eq, ":num_enemies", 1),
          (str_store_faction_name_link, s11, ":cur_faction"),
          (str_store_string, s12, "@{s11} and {s12}"),
        (else_try),
          (str_store_faction_name_link, s11, ":cur_faction"),
          (str_store_string, s12, "@{!}{s11}, {s12}"),
        (try_end),
        (val_add, ":num_enemies", 1),
      (try_end),
      (try_begin),
        (eq, ":num_enemies", 0),
        (str_store_string, s12, "@We are not at war with anyone."),
      (else_try),
        (str_store_string, s12, "@We are at war with {s12}."),
      (try_end),
  ]],
  
  [anyone|plyr|repeat_for_factions, "lord_talk_ask_about_war_2", [(store_repeat_object, ":faction_no"),
      (is_between, ":faction_no", kingdoms_begin, kingdoms_end),
      (faction_slot_eq, ":faction_no", slot_faction_state, sfs_active),
      (store_relation, ":cur_relation", ":faction_no", "$g_talk_troop_faction"),
      (lt, ":cur_relation", 0),
      (str_store_faction_name, s1, ":faction_no")],
    "Tell me more about the war with {s1}.", "lord_talk_ask_about_war_details",[(store_repeat_object, "$faction_requested_to_learn_more_details_about_the_war_against")]],
  
  [anyone|plyr,"lord_talk_ask_about_war_2", [], "That's all I wanted to know. Thank you.", "lord_pretalk",[]],
  
  [anyone,"lord_talk_ask_about_war_details", [],
    #   "We have {reg5?{reg5}:no} {reg3?armies:army} and they have {reg6?{reg6}:none}. Overall, {s9}.",
    "{s9}.",
    "lord_talk_ask_about_war_2",
    [#(call_script, "script_faction_get_number_of_armies", "$g_encountered_party_faction"),
      #(assign, reg5, reg0),
      #(assign, reg3, 1),
      #(try_begin),
      #  (eq, reg5, 1),
      #  (assign, reg3, 0),
      #(try_end),
      #(call_script, "script_faction_get_number_of_armies", "$faction_requested_to_learn_more_details_about_the_war_against"),
      #(assign, reg6, reg0),
      #(assign, reg4, 1),
      #(try_begin),
      #  (eq, reg6, 1),
      #  (assign, reg4, 0),
      #(try_end),
      #(store_div, ":our_str", reg5, 2),
      #(store_div, ":enemy_str", reg6, 2),
      #(store_sub, ":advantage", ":our_str", ":enemy_str"),
      #(val_clamp, ":advantage", -4, 5),
      #(val_add, ":advantage", 4),
      #(store_add, ":adv_str", "str_war_report_minus_4", ":advantage"),
      #(str_store_string, s9, ":adv_str"),
      
      (store_add, ":war_damage_slot", "$faction_requested_to_learn_more_details_about_the_war_against", slot_faction_war_damage_inflicted_on_factions_begin),
      (val_sub, ":war_damage_slot", kingdoms_begin),
      (faction_get_slot, ":war_damage_inflicted", "$g_talk_troop_faction", ":war_damage_slot"),
      
      (store_add, ":war_damage_slot", "$g_talk_troop_faction", slot_faction_war_damage_inflicted_on_factions_begin),
      (val_sub, ":war_damage_slot", kingdoms_begin),
      (faction_get_slot, ":war_damage_suffered", "$faction_requested_to_learn_more_details_about_the_war_against", ":war_damage_slot"),
      
      (val_max, ":war_damage_suffered", 1),
      
      (store_mul, ":war_damage_ratio", ":war_damage_inflicted", 100),
      (val_div, ":war_damage_ratio", ":war_damage_suffered"),
      
      (try_begin),
        (eq, "$cheat_mode", 1),
        (assign, reg3, ":war_damage_inflicted"),
        (assign, reg4, ":war_damage_suffered"),
        (assign, reg5, ":war_damage_ratio"),
        (display_message, "str_war_damage_inflicted_reg3_suffered_reg4_ratio_reg5"),
      (try_end),
      
      (str_store_string, s9, "str_error__did_not_calculate_war_progress_string_properly"),
      (try_begin),
        (lt, ":war_damage_inflicted", 5),
        (str_store_string, s9, "str_the_war_has_barely_begun_so_and_it_is_too_early_to_say_who_is_winning_and_who_is_losing"),
      (else_try),
        (gt, ":war_damage_inflicted", 100),
        (gt, ":war_damage_ratio", 200),
        (str_store_string, s9, "str_we_have_been_hitting_them_very_hard_and_giving_them_little_chance_to_recover"),
      (else_try),
        (gt, ":war_damage_inflicted", 80),
        (gt, ":war_damage_ratio", 150),
        (str_store_string, s9, "str_the_fighting_has_been_hard_but_we_have_definitely_been_getting_the_better_of_them"),
      (else_try),
        (gt, ":war_damage_suffered", 100),
        (lt, ":war_damage_ratio", 50),
        (str_store_string, s9, "str_they_have_been_hitting_us_very_hard_and_causing_great_suffering"),
      (else_try),
        (gt, ":war_damage_suffered", 80),
        (lt, ":war_damage_ratio", 68),
        (str_store_string, s9, "str_the_fighting_has_been_hard_and_i_am_afraid_that_we_have_been_having_the_worst_of_it"),
      (else_try),
        (gt, ":war_damage_suffered", 50),
        (gt, ":war_damage_inflicted", 50),
        (gt, ":war_damage_ratio", 65),
        (str_store_string, s9, "str_both_sides_have_suffered_in_the_fighting"),
      (else_try),
        (gt, ":war_damage_ratio", 125),
        (str_store_string, s9, "str_no_clear_winner_has_yet_emerged_in_the_fighting_but_i_think_we_are_getting_the_better_of_them"),
      (else_try),
        (gt, ":war_damage_ratio", 80),
        (str_store_string, s9, "str_no_clear_winner_has_yet_emerged_in_the_fighting_but_i_fear_they_may_be_getting_the_better_of_us"),
      (else_try),
        (str_store_string, s9, "str_no_clear_winner_has_yet_emerged_in_the_fighting"),
      (try_end),
      
      (try_begin),
        (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
        (call_script, "script_npc_decision_checklist_peace_or_war", "$g_talk_troop_faction", "$faction_requested_to_learn_more_details_about_the_war_against", -1),
        (str_store_string, s9, "str_s9_s14"),
      (try_end),
  ]],
  
  
  
  [anyone,"lord_talk_ask_about_strategy", [
      (faction_get_slot, ":ai_state", "$g_encountered_party_faction", slot_faction_ai_state),
      (faction_get_slot, ":ai_object", "$g_encountered_party_faction", slot_faction_ai_object),
      
      
      
      (faction_get_slot, ":ai_decider", "$g_encountered_party_faction", slot_faction_marshall),
      (try_begin),
        (eq, ":ai_decider", -1),
        (faction_get_slot, ":ai_decider", "$g_encountered_party_faction", slot_faction_leader),
      (try_end),
      
      (call_script, "script_npc_decision_checklist_faction_ai_alt", ":ai_decider"),
      (assign, ":planned_state", reg0),
      (assign, ":planned_object", reg1),
      
      
      (try_begin),
        (gt, ":ai_object", -1),
        (str_store_party_name, s8, ":ai_object"),
      (try_end),
      
      (try_begin),
        (eq, ":ai_state", sfai_default),
        (str_store_string, s7, "str_there_is_no_campaign_currently_in_progress"),
      (else_try),
        (eq, ":ai_state", sfai_gathering_army),
        (str_store_string, s7, "str_we_are_assembling_the_army"),
      (else_try),
        (eq, ":ai_state", sfai_attacking_center),
        (str_store_string, s7, "str_we_aim_to_take_the_fortress_of_s8"),
      (else_try),
        (eq, ":ai_state", sfai_raiding_village),
        (str_store_string, s7, "str_we_are_on_a_raid_and_are_now_targeting_s8"),
      (else_try),
        (eq, ":ai_state", sfai_attacking_enemy_army),
        (str_store_string, s7, "str_we_are_trying_to_seek_out_and_defeat_s8"),
      (else_try),
        (eq, ":ai_state", sfai_attacking_enemies_around_center),
        (str_store_string, s7, "str_we_are_riding_to_the_defense_of_s8"),
      (else_try),
        (eq, ":ai_state", sfai_feast),
        (str_store_string, s7, "str_we_are_gathering_for_a_feast_at_s8"),
      (try_end),
      
      #Additional information for gathering the army
      (str_clear, s9),
      (try_begin),
        (eq, ":ai_state", sfai_gathering_army),
        (faction_get_slot, ":faction_marshal", "$g_talk_troop_faction", slot_faction_marshall),
        (gt, ":faction_marshal", -1),
        (troop_get_slot, ":marshal_party", ":faction_marshal", slot_troop_leaded_party),
        (party_is_active, ":marshal_party"),
        
        (this_or_next|eq, "$g_talk_troop", ":faction_marshal"),
        (party_slot_eq, "$g_talk_troop_party", slot_party_ai_object, ":marshal_party"),
        
        (party_get_slot, ":marshal_object", ":marshal_party", slot_party_ai_object),
        
        (try_begin),
          (eq, ":marshal_object", -1),
          (str_store_string, s9, "str_we_are_waiting_here_for_vassals"),
        (else_try),
          (str_store_party_name, s11, ":marshal_object"),
          (str_store_string, s9, "str_we_are_travelling_to_s11_for_vassals"),
        (try_end),
      (try_end),
      
      
      (try_begin),
        (this_or_next|neq, ":ai_state", ":planned_state"),
        (neq, ":ai_object", ":planned_object"),
        
        (str_store_string, s14, "str__however_that_may_change_shortly_s14"),
      (try_end),
      
    ],
    "{s7} {s9} {s14}", "lord_strategy_follow_evaluation",
    []],
  
  [anyone, "lord_strategy_follow_evaluation", [
      (this_or_next|faction_slot_eq, "$g_talk_troop_faction", slot_faction_marshall, "$g_talk_troop"),
      (this_or_next|faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_default),
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_feast),
    ],
    "Did you have any other questions?",
    "lord_talk_ask_something_2",[
  ]],
  
  
  [anyone, "lord_strategy_follow_evaluation", [
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_gathering_army),
      (call_script, "script_npc_decision_checklist_faction_ai_alt", "$g_talk_troop"),
      (assign, ":talk_troop_preferred_strategy", reg0),
      (neq, ":talk_troop_preferred_strategy", sfai_gathering_army),
      
      (store_current_hours, ":hours_at_current_state"),
      (faction_get_slot, ":current_state_started", "$g_talk_troop_faction", slot_faction_ai_current_state_started),
      (val_sub, ":hours_at_current_state", ":current_state_started"),
      (ge, ":hours_at_current_state", 40),
      
      (faction_get_slot, ":faction_marshal", "$g_talk_troop_faction", slot_faction_marshall),
      (is_between, ":faction_marshal", active_npcs_begin, active_npcs_end),
      (neq, ":faction_marshal", "$g_talk_troop"),
      (str_store_troop_name, s4, ":faction_marshal"),
    ],
    "Our leader {s4} is far too cautious. {reg4?He:She} should either use the army to attack the enemy, or let it go home.",
    "lord_strategy_follow_up",[
      (assign, "$g_talk_troop_disagrees_with_marshal", 1),
      
  ]],
  
  
  [anyone, "lord_strategy_follow_evaluation", [
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_gathering_army),
      
      (store_current_hours, ":hours_at_current_state"),
      (faction_get_slot, ":current_state_started", "$g_talk_troop_faction", slot_faction_ai_current_state_started),
      (val_sub, ":hours_at_current_state", ":current_state_started"),
      (ge, ":hours_at_current_state", 40),
      
      (faction_get_slot, ":faction_marshal", "$g_talk_troop_faction", slot_faction_marshall),
      (is_between, ":faction_marshal", active_npcs_begin, active_npcs_end),
      (neq, ":faction_marshal", "$g_talk_troop"),
      
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", ":faction_marshal"),
      (lt, reg0, 5),
      
      (str_store_troop_name, s4, ":faction_marshal"),
      
    ],
    "Our army sits, doing nothing. Apparently, too few vassals have answered the call to arms. Perhaps {s4} does not enjoy the confidence of the great lords of this realm.",
    "lord_strategy_follow_up",[
      (assign, "$g_talk_troop_disagrees_with_marshal", 1),
      
  ]],
  
  #To Steve - Why we need this dialog? It already included in below lord_strategy_follow_evaluation dialogs
  #[anyone, "lord_strategy_follow_evaluation",
  #[
  #  (this_or_next|faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_attacking_center),
  #  (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_raiding_village),
  #
  #  (faction_get_slot, ":cur_object", "$g_talk_troop_faction", slot_faction_ai_object),
  #  (call_script, "script_npc_decision_checklist_evaluate_enemy_center_for_attack", "$g_talk_troop", ":cur_object", 1, 0),
  #  (lt, reg0, 0),
  #
  #  (str_store_string, s9, reg1),
  #  (str_store_party_name, s8, ":cur_object"),
  #],
  # "I disagree with the marshal's decision. I believe that {s8} {s9}",
  # "lord_strategy_why_not",[
  # ]],
  
  #This dialog appears when lord disagrees with marshal about the selected faction ai (attack/defend/gather/other).
  #To Steve - I took that dialog upper from below one. Lord should compare his faction ai choice with marshal's one before comparing preffered ai objects.
  [anyone, "lord_strategy_follow_evaluation",
    [
      (call_script, "script_npc_decision_checklist_faction_ai_alt", "$g_talk_troop"),
      (assign, ":talk_troop_preferred_strategy", reg0),
      
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, ":talk_troop_preferred_strategy"),
      
      (assign, ":continue", 1),
      (try_begin),
        (eq, ":talk_troop_preferred_strategy", sfai_raiding_village),
        (str_store_string, s4, "@go on the offensive now."),
      (else_try),
        (eq, ":talk_troop_preferred_strategy", sfai_attacking_center),
        (str_store_string, s4, "@go on the offensive now."),
      (else_try),
        (eq, ":talk_troop_preferred_strategy", sfai_attacking_enemies_around_center),
        (str_store_string, s4, "@act to defend our lands."),
      (else_try),
        (eq, ":talk_troop_preferred_strategy", sfai_gathering_army),
        (str_store_string, s4, "@take more time to gather the army."),
      (else_try),
        (assign, ":continue", 0),
      (try_end),
      
      (eq, ":continue", 1),
      
      (faction_get_slot, ":faction_marshal", "$g_talk_troop_faction", slot_faction_marshall),
      (is_between, ":faction_marshal", active_npcs_begin, active_npcs_end),
      (neq, ":faction_marshal", "$g_talk_troop"),
      
      (str_store_troop_name, s10, ":faction_marshal"),
      (assign, "$g_talk_troop_disagrees_with_marshal", 1),
      
    ],
    "I disagree with this strategy. I would prefer to {s4}.",
    "lord_strategy_follow_up", [
      (assign, "$g_talk_troop_disagrees_with_marshal", 1),
      
  ]],
  
  #This dialog appears when lord disagrees with marshal about the city will be attacked.
  [anyone, "lord_strategy_follow_evaluation",
    [
      (this_or_next|faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_attacking_center),
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_raiding_village),
      
      (call_script, "script_find_center_to_attack_alt", "$g_talk_troop", 1, 0),
      (assign, ":preferred_center", reg0),
      (is_between, ":preferred_center", centers_begin, centers_end),
      
      (faction_get_slot, ":cur_object", "$g_talk_troop_faction", slot_faction_ai_object),
      (neq, ":cur_object", ":preferred_center"),
      
      #To Steve - if lord's preffered center is different from marshal's current one then this should be enough for lord to say I disagree with marshal isn't this better?
      #Because it is not easy for any lord to return minus score for a center, so if we do not do this, we will not be able to see lords which disagree with marshal.
      #Conclusion : I removed condition of (lt, reg0, 0),
      
      (faction_get_slot, ":faction_marshal", "$g_talk_troop_faction", slot_faction_marshall),
      (is_between, ":faction_marshal", active_npcs_begin, active_npcs_end),
      (neq, ":faction_marshal", "$g_talk_troop"),
      
      (call_script, "script_npc_decision_checklist_evaluate_enemy_center_for_attack", ":faction_marshal", ":preferred_center", 1, 0),
      #(lt, reg0, 0),
      
      (str_store_string, s9, reg1),
      (str_store_party_name, s8, ":preferred_center"),
      
      (faction_get_slot, ":faction_marshal", "$g_talk_troop_faction", slot_faction_marshall),
      (is_between, ":faction_marshal", active_npcs_begin, active_npcs_end),
      (neq, ":faction_marshal", "$g_talk_troop"),
      
      (str_store_troop_name, s10, ":faction_marshal"),
      
    ],
    "I personally would prefer to attack {s8}, but our marshal {s10} believes that it {s9}",
    "lord_strategy_follow_up",[
      (assign, "$g_talk_troop_disagrees_with_marshal", 1),
      
  ]],
  
  #This dialog appears when lord disagrees with marshal about the city will be defended.
  [anyone, "lord_strategy_follow_evaluation",
    [
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_attacking_enemies_around_center),
      
      (call_script, "script_find_center_to_defend", "$g_talk_troop"),
      (assign, ":preferred_center", reg0),
      (is_between, ":preferred_center", centers_begin, centers_end),
      (faction_get_slot, ":cur_object", "$g_talk_troop_faction", slot_faction_ai_object),
      (neq, ":cur_object", ":preferred_center"),
      
      (faction_get_slot, ":faction_marshal", "$g_talk_troop_faction", slot_faction_marshall),
      (is_between, ":faction_marshal", active_npcs_begin, active_npcs_end),
      (neq, ":faction_marshal", "$g_talk_troop"),
      
      (str_store_party_name, s8, ":preferred_center"),
      (str_store_party_name, s9, ":cur_object"),
      
    ],
    "I personally would prefer to defend {s8}, instead of {s9}.",
    "lord_strategy_follow_up",[
      (assign, "$g_talk_troop_disagrees_with_marshal", 1),
  ]],
  
  
  
  
  
  [anyone, "lord_strategy_follow_evaluation",
    [
      (faction_get_slot, ":faction_marshal", "$g_talk_troop_faction", slot_faction_marshall),
      (this_or_next|neg|is_between, ":faction_marshal", active_npcs_begin, active_npcs_end),
      (eq, ":faction_marshal", "$g_talk_troop"),
    ],
    "Is there anything else?",
    "lord_talk",[
  ]],
  
  
  [anyone, "lord_strategy_follow_evaluation",
    [],
    "This strategy seems reasonable to me.",
    "lord_strategy_follow_up",[
      (assign, "$g_talk_troop_disagrees_with_marshal", 0),
  ]],
  
  [anyone|plyr, "lord_strategy_follow_up", [
      (this_or_next|faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_attacking_center),
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_raiding_village),
    ],
    "If you're attacking, why aren't you...",
    "lord_strategy_why_not",[
  ]],
  
  [anyone|plyr, "lord_strategy_follow_up", [
    ],
    "I see....",
    "lord_talk_ask_something_again",[
  ]],
  
  [anyone|plyr, "lord_strategy_follow_up", [
      (eq, "$g_talk_troop_disagrees_with_marshal", 1),
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
      (faction_get_slot, ":faction_marshal", "$g_talk_troop_faction", slot_faction_marshall),
      (is_between, ":faction_marshal", active_npcs_begin, active_npcs_end),
      (str_store_troop_name, s4, ":faction_marshal"),
    ],
    "Would you say, then, that {s4} should no longer be marshal?",
    "lord_talk_replace_marshal",[
  ]],
  
  [anyone, "lord_talk_replace_marshal", [
      (faction_get_slot, ":faction_issue", "$g_talk_troop_faction", slot_faction_political_issue),
      (is_between, ":faction_issue", centers_begin, centers_end),
      (str_store_party_name, s4, ":faction_issue"),
    ],
    "I believe that our realm should resolve the issue of {s4} before we begin to debate replacing the marshal.",
    "lord_talk_ask_something_again",[
  ]],
  
  
  [anyone, "lord_talk_replace_marshal", [
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_political_issue, 1),
      (troop_get_slot, ":stance_on_faction_issue", "$g_talk_troop", slot_troop_stance_on_faction_issue),
      (faction_get_slot, ":faction_marshal", "$g_talk_troop_faction", slot_faction_marshall),
      (neq, ":stance_on_faction_issue", ":faction_marshal"),
      (str_store_troop_name, s4,  ":stance_on_faction_issue"),
      (str_store_troop_name, s5,  ":faction_marshal"),
      
    ],
    "Yes. I have already made my position on this matter clear. I believe that {s4} should be marshal instead of {s5}.",
    "lord_talk_ask_something_again",[
  ]],
  
  [anyone, "lord_talk_replace_marshal", [
      (faction_get_slot, ":faction_marshal", "$g_talk_troop_faction", slot_faction_marshall),
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", ":faction_marshal"),
      (assign, ":relation_with_marshal", reg0),
      (gt, ":relation_with_marshal", "$g_talk_troop_effective_relation"),
    ],
    "I will make up my mind on this matter without your persuasion, {sir/my lady}.",
    "lord_talk_ask_something_again",[
  ]],
  
  [anyone, "lord_talk_replace_marshal", [
    ],
    "Hmm...",
    "lord_talk_replace_marshal_decision",[
      (faction_set_slot, "$g_talk_troop_faction", slot_faction_political_issue, 1),
  ]],
  
  
  [anyone, "lord_talk_replace_marshal_decision", [
      (call_script, "script_npc_decision_checklist_take_stand_on_issue", "$g_talk_troop"),
      (assign, ":replacement_candidate", reg0),
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_marshall, ":replacement_candidate"),
      (call_script, "script_troop_describes_troop_to_s15", "$g_talk_troop", ":replacement_candidate"),
    ],
    "Yes, I would say that. At this point, I would be tempted to say that I support {s15} instead. I am glad that you and I had this discussion, so that I know that we are of the same mind on this matter.",
    "lord_talk_ask_something_again",[
      (call_script, "script_npc_decision_checklist_take_stand_on_issue", "$g_talk_troop"),
      (assign, ":replacement_candidate", reg0),
      (troop_set_slot, "$g_talk_troop", slot_troop_stance_on_faction_issue, ":replacement_candidate"),
      
      (faction_get_slot, ":faction_marshal", "$g_talk_troop_faction", slot_faction_marshall),
      (troop_get_slot, ":marshal_controversy",  ":faction_marshal", slot_troop_controversy),
      (val_add, ":marshal_controversy", 5),
      (troop_set_slot, ":faction_marshal", slot_troop_controversy, ":marshal_controversy"),
      
      
      (call_script, "script_troop_describes_troop_to_s15", "$g_talk_troop", ":replacement_candidate"),
      
  ]],
  
  
  [anyone, "lord_talk_replace_marshal_decision", [
      (faction_get_slot, ":faction_marshal", "$g_talk_troop_faction", slot_faction_marshall),
      (str_store_troop_name, s4, ":faction_marshal"),
    ],
    "Not necessarily. It is possible for {s4} and I have to have an honest disagreement over strategy, without my seeking to replace him.",
    "lord_talk_ask_something_again",[
  ]],
  
  
  
  
  [anyone, "lord_strategy_why_not", [
    ],
    "Yes?",
    "lord_strategy_why_not_select",[
  ]],
  
  [anyone|plyr, "lord_strategy_why_not_select", [
    ],
    "Never mind",
    "lord_talk_ask_something_again",[]],
  
  [anyone|plyr, "lord_strategy_why_not_select",
    [
      (this_or_next|faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_raiding_village),
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_attacking_center),
      
      (faction_get_slot, ":cur_object", "$g_talk_troop_faction", slot_faction_ai_object),
      (faction_get_slot, ":faction_marshal", "$g_talk_troop_faction", slot_faction_marshall),
      (gt, ":faction_marshal", -1),
      (call_script, "script_find_center_to_attack_alt", ":faction_marshal", 1, 0),
      (neq, reg0, ":cur_object"),
      (str_store_party_name,s4, ":cur_object"),
    ],
    "..planning to continue with the attack on {s4}?",
    "lord_strategy_why_not_reason",[
  ]],
  
  [anyone|plyr|repeat_for_parties, "lord_strategy_why_not_select",
    [
      (store_repeat_object, ":selected_center"),
      (is_between, ":selected_center", centers_begin, centers_end),
      
      (store_faction_of_party, ":selected_center_faction", ":selected_center"),
      (eq, ":selected_center_faction", "$g_talk_troop_faction"),
      
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_object, ":selected_center"),
      (neq, "$g_target_after_gathering", ":selected_center"),
      
      (party_slot_ge, ":selected_center", slot_center_sortie_enemy_strength, 1),
      (str_store_party_name,s4, ":selected_center"),
    ],
    "..defending {s4}?",
    "lord_strategy_why_not_reason",[
      (store_repeat_object, "$temp"),
  ]],
  
  [anyone|plyr|repeat_for_parties, "lord_strategy_why_not_select",
    [
      (store_repeat_object, ":selected_center"),
      (is_between, ":selected_center", centers_begin, centers_end),
      
      (store_faction_of_party, ":selected_center_faction", ":selected_center"),
      (store_relation, ":relation", ":selected_center_faction", "$g_talk_troop_faction"),
      (lt, ":relation", 0),
      
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_object, ":selected_center"),
      (str_store_party_name,s4, ":selected_center"),
    ],
    "..attacking {s4}?",
    "lord_strategy_why_not_reason",
    [
      (store_repeat_object, "$temp"),
      
      (try_begin),
        (eq, "$cheat_mode", 1),
        (store_sub, ":faction_recce_slot", "$g_talk_troop_faction", kingdoms_begin),
        (val_add, ":faction_recce_slot", slot_center_last_reconnoitered_by_faction_time),
        (store_current_hours, ":hours_since_last_recon"),
        (party_get_slot, ":last_recon_time", "$temp", ":faction_recce_slot"),
        (val_sub, ":hours_since_last_recon", ":last_recon_time"),
      (try_end),
  ]],
  
  [anyone, "lord_strategy_why_not_reason",
    [
      (assign, ":selected_center", "$temp"),
      (store_faction_of_party, ":selected_center_faction", ":selected_center"),
      (eq, ":selected_center_faction", "$g_talk_troop_faction"),
      (faction_get_slot, ":faction_marshal", "$g_talk_troop_faction", slot_faction_marshall),
      (call_script, "script_find_center_to_defend", ":faction_marshal"),
      (assign, ":most_threatened_center", reg0),
      (assign, ":threat_danger_level", reg1),
      (assign, ":enemy_strength_near_threatened_center", reg2),
      
      (try_begin),
        (call_script, "script_find_center_to_attack_alt", ":faction_marshal", 1, 0),
        (assign, ":target_value_level", reg1),
        (call_script, "script_find_center_to_attack_alt", ":faction_marshal", 1, 1),
        (assign, ":target_value_level_all_vassals", reg1),
        
        (try_begin),
          (ge, ":target_value_level_all_vassals", ":target_value_level"),
          (assign, ":target_value_level_max", ":target_value_level_all_vassals"),
        (else_try),
          (assign, ":target_value_level_max", ":target_value_level"),
        (try_end),
        
        (gt, ":target_value_level_max", ":threat_danger_level"),
        (assign, reg4, ":target_value_level"),
        (assign, reg5, ":threat_danger_level"),
        (str_store_string, s9, "str_reason_1"),
      (else_try),
        (assign, ":continue", 0),
        (try_begin),
          (is_between, ":selected_center", villages_begin, villages_end),
          (is_between, ":most_threatened_center", walled_centers_begin, walled_centers_end),
          (assign, ":continue", 1),
        (try_end),
        
        (try_begin),
          (is_between, ":selected_center", castles_begin, castles_end),
          (is_between, ":most_threatened_center", towns_begin, towns_end),
          (assign, ":continue", 1),
        (try_end),
        
        (eq, ":continue", 1),
        
        (str_store_party_name, s8, ":most_threatened_center"),
        #values of centers : town > castle > village
        #Situation : We are going to defend more valueable center.
        #To Steve - Please find a better explaining string for below line.
        (str_store_string, s9, "str_reason_2"),
      (else_try),
        (neq, ":most_threatened_center", ":selected_center"),
        (str_store_party_name, s8, ":most_threatened_center"),
        (str_store_string, s9, "str_reason_3"),
      (else_try),
        (troop_get_slot, ":marshal_party", ":faction_marshal", slot_troop_leaded_party),
        (party_is_active, ":marshal_party"),
        (party_get_slot, ":cached_strength", ":marshal_party", slot_party_cached_strength),
        (party_get_slot, ":follower_strength", ":marshal_party", slot_party_follower_strength),
        (store_add, ":total_strength", ":cached_strength", ":follower_strength"),
        (ge, ":enemy_strength_near_threatened_center", ":total_strength"),
        (assign, reg4, ":enemy_strength_near_threatened_center"),
        (assign, reg5, ":total_strength"),
        (str_store_string, s9, "str_reason_4"),
      (else_try),
        (str_store_string, s9, "str_reason_5"),
      (try_end),
    ],
    "{s9}",
    "lord_talk_why_not_repeat",[]],
  
  [anyone, "lord_strategy_why_not_reason",
    [
      (assign, ":selected_center", "$temp"),
      (faction_get_slot, ":faction_marshal", "$g_talk_troop_faction", slot_faction_marshall),
      
      (faction_get_slot, ":faction_ai_object", "$g_talk_troop_faction", slot_faction_ai_object),
      
      (call_script, "script_npc_decision_checklist_evaluate_enemy_center_for_attack", ":faction_marshal", ":faction_ai_object", 1, 0),
      (assign, "$g_faction_object_score", reg0),
      
      (assign, "$g_do_not_skip_other_than_current_ai_object", 1),
      (call_script, "script_npc_decision_checklist_evaluate_enemy_center_for_attack", ":faction_marshal", ":selected_center", 1, 0),
      (assign, "$g_do_not_skip_other_than_current_ai_object", 0),
      
      (lt, reg0, 0),
      (assign, ":explainer_string", reg1),
      (try_begin),
        (eq, "$g_use_current_ai_object_as_s8", 0),
        (str_store_party_name, s8, ":selected_center"),
      (else_try),
        (str_store_party_name, s8, ":faction_ai_object"),
      (try_end),
      (str_store_string, s9, ":explainer_string"),
      (str_clear, s10),
      (str_store_troop_name, s11, ":faction_marshal"),
      #s10 will say that
    ],
    "Our marshal {s11} believes that {s8} {s9}{s10}",
    "lord_talk_why_not_repeat",[]],
  
  [anyone, "lord_strategy_why_not_reason",
    [
      (faction_get_slot, ":faction_marshal", "$g_talk_troop_faction", slot_faction_marshall),
      (faction_get_slot, ":cur_object", "$g_talk_troop_faction", slot_faction_ai_object),
      
      (call_script, "script_npc_decision_checklist_evaluate_enemy_center_for_attack", ":faction_marshal", ":cur_object", 1, 0),
      (assign, ":power_ratio_for_cur_object", reg2),
      (call_script, "script_npc_decision_checklist_evaluate_enemy_center_for_attack", ":faction_marshal", "$temp", 1, 0),
      (assign, ":power_ratio_for_selected_center", reg2),
      
      (try_begin),
        (eq, ":power_ratio_for_selected_center", 0),
        (str_store_string, s7, "str_reason_6"),
      (else_try),
        (is_between, ":power_ratio_for_selected_center", 140, 200),
        (str_store_string, s7, "str_reason_7"),
      (else_try),
        (is_between, ":power_ratio_for_selected_center", 200, 300),
        (str_store_string, s7, "str_reason_8"),
      (else_try),
        (ge, ":power_ratio_for_selected_center", 300),
        (str_store_string, s7, "str_reason_9"),
      (else_try),
        (str_store_string, s7, "str_error_string"),
      (try_end),
      
      (try_begin),
        (eq, ":power_ratio_for_cur_object", 0),
        (str_store_string, s8, "str_reason_6"),
      (else_try),
        (is_between, ":power_ratio_for_cur_object", 140, 200),
        (str_store_string, s8, "str_reason_7"),
      (else_try),
        (is_between, ":power_ratio_for_cur_object", 200, 300),
        (str_store_string, s8, "str_reason_8"),
      (else_try),
        (ge, ":power_ratio_for_cur_object", 300),
        (str_store_string, s8, "str_reason_9"),
      (else_try),
        (str_store_string, s8, "str_error_string"),
      (try_end),
      
      (try_begin),
        (ge, ":cur_object", 0),
        (str_store_party_name, s4, ":cur_object"),
      (else_try),
        (ge, "$g_target_after_gathering", 0),
        (str_store_party_name, s4, "$g_target_after_gathering"),
      (else_try),
        (str_store_party_name, s4, "str_error_string"),
      (try_end),
      
      (str_store_troop_name, s5, ":faction_marshal"),
      
      (try_begin),
        (eq, "$cheat_mode", 1),
        (store_sub, ":faction_recce_slot", "$g_talk_troop_faction", kingdoms_begin),
        (val_add, ":faction_recce_slot", slot_center_last_reconnoitered_by_faction_time),
        (store_current_hours, ":hours_since_last_recon"),
        (party_get_slot, ":last_recon_time", "$temp", ":faction_recce_slot"),
        (val_sub, ":hours_since_last_recon", ":last_recon_time"),
        
        (store_sub, ":faction_recce_slot", "$g_talk_troop_faction", kingdoms_begin),
        (val_add, ":faction_recce_slot", slot_center_last_reconnoitered_by_faction_time),
        (store_current_hours, ":hours_since_last_recon"),
        (party_get_slot, ":last_recon_time", ":cur_object", ":faction_recce_slot"),
        (val_sub, ":hours_since_last_recon", ":last_recon_time"),
      (try_end),
      
      (try_begin),
        (assign, ":continue", 0),
        (try_begin),
          (party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, sfai_gathering_army),
          (lt, "$g_target_after_gathering", 0), #then this means faction is gathering army to attack a center.
          (assign, ":continue", 1),
        (try_end),
        
        (this_or_next|eq, ":continue", 1),
        (this_or_next|faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_attacking_center),
        (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_raiding_village),
        
        (str_store_string, s3, "str_has_decided_that_an_attack_on_"),
        (str_store_string, s6, "str_this_would_be_better_worth_the_effort"),
      (else_try),
        (str_store_string, s3, "str_has_decided_to_defend_"),
        (str_store_party_name, s9, "$temp"),
        (str_store_string, s6, "str_before_going_offensive_we_should_protect_our_lands_if_there_is_any_threat_so_this_can_be_reason_marshall_choosed_defending_s4"),
        (str_clear, s8),
      (try_end),
    ],
    "We could go there. {s7} However, {s5} {s3} {s4}. {s6} {s8}.",
    "lord_talk_why_not_repeat",[
  ]],
  
  [anyone,"lord_talk_why_not_repeat", [
    ],
    "Did you have any similar questions? Why we are not...",
    "lord_strategy_why_not_select",[
  ]],
  
  [anyone,"lord_talk_ask_marriage_1", [
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
    ],
    "You will not take offense if I tell you that, as a king, I have other plans for my children.",
    "lord_pretalk",[
  ]],
  
  
  [anyone,"lord_talk_ask_marriage_1", [
      (assign, "$marriage_candidate", -1),
      (try_begin),
        (troop_get_type, ":is_female", "trp_player"),
        (eq, ":is_female", 1),
        (troop_slot_eq, "$g_talk_troop", slot_troop_spouse, -1),
        (assign, "$marriage_candidate", "$g_talk_troop"),
      (else_try),
        (troop_get_type, ":is_female", "trp_player"),
        (eq, ":is_female", 0),
        (assign, "$marriage_candidate", -1),
        (try_for_range, ":lady", kingdom_ladies_begin, kingdom_ladies_end),
          (troop_slot_eq, ":lady", slot_troop_spouse, -1),
          (troop_slot_eq, ":lady", slot_troop_betrothed, -1),
          (call_script, "script_get_kingdom_lady_social_determinants", ":lady"),
          
          (eq, reg0, "$g_talk_troop"),
          
          (call_script, "script_troop_get_family_relation_to_troop", ":lady", "$g_talk_troop"),
          (assign, "$marriage_candidate", ":lady"),
          (str_store_troop_name, s14, "$marriage_candidate"),
          
          (str_store_string, s15, "str_it_is_our_custom_to_seal_any_such_alliances_with_marriage_and_in_fact_we_have_been_looking_for_a_suitable_groom_for_my_s11_s14"),
          
        (try_end),
      (try_end),
      (eq, "$marriage_candidate", -1),
    ],
    "It is our custom to seal any such alliances with marriage. Unfortunately, no one in my household is eligible to wed.",
    "lord_pretalk",[
  ]],
  
  [anyone,"lord_talk_ask_marriage_1", [
      (troop_get_type, ":type", "trp_player"),
      (eq, ":type", 0),
    ],
    "{s15}",
    "lord_courtship_pre_permission",[
  ]],
  
  [anyone,"lord_talk_ask_marriage_1", [
      (eq, "$marriage_candidate", "$g_talk_troop"),
    ],
    "Are you proposing that you and I marry?",
    "lord_marriage_proposal_female_pc_confirm",[
  ]],
  
  
  
  
  [anyone|plyr,"lord_courtship_pre_permission", [
      (neg|troop_slot_ge, "trp_player", slot_troop_spouse, 1),
      (neg|troop_slot_ge, "trp_player", slot_troop_betrothed, 1),
      
      (troop_get_type, ":is_female", "trp_player"),
      (eq, ":is_female", 0),
      
      (str_clear, s15),
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", slot_lord_granted_courtship_permission, -1),
        (str_store_string, s15, "str_once_again_"),
      (try_end),
    ],
    "May I {s15}suggest that I be considered as a groom?",
    "lord_courtship_permission",[
  ]],
  
  
  [anyone|plyr,"lord_courtship_pre_permission", [
      (eq, "$cheat_mode", 2),
    ],
    "CHEAT -- Start engagement",
    "lord_marriage_permission_engagement_date",[
      
      (setup_quest_text, "qst_formal_marriage_proposal"),
      (str_store_string, s2, "str_cheat__marriage_proposal"),
      
      (call_script, "script_start_quest", "qst_formal_marriage_proposal", "$marriage_candidate"),
      (quest_set_slot, "qst_formal_marriage_proposal", slot_quest_giver_troop, "$marriage_candidate"),
  ]],
  
  
  
  [anyone|plyr,"lord_courtship_pre_permission", [
    ],
    "Never mind",
    "lord_pretalk",[
  ]],
  
  
  
  
  
  [anyone|plyr,"lord_marriage_proposal_female_pc_confirm", [
    ],
    "Yes. That is my proposal.",
    "lord_marriage_proposal_female_pc_reax",[
  ]],
  
  [anyone|plyr,"lord_marriage_proposal_female_pc_confirm", [
    ],
    "No, I think you have misunderstood me.",
    "lord_pretalk",[
  ]],
  
  [anyone,"lord_marriage_proposal_female_pc_reax", [
      (call_script, "script_npc_decision_checklist_marry_female_pc", "$g_talk_troop"),
      (le, reg0, 0),
    ],
    "{s14}",
    "lord_pretalk",[
  ]],
  
  [anyone,"lord_marriage_proposal_female_pc_reax", [
      (call_script, "script_npc_decision_checklist_marry_female_pc", "$g_talk_troop"),
      (eq, reg0, 2),
    ],
    "{s14}",
    "lord_pretalk",[
      (troop_set_slot, "$g_talk_troop", slot_troop_met, 2),
  ]],
  
  [anyone,"lord_marriage_proposal_female_pc_reax", [
    ],
    "{s14}",
    "lord_marriage_proposal_female_pc_next_step",[
  ]],
  
  #  [anyone,"lord_marriage_proposal_female_pc_next_step", [
  #  ],
  #   "I must say, though. You live your life like a man, riding where you will, with the company you choose. This will not make it easy for the other lords to accept our marriage. I don't suppose that you would give up adventuring, for the sake of our marriage?",
  #   "lord_marriage_proposal_female_pc_next_step_2",[
  #   ]],
  
  #   [anyone|plyr,"lord_marriage_proposal_female_pc_next_step_2", [
  #  ],
  #   "I think not!",
  #   "lord_marriage_proposal_female_pc_next_step_3",[
  #   ]],
  
  [anyone,"lord_marriage_proposal_female_pc_next_step", [
    ],
    "I suppose the next step would be for me to send a message to your family, asking for their permission to marry you, but I suppose that you make your own decisions.",
    "lord_marriage_proposal_female_pc_next_step_4",[
  ]],
  
  [anyone|plyr,"lord_marriage_proposal_female_pc_next_step_4", [
    ],
    "You assume correctly.",
    "lord_marriage_proposal_female_pc_next_step_5",[
  ]],
  
  [anyone,"lord_marriage_proposal_female_pc_next_step_5", [
    ],
    "Very well, then. As there are no obstacles to our marriage, should we then consider ourselves engaged to be wed? I will organize a great feast, and we can exchange our vows before all the lords of the realm. If you are willing, that is...",
    "lord_marriage_proposal_female_pc_confirm_engagement",[
  ]],
  
  [anyone|plyr,"lord_marriage_proposal_female_pc_confirm_engagement", [
    ],
    "I am willing.",
    "lord_marriage_proposal_female_pc_confirm_engagement_yes",[
      (troop_set_slot, "$g_talk_troop", slot_troop_betrothed, "trp_player"),
      (troop_set_slot, "trp_player", slot_troop_betrothed, "$g_talk_troop"),
      
      (assign, "$g_other_quest", 0),
      (try_begin),
        (store_partner_quest, ":other_quest", "$g_talk_troop"),
        (gt, ":other_quest", 0),
        (assign, "$g_other_quest", ":other_quest"),
      (try_end),
      
      (str_store_troop_name, s4, "$g_talk_troop"),
      
      (setup_quest_text, "qst_wed_betrothed_female"),
      (str_store_string, s2, "str_you_plan_to_marry_s4_as_you_have_no_family_in_calradia_he_will_organize_the_wedding_feast"),
      
      (call_script, "script_start_quest", "qst_wed_betrothed_female", "$g_talk_troop"),
      
      (quest_set_slot, "qst_wed_betrothed_female", slot_quest_expiration_days, 120),
      (quest_set_slot, "qst_wed_betrothed_female", slot_quest_giver_troop, "$g_talk_troop"),
      
  ]],
  
  [anyone|plyr,"lord_marriage_proposal_female_pc_confirm_engagement", [
    ],
    "Actually, I would like to reconsider.",
    "lord_marriage_proposal_female_pc_confirm_engagement_no",[
      
  ]],
  
  [anyone,"lord_marriage_proposal_female_pc_confirm_engagement_yes", [
      
      (str_clear, s12),
      (try_begin),
        (gt, "$g_other_quest", 0),
        (call_script, "script_succeed_quest", "$g_other_quest"),
        (call_script, "script_end_quest", "$g_other_quest"),
        (str_store_string, s12, "str_cancel_fiancee_quest"),
      (try_end),
    ],
    "Very well. Hopefully, a little over a month from now, we shall be wed.{s12}",
    "close_window",[
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone,"lord_marriage_proposal_female_pc_confirm_engagement_no", [
    ],
    "Take whatever time you need, my lady.",
    "close_window",[
      (assign, "$g_leave_encounter", 1),
  ]],
  
  
  
  #continue marriage talks hereCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
  
  [anyone|plyr,"lord_talk", [(eq,"$talk_context",tc_party_encounter),
      (lt, "$g_encountered_party_relation", 0),
      (str_store_troop_name,s4,"$g_talk_troop")],
    "I say this only once, {s4}! Surrender or die!", "party_encounter_lord_hostile_ultimatum_surrender", []],
  
  [anyone,"party_encounter_lord_hostile_ultimatum_surrender", [],
    "{s43}", "close_window", [
      (play_sound, "snd_enemi_greetings"),
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_lord_challenged_default"),
      
      (call_script, "script_make_kingdom_hostile_to_player", "$g_encountered_party_faction", -3),
      
      (try_begin),
        (gt, "$g_talk_troop_relation", -10),
        (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -1),
      (try_end),
      (assign,"$encountered_party_hostile",1),
      (assign,"$encountered_party_friendly",0),]],
  
  
  [anyone|plyr,"lord_talk", [(eq,"$talk_context", tc_party_encounter),
      (neq,"$g_encountered_party_faction","$players_kingdom"),
      (ge, "$g_encountered_party_relation", 0),
      ], "I'm here to deliver you my demands!", "lord_predemand",[]],
  [anyone,"lord_predemand", [], "Eh? What do you want?", "lord_demand",[]],
  
  [anyone|plyr,"lord_demand", [(neq,"$g_encountered_party_faction","$players_kingdom"),
      (ge, "$g_encountered_party_relation", 0),], "I offer you one chance to surrender or die.", "lord_ultimatum_surrender",[]],
  
  #Neutral attack on lord
  [anyone,"lord_ultimatum_surrender", [(ge, "$g_encountered_party_relation", 0)], "{s43}", "lord_attack_verify",[#originally, speak you rascal
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_unprovoked_attack_default"),
      (try_begin),
        (faction_slot_ge, "$g_encountered_party_faction", slot_faction_truce_days_with_factions_begin, 1),
        (str_store_faction_name, s34, "$g_encountered_party_faction"),
        (str_store_string, s43, "str_s43_just_so_you_know_if_you_attack_me_you_will_be_in_violation_of_the_truce_you_signed_with_the_s34"),
      (try_end),
      (try_begin),
        (eq, "$players_kingdom", "fac_player_supporters_faction"),
        (faction_slot_eq, "fac_player_supporters_faction", slot_faction_leader, "trp_player"),
        (str_store_string, s43, "str_s43_also_you_should_know_that_an_unprovoked_assault_is_declaration_of_war"),
      (try_end),
      
  ]],
  
  [anyone|plyr,"lord_attack_verify", [], "Forgive me sir. I don't know what I was thinking.", "lord_attack_verify_cancel",[]],
  [anyone,"lord_attack_verify_cancel", [], "Be gone, then.", "close_window",[(call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -1),(assign, "$g_leave_encounter",1)]],
  [anyone|plyr,"lord_attack_verify", [], "That is none of your business. Prepare to fight!", "lord_attack_verify_commit",[
  ]],
  
  #The kingdoms are already at war
  [anyone,"lord_ultimatum_surrender", [], "{s43}", "lord_attack_verify_b", #originally, you will not survive this
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_unnecessary_attack_default"),
      (call_script, "script_make_kingdom_hostile_to_player", "$g_encountered_party_faction", -3),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -5),
      
      (assign,"$encountered_party_hostile",1),
      (assign,"$encountered_party_friendly",0),
  ]],
  
  [anyone|plyr,"lord_attack_verify_b", [], "Forgive me sir. I don't know what I was thinking.", "lord_attack_verify_cancel",[]],
  [anyone|plyr,"lord_attack_verify_b", [], "I stand my ground. Prepare to fight!", "lord_attack_verify_commit",[]],
  
  [anyone,"lord_attack_verify_commit", [], "{s43}", "close_window",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_lord_challenged_default"),
      (try_begin),
        (ge, "$g_encountered_party_relation", 0),
        (call_script, "script_diplomacy_party_attacks_neutral", "p_main_party", "$g_encountered_party"),
      (try_end),
      (try_begin), #this try is added so that a player  monarch ccannot spark a war by attacking a neutral. The player does however cause a provocation, which may allow the other side to go to war
        #If a player can create a hostile faction simply by attacking, this will allow a number of exploits. Therefore, it is quite important to keep this condition in here for active player kingdoms
        (neq, "$players_kingdom", "fac_player_supporters_faction"),
        (call_script, "script_make_kingdom_hostile_to_player", "$g_encountered_party_faction", -3),
      (else_try),
        (eq, "$players_kingdom", "fac_player_supporters_faction"),
        (call_script, "script_diplomacy_start_war_between_kingdoms",  "fac_player_supporters_faction", "$g_encountered_party_faction", 1),
      (try_end),
      
      #   (call_script, "script_make_kingdom_hostile_to_player", "$g_encountered_party_faction", -3),
      (assign,"$encountered_party_hostile",1),
      (assign,"$encountered_party_friendly",0),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -30),
  ]],
  #Post 0907 changes end
  
  [anyone|plyr,"lord_demand", [], "Forgive me. It's nothing.", "lord_pretalk",[]],
  
  
  ##  [anyone|plyr,"lord_talk", [(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                             (ge, "$g_talk_troop_faction_relation", 0),
  ##                             ],
  ##   "I wish to ask for a favor.", "lord_ask_for_favor_ask",[]],
  
  
  
  [anyone|plyr,"lord_talk", [
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
      (troop_slot_eq, "$g_talk_troop", slot_troop_discussed_rebellion, 0),
      (assign, ":pretender", 0),
      (try_for_range, ":possible_pretender", pretenders_begin, pretenders_end),
        (troop_slot_eq, ":possible_pretender", slot_troop_original_faction, "$g_talk_troop_faction"),
        (assign, ":pretender", ":possible_pretender"),
      (try_end),
      (troop_slot_ge, ":pretender", slot_troop_met, 1),
      (str_store_troop_name, s45, ":pretender"),
      (troop_get_type, reg3, ":pretender"),
    ],
    "I have met in my travels one who calls {reg3?herself:himself} {s45}...", "liege_defends_claim_1",[
  ]],
  
  [anyone,"liege_defends_claim_1", [],
    "Oh really? It is not everyone who dares mention that name in my presence. I am not sure whether to reward your bravery, or punish you for your impudence.", "liege_defends_claim_2", [
      (troop_set_slot, "$g_talk_troop", slot_troop_discussed_rebellion, 1),
  ]],
  
  [anyone,"liege_defends_claim_2", [],
    "Very well. I will indulge your curiosity. But listen closely, because I do not wish to speak of this matter again.", "liege_defends_claim_3", [
  ]],
  
  [anyone,"liege_defends_claim_3", [],
    "{s48}", "liege_defends_claim_4", [
      (store_sub, ":rebellion_string", "$g_talk_troop_faction", "fac_kingdom_1"),
      (val_add, ":rebellion_string", "str_swadian_rebellion_monarch_response_1"),
      (str_store_string, 48, ":rebellion_string"),
  ]],
  
  [anyone,"liege_defends_claim_4", [],
    "{s48}", "lord_talk", [
      (store_sub, ":rebellion_string", "$g_talk_troop_faction", "fac_kingdom_1"),
      (val_add, ":rebellion_string", "str_swadian_rebellion_monarch_response_2"),
      (str_store_string, 48, ":rebellion_string"),
  ]],
  
  
  #Rebellion changes begin
  #  [anyone|plyr,"lord_talk", [
  #                             (gt, "$supported_pretender", 0),
  #                             (eq, "$supported_pretender_old_faction", "$g_talk_troop_faction"),
  #                             (troop_slot_eq, "$g_talk_troop", slot_troop_discussed_rebellion, 0),
  #                             (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
  #                             (troop_slot_ge, "$g_talk_troop", slot_troop_leaded_party, 1),
  #                             (str_store_troop_name, s12, "$supported_pretender"),
  #                             (str_store_faction_name, s14, "$supported_pretender_old_faction"),
  #                             (faction_get_slot, ":old_faction_lord", "$supported_pretender_old_faction", slot_faction_leader),
  #                             (str_store_troop_name, s15, ":old_faction_lord"),
  #                             ],
  #   "{s12} is the rightful ruler of {s14}. Join our cause against the usurper, {s15}!", "lord_join_rebellion_suggest",[]],
  
  [anyone|plyr,"lord_talk",
    [
      (eq, "$cheat_mode", 2),
      (gt, "$supported_pretender", 0),
      (eq, "$supported_pretender_old_faction", "$g_talk_troop_faction"),
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
      (troop_slot_ge, "$g_talk_troop", slot_troop_leaded_party, 1),
    ],
    "{!}CHEAT - Join our cause by force.", "lord_join_rebellion_suggest_cheat",[]],
  
  [anyone|plyr,"party_encounter_lord_hostile_attacker_2",
    [
      (eq, "$cheat_mode", 2),
      (gt, "$supported_pretender", 0),
      (eq, "$supported_pretender_old_faction", "$g_talk_troop_faction"),
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
      (troop_slot_ge, "$g_talk_troop", slot_troop_leaded_party, 1),
    ],
    "{!}CHEAT - Join our cause by force.", "lord_join_rebellion_suggest_cheat",[]],
  
  [anyone,"lord_join_rebellion_suggest_cheat",
    [], "Cheat:Allright.",
    "lord_join_rebellion_ask_for_order",
    [
      (troop_set_slot, "$g_talk_troop", slot_troop_discussed_rebellion, 1),
      (call_script, "script_change_troop_faction", "$g_talk_troop", "$players_kingdom"),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  #  [anyone|plyr,"party_encounter_lord_hostile_attacker_2", [
  #                             (gt, "$supported_pretender", 0),
  #                             (eq, "$supported_pretender_old_faction", "$g_talk_troop_faction"),
  #                             (neg|troop_slot_ge, "$g_talk_troop", slot_troop_intrigue_impatience, 100),
  #                             (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
  #                             (troop_slot_ge, "$g_talk_troop", slot_troop_leaded_party, 1),
  #                             (str_store_troop_name, s12, "$supported_pretender"),
  #                             (str_store_faction_name, s14, "$supported_pretender_old_faction"),
  #                             (faction_get_slot, ":old_faction_lord", "$supported_pretender_old_faction", slot_faction_leader),
  #                             (str_store_troop_name, s15, ":old_faction_lord"),
  #                             ],
  #   "{s12} is your rightful ruler. Join our cause against the usurper, {s15}!", "lord_join_rebellion_suggest",[]],
  
  
  
  #  [anyone,"lord_join_rebellion_suggest", [
  #                    (eq,"$talk_context",tc_party_encounter),
  #                    (encountered_party_is_attacker),
  #                    (lt, "$g_talk_troop_relation", -5),
  #      ], "I have no time to bandy words with the likes of you. Now defend yourself!",
  #   "party_encounter_lord_hostile_attacker_2",
  #   [
  #    (try_begin),
  #		(neg|troop_slot_ge, "$g_talk_troop", slot_troop_intrigue_impatience, 100),
  #		(troop_set_slot, "$g_talk_troop", slot_troop_intrigue_impatience, 100),
  #	(try_end),
  
  #    ]],
  
  
  #removed a number of rebellion scripts...
  
  #Rebellion changes end
  
  
  [anyone|plyr,"lord_talk",
    [
      (troop_get_slot, ":prison_location", "$g_talk_troop", slot_troop_prisoner_of_party),
      (is_between, ":prison_location", centers_begin, centers_end),
      (neg|party_slot_eq, ":prison_location", slot_town_lord, "trp_player"),
      (neq, "$talk_context", tc_prison_break),
    ],
    "I've come to break you out of here.", "lord_prison_break_chains",[]],
  
  [anyone,"lord_prison_break_chains", [],
    "Thank the heavens you came! However, I'm not going anywhere with these chains on my legs. You'll need to get the key away from the guard somehow.", "close_window",[]],
  
  [anyone|plyr,"lord_talk",
    [
      (ge, "$cheat_mode", 1),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
    ],
    "{!}CHEAT - Take the following action.", "lord_suggest_action_ask",[]],
  
  
  [anyone,"lord_tell_objective",
    [
      (troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
    ],
    "What am I doing? What does it look like I'm doing?! I'm a prisoner here!", "lord_pretalk",[]],
  
  [anyone,"lord_tell_objective",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_leaded_party, -1)
    ],
    "I am not commanding any men at the moment.", "lord_pretalk",[]],
  
  
  
  
  
  #sdsd
  [anyone,"lord_tell_objective", [
      (party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_holding_center),
      (party_get_attached_to, ":cur_center_no", "$g_talk_troop_party"),
      (try_begin),
        (lt, ":cur_center_no", 0),
        (party_get_cur_town, ":cur_center_no", "$g_talk_troop_party"),
      (try_end),
      (is_between, ":cur_center_no", centers_begin, centers_end),
    ],
    "We are resting at {s1}. {s14}{s15}",
    "lord_pretalk",
    [(party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
      (str_store_party_name, s1, ":ai_object")]],
  
  
  
  
  
  
  
  [anyone,"lord_tell_objective", [(party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_holding_center)],
    "We are travelling to {s1}. {s14}{s15}", "lord_pretalk",
    [(party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
      (str_store_party_name, s1, ":ai_object"),
  ]],
  
  [anyone|auto_proceed,"lord_tell_objective", [
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_marshall, "$g_talk_troop"),
      (party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_visiting_village)],
    "{!}Warning: This line should never display.", "lord_tell_objective_2",
    []],
  
  #fix for translation variable changes
  [anyone,"lord_tell_objective_2", [],
    "I am heading to the vicinity of {s1}. {s14}{s15}", "lord_pretalk",
    [(party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
      (str_store_party_name, s1, ":ai_object")]],
  
  [anyone,"lord_tell_objective", [
      (party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_visiting_village)],
    "We are recruiting new soldiers from {s1}. {s14}{s15}", "lord_pretalk",
    [(party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
      (str_store_party_name, s1, ":ai_object")]],
  
  
  
  
  [anyone,"lord_tell_objective", [(party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_patrolling_around_center)],
    "We are scouting for the enemy around {s1}. {s14}{s15}", "lord_pretalk",
    [(party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
      (str_store_party_name, s1, ":ai_object"),
  ]],
  
  #  [anyone,"lord_tell_objective", [(party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_raiding_around_center)],
  #   "We ride out to lay waste to village of {s1} to punish the foe for his misdeeds.", "lord_pretalk",[(party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
  #                                                               (str_store_party_name, s1, ":ai_object")]],
  
  [anyone,"lord_tell_objective", [
      (party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_raiding_around_center),
      (party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
      (str_store_party_name, s1, ":ai_object")
    ],
    "We are laying waste to the village of {s1}. {s14}{s15}", "lord_pretalk",[]],
  
  [anyone,"lord_tell_objective", [(party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_retreating_to_center)],
    "We are retreating to {s1}. {s14}{s15}", "lord_pretalk",[(party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
      (str_store_party_name, s1, ":ai_object")]],
  
  [anyone,"lord_tell_objective", [(party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_besieging_center)],
    "We are besieging {s1}. {s14}{s15}", "lord_pretalk",[(party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
      (str_store_party_name, s1, ":ai_object")]],
  
  [anyone,"lord_tell_objective", [(party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_engaging_army),
      (party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
      (party_is_active, ":ai_object"),
    ],
    "We are fighting against {s1}. {s14}{s15}", "lord_pretalk",
    [
      (party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
      (str_store_party_name, s1, ":ai_object")
  ]],
  
  [anyone,"lord_tell_objective", [
      (party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_screening_army)],
    "I am screening {s1}'s advance. {s14}{s15}", "lord_pretalk",[
      (party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
      (party_stack_get_troop_id, ":ai_object_commander", ":ai_object", 0),
      (str_store_troop_name, s1, ":ai_object_commander")
  ]],
  
  
  [anyone,"lord_tell_objective", [(party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_accompanying_army)],
    "We are accompanying {s1}. {s14}{s15}", "lord_pretalk",[(party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
      (str_store_party_name, s1, ":ai_object")]],
  
  
  [anyone,"lord_tell_objective",
    [
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_marshall, "$g_talk_troop"),
      (neg|faction_slot_eq,  "$g_talk_troop_faction", slot_faction_ai_state, sfai_default),
      (neg|faction_slot_eq,  "$g_talk_troop_faction", slot_faction_ai_state, sfai_feast),
    ],
    "I am leading the army of the realm.", "lord_talk_ask_about_strategy",[]],
  
  
  [anyone,"lord_tell_objective",
    [
      (assign, ":pass", 0),
      (try_begin),
        (party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_undefined),
        (assign, ":pass", 1),
      (else_try),
        (party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_engaging_army),
        (party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
        (neg|party_is_active, ":ai_object"),
        (assign, ":pass", 1),
      (try_end),
      (eq, ":pass", 1),
    ],
    "We are reconsidering our next objective.", "lord_pretalk",[]],
  
  [anyone,"lord_tell_objective", [],
    "I don't know: {reg1} {s1} (ERROR)", "lord_pretalk",[(party_get_slot, reg1, "$g_talk_troop_party", slot_party_ai_state),
      (party_get_slot, ":ai_object", "$g_talk_troop_party", slot_party_ai_object),
      (str_store_party_name, s1, ":ai_object")]],
  
  [anyone|plyr,"lord_talk",
    [
      (eq, "$talk_context", tc_party_encounter),
      (eq, 1, 0),
      (eq, "$g_talk_troop_faction", "$players_kingdom"),
      (party_slot_eq, "$g_encountered_party", slot_party_following_player, 0),
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_marshall, "trp_player"),
    ],
    "Will you follow me? I have a plan.", "lord_ask_follow",[]],
  
  [anyone,"lord_ask_follow", [(party_get_slot, ":dont_follow_until_time", "$g_encountered_party", slot_party_dont_follow_player_until_time),
      (store_current_hours, ":cur_time"),
      (lt, ":cur_time", ":dont_follow_until_time")],
    "I enjoy your company, {playername}, but there are other things I must attend to. Perhaps in a few days I can ride with you again.", "close_window",
    [(assign, "$g_leave_encounter",1)]],
  
  [anyone,"lord_ask_follow", [(troop_get_slot, ":troop_renown", "$g_talk_troop", slot_troop_renown),
      (troop_get_slot, ":player_renown", "trp_player", slot_troop_renown),
      (val_mul, ":troop_renown", 3),
      (val_div, ":troop_renown", 4),
      (lt, ":player_renown", ":troop_renown"),
    ],
    "That would hardly be proper, {playername}. Why don't you follow me instead?", "close_window",
    [(assign, "$g_leave_encounter",1)]],
  
  [anyone,"lord_ask_follow", [(lt, "$g_talk_troop_effective_relation", 25)],
    "{s43}", "close_window",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_lord_follow_refusal_default"),
      (assign, "$g_leave_encounter",1)]],
  #Post 0907 changes end
  
  [anyone,"lord_ask_follow", [],
    "Lead the way, {playername}! Let us bring death and defeat to all our enemies.", "close_window",
    [(party_set_slot, "$g_talk_troop_party", slot_party_commander_party, "p_main_party"),
      #(call_script, "script_party_decide_next_ai_state_under_command", "$g_talk_troop_party"),
      (call_script, "script_npc_decision_checklist_party_ai", "$g_talk_troop"), #This handles AI for both marshal and other parties
      (call_script, "script_party_set_ai_state", "$g_talk_troop_party", reg0, reg1),
      
      (store_current_hours, ":follow_until_time"),
      (store_add, ":follow_period", 30, "$g_talk_troop_relation"),
      (val_div, ":follow_period", 2),
      (val_add, ":follow_until_time", ":follow_period"),
      (party_set_slot, "$g_encountered_party", slot_party_follow_player_until_time, ":follow_until_time"),
      (party_set_slot, "$g_encountered_party", slot_party_following_player, 1),
      (assign, "$g_leave_encounter",1)]],
  
  [anyone,"lord_talk_preoffer", [], "Yes?", "lord_talk_offer",[]],
  
  
  ##  [anyone|plyr,"lord_talk_offer", [(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                             (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"), #he is not a faction leader!
  ##                             (call_script, "script_get_number_of_hero_centers", "$g_talk_troop"),
  ##                             (eq, reg0, 0), #he has no castles or towns
  ##                             (hero_can_join),
  ##                             ],
  ##   "I need capable men like you. Will you join me?", "knight_offer_join",[
  ##       ]],
  
  [anyone|plyr,"lord_talk_offer", [(eq,1,0)],
    "I wish to ransom one of your prisoners.", "knight_offer_join",[
  ]],
  
  [anyone|plyr,"lord_talk_offer", [], "Never mind.", "lord_pretalk",[]],
  
  [anyone ,"knight_offer_join", [(call_script, "script_cf_is_quest_troop", "$g_talk_troop")],
    "I fear I cannot join you at the moment, {playername}, I've important business to attend to and it cannot wait.", "hero_pretalk",[]],
  
  [anyone ,"knight_offer_join", [(lt, "$g_talk_troop_relation", 5),
      (store_character_level,":player_level","trp_player"),
      (store_character_level,":talk_troop_level","$g_talk_troop"),
      (val_mul,":player_level",2),
      (lt, ":player_level", ":talk_troop_level")],
    "You forget your place, {sir/madam}. I do not take orders from the likes of you.", "hero_pretalk",[]],
  
  [anyone ,"knight_offer_join", [
      (assign, ":num_player_companions",0),
      (try_for_range, ":hero_id", heroes_begin, heroes_end),
        (troop_slot_eq, ":hero_id",slot_troop_occupation, slto_player_companion),
        (val_add, ":num_player_companions",1),
      (try_end),
      (assign, reg5, ":num_player_companions"),
      (store_add, reg6, reg5, 1),
      (val_mul, reg6,reg6),
      (val_mul, reg6, 1000),
      (gt, reg6,0)], #note that we abuse the value of reg6 in the next line.
    "I would be glad to fight at your side, my friend, but there is a problem... " +
    "The thing is, I've found myself in a bit of debt that I must repay very soon. {reg6} denars altogether, " +
    "and I am honour-bound to return every coin. Unless you've got {reg6} denars with you that you can spare, " +
    "I've to keep my mind on getting this weight off my neck.", "knight_offer_join_2",[]],
  [anyone ,"knight_offer_join", [(gt,reg6, 100000)], "Join you? I think not.", "close_window",[]],
  [anyone ,"knight_offer_join", [], "Aye, my friend, I'll be happy to join you.", "knight_offer_join_2",[]],
  
  [anyone|plyr,"knight_offer_join_2", [(gt, reg6,0),(store_troop_gold, ":gold", "trp_player"),(gt,":gold",reg6)],
    "Here, take it, all {reg6} denars you need. 'Tis only money.", "knight_offer_join_accept",[(troop_remove_gold, "trp_player",reg6)]],
  [anyone|plyr,"knight_offer_join_2", [(le, reg6,0)], "Then let us ride together, my friend.", "knight_offer_join_accept",[]],
  
  [anyone|plyr,"knight_offer_join_2", [(eq, "$talk_context", tc_hero_freed)], "That's good to know. I will think on it.", "close_window",[]],
  [anyone|plyr,"knight_offer_join_2", [(neq, "$talk_context", tc_hero_freed)], "That's good to know. I will think on it.", "hero_pretalk",[]],
  
  
  [anyone ,"knight_offer_join_accept", [(troop_slot_ge, "$g_talk_troop", slot_troop_leaded_party, 1)],
    "I've some trusted men in my band who could be of use to you. What do you wish to do with them?", "knight_offer_join_accept_party",[
  ]],
  [anyone ,"knight_offer_join_accept", [], "Ah, certainly, it might be fun!", "close_window",[
      (call_script, "script_recruit_troop_as_companion", "$g_talk_troop"),
      (assign, "$g_leave_encounter",1)
  ]],
  
  [anyone|plyr,"knight_offer_join_accept_party", [], "You may disband your men. I've no need for other troops.", "knight_join_party_disband",[]],
  [anyone|plyr,"knight_offer_join_accept_party", [(troop_get_slot, ":companions_party","$g_talk_troop", slot_troop_leaded_party),
      (party_can_join_party,":companions_party","p_main_party"),
      ], "Your men may join as well. We need every soldier we can muster.", "knight_join_party_join",[]],
  [anyone|plyr,"knight_offer_join_accept_party", [(is_between,"$g_encountered_party",centers_begin, centers_end)], "Lead your men out of the town. I shall catch up with you on the road.", "knight_join_party_lead_out",[]],
  [anyone|plyr,"knight_offer_join_accept_party", [(neg|is_between,"$g_encountered_party",centers_begin, centers_end)],
    "Keep doing what you were doing. I'll catch up with you later.", "knight_join_party_lead_out",[]],
  
  
  [anyone ,"knight_join_party_disband", [], "Ah . . . Very well, {playername}. Much as I dislike losing good men, " +
    "the decision is yours. I'll disband my troops and join you.", "close_window",[
      (call_script, "script_recruit_troop_as_companion", "$g_talk_troop"),
      
      (troop_get_slot, ":companions_party","$g_talk_troop", slot_troop_leaded_party),
      (party_detach, ":companions_party"),
      (remove_party, ":companions_party"),
      (assign, "$g_leave_encounter",1)
  ]],
  
  [anyone ,"knight_join_party_join", [], "Excellent. " +
    "My lads and I will ride with you.", "close_window",[
      (call_script, "script_recruit_troop_as_companion", "$g_talk_troop"),
      (party_remove_members, "p_main_party", "$g_talk_troop", 1),
      
      (troop_get_slot, ":companions_party","$g_talk_troop", slot_troop_leaded_party),
      (assign, "$g_move_heroes", 1),
      (call_script, "script_party_add_party", "p_main_party", ":companions_party"),
      (party_detach, ":companions_party"),
      (remove_party, ":companions_party"),
      (assign, "$g_leave_encounter",1)
  ]],
  
  [anyone ,"knight_join_party_lead_out", [], "Very well then. " +
    "I shall maintain a patrol of this area. Return if you have further orders for me.", "close_window",[
      (call_script, "script_recruit_troop_as_companion", "$g_talk_troop"),
      (party_remove_members, "p_main_party", "$g_talk_troop", 1),
      
      (troop_get_slot, ":companions_party","$g_talk_troop", slot_troop_leaded_party),
      (party_set_faction, ":companions_party", "fac_player_supporters_faction"),
      (party_detach, ":companions_party"),
      (party_set_ai_behavior, ":companions_party", ai_bhvr_patrol_location),
      (party_set_flags, ":companions_party", pf_default_behavior, 0),
  ]],
  
  [anyone,"lord_enter_service_reject", [
      (eq, "$players_kingdom", "fac_player_supporters_faction"),
    ], "Indeed.... Did you offer vassalage, then, just to by time? Very well -- you shall have time to reconsider, but if you are toying with me, it will do your reputation no credit.", "close_window",
    [
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone,"lord_give_oath_give_up", [
      (eq, "$players_kingdom", "fac_player_supporters_faction"),
    ], "Indeed.... Did you offer vassalage, then, just to buy time? Very well -- you shall have time to reconsider, but if you are toying with me, it will do your reputation no credit.", "close_window",
    [
      (assign, "$g_leave_encounter", 1),
  ]],
  
  
  
  [anyone,"lord_enter_service_reject", [], "What pigswill! " +
    "And to think I would offer you a place among my nobles. Begone, beggar, before I lose my temper!", "close_window",
    [
      (try_begin),
        (store_partner_quest, ":lords_quest"),
        (eq, ":lords_quest", "qst_join_faction"),
        (call_script, "script_abort_quest", "qst_join_faction", 1),
      (try_end),
      (assign, "$g_invite_faction", 0),
      (assign, "$g_invite_faction_lord", 0),
      (assign, "$g_invite_offered_center", 0),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone,"lord_ask_enter_service", [(gt, "$players_kingdom", 0),
      (neq, "$players_kingdom", "$g_talk_troop_faction"),
      (faction_get_slot, ":players_lord", "$players_kingdom", slot_faction_leader),
      (neq, ":players_lord", "trp_player"),
      (str_store_troop_name, s5, ":players_lord"),
      ], "You are already oath-bound to serve {s5}, are you not?", "lord_give_oath_under_oath_already",[]],
  [anyone|plyr ,"lord_give_oath_under_oath_already", [], "Indeed I am, {s65}. Forgive my rambling.", "lord_pretalk",[]],
  
  [anyone,"lord_ask_enter_service", [(lt, "$g_talk_troop_effective_relation", -5)], "I accept oaths only from those I can trust to keep them, {playername}.", "lord_pretalk",[]],
  
  [anyone,"lord_ask_enter_service", [
      (troop_get_type, ":type", "trp_player"),
      (eq, ":type", 1),
      
      
      (try_for_range, ":center", centers_begin, centers_end),
        (party_slot_eq, ":center", slot_town_lord, "trp_player"),
        (assign, "$bypass_female_vassal_explanation", 1),
      (try_end),
      (eq, "$bypass_female_vassal_explanation", 0),
      
      #  (troop_get_slot, ":husband", "trp_player", slot_troop_spouse),
      ], "My lady, you seem to have the makings of a good war leader. For a woman to show such skill is an uncommon thing in France, but not completely without precedent. Noblewomen have often taken command of armies after their husbands or fathers were slain or captured, for example.", "lord_ask_enter_service_female_2",[
      (assign, "$bypass_female_vassal_explanation", 1),
      
  ]],
  
  [anyone,"lord_ask_enter_service_female_2", [
      ], "However, I have never heard of a king who granted a fief to a woman, no matter how valorous, simply because he needed an extra vassal. Were I to do such a thing, I would raise eyebrows across France. Men would say that I was besotted or bewitched, or that I aimed to overturn the natural order of things. As much as I regret it, I cannot afford to grant you a fief.", "lord_ask_enter_service_female_response",[]],
  
  [anyone|plyr, "lord_ask_enter_service_female_response", [],
    "What if I were to take one of your enemy's castles by force?", "lord_ask_enter_service_female_solution_capture", []],
  
  [anyone|plyr, "lord_ask_enter_service_female_response", [
      (neg|troop_slot_ge, "trp_player", slot_troop_spouse, active_npcs_begin),
    ],
    "What if I were to marry one of your lords?", "lord_ask_enter_service_female_solution_marriage", []],
  
  [anyone|plyr, "lord_ask_enter_service_female_response", [],
    "Perhaps one of your competitors will prove to be more open-minded.", "lord_ask_enter_service_female_solution_competitor", []],
  
  [anyone|plyr, "lord_ask_enter_service_female_response", [],
    "I would be willing to fight for you, even without the fief.", "lord_ask_enter_service", []],
  
  [anyone|plyr, "lord_ask_enter_service_female_response", [],
    "Never mind.", "lord_pretalk", []],
  
  [anyone,"lord_ask_enter_service_female_solution_marriage", [
      ], "Well, I still would not be willing to grant you any fiefs. However, you would no doubt have the use of your husband's properties, which would allow you to act as one of my vassals in all but name. Did you have an other questions?", "lord_ask_enter_service_female_response",[]],
  
  [anyone,"lord_ask_enter_service_female_solution_competitor", [
      ], "Oh, perhaps you might find someone who was truly desperate -- but then, I would think, they would not have many fiefs to bestow. Did you have an other questions?", "lord_ask_enter_service_female_response",[]],
  
  [anyone,"lord_ask_enter_service_female_solution_capture", [
      ], "Well, in that case, depending on the circumstances, I might be inclined to let you keep it. Did you have an other questions?", "lord_ask_enter_service_female_response",[]],
  
  
  [anyone,"lord_ask_enter_service",
    [
      (player_has_item, "itm_plis_recomandation"),#### lettre de recomandation!
      (assign, "$g_invite_offered_center", -1),
      (troop_get_slot, ":renown", "trp_player", slot_troop_renown),
      (store_mul, ":vassal_potential", "$g_talk_troop_effective_relation", 5),
      (val_add, ":vassal_potential", ":renown"),
      (call_script, "script_get_number_of_hero_centers", "trp_player"),
      (assign, ":num_centers_owned", reg0),
      (store_mul, ":center_affect", ":num_centers_owned", 50),
      (val_add, ":vassal_potential", ":center_affect"),
      (ge, ":vassal_potential", 150),
      #
      (try_begin),
        (troop_get_type, ":is_female", "trp_player"),
        (eq, ":is_female", 0),
        (eq, ":num_centers_owned", 0),
        (call_script, "script_get_poorest_village_of_faction", "$g_talk_troop_faction"),
        (gt, reg0, 0),
        (assign, "$g_invite_offered_center", reg0),
      (try_end),
    ],
    "You are known as a brave {man-at-arms/warrior} and a fine leader of men, {playername}. " +
    "I shall be pleased to accept your sword into my service and bestow vassalage upon you, " +
    "if you are ready to swear homage to me.", "lord_give_oath_1",[]],
  
  [anyone,"lord_ask_enter_service", [], "You've yet to show yourself as a competent commander, {playername}. " +
    "Take your sword to my enemies and prove to me that you are worthy of becoming my vassal. " +
    "Then we may speak more of this.", "lord_pretalk",[]],
  
  [anyone|plyr,"lord_give_oath_1", [],  "I am ready, {s65}.", "lord_give_oath_2", [(troop_remove_item, "trp_player", "itm_plis_recomandation"),]],
  [anyone|plyr,"lord_give_oath_1", [],  "Forgive me, {s65}, I must give the matter more thought first...", "lord_give_oath_give_up", []],
  
  [anyone,"lord_give_oath_give_up", [
      (troop_get_type, ":type", "trp_player"),
      (eq, ":type", 1),
      ],  "Take whatever time you need, my lady.", "lord_pretalk", []],
  
  [anyone,"lord_give_oath_give_up", [],  "What are you playing at, {playername}? Go and make up your mind, and stop wasting my time.", "close_window", [(assign, "$g_leave_encounter",1)]],
  [anyone,"lord_give_oath_2", [],  "Good. Then repeat the words of the oath with me: I swear homage to you as lawful ruler of the {s41}.", "lord_give_oath_3", [
      (str_store_faction_name, 41, "$g_talk_troop_faction"),
      (try_begin),
        (is_between, "$g_talk_troop", pretenders_begin, pretenders_end),
        (neg|troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
        
        (troop_get_slot, ":rebel_faction", "$g_talk_troop", slot_troop_original_faction),
        (str_store_faction_name, 41, ":rebel_faction"),
      (try_end),
  ]],
  
  [anyone|plyr,"lord_give_oath_3", [],  "I pledge homage to you as lawful ruler of the {s41}.", "lord_give_oath_4", []],
  [anyone|plyr,"lord_give_oath_3", [],  "Excuse me, {reg65?my lady:sir}. But I feel I need to think about this.", "lord_give_oath_give_up", []],
  
  [anyone,"lord_give_oath_4", [],  "I will remain as your loyal and devoted {man/follower} as long as my breath remains....", "lord_give_oath_5", []],
  
  [anyone|plyr,"lord_give_oath_5", [],  "I will remain as your loyal and devoted {man/follower} as long as my breath remains...", "lord_give_oath_6", []],
  [anyone|plyr,"lord_give_oath_5", [],  "{reg65?My lady:Sir}, may I ask for some time to think about this?", "lord_give_oath_give_up", []],
  
  [anyone,"lord_give_oath_6", [],  "...and I will be at your side to fight your enemies should you need my sword.", "lord_give_oath_7", []],
  
  [anyone|plyr,"lord_give_oath_7", [],  "...and I will be at your side to fight your enemies should you need my sword.", "lord_give_oath_8", []],
  [anyone|plyr,"lord_give_oath_7", [],  "{reg65?My lady:My lord}, please give me more time to think about this.", "lord_give_oath_give_up", []],
  
  [anyone,"lord_give_oath_8", [],  "Finally, I will uphold your lawful claims and those of your legitimate heirs.", "lord_give_oath_9", []],
  
  [anyone|plyr,"lord_give_oath_9", [],  "Finally, I will uphold your lawful claims and those of your legitimate heirs.", "lord_give_oath_10", []],
  [anyone|plyr,"lord_give_oath_9", [],  "{reg65?My lady:Sir}, I must have more time to consider this.", "lord_give_oath_give_up", []],
  
  [anyone,"lord_give_oath_10", [],  "Very well. You have given me your solemn oath, {playername}. May you uphold it always, with proper courage and devotion.", "lord_give_oath_go_on_2", []],
  
  [anyone,"lord_give_oath_go_on_2",
    [
      (assign, reg1, 1),
      (try_begin),
        (le, "$g_invite_offered_center", 0),
        (assign, reg1, 0),
      (else_try),
        (str_store_party_name, s1, "$g_invite_offered_center"),
      (try_end),
      #quete jeanne possible !!! zszszs
      (assign, "$quete_jhoan_ready_orleans", 1),
    ],
    "Let it be known that from this day forward, you are my sworn {man/follower} and vassal. " +
    "I give you my protection and grant you the right to bear arms in my name, and I pledge that I shall not deprive you of your life, liberty or properties except by the lawful judgment of your peers or by the law and custom of the land.{reg1? Furthermore I give you the fief of {s1} with all its rents and revenues.:}", "lord_give_oath_go_on_3", []],
  
  [anyone,"lord_give_oath_go_on_3",
    [
    ],
    
    "You have done a wise thing, {playername}. Serve me well and I promise, you will rise high.", "lord_give_conclude", []],
  
  
  
  ##  [anyone,"lord_give_oath_go_on_2", [],  "Then let it be know that from now on, you are my sworn {man/follower}.\
  ## I give you my protection and grant you the right to bear arms in my name.\
  ## You have done wisely {playername}. Serve me well and I promise, you will rise high.", "lord_give_oath_5", []],
  
  #  [anyone,"lord_ask_enter_service", [(lt, "$g_talk_troop_relation", 10),
  #                                     (store_character_level, ":player_level", "trp_player"),
  #                                     (lt, ":player_level", 10),
  #                                     ], "I know not much about you. Keep serving me {playername}. Prove your loyality, then I will know I can trust you and accept your oath.", "lord_pretalk",[]],
  
  ##  [anyone,"lord_ask_enter_service", [], "What kind of oath are you willing to make?", "lord_oath_what_kind",[]],
  ##
  ##  [anyone|plyr ,"lord_oath_what_kind", [], "I will give you my oath to serve you for two months.", "lord_oath_what_kind_2",[(assign, "$temp", 60)]],
  ##  [anyone|plyr ,"lord_oath_what_kind", [], "I will give you my oath to serve you for three months.", "lord_oath_what_kind_2",[(assign, "$temp", 90)]],
  ##  [anyone|plyr ,"lord_oath_what_kind", [], "I will give you my oath to serve you for six months.", "lord_oath_what_kind_2",[(assign, "$temp", 180)]],
  ##  [anyone|plyr ,"lord_oath_what_kind", [], "I will give you my oath to serve you indefinitely.", "lord_oath_what_kind_2",[(assign, "$temp", 720)]],
  ##  [anyone|plyr ,"lord_oath_what_kind", [], "Maybe I should give more thought to this, my lord.", "lord_oath_what_kind_cancel",[]],
  ##  [anyone ,"lord_oath_what_kind_cancel", [], "What nonsense is this? Now go make up your mind and stop wasting my time.", "close_window",[]],
  ##
  ##  [anyone, "lord_oath_what_kind_2", [], "Hmmm. Do you ask for anything in return?", "lord_oath_what_do_you_want",[]],
  ##
  ##  [anyone|plyr, "lord_oath_what_do_you_want", [], "I ask for nothing but your blessing, my lord.", "lord_oath_consider",[(assign,"$temp2",0)]],
  ##  [anyone|plyr, "lord_oath_what_do_you_want", [], "I only ask for the right to have my own banner, my lord.", "lord_oath_consider",[(assign,"$temp2",1)]],
  ##  [anyone|plyr, "lord_oath_what_do_you_want", [], "I just ask for the right to hold one castle, my lord.", "lord_oath_consider",[(assign,"$temp2",2)]],
  ##  [anyone|plyr, "lord_oath_what_do_you_want", [], "I ask for the right to hold two castles, my lord.", "lord_oath_consider",[(assign,"$temp2",4)]],
  ##  [anyone|plyr, "lord_oath_what_do_you_want", [], "I ask for the right to hold three castles, my lord.", "lord_oath_consider",[(assign,"$temp2",6)]],
  ##  [anyone|plyr ,"lord_oath_what_do_you_want", [], "Maybe I should give more thought to this, my lord.", "lord_oath_what_kind_cancel",[]],
  ##
  ##  [anyone ,"lord_oath_consider", [
  ##      (store_character_level, ":player_level", "trp_player"),
  ##      (store_mul, ":benefit", ":player_level", 5),
  ##      (val_add, ":benefit", "$temp"),
  ##      (val_add, ":benefit", "$g_talk_troop_relation"),
  ##
  ##      (store_mul, ":cost", "$temp2", 100),
  ##      (lt, ":cost", ":benefit"),
  ##      ], "That is agreeable {playername}. Give me your oath now and I will accept you as my follower and offer you my protection.", "lord_give_oath_go_on",[]],
  ##
  ##  [anyone ,"lord_oath_consider", [], "Hmmm. What you ask for is not acceptible {playername}.", "close_window",[]],
  ##
  ##  [anyone|plyr,"lord_give_oath_go_on", [(eq, "$temp", 60)],  "I give you my oath lord, that I will remain in your service for two months.\
  ## During this time, I will be faithful to you,\
  ## I will not act in a way to cause you harm, and I will be at your side to fight your enemies should you need my sword.", "lord_give_oath_go_on_2", []],
  ##  [anyone|plyr,"lord_give_oath_go_on", [(eq, "$temp", 90)],  "I give you my oath lord, that I will remain in your service for three months.\
  ## During this time, I will be faithful to you,\
  ## I will not act in a way to cause you harm, and I will be at your side to fight your enemies should you need my sword.", "lord_give_oath_go_on_2", []],
  ##  [anyone|plyr,"lord_give_oath_go_on", [(eq, "$temp", 180)],  "I give you my oath lord, that I will remain in your service for six months.\
  ## During this time, I will be faithful to you,\
  ## I will not act in a way to cause you harm, and I will be at your side to fight your enemies should you need my sword.", "lord_give_oath_go_on_2", []],
  ##  [anyone|plyr,"lord_give_oath_go_on", [(gt, "$temp", 700)],  "I give you my oath lord, that I will remain as your loyal and devoted {man/follower} as long as my breath remains.\
  ## I will never act in a way to cause you harm, and I will be at your side to fight your enemies should you need my sword.", "lord_give_oath_go_on_2", []],
  ##
  ##  [anyone,"lord_give_oath_go_on_2", [(eq,"$temp2",0)],  "Then let it be know that from now on, you are my sworn {man/follower}.\
  ## I give you my protection and grant you the right to bear arms in my name.\
  ## You have done wisely {playername}. Serve me well and I promise, you will rise high.", "lord_give_oath_5", []],
  ##
  ##  [anyone,"lord_give_oath_go_on_2", [(eq,"$temp2",1)],  "Then let it be know that from now on, you are my sworn {man/follower}.\
  ## I give you my protection and grant you the right to hold your own banner.\
  ## You have done wisely {playername}. Serve me well and I promise, you will rise high.", "lord_give_oath_5", []],
  ##
  ##  [anyone,"lord_give_oath_go_on_2", [(eq,"$temp2",2)],  "Then let it be know that from now on, you are my sworn {man/follower} and vassal.\
  ## I give you my protection and grant you the right to hold a castle.\
  ## You have done wisely {playername}. Serve me well and I promise, you will rise high.", "lord_give_oath_5", []],
  ##
  ##  [anyone,"lord_give_oath_go_on_2", [(eq,"$temp2",4)],  "Then let it be know that from now on, you are my sworn {man/follower} and vassal.\
  ## I give you my protection and grant you the right to hold two castles.\
  ## You have done wisely {playername}. Serve me well and I promise, you will rise high.", "lord_give_oath_5", []],
  ##
  ##  [anyone,"lord_give_oath_go_on_2", [],  "Then let it be know that from now on, you are my sworn {man/follower} and vassal.\
  ## I give you my protection and grant you the right to hold three castles.\
  ## You have done wisely {playername}. Serve me well and I promise, you will rise high.", "lord_give_oath_5", []],
  
  [anyone|plyr,"lord_give_conclude",
    [
      (troop_get_type, reg39, "$g_talk_troop"),
      (try_begin), #activate husband as pretender
        (troop_slot_eq, "$g_talk_troop", slot_troop_spouse, "trp_player"),
        (str_store_string, s41, "str_very_well__you_are_now_my_liege_as_well_as_my_husband"),
      (else_try),	#all other situations
        (str_store_string, s41, "str_i_thank_you_reg39my_ladylord"),
      (try_end),
    ],  "{s41}", "lord_give_conclude_2",
    [
      #Pretender changes
      (try_begin),
        (this_or_next|is_between, "$g_talk_troop", pretenders_begin, pretenders_end),
        (troop_slot_eq, "$g_talk_troop", slot_troop_spouse, "trp_player"),
        
        (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
        
        (assign, "$supported_pretender", "$g_talk_troop"),
        (troop_get_slot, "$supported_pretender_old_faction", "$g_talk_troop", slot_troop_original_faction),
        (troop_set_faction, "$g_talk_troop", "fac_player_supporters_faction"),
        (faction_set_slot, "fac_player_supporters_faction", slot_faction_leader, "$g_talk_troop"),
        (assign, "$g_talk_troop_faction", "fac_player_supporters_faction"),
        
        (quest_set_slot, "qst_rebel_against_kingdom", slot_quest_giver_troop, "$g_talk_troop"),
        (quest_set_slot, "qst_rebel_against_kingdom", slot_quest_target_faction, "$supported_pretender_old_faction"),
        
        (str_store_faction_name_link, s14, "$supported_pretender_old_faction"),
        (str_store_troop_name_link, s13, "$g_talk_troop"),
        (setup_quest_text,"qst_rebel_against_kingdom"),
        (str_store_string, s2, "@You promised to help {s13} claim the throne of {s14}."),
        (call_script, "script_start_quest", "qst_rebel_against_kingdom", "$g_talk_troop"),
      (try_end),
      
      (try_begin),
        (eq, "$players_kingdom", "fac_player_supporters_faction"),
        (call_script, "script_deactivate_player_faction"),
        (try_for_range, ":npc", active_npcs_begin, active_npcs_end),
          (store_faction_of_troop, ":npc_faction", ":npc"),
          (eq, ":npc_faction", "fac_player_supporters_faction"),
          (troop_slot_eq, ":npc", slot_troop_occupation, slto_kingdom_hero),
          (call_script, "script_change_troop_faction", ":npc", "$g_talk_troop_faction"),
        (try_end),
      (try_end),
      
      (try_begin),
        (is_between, "$players_oath_renounced_against_kingdom", kingdoms_begin, kingdoms_end),
        (neq, "$players_oath_renounced_against_kingdom", "$g_talk_troop_faction"),
        (store_relation, ":relation", "fac_player_supporters_faction", "$players_oath_renounced_against_kingdom"),
        (val_min, ":relation", -40),
        (call_script, "script_set_player_relation_with_faction", "$players_oath_renounced_against_kingdom", ":relation"),
        (call_script, "script_update_all_notes"),
        (assign, "$g_recalculate_ais", 1),
      (try_end),
      
      (try_begin),
        (is_between, "$players_kingdom", kingdoms_begin, kingdoms_end),
        (neq, "$players_kingdom", "fac_player_supporters_faction"),
        (neq, "$players_kingdom", "$g_talk_troop_faction"), #ie, don't leave faction if the player is already part of the same kingdom
        
        (faction_get_slot, ":old_leader", "$players_kingdom", slot_faction_leader),
        (call_script, "script_add_log_entry", logent_renounced_allegiance,   "trp_player",  -1, ":old_leader", "$players_kingdom"),
        (call_script, "script_player_leave_faction", 0),
      (try_end),
      
      (call_script, "script_player_join_faction", "$g_talk_troop_faction"),
      
      (try_begin),
        (gt, "$g_invite_offered_center", 0),
        (call_script, "script_give_center_to_lord", "$g_invite_offered_center", "trp_player", 0),
        (try_begin),
          (faction_slot_eq, "$players_kingdom", slot_faction_political_issue, "$g_invite_offered_center"),
          (faction_set_slot, "$players_kingdom", slot_faction_political_issue, -1),
        (try_end),
      (try_end),
      (call_script, "script_add_log_entry", logent_pledged_allegiance,   "trp_player",  -1, "$g_talk_troop", "$g_talk_troop_faction"),
      
      (try_begin),
        (check_quest_active, "qst_join_faction"),
        (eq, "$g_invite_faction_lord", "$g_talk_troop"),
        (call_script, "script_end_quest", "qst_join_faction"),
      (else_try),
        (check_quest_active, "qst_join_faction"),
        (call_script, "script_abort_quest", "qst_join_faction", 0),
      (try_end),
      (assign, "$player_has_homage" ,1),
      (assign, "$g_player_banner_granted", 1),
      (assign, "$g_invite_faction", 0),
      (assign, "$g_invite_faction_lord", 0),
      (assign, "$g_invite_offered_center", 0),
      (assign, "$g_leave_encounter",1)]],
  
  [anyone,"lord_give_conclude_2", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_spouse, "trp_player"),
      ],  "So be it, my wife. May all my vassals be as valiant and loyal as you.", "close_window", [(assign, "$g_leave_encounter",1)]],
  
  [anyone,"lord_give_conclude_2", [],  "I have great hopes for you {playername}. " +
    "I know you shall prove yourself worthy of the trust I have placed in you.", "close_window", [(assign, "$g_leave_encounter",1)]],
  
  
  
  [anyone,"lord_ask_enter_service", [(str_store_faction_name,5,"$g_talk_troop_faction")], "Heh, a wise move, " +
    "{playername}. With loyal service, a {man/woman} in my service could become wealthy and powerful, " +
    "and our enemies... Well, our enemies are as wheat before a scythe. " +
    "However, to enter my service you must first renounce all worldly oaths and bonds, " +
    "and swear to serve only the {s5}.", "lord_enter_service_swear",[]],
  [anyone|plyr ,"lord_enter_service_swear", [], "I do so swear, {s65}.", "lord_enter_service_swear_accepted",[]],
  [anyone|plyr ,"lord_enter_service_swear", [], "I need some time to think about this.", "lord_enter_service_swear_denied",[]],
  [anyone ,"lord_enter_service_swear_denied", [], "Are you having me on? I've no time for games, {playername}. " +
    "Make up your mind and stop wasting my time.", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  [anyone ,"lord_enter_service_swear_accepted", [(str_store_faction_name,5,"$g_talk_troop_faction")],
    "Then it is my pleasure to welcome you to the service of my house. From this day on, {playername}, " +
    "you are a soldier of the {s5} with all the duties and privileges that come with it.", "lord_enter_service_swear_accepted_2",
    [
  ]],
  
  [anyone ,"lord_enter_service_swear_accepted_2", [(str_store_faction_name,5,"$g_talk_troop_faction")],
    "I charge you with rooting out and destroying the forces of our enemies wherever you may find them. " +
    "Moreover, I will have special tasks for you from time to time, as may some of my other vassal lords. " +
    "Serve, fight, and honour your oaths. These things will take you far, if you've a mind for promotion. " +
    "May God grant us long lives and many victories to toast in my hall!", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  [anyone,"lord_ask_leave_service", [(ge, "$g_talk_troop_relation", 1)], "Hrm. " +
    "Has your oath become burdensome, {playername}? It is unusual to request release from homage, " +
    "but in respect of your fine service, I will not hold you if you truly wish to end it. " +
    "Though you would be sorely missed.", "lord_ask_leave_service_verify",[]],
  [anyone,"lord_ask_leave_service", [], "Release from homage? Hmm, perhaps it would be for the best... " +
    "However, {playername}, you must be sure that release is what you desire. This is not a thing done lightly.", "lord_ask_leave_service_verify",[]],
  
  [anyone|plyr ,"lord_ask_leave_service_verify", [], "It is something I must do, {s65}.", "lord_ask_leave_service_2",[]],
  [anyone|plyr ,"lord_ask_leave_service_verify", [], "You are right, {s65}. My place is here.", "lord_ask_leave_service_giveup",[]],
  
  [anyone,"lord_ask_leave_service_giveup", [], "I am pleased to hear it, {playername}. " +
    "I hope you'll banish such unworthy thoughts from your mind from now on.", "lord_pretalk",[]],
  
  [anyone,"lord_ask_leave_service_2", [], "Then you are sure? Also, be aware that if you leave my services, you will be surrendering to me all the fiefs which you hold in my name.", "lord_ask_leave_service_verify_again",[]],
  [anyone|plyr ,"lord_ask_leave_service_verify_again", [], "Yes, {s65}.", "lord_ask_leave_service_3",[]],
  [anyone|plyr ,"lord_ask_leave_service_verify_again", [], "Of course not, {s65}. I am ever your loyal vassal.", "lord_ask_leave_service_giveup",[]],
  
  [anyone,"lord_ask_leave_service_3", [], "As you wish. I hereby declare your oaths to be null and void. " +
    "You will no longer hold land or titles in my name, and you are released from your duties to my house. " +
    "You are free, {playername}.", "lord_ask_leave_service_end",
    [
      (call_script, "script_add_log_entry", logent_renounced_allegiance,   "trp_player",  -1, "$g_talk_troop", "$g_talk_troop_faction"),
      (call_script, "script_player_leave_faction", 1), #1 means give back fiefs
  ]],
  
  [anyone|plyr ,"lord_ask_leave_service_end", [], "Thank you, sir. It was an honour to serve you..", "lord_ask_leave_service_end_2",[]],
  [anyone|plyr ,"lord_ask_leave_service_end", [], "My thanks. It feels good to be {a free man/free} once again.", "lord_ask_leave_service_end_2",[]],
  
  [anyone ,"lord_ask_leave_service_end_2", [], "Farewell then, {playername}, and good luck go with you.", "close_window",
    [(assign, "$g_leave_encounter", 1)]],
  
  #Active quests
  ##### TODO: QUESTS COMMENT OUT BEGIN
  
  [anyone,"lord_active_mission_1", [(store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_lend_companion"),
      #(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (check_quest_active,"qst_lend_companion"),
      (quest_slot_eq, "qst_lend_companion", slot_quest_giver_troop, "$g_talk_troop"),
      (store_current_day, ":cur_day"),
      (quest_get_slot, ":quest_target_amount", "qst_lend_companion", slot_quest_target_amount),
      (ge, ":cur_day", ":quest_target_amount"),
      ##                                    (quest_get_slot, ":quest_target_troop", "qst_lend_companion", slot_quest_target_troop),
      ##                                    (str_store_troop_name,s14,":quest_target_troop"),
      ##                                    (troop_get_type, reg3, ":quest_target_troop"),
    ],
    "Oh, you want your companion back? I see...", "lord_lend_companion_end",[]],
  
  
  
  
  [anyone,"lord_active_mission_1", [(store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_lend_companion")],
    "{playername}, I must beg your patience, I still have need of your companion. Please return later when things have settled.", "lord_pretalk",[]],
  #default
  [anyone,"lord_active_mission_1", [], "Yes, have you made any progress on it?", "lord_active_mission_2",[]],
  
  [anyone|plyr,"lord_active_mission_2",[#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (check_quest_active,"qst_capture_prisoners"),
      (quest_slot_eq, "qst_capture_prisoners", slot_quest_giver_troop, "$g_talk_troop"),
      (quest_get_slot, ":quest_target_amount", "qst_capture_prisoners", slot_quest_target_amount),
      (quest_get_slot, ":quest_target_troop", "qst_capture_prisoners", slot_quest_target_troop),
      (party_count_prisoners_of_type, ":count_prisoners", "p_main_party", ":quest_target_troop"),
      (ge, ":count_prisoners", ":quest_target_amount"),
      (assign, reg1, ":quest_target_amount"),
      (str_store_troop_name_plural, s1, ":quest_target_troop")],
    "Indeed. I brought you {reg1} {s1} as prisoners.", "lord_generic_mission_thank",
    [(quest_get_slot, ":quest_target_amount", "qst_capture_prisoners", slot_quest_target_amount),
      (quest_get_slot, ":quest_target_troop", "qst_capture_prisoners", slot_quest_target_troop),
      (party_remove_prisoners, "p_main_party", ":quest_target_troop", ":quest_target_amount"),
      (party_add_prisoners, "$g_encountered_party", ":quest_target_troop", ":quest_target_amount"),
      (call_script, "script_finish_quest", "qst_capture_prisoners", 100)]],
  
  
  [anyone|plyr,"lord_active_mission_2",
    [
      #(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (store_partner_quest, ":lords_quest"),
      (eq, ":lords_quest", "qst_capture_enemy_hero"),
      (assign, ":has_prisoner", 0),
      (quest_get_slot, ":quest_target_faction", "qst_capture_enemy_hero", slot_quest_target_faction),
      (party_get_num_prisoner_stacks, ":num_stacks", "p_main_party"),
      (try_for_range, ":i_stack", 0, ":num_stacks"),
        (party_prisoner_stack_get_troop_id, ":stack_troop", "p_main_party", ":i_stack"),
        (troop_is_hero, ":stack_troop"),
        (store_troop_faction, ":stack_faction", ":stack_troop"),
        (eq, ":quest_target_faction", ":stack_faction"),
        (troop_slot_eq, ":stack_troop", slot_troop_occupation, slto_kingdom_hero),
        (assign, ":has_prisoner", 1),
        (quest_set_slot, "qst_capture_enemy_hero", slot_quest_target_troop, ":stack_troop"),
      (try_end),
      (eq, ":has_prisoner", 1),
      (str_store_faction_name, s13, ":quest_target_faction")
    ],
    "Oh, indeed. I've captured a lord from {s13} for you.", "capture_enemy_hero_thank",
    []],
  
  [anyone,"capture_enemy_hero_thank", [],
    "Many thanks, my friend. He will serve very well for a bargain. You've done a fine work here. Please accept these {reg5} denars for your help.", "capture_enemy_hero_thank_2",
    [(quest_get_slot, ":quest_target_troop", "qst_capture_enemy_hero", slot_quest_target_troop),
      (quest_get_slot, ":quest_target_faction", "qst_capture_enemy_hero", slot_quest_target_faction),
      (party_remove_prisoners, "p_main_party", ":quest_target_troop", 1),
      (store_relation, ":reln", "$g_encountered_party_faction", ":quest_target_faction"),
      (try_begin),
        (lt, ":reln", 0),
        (party_add_prisoners, "$g_encountered_party", ":quest_target_troop", 1), #Adding him to the dungeon
      (else_try),
        #Do not add a non-enemy lord to the dungeon (due to recent diplomatic changes or due to a neutral town/castle)
        #(troop_set_slot, ":quest_target_troop", slot_troop_is_prisoner, 0),
        (troop_set_slot, ":quest_target_troop", slot_troop_prisoner_of_party, -1),
      (try_end),
      (quest_get_slot, ":reward", "qst_capture_enemy_hero", slot_quest_gold_reward),
      (assign, reg5, ":reward"),
      (call_script, "script_troop_add_gold", "trp_player", ":reward"),
      (add_xp_as_reward, 2500),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 4),
      (call_script, "script_end_quest", "qst_capture_enemy_hero"),
  ]],
  
  [anyone|plyr,"capture_enemy_hero_thank_2", [],
    "Certainly, {s65}.", "lord_pretalk",[]],
  [anyone|plyr,"capture_enemy_hero_thank_2", [],
    "It was nothing.", "lord_pretalk",[]],
  [anyone|plyr,"capture_enemy_hero_thank_2", [],
    "Give me more of a challenge next time.", "lord_pretalk",[]],
  
  ##
  ##  [anyone|plyr,"lord_active_mission_2", [(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                                         (store_partner_quest,":lords_quest"),
  ##                                         (eq,":lords_quest","qst_capture_messenger"),
  ##                                         (quest_get_slot, ":quest_target_troop", ":lords_quest", slot_quest_target_troop),
  ##                                         (quest_get_slot, ":quest_target_amount", ":lords_quest", slot_quest_target_amount),
  ##                                         (store_num_parties_destroyed_by_player, ":num_destroyed", "pt_messenger_party"),
  ##                                         (gt, ":num_destroyed", ":quest_target_amount"),
  ##                                         (party_count_prisoners_of_type, ":num_prisoners", "p_main_party", ":quest_target_troop"),
  ##                                         (ge, ":num_prisoners", 1),
  ##                                         (str_store_troop_name, 3, ":quest_target_troop")],
  ##   "Indeed sir. I have captured a {s3} my lord.", "lord_generic_mission_thank",[(quest_get_slot, ":quest_target_troop", "qst_capture_messenger", slot_quest_target_troop),
  ##                                                                     (party_remove_prisoners, "p_main_party", ":quest_target_troop", 1),
  ##                                                                     (party_add_prisoners, "$g_encountered_party", ":quest_target_troop", 1),#Adding him to the dungeon
  ##                                                                     (call_script, "script_finish_quest", "qst_capture_messenger", 100)]],
  ##
  ##
  [anyone|plyr,"lord_active_mission_2", [#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (store_partner_quest,":lords_quest"),
      (eq,":lords_quest","qst_raise_troops"),
      (quest_get_slot, ":quest_target_troop", ":lords_quest", slot_quest_target_troop),
      (quest_get_slot, ":quest_target_amount", ":lords_quest", slot_quest_target_amount),
      (party_count_companions_of_type, ":num_companions", "p_main_party", ":quest_target_troop"),
      (ge, ":num_companions", ":quest_target_amount"),
      (assign, reg1, ":quest_target_amount"),
      (str_store_troop_name_plural, s13, ":quest_target_troop")],
    "Indeed. I have raised {reg1} {s13}. You can take them.", "lord_raise_troops_thank",[(quest_get_slot, ":quest_target_troop", "qst_raise_troops", slot_quest_target_troop),
      (quest_get_slot, ":quest_target_amount", "qst_raise_troops", slot_quest_target_amount),
      (call_script,"script_change_player_relation_with_troop","$g_talk_troop", 3),
      (party_remove_members, "p_main_party", ":quest_target_troop", ":quest_target_amount"),
      (call_script, "script_end_quest", "qst_raise_troops"),
      (troop_get_slot, ":cur_lords_party", "$g_talk_troop", slot_troop_leaded_party),
      (gt, ":cur_lords_party", 0),
      (party_add_members, ":cur_lords_party", ":quest_target_troop", ":quest_target_amount"),
  ]],
  
  [anyone,"lord_raise_troops_thank", [],
    "These men may well turn the tide in my plans, {playername}. I am confident you've trained them well. My thanks and my compliments to you.", "lord_raise_troops_thank_2",[]],
  
  [anyone|plyr,"lord_raise_troops_thank_2", [],
    "Well, the lads are at your command now, sir. I am sure you will take good care of them.", "lord_pretalk",[]],
  
  
  [anyone|plyr,"lord_active_mission_2", [#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      
      #                                         (store_partner_quest,":lords_quest"),
      #                                         (eq, ":lords_quest", "qst_collect_taxes"),
      (check_quest_active, "qst_collect_taxes"),
      (quest_slot_eq, "qst_collect_taxes", slot_quest_giver_troop, "$g_talk_troop"),
      
      (check_quest_succeeded, "qst_collect_taxes"),
      (eq, "$qst_collect_taxes_halve_taxes", 0),
      (quest_get_slot, ":quest_gold_reward", "qst_collect_taxes", slot_quest_gold_reward),
      (store_mul, ":required_gold", ":quest_gold_reward", 8),
      (val_div, ":required_gold", 10),
      (store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", ":required_gold"),
      (assign, reg19, ":quest_gold_reward"),
      (quest_get_slot, ":quest_target_center", "qst_collect_taxes", slot_quest_target_center),
      (str_store_party_name, s3, ":quest_target_center"),
    ],
    "Here are all the taxes from {s3}. It comes up to {reg19} denars.", "lord_collect_taxes_success",
    []],
  
  [anyone|plyr,"lord_active_mission_2", [#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (check_quest_active, "qst_collect_taxes"),
      (quest_slot_eq, "qst_collect_taxes", slot_quest_giver_troop, "$g_talk_troop"),
      
      #                                         (store_partner_quest,":lords_quest"),
      #                                         (eq, ":lords_quest", "qst_collect_taxes"),
      (check_quest_succeeded, "qst_collect_taxes"),
      (eq, "$qst_collect_taxes_halve_taxes", 1),
      (quest_get_slot, ":quest_gold_reward", "qst_collect_taxes", slot_quest_gold_reward),
      (store_mul, ":required_gold", ":quest_gold_reward", 95),
      (val_div, ":required_gold", 100),
      (store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", ":required_gold"),
      (assign, reg19, ":quest_gold_reward"),
      (quest_get_slot, ":quest_target_center", "qst_collect_taxes", slot_quest_target_center),
      (str_store_party_name, s3, ":quest_target_center"),
    ],
    "Here are the taxes from {s3}. It comes up to {reg19} denars.", "lord_collect_taxes_half_success",
    []],
  
  [anyone|plyr,"lord_active_mission_2", [#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (check_quest_active, "qst_collect_taxes"),
      (quest_slot_eq, "qst_collect_taxes", slot_quest_giver_troop, "$g_talk_troop"),
      
      #                                         (store_partner_quest,":lords_quest"),
      #                                         (eq, ":lords_quest", "qst_collect_taxes"),
      (check_quest_failed, "qst_collect_taxes"),
      (quest_get_slot, ":quest_gold_reward", "qst_collect_taxes", slot_quest_gold_reward),
      (store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", ":quest_gold_reward"),
      (assign, reg19, ":quest_gold_reward"),
      (quest_get_slot, ":quest_target_center", "qst_collect_taxes", slot_quest_target_center),
      (str_store_party_name, s3, ":quest_target_center"),
    ],
    "Unfortunately, a revolt broke up while I was collecting the taxes. " +
    "I could only collect {reg19} denars.", "lord_collect_taxes_fail",
    []],
  
  [anyone,"lord_collect_taxes_success", [(quest_get_slot, ":total_revenue", "qst_collect_taxes", slot_quest_gold_reward),
      (store_mul, ":owner_share", ":total_revenue", 8),
      (val_div, ":owner_share", 10),
      (assign, reg20, ":owner_share"),
      (store_sub, reg21, ":total_revenue", ":owner_share")],
    "Well done, {playername}, very well done indeed! You were truly the right {man/person} for the job. " +
    "I promised you a fifth of the taxes, so that amounts to {reg21} denars. " +
    "If you give me {reg20} denars, you may keep the difference. " +
    "A good result for everyone, eh?", "lord_pretalk",
    [
      (troop_remove_gold, "trp_player", reg20),
      (quest_set_slot, "qst_collect_taxes", slot_quest_gold_reward, 0),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 2),
      (call_script, "script_end_quest", "qst_collect_taxes"),
  ]],
  
  
  [anyone,"lord_collect_taxes_half_success", [(quest_get_slot, ":gold_reward", "qst_collect_taxes", slot_quest_gold_reward),
      (val_mul, ":gold_reward", 95),
      (val_div, ":gold_reward", 100),
      (assign, reg20, ":gold_reward")],
    "What?! Is this some scheme of yours, {playername}? That's less than half the taxes I'm owed! " +
    "You have let them get away with murder as well as my money. What a farce! " +
    "You can forget the money I promised you, I'm taking {reg20} denars from what you collected, " +
    "and you're lucky I'm leaving you a few coins for honour's sake.", "lord_pretalk",
    [(troop_remove_gold, "trp_player", reg20),
      (quest_set_slot, "qst_collect_taxes", slot_quest_gold_reward, 0),
      (call_script, "script_end_quest", "qst_collect_taxes"),
  ]],
  
  
  [anyone,"lord_collect_taxes_fail", [],
    "God, what a bloody mess you've gotten us into, {playername}. " +
    "This could turn very ugly if I do not take immediate action. " +
    "I certainly hope you're not here expecting to be paid for failure. " +
    "Hand over my {reg19} denars, if you please, and end our business together.", "lord_pretalk",
    [(call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -1),
      (quest_get_slot, ":gold_reward", "qst_collect_taxes", slot_quest_gold_reward),
      (troop_remove_gold, "trp_player", ":gold_reward"),
      (quest_set_slot, "qst_collect_taxes", slot_quest_gold_reward, 0),
      (call_script, "script_end_quest", "qst_collect_taxes"),
  ]],
  
  [anyone|plyr,"lord_active_mission_2", [ (check_quest_active, "qst_hunt_down_fugitive"),
      (quest_slot_eq, "qst_hunt_down_fugitive", slot_quest_giver_troop, "$g_talk_troop"),
      
      (check_quest_succeeded, "qst_hunt_down_fugitive"),
      (quest_get_slot, ":quest_target_center", "qst_hunt_down_fugitive", slot_quest_target_center),
      (str_store_party_name, s3, ":quest_target_center"),
      (quest_get_slot, ":quest_target_dna", "qst_hunt_down_fugitive", slot_quest_target_dna),
      (call_script, "script_get_name_from_dna_to_s50", ":quest_target_dna"),
      (str_store_string, s4, s50),],
    "I found {s4} hiding at {s3} and gave him his punishment.", "lord_hunt_down_fugitive_success",
    []],
  
  [anyone|plyr,"lord_active_mission_2", [
      (check_quest_active, "qst_hunt_down_fugitive"),
      (quest_slot_eq, "qst_hunt_down_fugitive", slot_quest_giver_troop, "$g_talk_troop"),
      
      (check_quest_failed, "qst_hunt_down_fugitive"),
    ],
    "I'm afraid he got away.", "lord_hunt_down_fugitive_fail",
    []],
  
  [anyone,"lord_hunt_down_fugitive_success", [],
    "And we'll all be a lot better off without him! Thank you, {playername}, " +
    "for removing this long-festering thorn from my side. 'Tis good to know you can be trusted to handle things " +
    "with an appropriate level of tactfulness. " +
    "A bounty I promised, and a bounty you shall have. 300 denars and not a copper less!", "lord_hunt_down_fugitive_success_2",
    [
      (add_xp_as_reward, 300),
  ]],
  
  [anyone|plyr,"lord_hunt_down_fugitive_success_2", [],
    "Let me take the money, {s65}. Thank you.", "lord_hunt_down_fugitive_reward_accept",[]],
  [anyone|plyr,"lord_hunt_down_fugitive_success_2", [],
    "This is blood money. I can't accept it.", "lord_hunt_down_fugitive_reward_reject",[]],
  
  #Post 0907 changes begin
  [anyone,"lord_hunt_down_fugitive_reward_accept", [],
    "Of course, {playername}. Here you are. Once again, you've my thanks for ridding me of that {s43}.", "lord_pretalk",[
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_lord_insult_default"),
      
      (call_script, "script_troop_add_gold", "trp_player", 300),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      (call_script, "script_end_quest", "qst_hunt_down_fugitive"),
  ]],
  
  [anyone,"lord_hunt_down_fugitive_reward_reject", [],
    "You are a {man/woman} for whom justice is its own reward, eh? As you wish it, {playername}, as you wish it. " +
    "An honourable sentiment, to be true. Regardless, you've my thanks for ridding me of that {s43}.", "lord_pretalk",[
      
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_lord_insult_default"),
      
      
      (call_script, "script_change_player_honor", 3),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      (call_script, "script_end_quest", "qst_hunt_down_fugitive"),
  ]],
  
  [anyone,"lord_hunt_down_fugitive_fail", [],
    "It is a sad day when that {s43} manages to avoid the hand of justice yet again. " +
    "I thought you would be able to do this, {playername}. Clearly I was wrong.", "lord_pretalk",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_lord_insult_default"),
      
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -1),
      (call_script, "script_end_quest", "qst_hunt_down_fugitive"),
  ]],
  #Post 0907 changes end
  
  
  
  ##
  ##
  ##  [anyone|plyr,"lord_active_mission_2", [(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                                         (store_partner_quest,":lords_quest"),
  ##                                         (eq,":lords_quest","qst_bring_back_deserters"),
  ##                                         (quest_get_slot, ":quest_target_troop", ":lords_quest", slot_quest_target_troop),
  ##                                         (quest_get_slot, ":quest_target_amount", ":lords_quest", slot_quest_target_amount),
  ##                                         (party_count_prisoners_of_type, ":num_prisoners", "p_main_party", ":quest_target_troop"),
  ##                                         (ge, ":num_prisoners", ":quest_target_amount"),
  ##                                         (assign, reg1, ":quest_target_amount")],
  ##   "Yes sir. I have brought {reg1} deserters as you asked me to.", "lord_generic_mission_thank",[(quest_get_slot, ":quest_target_troop", "qst_bring_back_deserters", slot_quest_target_troop),
  ##                                                                                     (quest_get_slot, ":quest_target_amount", "qst_bring_back_deserters", slot_quest_target_amount),
  ##                                                                                     (party_remove_prisoners, "p_main_party", ":quest_target_troop", ":quest_target_amount"),
  ##                                                                                     (faction_get_slot, ":faction_tier_2_troop", "$g_talk_troop_faction", slot_faction_tier_2_troop),
  ##                                                                                     (try_begin),
  ##                                                                                       (gt, ":faction_tier_2_troop", 0),
  ##                                                                                       (troop_get_slot, ":cur_lords_party", "$g_talk_troop", slot_troop_leaded_party),
  ##                                                                                       (gt, ":cur_lords_party", 0),
  ##                                                                                       (party_add_members, ":cur_lords_party", ":faction_tier_2_troop", ":quest_target_amount"),
  ##                                                                                     (try_end),
  ##                                                                                     (call_script, "script_finish_quest", "qst_bring_back_deserters", 100)]],
  ##
  ##
  ##### TODO: QUESTS COMMENT OUT END
  [anyone|plyr,"lord_active_mission_2", [], "I am still working on it.", "lord_active_mission_3",[]],
  [anyone|plyr,"lord_active_mission_2", [], "I am afraid I won't be able to do this quest.", "lord_mission_failed",[]],
  
  [anyone,"lord_active_mission_3", [], "Good. Remember, I am counting on you.", "lord_pretalk",[]],
  
  
  
  
  #Post 0907 changes begin
  [anyone,"lord_mission_failed", [], "{s43}", "lord_pretalk",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_lord_mission_failed_default"),
      (store_partner_quest,":lords_quest"),
      (call_script, "script_abort_quest", ":lords_quest", 1)]],
  #Post 0907 changes end
  
  
  #Claim center
  ##  [anyone,"lord_claim_center_begin", [],
  ##   "What do you want to do with {s4}?", "lord_claim_center_ask",[]],
  ##
  ##  [anyone|plyr,"lord_claim_center_ask", [],
  ##   "I want to claim it for myself.", "lord_claim_center_2",[]],
  ##  [anyone|plyr,"lord_claim_center_ask", [],
  ##   "I will leave it to you my lord. I have no interest in holding {s4}.", "lord_claim_center_leave_to_lord",[]],
  
  
  ##  [anyone,"lord_claim_center_2", [(eq, "$g_player_permitted_castles", 0),],
  ##   "You are an able warrior {playername} and there is no question of your bravery.\
  ## Alas, you are not noble born, and there are those who will be upset if I allow you to hold a castle.\
  ## So, it saddens me but I must decline your request.", "lord_claim_center_deny", []],
  ##
  ##  [anyone|plyr,"lord_claim_center_deny", [],
  ##   "This is not fair my lord. I shed my blood to take {s4}. Now another {man/master} will rule over it.", "lord_claim_center_deny_2", []],
  ##  [anyone|plyr,"lord_claim_center_deny", [],
  ##   "I understand sir. Do as you will.", "lord_claim_center_leave_to_lord", []],
  ##  [anyone,"lord_claim_center_deny_2", [],
  ##   "Remember that you gave me your oath {playername}. And you agreed to do as told.", "lord_claim_center_deny_3", []],
  ##  [anyone,"lord_claim_center_deny_3", [],
  ##   "Yes sir.", "lord_claim_center_leave_to_lord", []],
  ##
  ##  [anyone,"lord_claim_center_leave_to_lord", [],
  ##   "Very well.  Then I will find a suitable master for {s4}.\
  ## In recognition of your bravery and service, I give you these 5000 denars.", "lord_pretalk",
  ##   [(troop_get_slot, ":wealth", "$g_talk_troop", slot_troop_wealth),
  ##    (val_sub, ":wealth", 6000),
  ##    (troop_set_slot, "$g_talk_troop", slot_troop_wealth, ":wealth"),
  ##    (call_script, "script_troop_add_gold", "trp_player", 5000),
  ##
  ##    (assign, ":new_master", "$g_talk_troop"),
  ##    (assign, ":max_wealth", 0),
  ##
  ##    (try_for_range, ":hero_no", kingdom_heroes_begin, kingdom_heroes_end),
  ##      (troop_slot_eq, ":hero_no", slot_troop_is_prisoner, 0),
  ##      (troop_slot_eq, ":hero_no", slot_troop_occupation, slto_kingdom_hero),
  ##      (store_troop_faction, ":hero_faction", ":hero_no"),
  ##      (eq, ":hero_faction", "$players_kingdom"),
  ##      (call_script, "script_get_number_of_hero_centers", "$g_talk_troop"),
  ##      (assign, ":no_of_owned_centers", reg0),
  ##      (neg|faction_slot_eq, "$players_kingdom", slot_faction_leader, ":hero_no"),
  ##      (lt, ":no_of_owned_centers", 2),
  ##      (troop_get_slot, ":wealth", "$g_talk_troop", slot_troop_wealth),
  ##      (ge, ":wealth", ":max_wealth"),
  ##      (assign, ":new_master", ":hero_no"),
  ##      (assign, ":max_wealth", ":wealth"),
  ##    (try_end),
  ##
  ##    (call_script, "script_give_center_to_lord", "$center_to_be_claimed", ":new_master"),
  ##    (set_spawn_radius, 1),
  ##    (spawn_around_party, "$center_to_be_claimed", "pt_old_garrison"),
  ##    (assign, ":new_party", reg0),
  ##    (party_set_ai_behavior, ":new_party", ai_bhvr_attack_party),
  ##    (party_set_ai_object, ":new_party", "p_main_party"),
  ##    (party_set_flags, ":new_party", pf_default_behavior, 0),
  ##    (call_script, "script_party_copy", ":new_party", "$center_to_be_claimed"),
  ##    (party_clear, "$center_to_be_claimed"),
  ##
  ##    (faction_get_slot, ":reinforcement_template_a", "$g_talk_troop_faction", slot_faction_reinforcements_a),
  ##    (faction_get_slot, ":reinforcement_template_b", "$g_talk_troop_faction", slot_faction_reinforcements_b),
  ##    (party_add_template, "$center_to_be_claimed", ":reinforcement_template_a"),
  ##    (party_add_template, "$center_to_be_claimed", ":reinforcement_template_b"),
  ##    ]],
  ##
  ##
  ##  [anyone,"lord_claim_center_2", [(assign, ":number_of_claimed_centers", 0),
  ##                                  (try_for_range, ":center_no", centers_begin, centers_end),
  ##                                    (party_slot_eq, ":center_no", slot_party_type, spt_castle),
  ##                                    (store_faction_of_party, ":faction_no", ":center_no"),
  ##                                    (eq, ":faction_no", "fac_player_supporters_faction"),
  ##                                    (party_slot_eq, ":center_no", slot_town_claimed_by_player, 1),
  ##                                    (val_add, ":number_of_claimed_centers", 1),
  ##                                  (try_end),
  ##                                  (lt, ":number_of_claimed_centers", "$g_player_permitted_castles"),
  ##                                  (assign, reg7, ":number_of_claimed_centers"),
  ##                                  ],
  ##   "I had promised you to defend your right to hold {reg7?a:another} castle {playername}. Now I honor that promise.\
  ## I can think of {no man finer than you/no one better than you} to be the {lord/lady} of {s4}.\
  ## Renew your oath to me now. Then I will be your liege,\
  ## and I'll support you and protect you against all those who oppose your claim.",
  ##  "lord_claim_center_give_oath",[]],
  ##
  ##
  ##  [anyone|plyr,"lord_claim_center_give_oath", [],  "I give you my oath lord, I will forever be faithful to you,\
  ## I will never act in a way to cause you harm, and I will be at your side to fight your enemies should you need my sword.", "lord_claim_center_direct_3", []],
  ##  [anyone,"lord_claim_center_direct_3", [],  "You have given your oath of fealty {playername}. I accept your oath and give you the fief of {s4}.\
  ## Rule it wisely and protect it against our enemies.", "lord_claim_center_direct_4", [
  ##     (party_set_slot, "$center_to_be_claimed", slot_town_claimed_by_player, 1),
  ##     (call_script, "script_give_center_to_lord", "$center_to_be_claimed", "trp_player")]],
  ##  [anyone|plyr,"lord_claim_center_direct_4", [],  "I thank you lord.", "close_window", [(assign, "$g_leave_encounter",1)]],
  
  #Ask for favor
  ##  [anyone,"lord_ask_for_favor_ask", [],
  ##   "What is it? I don't have time for personal requests.", "lord_ask_for_favor",[]],
  ##  [anyone,"lord_ask_for_favor_ask", [],
  ##   "Say it then. If it's something possible...", "lord_ask_for_favor",[]],
  ##
  ##  [anyone|plyr,"lord_ask_for_favor", [],
  ##   "Nothing my lord. It's not important.", "lord_pretalk",[]],
  #Suggest action
  [anyone,"lord_suggest_action_ask", [],
    "{!}What do you suggest?", "lord_suggest_action",[]],
  
  ##  [anyone|plyr,"lord_suggest_action",
  ##   [(troop_get_type, ":is_female", "trp_player"),
  ##    (eq, ":is_female", 1),
  ##    (lt, "$talk_context", tc_siege_commander),
  ##    ],
  ##   "{!}CHEAT: I want to marry you! (1)", "lord_groom_vows",[]],
  
  [anyone|plyr,"lord_suggest_action", [],
    "{!}CHEAT: I want to join your faction.", "lord_suggest_join_faction",[]],
  [anyone,"lord_suggest_join_faction", [],
    "{!}Alright then.", "lord_give_oath_5",[]],
  
  [anyone|plyr,"lord_suggest_action", [],
    "{!}CHEAT: I want to know your leaded party ID.", "lord_suggest_learn_party_id",[]],
  [anyone,"lord_suggest_learn_party_id", [
      (assign, reg1, "$g_encountered_party"),
      (troop_get_slot, reg0, "$g_talk_troop", slot_troop_leaded_party)],
    "{!}It is {reg0}. Encountered party is {reg1}", "lord_pretalk",[]],
  
  [anyone|plyr,"lord_suggest_action", [],
    "{!}CHEAT: I want to know your AI initiative.", "lord_suggest_learn_ai_initiative",[]],
  [anyone,"lord_suggest_learn_ai_initiative", [(party_get_ai_initiative, reg0, "$g_encountered_party")],
    "{!}It is {reg0}.", "lord_pretalk",[]],
  
  
  [anyone|plyr,"lord_suggest_action", [(eq, "$players_kingdom", "$g_talk_troop_faction"),],
    "{!}CHEAT: I want to be your kingdom's marshall.", "lord_suggest_become_marshall",[]],
  [anyone,"lord_suggest_become_marshall", [],
    "{!}Alright then.", "lord_pretalk",
    [
      (faction_get_slot, ":old_marshall", "$g_talk_troop_faction", slot_faction_marshall),
      (try_begin),
        (ge, ":old_marshall", 0),
        (troop_get_slot, ":old_marshall_party", ":old_marshall", slot_troop_leaded_party),
        (party_is_active, ":old_marshall_party"),
        (party_set_marshall, ":old_marshall_party", 0),
      (try_end),
      
      (faction_set_slot, "$g_talk_troop_faction", slot_faction_marshall, "trp_player"),
      (faction_set_slot, "$g_talk_troop_faction", slot_faction_ai_state, sfai_default),
      (assign, "$g_recalculate_ais", 1),
  ]],
  
  [anyone|plyr,"lord_suggest_action", [(neq, "$talk_context", tc_siege_commander)],
    "{!}CHEAT: Let us attack an enemy town or castle.", "lord_suggest_attack_enemy_castle",[]],
  [anyone|plyr,"lord_suggest_action", [(neq, "$talk_context", tc_siege_commander)],
    "{!}CHEAT: Let us return back to a friendly town.", "lord_suggest_go_to_friendly_town",[]],
  [anyone|plyr,"lord_suggest_action", [(neq, "$talk_context", tc_siege_commander)],
    "{!}CHEAT: Let us attack an enemy war party.", "lord_suggest_attack_enemy_party",[]],
  [anyone|plyr,"lord_suggest_action", [(eq, "$talk_context", tc_siege_commander)],
    "{!}CHEAT: Let us lift this siege.", "lord_suggest_lift_siege",[]],
  [anyone|plyr,"lord_suggest_action", [(neq, "$talk_context", tc_siege_commander)],
    "{!}CHEAT: Follow me.", "lord_suggest_follow_me",[]],
  [anyone|plyr,"lord_suggest_action", [(neq, "$talk_context", tc_siege_commander)],
    "{!}CHEAT: Follow someone.", "lord_suggest_follow_other",[]],
  [anyone|plyr,"lord_suggest_action", [(neq, "$talk_context", tc_siege_commander)],
    "{!}CHEAT: Raid a village.", "lord_suggest_raid_village",[]],
  [anyone|plyr,"lord_suggest_action", [],
    "{!}CHEAT: Like me.", "lord_pretalk",[(call_script,"script_change_player_relation_with_troop","$g_talk_troop",20)]],
  
  [anyone,"lord_suggest_lift_siege", [],
    "{!}As you wish, {playername}.", "close_window",[(call_script, "script_party_set_ai_state", "$g_talk_troop_party", spai_undefined),
      (party_leave_cur_battle, "$g_talk_troop_party"),
      (assign, "$g_leave_encounter", 1)]],
  
  [anyone,"lord_suggest_go_to_friendly_town", [],
    "{!}Hmm. Which town or castle do you suggest we go to?", "lord_suggest_go_to_friendly_town2",[]],
  [anyone|plyr|repeat_for_parties,"lord_suggest_go_to_friendly_town2", [
      (store_repeat_object, ":center_no"),
      (this_or_next|party_slot_eq,":center_no",slot_party_type, spt_castle),
      (party_slot_eq,":center_no",slot_party_type, spt_town),
      (neq, ":center_no", "$g_encountered_party"),
      (store_faction_of_party, ":town_faction", ":center_no"),
      (eq, ":town_faction", "$g_talk_troop_faction"),
      (str_store_party_name, s1, ":center_no")],
    "{!}CHEAT: {s1}", "lord_suggest_go_to_friendly_town3",[(store_repeat_object, "$town_suggested_to_go_to")]],
  [anyone|plyr,"lord_suggest_go_to_friendly_town2", [],
    "{!}CHEAT: Never mind.", "lord_pretalk",[]],
  
  [anyone,"lord_suggest_go_to_friendly_town3", [(str_store_party_name, 1, "$town_suggested_to_go_to")],
    "{!}Very well, we go to {s1}.", "lord_pretalk",
    [
      (call_script, "script_party_set_ai_state", "$g_talk_troop_party", spai_holding_center, "$town_suggested_to_go_to"),
  ]],
  
  
  
  [anyone,"lord_suggest_attack_enemy_party", [],
    "{!}Hmm. Which party do you suggest we attack?", "lord_suggest_attack_enemy_party2",[]],
  [anyone|plyr|repeat_for_parties,"lord_suggest_attack_enemy_party2", [
      (store_repeat_object, ":party_no"),
      (party_slot_eq,":party_no",slot_party_type, spt_kingdom_hero_party),
      (party_is_active, ":party_no"),
      (store_faction_of_party, ":party_faction", ":party_no"),
      (store_relation, ":party_relation", ":party_faction", "$g_talk_troop_faction"),
      (le, ":party_relation", -10),
      (call_script, "script_get_closest_walled_center", ":party_no"),
      (assign, ":center_no", reg0),
      (str_store_party_name, s3, ":center_no"),
      (str_store_faction_name, s2, ":party_faction"),
      (str_store_party_name, s1, ":party_no")],
    "{!}CHEAT: {s1} of {s2} around {s3}", "lord_suggest_attack_enemy_party3",[(store_repeat_object, "$suggested_to_attack_party")]],
  [anyone|plyr,"lord_suggest_attack_enemy_party2", [],
    "{!}CHEAT: Never mind.", "lord_pretalk",[]],
  
  [anyone,"lord_suggest_attack_enemy_party3", [(str_store_party_name, 1, "$suggested_to_attack_party")],
    "{!}As you wish, we will attack {s1}.", "lord_pretalk",
    [
      (call_script, "script_party_set_ai_state", "$g_talk_troop_party", spai_engaging_army, "$suggested_to_attack_party"),
  ]],
  
  
  ##  [anyone,"lord_suggest_attack_enemy_castle", [(troop_get_slot, ":player_favor", "$g_talk_troop", slot_troop_player_favor),
  ##                                               (lt, ":player_favor", 20)],
  ##   "Hmm. No, I don't think that's a good idea.", "lord_pretalk",[]],
  
  [anyone,"lord_suggest_attack_enemy_castle", [],
    "{!}Hmm. Which one do you suggest we attack?", "lord_suggets_attack_enemy_castle2",[]],
  [anyone|plyr|repeat_for_parties,"lord_suggets_attack_enemy_castle2", [
      (store_repeat_object, ":center_no"),
      (this_or_next|party_slot_eq,":center_no",slot_party_type, spt_castle),
      (party_slot_eq,":center_no",slot_party_type, spt_town),
      (store_faction_of_party, ":town_faction", ":center_no"),
      (store_relation, ":town_relation", ":town_faction", "$g_talk_troop_faction"),
      (le, ":town_relation", -10),
      (str_store_faction_name, s2, ":town_faction"),
      (str_store_party_name, s1, ":center_no")],
    "{!}CHEAT: {s1} of {s2}", "lord_suggets_attack_enemy_castle3",[(store_repeat_object, "$suggested_to_attack_center")]],
  
  [anyone|plyr,"lord_suggets_attack_enemy_castle2", [],
    "{!}CHEAT: Never mind my lord.", "lord_pretalk",[]],
  
  [anyone,"lord_suggets_attack_enemy_castle3", [(str_store_party_name, 1, "$suggested_to_attack_center")],
    "That should be possible. Very well, we'll attack {s1}.", "lord_pretalk",
    [
      (call_script, "script_party_set_ai_state", "$g_talk_troop_party", spai_besieging_center, "$suggested_to_attack_center"),
      
  ]],
  
  [anyone,"lord_suggest_raid_village", [],
    "{!}Hmm. Which village do you suggest we attack?", "lord_suggest_raid_village_2",[]],
  [anyone|plyr|repeat_for_parties,"lord_suggest_raid_village_2", [
      (store_repeat_object, ":center_no"),
      (party_slot_eq,":center_no",slot_party_type, spt_village),
      (store_faction_of_party, ":town_faction", ":center_no"),
      (store_relation, ":town_relation", ":town_faction", "$g_talk_troop_faction"),
      (le, ":town_relation", -10),
      (str_store_faction_name, s2, ":town_faction"),
      (str_store_party_name, s1, ":center_no")],
    "{!}CHEAT: {s1} of {s2}", "lord_suggest_raid_village_3",[(store_repeat_object, "$suggested_to_attack_center")]],
  [anyone|plyr,"lord_suggest_raid_village_2", [],
    "{!}CHEAT: Never mind.", "lord_pretalk",[]],
  
  [anyone,"lord_suggest_raid_village_3", [(str_store_party_name, s1, "$suggested_to_attack_center")],
    "{!}That should be possible. Very well, we'll attack {s1}.", "lord_pretalk",
    [
      (call_script, "script_party_set_ai_state", "$g_talk_troop_party", spai_raiding_around_center, "$suggested_to_attack_center"),
  ]],
  
  
  [anyone,"lord_suggest_follow_me", [],
    "{!}Aye, I'll follow you.", "lord_pretalk",
    [
      (party_set_slot, "$g_talk_troop_party", slot_party_commander_party, "p_main_party"),
      #(call_script, "script_party_decide_next_ai_state_under_command", "$g_talk_troop_party")
      (call_script, "script_npc_decision_checklist_party_ai", "$g_talk_troop"),
      (call_script, "script_party_set_ai_state", "$g_talk_troop_party", reg0, reg1),
  ]],
  
  
  [anyone,"lord_suggest_follow_other", [],
    "{!}Who do you want me to follow?", "lord_suggest_follow_other_2",[]],
  [anyone|plyr|repeat_for_parties,"lord_suggest_follow_other_2", [
      (store_repeat_object, ":party_no"),
      (party_slot_eq,":party_no",slot_party_type, spt_kingdom_hero_party),
      (neq, ":party_no", "$g_talk_troop"),
      (store_faction_of_party, ":party_faction", ":party_no"),
      (eq, ":party_faction", "$g_talk_troop_faction"),
      (str_store_party_name, s1, ":party_no")],
    "{!}CHEAT: {s1}", "lord_suggest_follow_other_3",[(store_repeat_object, "$town_suggested_to_go_to")]],
  [anyone|plyr,"lord_suggest_follow_other_2", [],
    "{!}CHEAT: Never mind.", "lord_pretalk",[]],
  
  [anyone,"lord_suggest_follow_other_3", [(str_store_party_name, 1, "$town_suggested_to_go_to")],
    "{!}As you wish, I shall be accompanying {s1}.", "lord_pretalk",
    [
      (party_set_slot, "$g_talk_troop_party", slot_party_commander_party, "$town_suggested_to_go_to"),
      #(call_script, "script_party_decide_next_ai_state_under_command", "$g_talk_troop_party"),
      (call_script, "script_npc_decision_checklist_party_ai", "$g_talk_troop"),
      (call_script, "script_party_set_ai_state", "$g_talk_troop_party", reg0, reg1),
  ]],
  
  [anyone|plyr,"lord_suggest_action", [],
    "{!}CHEAT: Nothing, {s65}. It's not important.", "lord_pretalk",[]],
  
  
  ##### TODO: QUESTS COMMENT OUT BEGIN
  #Request Mission
  
  [anyone|auto_proceed,"lord_request_mission_ask",
    [(eq, "$players_kingdom", 0),
      (ge, "$g_talk_troop_faction_relation", 0),
      (ge, "$g_talk_troop_relation", 0),
      (troop_slot_ge, "trp_player", slot_troop_renown, 30),
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
      (faction_get_slot, ":last_offer_time", "$g_talk_troop_faction", slot_faction_last_mercenary_offer_time),
      
      (assign, ":num_enemies", 0),
      (try_for_range, ":faction_no", kingdoms_begin, kingdoms_end),
        (faction_slot_eq, "$g_talk_troop_faction", slot_faction_state, sfs_active),
        (store_relation, ":reln", "$g_talk_troop_faction", ":faction_no"),
        (lt, ":reln", 0),
        (val_add, ":num_enemies", 1),
      (try_end),
      (ge, ":num_enemies", 1),
      (store_current_hours, ":cur_hours"),
      (store_add,  ":week_past_last_offer_time", ":last_offer_time", 7 * 24),
      (val_add,  ":last_offer_time", 24),
      (ge, ":cur_hours", ":last_offer_time"),
      (store_random_in_range, ":rand", 0, 100),
      (this_or_next|lt, ":rand", 20),
      (ge, ":cur_hours", ":week_past_last_offer_time"),
      
      
      (troop_get_type, ":type", "trp_player"),
      (this_or_next|eq, ":type", 0),
      (this_or_next|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_cunning),
      (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_goodnatured),
    ],
    "{!}Warning: This line should never display.", "lord_propose_mercenary",[(store_current_hours, ":cur_hours"),
      (faction_set_slot, "$g_talk_troop_faction", slot_faction_last_mercenary_offer_time,  ":cur_hours")]],
  
  
  
  
  
  [anyone,"lord_propose_mercenary", [(call_script, "script_party_calculate_strength", "p_main_party", 0),
      (assign, ":offer_value", reg0),
      (val_add, ":offer_value", 100),
      (call_script, "script_round_value", ":offer_value"),
      (assign, ":offer_value", reg0),
      (assign, "$temp", ":offer_value"),
      (faction_get_slot, ":faction_leader", "$g_talk_troop_faction", slot_faction_leader),
      (neq, ":faction_leader", "$g_talk_troop"),
      (str_store_faction_name, s9, "$g_talk_troop_faction"),
      (str_store_troop_name, s10, ":faction_leader"),
      
      (troop_get_type, ":is_female", "trp_player"),
      (try_begin),
        (eq, ":is_female", 3), #disabled
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_martial),
        (str_store_string, s11, "str_now_some_might_say_that_women_have_no_business_leading_mercenary_companies_but_i_suspect_that_you_would_prove_them_wrong_what_do_you_say"),
      (else_try),
        (str_store_string, s11, "@What do you say to entering the service of {s9} as a mercenary captain? " +
        "I have no doubt that you would be up to the task."),
      (try_end)
    ],
    
    "As it happens, {playername}, I promised {s10} that I would hire a company of mercenaries for an upcoming campaign. " +
    "","lord_mercenary_service", []],
  [anyone|plyr,"lord_mercenary_service", [], "I'm not interested, thank you.", "lord_mercenary_service_reject", []],
  [anyone|plyr,"lord_mercenary_service", [], "Aye, I'll join {s9}.", "lord_mercenary_service_accept", []],
  [anyone|plyr,"lord_mercenary_service", [], "I'm interested. Please tell me more.", "lord_mercenary_elaborate_pay", []],
  
  [anyone,"lord_mercenary_service_accept", [(str_store_faction_name, s9, "$g_talk_troop_faction")],
    "Perfect. Of course you shall have to make a formal declaration of allegiance, " +
    "and give your oath that you and your company will remain in service to {s9} " +
    "for a period of no less than one month.", "lord_mercenary_service_verify", []],
  [anyone|plyr,"lord_mercenary_service_verify", [], "As you wish. Your enemies are my enemies.", "lord_mercenary_service_verify_2", []],
  [anyone|plyr,"lord_mercenary_service_verify", [], "On second thought, forget it.", "lord_mercenary_service_reject", []],
  
  [anyone,"lord_mercenary_service_verify_2", [], "That will do. You've made a wise choice, my friend. " +
    "{s9} does well by its loyal fighters, you will receive many rewards for your service.", "lord_mercenary_service_accept_3", [
      (call_script, "script_troop_add_gold", "trp_player", "$temp"),
      (store_current_day, ":cur_day"),
      (store_add, "$mercenary_service_next_renew_day", ":cur_day", 30),
      (call_script, "script_player_join_faction", "$g_talk_troop_faction"),
      (str_store_faction_name, s9, "$g_talk_troop_faction"),]],
  
  [anyone,"lord_mercenary_service_accept_3", [], "Now, I suggest you prepare for a serious campaign. " +
    "Train and equip your soldiers as best you can in the meantime, and respond quickly when you are summoned for duty.", "lord_pretalk", []],
  
  [anyone,"lord_mercenary_service_reject", [(str_store_faction_name, s9, "$g_talk_troop_faction")],
    "I'm very sorry to hear that. You'll find no better place than {s9}, be sure of that.", "lord_pretalk", []],
  
  [anyone,"lord_mercenary_elaborate_pay", [(assign, reg12, "$temp")],
    "I can offer you a contract for one month. At the end of this period, it can be extended on a monthly basis. " +
    "An initial sum of {reg12} denars will be paid to you to seal the contract. " +
    "After that, you'll receive wages from {s10} each week, according to the number and quality of the soldiers in your company. " +
    "You still have your rights to battlefield loot and salvage, as well as any prisoners you capture. " +
    "War can be very profitable at times...", "lord_mercenary_elaborate_1",
    [(faction_get_slot, ":faction_leader", "$g_talk_troop_faction", slot_faction_leader),
      (str_store_troop_name, s10, ":faction_leader")]],
  
  
  [anyone,"lord_mercenary_service_elaborate_duty", [],
    "Duties... There are only a few, none of them difficult. The very first thing is to declare your allegiance. " +
    "An oath of loyalty to our cause. Once that's done, you shall be required to fulfill certain responsibilities. " +
    "You'll participate in military campaigns, fulfill any duties given to you by your commanders, " +
    "and most of all you shall attack the enemies of our kingdom wherever you might find them.", "lord_mercenary_elaborate_1",
    [(faction_get_slot, ":faction_leader", "$g_talk_troop_faction", slot_faction_leader),
      (str_store_troop_name, s10, ":faction_leader")]],
  
  [anyone|plyr,"lord_mercenary_elaborate_1", [], "And what about my duties as a mercenary?", "lord_mercenary_service_elaborate_duty", []],
  [anyone|plyr,"lord_mercenary_elaborate_1", [], "Can I hold on to any castles I take?", "lord_mercenary_elaborate_castle", []],
  [anyone|plyr,"lord_mercenary_elaborate_1",
    [
      (neg|troop_slot_ge, "trp_player", slot_troop_banner_scene_prop, 1),
      #custom_banner begin
      ##    (eq, "trp_player", slot_troop_custom_banner_flag_type, -1),
      #custom_banner end
      ], "Can I fly my own banner?", "lord_mercenary_elaborate_banner", []],
  [anyone|plyr,"lord_mercenary_elaborate_1", [], "How much will you pay me for my service?", "lord_mercenary_elaborate_pay", []],
  [anyone|plyr,"lord_mercenary_elaborate_1", [], "Sounds good. I wish to enter your service as a mercenary.", "lord_mercenary_service_accept", []],
  [anyone|plyr,"lord_mercenary_elaborate_1", [], "Apologies, my sword is not for hire.", "lord_mercenary_service_reject", []],
  
  
  [anyone,"lord_mercenary_elaborate_castle", [(troop_get_type, ":type", "trp_player"),(eq, ":type", 1),
      (faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop")
    ],
    "Only my loyal vassals can own lands and castles in my realm -- and all my vassals are men.\I am not inclined to depart from this tradition without a very good reason. If you prove yourself in battle, you can swear an oath of homage to me and become my vassal.\We may then discuss how you may obtain a castle.",
    "lord_mercenary_elaborate_1", []],
  
  [anyone,"lord_mercenary_elaborate_castle", [(troop_get_type, ":type", "trp_player"),(eq, ":type", 1),
    ],
    "Hmm... Only loyal vassals of {s10} can own lands and castles. While kings will sometimes accept vassalage from men who prove themselves in battle, and grant them land, I have never heard of a king who gave fiefs to women. You had best discuss that issue with {s10} himself.",
    "lord_mercenary_elaborate_1", []],
  
  
  [anyone,"lord_mercenary_elaborate_castle", [(faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop")],
    "Only my loyal vassals can own lands and castles in my realm. " +
    "A mercenary can not be trusted with such a responsibility. " +
    "However, after serving for some time, you can swear homage to me and become my vassal. " +
    "Then you will be rewarded with a fief.", "lord_mercenary_elaborate_1", []],
  
  [anyone,"lord_mercenary_elaborate_castle", [], "Only loyal vassals of {s10} can own lands and castles. " +
    "You understand, a simple mercenary cannot be trusted with such responsibility. " +
    "However, after serving for some time, you may earn the right to swear homage to {s10} and become his vassal. " +
    "Then you would be rewarded with a fief.", "lord_mercenary_elaborate_1", []],
  
  [anyone,"lord_mercenary_elaborate_banner", [(faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop")],
    "Only my noble vassals have the honour of carrying their own banners. " +
    "However, after some time in mercenary service, you may earn the opportunity to swear homage to me and become my vassal, " +
    "gaining the right to choose a banner of your own and fight under it in battle.", "lord_mercenary_elaborate_1", []],
  [anyone,"lord_mercenary_elaborate_banner", [], "Only noble vassals of {s10} have the honour of carrying their own banners. " +
    "However, after some time of mercenary service, perhaps you can earn the opportunity to swear homage to {s10} and become his vassal, " +
    "gaining the right to choose a banner of your own and fight under it in battle.", "lord_mercenary_elaborate_1", []],
  
  [anyone,"lord_request_mission_ask", [(store_partner_quest,":lords_quest"),(ge,":lords_quest",0)],
    "You still haven't finished the last job I gave you, {playername}. You should be working on that, not asking me for other things to do.", "lord_pretalk",[]],
  
  
  [anyone,"lord_request_mission_ask", [(troop_slot_eq, "$g_talk_troop", slot_troop_does_not_give_quest, 1)],
    "I don't have any other jobs for you right now.", "lord_pretalk",[]],
  
  
  
  
  [anyone|auto_proceed,"lord_request_mission_ask", [], "A task?", "lord_tell_mission",
    [
      (call_script, "script_get_quest", "$g_talk_troop"),
      (assign, "$random_quest_no", reg0),
  ]],
  
  #check with armagan on this
  
  
  [anyone,"lord_request_mission_ask", [
      (this_or_next|troop_slot_eq, "$g_talk_troop", slot_troop_met, 2),
      (troop_slot_eq, "trp_player", slot_troop_betrothed, "$g_talk_troop"),
      (troop_get_type, ":is_female", "trp_player"),
      (eq, ":is_female", 1),
    ],
    "My lady, by the traditions of courtship, I should be offering my services to you. Unfortunately, I have little time right now, so I beg you to take this declaration of my esteem in its place.", "lord_pretalk",[]],
  
  
  [anyone,"lord_tell_mission", [
      (eq, "$player_has_homage" ,1),
      (neq, "$random_quest_no", "qst_rescue_prisoner"),
      (neq, "$random_quest_no", "qst_destroy_bandit_lair"),
      (neq, "$random_quest_no", "qst_raise_troops"),
      (neq, "$random_quest_no", "qst_escort_lady"),
      (neq, "$random_quest_no", "qst_lend_companion"),
      (neq, "$random_quest_no", "qst_capture_enemy_hero"),
      (neq, "$random_quest_no", "qst_cause_provocation"),
      
      
    ],
    "There are some minor errands which I need completed, but it would be more appropriate to give them to one of my own men, not to a sworn vassal of the realm.", "lord_tell_mission_sworn_vassal",[]],
  
  
  
  
  [anyone,"lord_tell_mission_sworn_vassal", [
      (this_or_next|party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_besieging_center),
      (party_slot_eq, "$g_talk_troop_party", slot_party_ai_state, spai_raiding_around_center),
      
      (party_get_slot, ":cur_object", "$g_talk_troop_party", slot_party_ai_object),
      (is_between, ":cur_object", centers_begin, centers_end),
      (str_store_party_name, s4, ":cur_object"),
    ],
    "If you are looking for action against our foes, you may join our attack on {s4}. The enemy may come in force to oppose us, so it is good to have as many men as possible.", "lord_pretalk",[]],
  
  
  
  [anyone,"lord_tell_mission_sworn_vassal", [
      (eq, "$g_talk_troop_faction", "$players_kingdom"),
      
      (party_get_slot, ":cur_object", "$g_talk_troop_party", slot_party_ai_object),
      (is_between, ":cur_object", centers_begin, centers_end),
      (party_get_slot, ":last_spotted_enemy", ":cur_object", slot_center_last_spotted_enemy),
      (party_is_active, ":last_spotted_enemy"),
      (store_faction_of_party, ":last_spotted_enemy_faction", ":last_spotted_enemy"),
      (store_relation, ":relation",":last_spotted_enemy_faction", "$g_talk_troop_faction"),
      (lt, ":relation", 0),
      
      (is_between, ":last_spotted_enemy_faction", kingdoms_begin, kingdoms_end),
      (str_store_party_name, s4, ":cur_object"),
      (str_store_faction_name, s5, ":last_spotted_enemy_faction"),
      
    ],
    "If you are looking for action against our foes, you may try venturing out to {s4}. We have received word that a force of the {s5} is in the area, and I am going there myself. I cannot guarantee you that our enemies will be there when you arrive, of course.", "lord_pretalk",[]],
  
  [anyone,"lord_tell_mission_sworn_vassal", [
      (eq, "$g_talk_troop_faction", "$players_kingdom"),
      (assign, ":alarmed_center_found", -1),
      (assign, ":score_to_beat", 9999),
      
      (try_for_range, ":center_no", centers_begin, centers_end),
        (store_faction_of_party, ":center_faction", ":center_no"),
        (eq, ":center_faction", "$g_talk_troop_faction"),
        (party_get_slot, ":last_spotted_enemy", ":center_no", slot_center_last_spotted_enemy),
        (party_is_active, ":last_spotted_enemy"),
        (store_faction_of_party, ":last_spotted_enemy_faction", ":last_spotted_enemy"),
        (is_between, ":last_spotted_enemy_faction", kingdoms_begin, kingdoms_end),
        
        (store_relation, ":relation", ":last_spotted_enemy_faction", "$g_talk_troop_faction"),
        (lt, ":relation", 0),
        
        (store_distance_to_party_from_party, ":distance", ":center_no", "p_main_party"),
        (lt, ":distance", ":score_to_beat"),
        
        (assign, ":alarmed_center_found", ":center_no"),
        (assign, ":score_to_beat", ":distance"),
        (str_store_faction_name, s5, ":last_spotted_enemy_faction"),
      (try_end),
      (is_between, ":alarmed_center_found", centers_begin, centers_end),
      (str_store_party_name, s4, ":alarmed_center_found"),
    ],
    "If you are looking for action against our foes, you may try venturing out to {s4}. We have received word that a force of the {s5} is in the area. I am not currently headed that way, but others may be.  I cannot guarantee you that our enemies will be there when you arrive, of course.", "lord_pretalk",[]],
  
  
  
  [anyone,"lord_tell_mission_sworn_vassal", [  ],
    "If a worthy task presents itself, however, I may have a favor to ask of you at a later date.", "lord_pretalk",[]],
  
  
  
  
  [anyone,"lord_tell_mission", [
      (eq,"$random_quest_no", "qst_destroy_bandit_lair"),
      (quest_get_slot, ":bandit_lair", "qst_destroy_bandit_lair", slot_quest_target_party),
      
      (party_stack_get_troop_id, ":bandit_type", ":bandit_lair", 0),
      (str_store_troop_name_plural, s4, ":bandit_type"),
      
    ], "Yes -- there is something you can do for us. We have heard reports that a group of {s4} have established a hideout in this area, and have been attacking travellers. If you could find their lair and destroy it, we would be very grateful.", "destroy_lair_quest_brief", #s48 is bandits, s42 is the road information
    []],
  
  
  [anyone,"lord_tell_mission",
    [(eq,"$random_quest_no","qst_rescue_prisoner")],
    "My {s11}, {s13}, has been taken prisoner by {s14} of the {s15}. Normally, honorable nobles will grant prisoners of gentle blood the privilege of parole, and treat them as honored guests so long as they give their word that they will not attempt to escape, until such time as a ransom can be paid.  But {s14}, instead of granting {s13} parole, has consigned my {s11} to his dungeons -- no doubt in the hope that he can demand more from us.", "lord_mission_rescue_prisoner",
    [
      (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
      (troop_get_slot, ":quest_target_center", ":quest_target_troop", slot_troop_prisoner_of_party),
      (call_script, "script_troop_get_family_relation_to_troop", ":quest_target_troop", "$g_talk_troop"),
      
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_troop_name_link, s13, ":quest_target_troop"),
      (str_store_party_name_link, s24, ":quest_target_center"),
      (party_get_slot, ":captor", ":quest_target_center", slot_town_lord),
      (str_store_troop_name, s14, ":captor"),
      (store_faction_of_party, ":target_faction", ":quest_target_center"),
      (str_store_faction_name, s15, ":target_faction"),
      
      
      (setup_quest_text,"$random_quest_no"),
      ##     (try_begin),
      ##       (is_between, "$g_encountered_party", centers_begin, centers_end),
      ##       (setup_quest_giver, "$random_quest_no", "str_given_by_s1_at_s2"),
      ##     (else_try),
      ##       (setup_quest_giver,"$random_quest_no", "str_given_by_s1_in_wilderness"),
      ##     (try_end),
      (str_store_string, s2, "str_s9_asked_you_to_rescue_s13_who_is_prisoner_at_s24"),
  ]],
  
  
  [anyone,"lord_mission_rescue_prisoner", [],
    "We need you to get my {s11} out of prison. You may be able to pay a ransom -- in which case we could cover your expenses, up to 5000 denars. If you have connections within {s24}, you may be able to use them to sneak him out. Or, you may try a more direct approach -- walk up to the gaoler, take the keys by force, and then fight your way out. Can you do this for us?", "lord_mission_rescue_prisoner_confirm",
    [
  ]],
  
  [anyone|plyr,"lord_mission_rescue_prisoner_confirm", [],
    "I can try.", "lord_mission_rescue_prisoner_accepted",[]],
  
  [anyone|plyr,"lord_mission_rescue_prisoner_confirm", [], "I don't think that I can help you.", "lord_mission_rescue_prisoner_rejected",[]],
  [anyone,"lord_mission_rescue_prisoner_rejected", [], "It would not have been an easy task. Perhaps we will find another way.", "close_window",[
      (assign, "$g_leave_encounter",1),
  ]],
  
  [anyone,"lord_mission_rescue_prisoner_accepted", [], "We are most grateful. Could I ask you how you were planning to proceed?", "lord_mission_rescue_prisoner_method",
    [(call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",1),
  ]],
  
  [anyone,"lord_mission_rescue_other_ideas", [], "Did you have any other ideas which you wished to discuss?", "lord_mission_rescue_prisoner_method",
    []],
  
  
  [anyone|plyr,"lord_mission_rescue_prisoner_method", [
      (eq, 1, 0),
    ],
    "I am thinking of paying the ransom.", "lord_mission_rescue_prisoner_method_ransom",[]],
  
  [anyone|plyr,"lord_mission_rescue_prisoner_method", [
      (eq, 1, 0),
    ],
    "I am thinking of using my connections in {s24}.", "lord_mission_rescue_prisoner_method_connections",[]],
  
  [anyone|plyr,"lord_mission_rescue_prisoner_method", [],
    "I am thinking of breaking into the prison in {s24}, finding {s13}, and fighting my way out.", "lord_mission_rescue_prisoner_method_prisonbreak",[]],
  
  [anyone|plyr,"lord_mission_rescue_prisoner_method", [],
    "I am thinking of taking {s24} by storm.", "lord_mission_rescue_prisoner_method_siege",[]],
  
  [anyone|plyr,"lord_mission_rescue_prisoner_method", [],
    "I have done enough planning. Time to act!", "lord_mission_rescue_prisoner_planning_end",[]],
  
  [anyone,"lord_mission_rescue_prisoner_planning_end", [],
    "May the heavens protect you.", "close_window",[
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone,"lord_mission_rescue_prisoner_method_ransom", [],
    "{!}[Ransom option not yet implemented]", "lord_mission_rescue_other_ideas",[]],
  
  [anyone,"lord_mission_rescue_prisoner_method_prisonbreak", [],
    "I had discussed this idea with some of my men. One could enter {s24}, either in disguise or openly, then walk up to the prison guard and try to take the keys by force. However, getting out may be difficult. The garrison may be slow to react, but even so, you are likely to find yourself fighting a half dozen or more of the enemy at once, with limited space in which to maneuver. If you can fight your way past them, though, you can probably get out.", "lord_mission_rescue_prisoner_method_prisonbreak_2",[]],
  
  [anyone,"lord_mission_rescue_prisoner_method_prisonbreak_2", [],
    "You may find it useful to create a distraction, to divert the attention of some of the garrison. If you have any connections in the villages near {s24}, this may be a time to put them to use.", "lord_mission_rescue_other_ideas",[]],
  
  
  [anyone,"lord_mission_rescue_prisoner_method_siege", [],
    "Well, that is certainly the most direct approach.", "lord_mission_rescue_other_ideas",[]],
  
  
  
  
  
  
  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_deliver_message")],
    "I need to send a letter to {s13} who should be currently at {s4}. " +
    "If you will be heading towards there, would you deliver it to him? " +
    "The letter needs to be in his hands in 30 days.", "lord_mission_deliver_message",
    [
      (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (str_store_troop_name_link,s9,"$g_talk_troop"),
      (str_store_troop_name_link,s13,":quest_target_troop"),
      (str_store_party_name_link,s4,":quest_target_center"),
      (setup_quest_text,"$random_quest_no"),
      ##     (try_begin),
      ##       (is_between, "$g_encountered_party", centers_begin, centers_end),
      ##       (setup_quest_giver, "$random_quest_no", "str_given_by_s1_at_s2"),
      ##     (else_try),
      ##       (setup_quest_giver,"$random_quest_no", "str_given_by_s1_in_wilderness"),
      ##     (try_end),
      (str_store_string, s2, "@{s9} asked you to take a message to {s13}. {s13} was believed to be at {s4} when you were given this quest."),
  ]],
  
  [anyone|plyr,"lord_mission_deliver_message", [], "Certainly, I intend to pass by {s4} and it would be no trouble.", "lord_mission_deliver_message_accepted",[]],
  [anyone|plyr,"lord_mission_deliver_message", [], "I doubt I'll be seeing {s13} anytime soon, {s65}. You'd best send it with someone else.", "lord_mission_deliver_message_rejected",[]],
  [anyone|plyr,"lord_mission_deliver_message", [], "I am no errand boy, sir. Hire a courier for your trivialities.", "lord_mission_deliver_message_rejected_rudely",[]],
  
  [anyone,"lord_mission_deliver_message_accepted", [], "I appreciate it, {playername}. Here's the letter, " +
    "and a small sum to cover your travel expenses. Give my regards to {s13} when you see him.", "close_window",
    [(call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_troop_add_gold", "trp_player", 30),    (assign, "$g_leave_encounter",1),
  ]],
  
  [anyone,"lord_mission_deliver_message_rejected", [], "Ah, all right then. Well, I am sure I will find someone else.", "lord_pretalk",
    [(troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1)]],
  
  [anyone,"lord_mission_deliver_message_rejected_rudely", [], "Hm, is this how you respond to a polite request " +
    "for a small favor? A poor show, {playername}. I didn't know you would take offence.", "lord_mission_deliver_message_rejected_rudely_2",[]],
  
  [anyone|plyr,"lord_mission_deliver_message_rejected_rudely_2", [], "Then you shall know better from now on.", "lord_mission_deliver_message_rejected_rudely_3",[]],
  [anyone|plyr,"lord_mission_deliver_message_rejected_rudely_2", [], "Forgive my temper, {s65}. I'll deliver your letter.", "lord_mission_deliver_message_accepted",[]],
  
  [anyone,"lord_mission_deliver_message_rejected_rudely_3", [], "All right. I will remember that.", "close_window",[
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",-4),
      (quest_set_slot, "$random_quest_no", slot_quest_dont_give_again_remaining_days, 150),
      (troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1),
      (assign, "$g_leave_encounter",1),
  ]],
  
  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_deliver_message_to_enemy_lord")],
    "I need to deliver a letter to {s13} of {s15}, who must be at {s4} currently. " +
    "If you are going towards there, would you deliver my letter to him? The letter needs to reach him in 40 days.", "lord_mission_deliver_message",
    [
      (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (str_store_troop_name_link,s9,"$g_talk_troop"),
      ##     (str_store_party_name,2,"$g_encountered_party"),
      (str_store_troop_name_link,s13,":quest_target_troop"),
      (str_store_party_name_link,s4,":quest_target_center"),
      (store_troop_faction, ":target_faction", ":quest_target_troop"),
      (str_store_faction_name_link,s15,":target_faction"),
      (setup_quest_text,"$random_quest_no"),
      ##     (try_begin),
      ##       (is_between, "$g_encountered_party", centers_begin, centers_end),
      ##       (setup_quest_giver, "$random_quest_no", "str_given_by_s1_at_s2"),
      ##     (else_try),
      ##       (setup_quest_giver,"$random_quest_no", "str_given_by_s1_in_wilderness"),
      ##     (try_end),
      (str_store_string, s2, "@{s9} asked you to take a message to {s13} of {s15}. {s13} was believed to be at {s4} when you were given this quest."),
  ]],
  
  
  ##
  ##  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_deliver_message_to_lover")],
  ##   "My dear friend, I have a deep affection for {s3} and I believe she feels the same way for me as well.\
  ## Alas, her father {s5} finds me unsuitable for her and will do anything to prevent our union.\
  ## I really need your help. Please, will you take this letter to her? She should be at {s4} at the moment.", "lord_mission_told",
  ##   [
  ##     (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
  ##     (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
  ##     (str_store_troop_name_link,1,"$g_talk_troop"),
  ##     (str_store_party_name_link,2,"$g_encountered_party"),
  ##     (str_store_troop_name_link,3,":quest_target_troop"),
  ##     (str_store_party_name_link,4,":quest_target_center"),
  ##     (setup_quest_text,"$random_quest_no"),
  ##     (try_begin),
  ##       (is_between, "$g_encountered_party", centers_begin, centers_end),
  ##       (setup_quest_giver, "$random_quest_no", "str_given_by_s1_at_s2"),
  ##     (else_try),
  ##       (setup_quest_giver,"$random_quest_no", "str_given_by_s1_in_wilderness"),
  ##     (try_end),
  ##   ]],
  ##
  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_escort_lady")],
    "There is a small thing... My {s17} {s13} is due for a visit to her relatives at {s14}. " +
    "The visit has been postponed several times already with all the trouble on the roads, " +
    "but this time she is adamant about going. So, I want to at least make sure she's well-guarded. " +
    "I trust you well, {playername} so I would be very grateful if you could escort her to {s14} " +
    "and make sure she arrives safe and sound.", "lord_mission_told",
    [
      (quest_get_slot, ":quest_object_troop", "$random_quest_no", slot_quest_object_troop),
      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (try_begin),
        (troop_slot_eq, ":quest_object_troop", slot_troop_father, "$g_talk_troop"),
        (str_store_string, s17, "str_daughter"),
      (else_try),
        (str_store_string, s17, "str_wife"),
      (try_end),
      (str_store_troop_name_link, s11, "$g_talk_troop"),
      (str_store_troop_name_link, s13, ":quest_object_troop"),
      (str_store_party_name_link, s14, ":quest_target_center"),
      (setup_quest_text,"$random_quest_no"),
      (str_store_string, s2, "@{s11} asked you to escort his {s17} {s13} to {s14}."),
  ]],
  
  ##
  ##  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_hunt_down_raiders")],
  ## "A messenger came with important news a few hours ago.\
  ## A group of enemy raiders have attacked a village near {s3}.\
  ## They have murdered anyone who tried to resist, stolen everything they could carry and put the rest to fire.\
  ## Now, they must be on their way back to their base at {s4}.\
  ## You must catch them on the way and make them pay for their crimes.", "lord_mission_told",
  ##   [
  ##       (quest_get_slot, ":quest_object_center", "$random_quest_no", slot_quest_object_center),
  ##       (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
  ##       (str_store_party_name_link,3,":quest_object_center"),
  ##       (str_store_party_name_link,4,":quest_target_center"),
  ##    ]],
  ##
  ##  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_bring_back_deserters")],
  ## "I am worried about the growing number of deserters. If we don't do something about it, we may soon have noone left to fight in our wars.\
  ## I want you to go now and bring back {reg1} {s3}. I would ask you to hang the bastards but we are short of men and we need them back in the ranks.", "lord_mission_told",
  ##   [
  ##       (quest_get_slot, ":quest_target_amount", "$random_quest_no", slot_quest_target_amount),
  ##       (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
  ##
  ##       (str_store_troop_name_link,1,"$g_talk_troop"),
  ##       (str_store_party_name_link,2,"$g_encountered_party"),
  ##       (str_store_troop_name_plural,3,":quest_target_troop"),
  ##       (assign, reg1, ":quest_target_amount"),
  ##       (setup_quest_text,"$random_quest_no"),
  ##       (try_begin),
  ##         (is_between, "$g_encountered_party", centers_begin, centers_end),
  ##         (setup_quest_giver, "$random_quest_no", "str_given_by_s1_at_s2"),
  ##       (else_try),
  ##         (setup_quest_giver,"$random_quest_no", "str_given_by_s1_in_wilderness"),
  ##       (try_end),
  ##    ]],
  ##
  ##  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_deliver_supply_to_center_under_siege")],
  ## "The enemy has besieged {s5}. Our brothers there are doing their best to fend off attacks, but they can't hold for long without supplies.\
  ## We need someone to take the supplies they need and make it into the town as soon as possible.\
  ## It's a very dangerous job, but if there's one person who can do it, it's you {playername}.\
  ## You can take the supplies from seneschal {s3}. When you arrive at {s5}, give them to the seneschal of that town.", "lord_mission_told",
  ##   [
  ##       (quest_get_slot, ":quest_target_amount", "$random_quest_no", slot_quest_target_amount),
  ##       (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
  ##       (quest_get_slot, ":quest_object_troop", "$random_quest_no", slot_quest_object_troop),
  ##       (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
  ##
  ##       (str_store_troop_name_link,1,"$g_talk_troop"),
  ##       (str_store_party_name_link,2,"$g_encountered_party"),
  ##       (str_store_troop_name_link,3,":quest_object_troop"),
  ##       (str_store_troop_name,4,":quest_target_troop"),
  ##       (str_store_party_name_link,5,":quest_target_center"),
  ##       (assign, reg1, ":quest_target_amount"),
  ##       (setup_quest_text,"$random_quest_no"),
  ##       (try_begin),
  ##         (is_between, "$g_encountered_party", centers_begin, centers_end),
  ##         (setup_quest_giver, "$random_quest_no", "str_given_by_s1_at_s2"),
  ##       (else_try),
  ##         (setup_quest_giver,"$random_quest_no", "str_given_by_s1_in_wilderness"),
  ##       (try_end),
  ##    ]],
  ##
  ##  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_bring_reinforcements_to_siege")],
  ## "{s4} has besieged {s5} and God willing, that town will not hold for long.\
  ## Still I promised him to send {reg1} {s3} as reinforcements and I need someone to lead those men.\
  ## Can you take them to {s4}?", "lord_mission_told",
  ##   [
  ##       (quest_get_slot, ":quest_target_amount", "$random_quest_no", slot_quest_target_amount),
  ##       (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
  ##       (quest_get_slot, ":quest_object_troop", "$random_quest_no", slot_quest_object_troop),
  ##       (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
  ##
  ##       (str_store_troop_name_link,1,"$g_talk_troop"),
  ##       (str_store_party_name_link,2,"$g_encountered_party"),
  ##       (str_store_troop_name_plural,3,":quest_object_troop"),
  ##       (str_store_troop_name_link,4,":quest_target_troop"),
  ##       (str_store_party_name_link,5,":quest_target_center"),
  ##       (assign, reg1, ":quest_target_amount"),
  ##       (setup_quest_text,"$random_quest_no"),
  ##       (try_begin),
  ##         (is_between, "$g_encountered_party", centers_begin, centers_end),
  ##         (setup_quest_giver, "$random_quest_no", "str_given_by_s1_at_s2"),
  ##       (else_try),
  ##         (setup_quest_giver,"$random_quest_no", "str_given_by_s1_in_wilderness"),
  ##       (try_end),
  ##    ]],
  ##
  ##  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_rescue_lady_under_siege")],
  ## "The enemy has besieged {s4} and my dear {s7} {s3} has been trapped within the town walls.\
  ## As you may guess, I am greatly distressed by this. I need a very reliable commander, to rescue her from the town and bring her back to me.\
  ## Will you do that {playername}?", "lord_mission_told",
  ##   [
  ##       (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
  ##       (quest_get_slot, ":quest_object_troop", "$random_quest_no", slot_quest_object_troop),
  ##
  ##       (try_begin),
  ##         (troop_slot_eq, "$g_talk_troop", slot_troop_daughter, ":quest_object_troop"),
  ##         (str_store_string, s7, "str_daughter"),
  ##       (else_try),
  ##         (str_store_string, s7, "str_wife"),
  ##       (try_end),
  ##
  ##       (str_store_troop_name_link,1,"$g_talk_troop"),
  ##       (str_store_party_name_link,2,"$g_encountered_party"),
  ##       (str_store_troop_name_link,3,":quest_object_troop"),
  ##       (str_store_party_name_link,4,":quest_target_center"),
  ##       (setup_quest_text,"$random_quest_no"),
  ##       (try_begin),
  ##         (is_between, "$g_encountered_party", centers_begin, centers_end),
  ##         (setup_quest_giver, "$random_quest_no", "str_given_by_s1_at_s2"),
  ##       (else_try),
  ##         (setup_quest_giver,"$random_quest_no", "str_given_by_s1_in_wilderness"),
  ##       (try_end),
  ##    ]],
  ##
  ##
  ##  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_bring_prisoners_to_enemy")],
  ##   "The enemy wants to ransom some of their soldiers that we captured at the last battle.\
  ## They'll pay 100 denars in return for giving them back {reg1} {s3}.\
  ## God knows I can use that money so I accepted their offer.\
  ## Now, what I need is someone to take the prisoners to {s4} and come back with the money.", "lord_mission_told",
  ##   [
  ##     (quest_get_slot, ":quest_object_troop", "$random_quest_no", slot_quest_object_troop),
  ##     (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
  ##     (quest_get_slot, reg1, "$random_quest_no", slot_quest_target_amount),
  ##     (str_store_troop_name_link,1,"$g_talk_troop"),
  ##     (str_store_party_name_link,2,"$g_encountered_party"),
  ##     (str_store_troop_name_plural,3,":quest_object_troop"),
  ##     (str_store_party_name_link,4,":quest_target_center"),
  ##     (setup_quest_text,"$random_quest_no"),
  ##     (try_begin),
  ##       (is_between, "$g_encountered_party", centers_begin, centers_end),
  ##       (setup_quest_giver, "$random_quest_no", "str_given_by_s1_at_s2"),
  ##     (else_try),
  ##       (setup_quest_giver,"$random_quest_no", "str_given_by_s1_in_wilderness"),
  ##     (try_end),
  ##   ]],
  ##
  
  
  # Deal with bandits
  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_deal_with_bandits_at_lords_village")],
    "A group of bandits have taken refuge in my village of {s15}. " +
    "They are plundering nearby farms, and getting rich and fat stealing my taxes and feasting on my cattle. " +
    "I'd like nothing better than to go out there and teach them a lesson, " +
    "but I have my hands full at the moment, so I can't do anything about it.", "lord_mission_deal_with_bandits_told",
    [
      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (str_store_party_name_link,s15,":quest_target_center"),
      (str_store_troop_name_link,s13,"$g_talk_troop"),
      (setup_quest_text,"$random_quest_no"),
      (str_store_string, s2, "@{s13} asked you to deal with the bandits who are occupying the village of {s15} and then report back to him."),
  ]],
  
  [anyone|plyr,"lord_mission_deal_with_bandits_told", [],
    "Worry not, I can go to {s15} and deal with these scum for you.", "lord_mission_deal_with_bandits_accepted",[]],
  [anyone|plyr,"lord_mission_deal_with_bandits_told", [], "You shall have to find help elsewhere, I am too busy.", "lord_mission_deal_with_bandits_rejected",[]],
  
  [anyone,"lord_mission_deal_with_bandits_accepted", [], "Will you do that? " +
    "Know that, I will be grateful to you. Here is some money for the expenses of your campaign. " +
    "Make an example of those {s43}s.", "close_window",
    [
      
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_lord_insult_default"),
      
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_troop_add_gold", "trp_player", 200),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",1),
      (assign, "$g_leave_encounter",1),
  ]],
  
  [anyone,"lord_mission_deal_with_bandits_rejected", [], "Ah... Very well then, forget I brought it up.", "lord_pretalk",
    [(troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1)]],
  
  # Raise troops
  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_raise_troops")],
    "No lord should have to admit this, {playername}, but I was inspecting my soldiers the other day " +
    "and there are men here who don't know which end of a sword to hold. " +
    "{s43} " +
    "You are a warrior of renown, {playername}. Will you train some troops for me? " +
    "I would be grateful to you.", "lord_tell_mission_raise_troops",[
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_troop_train_request_default"),
      
  ]],
  
  [anyone|plyr,"lord_tell_mission_raise_troops", [], "How many men do you need?", "lord_tell_mission_raise_troops_2",[]],
  
  [anyone,"lord_tell_mission_raise_troops_2", [], "If you can raise {reg1} {s14} and bring them to me, that will probably be enough.", "lord_mission_raise_troops_told",
    [
      (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
      (quest_get_slot, reg1, "$random_quest_no", slot_quest_target_amount),
      (str_store_troop_name_link,s9,"$g_talk_troop"),
      (str_store_troop_name_plural,s14,":quest_target_troop"),
      (setup_quest_text,"$random_quest_no"),
      (str_store_string, s2, "@{s9} asked you to raise {reg1} {s14} and bring them to him."),
  ]],
  
  [anyone|plyr,"lord_mission_raise_troops_told", [(quest_get_slot, reg1, "$random_quest_no", slot_quest_target_amount)],
    "Of course, {s65}. Give me {reg1} fresh recruits and I'll train them to be {s14}.", "lord_mission_raise_troops_accepted",[]],
  [anyone|plyr,"lord_mission_raise_troops_told", [], "I am too busy these days to train anyone.", "lord_mission_raise_troops_rejected",[]],
  
  [anyone,"lord_mission_raise_troops_accepted", [], "You've taken a weight off my shoulders, {playername}. " +
    "I shall tell my sergeants to send you the recruits and attach them to your command. " +
    "Also, I'll advance you some money to help with expenses. Here, this purse should do it. " +
    "Thank you for your help.", "close_window",
    [(call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_troop_add_gold", "trp_player", 100),
      (quest_get_slot, ":recruit_troop", "$random_quest_no", slot_quest_object_troop),
      (quest_get_slot, ":num_recruits", "$random_quest_no", slot_quest_target_amount),
      (party_add_members, "p_main_party", ":recruit_troop", ":num_recruits"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",1),
      (assign, "$g_leave_encounter",1),
  ]],
  
  [anyone,"lord_mission_raise_troops_rejected", [], "Oh, of course. I had expected as much. Well, good luck to you then.", "lord_pretalk",
    [(troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1)]],
  
  
  #Collect Taxes
  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_collect_taxes"),
      (assign, reg9, 0),
      (try_begin),
        (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
        (party_slot_eq, ":quest_target_center", slot_party_type, spt_town),
        (assign, reg9, 1),
      (try_end),
    ], "You probably know that I am the lord of the {reg9?town:village} of {s3}. " +
    "However, it has been months since {s3} has delivered the taxes and rents due me as its rightful lord. " +
    "Apparently the populace there has grown unruly lately and I need someone to go there and remind them of " +
    "their obligations. And to . . . persuade them if they won't listen. " +
    "If you go there and raise the taxes they owe me, I will grant you one-fifth of everything you collect.", "lord_mission_collect_taxes_told",
    [
      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (str_store_troop_name_link,s9,"$g_talk_troop"),
      (str_store_party_name_link,s3,":quest_target_center"),
      (setup_quest_text,"$random_quest_no"),
      (str_store_string, s2, "@{s9} asked you to collect taxes from {s3}. He offered to leave you one-fifth of all the money you collect there."),
  ]],
  
  [anyone|plyr,"lord_mission_collect_taxes_told", [],
    "A fair offer, {s65}. We have an agreement.", "lord_mission_collect_taxes_accepted",[]],
  [anyone|plyr,"lord_mission_collect_taxes_told", [], "Forgive me, I don't have the time.", "lord_mission_collect_taxes_rejected",[]],
  
  [anyone,"lord_mission_collect_taxes_accepted", [], "Welcome news, {playername}. " +
    "I will entrust this matter to you. " +
    "Remember, those {reg9?townsmen:peasants} are foxy beasts, they will make every excuse not to pay me my rightful incomes. " +
    "Do not let them fool you.", "close_window",
    [(call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",1),
      (assign, "$g_leave_encounter",1),
      (assign, reg9, 0),
      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (try_begin),
        (party_slot_eq, ":quest_target_center", slot_party_type, spt_town),
        (assign, reg9, 1),
      (try_end),
  ]],
  
  [anyone,"lord_mission_collect_taxes_rejected", [], "Oh, yes. Well, good luck to you then.", "lord_pretalk",
    [(troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1)]],
  
  #Hunt down fugitive
  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_hunt_down_fugitive")],
    "I have something you could help with, an issue with the lawless villain known as {s4}. " +
    "He murdered one of my men and has been on the run from his judgment ever since. " +
    "I can't let him get away with avoiding justice, so I've put a bounty of 300 denars on his head. " +
    "Friends of the murdered man reckon that this assassin may have taken refuge with his kinsmen at {s3}. " +
    "You might be able to hunt him down and give him what he deserves, and claim the bounty for yourself.", "lord_mission_hunt_down_fugitive_told",
    [
      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (quest_get_slot, ":quest_target_dna", "$random_quest_no", slot_quest_target_dna),
      (str_store_troop_name_link,s9, "$g_talk_troop"),
      (str_store_party_name_link,s3, ":quest_target_center"),
      (call_script, "script_get_name_from_dna_to_s50", ":quest_target_dna"),
      (str_store_string, s4, s50),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s9} asked you to hunt down a fugitive named {s4}. He is currently believed to be at {s3}."),
  ]],
  
  [anyone|plyr,"lord_mission_hunt_down_fugitive_told", [],
    "Then I will hunt him down and execute the law.", "lord_mission_hunt_down_fugitive_accepted",[]],
  [anyone|plyr,"lord_mission_hunt_down_fugitive_told", [], "I am too busy to go after him at the moment.", "lord_mission_hunt_down_fugitive_rejected",[]],
  
  [anyone,"lord_mission_hunt_down_fugitive_accepted", [], "That's excellent, {playername}. " +
    "I will be grateful to you and so will the family of the man he murdered. " +
    "And of course the bounty on his head will be yours if you can get him. " +
    "Well, good hunting to you.", "close_window",
    [(call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",1),
      (assign, "$g_leave_encounter",1),
  ]],
  
  [anyone,"lord_mission_hunt_down_fugitive_rejected", [], "As you wish, {playername}. " +
    "I suppose there are plenty of bounty hunters around to get the job done . . .", "lord_pretalk",
    [(troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1)]],
  
  
  
  ##  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_capture_messenger")],
  ##   "The enemy seems to be preparing for some kind of action and I want to know what their plans are.\
  ## Capture one of their messengers and bring him to me.", "lord_mission_told",
  ##   [
  ##       (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
  ##
  ##       (str_store_troop_name_link,1,"$g_talk_troop"),
  ##       (str_store_party_name_link,2,"$g_encountered_party"),
  ##       (str_store_troop_name,3,":quest_target_troop"),
  ##       (setup_quest_text,"$random_quest_no"),
  ##       (try_begin),
  ##         (is_between, "$g_encountered_party", centers_begin, centers_end),
  ##         (setup_quest_giver, "$random_quest_no", "str_given_by_s1_at_s2"),
  ##       (else_try),
  ##         (setup_quest_giver,"$random_quest_no", "str_given_by_s1_in_wilderness"),
  ##       (try_end),
  ##   ]],
  ##
  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_kill_local_merchant")],
    "The wretched truth is that I owe a considerable sum of money to one of the merchants here in {s3}. " +
    "I've no intention of paying it back, of course, but that loud-mouthed fool is making a terrible fuss about it. " +
    "He even had the audacity to come and threaten me -- me! -- " +
    "with a letter of complaint to the trade guilds and bankers. Why, he'd ruin my good reputation! " +
    "So I need a {man/woman} I can trust, someone who will guarantee the man's silence. For good.", "lord_mission_told_kill_local_merchant",
    [
      (str_store_troop_name_link,s9,"$g_talk_troop"),
      (str_store_party_name_link,s3,"$current_town"),
      (setup_quest_text,"$random_quest_no"),
      (str_store_string, s2, "@{s9} asked you to assassinate a local merchant at {s3}."),
  ]],
  
  [anyone|plyr,"lord_mission_told_kill_local_merchant", [], "Worry not, he shan't breathe a word.", "lord_mission_accepted_kill_local_merchant",[]],
  [anyone|plyr,"lord_mission_told_kill_local_merchant", [], "I'm no common murderer, sir. Find someone else for your dirty job.", "lord_mission_rejected",[]],
  
  [anyone,"lord_mission_accepted_kill_local_merchant", [], "Very good. I trust in your skill and discretion, " +
    "{playername}. Do not disappoint me. " +
    "Go now and wait for my word, I'll send you a message telling when and where you can catch the merchant. " +
    "Dispose of him for me and I shall reward you generously.", "close_window",
    [(call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (assign, "$g_leave_town",1),
      (assign, "$qst_kill_local_merchant_center", "$current_town"),
      (rest_for_hours, 10, 4, 0),
      (finish_mission),
  ]],
  
  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_meet_spy_in_enemy_town"),
      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (str_store_party_name, s13, ":quest_target_center"),
      (store_faction_of_party,":quest_target_center_faction",),
      (str_store_faction_name, s14, ":quest_target_center_faction"),
    ],
    "I have a sensitive matter which needs tending to, {playername}, and no trustworthy retainers to take care of it. The fact is that I have a spy in {s13} to keep an eye on things for me, and report anything that might warrant my attention. Every week I send someone to collect the spy's reports and bring them back to me. The job's yours if you wish it.", "lord_mission_told_meet_spy_in_enemy_town",
    [
  ]],
  
  [anyone|plyr,"lord_mission_told_meet_spy_in_enemy_town", [], "I don't mind a bit of skullduggery. Count me in.", "quest_meet_spy_in_enemy_town_accepted",[]],
  [anyone|plyr,"lord_mission_told_meet_spy_in_enemy_town", [], "I must decline. This cloak-and-dagger work isn't fit for me.", "quest_meet_spy_in_enemy_town_rejected",[]],
  
  [anyone,"quest_meet_spy_in_enemy_town_accepted", [], "Excellent! Make your way to {s13} as soon as you can, the spy will be waiting.", "quest_meet_spy_in_enemy_town_accepted_response",
    [
      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (quest_get_slot, ":secret_sign", "$random_quest_no", slot_quest_target_amount),
      (store_sub, ":countersign", ":secret_sign", secret_signs_begin),
      (val_add, ":countersign", countersigns_begin),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_string, s11, ":secret_sign"),
      (str_store_string, s12, ":countersign"),
      (str_store_party_name_link, s13, ":quest_target_center"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s9} has asked you to meet with a spy in {s13}."),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_cf_center_get_free_walker", ":quest_target_center"),
      (call_script, "script_center_set_walker_to_type", ":quest_target_center", reg0, walkert_spy),
      (str_store_item_name,s14,"$spy_item_worn"),
      #TODO: Change this value
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      (assign, "$g_leave_encounter",1),
  ]],
  [anyone|plyr,"quest_meet_spy_in_enemy_town_accepted_response", [(quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (str_store_party_name_link, s13, ":quest_target_center")],
    "{s13} is heavily defended. How can I get close without being noticed?", "quest_meet_spy_in_enemy_town_accepted_2",
    []],
  [anyone,"quest_meet_spy_in_enemy_town_accepted_2", [], "You shall have to use stealth. Take care to avoid enemy strongholds, villages and patrols, and don't bring too many men with you. If you fail to sneak in the first time, give it a while for the garrison to lower its guard again, or you may have a difficult time infiltrating the town.", "quest_meet_spy_in_enemy_town_accepted_response",
    []],
  [anyone|plyr,"quest_meet_spy_in_enemy_town_accepted_response", [], "How will I recognise the spy?", "quest_meet_spy_in_enemy_town_accepted_3",
    []],
  [anyone,"quest_meet_spy_in_enemy_town_accepted_3", [(quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (str_store_party_name_link, s13, ":quest_target_center"),
      (troop_get_type, reg7, "$spy_quest_troop"),
      (quest_get_slot, ":secret_sign", "$random_quest_no", slot_quest_target_amount),
      (store_sub, ":countersign", ":secret_sign", secret_signs_begin),
      (val_add, ":countersign", countersigns_begin),
      (str_store_string, s11, ":secret_sign"),
      (str_store_string, s12, ":countersign"),],
    "Once you get to {s13} you must talk to the locals, the spy will be one of them. If you think you've found the spy, say the phrase '{s11}' The spy will respond with the phrase '{s12}' Thus you will know the other, and {reg7?she:he} will give you any information {reg7?she:he}'s gathered in my service.", "quest_meet_spy_in_enemy_town_accepted_response",
    []],
  [anyone|plyr,"quest_meet_spy_in_enemy_town_accepted_response", [], "Will I be paid?", "quest_meet_spy_in_enemy_town_accepted_4",
    []],
  [anyone,"quest_meet_spy_in_enemy_town_accepted_4", [], "Of course, I have plenty of silver in my coffers for loyal {men/women} like you. Do well by me, {playername}, and you'll rise high.", "quest_meet_spy_in_enemy_town_accepted_response",
    []],
  [anyone|plyr,"quest_meet_spy_in_enemy_town_accepted_response", [], "I know what to do. Farewell, my lord.", "quest_meet_spy_in_enemy_town_accepted_end",
    []],
  [anyone,"quest_meet_spy_in_enemy_town_accepted_end", [(quest_get_slot, ":secret_sign", "$random_quest_no", slot_quest_target_amount),
      (store_sub, ":countersign", ":secret_sign", secret_signs_begin),
      (val_add, ":countersign", countersigns_begin),
      (str_store_string, s11, ":secret_sign"),
      (str_store_string, s12, ":countersign")],
    "Good luck, {playername}. Remember, the secret phrase is '{s11}' The counterphrase is '{s12}' Bring any reports back to me, and I'll compensate you for your trouble.", "lord_pretalk",
    []],
  
  [anyone,"quest_meet_spy_in_enemy_town_rejected", [], "As you wish, {playername}, but I strongly advise you to forget anything I told you about any spies. They do not exist, have never existed, and no one will ever find them. Remember that.", "lord_pretalk",
    [(troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1)]],
  
  
  
  
  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_cause_provocation"),
      (quest_get_slot, ":quest_target_faction", "$random_quest_no", slot_quest_target_faction),
      (str_store_faction_name_link, s13, ":quest_target_faction")],
    "This peace with {s13} ill suits me, {playername}. We've let those swine have their way for far too long. " +
    "Now they get stronger with each passing and their arrogance knows no bounds. " +
    "I say, we must wage war on them before it's too late! " +
    "Unfortunately, some of the bleeding hearts among our realm's lords are blocking a possible declaration of war. " +
    "Witless cowards with no stomach for blood.", "lord_mission_told_raid_caravan_to_start_war",
    [
  ]],
  
  [anyone|plyr,"lord_mission_told_raid_caravan_to_start_war", [], "You are right, {s65}, but what can we do?", "lord_mission_tell_raid_caravan_to_start_war_2",[]],
  [anyone|plyr,"lord_mission_told_raid_caravan_to_start_war", [], "I disagree, sir. It is better that there be peace.", "quest_raid_caravan_to_start_war_rejected_1",[]],
  
  [anyone,"lord_mission_tell_raid_caravan_to_start_war_2", [(quest_get_slot, ":quest_target_faction", "$random_quest_no", slot_quest_target_faction),
      (str_store_faction_name_link, s13, ":quest_target_faction"),
      (str_store_faction_name, s14, "$g_talk_troop_faction")],
    "Ah, 'tis good to hear someone who understands! " +
    "As a matter of fact, there is something we can do, {playername}. A little bit of provocation... " +
    "If one of our war parties managed to enter their territory and pillage one of their caravans, or raided one of their villages, " +
    "and perhaps left behind a little token or two of the {s14}, " +
    "they would have ample cause to declare war on us. " +
    "And then, well, even the cowards among us must rise to defend themselves. " +
    "So what do you say? Are you interested?", "lord_mission_tell_raid_caravan_to_start_war_3",[]],
  
  [anyone|plyr,"lord_mission_tell_raid_caravan_to_start_war_3", [], "An excellent plan. Count me in.", "quest_raid_caravan_to_start_war_accepted",[]],
  [anyone|plyr,"lord_mission_tell_raid_caravan_to_start_war_3", [], "Why don't you do that yourself?", "lord_mission_tell_raid_caravan_to_start_war_4",[]],
  
  [anyone,"lord_mission_tell_raid_caravan_to_start_war_4", [
    ], "Well, {playername}, some of the lords in our kingdom " +
    "won't like the idea of someone inciting a war without their consent. " +
    "They are already looking for an excuse to get at me, and if I did this they could make me pay for it dearly. " +
    "You, on the other hand, are young and well-liked and daring, so you might just get away with it. " +
    "And of course I will back you up and defend your actions against your opponents. " +
    "All in all, a few lords might be upset at your endeavour, but I am sure you won't be bothered with that.", "lord_mission_tell_raid_caravan_to_start_war_5",[]],
  
  [anyone|plyr,"lord_mission_tell_raid_caravan_to_start_war_5", [], "That seems reasonable. I am willing to do this.", "quest_raid_caravan_to_start_war_accepted",[]],
  [anyone|plyr,"lord_mission_tell_raid_caravan_to_start_war_5", [], "I don't like this. Find yourself someone else to take the blame for your schemes.", "quest_raid_caravan_to_start_war_rejected_2",[]],
  
  [anyone,"quest_raid_caravan_to_start_war_accepted", [], "Very good! " +
    "A raid on a caravan, or, if you can't manage that, an attack on one of their villages, should do the trick. " +
    "Now, good luck and good hunting. Go set the borders aflame!", "close_window",
    [
      (quest_get_slot, ":quest_target_faction", "$random_quest_no", slot_quest_target_faction),
      (quest_get_slot, ":quest_target_amount", "$random_quest_no", slot_quest_target_amount),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_faction_name_link, s13, ":quest_target_faction"),
      (assign, reg13, ":quest_target_amount"),
      (setup_quest_text,"$random_quest_no"),
      (str_store_string, s2, "str_s9_asked_you_to_attack_a_village_or_some_caravans_as_to_provoke_a_war_with_s13"),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      #     (call_script, "script_change_player_relation_with_troop","$g_talk_troop",5),
      (assign, "$g_leave_encounter",1),
  ]],
  
  [anyone,"quest_raid_caravan_to_start_war_rejected_1", [], "Ah, you think so? But how long will your precious peace last? Not long, believe me.", "lord_pretalk",
    [(troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1)]],
  [anyone,"quest_raid_caravan_to_start_war_rejected_2", [], "Hm. As you wish, {playername}. " +
    "I thought you had some fire in you, but it seems I was wrong.", "lord_pretalk",
    [(troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1)]],
  
  
  
  
  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_bring_back_runaway_serfs")],
    "Well, some of the serfs working my fields in {s4} have run away. The ungrateful swine, " +
    "I let them plough my fields and rent my cottages, and this is how they repay me! " +
    "From what I've been hearing, they're running to {s3} as fast as they can, " +
    "and have split up into three groups to try and avoid capture. " +
    "I want you to capture all three groups and fetch them back to {s4} by whatever means necessary. " +
    "I should really have them hanged for attempting to escape, but we need hands for the upcoming harvest, " +
    "so I'll let them go off this time with a good beating.", "lord_mission_told",
    [
      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (quest_get_slot, ":quest_object_center", "$random_quest_no", slot_quest_object_center),
      
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_party_name_link, s3, ":quest_target_center"),
      (str_store_party_name_link, s4, ":quest_object_center"),
      (setup_quest_text,"$random_quest_no"),
      (str_store_string, s2, "str_s9_asked_you_to_catch_the_three_groups_of_runaway_serfs_and_bring_them_back_to_s4_alive_and_breathing_he_said_that_all_three_groups_are_heading_towards_s3"),
  ]],
  
  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_follow_spy")],
    "I have good information that a man in this very town is actually an enemy spy. " +
    "He should be seized and hanged for his impudence, " +
    "but we also believe that very soon he will leave town to meet with his master, " +
    "the man to whom the spy feeds all his little whispers. " +
    "The spy himself is of little import, but the master is a dangerous man, and could tell us a great deal " +
    "if we could only get our hands on him...", "lord_tell_mission_follow_spy",[]],
  [anyone,"lord_tell_mission_follow_spy", [],
    "I want you to wait here until the spy leaves town. Then you must follow him, stealthily, to the meeting place. " +
    "You must take absolute care not to be seen by the spy on your way, else he may suspect foul play and turn back. " +
    "When the master appears, you must ambush and arrest them and bring the pair back to me. " +
    "Alive, if you please.", "lord_tell_mission_follow_spy_2",
    [
  ]],
  
  [anyone|plyr, "lord_tell_mission_follow_spy_2", [],
    "I'll do it, {s65}.", "lord_tell_mission_follow_spy_accepted", []],
  [anyone|plyr, "lord_tell_mission_follow_spy_2", [],
    "No, this skulking is not for me.", "lord_tell_mission_follow_spy_rejected", []],
  
  
  [anyone,"lord_tell_mission_follow_spy_accepted", [],
    "Good, I'm sure you'll do a fine job of it. One of my men will point the spy out to you when he leaves, " +
    "so you will know the man to follow. Remember, I want them both, and I want them alive.", "close_window",
    [
      (str_store_troop_name_link, s11, "$g_talk_troop"),
      (str_store_party_name_link, s12, "$g_encountered_party"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s11} asked you to follow the spy that will leave {s12}. Be careful not to let the spy see you on the way, or he may get suspicious and turn back. Once the spy meets with his accomplice, you are to capture them and bring them back to {s11}."),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      #TODO: Change this value
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      
      (spawn_around_party, "p_main_party", "pt_spy_partners"),
      (assign, "$qst_follow_spy_spy_partners_party", reg0),
      (party_set_position, "$qst_follow_spy_spy_partners_party", pos63),
      (party_set_ai_behavior, "$qst_follow_spy_spy_partners_party", ai_bhvr_hold),
      (party_set_flags, "$qst_follow_spy_spy_partners_party", pf_default_behavior, 0),
      (set_spawn_radius, 0),
      (spawn_around_party, "$g_encountered_party", "pt_spy"),
      (assign, "$qst_follow_spy_spy_party", reg0),
      (party_set_ai_behavior, "$qst_follow_spy_spy_party", ai_bhvr_travel_to_party),
      (party_set_ai_object, "$qst_follow_spy_spy_party", "$qst_follow_spy_spy_partners_party"),
      (party_set_flags, "$qst_follow_spy_spy_party", pf_default_behavior, 0),
      (assign, "$g_leave_town", 1),
      (rest_for_hours, 2, 4, 0),
      #no need to set g_leave_encounter to 1 since this quest can only be given at a town
  ]],
  
  [anyone,"lord_tell_mission_follow_spy_rejected", [],
    "A shame. Well, carry on as you were, {playername}...", "lord_pretalk",
    [(troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1)]],
  
  
  
  
  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_capture_enemy_hero")],
    "There is a difficult job I need done, {playername}, and you may be the {man/one} who can carry it off. " +
    "I need someone to capture one of the noble lords of {s13} and bring him to me. " +
    "Afterwards, I'll be able to exchange him in return for a relative of mine held by {s13}. " +
    "It is a simple enough job, but whomever you choose will be guarded by an elite band of personal retainers. " +
    "Are you up for a fight?", "lord_tell_mission_capture_enemy_hero",
    [
      (quest_get_slot, ":quest_target_faction", "$random_quest_no", slot_quest_target_faction),
      (str_store_faction_name, s13, ":quest_target_faction"),
  ]],
  
  [anyone|plyr, "lord_tell_mission_capture_enemy_hero", [],
    "Consider it done, {s65}.", "lord_tell_mission_capture_enemy_hero_accepted", []],
  [anyone|plyr, "lord_tell_mission_capture_enemy_hero", [],
    "I must refuse, {s65}. I am not a kidnapper.", "lord_tell_mission_capture_enemy_hero_rejected", []],
  
  [anyone,"lord_tell_mission_capture_enemy_hero_accepted", [],
    "I like your spirit! Go and bring me one of our enemies, " +
    "and I'll toast your name in my hall when you return! And reward you for your efforts, of course...", "close_window",
    [
      (quest_get_slot, ":quest_target_faction", "$random_quest_no", slot_quest_target_faction),
      (str_store_troop_name_link, s11, "$g_talk_troop"),
      (str_store_faction_name_link, s13, ":quest_target_faction"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s11} asked you to capture a lord from {s13}, any lord, and then drag your victim back to {s11} for safekeeping."),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      #TODO: Change this value
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      (assign, "$g_leave_encounter",1),
  ]],
  
  [anyone,"lord_tell_mission_capture_enemy_hero_rejected", [],
    "Clearly you lack the mettle I had thought you possessed. Very well, {playername}, I will find someone else.", "lord_pretalk",
    [(troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1)]],
  
  
  
  
  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_lend_companion")],
    "I don't have a job for you right now, but your companion {s3} is a skilled {reg3?lass:fellow} " +
    "and I need someone with {reg3?her:his} talents. Will you lend {reg3?her:him} to me for a while?", "lord_tell_mission_lend_companion",
    [
      (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
      (quest_get_slot, ":quest_target_amount", "$random_quest_no", slot_quest_target_amount),
      (val_add, ":quest_target_amount", 1),
      (assign, reg1, ":quest_target_amount"),
      (str_store_troop_name_link,s9,"$g_talk_troop"),
      (str_store_troop_name,s3,":quest_target_troop"),
      (setup_quest_text,"$random_quest_no"),
      (troop_get_type, reg3, ":quest_target_troop"),
      (str_store_string, s2, "@{s9} asked you to lend your companion {s3} to him for a week."),
  ]],
  [anyone|plyr,"lord_tell_mission_lend_companion", [],
    "How long will you be needing {reg3?her:him}?", "lord_tell_mission_lend_companion_2", []],
  [anyone,"lord_tell_mission_lend_companion_2", [],
    "Just a few days, a week at most.", "lord_mission_lend_companion_told", []],
  
  [anyone|plyr,"lord_mission_lend_companion_told",
    [(quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),(str_store_troop_name,s3,":quest_target_troop"),],
    "Then I will leave {s3} with you for one week.", "lord_tell_mission_lend_companion_accepted", []],
  [anyone|plyr,"lord_mission_lend_companion_told", [(quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
      (str_store_troop_name,s3,":quest_target_troop"),],
    "I am sorry, but I cannot do without {s3} for a whole week.", "lord_tell_mission_lend_companion_rejected", []],
  
  [anyone,"lord_tell_mission_lend_companion_accepted", [],
    "I cannot thank you enough, {playername}. Worry not, your companion shall be returned to you with due haste.", "close_window",
    [(call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",1),
      (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
      (party_remove_members, "p_main_party", ":quest_target_troop", 1),
      (assign, "$g_leave_encounter",1),
  ]],
  
  [anyone,"lord_tell_mission_lend_companion_rejected", [],
    "Well, that's damned unfortunate, but I suppose I cannot force you or {s3} to agree. " +
    "I shall have to make do without.", "lord_pretalk",
    [(troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1)]],
  
  
  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_collect_debt")],
    "Some time ago, I loaned out a considerable sum of money to {s3}. {reg4} denars, to be precise. " +
    "He was supposed to pay it back within a month but I haven't received a copper from him since. " +
    "That was months ago. If you could collect the debt from him on my behalf, " +
    "I would be grateful indeed. I would even let you keep one fifth of the money for your trouble. " +
    "What do you say?", "lord_tell_mission_collect_debt",
    [
      (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (quest_get_slot, reg4, "$random_quest_no", slot_quest_target_amount),
      (str_store_troop_name_link,s9,"$g_talk_troop"),
      (str_store_troop_name_link,s3,":quest_target_troop"),
      (str_store_party_name_link,s4,":quest_target_center"),
      (setup_quest_text,"$random_quest_no"),
      (str_store_string, s2, "@{s9} asked you to collect the debt of {reg4} denars {s3} owes to him. {s3} was at {s4} when you were given this quest."),
  ]],
  [anyone|plyr,"lord_tell_mission_collect_debt", [],
    "Do you know where I can find {s3}, {s65}?", "lord_tell_mission_collect_debt_2", []],
  [anyone,"lord_tell_mission_collect_debt_2", [],
    "If you leave now, you should be able to find him at {s4}. " +
    "I've no doubt that he will be suitably embarassed by his conduct and give you all the money he owes me.", "lord_tell_mission_collect_debt_3", []],
  [anyone|plyr,"lord_tell_mission_collect_debt_3", [], "Then I will talk to {s3} on your behalf.", "lord_tell_mission_collect_debt_accepted", []],
  [anyone|plyr,"lord_tell_mission_collect_debt_3", [], "Forgive me, {s65}, but I doubt I would be more successful than yourself.", "lord_tell_mission_collect_debt_rejected", []],
  
  [anyone,"lord_tell_mission_collect_debt_accepted", [], "You made me very happy by accepting this {playername}. Please, talk to {s3} and don't leave him without my money.", "close_window",
    [(call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop", 1),
      (assign, "$g_leave_encounter",1),
  ]],
  
  [anyone,"lord_tell_mission_collect_debt_rejected", [], "Perhaps not, {playername}. I suppose I'm never getting that money back...", "lord_pretalk",
    [(troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1)]],
  
  ##
  ##  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_capture_conspirators")],
  ## "TODO: I want you to capture troops in {reg1} conspirator parties that plan to rebel against me and join {s3}.", "lord_mission_told",
  ##   [
  ##       (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
  ##       (assign, reg1, "$qst_capture_conspirators_num_parties_to_spawn"),
  ##       (str_store_troop_name_link,1,"$g_talk_troop"),
  ##       (str_store_party_name_link,2,"$g_encountered_party"),
  ##       (str_store_troop_name,3,":quest_target_troop"),
  ##       (setup_quest_text,"$random_quest_no"),
  ##       (try_begin),
  ##         (is_between, "$g_encountered_party", centers_begin, centers_end),
  ##         (setup_quest_giver, "$random_quest_no", "str_given_by_s1_at_s2"),
  ##       (else_try),
  ##         (setup_quest_giver,"$random_quest_no", "str_given_by_s1_in_wilderness"),
  ##       (try_end),
  ##    ]],
  ##
  ##
  ##  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_defend_nobles_against_peasants")],
  ## "TODO: I want you to defend {reg1} noble parties against peasants.", "lord_mission_told",
  ##   [
  ##       (assign, reg1, "$qst_defend_nobles_against_peasants_num_noble_parties_to_spawn"),
  ##       (str_store_troop_name_link,1,"$g_talk_troop"),
  ##       (str_store_party_name_link,2,"$g_encountered_party"),
  ##       (setup_quest_text,"$random_quest_no"),
  ##       (try_begin),
  ##         (is_between, "$g_encountered_party", centers_begin, centers_end),
  ##         (setup_quest_giver, "$random_quest_no", "str_given_by_s1_at_s2"),
  ##       (else_try),
  ##         (setup_quest_giver,"$random_quest_no", "str_given_by_s1_in_wilderness"),
  ##       (try_end),
  ##    ]],
  ##
  ##
  [anyone,"lord_tell_mission", [(eq, "$random_quest_no", "qst_incriminate_loyal_commander"),
      (quest_get_slot, ":quest_target_troop", "qst_incriminate_loyal_commander", slot_quest_target_troop),
      (quest_get_slot, ":quest_object_troop", "qst_incriminate_loyal_commander", slot_quest_object_troop),
      (quest_get_slot, ":quest_target_center", "qst_incriminate_loyal_commander", slot_quest_target_center),
      (str_store_troop_name_link, s13,":quest_target_troop"),
      (str_store_party_name_link, s14,":quest_target_center"),
      (str_store_troop_name_link, s15,":quest_object_troop"),
    ],
    "I tell you, that blubbering fool {s13} is not fit to rule {s14}. " +
    "God knows he would be divested of his lands in an instant were it not for one of his loyal vassals, {s15}. " +
    "As long as he has his vassal aiding him, it will be a difficult job beating him. " +
    "So I need to get {s15} out of the picture, and I have a plan just to do that... " +
    "With your help, naturally.", "lord_tell_mission_incriminate_commander",[]],
  
  [anyone|plyr,"lord_tell_mission_incriminate_commander", [], "{s66}, I am all ears.", "lord_tell_mission_incriminate_commander_2",[]],
  [anyone|plyr,"lord_tell_mission_incriminate_commander", [], "I don't wish to involve myself in anything dishonourable against {s15}.", "lord_tell_mission_incriminate_commander_rejected",[]],
  
  [anyone,"lord_tell_mission_incriminate_commander_rejected", [], "Dishonourable? Bah! " +
    "I was hoping I could count on you, {playername}, but you've shown me what a fool I was. " +
    "I shall have to find someone whose loyalty I can trust.", "lord_pretalk",
    [(call_script, "script_change_player_relation_with_troop","$g_talk_troop",-5),
      (call_script, "script_change_player_honor", 2)]],
  
  [anyone,"lord_tell_mission_incriminate_commander_2", [], "I have written a fake letter to {s15}, " +
    "bearing my own seal, which implicates him in a conspiracy with us to stage a coup in {s14}, in my favour. " +
    "If we can make {s13} believe the letter is genuine, he will deal with {s15} very swiftly. " +
    "Of course, the challenge there is to convince {s13} that the letter is indeed real...", "lord_tell_mission_incriminate_commander_3",[]],
  
  [anyone|plyr,"lord_tell_mission_incriminate_commander_3", [], "Please continue, {s65}...", "lord_tell_mission_incriminate_commander_4",[]],
  [anyone|plyr,"lord_tell_mission_incriminate_commander_3", [], "No, I will not sully myself with this dishonourable scheme.", "lord_tell_mission_incriminate_commander_rejected",[]],
  
  [anyone,"lord_tell_mission_incriminate_commander_4", [], "This is where you come into play. " +
    "You'll take the letter to {s14}, then give it to one of your soldiers and instruct him to take it to {s15}. " +
    "I will have one of my spies inform the town garrison so that your man will be arrested on his way. " +
    "The guards will then find the letter and take it to {s13}. " +
    "They'll torture your man, of course, to try and get the truth out of him, " +
    "but all he knows is that you ordered the letter to be delivered to {s15} under the utmost secrecy. " +
    "{s13} knows you serve me, and the fool will certainly believe the whole charade.", "lord_tell_mission_incriminate_commander_5",[]],
  
  [anyone|plyr,"lord_tell_mission_incriminate_commander_5", [], "Is that all?", "lord_tell_mission_incriminate_commander_7",[]],
  [anyone,"lord_tell_mission_incriminate_commander_7", [(str_store_troop_name, s8, "$incriminate_quest_sacrificed_troop"),
      (str_store_troop_name_plural, s9, "$incriminate_quest_sacrificed_troop"),
    ], "There is one more thing... " +
    "Your messenger must be someone trustworthy. If you sent the letter with a simple peasant, someone expendable, " +
    "{s13} might suspect a plot. He may have the wits of a snail, but even a snail can see the obvious. " +
    "Give the letter to someone of rank. One of your {s9}, perhaps.", "lord_tell_mission_incriminate_commander_8",[]],
  [anyone|plyr,"lord_tell_mission_incriminate_commander_8", [], "What? I can't send one of my trusted {s9} to his death!", "lord_tell_mission_incriminate_commander_9",[]],
  [anyone|plyr,"lord_tell_mission_incriminate_commander_8", [], "Then a {s8} it will be.", "lord_tell_mission_incriminate_commander_fin",[]],
  [anyone,"lord_tell_mission_incriminate_commander_9", [], "Come now, {playername}. " +
    "There is a place for sentimentality, but this is not it. Believe me, you shall be generously compensated, " +
    "and what is the purpose of soldiers if not to die at our say-so?", "lord_tell_mission_incriminate_commander_10",[]],
  [anyone|plyr,"lord_tell_mission_incriminate_commander_10", [], "A {s8} it is.", "lord_tell_mission_incriminate_commander_fin",[]],
  [anyone|plyr,"lord_tell_mission_incriminate_commander_10", [], "No, I'll not sacrifice one of my chosen men.", "lord_tell_mission_incriminate_commander_rejected",[]],
  
  [anyone,"lord_tell_mission_incriminate_commander_fin", [], "I can't tell you how pleased I am to hear that, " +
    "{playername}. You are removing one of the greatest obstacles in my path. " +
    "Here is the letter, as well as 300 denars for your expenses. " +
    "Remember, there'll be more once you succeed. Much, much more...", "lord_pretalk",
    [
      (quest_get_slot, ":quest_target_troop", "qst_incriminate_loyal_commander", slot_quest_target_troop),
      (quest_get_slot, ":quest_object_troop", "qst_incriminate_loyal_commander", slot_quest_object_troop),
      (quest_get_slot, ":quest_target_center", "qst_incriminate_loyal_commander", slot_quest_target_center),
      (call_script, "script_troop_add_gold", "trp_player", 300),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",2),
      (str_store_troop_name_link, s11,"$g_talk_troop"),
      (str_store_troop_name_link, s13,":quest_target_troop"),
      (str_store_party_name_link, s14,":quest_target_center"),
      (str_store_troop_name_plural, s15,"$incriminate_quest_sacrificed_troop"),
      (str_store_troop_name_link, s16,":quest_object_troop"),
      (setup_quest_text,"$random_quest_no"),
      (str_store_string, s2, "@{s11} gave you a fake letter to fool {s13} into banishing his vassal {s16}. " +
        "You are to go near {s14}, give the letter to one of your {s15} and send him into the town as a messenger, " +
      "believing his orders to be genuine."),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
  ]],
  
  [anyone,"lord_tell_mission", [(eq,"$random_quest_no","qst_capture_prisoners")],
    "A group of my soldiers were captured in a recent skirmish with the enemy. " +
    "Thankfully we have a mutual agreement of prisoner exchange, and they will release my men, " +
    "but they want us to give them prisoners of equal rank and number. Prisoners I don't currently have. " +
    "So, I need a good {man/warrior} to find me {reg1} {s3} as prisoners, that I may exchange them.", "lord_mission_told",
    [
      (quest_get_slot, ":quest_target_troop", "qst_capture_prisoners", slot_quest_target_troop),
      (quest_get_slot, ":quest_target_amount", "qst_capture_prisoners", slot_quest_target_amount),
      (assign,reg1,":quest_target_amount"),
      (str_store_troop_name_link,s9,"$g_talk_troop"),
      ##       (str_store_party_name,2,"$g_encountered_party"),
      (str_store_troop_name_by_count,3,":quest_target_troop",":quest_target_amount"),
      (setup_quest_text,"$random_quest_no"),
      ##       (try_begin),
      ##         (is_between, "$g_encountered_party", centers_begin, centers_end),
      ##         (setup_quest_giver, "$random_quest_no", "str_given_by_s1_at_s2"),
      ##       (else_try),
      ##         (setup_quest_giver,"$random_quest_no", "str_given_by_s1_in_wilderness"),
      ##       (try_end),
      (str_store_string, s2, "@{s9} has requested you to bring him {reg1} {s3} as prisoners."),
  ]],
  
  
  [anyone,"lord_tell_mission", [], "No {playername}. I do not need your help at this time.", "lord_pretalk",[]],
  
  
  [anyone|plyr,"lord_mission_told", [], "You can count on me, {s65}.", "lord_mission_accepted",[]],
  [anyone|plyr,"lord_mission_told", [], "I fear I cannot accept such a mission at the moment.", "lord_mission_rejected",[]],
  
  [anyone,"lord_mission_accepted", [], "Excellent, {playername}, excellent. I have every confidence in you.", "close_window",
    [(assign, "$g_leave_encounter",1),
      (try_begin),
        (eq, "$random_quest_no", "qst_escort_lady"),
        (quest_get_slot, ":quest_object_troop", "$random_quest_no", slot_quest_object_troop),
        (troop_set_slot, ":quest_object_troop", slot_troop_cur_center, 0),
        (troop_join, ":quest_object_troop"),
        ##    (else_try),
        ##      (eq, "$random_quest_no", "qst_hunt_down_raiders"),
        ##      (quest_get_slot, ":quest_object_center", "$random_quest_no", slot_quest_object_center),
        ##      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
        ##      (quest_get_slot, ":quest_target_faction", "$random_quest_no", slot_quest_target_faction),
        ##      (set_spawn_radius, 3),
        ##      (call_script, "script_cf_create_kingdom_party", ":quest_target_faction", spt_raider),
        ###      (spawn_around_party,":quest_object_center",":quest_target_party_template"),
        ##      (assign, ":quest_target_party", reg0),
        ##      (party_relocate_near_party, reg0, ":quest_object_center"),
        ##      (quest_set_slot, "$random_quest_no", slot_quest_target_party, ":quest_target_party"),
        ##      (party_set_ai_behavior,":quest_target_party",ai_bhvr_travel_to_party),
        ##      (party_set_ai_object,":quest_target_party",":quest_target_center"),
        ##      (party_set_flags, ":quest_target_party", pf_default_behavior, 0),
        ##      (party_set_faction,":quest_target_party",":quest_target_faction"),
        ##      (str_store_troop_name,1,"$g_talk_troop"),
        ##      (str_store_party_name,2,"$g_encountered_party"),
        ##      (str_store_party_name,3,":quest_object_center"),
        ##      (str_store_party_name,4,":quest_target_center"),
        ##      (setup_quest_text,"$random_quest_no"),
        ##      (try_begin),
        ##        (is_between, "$g_encountered_party", centers_begin, centers_end),
        ##        (setup_quest_giver, "$random_quest_no", "str_given_by_s1_at_s2"),
        ##      (else_try),
        ##        (setup_quest_giver,"$random_quest_no", "str_given_by_s1_in_wilderness"),
        ##      (try_end),
        ##    (else_try),
        ##      (eq, "$random_quest_no", "qst_bring_reinforcements_to_siege"),
        ##      (quest_get_slot, ":quest_object_troop", "$random_quest_no", slot_quest_object_troop),
        ##      (quest_get_slot, ":quest_target_amount", "$random_quest_no", slot_quest_target_amount),
        ##      (troop_get_slot, ":cur_party", "$g_talk_troop", slot_troop_leaded_party),
        ##      (party_remove_members, ":cur_party", ":quest_object_troop", ":quest_target_amount"),
        ##      (party_add_members, "p_main_party", ":quest_object_troop", ":quest_target_amount"),
        ##    (else_try),
        ##      (eq, "$random_quest_no", "qst_bring_prisoners_to_enemy"),
        ##      (quest_get_slot, ":quest_object_troop", "$random_quest_no", slot_quest_object_troop),
        ##      (quest_get_slot, ":quest_target_amount", "$random_quest_no", slot_quest_target_amount),
        ##      (party_add_prisoners, "p_main_party", ":quest_object_troop", ":quest_target_amount"),
      (else_try),
        (eq, "$random_quest_no", "qst_deliver_message_to_enemy_lord"),
        (call_script, "script_troop_add_gold", "trp_player", 10),
      (else_try),
        (eq, "$random_quest_no", "qst_bring_back_runaway_serfs"),
        (quest_get_slot, ":quest_giver_center", "$random_quest_no", slot_quest_giver_center),
        (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
        (quest_get_slot, ":quest_target_party_template", "$random_quest_no", slot_quest_target_party_template),
        
        (set_spawn_radius, 3),
        (spawn_around_party,":quest_giver_center",":quest_target_party_template"),
        (assign, "$qst_bring_back_runaway_serfs_party_1", reg0),
        (party_set_ai_behavior,"$qst_bring_back_runaway_serfs_party_1",ai_bhvr_travel_to_party),
        (party_set_ai_object,"$qst_bring_back_runaway_serfs_party_1",":quest_target_center"),
        (party_set_flags, "$qst_bring_back_runaway_serfs_party_1", pf_default_behavior, 0),
        (spawn_around_party,":quest_giver_center",":quest_target_party_template"),
        (assign, "$qst_bring_back_runaway_serfs_party_2", reg0),
        (party_set_ai_behavior,"$qst_bring_back_runaway_serfs_party_2",ai_bhvr_travel_to_party),
        (party_set_ai_object,"$qst_bring_back_runaway_serfs_party_2",":quest_target_center"),
        (party_set_flags, "$qst_bring_back_runaway_serfs_party_2", pf_default_behavior, 0),
        (spawn_around_party,":quest_giver_center",":quest_target_party_template"),
        (assign, "$qst_bring_back_runaway_serfs_party_3", reg0),
        (party_set_ai_behavior,"$qst_bring_back_runaway_serfs_party_3",ai_bhvr_travel_to_party),
        (party_set_ai_object,"$qst_bring_back_runaway_serfs_party_3",":quest_target_center"),
        (party_set_flags, "$qst_bring_back_runaway_serfs_party_3", pf_default_behavior, 0),
        (rest_for_hours, 1, 4),
        ##    (else_try),
        ##      (eq, "$random_quest_no", "qst_capture_conspirators"),
        ##      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
        ##      (spawn_around_party,"p_main_party","pt_conspirator_leader"),
        ##      (assign, "$qst_capture_conspirators_party_1", reg0),
        ##      (assign, "$qst_capture_conspirators_num_parties_spawned", 1),
        ##      (party_set_ai_behavior, "$qst_capture_conspirators_party_1", ai_bhvr_hold),
        ##      (party_set_flags, "$qst_capture_conspirators_party_1", pf_default_behavior, 0),
        ##      (party_get_position, pos1, ":quest_target_center"),
        ##      (call_script, "script_map_get_random_position_around_position_within_range", 17, 19),
        ##      (party_set_position, "$qst_capture_conspirators_party_1", pos2),
        ##      (party_get_num_companions, ":num_companions", "$qst_capture_conspirators_party_1"),
        ##      (val_add, "$qst_capture_conspirators_num_troops_to_capture", ":num_companions"),
        ##    (else_try),
        ##      (eq, "$random_quest_no", "qst_defend_nobles_against_peasants"),
        ##      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
        ##      (set_spawn_radius, 9),
        ##      (try_for_range, ":unused", 0, "$qst_defend_nobles_against_peasants_num_peasant_parties_to_spawn"),
        ##        (spawn_around_party, ":quest_target_center", "pt_peasant_rebels"),
        ##        (try_begin),
        ##          (le, "$qst_defend_nobles_against_peasants_peasant_party_1", 0),
        ##          (assign, "$qst_defend_nobles_against_peasants_peasant_party_1", reg0),
        ##        (else_try),
        ##          (le, "$qst_defend_nobles_against_peasants_peasant_party_2", 0),
        ##          (assign, "$qst_defend_nobles_against_peasants_peasant_party_2", reg0),
        ##        (else_try),
        ##          (le, "$qst_defend_nobles_against_peasants_peasant_party_3", 0),
        ##          (assign, "$qst_defend_nobles_against_peasants_peasant_party_3", reg0),
        ##        (else_try),
        ##          (le, "$qst_defend_nobles_against_peasants_peasant_party_4", 0),
        ##          (assign, "$qst_defend_nobles_against_peasants_peasant_party_4", reg0),
        ##        (else_try),
        ##          (le, "$qst_defend_nobles_against_peasants_peasant_party_5", 0),
        ##          (assign, "$qst_defend_nobles_against_peasants_peasant_party_5", reg0),
        ##        (else_try),
        ##          (le, "$qst_defend_nobles_against_peasants_peasant_party_6", 0),
        ##          (assign, "$qst_defend_nobles_against_peasants_peasant_party_6", reg0),
        ##        (else_try),
        ##          (le, "$qst_defend_nobles_against_peasants_peasant_party_7", 0),
        ##          (assign, "$qst_defend_nobles_against_peasants_peasant_party_7", reg0),
        ##        (else_try),
        ##          (le, "$qst_defend_nobles_against_peasants_peasant_party_8", 0),
        ##          (assign, "$qst_defend_nobles_against_peasants_peasant_party_8", reg0),
        ##        (try_end),
        ##      (try_end),
        ##      (set_spawn_radius, 0),
        ##      (party_get_position, pos1, ":quest_target_center"),
        ##      (try_for_range, ":unused", 0, "$qst_defend_nobles_against_peasants_num_noble_parties_to_spawn"),
        ##        (spawn_around_party, ":quest_target_center", "pt_noble_refugees"),
        ##        (assign, ":cur_noble_party", reg0),
        ##        (party_set_ai_behavior, ":cur_noble_party", ai_bhvr_travel_to_party),
        ##        (party_set_ai_object, ":cur_noble_party", ":quest_target_center"),
        ##	    (party_set_flags, ":cur_noble_party", pf_default_behavior, 0),
        ##        (call_script, "script_map_get_random_position_around_position_within_range", 13, 17),
        ##        (party_set_position, ":cur_noble_party", pos2),
        ##        (party_get_num_companions, ":num_companions", ":cur_noble_party"),
        ##        (val_add, "$qst_defend_nobles_against_peasants_num_nobles_to_save", ":num_companions"),
        ##        (try_begin),
        ##          (le, "$qst_defend_nobles_against_peasants_noble_party_1", 0),
        ##          (assign, "$qst_defend_nobles_against_peasants_noble_party_1", reg0),
        ##        (else_try),
        ##          (le, "$qst_defend_nobles_against_peasants_noble_party_2", 0),
        ##          (assign, "$qst_defend_nobles_against_peasants_noble_party_2", reg0),
        ##        (else_try),
        ##          (le, "$qst_defend_nobles_against_peasants_noble_party_3", 0),
        ##          (assign, "$qst_defend_nobles_against_peasants_noble_party_3", reg0),
        ##        (else_try),
        ##          (le, "$qst_defend_nobles_against_peasants_noble_party_4", 0),
        ##          (assign, "$qst_defend_nobles_against_peasants_noble_party_4", reg0),
        ##        (else_try),
        ##          (le, "$qst_defend_nobles_against_peasants_noble_party_5", 0),
        ##          (assign, "$qst_defend_nobles_against_peasants_noble_party_5", reg0),
        ##        (else_try),
        ##          (le, "$qst_defend_nobles_against_peasants_noble_party_6", 0),
        ##          (assign, "$qst_defend_nobles_against_peasants_noble_party_6", reg0),
        ##        (else_try),
        ##          (le, "$qst_defend_nobles_against_peasants_noble_party_7", 0),
        ##          (assign, "$qst_defend_nobles_against_peasants_noble_party_7", reg0),
        ##        (else_try),
        ##          (le, "$qst_defend_nobles_against_peasants_noble_party_8", 0),
        ##          (assign, "$qst_defend_nobles_against_peasants_noble_party_8", reg0),
        ##        (try_end),
        ##      (try_end),
      (try_end),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (try_begin),
        (eq, "$random_quest_no", "qst_lend_surgeon"),
        (assign, "$g_leave_town_outside", 1),
        (assign,"$auto_enter_town","$g_encountered_party"),
        #      (store_current_hours, "$quest_given_time"),
        (rest_for_hours, 4),
        (assign, "$lord_requested_to_talk_to", "$g_talk_troop"),
      (try_end),
  ]],
  [anyone,"lord_mission_rejected", [], "Is that so? Well, I suppose you're just not up to the task. " +
    "I shall have to look for somebody with more mettle.", "close_window",
    [(assign, "$g_leave_encounter",1),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -1),
      (try_begin),
        (quest_slot_eq, "$random_quest_no", slot_quest_dont_give_again_remaining_days, 0),
        (quest_set_slot, "$random_quest_no", slot_quest_dont_give_again_remaining_days, 1),
      (try_end),
      (troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1),
  ]],
  
  
  ##### TODO: QUESTS COMMENT OUT END
  
  ## Freelancer
  # dialog_ask_enlistment
  
  [anyone|plyr,"lord_talk", [
      (eq, "$freelancer_state", 0),
      (ge, "$g_talk_troop_faction_relation", 0),
      #(neq, "$players_kingdom", "$g_talk_troop_faction"),
      (eq, "$players_kingdom", 0),
      (troop_get_type, reg3, "$g_talk_troop"),
      (try_begin),
        (eq, reg3, 2),
        (assign, reg3, 1), #Kham - Jeanne is female
      (else_try),
        (gt, reg3, 2), #Kham: other skins are male
        (assign, reg3, 0),
      (try_end),
    ],
    "My {reg3?Lady:Lord}, I would like to like to enlist in your army.", "lord_request_enlistment",[]],
  
  # dialog_advise_retirement
  
  [anyone|plyr,"lord_talk", [
      (eq, "$g_talk_troop", "$enlisted_lord"),
      (neq, "$freelancer_state", 0),
      (ge, "$g_talk_troop_faction_relation", 0),
      (neq, "$players_kingdom", "$g_talk_troop_faction"),
      (eq, "$players_kingdom", 0),
      (troop_get_type, reg3, "$g_talk_troop"),
      (try_begin),
        (eq, reg3, 2),
        (assign, reg3, 1), #Kham - Jeanne is female
      (else_try),
        (gt, reg3, 2), #Kham: other skins are male
        (assign, reg3, 0),
      (try_end),
    ],
    "My {reg3?Lady:Lord}, I would like to like to retire from service.", "lord_request_retire",[]],
  
  #dialog_ask_leave
  [anyone|plyr,"lord_talk",[
      (eq, "$g_talk_troop", "$enlisted_lord"),
      (eq, "$freelancer_state", 1),
      (ge, "$g_talk_troop_faction_relation", 0),
      (neq, "$players_kingdom", "$g_talk_troop_faction"),
      (eq, "$players_kingdom", 0),
      (troop_get_type, reg3, "$g_talk_troop"),
      (try_begin),
        (eq, reg3, 2),
        (assign, reg3, 1), #Kham - Jeanne is female
      (else_try),
        (gt, reg3, 2), #Kham: other skins are male
        (assign, reg3, 0),
      (try_end),
    ],
    "My {reg3?Lady:Lord}, I would like to request some personal leave", "lord_request_vacation",[]],
  
  #dialog_ask_return_from_leave
  [anyone|plyr,"lord_talk",[
      (eq, "$g_talk_troop", "$enlisted_lord"),
      (eq, "$freelancer_state", 2),
      (ge, "$g_talk_troop_faction_relation", 0),
      (neq, "$players_kingdom", "$g_talk_troop_faction"),
      (eq, "$players_kingdom", 0),
      (troop_get_type, reg3, "$g_talk_troop"),
      (try_begin),
        (eq, reg3, 2),
        (assign, reg3, 1), #Kham - Jeanne is female
      (else_try),
        (gt, reg3, 2), #Kham: other skins are male
        (assign, reg3, 0),
      (try_end),
    ],
    "My {reg3?Lady:Lord}, I am ready to return to your command.", "ask_return_from_leave",[]],
  
  ## Freelancer END
  
  #Leave
  [anyone|plyr,"lord_talk",
    [
      (troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      ], "I must leave now.", "lord_leave_prison",[]],
  
  [anyone|plyr,"lord_talk",
    [
      (lt, "$g_talk_troop_faction_relation", 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      ], "This audience is over. I leave now.", "lord_leave",[]],
  
  [anyone|plyr,"lord_talk",
    [
      (ge, "$g_talk_troop_faction_relation", 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      ], "I must beg my leave.", "lord_leave",[]],
  
  [anyone,"lord_leave", [#(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (lt, "$g_talk_troop_faction_relation", 0),
      (store_partner_quest,":enemy_lord_quest"),
      (lt, ":enemy_lord_quest", 0),
      (troop_slot_eq, "$g_talk_troop", slot_troop_does_not_give_quest, 0),
      (call_script, "script_get_quest", "$g_talk_troop"),
      (assign, "$random_quest_no", reg0),
      (ge, "$random_quest_no", 0),
      (this_or_next|eq, "$random_quest_no", "qst_lend_surgeon"), #so far only for quest lend surgeon
      (eq, 2, 1),
    ],
    "Before you go, {playername}, I have something to ask of you... We may be enemies in this war, " +
    "but I pray that you believe, as I do, that we can still be civil towards each other. " +
    "Thus I hoped that you would be kind enough to assist me in something important to me.", "lord_leave_give_quest",[]],
  
  [anyone|plyr,"lord_leave_give_quest", [],
    "I am listening.", "enemy_lord_tell_mission",[]],
  
  
  [anyone,"enemy_lord_tell_mission", [(eq,"$random_quest_no","qst_lend_surgeon")],
    "I have a friend here, an old warrior, who is very sick. Pestilence has infected an old battle wound, " +
    "and unless he is seen to by a surgeon soon,  he will surely die. This man is dear to me, {playername}, " +
    "but he's also stubborn as a hog and refuses to have anyone look at his injury because he doesn't trust the physicians here. " +
    "I have heard that you've a capable surgeon with you. If you would let your surgeon come here and have a look, " +
    "{reg3?she:he} may be able to convince him to give his consent to an operation. " +
    "Please, I will be deeply indebted to you if you grant me this request.", "lord_mission_told",
    [
      (quest_get_slot, ":quest_object_troop", "$random_quest_no", slot_quest_object_troop),
      (str_store_troop_name_link,1,"$g_talk_troop"),
      ##     (str_store_party_name,2,"$g_encountered_party"),
      (str_store_troop_name,3,":quest_object_troop"),
      (troop_get_type, reg3, ":quest_object_troop"),
      (setup_quest_text,"$random_quest_no"),
      ##     (try_begin),
      ##       (is_between, "$g_encountered_party", centers_begin, centers_end),
      ##       (setup_quest_giver, "$random_quest_no", "str_given_by_s1_at_s2"),
      ##     (else_try),
      ##       (setup_quest_giver,"$random_quest_no", "str_given_by_s1_in_wilderness"),
      ##     (try_end),
      (str_store_string, s2, "@Lend your experienced surgeon {s3} to {s1}."),
  ]],
  
  [anyone,"enemy_lord_tell_mission", [(str_store_quest_name, s7, "$random_quest_no")],
    "{!}ERROR: MATCHED WITH QUEST: {s7}.", "close_window",
    []],
  
  #### Freelancer - Kham Implementation ####
  
  # dialog_accept_enlistment
  
  [anyone,"lord_request_enlistment",
    [
      (ge, "$g_talk_troop_relation", 0),
      (try_begin),
        (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_freelancer_troop, 0),
        (faction_get_slot, reg1, "$g_talk_troop_faction", slot_faction_freelancer_troop),
      (else_try),
        (faction_get_slot, reg1, "$g_talk_troop_faction", slot_faction_tier_1_troop),
      (try_end),
      (str_store_troop_name, s1, reg1),
      (store_character_level, reg1, reg1),
      (val_mul, reg1, 10),
      (str_store_string, s2, "str_reg1_denars"),
      (try_begin),
        (store_troop_faction, ":commander_faction", "$enlisted_lord"),
        (str_store_troop_name, s4, "$enlisted_lord"),
        (faction_get_slot, ":is_captain", ":commander_faction", slot_faction_freelancer_captain), #Are they currently a captain for this faction?
        (lt, ":is_captain", 0),
        (str_store_string, s3, "@ I've heard that you were already an officer under {s4}. However, you will have to earn my trust and that of my men. So for now, "),
      (else_try),
        (str_store_string, s3, "@ "),
      (try_end),
      ], "I've got room in my ranks for a {man/woman} of your disposition, {playername}.{s3}I can take you on as a {s1}, with a weekly pay of {s2}. And food, of course.  Plenty of room for promotion and you'll be equipped as befits your rank. You'll have your take of what you can scavange in battle, too.  What do you say?", "lord_request_enlistment_confirm", []],
  
  [anyone|plyr,"lord_request_enlistment_confirm", [
      (troop_get_type, reg3, "$g_talk_troop"),
      (try_begin),
        (eq, reg3, 2),
        (assign, reg3, 1), #Kham - Jeanne is female
      (else_try),
        (gt, reg3, 2), #Kham: other skins are male
        (assign, reg3, 0),
      (try_end),],
    "Seems a fair lot and steady work in these lands. I'm with you, my {reg3?Lady:Lord}.", "close_window",
    [
      (party_clear, "p_freelancer_party_backup"),
      (call_script, "script_party_copy", "p_freelancer_party_backup", "p_main_party"),
      (remove_member_from_party, "trp_player","p_freelancer_party_backup"),
      (call_script, "script_event_player_enlists"),
      (assign, "$g_infinite_camping", 1),
      (rest_for_hours_interactive, 24 * 365, 5, 1),
      (assign, "$freelancer_speed", 0),
      (eq,"$talk_context",tc_party_encounter),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone|plyr,"lord_request_enlistment_confirm",[
      (troop_get_type, reg3, "$g_talk_troop"),
      (try_begin),
        (eq, reg3, 2),
        (assign, reg3, 1), #Kham - Jeanne is female
      (else_try),
        (gt, reg3, 2), #Kham: other skins are male
        (assign, reg3, 0),
      (try_end),],
    "Well, on second thought my {reg3?Lady:Lord}, I might try my luck alone a bit longer. My thanks.", "lord_pretalk",[]],
  
  # dialog_reject_enlistment
  
  [anyone,"lord_request_enlistment", [(lt, "$g_talk_troop_relation", 0)],
    "I do not trust you enough to allow you to serve for me.", "lord_pretalk",[]],
  
  
  
  # dialog_lord_accept_retire
  
  [anyone,"lord_request_retire",
    [
    ],
    "Very well {playername}. You are relieved of duty.", "lord_pretalk",[
      (call_script, "script_event_player_discharge"),
      #If player is a sarge or captain, remove his party - Kham
      (store_faction_of_troop, ":commander_faction", "$enlisted_lord"),
      (try_begin),
        (faction_get_slot, ":is_sarge", ":commander_faction", slot_faction_freelancer_captain), #is sarge / captain?
        (gt, ":is_sarge", 0),
        (call_script, "script_freelancer_remove_player_party"),
      (try_end),
      #End Removal of Player Party
      (call_script, "script_party_restore"),
      (change_screen_map),
    ],
  ],
  
  #dialog_accept_leave
  [anyone,"lord_request_vacation",
    [
      (ge, "$g_talk_troop_relation", 0),
      (store_troop_faction, ":commander_faction", "$enlisted_lord"),
      (faction_get_slot, reg3, ":commander_faction", slot_freelancer_rank),
      (val_add, reg3, 2), #add 2 days per rank for vacation. So a rank 1 only gets 3 days, rank 2, gets 4, etc...
      
    ],
    "Very well {playername}. You shall take some time off from military duty. Return in {reg3} days.", "lord_pretalk",[
      (call_script, "script_event_player_vacation"),
      #If player is a sarge or captain, remove his party - Kham
      (store_faction_of_troop, ":commander_faction", "$enlisted_lord"),
      (try_begin),
        (faction_get_slot, ":is_sarge", ":commander_faction", slot_faction_freelancer_captain), #is sarge / captain?
        (gt, ":is_sarge", 0),
        (call_script, "script_freelancer_remove_player_party"),
      (try_end),
      #End Removal of Player Party
      (call_script, "script_party_restore"),
      (change_screen_map),
    ],
  ],
  
  
  
  
  #dialog_accept_ask_return_from_leave
  [anyone,"ask_return_from_leave",
    [
      (ge, "$g_talk_troop_relation", 0),
      (neg|troop_slot_eq, "trp_player", slot_freelancer_mission, 1),
    ],
    "Welcome back {playername}. Your regiment has missed you I daresay, Now return to your post.", "lord_pretalk",[
      (call_script, "script_party_copy", "p_freelancer_party_backup", "p_main_party"),
      (remove_member_from_party, "trp_player","p_freelancer_party_backup"),
      (call_script, "script_event_player_returns_vacation"),
      (change_screen_map),
    ],
  ],
  
  #dialog_accept_ask_return_from_leave - For Mission Completion (Kham)
  [anyone,"ask_return_from_leave",
    [
      (ge, "$g_talk_troop_relation", 0),
      (troop_slot_eq, "trp_player", slot_freelancer_mission, 1),
    ],
    "Welcome back {playername}. Thank you for completing the mission. Now return to your post.", "close_window",[
      (call_script, "script_party_copy", "p_freelancer_party_backup", "p_main_party"),
      (remove_member_from_party, "trp_player","p_freelancer_party_backup"),
      (call_script, "script_event_player_returns_mission"),
      (change_screen_map),
    ],
  ],
  
  #+freelancer end
  
  #### Freelancer - Kham Implementation END ####
  
  
  [anyone,"lord_leave_prison", [],
    "We'll meet again.", "close_window",[]],
  
  [anyone|auto_proceed,"lord_leave", [
      (troop_get_type, ":type", "trp_player"),
      (eq, ":type", 1),
      (call_script, "script_troop_get_romantic_chemistry_with_troop", "trp_player", "$g_talk_troop"),
      (gt, reg0, 7),
      (ge, "$g_talk_troop_relation", 0),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_betrothed, active_npcs_begin),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_spouse, active_npcs_begin),
      (neg|troop_slot_ge, "trp_player", slot_troop_betrothed, active_npcs_begin),
      (neg|troop_slot_ge, "trp_player", slot_troop_spouse, active_npcs_begin),
      
      (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"),
      
    ],
    "Farewell, my lady. I shall remain your most ardent admirer.", "close_window",
    [(eq,"$talk_context",tc_party_encounter),
      (assign, "$g_leave_encounter", 1)]],
  
  
  [anyone|auto_proceed,"lord_leave", [(faction_slot_eq,"$g_talk_troop_faction",slot_faction_leader,"$g_talk_troop")],
    "Of course, {playername}. Farewell.", "close_window",[(eq,"$talk_context",tc_party_encounter),(assign, "$g_leave_encounter", 1)]],
  [anyone|auto_proceed,"lord_leave", [(ge,"$g_talk_troop_relation",10)],
    "Good journeys to you, {playername}.", "close_window",[(eq,"$talk_context",tc_party_encounter),(assign, "$g_leave_encounter", 1)]],
  [anyone|auto_proceed,"lord_leave", [(ge, "$g_talk_troop_faction_relation", 0)],
    "Yes, yes. Farewell.", "close_window",[(eq,"$talk_context",tc_party_encounter),(assign, "$g_leave_encounter", 1)]],
  [anyone|auto_proceed,"lord_leave", [],
    "We will meet again.", "close_window",[(eq,"$talk_context",tc_party_encounter),(assign, "$g_leave_encounter", 1)]],
  
  
  #Royal family members
  
  
  [anyone|plyr,"member_chat", [(troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady)],
    "Are you enjoying the journey, {s65}?", "lady_journey_1",[]],
  [anyone,"lady_journey_1", [],
    "I am doing quite fine, {playername}. Thank you for your concern.", "close_window",[]],
  
  
  #Spouse
  [anyone,"start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      #    (troop_slot_eq, "$g_talk_troop", slot_troop_spouse, "trp_player"),
      (troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop"),
    ],
    "Yes, my husband?", "spouse_talk",[
  ]],
  
  [anyone|plyr,"spouse_talk",
    [
      (eq, "$g_player_minister", "$g_talk_troop"),
    ],
    "As you are my chief minister, I wish to speak to about affairs of state", "minister_issues",[
  ]],
  
  [anyone|plyr,"spouse_talk",
    [
      (assign, "$political_quest_to_cancel", -1),
      (try_begin),
        (check_quest_active, "qst_offer_gift"),
        (quest_slot_eq, "qst_offer_gift", slot_quest_giver_troop, "$g_talk_troop"),
        (assign, "$political_quest_to_cancel", "qst_offer_gift"),
        (str_store_string, s10, "str_offer_gift_description"),
      (else_try),
        (check_quest_active, "qst_resolve_dispute"),
        (quest_slot_eq, "qst_resolve_dispute", slot_quest_giver_troop, "$g_talk_troop"),
        (assign, "$political_quest_to_cancel", "qst_resolve_dispute"),
        (str_store_string, s10, "str_resolve_dispute_description"),
      (try_end),
      (gt, "$political_quest_to_cancel", 0),
    ],
    "Let's abandon our plan to {s10}.", "spouse_cancel_political_quest",[
  ]],
  
  [anyone,"spouse_cancel_political_quest",
    [],
    "Are you sure you want to drop that idea?", "spouse_cancel_political_quest_confirm",[
  ]],
  [anyone|plyr,"spouse_cancel_political_quest_confirm",
    [],
    "Yes, I am sure. Let's abandon that idea.", "spouse_pretalk",[
      (call_script, "script_abort_quest", "$political_quest_to_cancel"),
  ]],
  [anyone|plyr,"spouse_cancel_political_quest_confirm",
    [],
    "Actually, never mind.", "spouse_pretalk",[
  ]],
  
  
  
  [anyone|plyr,"spouse_talk",
    [],
    "Let us think of a way to improve our standing in this realm", "combined_political_quests",[
      (call_script, "script_get_political_quest", "$g_talk_troop"),
      (assign, "$political_quest_found", reg0),
      (assign, "$political_quest_target_troop", reg1),
      (assign, "$political_quest_object_troop", reg2),
  ]],
  
  [anyone|plyr, "spouse_talk",
    [
      (neg|check_quest_active, "qst_organize_feast"),
    ],
    "I was thinking that perhaps we could host a feast", "spouse_organize_feast",[
  ]],
  
  [anyone|plyr, "spouse_talk",
    [
    ],
    "Let us take inventory of our household possessions", "spouse_household_possessions",[
      (change_screen_loot, "trp_household_possessions"),
  ]],
  
  [anyone, "spouse_household_possessions",
    [
    ],
    "Anyway, that is the content of our larder.", "spouse_pretalk",[
  ]],
  
  
  [anyone|plyr,"spouse_talk",
    [],
    "We shall speak later, my {wife/husband}", "close_window",[
  ]],
  
  
  
  
  #Bride
  [anyone,"wedding_ceremony_bride_vow",
    [
      #    (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      #	(check_quest_active, "qst_wed_betrothed"),
      #	(quest_slot_eq, "qst_wed_betrothed", slot_quest_target_troop, "$g_talk_troop"),
      #	(quest_slot_eq, "qst_wed_betrothed", slot_quest_current_state, 2),
      #	(neg|quest_slot_ge, "qst_wed_betrothed", slot_quest_expiration_days, 2),
    ],
    "My husband, I hearby pledge to be your wife, to stand with you in good times and bad. May the heavens smile upon us and bless us with children, livestock, and land.", "wedding_ceremony_player_vow",[
      (quest_get_slot, ":bride", "qst_wed_betrothed", slot_quest_target_troop),
      (set_conversation_speaker_troop, ":bride"),
  ]],
  
  [anyone|plyr,"wedding_ceremony_player_vow",
    [],
    "I pledge the same. Let us be husband and wife.", "wedding_ceremony_vows_complete",[
  ]],
  
  [anyone|plyr,"wedding_ceremony_player_vow",
    [],
    "Wait -- hold on... I'm not quite ready for this.", "close_window",[
  ]],
  
  [anyone,"wedding_ceremony_vows_complete",
    [],
    "I now declare you and {s3} to be husband and wife. Go now to the chamber prepared for you, and we shall make arrangements for your bride to join you in your hall in {s11}.", "close_window",[
      (call_script, "script_courtship_event_bride_marry_groom", "$g_player_bride", "trp_player", 0), #parameters from dialog
      (call_script, "script_get_kingdom_lady_social_determinants", "$g_player_bride"),
      (str_store_troop_name, s3, "$g_player_bride"),
      
      (try_begin),
        (neq, reg0, "trp_player"),
        (str_store_string, s11, "str_error__player_not_logged_as_groom"),
      (else_try),
        (str_store_party_name, s11, reg1),
        (troop_set_slot, "$g_player_bride", slot_troop_cur_center, reg1),
      (try_end),
  ]],
  #WEDDING CUTSCENE BEGINS HERE
  
  [anyone, "spouse_pretalk",
    [],
    "Is there anything else, my {husband/wife}?", "spouse_talk",[
  ]],
  
  
  
  
  
  
  #take inventory
  [anyone,"spouse_organize_feast",
    [
      (faction_slot_eq, "$players_kingdom", slot_faction_ai_state, sfai_feast),
      (faction_slot_eq, "$players_kingdom", slot_faction_ai_object, "$g_encountered_party"),
    ],
    "A splendid idea, my {husband/wife}. However, let us wait for the current feast here to conclude, before organizing another.", "spouse_pretalk",[
  ]],
  
  [anyone,"spouse_organize_feast",
    [
      (eq, "$players_kingdom", "fac_player_supporters_faction"),
      (neg|is_between, "$g_player_court", centers_begin, centers_end),
    ],
    "A splendid idea, my {husband/wife}. However, we must establish a court before hosting a feast.", "spouse_pretalk",[
  ]],
  
  [anyone,"spouse_organize_feast",
    [
      (eq, "$players_kingdom", "fac_player_supporters_faction"),
      (store_current_hours, ":hours_since_last_feast"),
      (faction_get_slot, ":last_feast_time", "$players_kingdom", slot_faction_last_feast_start_time),
      (val_sub, ":hours_since_last_feast", ":last_feast_time"),
      (try_begin),
        (ge, "$cheat_mode", 1),
        (assign, reg4, ":hours_since_last_feast"),
        (str_store_faction_name, s4, "$players_kingdom"),
        (display_message, "@{!}DEBUG -- {reg4} hours since last feast for {s4}"),
      (try_end),
      (lt, ":hours_since_last_feast", 120),
      (store_sub, ":days_to_wait", 168, ":hours_since_last_feast"),
      (val_div, ":days_to_wait", 24),
      (assign, reg3, ":days_to_wait"),
    ],
    "A splendid idea, my {husband/wife}. However, our realm has recently had a feast. Perhaps we should wait another {reg3} days before we organize another one.", "spouse_pretalk",[
  ]],
  
  
  
  
  
  [anyone,"spouse_organize_feast",
    [],
    "A splendid idea, my {husband/wife}. However, to not insult our guests, we must make sure that we can provide a large and varied repast, for the lords, their families, and their retinues. All told, we should count on a couple of hundred mouths to feed, over several days. Let us take an inventory of our household possessions...", "spouse_evaluate_larder_for_feast",[
  ]],
  
  [anyone, "spouse_evaluate_larder_for_feast",
    [
      (call_script, "script_internal_politics_rate_feast_to_s9", "trp_household_possessions", 600, "$players_kingdom", 0),   #party, number of guests, taste, consume items
      (assign, "$feast_quality", reg0),
    ],
    "{s9}",   "spouse_feast_confirm",[]],
  
  
  [anyone|plyr, "spouse_feast_confirm",
    [
    ],
    "Let me add more items to our storehouses",   "spouse_feast_added_items", [
      (change_screen_loot, "trp_household_possessions"),
  ]],
  
  [anyone, "spouse_feast_added_items",
    [],
    "All right -- let me reevalute what is there...",   "spouse_evaluate_larder_for_feast",[]],
  
  
  
  [anyone|plyr, "spouse_feast_confirm",
    [
      (gt, "$feast_quality", 1),
    ],
    "Let us dispatch the invitations",   "spouse_feast_confirm_yes", []],
  
  [anyone|plyr, "spouse_feast_confirm",
    [
    ],
    "Let us wait, then",   "spouse_pretalk",[]],
  
  
  [anyone, "spouse_feast_confirm_yes",
    [ (neq, "$players_kingdom", "fac_player_supporters_faction"),],
    "I shall send word, then, that we will host a feast as soon as conditions in the realm permit. You perhaps should continue to stock our larder, so that we may do justice to our reputation for hospitality.",   "spouse_pretalk",[
      
      
      (assign, ":feast_venue", -1),
      (try_begin),
        (is_between, "$g_encountered_party", walled_centers_begin, walled_centers_end),
        (this_or_next|party_slot_eq, "$g_encountered_party", slot_town_lord, "trp_player"),
        (party_slot_eq, "$g_encountered_party", slot_town_lord, "$g_talk_troop"),
        (assign, ":feast_venue", "$g_encountered_party"),
      (else_try),
        (try_for_range, ":center", walled_centers_begin, walled_centers_end),
          (eq, ":feast_venue", -1),
          (this_or_next|party_slot_eq, ":center", slot_town_lord, "trp_player"),
          (party_slot_eq, ":center", slot_town_lord, "$g_talk_troop"),
          (assign, ":feast_venue", ":center"),
        (try_end),
      (else_try),
        (is_between, "$g_encountered_party", walled_centers_begin, walled_centers_end),
        (assign, ":feast_venue", "$g_encountered_party"),
      (try_end),
      
      
      (str_store_party_name, s9, ":feast_venue"),
      (setup_quest_text, "qst_organize_feast"),
      (str_store_string, s2, "str_you_intend_to_bring_goods_to_s9_in_preparation_for_the_feast_which_will_be_held_as_soon_as_conditions_permit"),
      
      (quest_set_slot, "qst_organize_feast", slot_quest_target_center, ":feast_venue"),
      (quest_set_slot, "qst_organize_feast", slot_quest_expiration_days, 30),
      (call_script, "script_start_quest", "qst_organize_feast", "$g_talk_troop"),
  ]],
  
  [anyone, "spouse_feast_confirm_yes",
    [
    ],
    "Very well, then. Let the feast begin immediately at our court {reg4?here:} in {s9}. You perhaps should continue to stock our larder, so that we may do justice to our reputation for hospitality. You may declare the feast to be concluded at any time, either by beginning a campaign or by letting it be known that the vassals can return to their homes.",   "spouse_pretalk",[
      
      (str_store_party_name, s9, "$g_player_court"),
      (setup_quest_text, "qst_organize_feast"),
      (str_store_string, s2, "str_you_intend_to_bring_goods_to_s9_in_preparation_for_the_feast_which_will_be_held_as_soon_as_conditions_permit"),
      
      (quest_set_slot, "qst_organize_feast", slot_quest_target_center, "$g_player_court"),
      (quest_set_slot, "qst_organize_feast", slot_quest_expiration_days, 30),
      (call_script, "script_start_quest", "qst_organize_feast", "$g_talk_troop"),
      
      (faction_set_slot, "$players_kingdom", slot_faction_ai_state, sfai_feast),
      (faction_set_slot, "$players_kingdom", slot_faction_ai_object, "$g_player_court"),
      
      (assign, "$player_marshal_ai_state", sfai_feast),
      (assign, "$player_marshal_ai_object", "$g_player_court"),
      
      (assign, "$g_recalculate_ais", 1),
      (assign, reg4, 1),
      (try_begin),
        (neq, "$g_encountered_party", "$g_player_court"),
        (assign, reg4, 0),
      (try_end),
  ]],
  
  [anyone,"start",	#too early
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (check_quest_active, "qst_wed_betrothed"),
      (quest_slot_eq, "qst_wed_betrothed", slot_quest_target_troop, "$g_talk_troop"),
      (quest_slot_ge, "qst_wed_betrothed", slot_quest_expiration_days, 2),
    ],
    "How wonderful it is... In a short while we shall be married! However, I should point out that, in the remaining few days, it is not customary for us to speak too much together.", "close_window",[
      (try_begin),
        (check_quest_active, "qst_visit_lady"),
        (quest_slot_eq, "qst_visit_lady", slot_quest_giver_troop, "$g_talk_troop"),
        (call_script, "script_end_quest", "qst_visit_lady"),
      (try_end),
  ]],
  
  [anyone,"start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (check_quest_active, "qst_wed_betrothed"),
      (quest_slot_eq, "qst_wed_betrothed", slot_quest_target_troop, "$g_talk_troop"),
      (call_script, "script_get_kingdom_lady_social_determinants", "$g_talk_troop"),
      (assign, ":guardian", reg0),
      #	(call_script, "script_get_heroes_attached_to_center", "$g_encountered_party", "p_temp_party"),
      (troop_get_slot, ":guardian_led_party", ":guardian", slot_troop_leaded_party),
      (party_is_active, ":guardian_led_party"),
      (party_get_attached_to, ":guardian_led_party_attached", ":guardian_led_party"),
      (eq, ":guardian_led_party_attached", "$g_encountered_party"),
      
      (call_script, "script_troop_get_family_relation_to_troop", ":guardian", "$g_talk_troop"),
      (str_store_troop_name, s4, ":guardian"),
      #use current location, or party is in?
    ],
    "Em, {playername}, you might not be used to our wedding customs, but I had hoped that someone would tell you... Speak first to my {s11}, {s4}.", "close_window",[
  ]],
  
  [anyone,"start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (check_quest_active, "qst_wed_betrothed"),
      (quest_slot_eq, "qst_wed_betrothed", slot_quest_target_troop, "$g_talk_troop"),
      (quest_get_slot, ":giver_troop", "qst_wed_betrothed", slot_quest_giver_troop),
      (call_script, "script_troop_get_family_relation_to_troop", ":giver_troop", "$g_talk_troop"),
      (str_store_troop_name, s10, ":giver_troop"),
    ],
    "I do not know where to find my {s11} {s10}, who by tradition should preside over our wedding. Perhaps we should wait until he can be found...", "close_window",[
      (assign, "$g_leave_encounter", 1),
  ]],
  
  
  
  #Captive
  [anyone,"start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (neq, "$g_talk_troop_faction", "$g_encountered_party_faction"),
      (party_get_slot, ":town_lord", "$g_encountered_party"),
      (ge, ":town_lord", active_npcs_begin),
      (str_store_troop_name, s12, ":town_lord"),
    ],
    "The honorable {s12} has agreed to allow us to return home to our families. We shall be departing shortly.", "close_window",[
  ]],
  
  [anyone,"start", #default for time since last talk
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (neg|troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop"),
      (neq, "$g_talk_troop_faction", "$g_encountered_party_faction"),
      (troop_slot_eq, "$g_talk_troop", slot_troop_prisoner_of_party, "$g_encountered_party"),
      (gt, "$g_time_since_last_talk", 24),
    ],
    "So great is my loneliness! How I miss my family!", "kingdom_lady_captive",[
  ]],
  
  
  
  [anyone,"start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (neg|troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop"),
      (neq, "$g_talk_troop_faction", "$g_encountered_party_faction"),
      (troop_slot_eq, "$g_talk_troop", slot_troop_prisoner_of_party, "$g_encountered_party"),
      (lt, "$g_talk_troop_relation", 1),
    ],
    "You are a cad, {sir/madame}, to hold a lady like this...", "kingdom_lady_captive",[
  ]],
  
  [anyone,"start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (neg|troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop"),
      (neq, "$g_talk_troop_faction", "$g_encountered_party_faction"),
      (troop_slot_eq, "$g_talk_troop", slot_troop_prisoner_of_party, "$g_encountered_party"),
      (lt, "$g_talk_troop_relation", 11),
    ],
    "It is strange. On occasion you have shown me such kindness, and yet you continue to hold me here against my will.", "kingdom_lady_captive",[
  ]],
  
  [anyone,"start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (neg|troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop"),
      (neq, "$g_talk_troop_faction", "$g_encountered_party_faction"),
      (troop_slot_eq, "$g_talk_troop", slot_troop_prisoner_of_party, "$g_encountered_party"),
    ],
    "Why haven't my family paid my ransom? You may hold me as prisoner, but it seems that you care for me more than they do!", "kingdom_lady_captive",[
  ]],
  
  
  [anyone|auto_proceed, "start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (neg|troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop"),
      (neq, "$g_talk_troop_faction", "$g_encountered_party_faction"),
      (troop_slot_eq, "$g_talk_troop", slot_troop_cur_center, "$g_encountered_party"),
      
      (call_script, "script_get_kingdom_lady_social_determinants", "$g_talk_troop"),
      (assign, ":guardian", reg0),
      (neq, "$g_encountered_party_faction", "fac_player_supporters_faction"),
      
      (store_faction_of_troop, ":guardian_faction", ":guardian"),
      (neq, ":guardian_faction", "$g_encountered_party_faction"),
    ],
    "{!}.", "lady_stranded_next",
    []],
  
  [anyone,"lady_stranded_next",
    [],
    "Greetings, {sir/my lady}. The tides of war have left me stranded here in this fortress, but I will shortly be departing. ", "close_window",[
  ]],
  
  
  
  [anyone,"start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (neg|troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop"),
      (neq, "$g_talk_troop_faction", "$g_encountered_party_faction"),
      (troop_slot_eq, "$g_talk_troop", slot_troop_cur_center, "$g_encountered_party"),
      
      (call_script, "script_get_kingdom_lady_social_determinants", "$g_talk_troop"),
      (assign, ":guardian", reg0),
      (store_faction_of_troop, ":guardian_faction", ":guardian"),
      (neq, ":guardian_faction", "$g_encountered_party_faction"),
      
    ],
    "{playername} -- I assume that you, as a {man/lady} of honor, will accord gentle-born ladies such as ourselves the right to return to our families, and not demand a ransom.", "lady_talk_refugee",[
  ]],
  
  [anyone,"start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (neg|troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop"),
      (neq, "$g_talk_troop_faction", "$g_encountered_party_faction"),
      (troop_get_slot, ":new_location", "$g_talk_troop", slot_troop_cur_center),
      (str_clear, s5),
      (try_begin),
        (is_between, ":new_location", centers_begin, centers_end),
        (str_store_party_name, s4, ":new_location"),
        (str_store_string, s5, "str_for_s4"),
      (try_end),
    ],
    "We will shortly depart{s5}. It is good to know that some people in this world retain a sense of honor.", "close_window",[
  ]],
  
  
  [anyone|plyr,"lady_talk_refugee",
    [],
    "Of course, my lady", "close_window",[
      (troop_get_slot, ":current_location", "$g_talk_troop", slot_troop_cur_center),
      (call_script, "script_get_kingdom_lady_social_determinants", "$g_talk_troop"),
      (assign, ":new_location", reg1),
      (troop_set_slot, "$g_talk_troop", slot_troop_cur_center, ":new_location"),
      (try_begin),
        (neq, ":current_location", ":new_location"),
        (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", 1),
      (try_end),
  ]],
  
  [anyone|plyr,"lady_talk_refugee",
    [],
    "You assume wrong, my lady!", "lady_captive_talk",[
  ]],
  
  [anyone,"lady_captive_talk",
    [],
    "What?! What infamy is this?", "lady_captive_confirm",[
  ]],
  
  [anyone|plyr,"lady_captive_confirm",
    [],
    "My apologies - you must have misunderstood me. Of course you may leave.", "close_window",[
  ]],
  
  [anyone|plyr,"lady_captive_confirm",
    [],
    "Contact your family to arrange for a ransom, my lady.", "close_window",[
      (troop_set_slot, "$g_talk_troop", slot_troop_prisoner_of_party, "$g_encountered_party"),
      (call_script, "script_change_player_honor", -2),
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", -10),
      
      #incomplete -- make sure ransoms are offered for ladies
  ]],
  
  
  [anyone|plyr,"kingdom_lady_captive",
    [],
    "Then write to your family, and ask them to hurry up with the ransom!", "close_window",[
  ]],#incomplete
  
  
  
  #  [anyone|plyr,"kingdom_lady_captive",
  #   [
  #    (troop_get_slot, ":is_female", "trp_player"),
  #	(eq, ":is_female", 0),
  
  #   (troop_slot_eq, "$g_talk_troop", slot_troop_spouse, -1),
  #   (troop_slot_eq, "trp_player", slot_troop_spouse, -1),
  #   ],
  #   "Then marry me forthwith, and stay here as my wife", "close_window",[
  # ]],#incomplete
  
  
  [anyone|plyr,"kingdom_lady_captive",
    [],
    "I have changed my mind -- you are free to go", "close_window",[
      (troop_set_slot, "$g_talk_troop", slot_troop_prisoner_of_party, -1),
      (troop_set_slot, "$g_talk_troop", slot_troop_met, 1),
  ]],#incomplete
  
  
  
  
  #1429 lady
  #Kingdom ladies quest resolution
  
  [anyone,"start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (check_quest_active, "qst_duel_courtship_rival"),
      (check_quest_failed, "qst_duel_courtship_rival"),
      (quest_slot_eq, "qst_duel_courtship_rival", slot_quest_giver_troop, "$g_talk_troop"),
      (quest_get_slot, ":quest_target_troop", "qst_duel_courtship_rival", slot_quest_target_troop),
      (str_store_troop_name, s10, ":quest_target_troop"),
      (lt, "$g_talk_troop_relation", 0),
    ],
    "Well, {playername} -- you fought a duel with {s10}, and lost. According to our custom and tradition, I should no longer receive you. Farewell, {playername}.", "close_window",[
      (call_script, "script_end_quest", "qst_duel_courtship_rival"),
      (troop_set_slot, "$g_talk_troop", slot_troop_met, 4),
  ]],#incomplete
  
  
  [anyone,"start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (check_quest_active, "qst_duel_courtship_rival"),
      (check_quest_failed, "qst_duel_courtship_rival"),
      (quest_slot_eq, "qst_duel_courtship_rival", slot_quest_giver_troop, "$g_talk_troop"),
      (quest_get_slot, ":quest_target_troop", "qst_duel_courtship_rival", slot_quest_target_troop),
      (str_store_troop_name, s10, ":quest_target_troop"),
    ],
    "Oh {playername} -- I heard of your duel with {s10}. I wish now that you had never fought him, for our honor and tradition demand that, having lost to him, you now break off your suit with me. Farewell, {playername}.", "lady_duel_lost",[
      (troop_set_slot, "$g_talk_troop", slot_troop_met, 4),
      (call_script, "script_end_quest", "qst_duel_courtship_rival"),
  ]],
  
  [anyone|plyr,"lady_duel_lost",
    [], "Very well - we must do as tradition demands... Farewell, my lady", "close_window", [
  ]],
  
  [anyone|plyr,"lady_duel_lost",
    [], "Let honor and tradition hang!", "lady_duel_lost_flaunt_conventions", [
  ]],
  
  [anyone, "lady_duel_lost_flaunt_conventions",
    [], "Oh, {playername}! Although people will talk, it would so break my heart to no longer be able to see you. We shall ignore this silly, cruel tradition.", "close_window", [
      (troop_set_slot, "$g_talk_troop", slot_troop_met, 2),
      (call_script, "script_change_player_honor", -5),
  ]],
  
  [anyone, "lady_duel_lost_flaunt_conventions",
    [], "No, {playername} -- I cannot afford to fritter away my good name, and neither can you.", "close_window", [
  ]],
  
  
  [anyone,"start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (check_quest_active, "qst_duel_courtship_rival"),
      (check_quest_succeeded, "qst_duel_courtship_rival"),
      (quest_slot_eq, "qst_duel_courtship_rival", slot_quest_giver_troop, "$g_talk_troop"),
      (quest_get_slot, ":quest_target_troop", "qst_duel_courtship_rival", slot_quest_target_troop),
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", ":quest_target_troop"),
      (lt, reg0, 0),
      (str_store_troop_name_link, s10, ":quest_target_troop"),
    ],
    "Oh, {playername} -- I have heard that you won your duel with {s10}. I'm grateful that you have delivered me from that man's attentions!", "lady_start",[
      (call_script, "script_end_quest", "qst_duel_courtship_rival"),
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", 3),
      (add_xp_as_reward, 1000),
      
  ]],#incomplete
  
  
  [anyone,"start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (check_quest_active, "qst_duel_courtship_rival"),
      (check_quest_succeeded, "qst_duel_courtship_rival"),
      (quest_slot_eq, "qst_duel_courtship_rival", slot_quest_giver_troop, "$g_talk_troop"),
      (quest_get_slot, ":quest_target_troop", "qst_duel_courtship_rival", slot_quest_target_troop),
      (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_ambitious),
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", ":quest_target_troop"),
      (str_store_troop_name_link, s10, ":quest_target_troop"),
      
    ],
    "Well, {playername} --  you won your duel with {s10}. Clearly, he was not worthy of my affections.", "lady_start",[
      (call_script, "script_end_quest", "qst_duel_courtship_rival"),
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", 2),
      (add_xp_as_reward, 1000),
  ]],
  
  [anyone|auto_proceed,"start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (check_quest_active, "qst_duel_courtship_rival"),
      (check_quest_succeeded, "qst_duel_courtship_rival"),
      (quest_slot_eq, "qst_duel_courtship_rival", slot_quest_giver_troop, "$g_talk_troop"),
      (quest_get_slot, ":quest_target_troop", "qst_duel_courtship_rival", slot_quest_target_troop),
      (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_conventional),
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", ":quest_target_troop"),
      (str_store_troop_name_link, s10, ":quest_target_troop"),
    ],
    "{!}.", "lady_duel_rep_1",[]],
  
  [anyone,"lady_duel_rep_1",
    [],
    "Well, {playername} --  you won your duel with {s10}. Oh, such foolishness, that men should fight over me! Sigh... But it is a bit romantic, I suppose.", "lady_start",[
      (call_script, "script_end_quest", "qst_duel_courtship_rival"),
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", 1),
      (add_xp_as_reward, 1000),
  ]],
  
  
  
  
  
  [anyone|auto_proceed,"start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (check_quest_active, "qst_duel_courtship_rival"),
      (check_quest_succeeded, "qst_duel_courtship_rival"),
      (quest_slot_eq, "qst_duel_courtship_rival", slot_quest_giver_troop, "$g_talk_troop"),
      (quest_get_slot, ":quest_target_troop", "qst_duel_courtship_rival", slot_quest_target_troop),
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", ":quest_target_troop"),
      (str_store_troop_name_link, s10, ":quest_target_troop"),
    ],
    "{!}.", "lady_duel_rep_2",[]],
  
  [anyone,"lady_duel_rep_2",
    [],
    "Well, {playername} --  you won your duel with {s10}. Honor now demands that he and I no longer meet... I was fond of him, you know. You did me no service by fighting him, sir.", "lady_start",[
      (call_script, "script_end_quest", "qst_duel_courtship_rival"),
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", -2),
      (add_xp_as_reward, 1000),
  ]],
  
  
  
  [anyone,"start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (check_quest_active, "qst_duel_for_lady"),
      (check_quest_succeeded, "qst_duel_for_lady"),
      (quest_slot_eq, "qst_duel_for_lady", slot_quest_giver_troop, "$g_talk_troop"),
      (le, "$talk_context", tc_siege_commander),
      (quest_get_slot, ":quest_target_troop", "qst_duel_for_lady", slot_quest_target_troop),
      (str_store_troop_name_link, s13, ":quest_target_troop"),
    ],
    "My dear {playername}, how joyous to see you again! I heard you gave that vile {s13} a well-deserved lesson. " +
    "I hope he never forgets his humiliation. " +
    "I've a reward for you, but I fear it's little compared to what you've done for me.", "lady_qst_duel_for_lady_succeeded_1",[]],
  
  [anyone|plyr,"lady_qst_duel_for_lady_succeeded_1", [], "Oh, it will just have to do.", "lady_qst_duel_for_lady_succeeded_2",[
      (str_store_string,s10,"@Then take it, with my eternal thanks. You are a noble {man/woman}. " +
      "I will never forget that you helped me in my time of need.")
  ]],
  
  [anyone|plyr,"lady_qst_duel_for_lady_succeeded_1", [], "{s66}, this is far too much!", "lady_qst_duel_for_lady_succeeded_2",[
      (str_store_string,s10,"@Forgive me, {playername}, but I must insist you accept it. " +
        "The money means little to me, and I owe you so much. " +
      "Here, take it, and let us speak no more of this."),
      (call_script, "script_change_player_honor", 1),
  ]],
  
  [anyone|plyr,"lady_qst_duel_for_lady_succeeded_1", [], "Please, {s65}, no reward is necessary.", "lady_qst_duel_for_lady_succeeded_2",[
      (str_store_string,s10,"@{playername}, what a dear {man/woman} you are, " +
        "but I will not allow you to refuse this. I owe you far more than I can say, " +
      "and I am sure you can put this money to far better use than I."),
      (call_script, "script_change_player_honor", 2),
  ]],
  [anyone,"lady_qst_duel_for_lady_succeeded_2", [], "{s10}", "lady_pretalk",
    [(call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 10),
      (add_xp_as_reward, 1000),
      (call_script, "script_troop_add_gold", "trp_player", 2000),
      (call_script, "script_end_quest", "qst_duel_for_lady"),
  ]],
  
  [anyone,"start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (check_quest_active, "qst_duel_for_lady"),
      (check_quest_failed, "qst_duel_for_lady"),
      (quest_slot_eq, "qst_duel_for_lady", slot_quest_giver_troop, "$g_talk_troop"),
      (le, "$talk_context", tc_siege_commander),
      (quest_get_slot, ":quest_target_troop", "qst_duel_for_lady", slot_quest_target_troop),
      (str_store_troop_name_link, s13, ":quest_target_troop"),
    ],
    "I was told that you sought satisfaction from {s13} to prove my innocence, {playername}. " +
    "It was a fine gesture, and I thank you for your efforts.", "lady_qst_duel_for_lady_failed", []],
  [anyone|plyr,"lady_qst_duel_for_lady_failed", [], "I beg your forgiveness for my defeat, {s65}...", "lady_qst_duel_for_lady_failed_2",[]],
  [anyone,"lady_qst_duel_for_lady_failed_2", [], "It matters not, dear {playername}. You tried. " +
    "The truth cannot be proven at the point of a sword, but you willingly put your life at stake for my honour. " +
    "That alone will convince many of my innocence.", "lady_pretalk",
    [(call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 6),
      (add_xp_as_reward, 400),
      (call_script, "script_end_quest", "qst_duel_for_lady"),
  ]],
  
  
  [anyone,"start", [(troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (check_quest_active, "qst_escort_lady"),
      (eq, "$talk_context", tc_entering_center_quest_talk),
      (quest_slot_eq, "qst_escort_lady", slot_quest_object_troop, "$g_talk_troop")],
    "Thank you for escorting me here, {playername}. Please accept this gift as a token of my gratitude. " +
    "I hope we shall meet again sometime in the future.", "lady_escort_lady_succeeded",
    [
      (quest_get_slot, ":cur_center", "qst_escort_lady", slot_quest_target_center),
      (add_xp_as_reward, 300),
      (call_script, "script_troop_add_gold", "trp_player", 250),
      (call_script, "script_end_quest", "qst_escort_lady"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 2),
      (troop_set_slot, "$g_talk_troop", slot_troop_cur_center, ":cur_center"),
      (remove_member_from_party,"$g_talk_troop"),
  ]],
  
  [anyone|plyr,"lady_escort_lady_succeeded", [], "It was an honor to serve you, {s65}.", "close_window",[]],
  
  [anyone,"start", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (troop_set_slot, "$g_talk_troop", slot_lady_no_messages, 0), #do this for all
      (check_quest_active, "qst_visit_lady"),
      (quest_slot_eq, "qst_visit_lady", slot_quest_giver_troop, "$g_talk_troop"),
      ], "Ah {playername} - you must have received my message. How happy I am that you could come!", "lady_start",[
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      (call_script, "script_end_quest", "qst_visit_lady"),
      #	(assign, "$g_time_to_spare", 1),
  ]],
  
  
  [anyone,"start", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (check_quest_active, "qst_formal_marriage_proposal"),
      (quest_slot_eq, "qst_formal_marriage_proposal", slot_quest_giver_troop, "$g_talk_troop"),
      (neg|check_quest_succeeded, "qst_formal_marriage_proposal"),
      (neg|check_quest_failed, "qst_formal_marriage_proposal"),
      ], "{playername} - is there any word from my family?", "lady_proposal_pending",[
  ]],
  
  [anyone,"start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (check_quest_active, "qst_formal_marriage_proposal"),
      (quest_slot_eq, "qst_formal_marriage_proposal", slot_quest_giver_troop, "$g_talk_troop"),
      (check_quest_failed, "qst_formal_marriage_proposal"),
      (call_script, "script_get_kingdom_lady_social_determinants", "$g_talk_troop"),
      (assign, ":guardian", reg0),
      (call_script, "script_troop_get_family_relation_to_troop", ":guardian", "$g_talk_troop"),
    ],
    "I hear that my {s11} has refused your request to marry me. Does that mean that we must part?", "lady_betrothed",[
      (call_script, "script_end_quest", "qst_formal_marriage_proposal"),
  ]],
  
  #Marriage success
  
  
  [anyone,"start", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (le, "$talk_context", tc_siege_commander),
      (check_quest_active, "qst_rescue_lord_by_replace"),
      (check_quest_succeeded, "qst_rescue_lord_by_replace"),
      (quest_slot_eq, "qst_rescue_lord_by_replace", slot_quest_giver_troop, "$g_talk_troop"),
      (quest_get_slot, ":cur_lord", "qst_rescue_lord_by_replace", slot_quest_target_troop),
      (call_script, "script_troop_get_family_relation_to_troop", ":cur_lord", "$g_talk_troop"),
    ],
    "Oh, {playername}, you brought him back to me! Thank you ever so much for rescuing my {s11}. " +
    "Please, take this as some small repayment for your noble deed.", "lady_generic_mission_succeeded",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 8),
      (add_xp_as_reward, 2000),
      (call_script, "script_troop_add_gold", "trp_player", 1500),
      (call_script, "script_end_quest", "qst_rescue_lord_by_replace"),
  ]],
  
  
  [anyone,"start", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (check_quest_active, "qst_rescue_prisoner"),
      (check_quest_succeeded, "qst_rescue_prisoner"),
      (quest_slot_eq, "qst_rescue_prisoner", slot_quest_giver_troop, "$g_talk_troop"),
      (quest_get_slot, ":cur_lord", "qst_rescue_prisoner", slot_quest_target_troop),
      (call_script, "script_troop_get_family_relation_to_troop", ":cur_lord", "$g_talk_troop"),
    ],
    "Oh, {playername}, you brought him back to me! Thank you ever so much for rescuing my {s11}. " +
    "Please, take this as some small repayment for your noble deed.", "rescue_prisoner_succeed_1",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 8),
      (add_xp_as_reward, 2000),
      (call_script, "script_troop_add_gold", "trp_player", 1500),
      (call_script, "script_end_quest", "qst_rescue_prisoner"),
  ]],#rescuerescue
  [anyone|plyr,"rescue_prisoner_succeed_1", [], "Always an honour to serve, {s65}.", "lady_pretalk",[]],
  
  
  
  #first time greetings
  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_lady),
      (eq, "$g_talk_troop_met", 0),
      #  (gt, "$g_player_tournament_placement", 4),
      (eq, "$dedier_victoire_dame", 1),
      (str_clear, s8),
      
    ],
    "You must be {playername}. We have just had the honor of watching you distinguish yourself in the recent tournament{s8}.",
    "lady_meet_end", []],
  
  
  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_lady),
      (eq, "$g_talk_troop_met", 0),
      (le,"$talk_context",tc_siege_commander),
      
      (assign, ":known_by_relative", 0),
      (str_clear, s15),
      (try_for_range, ":lord", lords_begin, lords_end),
        (call_script, "script_troop_get_family_relation_to_troop", ":lord", "$g_talk_troop"),
        (gt, reg0, 5),
        
        (call_script, "script_troop_get_relation_with_troop", "trp_player", ":lord"),
        (gt, reg0, 10),
        
        (str_store_string, s15, s11),
        (str_store_troop_name, s16, ":lord"),
        (assign, ":known_by_relative", ":lord"),
      (try_end),
      
      
      (gt, ":known_by_relative", 0),
      
    ],
    "You must be {playername}. My {s15} {s16} has spoken most highly of you. I am delighted to make your acquaintance.",
    "lady_meet_end", []],
  
  
  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_lady),
      (eq, "$g_talk_troop_met", 0),
      (le,"$talk_context",tc_siege_commander),
    ],
    "I say, you don't look familiar...", "lady_premeet", []],
  
  #default greet
  [anyone,"start",
    [(troop_slot_eq, "$g_talk_troop", slot_troop_met, 4),
      (lt, "$g_talk_troop_relation", 0),
    ],
    "Ah, {playername}. How good it is to see you again. However, I believe that I am required elsewhere.", "close_window",[]],
  
  [anyone,"start",
    [(troop_slot_eq, "$g_talk_troop", slot_troop_met, 4),
    ],
    "{playername} -- how good it is to see you. (Whispers:) I still remember your visits fondly.", "lady_start",[]],
  
  [anyone ,"start", [(troop_slot_eq,"$g_talk_troop",slot_troop_occupation, slto_kingdom_lady),
      (eq, "$g_talk_troop_met", 0),
      # (gt, "$g_player_tournament_placement", 4),
      (eq, "$dedier_victoire_dame", 1),
      (ge, "$g_talk_troop_relation", 0),
    ],
    "Ah, {playername}. How spendid it was to see you distinguish yourself in the recent tournament.",
    "lady_meet_end", []],
  
  
  [anyone,"start", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (str_store_string, s12, "str_hello_playername"),
      #					(assign, "$g_time_to_spare", 1),
    ],
    "{s12}", "lady_start",[]],
  
  
  #lady_start - contains news, quest assignments
  [anyone,"lady_start", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (troop_slot_ge, "$g_talk_troop", slot_troop_met, 2),
      (neg|troop_slot_eq, "$g_talk_troop", slot_troop_met, 4),
      (troop_get_slot, ":betrothed", "$g_talk_troop", slot_troop_betrothed),
      (gt, ":betrothed", -1),
      (neq, ":betrothed", "trp_player"),
      (str_store_troop_name, s5, ":betrothed"),
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", ":betrothed"),
      (lt, reg0, 0),
      (ge, "$g_talk_troop_relation", 10),
    ],
    "I have sad news. I have become betrothed to {s5} -- against my will, I should say! Oh {playername} - I would so much rather be wed to you!", "lady_betrothed",[]],
  
  [anyone,"lady_start", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (troop_slot_ge, "$g_talk_troop", slot_troop_met, 2),
      (troop_get_slot, ":betrothed", "$g_talk_troop", slot_troop_betrothed),
      (gt, ":betrothed", -1),
      (neq, ":betrothed", "trp_player"),
      (str_store_troop_name, s5, ":betrothed"),
    ],
    "Good {playername} -- I have become betrothed to {s5}. It is now no longer seemly for us to see each other like this.", "lady_betrothed",[
      #	(try_begin),
      #		(check_quest_active, "qst_visit_lady"),
      #		(quest_slot_eq, "qst_visit_lady", slot_quest_giver_troop, "$g_talk_troop"),
      #		(call_script, "script_end_quest", "qst_visit_lady"),
      #	(try_end),
  ]],
  
  [anyone,"lady_start",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (troop_slot_eq, "$g_talk_troop", slot_troop_met, 2),
      (neg|troop_slot_eq, "$g_talk_troop", slot_troop_met, 4),
      (neg|troop_slot_ge, "trp_player", slot_troop_spouse, active_npcs_begin),
      (neg|troop_slot_ge, "$g_talk_troop", slot_troop_spouse, active_npcs_begin),
      
      (gt, "$g_talk_troop_relation", 0),
      (assign, "$romantic_rival", -1),
      
      (try_for_range, ":rival_lord", lords_begin, lords_end),
        (this_or_next|troop_slot_eq, ":rival_lord", slot_troop_love_interest_1, "$g_talk_troop"),
        (this_or_next|troop_slot_eq, ":rival_lord", slot_troop_love_interest_2, "$g_talk_troop"),
        (troop_slot_eq, ":rival_lord", slot_troop_love_interest_2, "$g_talk_troop"),
        (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", ":rival_lord"),
        (le, reg0, -4),
        
        (this_or_next|troop_slot_eq, ":rival_lord", slot_lord_reputation_type, lrep_debauched),
        (this_or_next|troop_slot_eq, ":rival_lord", slot_lord_reputation_type, lrep_quarrelsome),
        (this_or_next|troop_slot_eq, ":rival_lord", slot_lord_reputation_type, lrep_roguish),
        (troop_slot_eq, ":rival_lord", slot_lord_reputation_type, lrep_selfrighteous),
        
        (assign, "$romantic_rival", ":rival_lord"),
      (try_end),
      
      (gt, "$romantic_rival", 0),
    ],
    "I must tell you -- there is another lord who has been paying me attentions, although I cannot abide him. I fear he has designs on me, and may try to force me to wed against my will.", "lady_other_suitor",[]],
  
  #romantic news/quest assignments end
  [anyone,"lady_start", [ #friendly reminder that time is short
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (lt, "$g_time_since_last_talk", 24),
      (troop_slot_eq, "$g_talk_troop", slot_troop_met, 2),
      (gt, "$g_talk_troop_relation", 0),
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_adventurous),
        (str_store_string, s11, "str_i_do_enjoy_speaking_to_you_but_i_am_sure_you_understand_that_our_people_cluck_their_tongues_at_a_woman_to_spend_too_long_conversing_with_a_man_outside_her_family__although_the_heavens_know_its_never_the_man_who_is_held_to_blame_"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_ambitious),
        (str_store_string, s11, "str_as_much_as_i_enjoy_speaking_to_you_i_do_not_care_to_be_gossiped_about_by_others_who_might_lack_my_grace_and_beauty_"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_moralist),
        (str_store_string, s11, "str_i_do_so_enjoy_speaking_to_you_but_as_a_daughter_of_one_of_the_great_families_of_this_land_i_must_set_an_example_of_propriety_"),
      (else_try),
        (str_store_string, s11, "str_i_do_so_enjoy_speaking_to_you_but_as_a_daughter_of_good_family_i_must_protect_my_reputation_"),
      (try_end),
    ],
    "{s11}It is probably not suitable for us to tarry too long here in conversation, but I would hope to see you again soon.", "lady_talk",[]],
  
  [anyone,"lady_start", [ #unfriendly reminder that time is short
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (lt, "$g_time_since_last_talk", 24),
      (troop_slot_eq, "$g_talk_troop", slot_troop_met, 2),
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_adventurous),
        (str_store_string, s11, "str_although_it_is_kind_of_you_to_pay_me_such_attentions_i_suspect_that_you_might_find_other_ladies_who_may_be_more_inclined_to_return_your_affection"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_ambitious),
        (str_store_string, s11, "str_as_flattered_as_i_am_by_your_attentions_perhaps_you_should_seek_out_another_lady_of_somewhat_shall_we_say_different_tastes"),
      (else_try),
        (str_store_string, s11, "str_as_flattered_as_i_am_by_your_attentions_i_am_a_daughter_of_good_family_and_must_be_aware_of_my_reputation_it_is_not_seemly_that_i_converse_too_much_at_one_time_with_one_man_i_am_sure_you_understand_now_if_you_will_excuse_me"),
      (try_end),
      
    ],
    "{s11}", "lady_talk",[]],
  
  [anyone, "lady_start", [
      (eq, "$lady_flirtation_location", "$g_encountered_party"),
      (troop_slot_eq, "$g_talk_troop", slot_troop_met, 1),
      ],  "I was planning to retire for a little while, but perhaps we may have a chance to speak more later...", "lady_talk", []],
  
  
  #Defeault lady_start - no news, assignments
  [anyone,"lady_start", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      (troop_slot_eq, "$g_talk_troop", slot_troop_met, 2),
      (gt, "$g_talk_troop_relation", 0),
      (str_clear, s12),
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", slot_troop_met, 2),
        (gt, "$g_talk_troop_relation", 0),
        (gt, "$g_time_since_last_talk", 24),
        (try_begin),
          (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_otherworldly),
          (str_store_string, s12, "str_ah_my_gentle_playername_how_much_good_it_does_my_heart_to_see_you_again"),
        (else_try),
          (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_adventurous),
          (str_store_string, s12, "str_playername__i_am_so_glad_to_see_you_again_i_must_say_i_do_envy_your_freedom_to_ride_out_and_experience_the_world"),
        (else_try),
          (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_moralist),
          (str_store_string, s12, "str_playername__i_am_so_glad_to_see_you_i_trust_that_you_have_been_behaving_honorably_since_last_we_met"),
        (else_try),
          (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_ambitious),
          (str_store_string, s12, "str_greetings_playername__it_is_good_to_see_you_i_hope_that_you_have_had_success_in_your_efforts_to_make_your_name_in_the_world"),
        (else_try),
          (str_store_string, s12, "str_playername__i_am_so_glad_that_you_were_able_to_come"),
        (try_end),
      (try_end),
      
      
      ],"It is so delightful to have a chance to spend some time together.{s12}","lady_talk", []],
  
  
  [anyone,"lady_start", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_lady),
      ],"What brings you here today?","lady_talk", []],
  
  
  
  
  #Betrothed
  [anyone|plyr, "lady_proposal_pending", [],
    "No word so far...", "close_window",[]],
  
  [anyone|plyr, "lady_proposal_pending", [],
    "On second thought, now is not the time for us to marry", "lady_proposal_pending_end",[]],
  
  [anyone,"lady_proposal_pending_end", [
      (try_begin),
        (gt, "$g_talk_troop_effective_relation", 19),
        (str_store_string, s11, "str_very_well__i_will_let_you_choose_the_time"),
      (else_try),
        (str_store_string, s11, "str_good_i_am_glad_that_you_have_abandoned_the_notion_of_pushing_me_into_marriage_before_i_was_ready"),
      (try_end),
    ],
    "{s11}", "close_window",[
      (call_script, "script_end_quest", "qst_formal_marriage_proposal"),
  ]],
  
  
  
  [anyone|plyr,"lady_betrothed", [],
    "Never! We must elope together at once!", "lady_suggest_elope",[]],
  
  [anyone|plyr,"lady_betrothed", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_betrothed, -1),
      (call_script, "script_get_kingdom_lady_social_determinants", "$g_talk_troop"),
      (call_script, "script_troop_get_family_relation_to_troop", reg0, "$g_talk_troop"),
    ],
    "Perhaps I may still be able to change your {s11}'s mind", "lady_pretalk",[]],
  
  [anyone|plyr,"lady_betrothed", [],
    "So be it -- let us then part", "lady_conclude_relationship",[
  ]],
  
  
  [anyone,"lady_suggest_elope", [(troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_conventional)],
    "Good {playername} -- you are a good and kind man, but a lady cannot defy her family. Such things are not done!", "lady_conclude_relationship",[]],
  
  
  [anyone,"lady_suggest_elope",
    [
      (assign, "$romantic_rival", -1),
      (try_for_range, ":possible_rival", lords_begin, lords_end),
        (this_or_next|troop_slot_eq, ":possible_rival", slot_troop_love_interest_1, "$g_talk_troop"),
        (this_or_next|troop_slot_eq, ":possible_rival", slot_troop_love_interest_2, "$g_talk_troop"),
        (troop_slot_eq, ":possible_rival", slot_troop_love_interest_2, "$g_talk_troop"),
        (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", ":possible_rival"),
        
        (try_begin),
          (eq, "$cheat_mode", 1),
          (str_store_troop_name, s4, ":possible_rival"),
          (display_message, "str_rival_found_s4_reg0_relation"),
        (try_end),
        (gt, reg0, "$g_talk_troop_relation"),
        (assign, "$romantic_rival", ":possible_rival"),
      (try_end),
      
      (gt, "$romantic_rival", -1),
    ],
    "Sir -- as you may know, I have been entertaining offers from a number of gentlemen such as yourself. I am not yet at a stage where I can commit to any of them.", "lady_other_suitor",[
  ]],
  
  
  [anyone,"lady_suggest_elope", [
      (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_ambitious),
      (neg|troop_slot_ge, "trp_player", slot_troop_renown, 350)
    ],
    "Ah {playername}, you must realize. You are still finding your way in the world. I have great affection for you, {playername}, but I will not consign myself to obscurity.", "lady_conclude_relationship",[]],
  
  [anyone,"lady_suggest_elope", [
      (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_moralist),
      (lt, "$player_honor", 20)
    ],
    "Ah {playername}, although you are kind to me, I am not certain enough of your moral fiber to risk such a thing. Although I bare little affection for my husband, it would be a weighty thing to go against my family's wishes, and I am not certain enough of you to take that step.", "lady_conclude_relationship",[]],
  
  [anyone,"lady_suggest_elope", [(le, "$g_talk_troop_effective_relation", 20),],
    "Good {playername} -- to elope would be to throw away my ties with my family, which are everything to me! I have a considerable affection for you, but I am not sure that I am prepared to risk that.", "lady_conclude_relationship",[]],
  
  [anyone,"lady_suggest_elope", [
      (assign, "$home_for_spouse", -1),
      (try_for_range, ":player_center", centers_begin, centers_end),
        (eq, "$home_for_spouse", -1),
        (party_slot_eq, ":player_center", slot_town_lord, "trp_player"),
        (is_between, ":player_center", walled_centers_begin, walled_centers_end),
        #		(this_or_next|is_between, ":player_center", walled_centers_begin, walled_centers_end),
        #			(party_slot_eq, ":player_center", slot_center_has_manor, 1),
        (assign, "$home_for_spouse", ":player_center"),
      (try_end),
      (eq, "$home_for_spouse", -1),
    ],
    "Good {playername} -- I am not used to the hardships of campaigning as you are. I want a home to call my own. If you were lord of a castle or town with a great hall, I would gladly go there as your wife, to be mistress of the household. But I do not wish to live like a hunted animal.", "lady_conclude_relationship",[]],
  
  
  [anyone,"lady_suggest_elope", [
      (call_script, "script_get_kingdom_lady_social_determinants", "$g_talk_troop"),
      (call_script, "script_troop_get_family_relation_to_troop", reg0, "$g_talk_troop"),
    ],
    "Elope with you? Yes -- we could do that. It is a great step to defy my family -- but a loveless marriage, and life without you, might be a far worse thing! But be warned -- this will be a terrible blow to my {s11}'s prestige, and he will do everything in his power to bring you down.", "lady_elope_agree",[]],
  
  [anyone|plyr,"lady_elope_agree", [],
    "Quickly, then! There is no time to lose.", "lady_elope_agree_nurse",[
  ]],
  
  [anyone|plyr,"lady_elope_agree", [],
    "Everything in his power, you say? Em... Let me think about this...", "close_window",[
  ]],
  
  [anyone, "lady_elope_agree_nurse", [],
    "Your lordship... Your ladyship... Would you like me to witness your exchange of vows?", "lady_elope_agree_lady_vows",[
      (set_conversation_speaker_troop, trp_nurse_for_lady),
  ]],
  
  [anyone, "lady_elope_agree_lady_vows", [
      (str_store_troop_name, s4, "$g_talk_troop"),
    ],
    "Yes, do that. For my part, I make the following vow: I, {s4}, do swear that I accept {playername} as my husband, according to the ancient law and custom of our land...", "lady_elope_agree_nurse_2",[
  ]],
  
  [anyone, "lady_elope_agree_nurse_2", [],
    "Very good. Do you, {playername}, swear similarly to accept {s4} as your wife?", "lady_elope_agree_player_vows",[
      (set_conversation_speaker_troop, trp_nurse_for_lady),
  ]],
  
  [anyone|plyr,"lady_elope_agree_player_vows", [],
    "I do.", "close_window",[
      (call_script, "script_courtship_event_bride_marry_groom", "$g_talk_troop", "trp_player", 1), #1 is elopement
  ]],
  
  [anyone|plyr,"lady_elope_agree_player_vows", [],
    "Eh, what? This is all moving too fast...", "close_window",[
  ]],
  
  
  
  
  #markspot - do elopement here
  
  [anyone|plyr,"lady_elope_agree", [],
    "Oh, really? My dear -- I could never separate a lady from her family like that...", "lady_conclude_relationship",[
  ]],
  
  [anyone,"lady_conclude_relationship", [],
    "So I suppose our time together must come to an end...", "lady_conclude_relationship_confirm", []],
  
  [anyone|plyr,"lady_conclude_relationship_confirm", [],
    "Yes -- it must be...", "lady_conclude_relationship_confirm_yes", []],
  
  [anyone|plyr,"lady_conclude_relationship_confirm", [],
    "Wait -- perhaps there is still a chance for us!", "lady_conclude_relationship_confirm_no", []],
  
  [anyone,"lady_conclude_relationship_confirm_yes", [],
    "Farewell, {playername}. We will see each other, in the courts and castles of this realm, but we must keep our distance from each other. I will remember these days fondly, nonetheless.", "close_window", [
      (troop_set_slot, "$g_talk_troop", slot_troop_met, 4),
  ]],
  
  [anyone,"lady_conclude_relationship_confirm_no", [],
    "In that case, we shall see what the future brings.", "close_window", [
  ]],
  
  
  
  
  
  
  [anyone|plyr,"lady_generic_mission_succeeded", [], "Always an honour to serve, {s65}.", "lady_pretalk",[]],
  
  [anyone|plyr ,"lady_premeet", [],  "I am {playername}.", "lady_meet", []],
  [anyone|plyr ,"lady_premeet", [],  "My name is {playername}. At your service.", "lady_meet", []],
  
  
  [anyone, "lady_meet", [
      (troop_slot_ge, "trp_player", slot_troop_renown, 200),
      ],  "Of course. How splendid to finally make your acquaintance.", "lady_meet_end", []],
  
  [anyone, "lady_meet", [],  "{playername}? I do not believe I've heard of you before.", "lady_meet_end", []],
  
  [anyone, "lady_meet_end", [
      (eq, "$lady_flirtation_location", "$g_encountered_party"),
      ],  "I am about to retire for a little while, but perhaps we may have a chance to speak more later...", "lady_talk", []],
  
  
  [anyone, "lady_meet_end", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_spouse, -1),
      (call_script, "script_troop_get_romantic_chemistry_with_troop", "$g_talk_troop", "trp_player"),
      (le, reg0, 0),
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", "trp_player"),
      (le, reg0, 0),
      ],  "Now, if you will excuse me...", "lady_talk", []],
  
  [anyone, "lady_meet_end", [],  "Can I help you with anything?", "lady_talk", []],
  
  
  [anyone|plyr,"lady_talk", [(neg|troop_slot_ge, "$g_talk_troop", slot_troop_prisoner_of_party, 0),
      (ge, "$g_encountered_party_relation", 0),
    ],
    "I want to know the location of someone.", "lord_talk_ask_location",[]],
  
  
  ##### TODO: QUESTS COMMENT OUT BEGIN
  ##  [anyone|plyr,"lady_talk", [(check_quest_active, "qst_deliver_message_to_lover"),
  ##                             (quest_slot_eq, "qst_deliver_message_to_lover", slot_quest_target_troop, "$g_talk_troop"),
  ##                             (quest_get_slot, ":troop_no", "qst_deliver_message_to_lover", slot_quest_giver_troop),
  ##                             (str_store_troop_name_link, 3, ":troop_no")],
  ##   "I have brought you a message from {s3}", "lady_message_from_lover_success",[(call_script, "script_finish_quest", "qst_deliver_message_to_lover", 100)]],
  ##
  ##  [anyone|plyr,"lady_talk", [(check_quest_active, "qst_rescue_lady_under_siege"),
  ##                             (quest_slot_eq, "qst_rescue_lady_under_siege", slot_quest_object_troop, "$g_talk_troop"),
  ##                             (quest_slot_eq, "qst_rescue_lady_under_siege", slot_quest_current_state, 0)],
  ##   "TODO: I'm taking you home!", "lady_rescue_from_siege_check",[]],
  ##
  ##
  ##  [anyone,"lady_rescue_from_siege_check", [(neg|hero_can_join)],
  ##   "TODO: You don't have enough room for me!", "close_window",[]],
  ##
  ##
  ##  [anyone,"lady_rescue_from_siege_check", [], "TODO: Thank you so much!", "lady_pretalk",[(quest_set_slot, "qst_rescue_lady_under_siege", slot_quest_current_state, 1),
  ##                                                                                          (troop_set_slot, "$g_talk_troop", slot_troop_cur_center, 0),
  ##                                                                                          (troop_join, "$g_talk_troop")]],
  ##  [anyone,"lady_message_from_lover_success", [], "TODO: Thank you so much!", "lady_pretalk",[]],
  ##
  
  [anyone,"lady_pretalk", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_spouse, -1),
      (call_script, "script_troop_get_romantic_chemistry_with_troop", "$g_talk_troop", "trp_player"),
      (le, reg0, 0),
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", "trp_player"),
      (le, reg0, 0),
      ], "Now, if you will excuse me...", "lady_talk",[]],
  
  
  [anyone,"lady_pretalk", [], "Is there anything else?", "lady_talk",[]],
  
  ##[anyone|plyr,"lady_talk",
  ##   [(troop_get_type, ":is_female", "trp_player"),
  ##    (eq, ":is_female", 0),],
  ##   "{!}CHEAT: I want to marry you! (1)", "wedding_ceremony_bride_vow",[]],
  ##[anyone|plyr,"lady_talk",
  ##   [(troop_get_type, ":is_female", "trp_player"),
  ##    (eq, ":is_female", 0),],
  ##   "{!}CHEAT: I want to marry you! (2)", "lady_elope_agree_nurse_2",[]],
  
  [anyone|plyr,"lady_talk",
    [],
    "May I have the honor of knowing more about you, my lady?", "lady_relations",[]],
  
  [anyone,"lady_relations",
    [
      (str_store_string, s12, "str_i_am"),
      (assign, ":relation_found", 0),
      (assign, ":in_castle_of_relative", 0),
      
      (try_for_range, ":lord", active_npcs_begin, kingdom_ladies_end), #use this as the basis for "troop_describe_relation_with_troop"
        (call_script, "script_troop_get_family_relation_to_troop", "$g_talk_troop", ":lord"), #The normal order is reversed, because the lady is describing herself
        (this_or_next|gt, reg0, 5),
        (party_slot_eq, "$g_encountered_party", slot_town_lord, ":lord"),
        (gt, reg0, 0),
        
        (str_store_troop_name, s14, ":lord"),
        (try_begin),
          (eq, ":relation_found", 1),
          (str_store_string, s12, "str_s12"),
        (try_end),
        (str_store_string, s12, "str_s12_s11_to_s14"),
        (assign, ":relation_found", 1),
        
        (try_begin),
          (party_slot_eq, "$g_encountered_party", slot_town_lord, ":lord"),
          (assign, ":in_castle_of_relative", 1),
        (try_end),
      (try_end),
      
      (try_begin),
        (eq, ":in_castle_of_relative", 1),
        (str_store_string, s12, "str_s12"),
      (else_try),
        (eq, ":in_castle_of_relative", 0),
        (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_state, sfai_feast),
        (faction_slot_eq, "$g_talk_troop_faction", slot_faction_ai_object, "$g_encountered_party"),
        (str_store_string, s12, "str_s12_i_am_here_for_the_feast"),
      (else_try),
        (str_store_string, s12, "str_s12"),
      (try_end),
      
    ],
    "{s12}", "lady_pretalk",[]],
  
  
  [anyone|plyr,"lady_talk",
    [
      (troop_get_type, ":is_female", "trp_player"),
      (eq, ":is_female", 0),
      (troop_slot_eq, "$g_talk_troop", slot_troop_met, 1),
      (troop_slot_eq, "$g_talk_troop", slot_troop_spouse, -1),
      (neg|troop_slot_ge, "trp_player", slot_troop_spouse, active_npcs_begin),
      
      (neq, "$lady_flirtation_location", "$g_encountered_party"),
    ],
    "My lady, I would like to profess myself your most ardent admirer", "lady_profess_admiration",
    [
      (call_script, "script_troop_get_romantic_chemistry_with_troop", "$g_talk_troop", "trp_player"),
      (assign, ":reaction_change", reg0),
      
      #	(try_begin),
      #		(gt, "$g_player_tournament_placement", 3),
      #		(val_sub, "$g_player_tournament_placement", 3),
      #		(val_mul, "$g_player_tournament_placement", 4), #Twice normal, but is divided by two
      #	(else_try),
      #		(assign, "$g_player_tournament_placement", 0),
      #	(try_end),
      
      #	(try_begin),
      #		(troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_conventional),
      #		(val_mul, "$g_player_tournament_placement", 2),
      #	(else_try),
      #		(troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_moralist),
      #		(val_div, "$g_player_tournament_placement", 2),
      #	(try_end),
      
      #	(val_add, ":reaction_change", "$g_player_tournament_placement"),
      #	(assign, "$g_player_tournament_placement", 0),
      
      (val_div, ":reaction_change", 2),
      (val_max, ":reaction_change", -2),
      
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", ":reaction_change"),
      (assign, "$g_time_to_spare", 0),
      
  ]],
  
  [anyone|plyr,"lady_talk",
    [
      (troop_get_type, ":is_female", "trp_player"),
      (eq, ":is_female", 0),
      #(gt, "$g_player_tournament_placement", 3),
      (eq, "$dedier_victoire_dame", 1),
      (neg|troop_slot_ge, "trp_player", slot_troop_spouse, active_npcs_begin),
    ],
    "My lady, I would like to dedicate my successes in this recent tournament to you", "lady_tournament_dedication_reaction",
    [
      
      #(try_begin),
      #	(gt, "$g_player_tournament_placement", 3),
      #	(val_sub, "$g_player_tournament_placement", 3),
      #	(val_mul, "$g_player_tournament_placement", 2),
      #(else_try),
      #	(assign, "$g_player_tournament_placement", 0),
      #(try_end),
      
      #(try_begin),
      #	(troop_slot_eq, "$g_talk_troop", slot_lady_used_tournament, 1),
      #	(val_div, "$g_player_tournament_placement", 3),
      #	(str_store_string, s9, "str_another_tournament_dedication_oh_i_suppose_it_is_always_flattering"),
      #(else_try),
      #	(troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_conventional),
      #	(val_mul, "$g_player_tournament_placement", 2),
      #	(str_store_string, s9, "str_do_you_why_what_a_most_gallant_thing_to_say"),
      #(else_try),
      #	(troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_moralist),
      #	(val_div, "$g_player_tournament_placement", 2),
      #	(str_store_string, s9, "str_hmm_i_cannot_say_that_i_altogether_approve_of_such_frivolity_but_i_must_confess_myself_a_bit_flattered"),
      #(else_try),
      (str_store_string, s9, "str_why_thank_you_you_are_most_kind_to_do_so"),
      #(try_end),
      
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", 5),
      #(assign, "$g_player_tournament_placement", 0),
      (assign, "$dedier_victoire_dame", 0),
      #(troop_set_slot, "$g_talk_troop", slot_lady_used_tournament, 1),
  ]],
  
  [anyone,"lady_tournament_dedication_reaction", [],
    "{s9}", "lady_pretalk",
    []],
  
  
  
  [anyone,"lady_profess_admiration", [
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", "trp_player"),
      (gt, reg0, 0),
      
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_moralist),
        (str_store_string, s11, "str_you_are_most_courteous_and_courtesy_is_a_fine_virtue_"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_ambitious),
        (str_store_string, s11, "str_hmm_youre_a_bold_one_but_i_like_that_"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_adventurous),
        (str_store_string, s11, "str_ah_well_they_all_say_that_but_no_matter_a_compliment_well_delivered_is_at_least_a_good_start_"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_otherworldly),
        (str_store_string, s11, "str_oh_do_you_mean_that_such_a_kind_thing_to_say"),
      (else_try),
        (str_store_string, s11, "str_you_are_a_most_gallant_young_man_"),
      (try_end),
      
    ],
    "{s11}I would like it very much if we could see more of each other.", "close_window",
    [(troop_set_slot, "$g_talk_troop", slot_troop_met, 2),
      (assign, "$lady_flirtation_location", "$g_encountered_party"),
  ]],
  
  [anyone,"lady_profess_admiration", [
    ],
    "Ah... You are too kind... My, the hour is getting rather late, isn't it? I really must be going.", "lady_pretalk",
    [(troop_set_slot, "$g_talk_troop", slot_troop_met, 2),
  ]],
  
  
  [anyone|plyr,"lady_talk",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_met, 2),
      (eq, "$g_time_to_spare", 1),
      (eq, "$talk_context", tc_courtship),
    ],
    "Do you like poetry, my lady?", "lady_recite_poetry",[
      (assign, "$g_time_to_spare", 0),
  ]],
  
  [anyone,"lady_recite_poetry", [
    ],
    "That would depend on the poem. Did you intend to recite a verse?", "lady_recite_poetry",
    []],
  
  
  [anyone|plyr,"lady_recite_poetry",
    [
      (gt, "$tragic_poem_recitations", 0),
      (troop_slot_eq, "$g_talk_troop", slot_lady_courtship_tragic_recited, 0),
      
    ],
    "The wind that blows the dry steppe dust...", "lady_recite_poetry_response",[
      (assign, "$poem_selected", courtship_poem_tragic),
      (troop_set_slot, "$g_talk_troop", slot_lady_courtship_tragic_recited, 1),
      
  ]],
  
  [anyone|plyr,"lady_recite_poetry",
    [
      (gt, "$comic_poem_recitations", 0),
      (troop_slot_eq, "$g_talk_troop", slot_lady_courtship_comic_recited, 0),
      
    ],
    "All the silks of Veluca/All the furs of Khudan...", "lady_recite_poetry_response",[
      (assign, "$poem_selected", courtship_poem_comic),
      (troop_set_slot, "$g_talk_troop", slot_lady_courtship_comic_recited, 1),
      
  ]],
  
  [anyone|plyr,"lady_recite_poetry",
    [
      (gt, "$mystic_poem_recitations", 0),
      (troop_slot_eq, "$g_talk_troop", slot_lady_courtship_mystic_recited, 0),
      
    ],
    "You are the first and the last/the outer and the inner...", "lady_recite_poetry_response",[
      (assign, "$poem_selected", courtship_poem_mystic),
      (troop_set_slot, "$g_talk_troop", slot_lady_courtship_mystic_recited, 1),
      
  ]],
  
  [anyone|plyr,"lady_recite_poetry",
    [
      (gt, "$heroic_poem_recitations", 0),
      (troop_slot_eq, "$g_talk_troop", slot_lady_courtship_heroic_recited, 0),
    ],
    "A light pierced the gloom over Wercheg cliffs...", "lady_recite_poetry_response",[
      (assign, "$poem_selected", courtship_poem_heroic),
      (troop_set_slot, "$g_talk_troop", slot_lady_courtship_heroic_recited, 1),
      
  ]],
  
  [anyone|plyr,"lady_recite_poetry",
    [
      (gt, "$allegoric_poem_recitations", 0),
      (troop_slot_eq, "$g_talk_troop", slot_lady_courtship_allegoric_recited, 0),
      
    ],
    "I deflected her skeptical questioning darts/with armor made of purest devotion...", "lady_recite_poetry_response",[
      (assign, "$poem_selected", courtship_poem_allegoric),
      (troop_set_slot, "$g_talk_troop", slot_lady_courtship_allegoric_recited, 1),
  ]],
  
  
  [anyone|plyr,"lady_recite_poetry",
    [],"Actually, I can't think of any that I would care to recite...", "lady_pretalk",[]],
  
  [anyone,"lady_recite_poetry_response",
    [
      (call_script, "script_courtship_poem_reactions", "$g_talk_troop", "$poem_selected"),
    ],
    "{s11}", "lady_private_conversation_end",[
      (assign, ":reaction", reg0),
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", ":reaction"),
      (call_script, "script_courtship_poem_reactions", "$g_talk_troop", "$poem_selected"), #this needs to be twice, as the above resets s11
  ]],
  
  [anyone,"lady_private_conversation_end",
    [
      (str_clear, s11),
      (try_begin),
        (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", "trp_player"),
        (gt, reg0, 0),
        (str_store_string, s11, "str__do_come_and_see_me_again_soon"),
      (try_end),
    ],
    "Time is passing quickly, and we cannot linger here too long.", "lady_pretalk",
    [
      (assign, "$g_time_to_spare", 0),
  ]],
  
  
  [anyone|plyr,"lady_talk",
    [
      (neg|check_quest_active, "qst_formal_marriage_proposal"),
      (neg|troop_slot_ge, "trp_player", slot_troop_betrothed, active_npcs_begin),
      (neg|troop_slot_ge, "trp_player", slot_troop_spouse, active_npcs_begin),
      
      
      (troop_slot_eq, "$g_talk_troop", slot_troop_met, 2),
      (eq, "$talk_context", tc_courtship),
    ],
    "Do you think that we may have a future together, my lady?", "lady_marriage_discussion",[
  ]],
  
  
  [anyone,"lady_marriage_discussion",
    [
      (assign, "$romantic_rival", -1),
      (try_for_range, ":possible_rival", lords_begin, lords_end),
        (this_or_next|troop_slot_eq, ":possible_rival", slot_troop_love_interest_1, "$g_talk_troop"),
        (this_or_next|troop_slot_eq, ":possible_rival", slot_troop_love_interest_2, "$g_talk_troop"),
        (troop_slot_eq, ":possible_rival", slot_troop_love_interest_2, "$g_talk_troop"),
        (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", ":possible_rival"),
        
        (try_begin),
          (eq, "$cheat_mode", 1),
          (str_store_troop_name, s4, ":possible_rival"),
          (display_message, "str_rival_found_s4_reg0_relation"),
        (try_end),
        (gt, reg0, "$g_talk_troop_relation"),
        (assign, "$romantic_rival", ":possible_rival"),
      (try_end),
      (gt, "$romantic_rival", -1),
      
    ],
    "Sir -- as you may know, I have been entertaining offers from a number of gentlemen such as yourself. I am not yet at a stage where I can commit to any of them.", "lady_other_suitor",[
  ]],
  
  
  [anyone,"lady_marriage_discussion",
    [
      (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_ambitious),
      (neg|troop_slot_ge, "trp_player", slot_troop_renown, 350),
    ],
    "It is good to hear that you are thinking seriously about the future. However, I would like to see you rise a little further in the world before I am ready to commit to marry you.", "lady_proposal_refused",[
  ]],
  
  [anyone,"lady_marriage_discussion",
    [
      (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_moralist),
      (lt, "$player_honor", 10)
    ],
    "It is good to hear that your intentions are honorable. However, I have resolved only to marry a man of the strongest moral fiber. I would like you to prove yourself more in that regard.", "lady_proposal_refused",[
  ]],
  
  
  [anyone,"lady_marriage_discussion",
    [
      (lt, "$g_talk_troop_relation", 20),
    ],
    "Sir -- it is comforting to hear that your intentions towards me are honorable. But perhaps we should take the time to get to allow our affections for each other to grow a little stronger, before making any such decision.", "lady_proposal_refused",[
  ]],
  
  
  
  [anyone,"lady_marriage_discussion",
    [
      (call_script, "script_get_kingdom_lady_social_determinants", "$g_talk_troop"),
      (assign, ":guardian", reg0),
      (troop_slot_eq, ":guardian", slot_lord_granted_courtship_permission, -1),
      (str_store_troop_name, s4, reg0),
      (call_script, "script_troop_get_family_relation_to_troop", ":guardian", "$g_talk_troop"),
    ],
    "Oh {playername}, how happy that would make me! But my {s11} {s4} would never allow it... Perhaps it is best that we part...", "lady_betrothed", []],
  
  [anyone,"lady_marriage_discussion",
    [
      (call_script, "script_get_kingdom_lady_social_determinants", "$g_talk_troop"),
      (assign, ":guardian", reg0),
      (call_script, "script_troop_get_family_relation_to_troop", ":guardian", "$g_talk_troop"),
      (str_store_troop_name, s4, ":guardian"),
      
    ],
    "Oh {playername}, how happy that would make me! Go ask my {s11} {s4} for permission!", "close_window",[
      (call_script, "script_get_kingdom_lady_social_determinants", "$g_talk_troop"),
      (assign, ":guardian", reg0),
      (str_store_troop_name, s12, ":guardian"),
      (str_store_troop_name, s15, "$g_talk_troop"),
      (setup_quest_text, "qst_formal_marriage_proposal"),
      (str_store_string, s2, "str_you_intend_to_ask_s12_for_permission_to_marry_s15"),
      
      (quest_set_slot, "qst_formal_marriage_proposal", slot_quest_target_troop, ":guardian"),
      (quest_set_slot, "qst_formal_marriage_proposal", slot_quest_expiration_days, 30),
      (quest_set_slot, "qst_formal_marriage_proposal", slot_quest_current_state, 0),
      (call_script, "script_start_quest", "qst_formal_marriage_proposal", "$g_talk_troop"),
      (quest_set_slot, "qst_formal_marriage_proposal", slot_quest_giver_troop, "$g_talk_troop"),
      
      #Repeated to ensure strings work correctly
      (call_script, "script_troop_get_family_relation_to_troop", ":guardian", "$g_talk_troop"),
      (str_store_troop_name, s4, ":guardian"),
  ]],
  
  [anyone|plyr,"lady_proposal_refused",
    [
      (is_between, "$g_talk_troop_relation", 12, 20),
      (this_or_next|neg|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_ambitious),
      (troop_slot_ge, "trp_player", slot_troop_renown, 350),
      (this_or_next|neg|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_moralist),
      (ge, "$player_honor", 10),
    ],
    "Perhaps I can persuade you to delay no further.", "lady_proposal_refused_persuade_check",[
  ]],
  
  [anyone,"lady_proposal_refused_persuade_check",
    [
    ],
    "What do you have to say?", "lady_proposal_refused_persuade_player_response",[
      
      (assign, reg4, 20),
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", "trp_player"),
      (assign, ":cur_relation", reg0),
      (assign, reg5, ":cur_relation"),
      (assign, reg9, 1),
      (store_skill_level, ":persuasion_level", "skl_persuasion", "trp_player"),
      (store_sub, ":difference", 20, ":cur_relation"),
      (val_mul, ":persuasion_level", 2),
      (try_begin),
        (gt, ":difference", ":persuasion_level"),
        (assign, "$g_persuasion_failure_chance", 100),
      (else_try),
        (store_mul, "$g_persuasion_failure_chance", ":difference", 100),
        (val_div, "$g_persuasion_failure_chance", ":persuasion_level"),
      (try_end),
      (assign, reg8, "$g_persuasion_failure_chance"),
      (store_sub, reg7, 100, "$g_persuasion_failure_chance"),
      (dialog_box, "str_persuasion_opportunity"),
      
  ]],
  
  [anyone|plyr,"lady_proposal_refused_persuade_player_response",
    [
    ],
    "Love is as a rose, my lady. Left unplucked, it may wither.", "lady_proposal_refused_persuade_result",[
  ]],
  
  [anyone|plyr,"lady_proposal_refused_persuade_player_response",
    [],
    "Oh, never mind.", "lady_pretalk",
    []],
  
  
  [anyone,"lady_proposal_refused_persuade_result",
    [
      (store_random_in_range, ":random", 0, 100),
      (lt, ":random", "$g_persuasion_failure_chance"),
    ],
    "Enough, sir! I shall not be rushed into marriage, with you or with anyone else! You have made me very cross. Please, leave me alone for a while. I shall let you know when I am ready to speak to you again.", "close_window", [
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", -1),
      (jump_to_menu, "mnu_town"),
      (finish_mission),
  ]],
  
  
  [anyone,"lady_proposal_refused_persuade_result",
    [
      (call_script, "script_get_kingdom_lady_social_determinants", "$g_talk_troop"),
      (assign, ":guardian", reg0),
      (troop_slot_eq, ":guardian", slot_lord_granted_courtship_permission, -1),
      (str_store_troop_name, s4, reg0),
      (call_script, "script_troop_get_family_relation_to_troop", ":guardian", "$g_talk_troop"),
    ],
    "Oh {playername}, I could never allow that to happen! Oh, if only we could be wed! But my {s11} {s4} would never give his permission... Perhaps it is best that we part...", "lady_betrothed", [
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", 5),
  ]],
  
  [anyone,"lady_proposal_refused_persuade_result",
    [
      (call_script, "script_get_kingdom_lady_social_determinants", "$g_talk_troop"),
      (assign, ":guardian", reg0),
      (call_script, "script_troop_get_family_relation_to_troop", ":guardian", "$g_talk_troop"),
      (str_store_troop_name, s4, ":guardian"),
      
    ],
    "Oh {playername}, I could never allow that to happen! Go ask my {s11} {s4} his permission for us to be wed!", "close_window",[
      
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", 5),
      (call_script, "script_get_kingdom_lady_social_determinants", "$g_talk_troop"),
      (assign, ":guardian", reg0),
      (str_store_troop_name, s12, ":guardian"),
      (str_store_troop_name, s15, "$g_talk_troop"),
      (setup_quest_text, "qst_formal_marriage_proposal"),
      (str_store_string, s2, "str_you_intend_to_ask_s12_for_permission_to_marry_s15"),
      
      (quest_set_slot, "qst_formal_marriage_proposal", slot_quest_target_troop, ":guardian"),
      (quest_set_slot, "qst_formal_marriage_proposal", slot_quest_expiration_days, 30),
      (quest_set_slot, "qst_formal_marriage_proposal", slot_quest_current_state, 0),
      (call_script, "script_start_quest", "qst_formal_marriage_proposal", "$g_talk_troop"),
      (quest_set_slot, "qst_formal_marriage_proposal", slot_quest_giver_troop, "$g_talk_troop"),
  ]],
  
  [anyone|plyr,"lady_proposal_refused",
    [],
    "Very well -- I shall continue to strive to be worthy of your esteem!", "close_window",[
  ]],
  
  [anyone|plyr,"lady_proposal_refused",
    [
      (eq, 1, 0),
      (neg|check_quest_active, "qst_formal_marriage_proposal"),
    ],
    "I am tired of these games! I will speak to your family about arranging a wedding immediately..", "lady_player_threatens_compel",[
  ]],
  
  [anyone,"lady_player_threatens_compel",
    [],
    "What? Do you mean that?", "lady_player_threatens_compel_2",[
  ]],
  
  [anyone|plyr,"lady_player_threatens_compel_2",
    [],
    "No, of couse not. Please forgive my burst of temper", "lady_private_conversation_end",[
  ]],
  
  [anyone|plyr,"lady_player_threatens_compel_2",
    [],
    "Yes -- you clearly do not know what is in your best interests.", "close_window",[
      (call_script, "script_get_kingdom_lady_social_determinants", "$g_talk_troop"),
      (assign, ":guardian", reg0),
      (str_store_troop_name, s10, "$g_talk_troop"),
      (str_store_troop_name, s12, ":guardian"),
      (setup_quest_text, "qst_formal_marriage_proposal"),
      (str_store_string, s2, "str_you_intend_to_ask_s12_to_pressure_s10_to_marry_you"),
      
      (quest_set_slot, "qst_formal_marriage_proposal", slot_quest_target_troop, ":guardian"),
      (quest_set_slot, "qst_formal_marriage_proposal", slot_quest_expiration_days, 30),
      (quest_set_slot, "qst_formal_marriage_proposal", slot_quest_current_state, 0),
      (call_script, "script_start_quest", "qst_formal_marriage_proposal", "$g_talk_troop"),
      (quest_set_slot, "qst_formal_marriage_proposal", slot_quest_giver_troop, "$g_talk_troop"),
  ]],
  
  
  
  #rival suitor sequence
  [anyone|plyr,"lady_other_suitor",
    [],
    "It grieves me to hear that, my lady, but such things must be", "lady_pretalk",
    []],
  
  [anyone|plyr,"lady_other_suitor",
    [],
    "Who is the miscreant! Tell me his name!", "lady_other_suitor_challenge",
    []],
  
  [anyone|plyr,"lady_other_suitor", #similar to other
    [
      (eq, 1, 0),
    ],
    "I am tired of these games! I will demand that your family compel you to marry me..", "lady_player_threatens_compel",[
  ]],
  
  [anyone,"lady_other_suitor_challenge",
    [
      (check_quest_active,"qst_duel_courtship_rival"),
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", "$romantic_rival"),
      (lt, reg0, 0)
    ],
    "I would be so grateful! But from what I understand, you already have a duel on your hands. He is not honor-bound to fight you, if you are committed to another combat. Please, conclude your other business in a hurry, to rescue me from that man's attentions!.", "lady_pretalk",
    []],
  
  [anyone,"lady_other_suitor_challenge",
    [
      (check_quest_active,"qst_duel_courtship_rival")
    ],
    "Ah! Such talk. But from what I hear, you already have a duel on your hands. Finish one before you start another! Sigh... You men can be so silly...", "lady_pretalk",
    []],
  
  [anyone,"lady_other_suitor_challenge",
    [
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", "$romantic_rival"),
      (lt, reg0, 0),
      (str_store_troop_name, s5, "$romantic_rival"),
    ],
    "It is {s5}. Please, rescue me from that man's attentions!", "lady_other_suitor_challenge_confirm",
    []],
  
  
  
  [anyone,"lady_other_suitor_challenge",
    [
      (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_ambitious),
      (str_store_troop_name, s5, "$romantic_rival"),
    ],
    "Will you now? This should be interesting. Very well. Your rival is {s5}. Let us see which of you has the greater mettle.", "lady_other_suitor_challenge_confirm",
    [
      (assign, "$quarrel_penalty", 0),
  ]],
  
  [anyone,"lady_other_suitor_challenge",
    [
      (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_conventional),
      (str_store_troop_name, s5, "$romantic_rival"),
    ],
    "Oh, fie! I wish that this were not a matter of honor, so I could refuse such a request. But alas, I feel compelled to tell you that your rival is {s5}. I wish that heaven had not granted me such a fair visage, so that I would not inspire such passions in men!", "lady_other_suitor_challenge_confirm",
    [
      (assign, "$quarrel_penalty", -1),
  ]],
  
  [anyone,"lady_other_suitor_challenge",
    [
      (str_store_troop_name, s5, "$romantic_rival"),
    ],
    "I will have none of such talk! It is nonsense for you and {s5} to fight over -- whoops! I beg of you, sir, forget the name that just escaped my lips...", "lady_other_suitor_challenge_confirm",
    [
      (assign, "$quarrel_penalty", -3),
  ]],
  
  [anyone|plyr,"lady_other_suitor_challenge_confirm",
    [],
    "So be it! I shall challenge him to a trial of arms!", "lady_other_suitor_challenge_confirm_yes",
    []],
  
  [anyone|plyr,"lady_other_suitor_challenge_confirm",
    [],
    "On second thought, I let my passions run away with me there. Never mind.", "lady_other_suitor_challenge_confirm_no",
    []],
  
  [anyone,"lady_other_suitor_challenge_confirm_yes",
    [
      (try_begin),
        (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", "$romantic_rival"),
        (lt, reg0, 0),
        (str_store_string, s15, "str_do_be_careful_i_am_so_much_endebted_to_you_for_this"),
      (else_try),
        (troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_ambitious),
        (str_store_string, s15, "str_go_then__we_shall_see_which_of_you_triumphs"),
      (else_try),
        (str_store_string, s15, "str_sigh_i_will_never_truly_understand_men_and_their_rash_actions"),
      (try_end),
    ],
    "{s15}", "lady_pretalk",
    [
      (call_script, "script_troop_change_relation_with_troop", "trp_player", "$g_talk_troop", "$quarrel_penalty"),
      (str_store_troop_name, s11, "$g_talk_troop"),
      (str_store_troop_name_link, s13, "$romantic_rival"),
      (setup_quest_text, "qst_duel_courtship_rival"),
      (str_store_string, s2, "str_you_intend_to_challenge_s13_to_force_him_to_relinquish_his_suit_of_s11"),
      
      (call_script, "script_start_quest", "qst_duel_courtship_rival", "$g_talk_troop"),
      
      (quest_set_slot, "qst_duel_courtship_rival", slot_quest_target_troop, "$romantic_rival"),
      
      (quest_set_slot, "qst_duel_courtship_rival", slot_quest_xp_reward, 400),
      (quest_set_slot, "qst_duel_courtship_rival", slot_quest_expiration_days, 60),
      (quest_set_slot, "qst_duel_courtship_rival", slot_quest_current_state, 0),
  ]],
  
  [anyone,"lady_other_suitor_challenge_confirm_no",
    [],
    "Good. You are wise not to let your temper guide you.", "lady_private_conversation_end",
    []],
  
  
  
  
  
  
  [anyone|plyr,"lady_talk",
    [
      (troop_slot_ge, "$g_talk_troop", slot_troop_spouse, 0),
      #     (troop_slot_ge, "$g_talk_troop", slot_troop_met, 2),
      (store_partner_quest, ":ladys_quest"),
      (lt, ":ladys_quest", 0)
    ],
    "Is there anything I can do to win your favour?", "lady_ask_for_quest",[(call_script, "script_get_quest", "$g_talk_troop"),
      (assign, "$random_quest_no", reg0)]],
  
  [anyone,"lady_ask_for_quest",
    [
      (troop_slot_eq, "$g_talk_troop", slot_troop_does_not_give_quest, 1),
    ],
    "I don't have anything else for you to do right now.", "lady_pretalk", []],
  
  [anyone,"lady_ask_for_quest",
    [
      (this_or_next|eq, "$random_quest_no", "qst_rescue_lord_by_replace"),
      (eq, "$random_quest_no", "qst_rescue_prisoner"),
      
      (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
      (call_script, "script_troop_get_family_relation_to_troop", ":quest_target_troop", "$g_talk_troop"),
      (str_store_string, s17, s11),
    ],
    "Oh, I fear I may never see my {s17}, {s13}, again... He is a prisoner in the dungeon of {s14}. " +
    "We have tried to negotiate his ransom, but it has been set too high. " +
    "We can never hope to raise that much money without selling everything we own, " +
    "and God knows {s13} would rather spend his life in prison than make us destitute. " +
    "Instead I came up with a plan to get him out of there, but it requires someone to make a great sacrifice, " +
    "and so far my pleas have fallen on deaf ears...", "lady_mission_told",
    [
      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
      (call_script, "script_troop_get_family_relation_to_troop", ":quest_target_troop", "$g_talk_troop"),
      (str_store_string, s17, s11),
      
      (str_store_troop_name, s11, "$g_talk_troop"),
      (str_store_troop_name_link, s13, ":quest_target_troop"),
      (str_store_party_name_link, s14, ":quest_target_center"),
      (setup_quest_text,"$random_quest_no"),
      
      (try_begin),
        (eq, "$random_quest_no", "qst_rescue_lord_by_replace"),
        (str_store_string, s2, "@{s11} asked you to rescue her {s17}, {s13}, from {s14} by switching clothes and taking his place in prison."),
      (else_try),
        (str_store_string, s2, "@{s11} asked you to rescue her {s17}, {s13}, from {s14}."),
      (try_end),
  ]],
  
  [anyone,"lady_ask_for_quest", [
      (eq, "$random_quest_no", "qst_deliver_message_to_prisoner_lord"),
      (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
      (call_script, "script_troop_get_family_relation_to_troop", ":quest_target_troop", "$g_talk_troop"),
      
    ],
    "My poor {s11}, {s13}, is a prisoner in the {s14} dungeons. " +
    "The only way we can talk to each other is by exchanging letters whenever we can, " +
    "but the journey is so dangerous that we get little chance to do so. " +
    "Please, would you deliver one for me?", "lady_mission_told",
    [
      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
      
      
      (str_store_troop_name, s11, "$g_talk_troop"),
      (str_store_troop_name_link, s13, ":quest_target_troop"),
      (str_store_party_name_link, s14, ":quest_target_center"),
      (setup_quest_text,"$random_quest_no"),
      (str_store_string, s2, "@{s11} asked you to deliver a message to {s13}, who is imprisoned at {s14}."),
  ]],
  
  
  [anyone,"lady_ask_for_quest", [(eq, "$random_quest_no", "qst_duel_for_lady")],
    "Dear {playername}, you are kind to ask, but you know little of my troubles " +
    "and I can't possibly ask you to throw yourself into danger on my behalf.", "lady_quest_duel_for_lady",[]],
  
  [anyone|plyr,"lady_quest_duel_for_lady", [], "Tell me what the problem is, and I can make my own decision.", "lady_quest_duel_for_lady_2",
    [
      (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
      
      (str_store_troop_name, s11, "$g_talk_troop"),
      (str_store_troop_name_link, s13, ":quest_target_troop"),
      (str_store_string, s2, "@You agreed to challenge {s13} to defend {s11}'s honour."),
      (setup_quest_text,"$random_quest_no"),
  ]],
  
  [anyone,"lady_quest_duel_for_lady_2", [], "Very well, as you wish it... " +
    "My husband has made certain enemies in his life, {playername}. One of the most insidious is {s13}. " +
    "He is going around making terrible accusations against me, impugning my honour at every turn! " +
    "Because he cannot harm my husband directly, he is using me as a target to try and stain our name. " +
    "You should hear the awful things he's said! I only wish there was someone brave enough to make him recant his slander, " +
    "but {s13} is a very fine swordsman, and he's widely feared...", "lady_quest_duel_for_lady_3",[]],
  
  [anyone|plyr,"lady_quest_duel_for_lady_3", [], "I fear him not, {s65}. I will make him take back his lies.", "lady_quest_duel_for_lady_3_accepted",[]],
  [anyone,"lady_quest_duel_for_lady_3_accepted", [], "Oh! I can't ask that of you, {playername}, but... " +
    "I would be forever indebted to you, and you are so sure. It would mean so much if you would defend my honour. " +
    "Thank you a thousand times, all my prayers and my favour go with you.", "close_window",
    [
      
      (quest_get_slot, ":quest_target_troop", "$random_quest_no", slot_quest_target_troop),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_report_quest_troop_positions", "$random_quest_no", ":quest_target_troop", 3),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 3),
  ]],
  
  [anyone|plyr,"lady_quest_duel_for_lady_3", [], "If he's that dangerous, perhaps maybe it would be better to ignore him...", "lady_quest_duel_for_lady_3_rejected",[]],
  [anyone,"lady_quest_duel_for_lady_3_rejected", [], "Oh... Perhaps you're right, {playername}. " +
    "I should let go of these silly childhood ideas of chivalry and courage. {Men/People} are not like that, " +
    "not anymore. Good day to you.", "close_window",
    [(troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -1),
  ]],
  
  
  [anyone,"lady_ask_for_quest", [], "No, {playername}, I've no need for a champion right now.", "lady_pretalk",[]],
  
  [anyone|plyr,"lady_mission_told", [], "As you wish it, {s65}, it shall be done.", "lady_mission_accepted",[]],
  [anyone|plyr,"lady_mission_told", [], "{s66}, I fear I cannot help you right now.", "lady_mission_rejected",[]],
  
  [anyone,"lady_mission_accepted", [], "You are a true {gentleman/lady}, {playername}. " +
    "Thank you so much for helping me", "close_window",
    [
      (try_begin),
        (eq, "$random_quest_no", "qst_deliver_message_to_prisoner_lord"),
        (call_script, "script_troop_add_gold", "trp_player", 10),
      (try_end),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
  ]],
  [anyone,"lady_mission_rejected", [], "You'll not help a woman in need? You should be ashamed, {playername}... " +
    "Please leave me, I have some important embroidery to catch up.", "close_window",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -1),
      (troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1),
  ]],
  
  #Leave
  [anyone|plyr,"lady_talk", [
      (troop_slot_ge, "$g_talk_troop", slot_troop_spouse, 0),
      ], "I want to improve my relation with a lord. Can you help me?", "lady_restore_relation",[]],
  [anyone,"lady_restore_relation", [(le, "$g_talk_troop_relation", 0)], "{playername}, I don't know you well enough to act on your behalf. I am sorry.", "lady_pretalk",[]],
  [anyone,"lady_restore_relation", [], "Hmm. I guess you got on the wrong side of somebody. Very well, who do you want to restore your relation with?", "lady_restore_relation_2",[]],
  
  [anyone|plyr|repeat_for_troops,"lady_restore_relation_2", [(store_repeat_object, ":troop_no"),
      (is_between, ":troop_no", active_npcs_begin, active_npcs_end),
      (store_troop_faction, ":faction_no", ":troop_no"),
      (eq, "$g_talk_troop_faction", ":faction_no"),
      (call_script, "script_troop_get_player_relation", ":troop_no"),
      (lt, reg0, 0),
      (str_store_troop_name, s1, ":troop_no")],
    "{s1}", "lady_restore_relation_2b",[(store_repeat_object, "$troop_to_restore_relations_with")]],
  [anyone|plyr,"lady_restore_relation_2", [], "Never mind. I get along with everyone well enough.", "lady_pretalk",[]],
  
  [anyone,"lady_restore_relation_2b", [(str_store_troop_name, s10, "$troop_to_restore_relations_with")], "Well I can try to help you there. " +
    "I am sure a few expensive gifts will make {s10} look at you more favorably.", "lady_restore_relation_3",[]],
  
  [anyone,"lady_restore_relation_3", [(str_store_troop_name, s10, "$troop_to_restore_relations_with"),
      (assign, "$lady_restore_cost_1", 1000),
      (assign, "$lady_restore_cost_2", 2000),
      (assign, "$lady_restore_cost_3", 3000),
      (assign, reg10, "$lady_restore_cost_1"),
      (assign, reg11, "$lady_restore_cost_2"),
      (assign, reg12, "$lady_restore_cost_3"),
      (troop_get_type, reg4, "$troop_to_restore_relations_with"),
    ],
    "You can improve your relation with {s10} by sending {reg4?her:him} a gift worth {reg10} denars. " +
    "But if you can afford spending {reg11} denars on the gift, it would make a good impression on {reg4?her:him}. " +
    "And if you can go up to {reg12} denars, that would really help smooth things out.", "lady_restore_relation_4",[]],
  
  [anyone|plyr,"lady_restore_relation_4", [(store_troop_gold,":gold", "trp_player"),
      (ge, ":gold", "$lady_restore_cost_1"),
      (assign, reg10, "$lady_restore_cost_1")],
    "I think a gift of {reg10} denars will do.", "lady_restore_relation_5",[(assign, "$temp", 1), (assign, "$temp_2", "$lady_restore_cost_1")]],
  [anyone|plyr,"lady_restore_relation_4", [(store_troop_gold,":gold", "trp_player"),
      (ge, ":gold", "$lady_restore_cost_2"),
      (assign, reg11, "$lady_restore_cost_2")],
    "Maybe I can afford {reg11} denars.", "lady_restore_relation_5",[(assign, "$temp", 2), (assign, "$temp_2", "$lady_restore_cost_2")]],
  [anyone|plyr,"lady_restore_relation_4", [(store_troop_gold,":gold", "trp_player"),
      (ge, ":gold", "$lady_restore_cost_3"),
      (assign, reg12, "$lady_restore_cost_3")],
    "In that case, I am ready to spend {reg12} denars.", "lady_restore_relation_5",[(assign, "$temp", 3), (assign, "$temp_2", "$lady_restore_cost_3")]],
  
  [anyone|plyr,"lady_restore_relation_4", [], "I don't think I can afford a gift at the moment.", "lady_restore_relation_cant_afford",[]],
  
  [anyone,"lady_restore_relation_5", [], "Excellent. Then I'll choose an appropriate gift for you and send it to {s10} with your compliments. " +
    "I am sure {reg4?she:he} will appreciate the gesture.", "lady_restore_relation_6",[
      (troop_remove_gold, "trp_player","$temp_2"),
      (call_script, "script_change_player_relation_with_troop", "$troop_to_restore_relations_with", "$temp"),
      (troop_get_type, reg4, "$troop_to_restore_relations_with"),
  ]],
  
  [anyone|plyr,"lady_restore_relation_6", [], "Thank you for your help, madame.", "lady_pretalk",[]],
  
  [anyone,"lady_restore_relation_cant_afford", [], "I am afraid, I can't be of much help in that case, {playername}. I am sorry.", "lady_pretalk",[]],
  
  [anyone|plyr,"lady_talk", [], "I must beg my leave.", "lady_leave",[]],
  
  [anyone|auto_proceed,"lady_leave", [
      (call_script, "script_troop_get_relation_with_troop", "$g_talk_troop", "trp_player"),
      (try_begin),
        (lt, reg0, 0),
        (str_store_string, s12, "str_farewell"),
      (else_try),
        (str_store_string, s12, "str_farewell_playername"),
      (try_end),
      ], "{s12}", "close_window",[(eq,"$talk_context",tc_party_encounter),(assign, "$g_leave_encounter", 1)]],
  
  
  
  #Convincing bargaining
  [anyone,"convince_begin", [], "I still don't see why I should accept what you're asking of me.", "convince_options",
    [(quest_get_slot, "$convince_value", "$g_convince_quest", slot_quest_convince_value),
  ]],
  
  [anyone|plyr,"convince_options", [(assign, reg8, "$convince_value")], "Then I'll make it worth your while. ({reg8} denars)", "convince_bribe",[]],
  [anyone|plyr,"convince_options",
    [(store_div, "$convince_relation_penalty", "$convince_value", 300),
      (val_add, "$convince_relation_penalty", 1),
      (assign, reg9, "$convince_relation_penalty")],
    "Please, do it for the sake of our friendship. (-{reg9} to relation)", "convince_friendship",[]],
  [anyone|plyr,"convince_options", [], "Let me try and convince you. (Persuasion)", "convince_persuade_begin", []],
  [anyone|plyr,"convince_options", [], "Never mind.", "lord_pretalk",[]],
  
  [anyone,"convince_bribe", [], "Mmm, a generous gift to my coffers would certainly help matters... " +
    "{reg8} denars should do it. If you agree, then I'll go with your suggestion.", "convince_bribe_verify",[]],
  
  [anyone|plyr,"convince_bribe_verify", [(store_troop_gold, ":gold", "trp_player"),
      (lt, ":gold", "$convince_value")],
    "I'm afraid my finances will not allow for such a gift.", "convince_bribe_cant_afford",[]],
  [anyone|plyr,"convince_bribe_verify", [(store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", "$convince_value")],
    "Very well, please accept these {reg8} denars as a token of my gratitude.", "convince_bribe_goon",[]],
  [anyone|plyr,"convince_bribe_verify", [], "Let me think about this some more.", "convince_begin",[]],
  
  [anyone,"convince_bribe_cant_afford", [], "Ah. In that case, there is little I can do, " +
    "unless you have some further argument to make.", "convince_options",[]],
  [anyone,"convince_bribe_goon", [], "My dear {playername}, your generous gift has led me to reconsider what you ask, " +
    "and I have come to appreciate the wisdom of your proposal.", "convince_accept",[(troop_remove_gold, "trp_player","$convince_value")]],
  
  [anyone,"convince_friendship",
    [(store_add, ":min_relation", 5, "$convince_relation_penalty"),
      (ge, "$g_talk_troop_effective_relation", ":min_relation")], "You've done well by me in the past, {playername}, " +
    "and for that I will go along with your request, but know that I do not like you using our relationship this way.", "convince_friendship_verify",[]],
  
  [anyone|plyr,"convince_friendship_verify", [], "I am sorry, my friend, but I need your help in this.", "convince_friendship_go_on",[]],
  [anyone|plyr,"convince_friendship_verify", [], "If it will not please you, then I'll try something else.", "lord_pretalk",[]],
  
  [anyone,"convince_friendship_go_on", [], "All right then, {playername}, I will accept this for your sake. But remember, you owe me for this.", "convince_accept",
    [(store_sub, ":relation_change", 0, "$convince_relation_penalty"),
      (call_script, "script_change_player_relation_with_troop","$g_talk_troop",":relation_change")]],
  
  [anyone,"convince_friendship",
    [(ge, "$g_talk_troop_relation", -5)], "I don't think I owe you such a favor {playername}. " +
    "I see no reason to accept this for you.", "lord_pretalk",[]],
  
  [anyone,"convince_friendship", [], "Is this a joke? You've some nerve asking me for favours, {playername}, " +
    "and let me assure you you'll get none.", "lord_pretalk",[]],
  
  [anyone,"convince_persuade_begin",
    [(troop_get_slot, ":last_persuasion_time", "$g_talk_troop", slot_troop_last_persuasion_time),
      (store_current_hours, ":cur_hours"),
      (store_add, ":valid_time", ":last_persuasion_time", 24),
      (gt, ":cur_hours", ":valid_time"),
    ],
    "Very well. Make your case.", "convince_persuade_begin_2",[]],
  
  
  [anyone|plyr,"convince_persuade_begin_2", [], "[Attempt to persuade]", "convince_persuade",[
      (try_begin),
        (store_random_in_range, ":rand", 0, 100),
        (lt, ":rand", 30),
        (store_current_hours, ":cur_hours"),
        (troop_set_slot, "$g_talk_troop", slot_troop_last_persuasion_time, ":cur_hours"),
      (try_end),
      (store_skill_level, ":persuasion_level", "skl_persuasion", "trp_player"),
      (store_add, ":persuasion_potential", ":persuasion_level", 5),
      
      (store_random_in_range, ":random_1", 0, ":persuasion_potential"),
      (store_random_in_range, ":random_2", 0, ":persuasion_potential"),
      (store_add, ":rand", ":random_1", ":random_2"),
      
      (assign, ":persuasion_difficulty", "$convince_value"),
      (convert_to_fixed_point, ":persuasion_difficulty"),
      (store_sqrt, ":persuasion_difficulty", ":persuasion_difficulty"),
      (convert_from_fixed_point, ":persuasion_difficulty"),
      (val_div, ":persuasion_difficulty", 10),
      (val_add, ":persuasion_difficulty", 4),
      
      (store_sub, "$persuasion_strength", ":rand", ":persuasion_difficulty"),
      (val_mul, "$persuasion_strength", 20),
      (assign, reg5, "$persuasion_strength"),
      (val_sub, "$convince_value", "$persuasion_strength"),
      (quest_set_slot, "$g_convince_quest", slot_quest_convince_value, "$convince_value"),
      (str_store_troop_name, s50, "$g_talk_troop"),
      (troop_get_type, reg51, "$g_talk_troop"),
      (try_begin),
        (lt, "$persuasion_strength", -30),
        (str_store_string, s5, "str_persuasion_summary_very_bad"),
      (else_try),
        (lt, "$persuasion_strength", -10),
        (str_store_string, s5, "str_persuasion_summary_bad"),
      (else_try),
        (lt, "$persuasion_strength", 10),
        (str_store_string, s5, "str_persuasion_summary_average"),
      (else_try),
        (lt, "$persuasion_strength", 30),
        (str_store_string, s5, "str_persuasion_summary_good"),
      (else_try),
        (str_store_string, s5, "str_persuasion_summary_very_good"),
      (try_end),
      (dialog_box, "@{s5} (Persuasion strength: {reg5})", "@Persuasion Attempt"),
  ]],
  [anyone|plyr,"convince_persuade_begin_2", [], "Wait, perhaps there is another way to convince you.", "convince_begin",[]],
  
  [anyone,"convince_persuade_begin", [], "By God's grace, {playername}! " +
    "Haven't we talked enough already? I am tired of listening to you, " +
    "and I do not want to hear any more of it right now.", "lord_pretalk",[]],
  
  [anyone,"convince_persuade", [(le, "$convince_value", 0)], "All right, all right. You have persuaded me to it. " +
    "I'll go ahead with what you suggest.", "convince_accept",[]],
  [anyone,"convince_persuade", [(gt, "$persuasion_strength", 5)], "You've a point, {playername}, " +
    "I'll admit that much. However I am not yet convinced I should do as you bid.", "convince_options",[]],
  [anyone,"convince_persuade", [(gt, "$persuasion_strength", -5)], "Enough, {playername}. " +
    "You've a lot of arguments, but I find none of them truly convincing. I stand by what I said before.", "convince_options",[]],
  [anyone,"convince_persuade", [], "Truthfully, {playername}, I fail to see the virtue of your reasoning. " +
    "What you ask for makes even less sense now than it did before.", "convince_options",[]],
  
  #Seneschal
  
  [anyone,"start", [(troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_seneschal),
      (eq, "$talk_context", tc_siege_won_seneschal),
      (str_store_party_name, s1, "$g_encountered_party"),
    ],
    "I must congratulate you on your victory, my {lord/lady}. Welcome to {s1}. " +
    "We, the housekeepers of this castle, are at your service.", "siege_won_seneschal_1",[]],
  [anyone|plyr,"siege_won_seneschal_1", [], "Are you the seneschal?", "siege_won_seneschal_2",[]],
  [anyone,"siege_won_seneschal_2", [], "Indeed I am, my {lord/lady}. " +
    "I have always served the masters of {s1} to the best of my ability, whichever side they might be on. " +
    "Thus you may count on my utmost loyalty for as long as you are the {lord/lady} of this place. " +
    "Now, do you intend to keep me on as the seneschal? I promise you will not be disappointed.", "siege_won_seneschal_3",[]],
  [anyone|plyr,"siege_won_seneschal_3", [], "Very well, you may keep your post for the time being.", "siege_won_seneschal_4",[]],
  [anyone|plyr,"siege_won_seneschal_3", [], "You can stay, but I shall be keeping a close watch on you.", "siege_won_seneschal_4",[]],
  [anyone,"siege_won_seneschal_4", [], "Thank you, my {lord/lady}. If you do not mind my impudence, " +
    "may I inquire as to what you wish to do with the castle?", "siege_won_seneschal_5",[]],
  
  [anyone|plyr,"siege_won_seneschal_5", [], "I will sell it to another lord.", "siege_won_seneschal_6",[]],
  [anyone|plyr,"siege_won_seneschal_5", [], "I intend to claim it for myself.", "siege_won_seneschal_6",[]],
  
  [anyone|plyr,"siege_won_seneschal_5", [], "I haven't given it much thought. What are my options?", "siege_won_seneschal_list_options",[]],
  
  [anyone,"siege_won_seneschal_list_options", [], "According to our laws and traditions, " +
    "you can do one of several things. " +
    "First, you could station a garrison here to protect the castle from any immediate counterattacks, " +
    "then request an audience with some wealthy lord and ask him to make you an offer. " +
    "It would be worth a tidy sum, believe you me. " +
    "If you do not wish to sell, then you will have to find yourself a liege lord and protector who would accept homage from you. " +
    "Without a royal investiture and an army at your back, you would have a difficult time holding on to the castle. " +
    "Both you and {s1} would become great big targets for any man with a few soldiers and a scrap of ambition. " +
    "", "siege_won_seneschal_list_options_2",[]],
  
  [anyone|plyr,"siege_won_seneschal_list_options_2", [], "What do you mean, a liege lord and protector? I won this place by my own hand, I don't need anyone else!", "siege_won_seneschal_list_options_3",[]],
  [anyone,"siege_won_seneschal_list_options_3", [], "Of course you don't, my {lord/lady}. " +
    "However, no lord in the land will recognize your claim to the castle unless it is verified by royal decree. " +
    "They would call {s1} an outlaw stronghold and take it from you at the earliest opportunity. " +
    "Surely not even you could stand against a whole army.", "siege_won_seneschal_list_options_4",[]],
  [anyone|plyr,"siege_won_seneschal_list_options_4", [], "Hmm. I'll give it some thought.", "siege_won_seneschal_6",[]],
  
  [anyone,"siege_won_seneschal_6", [], "I am very pleased to hear it, my {lord/lady}. " +
    "I am only trying to serve you to the best of my ability. Now, " +
    "if at any time you find you have further need of me, " +
    "I will be in the great hall arranging a smooth handover of the castle to your forces. " +
    "", "close_window",[]],
  
  
  [anyone,"start", [(troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_seneschal),(eq,"$g_talk_troop_met",0),(str_store_party_name,s1,"$g_encountered_party")],
    "Good day, {sir/madam}. I do nott believe I've seen you here before. " +
    "Let me extend my welcome to you as the seneschal of {s1}.", "seneschal_intro_1",[]],
  
  [anyone|plyr,"seneschal_intro_1", [],  "A pleasure to meet you, {s65}.", "seneschal_intro_1a",[]],
  [anyone,"seneschal_intro_1a", [], "How can I help you?", "seneschal_talk",[]],
  [anyone|plyr,"seneschal_intro_1", [],  "What exactly do you do here?", "seneschal_intro_1b",[]],
  [anyone,"seneschal_intro_1b", [], "Ah, a seneschal's duties are many, good {sire/woman}. " +
    "For example, I collect the rents from my lord's estates, I manage the castle's storerooms, " +
    "I deal with the local peasantry, I take care of castle staff, I arrange supplies for the garrison... " +
    "All mundane matters on this fief are my responsibility, on behalf of my lord. " +
    "Everything except commanding the soldiers themselves.", "seneschal_talk",[]],
  
  [anyone,"start", [(troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_seneschal)],
    "Good day, {sir/madam}.", "seneschal_talk",[]],
  
  [anyone,"seneschal_pretalk", [], "Anything else?", "seneschal_talk",[]],
  
  
  ##### TODO: QUESTS COMMENT OUT BEGIN
  ##  [anyone|plyr,"seneschal_talk", [(check_quest_active, "qst_deliver_supply_to_center_under_siege"),
  ##                                  (quest_slot_eq, "qst_deliver_supply_to_center_under_siege", slot_quest_target_troop, "$g_talk_troop"),
  ##                                  (quest_slot_eq, "qst_deliver_supply_to_center_under_siege", slot_quest_current_state, 1),
  ##                                  (store_item_kind_count, ":no_supplies", "itm_siege_supply"),
  ##                                  (quest_get_slot, ":target_amount", "qst_deliver_supply_to_center_under_siege", slot_quest_target_amount),
  ##                                  (ge, ":no_supplies", ":target_amount")],
  ##   "TODO: Here are the supplies.", "seneschal_supplies_given",[]],
  ##
  ##  [anyone|plyr,"seneschal_talk", [(check_quest_active, "qst_deliver_supply_to_center_under_siege"),
  ##                                  (quest_slot_eq, "qst_deliver_supply_to_center_under_siege", slot_quest_target_troop, "$g_talk_troop"),
  ##                                  (quest_slot_eq, "qst_deliver_supply_to_center_under_siege", slot_quest_current_state, 1),
  ##                                  (store_item_kind_count, ":no_supplies", "itm_siege_supply"),
  ##                                  (quest_get_slot, ":target_amount", "qst_deliver_supply_to_center_under_siege", slot_quest_target_amount),
  ##                                  (lt, ":no_supplies", ":target_amount"),
  ##                                  (gt, ":no_supplies", 0)],
  ##   "TODO: Here are the supplies, but some of them are missing.", "seneschal_supplies_given_missing",[]],
  ##
  ##  [anyone|plyr,"seneschal_talk", [(check_quest_active, "qst_deliver_supply_to_center_under_siege"),
  ##                                  (quest_slot_eq, "qst_deliver_supply_to_center_under_siege", slot_quest_object_troop, "$g_talk_troop"),
  ##                                  (quest_slot_eq, "qst_deliver_supply_to_center_under_siege", slot_quest_current_state, 0)],
  ##   "TODO: Give me the supplies.", "seneschal_supplies",[]],
  ##
  ##  [anyone,"seneschal_supplies", [(store_free_inventory_capacity, ":free_inventory"),
  ##                                 (quest_get_slot, ":quest_target_amount", "qst_deliver_supply_to_center_under_siege", slot_quest_target_amount),
  ##                                 (ge, ":free_inventory", ":quest_target_amount"),
  ##                                 (quest_get_slot, ":quest_target_center", "qst_deliver_supply_to_center_under_siege", slot_quest_target_center),
  ##                                 (str_store_party_name, 0, ":quest_target_center"),
  ##                                 (troop_add_items, "trp_player", "itm_siege_supply", ":quest_target_amount")],
  ##   "TODO: Here, take these supplies. You must deliver them to {s0} as soon as possible.", "seneschal_pretalk",[(quest_set_slot, "qst_deliver_supply_to_center_under_siege", slot_quest_current_state, 1)]],
  ##
  ##  [anyone,"seneschal_supplies", [],
  ##   "TODO: You don't have enough space to take the supplies. Free your inventory and return back to me.", "seneschal_pretalk",[]],
  ##
  ##
  ##  [anyone,"seneschal_supplies_given", [],
  ##   "TODO: Thank you.", "seneschal_pretalk",[(party_get_slot, ":town_siege_days", "$g_encountered_party", slot_town_siege_days),
  ##                                            (quest_get_slot, ":target_amount", "qst_deliver_supply_to_center_under_siege", slot_quest_target_amount),
  ##                                            (val_sub, ":town_siege_days", ":target_amount"),
  ##                                            (try_begin),
  ##                                              (lt, ":town_siege_days", 0),
  ##                                              (assign, ":town_siege_days", 0),
  ##                                            (try_end),
  ##                                            (party_set_slot, "$g_encountered_party", slot_town_siege_days, ":town_siege_days"),
  ##                                            (troop_remove_items, "trp_player", "itm_siege_supply", ":target_amount"),
  ##                                            (call_script, "script_finish_quest", "qst_deliver_supply_to_center_under_siege", 100)]],
  ##
  ##  [anyone,"seneschal_supplies_given_missing", [],
  ##   "TODO: Thank you but it's not enough...", "seneschal_pretalk",[(store_item_kind_count, ":no_supplies", "itm_siege_supply"),
  ##                                                                  (quest_get_slot, ":target_amount", "qst_deliver_supply_to_center_under_siege", slot_quest_target_amount),
  ##                                                                  (assign, ":percentage_completed", 100),
  ##                                                                  (val_mul, ":percentage_completed", ":no_supplies"),
  ##                                                                  (val_div, ":percentage_completed", ":target_amount"),
  ##                                                                  (call_script, "script_finish_quest", "qst_deliver_supply_to_center_under_siege", ":percentage_completed"),
  ##                                                                  (party_get_slot, ":town_siege_days", "$g_encountered_party", slot_town_siege_days),
  ##                                                                  (val_sub, ":town_siege_days", ":no_supplies"),
  ##                                                                  (try_begin),
  ##                                                                    (lt, ":town_siege_days", 0),
  ##                                                                    (assign, ":town_siege_days", 0),
  ##                                                                  (try_end),
  ##                                                                  (party_set_slot, "$g_encountered_party", slot_town_siege_days, ":town_siege_days"),
  ##                                                                  (troop_remove_items, "trp_player", "itm_siege_supply", ":no_supplies"),
  ##                                                                  (call_script, "script_end_quest", "qst_deliver_supply_to_center_under_siege")]],
  ##
  ##### TODO: QUESTS COMMENT OUT END
  
  [anyone|plyr,"seneschal_talk", [(store_relation, ":cur_rel", "fac_player_supporters_faction", "$g_encountered_party_faction"),
      (ge, ":cur_rel", 0),],
    "I would like to ask you a question...", "seneschal_ask_something",[]],
  
  [anyone|plyr,"seneschal_talk", [(store_relation, ":cur_rel", "fac_player_supporters_faction", "$g_encountered_party_faction"),
      (ge, ":cur_rel", 0),],
    "I wish to know more about someone...", "seneschal_ask_about_someone",[]],
  
  [anyone,"seneschal_ask_about_someone", [],
    "Perhaps I may be able to help. Whom did you have in mind?", "seneschal_ask_about_someone_2",[]],
  
  #  [anyone|plyr|repeat_for_troops,"seneschal_ask_about_someone_2", [(store_repeat_object, ":troop_no"),
  #                                                                 (is_between, ":troop_no", heroes_begin, heroes_end),
  #                                                                  (store_troop_faction, ":faction_no", ":troop_no"),
  #                                                                 (eq, "$g_encountered_party_faction", ":faction_no"),
  #                                                                 (str_store_troop_name, s1, ":troop_no")],
  #  "{s1}", "seneschal_ask_about_someone_3",[(store_repeat_object, "$hero_requested_to_learn_relations")]],
  
  [anyone|plyr,"seneschal_ask_about_someone_2", [], "Never mind.", "seneschal_pretalk",[]],
  
  #  [anyone, "seneschal_ask_about_someone_3", [(call_script, "script_troop_write_family_relations_to_s1", "$hero_requested_to_learn_relations"),
  #                                          (call_script, "script_troop_write_owned_centers_to_s2", "$hero_requested_to_learn_relations")
  #										   ],
  #   "{s2}{s1}", "seneschal_ask_about_someone_4",[(add_troop_note_from_dialog, "$hero_requested_to_learn_relations", 2)]],
  
  #  [anyone, "seneschal_ask_about_someone_relation", [(call_script, "script_troop_count_number_of_enemy_troops", "$hero_requested_to_learn_relations"),
  #                                            (assign, ":no_enemies", reg0),
  #                                            (try_begin),
  #                                              (gt, ":no_enemies", 1),
  #                                              (try_for_range, ":i_enemy", 1, ":no_enemies"),
  #                                                (store_add, ":slot_no", slot_troop_enemies_begin, ":i_enemy"),
  #                                                (troop_get_slot, ":cur_enemy", "$hero_requested_to_learn_relations", ":slot_no"),
  #                                                (str_store_troop_name_link, s50, ":cur_enemy"),
  #                                                (try_begin),
  #                                                  (eq, ":i_enemy", 1),
  #                                                  (troop_get_slot, ":cur_enemy", "$hero_requested_to_learn_relations", slot_troop_enemy_1),
  #                                                  (str_store_troop_name_link, s51, ":cur_enemy"),
  #                                                  (str_store_string, s51, "str_s50_and_s51"),
  #                                                (else_try),
  #                                                  (str_store_string, s51, "str_s50_comma_s51"),
  #                                                (try_end),
  #                                              (try_end),
  #                                            (else_try),
  #                                              (eq, ":no_enemies", 1),
  #                                              (troop_get_slot, ":cur_enemy", "$hero_requested_to_learn_relations", slot_troop_enemy_1),
  #                                              (str_store_troop_name_link, s51, ":cur_enemy"),
  #                                            (else_try),
  #                                              (str_store_string, s51, "str_noone"),
  #                                            (try_end),
  #                                            (troop_get_type, reg1, "$hero_requested_to_learn_relations")],
  #   "{reg1?She:He} hates {s51}.", "seneschal_ask_about_someone_4",[(add_troop_note_from_dialog, "$hero_requested_to_learn_relations", 3)]],
  # Ryan END
  
  #  [anyone|plyr,"seneschal_ask_about_someone_4", [], "Where does {s1} stand with others?.", "seneschal_ask_about_someone_relation",[]],
  #  [anyone|plyr,"seneschal_ask_about_someone_4", [], "My thanks, that was helpful.", "seneschal_pretalk",[]],
  
  
  [anyone|plyr,"seneschal_talk", [], "I must take my leave of you now. Farewell.", "close_window",[]],
  
  
  [anyone,"seneschal_ask_something", [],
    "I'll do what I can to help, of course. What did you wish to ask?", "seneschal_ask_something_2",[]],
  
  [anyone|plyr,"seneschal_ask_something_2", [],
    "Perhaps you know where to find someone...", "seneschal_ask_location",[]],
  
  [anyone,"seneschal_ask_location", [],
    "Well, a man in my position does hear a lot of things. Of whom were you thinking?", "seneschal_ask_location_2",[]],
  
  [anyone|plyr|repeat_for_troops,"seneschal_ask_location_2", [(store_repeat_object, ":troop_no"),
      (is_between, ":troop_no", heroes_begin, heroes_end),
      (store_troop_faction, ":faction_no", ":troop_no"),
      (eq, "$g_encountered_party_faction", ":faction_no"),
      (str_store_troop_name, s1, ":troop_no")],
    "{s1}", "seneschal_ask_location_3",[(store_repeat_object, "$hero_requested_to_learn_location")]],
  
  [anyone|plyr,"seneschal_ask_location_2", [], "Never mind.", "seneschal_pretalk",[]],
  
  [anyone,"seneschal_ask_location_3", [(call_script, "script_get_information_about_troops_position", "$hero_requested_to_learn_location", 0)],
    "{s1}", "seneschal_pretalk",[]],
  
  #caravan merchants
  [anyone,"start",
    [(eq, "$caravan_escort_state",1),
      (eq, "$g_encountered_party","$caravan_escort_party_id"),
      (le, "$talk_context",tc_party_encounter),
      (store_distance_to_party_from_party, reg0, "$caravan_escort_destination_town", "$caravan_escort_party_id"),
      (lt, reg0, 5),
      (str_store_party_name, s3, "$caravan_escort_destination_town"),
      (assign, reg3, "$caravan_escort_agreed_reward"),
    ],
    "There! I can see the walls of {s3} in the distance. We've made it safely. " +
    "Here, take this purse of {reg3} denars, as I promised. I hope we can travel together again someday.", "close_window",
    [
      (assign,"$caravan_escort_state",0),
      (call_script, "script_troop_add_gold", "trp_player", "$caravan_escort_agreed_reward"),
      (assign,reg(4), "$caravan_escort_agreed_reward"),
      (val_mul,reg(4), 1),
      (add_xp_as_reward,reg(4)),
      (assign, "$g_leave_encounter",1),
  ]],
  
  [anyone,"start",
    [(eq, "$caravan_escort_state", 1),
      (eq, "$g_encountered_party", "$caravan_escort_party_id"),
      (eq, "$talk_context", tc_party_encounter),
    ],
    "We've made it this far... Is everything clear up ahead?", "talk_caravan_escort",[]],
  [anyone|plyr,"talk_caravan_escort", [],
    "There might be bandits nearby. Stay close.", "talk_caravan_escort_2a",[]],
  [anyone,"talk_caravan_escort_2a", [],
    "Trust me, {playername}, we're already staying as close to you as we can. Lead the way.", "close_window",[(assign, "$g_leave_encounter",1)]],
  [anyone|plyr,"talk_caravan_escort", [],
    "No sign of trouble, we can breathe easy.", "talk_caravan_escort_2b",[]],
  [anyone,"talk_caravan_escort_2b", [],
    "I'll breathe easy when we reach {s1} and not a moment sooner. Let's keep moving.", "close_window",[[str_store_party_name,s1,"$caravan_escort_destination_town"],(assign, "$g_leave_encounter",1)]],
  
  [anyone,"start", [(eq,"$talk_context", tc_party_encounter),
      (eq, "$g_encountered_party_type", spt_kingdom_caravan),
      (party_slot_ge, "$g_encountered_party", slot_party_last_toll_paid_hours, "$g_current_hours"),
    ],
    "What do you want? We paid our toll to you less than three days ago.", "merchant_talk",[]],
  
  [anyone,"start", [(eq,"$talk_context", tc_party_encounter),(eq, "$g_encountered_party_type", spt_kingdom_caravan),(ge,"$g_encountered_party_relation",0)],
    "Hail, friend.", "merchant_talk",[]],
  
  [anyone,"start", [(eq,"$talk_context", tc_party_encounter),
      (eq, "$g_encountered_party_type", spt_kingdom_caravan),
      (lt,"$g_encountered_party_relation",0),
      (eq, "$g_encountered_party_faction", "fac_merchants"),
    ],
    "What do you want? We are but simple merchants, we've no quarrel with you, so leave us alone.", "merchant_talk",[]],
  
  [anyone,"start", [(eq,"$talk_context", tc_party_encounter),
      (eq, "$g_encountered_party_type", spt_kingdom_caravan),
      (lt,"$g_encountered_party_relation",0),
      (faction_get_slot, ":faction_leader", "$g_encountered_party_faction",slot_faction_leader),
      (str_store_troop_name, s9, ":faction_leader"),
    ],
    "Be warned, knave! This caravan is under the protection of {s9}. " +
    "Step out of our way or you will face his fury!", "merchant_talk",[]],
  
  
  [anyone,"start", [(party_slot_eq, "$g_encountered_party", slot_party_type, spt_kingdom_caravan),(this_or_next|eq,"$talk_context", tc_party_encounter),(eq,"$talk_context", 0)],
    "Yes? What do you want?", "merchant_talk",[]],
  [anyone,"merchant_pretalk", [], "Anything else?", "merchant_talk",[]],
  
  [anyone|plyr,"merchant_talk", [(le,"$talk_context", tc_party_encounter),
      (check_quest_active, "qst_cause_provocation"),
      (neg|check_quest_concluded, "qst_cause_provocation"),
      (quest_slot_eq, "qst_cause_provocation", slot_quest_target_faction, "$g_encountered_party_faction"),
      (quest_get_slot, ":giver_troop", "qst_cause_provocation", slot_quest_giver_troop),
      (store_faction_of_troop, ":giver_troop_faction", ":giver_troop"),
      (str_store_faction_name, s17, ":giver_troop_faction"),
    ],
    "You are trespassing in the territory of the {s17}. I am confiscating this caravan and all its goods!", "caravan_start_war_quest_1",[]],
  [anyone,"caravan_start_war_quest_1", [(quest_get_slot, ":giver_troop", "qst_cause_provocation", slot_quest_giver_troop),
      (store_faction_of_troop, ":giver_troop_faction", ":giver_troop"),
      (str_store_faction_name, s17, ":giver_troop_faction"),
    ],
    "What? What nonsense is this? We are at peace with the {s17}, and are free to cross its lands!", "caravan_start_war_quest_2",[]],
  [anyone|plyr,"caravan_start_war_quest_2", [], "We'll see about that! Defend yourselves!", "merchant_attack",[]],
  [anyone|plyr,"caravan_start_war_quest_2", [], "Hmm. Maybe this was all a misunderstanding. Farewell.", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  
  [anyone|plyr,"merchant_talk", [(le,"$talk_context", tc_party_encounter),(eq, "$g_encountered_party_faction", "$players_kingdom")], "I have an offer for you.", "merchant_talk_offer",[]],
  [anyone,"merchant_talk_offer", [], "What is it?", "merchant_talk_offer_2",[]],
  
  [anyone|plyr,"merchant_talk_offer_2", [(eq,"$talk_context", tc_party_encounter),(eq, "$g_encountered_party_faction", "$players_kingdom")],
    "I can escort you to your destination for a price.", "caravan_offer_protection",[]],
  
  
  
  ##  [anyone|plyr,"merchant_talk_offer_2", [(troop_slot_eq, "$g_talk_troop", slot_troop_is_prisoner, 0),
  ##                                 (neg|faction_slot_eq, "$g_talk_troop_faction", slot_faction_leader, "$g_talk_troop"), #he is not a faction leader!
  ##                                 (call_script, "script_get_number_of_hero_centers", "$g_talk_troop"),
  ##                                 (eq, reg0, 0), #he has no castles or towns
  ##                                 (hero_can_join),
  ##                             ],
  ##   "I need capable men like you. Will you join me?", "knight_offer_join",[
  ##       ]],
  
  [anyone|plyr,"merchant_talk_offer_2", [], "Nothing. Forget it", "merchant_pretalk",[]],
  
  [anyone|plyr,"merchant_talk", [(check_quest_active, "qst_track_down_bandits"),
      ], "I am hunting a group of bandits with the following description... Have you seen them?", "merchant_bandit_information",[]],
  [anyone,"merchant_bandit_information", [
      (call_script, "script_get_manhunt_information_to_s15", "qst_track_down_bandits"),
      ], "{s15}", "merchant_pretalk",[]],
  
  
  [anyone|plyr,"merchant_talk", [(eq,"$talk_context", tc_party_encounter), #TODO: For the moment don't let attacking if merchant has paid toll.
      ], "Tell me about your journey", "merchant_trip_explanation",[]],
  
  [anyone, "merchant_trip_explanation", [
      (party_get_slot, ":origin", "$g_encountered_party", slot_party_last_traded_center),
      (party_get_slot, ":destination", "$g_encountered_party", slot_party_ai_object),
      (str_store_party_name, s11, ":origin"),
      (str_store_party_name, s12, ":destination"),
      
      (str_store_string, s14, "str___we_believe_that_there_is_money_to_be_made_selling_"),
      (store_sub, ":item_to_price_slot", slot_town_trade_good_prices_begin, trade_goods_begin),
      (assign, ":at_least_one_item_found", 0),
      (try_for_range, ":cur_goods", trade_goods_begin, trade_goods_end),
        (store_add, ":cur_goods_price_slot", ":cur_goods", ":item_to_price_slot"),
        (party_get_slot, ":origin_price", ":origin", ":cur_goods_price_slot"),
        (party_get_slot, ":destination_price", ":destination", ":cur_goods_price_slot"),
        
        (gt, ":destination_price", ":origin_price"),
        (store_sub, ":price_dif", ":destination_price", ":origin_price"),
        
        (gt, ":price_dif", 200),
        (str_store_item_name, s15, ":cur_goods"),
        (str_store_string, s14, "str_s14s15_"),
        
        (assign, ":at_least_one_item_found", 1),
      (try_end),
      
      (try_begin),
        (eq, ":at_least_one_item_found", 0),
        (str_store_string, s14, "str__we_carry_a_selection_of_goods_although_the_difference_in_prices_for_each_is_not_so_great_we_hope_to_make_a_profit_off_of_the_whole"),
      (else_try),
        (str_store_string, s14, "str_s14and_other_goods"),
        
      (try_end),
      
      ], "We are coming from {s11} and heading to {s12}.{s14}", "merchant_pretalk", []],
  
  
  
  [anyone|plyr,"merchant_talk", [(eq,"$talk_context", tc_party_encounter), #TODO: For the moment don't let attacking if merchant has paid toll.
      (neg|party_slot_ge, "$g_encountered_party", slot_party_last_toll_paid_hours, "$g_current_hours"),
      ], "I demand something from you!", "merchant_demand",[]],
  [anyone,"merchant_demand", [(eq,"$talk_context", tc_party_encounter)], "What do you want?", "merchant_demand_2",[]],
  
  [anyone|plyr,"merchant_demand_2", [(neq,"$g_encountered_party_faction","$players_kingdom")], "There is a toll for free passage here!", "merchant_demand_toll",[]],
  
  [anyone,"merchant_demand_toll", [(gt, "$g_strength_ratio", 70),
      (store_div, reg6, "$g_ally_strength", 2),
      (val_add, reg6, 40),
      (assign, "$temp", reg6),
      ], "Please, I don't want any trouble. I can give you {reg6} denars, just let us go.", "merchant_demand_toll_2",[]],
  [anyone,"merchant_demand_toll", [(store_div, reg6, "$g_ally_strength", 4),
      (val_add, reg6, 10),
      (assign, "$temp", reg6),
      ], "I don't want any trouble. I can give you {reg6} denars if you'll let us go.", "merchant_demand_toll_2",[]],
  
  [anyone|plyr,"merchant_demand_toll_2", [], "Agreed, hand it over and you may go in peace.", "merchant_demand_toll_accept",[]],
  [anyone,"merchant_demand_toll_accept", [(assign, reg6, "$temp")], "Very well then. Here's {reg6} denars. ", "close_window",
    [(assign, "$g_leave_encounter",1),
      (call_script, "script_troop_add_gold", "trp_player", "$temp"),
      (store_add, ":toll_finish_time", "$g_current_hours", merchant_toll_duration),
      (party_set_slot, "$g_encountered_party", slot_party_last_toll_paid_hours, ":toll_finish_time"),
      (try_begin),
        (ge, "$g_encountered_party_relation", -5),
        (store_relation,":rel", "$g_encountered_party_faction","fac_player_supporters_faction"),
        (try_begin),
          (gt, ":rel", 0),
          (val_sub, ":rel", 1),
        (try_end),
        (val_sub, ":rel", 1),
        (call_script, "script_set_player_relation_with_faction", "$g_encountered_party_faction", ":rel"),
      (try_end),
      ### Troop commentaries changes begin
      (call_script, "script_add_log_entry", logent_caravan_accosted, "trp_player",  -1, -1, "$g_encountered_party_faction"),
      ### Troop commentaries changes end
      (assign, reg6, "$temp"),
  ]],
  
  [anyone|plyr,"merchant_demand_toll_2", [], "I changed my mind, I can't take your money.", "merchant_pretalk",[]],
  
  [anyone|plyr,"merchant_demand_toll_2", [], "No, I want everything you have! [Attack]", "merchant_attack",[]],
  
  [anyone|plyr,"merchant_demand_2", [(neq,"$g_encountered_party_faction","$players_kingdom")], "Hand over your gold and valuables now!", "merchant_attack_begin",[]],
  [anyone|plyr,"merchant_demand_2", [], "Nothing. Forget it.", "merchant_pretalk",[]],
  
  
  [anyone,"merchant_attack_begin", [], "Are you robbing us?{s11}", "merchant_attack_verify",[
      (str_clear, s11),
      (try_begin),
        (faction_slot_ge, "$g_encountered_party_faction", slot_faction_truce_days_with_factions_begin, 1),
        (str_store_string, s11, "str__have_you_not_signed_a_truce_with_our_lord"),
      (try_end),
  ]],
  [anyone|plyr,"merchant_attack_verify", [], "Robbing you? No, no! It was a joke.", "merchant_attack_verify_norob",[]],
  [anyone,"merchant_attack_verify_norob", [], "God, don't joke about that, {lad/lass}. For a moment I thought we were in real trouble.", "close_window",[(assign, "$g_leave_encounter",1)]],
  [anyone|plyr,"merchant_attack_verify", [], "Of course I'm robbing you. Now hand over your goods.", "merchant_attack",[
      (call_script, "script_diplomacy_party_attacks_neutral", "p_main_party", "$g_encountered_party"),
  ]],
  
  [anyone,"merchant_attack", [], "Damn you, you won't get anything from us without a fight!", "close_window",
    [(store_relation,":rel", "$g_encountered_party_faction","fac_player_supporters_faction"),
      (try_begin),
        (gt, ":rel", 0),
        (val_sub, ":rel", 10),
      (try_end),
      (val_sub, ":rel", 5),
      (call_script, "script_set_player_relation_with_faction", "$g_encountered_party_faction", ":rel"),
      ### Troop commentaries changes begin
      (call_script, "script_diplomacy_party_attacks_neutral", "p_main_party", "$g_encountered_party"),
      ### Troop commentaries changes end
  ]],
  
  [anyone,"caravan_offer_protection", [],
    "These roads are dangerous indeed. One can never have enough protection.", "caravan_offer_protection_2",
    [(get_party_ai_object,":caravan_destination","$g_encountered_party"),
      (store_distance_to_party_from_party, "$caravan_distance_to_target",":caravan_destination","$g_encountered_party"),
      (assign,"$caravan_escort_offer","$caravan_distance_to_target"),
      (val_sub, "$caravan_escort_offer", 10),
      (call_script, "script_party_calculate_strength", "p_main_party",0),
      (assign, ":player_strength", reg0),
      (val_min, ":player_strength", 200),
      (val_add, ":player_strength", 20),
      (val_mul,"$caravan_escort_offer",":player_strength"),
      (val_div,"$caravan_escort_offer",50),
      (val_max, "$caravan_escort_offer", 5),
  ]],
  [anyone,"caravan_offer_protection_2", [[lt,"$caravan_distance_to_target",10]],
    "An escort? We're almost there already! Thank you for the offer, though.", "close_window",[(assign, "$g_leave_encounter",1)]],
  [anyone,"caravan_offer_protection_2", [(get_party_ai_object,":caravan_destination","$g_encountered_party"),
      (str_store_party_name,1,":caravan_destination"),
      (assign,reg(2),"$caravan_escort_offer")],
    "We are heading to {s1}. I will pay you {reg2} denars if you escort us there.", "caravan_offer_protection_3",
    []],
  [anyone|plyr,"caravan_offer_protection_3", [],
    "Agreed.", "caravan_offer_protection_4",[]],
  [anyone,"caravan_offer_protection_4", [],
    "I want you to stay close to us along the way. " +
    "We'll need your help if we get ambushed by bandits.", "caravan_offer_protection_5",[]],
  [anyone|plyr,"caravan_offer_protection_5", [],
    "Don't worry, you can trust me.", "caravan_offer_protection_6",[]],
  [anyone,"caravan_offer_protection_6", [(get_party_ai_object,":caravan_destination","$g_encountered_party"),
      (str_store_party_name,1,":caravan_destination")],
    "Good. Come and collect your money when we're within sight of {s1}. For now, let's just get underway.", "close_window",
    [(get_party_ai_object,":caravan_destination","$g_encountered_party"),
      (assign, "$caravan_escort_destination_town", ":caravan_destination"),
      (assign, "$caravan_escort_party_id", "$g_encountered_party"),
      (assign, "$caravan_escort_agreed_reward", "$caravan_escort_offer"),
      (assign, "$caravan_escort_state", 1),
      (assign, "$g_leave_encounter",1)
  ]],
  [anyone|plyr,"caravan_offer_protection_3", [],
    "Forget it.", "caravan_offer_protection_4b",[]],
  [anyone,"caravan_offer_protection_4b", [],
    "Perhaps another time, then.", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  [anyone|plyr,"merchant_talk", [(eq,"$talk_context", tc_party_encounter),(lt, "$g_talk_troop_faction_relation", 0)],
    "Not so fast. First, hand over all your goods and money.", "talk_caravan_enemy_2",[]],
  
  [anyone,"talk_caravan_enemy_2", [],
    "Never. It is our duty to protect these goods. You shall have to fight us, brigand!", "close_window",
    [
      (store_relation,":rel","$g_encountered_party_faction","fac_player_supporters_faction"),
      (val_min,":rel",0),
      (val_sub,":rel",4),
      (call_script, "script_set_player_relation_with_faction", "$g_encountered_party_faction", ":rel"),
      (call_script, "script_diplomacy_party_attacks_neutral", "p_main_party", "$g_encountered_party"),
  ]],
  
  [anyone|plyr,"merchant_talk", [], "[Leave]", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  #1429 CARAVANE
  [anyone|plyr,"merchant_talk", [], "Qu'avez vous d'interessant a vendre dans votre cargaison ?", "merchant_vend_caravaane",[]],
  
  [anyone,"merchant_vend_caravaane", [],"Regardez,et fesons vite Messire...a cause des brigands.", "merchant_pretalk",[[change_screen_trade]]],
  #
  
  
  # Prison Guards
  [anyone,"start", [(eq, "$talk_context", 0),(faction_slot_eq, "$g_encountered_party_faction", slot_faction_prison_guard_troop, "$g_talk_troop"),
      (this_or_next|eq, "$g_encountered_party_faction", "fac_player_supporters_faction"),
      (             party_slot_eq, "$g_encountered_party", slot_town_lord, "trp_player")
    ],
    "Good day, my {lord/lady}. Will you be visiting the prison?", "prison_guard_players",[]],
  [anyone|plyr,"prison_guard_players", [],
    "Yes. Unlock the door.", "close_window",[(call_script, "script_enter_dungeon", "$current_town", "mt_visit_town_castle")]],
  [anyone|plyr,"prison_guard_players", [],
    "No, not now.", "close_window",[]],
  
  [anyone,"start", [(eq, "$talk_context", 0),(faction_slot_eq, "$g_encountered_party_faction", slot_faction_prison_guard_troop, "$g_talk_troop")],
    "Yes? What do you want?", "prison_guard_talk",[]],
  
  [anyone|plyr,"prison_guard_talk", [],
    "Who is imprisoned here?", "prison_guard_ask_prisoners",[]],
  [anyone|plyr,"prison_guard_talk", [],
    "I want to speak with a prisoner.", "prison_guard_visit_prison",[]],
  
  [anyone,"prison_guard_ask_prisoners", [],
    "Currently, {s50} {reg1?are:is} imprisoned here.{s49}","prison_guard_talk",[
      (party_clear, "p_temp_party"),
      (party_clear, "p_temp_party_2"),
      (assign, ":num_heroes_in_dungeon", 0),
      (assign, ":num_heroes_given_parole", 0),
      
      (party_get_num_prisoner_stacks, ":num_stacks","$g_encountered_party"),
      (try_for_range, ":i_stack", 0, ":num_stacks"),
        (party_prisoner_stack_get_troop_id, ":stack_troop","$g_encountered_party",":i_stack"),
        (troop_is_hero, ":stack_troop"),
        (try_begin),
          (call_script, "script_cf_prisoner_offered_parole", ":stack_troop"),
          (party_add_members, "p_temp_party_2", ":stack_troop", 1),
          (val_add, ":num_heroes_given_parole", 1),
        (else_try),
          (party_add_members, "p_temp_party", ":stack_troop", 1),
          (val_add, ":num_heroes_in_dungeon", 1),
        (try_end),
      (try_end),
      (call_script, "script_print_party_members", "p_temp_party"),
      (str_store_string, s50, "str_s51"),
      (try_begin),
        (gt, ":num_heroes_in_dungeon", 1),
        (assign, reg1, 1),
      (else_try),
        (assign, reg1, 0),
      (try_end),
      
      (str_clear, s49),
      (try_begin),
        (ge, ":num_heroes_given_parole", 1),
        (call_script, "script_print_party_members", "p_temp_party_2"),
        (try_begin),
          (ge, ":num_heroes_given_parole", 2),
          (assign, reg2, 1),
        (else_try),
          (assign, reg2, 0),
        (try_end),
        (str_store_string, s49, "str__meanwhile_s51_reg2areis_being_held_in_the_castle_but_reg2havehas_made_pledges_not_to_escape_and_reg2areis_being_held_in_more_comfortable_quarters" ), #somewhat awkward wording prevents both gender and singular/plural pronoun issues
      (try_end)
      
      
  ]],
  
  [anyone,"prison_guard_visit_prison",
    [
      (this_or_next|faction_slot_eq, "$g_encountered_party_faction", slot_faction_marshall, "trp_player"),
      (this_or_next|party_slot_eq, "$g_encountered_party", slot_town_lord, "trp_player"),
      (eq, "$g_encountered_party_faction", "$players_kingdom"),
    ],
    "Of course, {sir/madam}. Go in.", "close_window",
    [
      (call_script, "script_enter_dungeon", "$current_town", "mt_visit_town_castle")
  ]],
  
  [anyone, "prison_guard_visit_prison",
    [
      #below condition is added by ozan, please lets discuss if it is needed or not. But I think this condition is needed because if there is nobody in prison
      #prison guard should not say you need to get permission, or take me money ext to let player go inside.
      (assign, ":num_heroes_in_dungeon", 0),
      (party_get_num_prisoner_stacks, ":num_stacks", "$g_encountered_party"),
      (assign, ":end_condition", ":num_stacks"),
      (try_for_range, ":i_stack", 0, ":end_condition"),
        (party_prisoner_stack_get_troop_id, ":stack_troop","$g_encountered_party",":i_stack"),
        (troop_is_hero, ":stack_troop"),
        (try_begin),
          (call_script, "script_cf_prisoner_offered_parole", ":stack_troop"),
        (else_try),
          (val_add, ":num_heroes_in_dungeon", 1),
          (assign, ":end_condition", 0),
        (try_end),
      (try_end),
      
      (ge, ":num_heroes_in_dungeon", 1),
    ],
    "You need to get permission from the lord to talk to prisoners.", "prison_guard_visit_prison_2",[]],
  
  [anyone, "prison_guard_visit_prison", [], "There is nobody inside, therefore you can freely go inside and look around.", "prison_guard_visit_prison_nobody", []],
  
  [anyone|plyr,"prison_guard_visit_prison_nobody", [], "All right then. I'll take a look at the prison.", "close_window",
    [
      (call_script, "script_enter_dungeon", "$current_town", "mt_visit_town_castle"),
  ]],
  
  [anyone|plyr,"prison_guard_visit_prison_nobody", [], "I have more important business to do.", "close_window",[]],
  
  [anyone|plyr,"prison_guard_visit_prison_2", [], "All right then. I'll try that.", "close_window",[]],
  [anyone|plyr,"prison_guard_visit_prison_2", [], "Come on now. I thought you were the boss here.", "prison_guard_visit_prison_3",[]],
  [anyone,"prison_guard_visit_prison_3", [], "He-heh. You got that right. Still, I can't let you into the prison.", "prison_guard_visit_prison_4",[]],
  
  [anyone|plyr,"prison_guard_visit_prison_4", [], "All right then. I'll leave now.", "close_window",[]],
  [anyone|plyr,"prison_guard_visit_prison_4", [(store_troop_gold,":gold","trp_player"),(ge,":gold",100)],
    "I found a purse with 100 denars a few paces away. I reckon it belongs to you.", "prison_guard_visit_prison_5",[]],
  
  [anyone,"prison_guard_visit_prison_5", [], "Ah! I was looking for this all day. How good of you to bring it back {sir/madam}. " +
    "Well, now that I know what an honest {man/lady} you are, there can be no harm in letting you inside for a look. Go in.... Just so you know, though -- I'll be hanging onto the keys, in case you were thinking about undoing anyone's chains.", "close_window",
    [(troop_remove_gold, "trp_player",100),(call_script, "script_enter_dungeon", "$current_town", "mt_visit_town_castle")]],
  
  [anyone|plyr,"prison_guard_visit_prison_4", [],
    "Give me the keys to the cells -- now!", "prison_guard_visit_break",[
  ]],
  
  [anyone,"prison_guard_visit_break", [], "Help! Help! Prison break!", "close_window",[
      (call_script, "script_activate_town_guard"),
      (assign, "$g_main_attacker_agent", "$g_talk_agent"),
      (assign, "$talk_context", tc_prison_break),
      #  (try_begin),
      #		(store_relation, ":relation", "fac_player_faction", "$g_encountered_party_faction"),
      #	Reduce relation with town
      # (try_end),
      
      (assign, ":end_cond", kingdom_ladies_end),
      (try_for_range, ":prisoner", active_npcs_begin, ":end_cond"),
        (troop_set_slot, ":prisoner", slot_troop_mission_participation, 0), #new
      (try_end),
  ]],
  
  
  [anyone|plyr,"prison_guard_talk", [],
    "Never mind.", "close_window",[]],
  
  
  
  
  # Castle Guards
  [anyone,"start", [(eq, "$talk_context", 0),(faction_slot_eq, "$g_encountered_party_faction", slot_faction_castle_guard_troop, "$g_talk_troop"),
      (this_or_next|eq, "$g_encountered_party_faction", "fac_player_supporters_faction"),
      (             party_slot_eq, "$g_encountered_party", slot_town_lord, "trp_player")
    ],
    "Your orders, {Lord/Lady}?", "castle_guard_players",[]],
  [anyone|plyr,"castle_guard_players", [],
    "Open the door. I'll go in.", "close_window",[(call_script, "script_enter_court", "$current_town")]],
  [anyone|plyr,"castle_guard_players", [],
    "Never mind.", "close_window",[]],
  
  
  [anyone,"start", [(eq, "$talk_context", 0),(faction_slot_eq, "$g_encountered_party_faction", slot_faction_castle_guard_troop, "$g_talk_troop"),(eq, "$sneaked_into_town",1),
      (gt,"$g_time_since_last_talk",0)],
    "Get out of my sight, beggar! You stink!", "castle_guard_sneaked_intro_1",[]],
  [anyone,"start", [(eq, "$talk_context", 0),(faction_slot_eq, "$g_encountered_party_faction", slot_faction_castle_guard_troop, "$g_talk_troop"),(eq, "$sneaked_into_town",1)],
    "Get lost before I lose my temper you vile beggar!", "close_window",[]],
  [anyone|plyr,"castle_guard_sneaked_intro_1", [], "I want to enter the hall and speak to the lord.", "castle_guard_sneaked_intro_2",[]],
  [anyone|plyr,"castle_guard_sneaked_intro_1", [], "[Leave]", "close_window",[]],
  [anyone,"castle_guard_sneaked_intro_2", [], "Are you out of your mind, {man/woman}? " +
    "Beggars are not allowed into the hall. Now get lost or I'll beat you bloody.", "close_window",[]],
  
  
  [anyone,"start", [(eq, "$talk_context", 0),(faction_slot_eq, "$g_encountered_party_faction", slot_faction_castle_guard_troop, "$g_talk_troop")],
    "What do you want?", "castle_guard_intro_1",[]],
  [anyone|plyr,"castle_guard_intro_1", [],
    "I want to enter the hall and speak to the lord.", "castle_guard_intro_2",[]],
  [anyone|plyr,"castle_guard_intro_1", [],
    "Never mind.", "close_window",[]],
  
  [anyone,"castle_guard_intro_2", [
      (faction_slot_eq, "$g_encountered_party_faction", slot_faction_ai_state, sfai_feast),
      (faction_slot_eq, "$g_encountered_party_faction", slot_faction_ai_object, "$current_town"),
      
      (this_or_next|neq, "$players_kingdom", "$g_encountered_party_faction"),
      (neg|troop_slot_ge, "trp_player", slot_troop_renown, 50),
      
      (neg|troop_slot_ge, "trp_player", slot_troop_renown, 125),
      (neq, "$g_player_eligible_feast_center_no", "$current_town"),
      
      (neg|check_quest_active, "qst_wed_betrothed"),
      (neg|check_quest_active, "qst_wed_betrothed_female"),
      
      (neg|troop_slot_ge, "trp_player", slot_troop_spouse, 1), #Married players always make the cut
      
    ], "I'm afraid there is a feast in progress, and you are not invited.", "close_window",
    []],
  
  
  [anyone,"castle_guard_intro_2", [], "You can go in after leaving your weapons with me. No one is allowed to carry arms into the lord's hall.", "castle_guard_intro_3",
    []],
  
  [anyone|plyr,"castle_guard_intro_3", [], "Here, take my arms. I'll go in.", "close_window", [(call_script, "script_enter_court", "$current_town")]],
  
  [anyone|plyr,"castle_guard_intro_3", [], "No, I give my arms to no one.", "castle_guard_intro_2b", []],
  [anyone,"castle_guard_intro_2b", [], "Then you can't go in.", "close_window", []],
  
  ##  [anyone|plyr,"castle_guard_intro_1", [],
  ##   "Never mind.", "close_window",[]],
  ##  [anyone,"castle_guard_intro_2", [],
  ##   "Does the lord expect you?", "castle_guard_intro_3",[]],
  ##  [anyone|plyr,"castle_guard_intro_3", [], "Yes.", "castle_guard_intro_check",[]],
  ##  [anyone|plyr,"castle_guard_intro_3", [], "No.", "castle_guard_intro_no",[]],
  ##  [anyone,"castle_guard_intro_check", [], "Hmm. All right {sir/madam}.\
  ## You can go in. But you must leave your weapons with me. Noone's allowed into the court with weapons.", "close_window",[]],
  ##  [anyone,"castle_guard_intro_check", [], "You liar!\
  ## Our lord would have no business with a filthy vagabond like you. Get lost now before I kick your butt.", "close_window",[]],
  ##  [anyone,"castle_guard_intro_no", [], "Well... What business do you have here then?", "castle_guard_intro_4",[]],
  ##  [anyone|plyr,"castle_guard_intro_4", [], "I wish to present the lord some gifts.", "castle_guard_intro_gifts",[]],
  ##  [anyone|plyr,"castle_guard_intro_4", [], "I have an important matter to discuss with the lord. Make way now.", "castle_guard_intro_check",[]],
  ##  [anyone,"castle_guard_intro_gifts", [], "Really? What gifts?", "castle_guard_intro_5",[]],
  ##  [anyone|plyr,"castle_guard_intro_4", [], "Many gifts. For example, I have a gift of 20 denars here for his loyal servants.", "castle_guard_intro_gifts",[]],
  ##  [anyone|plyr,"castle_guard_intro_4", [], "My gifts are of no concern to you. They are for your lords and ladies..", "castle_guard_intro_check",[]],
  ##  [anyone,"castle_guard_intro_gifts", [], "Oh! you can give those 20 denars to me. I can distribute them for you.\
  ## You can enter the court and present your gifts to the lord. I'm sure he'll be pleased.\
  ## But you must leave your weapons with me. Noone's allowed into the court with weapons.", "close_window",[]],
  
  #Kingdom Parties
  #  [anyone,"start", [(this_or_next|eq,"$g_encountered_party_template","pt_swadian_foragers"),
  #                    (eq,"$g_encountered_party_template","pt_vaegir_foragers"),
  ##  [anyone,"start", [(this_or_next|party_slot_eq,"$g_encountered_party",slot_party_type, spt_forager),
  ##                    (this_or_next|party_slot_eq,"$g_encountered_party",slot_party_type, spt_scout),
  ##                    (party_slot_eq,"$g_encountered_party",slot_party_type, spt_patrol),
  ##                    (str_store_faction_name,5,"$g_encountered_party_faction")],
  ##   "In the name of the {s5}.", "kingdom_party_encounter",[]],
  ##
  ##  [anyone,"kingdom_party_encounter", [(le,"$g_encountered_party_relation",-10)],
  ##   "Surrender now, and save yourself the indignity of defeat!", "kingdom_party_encounter_war",[]],
  ##  [anyone|plyr,"kingdom_party_encounter_war", [],  "[Go to Battle]", "close_window",[(encounter_attack)]],
  ##
  ##  [anyone,"kingdom_party_encounter", [(ge,"$g_encountered_party_relation",10)],
  ##   "Greetings, fellow warrior.", "close_window",[(eq,"$talk_context",tc_party_encounter),(assign, "$g_leave_encounter", 1)]],
  ##
  ##  [anyone,"kingdom_party_encounter", [],
  ##   "You can go.", "close_window",[]],
  
  
  
  
  
  
  
  
  #Player Parties
  ##  [party_tpl|pt_old_garrison,"start", [],
  ##   "They told us to leave the castle to the new garrison {sir/madam}. So we left and came to rejoin you.", "player_old_garrison_encounter",[]],
  ##
  ##  [anyone|plyr,"player_old_garrison_encounter", [(party_can_join)],
  ##   "You have done well. You'll join my command now.", "close_window",[(assign, "$g_move_heroes", 1),
  ##                                        (call_script, "script_party_add_party", "p_main_party", "$g_encountered_party"),
  ##                                        (remove_party, "$g_encountered_party"),
  ##                                        (assign, "$g_leave_encounter", 1)]],
  ##  [anyone|plyr,"player_old_garrison_encounter", [(assign, reg1, 0),
  ##                                                 (try_begin),
  ##                                                   (neg|party_can_join),
  ##                                                   (assign, reg1, 1),
  ##                                                 (try_end)],
  ##   "You can't join us now{reg1?, I can't command all the lot of you:}. Follow our lead.", "close_window",[(party_set_ai_behavior, "$g_encountered_party", ai_bhvr_attack_party),
  ##                                                                         (party_set_ai_object, "$g_encountered_party", "p_main_party"),
  ##                                                                         (party_set_flags, "$g_encountered_party", pf_default_behavior, 0),
  ##                                                                         (assign, "$g_leave_encounter", 1)]],
  ##
  ##  [anyone|plyr,"player_old_garrison_encounter", [(assign, reg1, 0),
  ##                                                 (try_begin),
  ##                                                   (neg|party_can_join),
  ##                                                   (assign, reg1, 1),
  ##                                                 (try_end)],
  ##   "You can't join us now{reg1?, I can't command all the lot of you:}. Stay here and wait for me.", "close_window",[
  ##       (party_set_ai_behavior, "$g_encountered_party", ai_bhvr_travel_to_point),
  ##       (party_get_position, pos1, "$g_encountered_party"),
  ##       (party_set_ai_target_position, "$g_encountered_party", pos1),
  ##       (party_set_flags, "$g_encountered_party", pf_default_behavior, 0),
  ##       (assign, "$g_leave_encounter", 1)]],
  ##
  
  
  
  
  
  
  [anyone,"start", [(eq, "$talk_context", tc_castle_gate)],
    "What do you want?", "castle_gate_guard_talk",[]],
  
  [anyone,"castle_gate_guard_pretalk", [],
    "Yes?", "castle_gate_guard_talk",[]],
  
  [anyone|plyr,"castle_gate_guard_talk", [(ge, "$g_encountered_party_relation", 0)],
    "We need shelter for the night. Will you let us in?", "castle_gate_open",[]],
  [anyone|plyr,"castle_gate_guard_talk", [(party_slot_ge, "$g_encountered_party", slot_town_lord, 1)], "I want to speak with the lord of the castle.", "request_meeting_castle_lord",[]],
  [anyone|plyr,"castle_gate_guard_talk", [], "I want to speak with someone in the castle.", "request_meeting_other",[]],
  
  [anyone|plyr,"castle_gate_guard_talk", [], "[Leave]", "close_window",[]],
  
  [anyone,"request_meeting_castle_lord", [(party_get_slot, ":castle_lord", "$g_encountered_party", slot_town_lord),
      (call_script, "script_get_troop_attached_party", ":castle_lord"),
      (eq, "$g_encountered_party", reg0),
      (str_store_troop_name, s2, ":castle_lord"),
      (assign, "$lord_requested_to_talk_to", ":castle_lord"),
      ],  "Wait here. {s2} will see you.", "close_window",[]],
  
  [anyone,"request_meeting_castle_lord", [],  "My lord is not here now.", "castle_gate_guard_pretalk",[]],
  
  [anyone,"request_meeting_other", [],  "Who is that?", "request_meeting_3",[]],
  
  [anyone|plyr|repeat_for_troops,"request_meeting_3", [(store_repeat_object, ":troop_no"),
      (troop_is_hero, ":troop_no"),
      (troop_slot_eq, ":troop_no", slot_troop_occupation, slto_kingdom_hero),
      (call_script, "script_get_troop_attached_party", ":troop_no"),
      (eq, "$g_encountered_party", reg0),
      (str_store_troop_name, s3, ":troop_no"),
    ],
    "{s3}", "request_meeting_4",[(store_repeat_object, "$lord_requested_to_talk_to")]],
  
  [anyone|plyr,"request_meeting_3", [], "Never mind.", "close_window",[(assign, "$lord_requested_to_talk_to", 0)]],
  
  [anyone,"request_meeting_4", [], "Wait there. I'll send him your request.", "request_meeting_5",[]],
  
  [anyone|plyr,"request_meeting_5", [], "I'm waiting...", "request_meeting_6",[]],
  
  [anyone,"request_meeting_6",
    [
      (call_script, "script_troop_get_player_relation", "$lord_requested_to_talk_to"),
      (assign, ":lord_relation", reg0),
      (gt, ":lord_relation", -20),
      ], "All right. {s2} will talk to you now.", "close_window",[(str_store_troop_name, s2, "$lord_requested_to_talk_to")]],
  
  [anyone,"request_meeting_6", [(str_store_troop_name, s2, "$lord_requested_to_talk_to")], "{s2} says he will not see you. Begone now.", "close_window",[]],
  
  [anyone,"castle_gate_open", [(party_get_slot, ":castle_lord", "$g_encountered_party", slot_town_lord),
      (call_script, "script_get_troop_attached_party", ":castle_lord"),
      (eq, "$g_encountered_party", reg0),
      (ge, "$g_encountered_party_relation", 0),
      (call_script, "script_troop_get_player_relation", ":castle_lord"),
      (assign, ":castle_lord_relation", reg0),
      #(troop_get_slot, ":castle_lord_relation", ":castle_lord", slot_troop_player_relation),
      (ge, ":castle_lord_relation", 5),
      (str_store_troop_name, s2, ":castle_lord")
    ],  "My lord {s2} will be happy to see you {sir/madam}. " +
    "Come on in. I am opening the gates for you.", "close_window",[(assign,"$g_permitted_to_center",1)]],
  
  
  [anyone,"castle_gate_open", [(party_get_slot, ":castle_lord", "$g_encountered_party", slot_town_lord),
      (call_script, "script_get_troop_attached_party", ":castle_lord"),
      (neq, "$g_encountered_party", reg0),
      (ge, "$g_encountered_party_relation", 0),
      (call_script, "script_troop_get_player_relation", ":castle_lord"),
      (assign, ":castle_lord_relation", reg0),
      #(troop_get_slot, ":castle_lord_relation", ":castle_lord", slot_troop_player_relation),
      (ge, ":castle_lord_relation", 5),
      (str_store_troop_name, s2, ":castle_lord")
    ],  "My lord {s2} is not in the castle now. " +
    "But I think he would approve of you taking shelter here. " +
    "Come on in. I am opening the gates for you.", "close_window",[(assign,"$g_permitted_to_center",1)]],
  
  [anyone,"castle_gate_open", [(party_get_slot, ":castle_lord", "$g_encountered_party", slot_town_lord),
      (call_script, "script_troop_get_player_relation", ":castle_lord"),
      (assign, ":castle_lord_relation", reg0),
      #(troop_get_slot, ":castle_lord_relation", ":castle_lord", slot_troop_player_relation),
      (ge, ":castle_lord_relation", -2),
      ],  "Come on in. I am opening the gates for you.", "close_window",[(assign,"$g_permitted_to_center",1)]],
  
  [anyone,"castle_gate_open", [(party_get_slot, ":castle_lord", "$g_encountered_party", slot_town_lord),
      (call_script, "script_troop_get_player_relation", ":castle_lord"),
      (assign, ":castle_lord_relation", reg0),
      #(troop_get_slot, ":castle_lord_relation", ":castle_lord", slot_troop_player_relation),
      (ge, ":castle_lord_relation", -19),
      (str_store_troop_name, s2, ":castle_lord")
    ],  "Come on in. But make sure your men behave sensibly within the walls. " +
    "My lord {s2} does not want trouble here.", "close_window",[(assign,"$g_permitted_to_center",1)]],
  
  [anyone,"castle_gate_open", [(party_get_slot, ":castle_lord", "$g_encountered_party", slot_town_lord),
      (str_store_troop_name, s2, ":castle_lord"),
      ],  "My lord {s2} does not want you here. Begone now.", "close_window",[]],
  
  
  #Enemy Kingdom Meetings
  
  
  #  [anyone,"start", [(eq, "$talk_context", tc_lord_talk_in_center)],
  #   "Greetings {playername}.", "request_meeting_1",[]],
  
  #  [anyone,"request_meeting_pretalk", [(eq, "$talk_context", tc_lord_talk_in_center)],
  #   "Yes?", "request_meeting_1",[]],
  
  #  [anyone|plyr,"request_meeting_1", [(ge, "$g_encountered_party_faction", 0)], "Open the gates and let me in!", "request_meeting_open_gates",[]],
  
  #  [anyone|plyr,"request_meeting_1", [(party_slot_ge, "$g_encountered_party", slot_town_lord, 1)], "I want to speak with the lord of the castle.", "request_meeting_castle_lord",[]],
  #  [anyone|plyr,"request_meeting_1", [], "I want to speak with someone in the castle.", "request_meeting_other",[]],
  
  ##### TODO: QUESTS COMMENT OUT BEGIN
  ##  [anyone|plyr,"request_meeting_1",[(check_quest_active,"qst_bring_prisoners_to_enemy"),
  ##                                    (neg|check_quest_succeeded, "qst_bring_prisoners_to_enemy"),
  ##                                    (quest_get_slot, ":quest_giver_troop", "qst_bring_prisoners_to_enemy", slot_quest_giver_troop),
  ##                                    (quest_get_slot, ":quest_target_amount", "qst_bring_prisoners_to_enemy", slot_quest_target_amount),
  ##                                    (quest_get_slot, ":quest_object_troop", "qst_bring_prisoners_to_enemy", slot_quest_object_troop),
  ##                                    (quest_slot_eq, "qst_bring_prisoners_to_enemy", slot_quest_target_center, "$g_encountered_party"),
  ##                                    (party_count_prisoners_of_type, ":num_prisoners", "p_main_party", ":quest_object_troop"),
  ##                                    (ge, ":num_prisoners", ":quest_target_amount"),
  ##                                    (str_store_troop_name,1,":quest_giver_troop"),
  ##                                    (assign, reg1, ":quest_target_amount"),
  ##                                    (str_store_troop_name_plural,2,":quest_object_troop")],
  ##   "TODO: Sir, lord {s1} ordered me to bring {reg1} {s2} for ransom.", "guard_prisoners_brought",
  ##   [(quest_get_slot, ":quest_target_amount", "qst_bring_prisoners_to_enemy", slot_quest_target_amount),
  ##    (quest_get_slot, ":quest_target_center", "qst_bring_prisoners_to_enemy", slot_quest_target_center),
  ##    (quest_get_slot, ":quest_object_troop", "qst_bring_prisoners_to_enemy", slot_quest_object_troop),
  ##    (party_remove_prisoners, "p_main_party", ":quest_object_troop", ":quest_target_amount"),
  ##    (party_add_members, ":quest_target_center", ":quest_object_troop", ":quest_target_amount"),
  ##    (call_script, "script_game_get_join_cost", ":quest_object_troop"),
  ##    (assign, ":reward", reg0),
  ##    (val_mul, ":reward", ":quest_target_amount"),
  ##    (val_div, ":reward", 2),
  ##    (call_script, "script_troop_add_gold", "trp_player", ":reward"),
  ##    (party_get_slot, ":cur_lord", "$g_encountered_party", slot_town_lord),#Removing gold from the town owner's wealth
  ##    (troop_get_slot, ":cur_wealth", ":cur_lord", slot_troop_wealth),
  ##    (val_sub, ":cur_wealth", ":reward"),
  ##    (troop_set_slot, ":cur_lord", slot_troop_wealth, ":cur_wealth"),
  ##    (quest_set_slot, "qst_bring_prisoners_to_enemy", slot_quest_target_amount, ":reward"),
  ##    (succeed_quest, "qst_bring_prisoners_to_enemy"),
  ##    ]],
  ##
  ##  [anyone|plyr,"request_meeting_1",[(check_quest_active,"qst_bring_prisoners_to_enemy"),
  ##                                    (neg|check_quest_succeeded, "qst_bring_prisoners_to_enemy"),
  ##                                    (quest_get_slot, ":quest_giver_troop", "qst_bring_prisoners_to_enemy", slot_quest_giver_troop),
  ##                                    (quest_get_slot, ":quest_target_amount", "qst_bring_prisoners_to_enemy", slot_quest_target_amount),
  ##                                    (quest_get_slot, ":quest_object_troop", "qst_bring_prisoners_to_enemy", slot_quest_object_troop),
  ##                                    (quest_slot_eq, "qst_bring_prisoners_to_enemy", slot_quest_target_center, "$g_encountered_party"),
  ##                                    (party_count_prisoners_of_type, ":num_prisoners", "p_main_party", ":quest_object_troop"),
  ##                                    (lt, ":num_prisoners", ":quest_target_amount"),
  ##                                    (gt, ":num_prisoners", 0),
  ##                                    (str_store_troop_name,1,":quest_giver_troop"),
  ##                                    (assign, reg1, ":quest_target_amount"),
  ##                                    (str_store_troop_name_plural,2,":quest_object_troop")],
  ##   "TODO: Sir, lord {s1} ordered me to bring {reg1} {s2} for ransom, but some of them died during my expedition.", "guard_prisoners_brought_some",
  ##   [(quest_get_slot, ":quest_target_amount", "qst_bring_prisoners_to_enemy", slot_quest_target_amount),
  ##    (quest_get_slot, ":quest_target_center", "qst_bring_prisoners_to_enemy", slot_quest_target_center),
  ##    (quest_get_slot, ":quest_object_troop", "qst_bring_prisoners_to_enemy", slot_quest_object_troop),
  ##    (party_count_prisoners_of_type, ":num_prisoners", "p_main_party", ":quest_object_troop"),
  ##    (party_remove_prisoners, "p_main_party", ":quest_object_troop", ":num_prisoners"),
  ##    (party_add_members, ":quest_target_center", ":quest_object_troop", ":num_prisoners"),
  ##    (call_script, "script_game_get_join_cost", ":quest_object_troop"),
  ##    (assign, ":reward", reg0),
  ##    (val_mul, ":reward", ":num_prisoners"),
  ##    (val_div, ":reward", 2),
  ##    (call_script, "script_troop_add_gold", "trp_player", ":reward"),
  ##    (party_get_slot, ":cur_lord", "$g_encountered_party", slot_town_lord),#Removing gold from the town owner's wealth
  ##    (troop_get_slot, ":cur_wealth", ":cur_lord", slot_troop_wealth),
  ##    (val_sub, ":cur_wealth", ":reward"),
  ##    (troop_set_slot, ":cur_lord", slot_troop_wealth, ":cur_wealth"),
  ##    (call_script, "script_game_get_join_cost", ":quest_object_troop"),
  ##    (assign, ":reward", reg0),
  ##    (val_mul, ":reward", ":quest_target_amount"),
  ##    (val_div, ":reward", 2),
  ##    (quest_set_slot, "qst_bring_prisoners_to_enemy", slot_quest_current_state, 1),#Some of the prisoners are given, so it's state will change for remembering that.
  ##    (quest_set_slot, "qst_bring_prisoners_to_enemy", slot_quest_target_amount, ":reward"),#Still needs to pay the lord the full price of the prisoners
  ##    (succeed_quest, "qst_bring_prisoners_to_enemy"),
  ##    ]],
  ##
  ##
  ##  [anyone,"guard_prisoners_brought", [],
  ##   "TODO: Thank you. Here is the money for prisoners.", "request_meeting_pretalk",[]],
  ##
  ##  [anyone,"guard_prisoners_brought_some", [],
  ##   "TODO: Thank you, but that's not enough. Here is the money for prisoners.", "request_meeting_pretalk",[]],
  
  #  [anyone|plyr,"request_meeting_1", [], "[Leave]", "close_window",[]],
  
  
  
  
  
  ##  [anyone,"request_meeting_open_gates", [(party_get_slot, ":castle_lord", "$g_encountered_party", slot_town_lord),
  ##                                         (call_script, "script_get_troop_attached_party", ":castle_lord"),
  ##                                         (eq, "$g_encountered_party", reg0),
  ##                                         (str_store_troop_name, 1, ":castle_lord")
  ##                                         ],  "My lord {s1} is in the castle now. You must ask his permission to enter.", "request_meeting_pretalk",[]],
  ##
  ##  [anyone,"request_meeting_open_gates", [(party_get_slot, ":castle_lord", "$g_encountered_party", slot_town_lord),
  ##                                         (call_script, "script_get_troop_attached_party", ":castle_lord"),
  ##                                         (neq, "$g_encountered_party", reg0),
  ##                                         (ge, "$g_encountered_party_relation", 0),
  ##                                         (troop_get_slot, ":castle_lord_relation", ":castle_lord", slot_troop_player_relation),
  ##                                         (ge, ":castle_lord_relation", 20),
  ##                                         (str_store_troop_name, 1, ":castle_lord")
  ##                                         ],  "My lord {s1} is not in the castle now.\
  ## But I think he would approve of you taking shelter here, {sir/madam}.\
  ## Come on in. I am opening the gates for you.", "close_window",[]],
  ##
  ##  [anyone,"request_meeting_open_gates", [(party_get_slot, ":castle_lord", "$g_encountered_party", slot_town_lord),(str_store_troop_name, 1, ":castle_lord")],
  ##   "My lord {s1} is not in the castle now. I can't allow you into the castle without his orders.", "request_meeting_pretalk",[]],
  
  
  
  
  # Quest conversations
  
  ##### TODO: QUESTS COMMENT OUT BEGIN
  
  ##  [party_tpl|pt_peasant_rebels,"start", [],
  ##   "TODO: What.", "peasant_rebel_talk",[]],
  ##  [anyone|plyr, "peasant_rebel_talk", [], "TODO: Die.", "close_window",[]],
  ##  [anyone|plyr, "peasant_rebel_talk", [], "TODO: Nothing.", "close_window",[(assign, "$g_leave_encounter",1)]],
  ##
  ##  [party_tpl|pt_noble_refugees,"start", [],
  ##   "TODO: What.", "noble_refugee_talk",[]],
  ##  [anyone|plyr, "noble_refugee_talk", [], "TODO: Nothing.", "close_window",[(assign, "$g_leave_encounter",1)]],
  ##
  
  
  [anyone,"start", [(eq,"$talk_context",tc_join_battle_ally),
    ],
    "You have come just in time. Let us join our forces now and teach our enemy a lesson.", "close_window",
    []],
  
  [anyone,"start", [(eq,"$talk_context",tc_join_battle_enemy),
    ],
    "You are making a big mistake by fighting against us.", "close_window",
    []],
  
  [anyone,"start", [(eq,"$talk_context",tc_ally_thanks),
      (troop_is_hero, "$g_talk_troop"),
      (eq, "$g_talk_troop_met", 0),
      (ge, "$g_talk_troop_relation", 17),
    ],
    "I don't think we have met properly my friend. You just saved my life out there, and I still don't know your name...", "ally_thanks_meet", []],
  
  
  [anyone,"start", [(eq,"$talk_context",tc_ally_thanks),
      (troop_is_hero, "$g_talk_troop"),
      (eq, "$g_talk_troop_met", 0),
      (ge, "$g_talk_troop_relation", 5),
      (str_store_troop_name, s1, "$g_talk_troop"),
    ],
    "Your help was most welcome stranger. My name is {s1}. Can I learn yours?", "ally_thanks_meet", []],
  
  [anyone,"start", [(eq,"$talk_context",tc_ally_thanks),
      (troop_is_hero, "$g_talk_troop"),
      (eq, "$g_talk_troop_met", 0),
      (ge, "$g_talk_troop_relation", 0),
      (str_store_troop_name, s1, "$g_talk_troop"),
    ],
    "Thanks for your help, stranger. We haven't met properly yet, have we? What is your name?", "ally_thanks_meet", []],
  
  [anyone|plyr,"ally_thanks_meet", [], "My name is {playername}.", "ally_thanks_meet_2", []],
  
  [anyone, "ally_thanks_meet_2", [(ge, "$g_talk_troop_relation", 15),(str_store_troop_name, s1, "$g_talk_troop")],
    "Well met indeed {playername}. My name is {s1} and I am forever in your debt. If there is ever anything I can help you with, just let me know...", "close_window", []],
  [anyone, "ally_thanks_meet_2", [(ge, "$g_talk_troop_relation", 5),], "Well met {playername}. I am in your debt for what you just did. I hope one day I will find a way to repay it.", "close_window", []],
  [anyone, "ally_thanks_meet_2", [], "Well met {playername}. I am {s1}. Thanks for your help and I hope we meet again.", "close_window", []],
  
  #Post 0907 changes begin
  [anyone,"start", [(eq,"$talk_context",tc_ally_thanks),
      (troop_is_hero, "$g_talk_troop"),
      (ge, "$g_talk_troop_relation", 30),
      (ge, "$g_relation_boost", 10),
    ],
    "Again you save our necks, {playername}! Truly, you are the best of friends. {s43}", "close_window", [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_battle_won_default"),
      (try_begin),
        (party_stack_get_troop_id, ":enemy_party_leader", "p_encountered_party_backup", 0),
        (is_between, ":enemy_party_leader", active_npcs_begin, active_npcs_end),
        (call_script, "script_add_log_entry", logent_lord_helped_by_player, "trp_player",  -1, ":enemy_party_leader", -1),
      (try_end),
  ]],
  
  [anyone,"start", [(eq,"$talk_context",tc_ally_thanks),
      (troop_is_hero, "$g_talk_troop"),
      (ge, "$g_talk_troop_relation", 20),
      (ge, "$g_relation_boost", 5),
    ],
    "You arrived just in the nick of time! {playername}. You have my deepest thanks! {s43}", "close_window", [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_battle_won_default"),
      #       (try_begin),
      #         (party_stack_get_troop_id, ":enemy_party_leader", "p_encountered_party_backup", 0),
      #         (is_between, ":enemy_party_leader", active_npcs_begin, active_npcs_end),
      (call_script, "script_add_log_entry", logent_lord_helped_by_player, "trp_player",  -1, "$g_talk_troop", -1),
      #       (try_end),
  ]],
  
  [anyone,"start", [(eq,"$talk_context",tc_ally_thanks),
      (troop_is_hero, "$g_talk_troop"),
      (ge, "$g_talk_troop_relation", 0),
      (ge, "$g_relation_boost", 3),
    ],
    "You turned up just in time, {playername}. I will not forget your help. {s43}", "close_window", [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_battle_won_default"),
      #       (try_begin),
      #         (party_stack_get_troop_id, ":enemy_party_leader", "p_encountered_party_backup", 0),
      #         (is_between, ":enemy_party_leader", active_npcs_begin, active_npcs_end),
      (call_script, "script_add_log_entry", logent_lord_helped_by_player, "trp_player",  -1, "$g_talk_troop", -1),
      #       (try_end),
  ]],
  
  [anyone,"start", [(eq,"$talk_context",tc_ally_thanks),
      (troop_is_hero, "$g_talk_troop"),
      (ge, "$g_talk_troop_relation", -5),
    ],
    "Good to see you here, {playername}. {s43}", "close_window", [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_battle_won_default"),
      (call_script, "script_troop_change_relation_with_troop", "$g_talk_troop", "trp_player", 1),
  ]],
  
  
  [anyone,"start", [(eq,"$talk_context",tc_ally_thanks),
      (troop_is_hero, "$g_talk_troop"),
      (ge, "$g_relation_boost", 4),
    ],
    "{s43}", "close_window", [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_battle_won_grudging_default"),
  ]],
  
  
  [anyone,"start", [(eq,"$talk_context",tc_ally_thanks),
      (troop_is_hero, "$g_talk_troop"),
    ],
    "{s43}", "close_window", [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_battle_won_unfriendly_default"),
  ]],
  
  
  #  [anyone,"start", [(eq,"$talk_context",tc_ally_thanks),
  #                    (troop_is_hero, "$g_talk_troop"),
  #                    (ge, "$g_talk_troop_relation", -20),
  #                    ],
  #   "So, this is {playername}. Well, your help wasn't really needed, but I guess you had nothing better to do, right?", "close_window", []],
  
  #  [anyone,"start", [(eq,"$talk_context",tc_ally_thanks),
  #                    (troop_is_hero, "$g_talk_troop"),
  #                    ],
  #   "Who told you to come to our help? I certainly didn't. Begone now. I want nothing from you and I will not let you steal my victory.", "close_window", []],
  
  #Post 0907 changes begin
  
  [anyone,"start", [(eq,"$talk_context",tc_ally_thanks),
      (ge, "$g_relation_boost", 10),
      (party_get_num_companions, reg1, "$g_encountered_party"),
      (val_sub, reg1, 1),
    ],
    "Thank you for your help {sir/madam}. You saved {reg1?our lives:my life} out there.", "close_window", []],
  
  [anyone,"start", [(eq,"$talk_context",tc_ally_thanks),
      (ge, "$g_relation_boost", 5),
    ],
    "Thank you for your help {sir/madam}. Things didn't look very well for us but then you came up and everything changed.", "close_window", []],
  
  [anyone,"start", [(eq,"$talk_context",tc_ally_thanks)],
    "Thank you for your help, {sir/madam}. It was fortunate to have you nearby.", "close_window", []],
  
  [anyone,"start", [(eq, "$talk_context", tc_hero_freed),
      (store_conversation_troop,":cur_troop"),
      (eq,":cur_troop","trp_kidnapped_girl"),],
    "Oh {sir/madam}. Thank you so much for rescuing me. Will you take me to my family now?", "kidnapped_girl_liberated_battle",[]],
  
  [anyone,"start", [(eq,"$talk_context",tc_hero_freed)],
    "I am in your debt for freeing me friend.", "freed_hero_answer",
    []],
  
  [anyone|plyr,"freed_hero_answer", [],
    "You're not going anywhere. You'll be my prisoner now!", "freed_hero_answer_1",
    [
      (store_conversation_troop, ":cur_troop_id"),
      (party_add_prisoners, "p_main_party", ":cur_troop_id", 1),#take prisoner
  ]],
  
  [anyone,"freed_hero_answer_1", [],
    "Alas. Will my luck never change?", "close_window",
    []],
  
  [anyone|plyr,"freed_hero_answer", [],
    "You're free to go, {s65}.", "freed_hero_answer_2",
    [
  ]],
  
  [anyone,"freed_hero_answer_2", [],
    "Thank you, good {sire/lady}. I never forget someone who's done me a good turn.", "close_window",
    []],
  
  [anyone|plyr,"freed_hero_answer", [],
    "Would you like to join me?", "freed_hero_answer_3",
    []],
  
  [anyone,"freed_hero_answer_3", [(store_random_in_range, ":random_no",0,2),(eq, ":random_no", 0)],
    "All right I will join you.", "close_window",
    [
      (store_conversation_troop, ":cur_troop_id"),
      (party_add_members, "p_main_party", ":cur_troop_id", 1),#join hero
  ]],
  
  [anyone,"freed_hero_answer_3", [],
    "No, I want to go on my own.", "close_window",
    [
  ]],
  
  [anyone,"start", [(eq,"$talk_context",tc_hero_defeated)],
    "You'll not live long to enjoy your victory. My kinsmen will soon wipe out the stain of this defeat.", "defeat_hero_answer",
    [
  ]],
  
  [anyone|plyr,"defeat_hero_answer", [],
    "You are my prisoner now.", "defeat_hero_answer_1",
    [
      (party_add_prisoners, "p_main_party", "$g_talk_troop", 1),#take prisoner
      #(troop_set_slot, "$g_talk_troop", slot_troop_is_prisoner, 1),
      (troop_set_slot, "$g_talk_troop", slot_troop_prisoner_of_party, "p_main_party"),
      (call_script, "script_event_hero_taken_prisoner_by_player", "$g_talk_troop"),
  ]],
  
  [anyone,"defeat_hero_answer_1", [],
    "Damn you. You will regret this.", "close_window",
    []],
  
  [anyone|plyr,"defeat_hero_answer", [],
    "You're free to go this time, but don't cross my path again.", "defeat_hero_answer_2",
    []],
  
  [anyone,"defeat_hero_answer_2", [],
    "We will meet again.", "close_window",
    []],
  
  
  
  
  [anyone,"combined_political_quests", [
      (eq, "$political_quest_found", "qst_resolve_dispute"),
    ],
    "{s9}", "political_quest_suggested",
    [
      (quest_set_slot, "qst_resolve_dispute", slot_quest_target_troop, "$political_quest_target_troop"),
      (quest_set_slot, "qst_resolve_dispute", slot_quest_object_troop, "$political_quest_object_troop"),
      
      (quest_get_slot, ":target_troop", "qst_resolve_dispute", slot_quest_target_troop),
      (quest_get_slot, ":object_troop", "qst_resolve_dispute", slot_quest_object_troop),
      (str_store_troop_name, s4, ":target_troop"),
      (str_store_troop_name, s5, ":object_troop"),
      (faction_get_slot, ":faction_leader", "$players_kingdom", slot_faction_leader),
      (str_store_troop_name, s7, ":faction_leader"),
      (try_begin),
        (eq, "$players_kingdom", "fac_player_supporters_faction"),
        (faction_slot_eq, "fac_player_supporters_faction", slot_faction_leader, "trp_player"),
        (str_store_string, s9, "str_you_may_be_aware_my_lord_of_the_quarrel_between_s4_and_s5_which_is_damaging_the_unity_of_this_realm_and_sapping_your_authority_if_you_could_persuade_the_lords_to_reconcile_it_would_boost_your_own_standing_however_in_taking_this_on_you_run_the_risk_of_one_the_lords_deciding_that_you_have_taken_the_rivals_side"),
      (else_try),
        (str_store_string, s9, "str_you_may_be_aware_my_lord_of_the_quarrel_between_s4_and_s5_which_is_damaging_the_unity_of_this_realm_and_sapping_your_authority_if_you_could_persuade_the_lords_to_reconcile_i_imagine_that_s7_would_be_most_pleased_however_in_taking_this_on_you_run_the_risk_of_one_the_lords_deciding_that_you_have_taken_the_rivals_side"),
      (try_end),
  ]],
  
  [anyone,"political_quest_follow_on", [
      (eq, "$political_quest_found", "qst_resolve_dispute"),
    ],
    "I think that is a wise move. Good luck to you.", "close_window",
    [
      (assign, "$g_leave_encounter", 1),
      (setup_quest_text,"qst_resolve_dispute"),
      
      (quest_get_slot, ":lord_1", "qst_resolve_dispute", slot_quest_target_troop),
      (str_store_troop_name_link, s11, ":lord_1"),
      
      (quest_get_slot, ":lord_2", "qst_resolve_dispute", slot_quest_object_troop),
      (str_store_troop_name_link, s12, ":lord_2"),
      
      (str_store_string, s2, "str_resolve_the_dispute_between_s11_and_s12"),
      (call_script, "script_start_quest", "qst_resolve_dispute", -1),
      (quest_set_slot, "qst_resolve_dispute", slot_quest_expiration_days, 30),
      (quest_set_slot, "qst_resolve_dispute", slot_quest_giver_troop, "$g_talk_troop"),
      (quest_set_slot, "qst_resolve_dispute", slot_quest_target_state, 0),
      (quest_set_slot, "qst_resolve_dispute", slot_quest_object_state, 0),
      
      (quest_get_slot, ":lord_1", "qst_resolve_dispute", slot_quest_target_troop), #this block just to check if the slots work
      (str_store_troop_name, s11, ":lord_1"),
      (quest_get_slot, ":lord_2", "qst_resolve_dispute", slot_quest_object_troop),
      (str_store_troop_name, s12, ":lord_2"),
    ],
  ],
  
  
  [anyone,"combined_political_quests", [
      
      (eq, "$political_quest_found", "qst_offer_gift"),
      (quest_set_slot, "qst_offer_gift", slot_quest_target_troop, "$political_quest_target_troop"),
      
      (quest_get_slot, ":target_troop", "qst_offer_gift", slot_quest_target_troop),
      (str_store_troop_name, s4, ":target_troop"),
      (troop_get_type, reg4, ":target_troop"),
      (call_script, "script_troop_get_family_relation_to_troop", ":target_troop", "$g_talk_troop"),
      
    ],
    "Your relations with {s4} are not all that they could be. As {reg4?she:he} is my {s11}, I can mediate to attempt to mend your quarrel. Perhaps the best way for me to do this would be to send {reg4?her:him} a gift -- a fur-trimmed velvet robe, perhaps. If you can provide me with a bolt of velvet and a length of furs, I can have one made and sent to {reg4?her:him.}", "political_quest_suggested",
    [
      (quest_get_slot, ":target_troop", "qst_offer_gift", slot_quest_target_troop),
      (troop_get_type, reg4, ":target_troop"),
  ]],
  
  
  
  [anyone,"political_quest_follow_on", [
      (eq, "$political_quest_found", "qst_offer_gift"),
    ],
    "Splendid. I shall await the materials.", "close_window",
    [
      (assign, "$g_leave_encounter", 1),
      (setup_quest_text,"qst_offer_gift"),
      
      (quest_get_slot, ":lord_1", "qst_offer_gift", slot_quest_target_troop),
      (str_store_troop_name, s14, ":lord_1"),
      (str_store_troop_name, s12, "$g_talk_troop"),
      (troop_get_type, reg4, "$g_talk_troop"),
      
      (str_store_string, s2, "str_you_intend_to_bring_gift_for_s14"),
      
      (call_script, "script_start_quest", "qst_offer_gift", "$g_talk_troop"),
      (quest_set_slot, "qst_offer_gift", slot_quest_expiration_days, 30),
  ]],
  
  
  
  
  [anyone,"combined_political_quests", [
      (eq, "$political_quest_found", "qst_denounce_lord"),
      (this_or_next|eq, "$g_talk_troop", "$g_player_minister"),
      (troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop"),
      
      (str_store_troop_name, s4, "$political_quest_target_troop"),
      (troop_get_type, reg4, "$political_quest_target_troop"),
      (str_store_faction_name, s5, "$players_kingdom"),
      
      (troop_get_slot, ":reputation_string", "$political_quest_target_troop", slot_lord_reputation_type),
      (val_add, ":reputation_string", "str_lord_derogatory_default"),
      (str_store_string, s7, ":reputation_string"),
      
      (troop_get_slot, ":reputation_string", "$political_quest_target_troop", slot_lord_reputation_type),
      (val_add, ":reputation_string", "str_lord_derogatory_result"),
      (str_store_string, s8, ":reputation_string"),
      
    ],
    "As you may realize, {s4} has many enemies among the lords of the {s5}. In particular, they feel that {reg4?she:he} is {s7}, and worry that {reg4?she:he} will {s8}. Were you to denounce {s4} to {reg4?her:his} face, you may reap much popularity -- although, of course, you would make an enemy of {reg4?her:him}, and risk being challenged to a duel.", "political_quest_suggested",
    [
  ]],
  
  [anyone,"combined_political_quests", [
      (eq, "$political_quest_found", "qst_denounce_lord"),
      (troop_get_type, reg4, "$political_quest_target_troop"),
      
      (str_clear, s9),
      (call_script, "script_troop_get_relation_with_troop", "trp_player", "$g_talk_troop"),
      (assign, ":player_relation_with_target", reg0),
      
      (str_store_troop_name, s4, "$political_quest_target_troop"),
      (try_begin),
        (ge, ":player_relation_with_target", 2),
        (neg|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_debauched),
        (neg|troop_slot_eq, "$g_talk_troop", slot_lord_reputation_type, lrep_quarrelsome),
        (str_store_string, s9, "str_i_realize_that_you_are_on_good_terms_with_s4_but_we_ask_you_to_do_this_for_the_good_of_the_realm"),
      (else_try),
        (ge, ":player_relation_with_target", 2),
        (str_store_string, s9, "str_i_realize_that_you_are_on_good_terms_with_s4_but_the_blow_will_hurt_him_more"),
      (try_end),
      
      (str_store_faction_name, s5, "$players_kingdom"),
      (str_store_troop_name, s4, "$political_quest_target_troop"),
      
      (troop_get_slot, ":reputation_string", "$political_quest_target_troop", slot_lord_reputation_type),
      (val_add, ":reputation_string", "str_lord_derogatory_default"),
      (str_store_string, s7, ":reputation_string"),
      
      (troop_get_slot, ":reputation_string", "$political_quest_target_troop", slot_lord_reputation_type),
      (val_add, ":reputation_string", "str_lord_derogatory_result"),
      (str_store_string, s8, ":reputation_string"),
      
      
    ],
    
    "As you may realize, many of us in the peerage of the {s5} consider {s4} to be {s7}, and a liability to our cause. We worry that {reg4?she:he} will {s8}. People know my views on {s4} already, but if you were to denounce {reg4?her:him} to {reg4?her:his} face, you would further erode his standing -- and discourage our liege from entrusting {reg4?her:him} with any more power or responsibility. Of course, you would make an enemy of {reg4?her:him}, and risk being challenged to a duel.{s9}", "political_quest_suggested",
    [
      
      
  ]],
  
  
  [anyone,"political_quest_follow_on", [
      (eq, "$political_quest_found", "qst_denounce_lord"),
      (this_or_next|eq, "$g_talk_troop", "$g_player_minister"),
      (troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop"),
    ],
    "We appreciate what you are doing. I find such intrigues distasteful, but it is all for the good of the {s5}.", "close_window",
    [
      (quest_set_slot, "qst_denounce_lord", slot_quest_target_troop, "$political_quest_target_troop"),
      
      (quest_get_slot, ":target_troop", "qst_denounce_lord", slot_quest_target_troop),
      (str_store_troop_name_link, s14, ":target_troop"),
      (str_store_troop_name_link, s12, "$g_talk_troop"),
      
      (str_store_string, s2, "str_you_intend_to_denounce_s14_to_his_face_on_behalf_of_s14"),
      (setup_quest_text, "qst_denounce_lord"),
      
      (call_script, "script_start_quest", "$political_quest_found", "$g_talk_troop"),
      (quest_set_slot, "qst_denounce_lord", slot_quest_expiration_days, 60),
      
      (str_store_faction_name, s5, "$players_kingdom"),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  
  [anyone,"political_quest_follow_on", [
      (eq, "$political_quest_found", "qst_denounce_lord"),
    ],
    "Very well. It is always risky to involve yourself in intrigues of this sort, but in this case, I think you will benefit.", "close_window",
    [
      (quest_set_slot, "qst_denounce_lord", slot_quest_target_troop, "$political_quest_target_troop"),
      
      (quest_get_slot, ":target_troop", "qst_denounce_lord", slot_quest_target_troop),
      (str_store_troop_name_link, s14, ":target_troop"),
      (str_store_troop_name_link, s12, "$g_talk_troop"),
      
      (str_store_string, s2, "str_you_intend_to_denounce_s14_to_his_face_on_behalf_of_s14"),
      (setup_quest_text, "qst_denounce_lord"),
      
      (call_script, "script_start_quest", "$political_quest_found", "$g_talk_troop"),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  
  
  
  [anyone,"combined_political_quests", [
      (eq, "$political_quest_found", "qst_intrigue_against_lord"),
      (str_store_troop_name, s4, "$political_quest_target_troop"),
      (troop_get_type, reg4, "$political_quest_target_troop"),
      (str_store_faction_name, s5, "$players_kingdom"),
      (troop_get_slot, ":reputation_string", "$political_quest_target_troop", slot_lord_reputation_type),
      (val_add, ":reputation_string", "str_lord_derogatory_default"),
      (str_store_string, s7, ":reputation_string"),
      
      (troop_get_slot, ":reputation_string_2", "$political_quest_target_troop", slot_lord_reputation_type),
      (val_add, ":reputation_string_2", "str_lord_derogatory_result"),
      (str_store_string, s8, ":reputation_string_2"),
      
      (faction_get_slot, ":faction_leader", "$players_kingdom", slot_faction_leader),
      (str_store_troop_name, s9, ":faction_leader"),
    ],
    "You and I have a common interest in seeking to curtail the rise of {s4}. I feel that {reg4?she:he} is {s7}, and worry that {reg4?she:he} will {s8}. Were you to tell our liege {s9} your opinion of {s4}, it might discourage {s9} from granting {s4} any further powers or responsibilities, at least for a while, and I would be much obliged to you.", "political_quest_suggested",
    []],
  
  #Intrigue lord for
  [anyone,"political_quest_follow_on", [
      (eq, "$political_quest_found", "qst_intrigue_against_lord"),
      #	(this_or_next|eq, "$g_talk_troop", "$g_player_minister"),
      #		(troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop"),
      (str_store_faction_name, s5, "$players_kingdom"),
      
    ],
    "We appreciate what you are doing. I find such intrigues distasteful, but it is all for the good of the {s5}.", "close_window",
    [
      (quest_set_slot, "qst_intrigue_against_lord", slot_quest_target_troop, "$political_quest_target_troop"),
      
      (quest_get_slot, ":target_troop", "qst_intrigue_against_lord", slot_quest_target_troop),
      (store_faction_of_troop, ":target_troop_faction", ":target_troop"),
      (faction_get_slot, ":faction_liege", ":target_troop_faction", slot_faction_leader),
      (str_store_troop_name_link, s14, ":target_troop"),
      (str_store_troop_name_link, s13, ":faction_liege"),
      (str_store_troop_name_link, s12, "$g_talk_troop"),
      
      (str_store_string, s2, "str_you_intend_to_denounce_s14_to_s13_on_behalf_of_s12"),
      (setup_quest_text, "qst_intrigue_against_lord"),
      
      (call_script, "script_start_quest", "$political_quest_found", "$g_talk_troop"),
      (quest_set_slot, "qst_intrigue_against_lord", slot_quest_expiration_days, 60),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  
  [anyone,"combined_political_quests", [],
    "I cannot think of anything right now, but we will have some items of mutual interest in the future.", "political_quest_suggested",
    []],
  
  [anyone|plyr,"political_quest_suggested", [
      (gt, "$political_quest_found", 0),
    ],
    "I like that idea.", "political_quest_follow_on",
    [
  ]],
  
  [anyone|plyr,"political_quest_suggested", [
      (gt, "$political_quest_found", 0),
    ],
    "Hmm.. Maybe you can think of something else?", "combined_political_quests",
    [
      (quest_set_slot, "$political_quest_found", slot_quest_dont_give_again_remaining_days, 3),
      (call_script, "script_get_political_quest", "$g_talk_troop"),
      (assign, "$political_quest_found", reg0),
      (assign, "$political_quest_target_troop", reg1),
      (assign, "$political_quest_object_troop", reg2),
      
  ]],
  
  [anyone|plyr,"political_quest_suggested", [],
    "Let us discuss another topic", "political_quests_end",
    []],
  
  
  
  
  
  
  
  
  [anyone,"political_quests_end", [
      (troop_slot_eq, "$g_talk_troop", slot_troop_occupation, slto_kingdom_hero),
    ],
    "Very well.", "lord_pretalk",
    []],
  
  [anyone,"political_quests_end", [
      (troop_slot_eq, "trp_player", slot_troop_spouse, "$g_talk_troop"),
    ],
    "Very well.", "spouse_pretalk",
    []],
  
  [anyone,"political_quests_end", [
      (eq, "$g_talk_troop", "$g_player_minister"),
    ],
    "Very well.", "minister_pretalk",
    []],
  
  [anyone,"political_quests_end", [
    ],
    "Very well.", "close_window",
    [
      (assign, "$g_leave_encounter", 1),
  ]],
  
  
  
  
  # Local merchant
  
  [trp_local_merchant,"start", [], "Mercy! Please don't kill me!", "local_merchant_mercy",[]],
  [anyone|plyr,"local_merchant_mercy", [(quest_get_slot, ":quest_giver_troop", "qst_kill_local_merchant", slot_quest_giver_troop),(str_store_troop_name, s2, ":quest_giver_troop")],
    "I have nothing against you man. But {s2} wants you dead. Sorry.", "local_merchant_mercy_no",[]],
  [anyone,"local_merchant_mercy_no", [], "Damn you! May you burn in Hell!", "close_window",[]],
  [anyone|plyr,"local_merchant_mercy", [], "I'll let you live, if you promise me...", "local_merchant_mercy_yes",[]],
  
  [anyone,"local_merchant_mercy_yes", [], "Of course, I promise, I'll do anything. Just spare my life... ", "local_merchant_mercy_yes_2",[]],
  [anyone|plyr,"local_merchant_mercy_yes_2", [], "You are going to forget about {s2}'s debt to you. " +
    "And you will sign a paper stating that he owes you nothing.", "local_merchant_mercy_yes_3",[]],
  [anyone,"local_merchant_mercy_yes_3", [], "Yes, of course. I'll do as you say.", "local_merchant_mercy_yes_4",[]],
  [anyone|plyr,"local_merchant_mercy_yes_4", [], "And if my lord hears so much of a hint of a complaint about this issue, then I'll come back for you, " +
    "and it won't matter how much you scream for mercy then. " +
    "Do you understand me?", "local_merchant_mercy_yes_5",[]],
  [anyone,"local_merchant_mercy_yes_5", [], "Yes {sir/madam}. Don't worry. I won't make any complaint.", "local_merchant_mercy_yes_6",[]],
  [anyone|plyr,"local_merchant_mercy_yes_6", [], "Good. Go now, before I change my mind.", "close_window",
    [(quest_set_slot, "qst_kill_local_merchant", slot_quest_current_state, 2),
      (call_script, "script_succeed_quest", "qst_kill_local_merchant"),
      (finish_mission),
  ]],
  
  # Village traitor
  
  [trp_fugitive,"start", [], "What do you want?", "fugitive_1",[]],
  [trp_fugitive|plyr,"fugitive_1", [
      (quest_get_slot, ":quest_target_dna", "qst_hunt_down_fugitive", slot_quest_target_dna),
      (call_script, "script_get_name_from_dna_to_s50", ":quest_target_dna"),
      (str_store_string, s4, s50),
      ], "I am looking for a murderer by the name of {s4}. You fit his description.", "fugitive_2",[]],
  [trp_fugitive|plyr,"fugitive_1", [], "Nothing. Sorry to trouble you.", "close_window",[]],
  [trp_fugitive,"fugitive_2", [], "I don't understand, {sir/madam}. " +
    "I never killed anyone. I think you've got the wrong man.", "fugitive_3",[]],
  [trp_fugitive|plyr,"fugitive_3", [], "Then drop your sword. If you are innocent, you have nothing to fear. " +
    "We'll go now and talk to your neighbours, and if they verify your story, I'll go on my way.", "fugitive_4",[]],
  [anyone,"fugitive_4", [], "I'm not going anywhere, friend. You're going to have to fight for your silver, today.", "fugitive_5",
    []],
  
  [trp_fugitive|plyr,"fugitive_5", [], "No problem. I really just need your head, anyway.", "fugitive_fight_start",[]],
  [trp_fugitive|plyr,"fugitive_5", [], "I come not for money, but to execute the law!", "fugitive_fight_start",[]],
  [trp_fugitive|plyr,"fugitive_5", [], "Alas, that you cannot be made to see reason.", "fugitive_fight_start",[]],
  
  [anyone,"fugitive_fight_start", [], "Die, dog!", "close_window",
    [
      (set_party_battle_mode),
      (quest_set_slot, "qst_hunt_down_fugitive", slot_quest_current_state, 1),
      (call_script, "script_activate_tavern_attackers"),
  ]],
  
  
  [anyone,"member_chat", [(check_quest_active, "qst_incriminate_loyal_commander"),
      (quest_slot_eq, "qst_incriminate_loyal_commander", slot_quest_current_state, 0),
      (store_conversation_troop, "$g_talk_troop"),
      (eq, "$g_talk_troop", "$incriminate_quest_sacrificed_troop"),
      (quest_get_slot, ":quest_target_center", "qst_incriminate_loyal_commander", slot_quest_target_center),
      (store_distance_to_party_from_party, ":distance", "p_main_party", ":quest_target_center"),
      (lt, ":distance", 10),
      ], "Yes {sir/madam}?", "sacrificed_messenger_1",[]],
  
  [anyone|plyr,"sacrificed_messenger_1", [(quest_get_slot, ":quest_target_center", "qst_incriminate_loyal_commander", slot_quest_target_center),
      (str_store_party_name, s1, ":quest_target_center"),
      (quest_get_slot, ":quest_object_troop", "qst_incriminate_loyal_commander", slot_quest_object_troop),
      (str_store_troop_name, s2, ":quest_object_troop"),],
    "Take this letter to {s1} and give it to {s2}.", "sacrificed_messenger_2",[]],
  [anyone|plyr,"sacrificed_messenger_1", [],
    "Nothing. Nothing at all.", "close_window",[]],
  
  [anyone,"sacrificed_messenger_2", [],
    "Yes {sir/madam}. You can trust me. I will not fail you.", "sacrificed_messenger_3",[]],
  
  [anyone|plyr,"sacrificed_messenger_3", [],
    "Good. I will not forget your service. You will be rewarded when you return.", "close_window",[(party_remove_members, "p_main_party", "$g_talk_troop", 1),
      (set_spawn_radius, 0),
      (spawn_around_party, "p_main_party", "pt_sacrificed_messenger"),
      (assign, ":new_party", reg0),
      (party_add_members, ":new_party", "$g_talk_troop", 1),
      (party_set_ai_behavior, ":new_party", ai_bhvr_travel_to_party),
      (quest_get_slot, ":quest_target_center", "qst_incriminate_loyal_commander", slot_quest_target_center),
      (party_set_ai_object, ":new_party", ":quest_target_center"),
      (party_set_flags, ":new_party", pf_default_behavior, 0),
      (quest_set_slot, "qst_incriminate_loyal_commander", slot_quest_current_state, 2),
      (quest_set_slot, "qst_incriminate_loyal_commander", slot_quest_target_party, ":new_party")]],
  [anyone|plyr,"sacrificed_messenger_3", [], "Arggh! I can't do this. I can't send you to your own death!", "sacrificed_messenger_cancel",[]],
  [anyone,"sacrificed_messenger_cancel", [], "What do you mean {sir/madam}", "sacrificed_messenger_cancel_2",[]],
  [anyone|plyr,"sacrificed_messenger_cancel_2", [(quest_get_slot, ":quest_giver", "qst_incriminate_loyal_commander", slot_quest_giver_troop),
      (str_store_troop_name, s3, ":quest_giver"),
    ], "There's a trap set up for you in the town. " +
    "{s3} ordered me to sacrifice one of my chosen warriors to fool the enemy, " +
    "but he will just need to find another way.", "sacrificed_messenger_cancel_3",[
      (quest_get_slot, ":quest_giver", "qst_incriminate_loyal_commander", slot_quest_giver_troop),
      (quest_set_slot, "qst_incriminate_loyal_commander", slot_quest_current_state, 1),
      (call_script, "script_change_player_relation_with_troop",":quest_giver",-5),
      (call_script, "script_change_player_honor", 3),
      (call_script, "script_fail_quest", "qst_incriminate_loyal_commander"),
  ]],
  [anyone,"sacrificed_messenger_cancel_3", [], "Thank you, {sir/madam}. " +
    "I will follow you to the gates of hell. But this would not be a good death.", "close_window",[]],
  
  [party_tpl|pt_sacrificed_messenger,"start", [],
    "Don't worry, {sir/madam}, I'm on my way.", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  #Spy
  
  [party_tpl|pt_spy,"start", [], "Good day {sir/madam}. Such fine weather don't you think? If you'll excuse me now I must go on my way.", "follow_spy_talk",[]],
  
  [anyone|plyr, "follow_spy_talk",
    [
      (quest_get_slot, ":quest_giver", "qst_follow_spy", slot_quest_giver_troop),
      (str_store_troop_name, s1, ":quest_giver"),
    ],
    "In the name of {s1}, you are under arrest!", "follow_spy_talk_2", []],
  [anyone, "follow_spy_talk_2", [], "You won't get me alive!", "close_window", []],
  [anyone|plyr, "follow_spy_talk", [], "Never mind me. I was just passing by.", "close_window", [(assign, "$g_leave_encounter",1)]],
  
  [party_tpl|pt_spy_partners,"start", [], "Greetings.", "spy_partners_talk",[]],
  
  [anyone|plyr,"spy_partners_talk",
    [
      (quest_get_slot, ":quest_giver", "qst_follow_spy", slot_quest_giver_troop),
      (str_store_troop_name, s1, ":quest_giver"),
    ],
    "In the name of {s1} You are under arrest!", "spy_partners_talk_2",[]],
  [anyone,"spy_partners_talk_2", [], "You will have to fight us first!", "close_window",[]],
  [anyone|plyr,"spy_partners_talk", [], "Never mind me. I was just passing by.", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  
  ###Conspirator
  ##
  ##  [party_tpl|pt_conspirator_leader,"start", [], "TODO: Hello.", "conspirator_talk",[]],
  ##  [party_tpl|pt_conspirator,"start", [], "TODO: Hello.", "conspirator_talk",[]],
  ##
  ##  [anyone|plyr,"conspirator_talk", [(gt, "$qst_capture_conspirators_leave_meeting_counter", 0),
  ##                                    (quest_get_slot,":quest_giver","qst_capture_conspirators",slot_quest_giver_troop),
  ##                                    (str_store_troop_name,s1,":quest_giver")],
  ##   "TODO: In the name of {s1}, you are under arrest!", "conspirator_talk_2",[]],
  ##
  ##  [anyone|plyr,"conspirator_talk", [], "TODO: Bye.", "close_window",[(assign, "$g_leave_encounter",1)]],
  ##
  ##  [anyone,"conspirator_talk_2", [], "You won't get me alive!", "close_window",[]],
  ##
  #Runaway Peasants
  
  
  [party_tpl|pt_runaway_serfs,"start", [(party_slot_eq, "$g_encountered_party", slot_town_center, 0)],#slot_town_center is used for first time meeting
    "Good day {sir/madam}.", "runaway_serf_intro_1",
    [(party_set_slot, "$g_encountered_party", slot_town_center, 1)]],
  
  [anyone|plyr,"runaway_serf_intro_1", [(quest_get_slot, ":lord", "qst_bring_back_runaway_serfs", slot_quest_giver_troop),
      (str_store_troop_name, s4, ":lord")],
    "I have been sent by your {s4} whom you are running from. He will not punish you if you return now.", "runaway_serf_intro_2",[]],
  
  [anyone,"runaway_serf_intro_2", [(quest_get_slot, ":target_center", "qst_bring_back_runaway_serfs", slot_quest_target_center),
      (str_store_party_name, s6, ":target_center"),
      (quest_get_slot, ":quest_object_center", "qst_bring_back_runaway_serfs", slot_quest_object_center),
      (str_store_party_name, s1, ":quest_object_center")],
    "My good {sir/madam}. Our lives at our village {s1} was unbearable. We worked all day long and still went to bed hungry. " +
    "We are going to {s6} to start a new life, where we will be treated like humans.", "runaway_serf_intro_3",[]],
  
  [anyone|plyr,"runaway_serf_intro_3", [(quest_get_slot, ":quest_object_center", "qst_bring_back_runaway_serfs", slot_quest_object_center),
      (str_store_party_name, s1, ":quest_object_center"),],
    "You have gone against our laws by running from your bondage. You will go back to {s1} now!", "runaway_serf_go_back",
    [(quest_get_slot, ":quest_object_center", "qst_bring_back_runaway_serfs", slot_quest_object_center),
      (call_script, "script_change_player_relation_with_center", ":quest_object_center", -1)]],
  
  [anyone|plyr,"runaway_serf_intro_3", [], "Well, maybe you are right. All right then. If anyone asks, I haven't seen you.", "runaway_serf_let_go",
    [(quest_get_slot, ":quest_object_center", "qst_bring_back_runaway_serfs", slot_quest_object_center),
      (call_script, "script_change_player_relation_with_center", ":quest_object_center", 1)]],
  
  [party_tpl|pt_runaway_serfs,"runaway_serf_go_back", [(quest_get_slot, ":home_center", "qst_bring_back_runaway_serfs", slot_quest_object_center),
      (str_store_party_name, s5, ":home_center")],
    "All right {sir/madam}. As you wish. We'll head back to {s5} now.", "close_window",
    [(quest_get_slot, ":quest_object_center", "qst_bring_back_runaway_serfs", slot_quest_object_center),
      (party_set_ai_object, "$g_encountered_party", ":quest_object_center"),
      (assign, "$g_leave_encounter",1)]],
  
  [anyone,"runaway_serf_let_go", [], "God bless you, {sir/madam}. We will not forget your help.", "close_window",
    [(party_set_slot, "$g_encountered_party", slot_town_castle, 1),
      (assign, "$g_leave_encounter",1)]],
  
  
  [party_tpl|pt_runaway_serfs,"start", [(party_slot_eq, "$g_encountered_party", slot_town_castle, 1),
    ],
    "Good day {sir/madam}. Don't worry. If anyone asks, we haven't seen you.", "runaway_serf_reconsider",[]],
  
  [anyone|plyr,"runaway_serf_reconsider", [], "I have changed my mind. You must back to your village!", "runaway_serf_go_back",
    [(party_set_slot, "$g_encountered_party", slot_town_castle, 0),
      (quest_get_slot, ":quest_object_center", "qst_bring_back_runaway_serfs", slot_quest_object_center),
      (call_script, "script_change_player_relation_with_center", ":quest_object_center", -2)]],
  
  [anyone|plyr,"runaway_serf_reconsider", [], "Good. Go quickly now before I change my mind.", "runaway_serf_let_go",[]],
  
  
  [party_tpl|pt_runaway_serfs,"start", [(party_slot_eq, "$g_encountered_party", slot_town_castle, 0),
      (get_party_ai_object, ":cur_ai_object"),
      (quest_get_slot, ":home_center", "qst_bring_back_runaway_serfs", slot_quest_object_center),
      (neq, ":home_center", ":cur_ai_object")],
    "Good day {sir/madam}. We were heading back to {s5}, but I am afraid we lost our way.", "runaway_serf_talk_caught",[]],
  
  [anyone|plyr,"runaway_serf_talk_caught", [], "Do not test my patience. You are going back now!", "runaway_serf_go_back",[]],
  [anyone|plyr,"runaway_serf_talk_caught", [], "Well, if you are that eager to go, then go.", "runaway_serf_let_go",
    [(quest_get_slot, ":quest_object_center", "qst_bring_back_runaway_serfs", slot_quest_object_center),
      (call_script, "script_change_player_relation_with_center", ":quest_object_center", 1)]],
  
  [party_tpl|pt_runaway_serfs,"start",
    [(quest_get_slot, ":home_center", "qst_bring_back_runaway_serfs", slot_quest_object_center),
      (str_store_party_name, s5, ":home_center")], "We are on our way back to {s5} {sir/madam}.", "runaway_serf_talk_again_return",[]],
  
  [anyone|plyr,"runaway_serf_talk_again_return", [], "Make haste now. The sooner you return the better.", "runaway_serf_talk_again_return_2",[]],
  [anyone|plyr,"runaway_serf_talk_again_return", [], "Good. Keep going.", "runaway_serf_talk_again_return_2",[]],
  
  [anyone|plyr,"runaway_serf_talk_again_return_2", [], "Yes {sir/madam}. As you wish.", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  
  
  #Quest bandits
  [anyone,"start", [
      (check_quest_active, "qst_track_down_bandits"),
      (quest_slot_eq, "qst_track_down_bandits", slot_quest_target_party, "$g_encountered_party"),
      (neg|is_between, "$g_encountered_party_faction", kingdoms_begin, kingdoms_end), #ie, the party has not respawned as a non-bandit
    ],
    "This must be your unlucky day, mate. We're just about the worst people you could run into, in these parts.", "troublesome_bandits_intro_1",[
  ]],
  
  [anyone|plyr,"troublesome_bandits_intro_1", [],
    "Heh. For me, you are nothing more than walking money bags. " +
    "A merchant in {s1} offered me good money for your heads.",
    "troublesome_bandits_intro_2", [(quest_get_slot, ":quest_giver_center", "qst_track_down_bandits", slot_quest_giver_center),
      (str_store_party_name, s1, ":quest_giver_center")
  ]],
  [anyone,"troublesome_bandits_intro_2", [],
    "A bounty hunter! Kill {him/her}! Kill {him/her} now!", "close_window",[
      (encounter_attack)]],
  
  
  #Deserters
  [party_tpl|pt_deserters, "start", [(eq,"$talk_context",tc_party_encounter),
      (party_get_slot,":protected_until_hours", "$g_encountered_party",slot_party_ignore_player_until),
      (store_current_hours,":cur_hours"),
      (store_sub, ":protection_remaining",":protected_until_hours",":cur_hours"),
      (gt, ":protection_remaining", 0)], "What do you want? " +
    "You want to pay us some more money?", "deserter_paid_talk",[]],
  [anyone|plyr,"deserter_paid_talk", [], "Sorry to trouble you. I'll be on my way now.", "deserter_paid_talk_2a",[]],
  [anyone,"deserter_paid_talk_2a", [], "Yeah. Stop fooling around and go make some money. " +
    "I want to see that purse full next time I see you.", "close_window",[(assign, "$g_leave_encounter",1)]],
  [anyone|plyr,"deserter_paid_talk", [], "No. It's your turn to pay me this time.", "deserter_paid_talk_2b",[]],
  [anyone,"deserter_paid_talk_2b", [], "What nonsense are you talking about? You want trouble? You got it.", "close_window",[
      (party_set_slot,"$g_encountered_party",slot_party_ignore_player_until,0),
      (party_ignore_player, "$g_encountered_party", 0),
  ]],
  
  
  [party_tpl|pt_deserters,"start", [
      (eq,"$talk_context",tc_party_encounter)
    ], "We are the free brothers. " +
    "We will fight only for ourselves from now on. " +
    "Now give us your gold or taste our steel.", "deserter_talk",[]],
  ##  [anyone|plyr,"deserter_talk", [(check_quest_active, "qst_bring_back_deserters"),
  ##                                 (quest_get_slot, ":target_deserter_troop", "qst_bring_back_deserters", slot_quest_target_troop),
  ##                                 (party_count_members_of_type, ":num_deserters", "$g_encountered_party",":target_deserter_troop"),
  ##                                 (gt, ":num_deserters", 1)],
  ##   "If you surrender to me now, you will rejoin the army of your kingdom without being punished. Otherwise you'll get a taste of my sword.", "deserter_join_as_prisoner",[]],
  [anyone|plyr,"deserter_talk", [], "When I'm done with you, you'll regret ever leaving your army.", "close_window",[]],
  [anyone|plyr,"deserter_talk", [], "There's no need to fight. I am ready to pay for free passage.", "deserter_barter",[]],
  
  ##  [anyone,"deserter_join_as_prisoner", [(call_script, "script_party_calculate_strength", "p_main_party"),
  ##                                        (assign, ":player_strength", reg0),
  ##                                        (store_encountered_party,":encountered_party"),
  ##                                        (call_script, "script_party_calculate_strength", ":encountered_party"),
  ##                                        (assign, ":enemy_strength", reg0),
  ##                                        (val_mul, ":enemy_strength", 2),
  ##                                        (ge, ":player_strength", ":enemy_strength")],
  ##   "All right we join you then.", "close_window",[(assign, "$g_enemy_surrenders", 1)]],
  ##  [anyone,"deserter_join_as_prisoner", [], "TODO: We will never surrender!", "close_window",[(encounter_attack)]],
  
  [anyone,"deserter_barter", [], "Good. You are clever. Now, having a look at your baggage, I reckon a fellow like you could pretty easily afford {reg5} denars. We wouldn't want to be too greedy, now would we? Pay us, and then you can go.", "deserter_barter_2",[
      (store_troop_gold, ":total_value", "trp_player"),
      (troop_get_inventory_capacity, ":inv_size", "trp_player"),
      (try_for_range, ":i_slot", 0, ":inv_size"),
        (troop_get_inventory_slot, ":item_id", "trp_player", ":i_slot"),
        (ge, ":item_id", 0),
        (try_begin),
          (is_between, ":item_id", trade_goods_begin, trade_goods_end),
          (store_item_value, ":item_value", ":item_id"),
          (val_add, ":total_value", ":item_value"),
        (try_end),
      (try_end),
      (store_div, "$deserter_tribute", ":total_value", 10), #10000 gold = excellent_target
      (val_max, "$deserter_tribute", 10),
      (assign,reg(5),"$deserter_tribute")]],
  [anyone|plyr,"deserter_barter_2", [(store_troop_gold,reg(2)),(ge,reg(2),"$deserter_tribute"),(assign,reg(5),"$deserter_tribute")],
    "All right here's your {reg5} denars.", "deserter_barter_3a",[(troop_remove_gold, "trp_player","$deserter_tribute")]],
  [anyone|plyr,"deserter_barter_2", [],
    "I don't have that much money with me", "deserter_barter_3b",[]],
  [anyone,"deserter_barter_3b", [],
    "Too bad. Then we'll have to sell you to the slavers.", "close_window",[]],
  
  
  [anyone,"deserter_barter_3a", [], "Heh. That wasn't difficult, now, was it? All right. Go now.", "close_window",[
      (store_current_hours,":protected_until"),
      (val_add, ":protected_until", 72),
      (party_set_slot,"$g_encountered_party",slot_party_ignore_player_until,":protected_until"),
      (party_ignore_player, "$g_encountered_party", 72),
      
      (assign, "$g_leave_encounter",1)
  ]],
  
  ##### TODO: QUESTS COMMENT OUT END
  
  #Tavernkeepers
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),(ge,reg(1),tavernkeepers_begin),(lt,reg(1),tavernkeepers_end),(eq, "$g_talk_troop", "trp_town_1_tavernkeeper"),],
    "Bienvenue a la taverne des trois courones...vous voullez boire ou manger ?...Paris es une grande ville,et comme je dit toujours ,on y trouve autant de bonnes choses que de mauvaises.", "tavernkeeper_talk",[(play_sound, "snd_taverniers_h"),]],
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),(ge,reg(1),tavernkeepers_begin),(lt,reg(1),tavernkeepers_end),(eq, "$g_talk_troop", "trp_town_2_tavernkeeper"),],
    "Bien le bonjour,que désirez vous ?", "tavernkeeper_talk",[]],
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),(ge,reg(1),tavernkeepers_begin),(lt,reg(1),tavernkeepers_end),(eq, "$g_talk_troop", "trp_town_3_tavernkeeper"),],
    "Messire...payez votre nouriture et votre boisson,et ne faites pas d'histoires...j'ai déja vue assez de clients armés comme vous l'etes s'entretuer dans ma taverne.", "tavernkeeper_talk",[(play_sound, "snd_taverniers_f"),]],
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),(ge,reg(1),tavernkeepers_begin),(lt,reg(1),tavernkeepers_end),(eq, "$g_talk_troop", "trp_town_4_tavernkeeper"),],
    "Bienvenue Messire,vous etes au Sanglier Bleu,que puis je pour vous ?", "tavernkeeper_talk",[(play_sound, "snd_taverniers_h"),]],
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),(ge,reg(1),tavernkeepers_begin),(lt,reg(1),tavernkeepers_end),(eq, "$g_talk_troop", "trp_town_5_tavernkeeper"),],
    "Bien le bonjour,asseyez vous et buvez tant que vous le pourez,mais il faudra me payer la chambre demain matin.", "tavernkeeper_talk",[(play_sound, "snd_taverniers_h"),]],
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),(ge,reg(1),tavernkeepers_begin),(lt,reg(1),tavernkeepers_end),(eq, "$g_talk_troop", "trp_town_6_tavernkeeper"),],
    "Entrez chevalier...au faisan doré vous aurez tout ce que vous désirez.", "tavernkeeper_talk",[(play_sound, "snd_taverniers_f"),]],
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),(ge,reg(1),tavernkeepers_begin),(lt,reg(1),tavernkeepers_end),(eq, "$g_talk_troop", "trp_town_7_tavernkeeper"),],
    "Salutations Messire,venez vous reposer et vous restaurer pret du feu.", "tavernkeeper_talk",[(play_sound, "snd_taverniers_f"),]],
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),(ge,reg(1),tavernkeepers_begin),(lt,reg(1),tavernkeepers_end),(eq, "$g_talk_troop", "trp_town_8_tavernkeeper"),],
    "Bienvenue a Marseille Messire,qu'es ce que je vous sert ?", "tavernkeeper_talk",[(play_sound, "snd_taverniers_h"),]],
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),(ge,reg(1),tavernkeepers_begin),(lt,reg(1),tavernkeepers_end),(eq, "$g_talk_troop", "trp_town_9_tavernkeeper"),],
    "Salutations,si vous avez de quois payer ,je peut vous proposer les spécialités de notre région.", "tavernkeeper_talk",[(play_sound, "snd_taverniers_f"),]],
  
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),(ge,reg(1),tavernkeepers_begin),(lt,reg(1),tavernkeepers_end),(eq, "$g_talk_troop", "trp_town_10_tavernkeeper"),],
    "Entrez noble Sire,si vous aurez toujours assez d'écus vous serez le roi de ma taverne.", "tavernkeeper_talk",[(play_sound, "snd_taverniers_f"),]],
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),(ge,reg(1),tavernkeepers_begin),(lt,reg(1),tavernkeepers_end),(eq, "$g_talk_troop", "trp_town_11_tavernkeeper"),],
    "Bien le bonjour,entrez vous réchauffer,je vous consseille de passer la nuit ici,a cause des loups...qu'est ce que ce sera ?", "tavernkeeper_talk",[(play_sound, "snd_taverniers_f"),]],
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),(ge,reg(1),tavernkeepers_begin),(lt,reg(1),tavernkeepers_end),(eq, "$g_talk_troop", "trp_town_12_tavernkeeper"),],
    "Le bonjour mon seigneur,que voullez vous boire ?", "tavernkeeper_talk",[(play_sound, "snd_taverniers_h"),]],
  
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),(ge,reg(1),tavernkeepers_begin),(lt,reg(1),tavernkeepers_end),(eq, "$g_talk_troop", "trp_town_13_tavernkeeper"),],
    "Bonjour messire,vous etes a la cave de Bernard,que voullez vous ?", "tavernkeeper_talk",[(play_sound, "snd_taverniers_f"),]],
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),(ge,reg(1),tavernkeepers_begin),(lt,reg(1),tavernkeepers_end),(eq, "$g_talk_troop", "trp_town_14_tavernkeeper"),],
    "Bien le bonjour,voullez vous acheter de notre meilleur vin ?...bien des personnes font plusieurs lieux pour venir le gouter.", "tavernkeeper_talk",[(play_sound, "snd_taverniers_h"),]],
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),(ge,reg(1),tavernkeepers_begin),(lt,reg(1),tavernkeepers_end),(eq, "$g_talk_troop", "trp_town_15_tavernkeeper"),],
    "Bienvenu au tonneau flotant,la meilleure taverne d'Orléans.", "tavernkeeper_talk",[(play_sound, "snd_taverniers_f"),]],
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),(ge,reg(1),tavernkeepers_begin),(lt,reg(1),tavernkeepers_end),(eq, "$g_talk_troop", "trp_town_16_tavernkeeper"),],
    "Le bonjour mon seigneur,que voullez vous boire ?", "tavernkeeper_talk",[(play_sound, "snd_taverniers_h"),]],
  
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),(ge,reg(1),tavernkeepers_begin),(lt,reg(1),tavernkeepers_end),(eq, "$g_talk_troop", "trp_town_20_tavernkeeper"),],
    "Le bonjour et bienvenue a la taverne des deux cerfs, que voullez vous ?", "tavernkeeper_talk",[(play_sound, "snd_taverniers_h"),]],
  
  #
  [anyone ,"start", [(store_conversation_troop,reg(1)),(ge,reg(1),tavernkeepers_begin),(lt,reg(1),tavernkeepers_end)],
    "Good day dear {sir/madam}. How can I help you?", "tavernkeeper_talk",[]],
  #    (store_encountered_party,reg(2)),
  #    (party_get_slot,"$tavernkeeper_party",reg(2),slot_town_mercs),
  #???       (party_slot_ge, "$current_town", slot_town_merchant, 1)
  
  
  
  
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),(ge,reg(1),tavernkeepers_begin),(lt,reg(1),tavernkeepers_end)],
    "Good day dear {sir/madam}. How can I help you?", "tavernkeeper_talk",
    [
      #    (store_encountered_party,reg(2)),
      #    (party_get_slot,"$tavernkeeper_party",reg(2),slot_town_mercs),
      #???       (party_slot_ge, "$current_town", slot_town_merchant, 1)
  ]],
  
  [anyone,"tavernkeeper_pretalk", [], "Anything else?", "tavernkeeper_talk",[]],
  
  [anyone|plyr,"tavernkeeper_talk", [(check_quest_active,"qst_deliver_wine"),
      (quest_slot_eq, "qst_deliver_wine", slot_quest_target_center, "$g_encountered_party"),
      (quest_get_slot, ":quest_target_item", "qst_deliver_wine", slot_quest_target_item),
      (quest_get_slot, ":quest_target_amount", "qst_deliver_wine", slot_quest_target_amount),
      (store_item_kind_count, ":item_count", ":quest_target_item"),
      (ge, ":item_count", ":quest_target_amount"),
      (assign, reg9, ":quest_target_amount"),
      (str_store_item_name, s4, ":quest_target_item"),
    ],
    "I was told to deliver you {reg9} units of {s4}.", "tavernkeeper_deliver_wine",[]],
  [anyone,"tavernkeeper_deliver_wine", [],
    "At last! My stock was almost depleted. " +
    "I had paid the cost of the {s4} in advance. " +
    "Here, take these {reg5} denars. That should cover your pay. " +
    "And give {s9} my regards. " +
    "I'll put in a good word for you next time I deal with him.", "tavernkeeper_pretalk",
    [(quest_get_slot, ":quest_target_item", "qst_deliver_wine", slot_quest_target_item),
      (quest_get_slot, ":quest_target_amount", "qst_deliver_wine", slot_quest_target_amount),
      (quest_get_slot, ":quest_gold_reward", "qst_deliver_wine", slot_quest_gold_reward),
      (quest_get_slot, ":quest_giver_troop", "qst_deliver_wine", slot_quest_giver_troop),
      (troop_remove_items, "trp_player", ":quest_target_item", ":quest_target_amount"),
      (call_script, "script_troop_add_gold", "trp_player", ":quest_gold_reward"),
      (assign, ":xp_reward", ":quest_gold_reward"),
      (val_mul, ":xp_reward", 4),
      (add_xp_as_reward, ":xp_reward"),
      (assign, reg5, ":quest_gold_reward"),
      (str_store_item_name, s4, ":quest_target_item"),
      (str_store_troop_name, s9, ":quest_giver_troop"),
      
      (quest_get_slot, ":giver_town", "qst_deliver_wine", slot_quest_giver_center),
      (call_script, "script_change_player_relation_with_center", ":giver_town", 2),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
      (call_script, "script_end_quest", "qst_deliver_wine"),
  ]],
  
  [anyone|plyr,"tavernkeeper_talk", [(check_quest_active,"qst_deliver_wine"),
      (quest_slot_eq, "qst_deliver_wine", slot_quest_target_center, "$g_encountered_party"),
      (quest_get_slot, ":quest_target_item", "qst_deliver_wine", slot_quest_target_item),
      (quest_get_slot, ":quest_target_amount", "qst_deliver_wine", slot_quest_target_amount),
      (store_item_kind_count, ":item_count", ":quest_target_item"),
      (lt, ":item_count", ":quest_target_amount"),
      (gt, ":item_count", 0),
      (assign, reg9, ":quest_target_amount"),
      (str_store_item_name, s4, ":quest_target_item"),
    ],
    "I was told to deliver you {reg9} units of {s4}, but I lost some of the cargo on the way.", "tavernkeeper_deliver_wine_incomplete",[]],
  [anyone,"tavernkeeper_deliver_wine_incomplete", [],
    "Attacked by bandits eh? " +
    "You are lucky they left you alive. " +
    "Anyway, I can pay you no more than {reg5} denars for this. " +
    "And I will let {s1} know that my order was delivered less than completely, " +
    "so you will probably be charged for this loss.", "tavernkeeper_pretalk",
    [(quest_get_slot, ":quest_target_item", "qst_deliver_wine", slot_quest_target_item),
      (quest_get_slot, ":quest_target_amount", "qst_deliver_wine", slot_quest_target_amount),
      (quest_get_slot, ":quest_gold_reward", "qst_deliver_wine", slot_quest_gold_reward),
      (quest_get_slot, ":quest_giver_troop", "qst_deliver_wine", slot_quest_giver_troop),
      (store_item_kind_count, ":item_count", ":quest_target_item"),
      (troop_remove_items, "trp_player", ":quest_target_item", ":item_count"),
      (val_mul, ":quest_gold_reward", ":item_count"),
      (val_div, ":quest_gold_reward", ":quest_target_amount"),
      (call_script, "script_troop_add_gold", "trp_player", ":quest_gold_reward"),
      (assign, reg5, ":quest_gold_reward"),
      (assign, ":xp_reward", ":quest_gold_reward"),
      (val_mul, ":xp_reward", 4),
      (add_xp_as_reward, ":xp_reward"),
      (str_store_troop_name, s1, ":quest_giver_troop"),
      (assign, ":debt", "$qst_deliver_wine_debt"),
      (store_sub, ":item_left", ":quest_target_amount", ":item_count"),
      (val_mul, ":debt", ":item_left"),
      (val_div, ":debt", ":quest_target_amount"),
      (val_add, "$debt_to_merchants_guild", ":debt"),
      (quest_get_slot, ":giver_town", "qst_deliver_wine", slot_quest_giver_center),
      (call_script, "script_change_player_relation_with_center", ":giver_town", 1),
      (call_script, "script_end_quest", "qst_deliver_wine"),
  ]],
  
  [anyone|plyr,"tavernkeeper_talk", [(check_quest_active,"qst_deliver_wine"),
      (quest_slot_eq, "qst_deliver_wine", slot_quest_target_center, "$g_encountered_party"),
      (quest_get_slot, ":quest_target_item", "qst_deliver_wine", slot_quest_target_item),
      (store_item_kind_count, ":item_count", ":quest_target_item"),
      (eq, ":item_count", 0),
      (quest_get_slot, reg9, "qst_deliver_wine", slot_quest_target_amount),
      (str_store_item_name, s4, ":quest_target_item"),
    ],
    "I was told to deliver you {reg9} units of {s4}, but I lost the cargo on the way.", "tavernkeeper_deliver_wine_lost",[]],
  
  [anyone,"tavernkeeper_deliver_wine_lost", [],
    "What? I was waiting for that {s4} for weeks! " +
    "And now you are telling me that you lost it? " +
    "You may rest assured that I will let {s1} know about this.", "tavernkeeper_pretalk",
    [(add_xp_as_reward, 40),
      (quest_get_slot, ":quest_target_item", "qst_deliver_wine", slot_quest_target_item),
      (quest_get_slot, ":quest_giver_troop", "qst_deliver_wine", slot_quest_giver_troop),
      (str_store_item_name, s4, ":quest_target_item"),
      (str_store_troop_name, s1, ":quest_giver_troop"),
      (val_add, "$debt_to_merchants_guild", "$qst_deliver_wine_debt"),
      (call_script, "script_end_quest", "qst_deliver_wine"),
  ]],
  
  ##mercenaires1429 racourcis
  ##  [anyone|plyr,"tavernkeeper_talk", [], "Il y a beaucoup de soldats qui passes par ici ? je cherche des hommes solides a recruter.", "tavernkeeper_buy_peasants",[]],
  ##  [anyone,"tavernkeeper_buy_peasants",
  ##   [
  ##      (store_encountered_party,reg(3)),
  ##       (store_faction_of_party,reg(4),reg(3)),
  ##       (store_relation,reg(5),"fac_player_supporters_faction",reg(4)),
  ##       (lt, reg(5), -3),
  ##    ], "Je ne crois pas non...la plupart de mes clients sont d'honetes gens qui ne saves meme pas tenir une arme.", "tavernkeeper_buy_peasants_2",[]],
  ##  [anyone,"tavernkeeper_buy_peasants", [], "Oui,dans les tavernes il n'y a que ca...quand ils ne se battes pas ,ils boivent,ce qui me conviens parfaitement d'ailleur,j'en conais certains qui ferais l'afaire.", "tavernkeeper_buy_peasants_2",[(set_mercenary_source_party,"$tavernkeeper_party"),[change_screen_buy_mercenaries]]],
  ##  [anyone,"tavernkeeper_buy_peasants_2", [], "Quois d'autre encore...?", "tavernkeeper_talk",[]],
  ##1429
  ##  [anyone|plyr,"tavernkeeper_talk", [], "Je voudrais louer une chambre.", "tavernkeeper_rest",[]],
  ##  [anyone,"tavernkeeper_rest",
  ##   [
  ##      (store_encountered_party,reg(3)),
  ##       (store_faction_of_party,reg(4),reg(3)),
  ##       (store_relation,reg(5),"fac_player_supporters_faction",reg(4)),
  ##      (lt, reg(5), -3),
  ##    ], "Je ne loue pas de chambre aux etrangers,je ne vous conais pas...c'est non.", "close_window",
  ##  []],
  ##  [anyone,"tavernkeeper_rest", [], "Bien sur...pour combien de temp?", "tavernkeeper_rest_2",[]],
  ##
  ##  [anyone|plyr,"tavernkeeper_rest_2", [], "Je reste jusqu'a mon retablissement.", "close_window", [(change_screen_return),
  ##      (this_or_next|ge,"$g_encountered_party_relation", 0),
  ##        (eq,"$castle_undefended",1),
  ##        (assign, ":can_rest", 1),
  ##        (str_clear, s1),
  ##        (try_begin),
  ##          (neg|party_slot_eq, "$current_town", slot_town_lord, "trp_player"),
  ##		  (troop_get_slot, ":player_spouse", "trp_player", slot_troop_spouse),
  ##          (neg|party_slot_eq, "$current_town", slot_town_lord, ":player_spouse"),
  ##
  ##          (party_slot_ge, "$current_town", slot_town_lord, "trp_player"), #can rest for free in castles and towns with unassigned lords
  ##          (store_faction_of_party, ":current_town_faction", "$current_town"),
  ##          (neq, ":current_town_faction", "fac_player_supporters_faction"),
  ##         (party_get_num_companions, ":num_men", "p_main_party"),
  ##          (store_div, reg1, ":num_men", 4),
  ##          (val_add, reg1, 1),
  ##          (str_store_string, s1, "@ ({reg1} denars per night)"),
  ##          (store_troop_gold, ":gold", "trp_player"),
  ##         (lt, ":gold", reg1),
  ##         (assign, ":can_rest", 0),
  ##        (try_end),
  ##        (eq, ":can_rest", 1),
  ##        (assign, "$auto_enter_town", "$current_town"),
  ##        (assign, "$g_town_visit_after_rest", 1),
  ##        (assign, "$g_last_rest_center", "$current_town"),
  ##        (assign, "$g_last_rest_payment_until", -1),
  ##
  ##        (try_begin),
  ##         (party_is_active, "p_main_party"),
  ##          (party_get_current_terrain, ":cur_terrain", "p_main_party"),
  ##        (try_end),
  ##
  ##        (rest_for_hours_interactive, 24 * 7, 5, 0), #rest while not attackable
  ##        (change_screen_return),
  ##          (finish_mission),
  ##      ]],
  ##
  ##  [anyone|plyr,"tavernkeeper_rest_2", [], "J'ai changé d'avis.", "tavernkeeper_pretalk",[]],
  
  ###############fin louer chambre
  [anyone|plyr,"tavernkeeper_talk", [
      (store_current_hours,":cur_hours"),
      (val_sub, ":cur_hours", 24),
      (gt, ":cur_hours", "$buy_drinks_last_time"),
      ], "I'd like to buy every man who comes in here tonight a jar of your best wine.", "tavernkeeper_buy_drinks",[]],
  
  [anyone,"tavernkeeper_buy_drinks",
    [
      ], "Of course, {my lord/my lady}. I reckon {reg5} denars should be enough for that. What should I tell the lads?", "tavernkeeper_buy_drinks_2",[
      (assign, "$temp", 1000),
      (assign, reg5, "$temp"),
  ]],
  
  [anyone|plyr,"tavernkeeper_buy_drinks_2",
    [
      (store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", "$temp"),
      (str_store_party_name, s10, "$current_town"),
      ], "Let everyone know of the generosity of {playername} to the people of {s10}.", "tavernkeeper_buy_drinks_end",[
      
  ]],
  
  [anyone,"tavernkeeper_buy_drinks_end",
    [], "Don't worry {sir/madam}. Your name will be cheered and toasted here all night.", "tavernkeeper_pretalk",
    [
      (troop_remove_gold, "trp_player", "$temp"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
      (store_current_hours,":cur_hours"),
      (assign, "$buy_drinks_last_time", ":cur_hours"),
  ]],
  
  
  [anyone|plyr,"tavernkeeper_buy_drinks_2", [], "Actually, cancel that order.", "tavernkeeper_pretalk",[]],
  
  [anyone|plyr,"tavernkeeper_talk", [
      (neq, "$g_encountered_party_faction", "fac_player_supporters_faction"),
    ],
    "Have you heard of anyone in this realm who might have a job for a {man/woman} like myself?", "tavernkeeper_job_ask",[
  ]],
  
  [anyone,"tavernkeeper_job_ask",
    [
      (str_store_string, s9, "str__of_course_the_land_is_currently_at_peace_so_you_may_have_better_luck_in_other_realms"),
      (try_for_range, ":faction", kingdoms_begin, kingdoms_end),
        (store_relation, ":relation", "$g_encountered_party_faction", ":faction"),
        (lt, ":relation", 0),
        (str_clear, s9),
      (try_end),
      (faction_get_slot, ":leader",  "$g_encountered_party_faction", slot_faction_leader),
      (str_store_troop_name, s10, ":leader"),
      
    ], "Hmm... Well, {s10} is often looking for mercenaries to fight in his wars.{s9}", "tavernkeeper_job_search",
    [
      (assign, "$g_troop_list_no", 0),
  ]],
  
  
  [anyone, "tavernkeeper_job_search",
    [],
    "Let me think some more...", "tavernkeeper_job_result",
    [
      (call_script, "script_npc_find_quest_for_player_to_s11", "$g_encountered_party_faction"),
      (assign, ":quest_giver", reg0),
      
      (call_script, "script_get_dynamic_quest", ":quest_giver"),
      (assign, ":quest_type", reg0),
      
      (try_begin),
        (gt, ":quest_giver", -1),
        (str_store_troop_name, s7, ":quest_giver"),
        (str_clear, s9), #location string
        
        (assign, ":location", -1),
        (try_begin),
          (troop_slot_eq, ":quest_giver", slot_troop_occupation, slto_kingdom_hero),
          (troop_get_slot, ":quest_giver_party", ":quest_giver", slot_troop_leaded_party),
          (party_is_active, ":quest_giver_party"),
          (party_get_attached_to, ":location", ":quest_giver_party"),
        (else_try),
          (is_between, ":quest_giver", mayors_begin, mayors_end),
          (try_for_range, ":town", towns_begin, towns_end),
            (party_slot_eq, ":town", slot_town_elder, ":quest_giver"),
            (assign, ":location", ":town"),
          (try_end),
        (try_end),
        
        (try_begin),
          (gt, ":location", -1),
          (try_begin),
            (eq, ":location", "$g_encountered_party"),
            (str_store_string, s8, "str_here"),
          (else_try),
            (str_store_string, s8, "str_over"),
          (try_end),
          (str_store_party_name, s12, ":location"),
          (str_store_string, s9, "str_s8_in_s12"),
        (try_end),
        
        (try_begin),
          (eq, ":quest_type", "qst_track_down_bandits"),
          (str_store_string, s10, "str__has_put_together_a_bounty_on_some_bandits_who_have_been_attacking_travellers_in_the_area"),
        (else_try),
          (eq, ":quest_type", "qst_destroy_bandit_lair"),
          (str_store_string, s10, "str__has_been_worried_about_bandits_establishing_a_hideout_near_his_home"),
        (else_try),
          (eq, ":quest_type", "qst_retaliate_for_border_incident"),
          (str_store_string, s10, "str__is_looking_for_a_way_to_avoid_an_impending_war"),
        (else_try),
          (eq, ":quest_type", "qst_rescue_prisoner"),
          (str_store_string, s10, "str__may_need_help_rescuing_an_imprisoned_family_member"),
        (else_try),
          (eq, ":quest_type", "qst_cause_provocation"),
          (str_store_string, s10, "str__has_been_asking_around_for_someone_who_might_want_work_id_watch_yourself_with_him_though"),
        (else_try),
          (str_store_string, s10, "str_tavernkeeper_invalid_quest"),
        (try_end),
        
        (troop_get_type, reg4, ":quest_giver"),
      (try_end),
      
  ]],
  
  
  [anyone, "tavernkeeper_job_result", [
      (store_sub, ":last_troop", mayors_end, 1),
      (lt, "$g_troop_list_no", ":last_troop"),
    ], "I have heard that {s7} {s9}{s10} You may want to speak with {reg4?her:him}.", "tavernkeeper_job_search",
    [
  ]],
  
  [anyone, "tavernkeeper_job_result", [
      (store_sub, ":last_troop", mayors_end, 1),
      (ge, "$g_troop_list_no", ":last_troop"),
    ], "There may be other work, of course -- lords and guildmasters often have other tasks which we don't hear about. Also, the villages around here frequently need help, although they'd be more likely to pay you with a wedge of cheese and goodwill than with cold hard denars.", "tavernkeeper_job_result_2",
    [
  ]],
  
  [anyone,"tavernkeeper_job_result_2", [], "Je garde les oreilles ouvertes a toutes autres opportunités,redemandez moi de temps en temps.", "tavernkeeper_pretalk",[]],
  
  #1429 TAVERNIER VENDEUR
  # # # # # # # # #
  [anyone|plyr,"tavernkeeper_talk", [], "Qu'avez vous a vendre ?.", "goods_tavernier_requested",[]],
  [anyone,"goods_tavernier_requested", [], "De quois avez vous besoin ?...", "goods_tavernier_completed",[[change_screen_trade]]],
  [anyone,"goods_tavernier_completed", [], "Autre chose?", "tavernkeeper_talk",[]],
  
  
  
  ###1429DIALOGUES TAVERNIER
  [anyone|plyr,"tavernkeeper_talk", [], "Qui y t'il d'intéressent a voir en france?", "tavernkeeper_trav",[(store_random_in_range, "$rand5", 0, 8),]],
  
  [anyone,"tavernkeeper_trav", [(eq,"$rand5",0),], "Le mraché de Bordeaux vaut le détour a ce que l'on dit,la rue Sainte Catherine regorge de marchants.", "tavernkeeper_travend",[]],
  [anyone,"tavernkeeper_trav", [(eq,"$rand5",1),], "Il y a la grande forge a Orléans,ils fabriquent les meilleurs armes la bas.", "tavernkeeper_travend",[]],
  [anyone,"tavernkeeper_trav", [(eq,"$rand5",2),], "Les écuries de paris vallent le détour a ce qu'on dit,ils y entrainent les meilleurs chevaux,paraitrais meme que l'on puisse en acheter.", "tavernkeeper_travend",[]],
  [anyone,"tavernkeeper_trav", [(eq,"$rand5",3),], "Si il vous arivais de vous blésser,il y a un tres bon medecin a Dijon,c'est ce que les voyageurs,m'ont rapportés en tout cas,je n'ai jamais verifié.", "tavernkeeper_travend",[]],
  [anyone,"tavernkeeper_trav", [(eq,"$rand5",4),], "A ce qu'il parais,le cloitre aux dammes de Marseille es infecté par la peste noire,Dieu nous en préserve.", "tavernkeeper_travend",[]],
  [anyone,"tavernkeeper_trav", [(eq,"$rand5",5),], "Faites attention si il vous arivais de vous rendre dans les quartiers pauvres de Paris Messire,c'est un repert de voleurs et de ribauds en tous genres.", "tavernkeeper_travend",[]],
  [anyone,"tavernkeeper_trav", [(eq,"$rand5",6),], "Il y a un atelier d'engins de siege aux portes de Limoges,a ce qu'on dit ils y fabriquent des armes d'un nouveau genre,si cela pouvais nous faire gagner cette guerre...", "tavernkeeper_travend",[]],
  [anyone,"tavernkeeper_trav", [(eq,"$rand5",7),], "Il y a une troupe de mercenaires basés a Bourges,ils recrutent les hommes d'armes biens entrainés il parait et ils payent bien.", "tavernkeeper_travend",[]],
  [anyone,"tavernkeeper_trav", [(eq,"$rand5",8),], "Vous pourriez vous faire engager comme courssier si vous avez une monture rapide, ils ne payent pas si bien mais ils ont beaucoup de travail a proposer a ce que l'on dit.vous pourrez trouver une de leures guilde a Bourges,Bordeau,Calais et a Marseille.", "tavernkeeper_travend",[]],
  
  
  [anyone|plyr,"tavernkeeper_travend", [], "Merci pour les rensseignements.", "tavernkeeper_pretalk",[]],
  
  
  [anyone,"tavernkeeper_trav",
    [
      (store_encountered_party,reg(3)),
      (store_faction_of_party,reg(4),reg(3)),
      (store_relation,reg(5),"fac_player_supporters_faction",reg(4)),
      (lt, reg(5), -3),
    ], "Je n'ai plus envie de vous parler,partez.", "close_window",
    
    []],
  
  [anyone,"tavernkeeper_war_3", [], "Tres bien... si vous voulez mon opinon,on devrais prendre les armes et liberer la france nous memes,en expulsant les nobles par la meme occasion", "tavernkeeper_pretalk",[]],
  
  ###1429DIALOGUES TAVERNIER
  [anyone|plyr,"tavernkeeper_talk", [], "Que pensez vous de cette guerre?", "tavernkeeper_war",[]],
  [anyone,"tavernkeeper_war", [], "Ce que j'en pense ?... c'est qu'elle a trop durée.pendant que les nobles se disputes leurs terres,les paysans et les honetes gens crève a la bataille ou allieurs,pour nous les petites gens,c'est soit mourir de faim ou sur le champ d'honeur,ce drole choix nous reviens encore", "tavernkeeper_war_2",[]],
  [anyone|plyr,"tavernkeeper_war_2", [], "Ne pouvons nous rien faire pour changer ca ?", "tavernkeeper_war_3",[]],
  [anyone|plyr,"tavernkeeper_war_2", [], "Que voulez vous...les choses sont ainsi.", "tavernkeeper_pretalk",[]],
  
  
  [anyone,"tavernkeeper_war_3",
    [
      (store_encountered_party,reg(3)),
      (store_faction_of_party,reg(4),reg(3)),
      (store_relation,reg(5),"fac_player_supporters_faction",reg(4)),
      (lt, reg(5), -3),
    ], "J'en es déja trop dit...", "close_window",
    
    []],
  
  [anyone,"tavernkeeper_war_3", [], "Tres bien... si vous voulez mon opinon,on devrais prendre les armes et liberer la france nous memes,en expulsant les nobles par la meme occasion", "tavernkeeper_pretalk",[]],
  
  ###  ###1429DIALOGUES TAVERNIER2
  
  [anyone|plyr,"tavernkeeper_talk", [], "J'aimerais apprendre a cuisiner pour ma troupe, pouvez vous m'y aider ?", "tavernkeeper_cuisinier",[]],
  [anyone,"tavernkeeper_cuisinier", [], "C'est possible, mais il vous faudra payer pour les ustenssils de cuisine et les marchandises.", "tavernkeeper_cuisinier_2",[]],
  [anyone|plyr,"tavernkeeper_cuisinier_2", [], "Je payerais...", "tavernkeeper_cuisinier_3",[]],
  [anyone|plyr,"tavernkeeper_cuisinier_2", [], "J'ai assez dépenssé pour aujourd'hui, peut etre plus tard.", "tavernkeeper_pretalk",[]],
  
  [anyone,"tavernkeeper_cuisinier_3", [], "Bien, il va vous falloire un chaudron, des ustenssils et des recettes, j'ai justement un deuxième chaudron que je peut vous vendre 230 écus, je vous laisse mes ustenssils pour 30 écus, et chaques recettes vous en couterons 25. que voullez vous en premier ?", "tavernkeeper_cuisinier_4",[]],
  
  [anyone|plyr,"tavernkeeper_cuisinier_4",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 230),
    ], "Je voudrais un chaudron.", "tavernkeeper_cuisinier_chaud",
    [
      (troop_remove_gold,"trp_player",230),
  ]],
  [anyone|plyr,"tavernkeeper_cuisinier_4",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 30),
    ], "Je vais prendre les ustenssils de cuisine.", "tavernkeeper_cuisinier_ust",
    [
      (troop_remove_gold,"trp_player",30),
  ]],
  [anyone|plyr,"tavernkeeper_cuisinier_4",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 25),
      ], "avez vous des recettes ?", "tavernkeeper_cuisinier_recet",[]],
  
  [anyone|plyr,"tavernkeeper_cuisinier_4", [], "Je...n'es pas assez d'or...", "tavernkeeper_cuisinier_fail",[]],
  
  [anyone,"tavernkeeper_cuisinier_fail", [], "Et voila...j'ai encore perdu mon temps, si vous n'avez pas d'or a dépensser, je vous suggère d'aller en gagner et de revenire plus tard...sans vous offensser messire, mais ici on fait du comerce.", "tavernkeeper_pretalk",[]],
  
  
  [anyone,"tavernkeeper_cuisinier_chaud", [], "Merci bien messire, autre chose ?", "tavernkeeper_cuisinier_4",[(troop_add_item, "trp_player", "itm_chaudron", 0),]],
  [anyone,"tavernkeeper_cuisinier_ust", [], "Merci bien messire, autre chose ?", "tavernkeeper_cuisinier_4",[(troop_add_item, "trp_player", "itm_ustensil", 0),]],
  [anyone,"tavernkeeper_cuisinier_recet", [], "Et bien, j'ai la recette d'une soupe de légumes, de la potée de choux, ou d'une soupe de poisson, laquelle voullez vous éssayer ?", "tavernkeeper_recettes_start",[]],
  
  
  [anyone|plyr,"tavernkeeper_recettes_start",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 25),
    ], "Je vais prendre la recette de la soupe de légumes.", "tavernkeeper_rec_soup",
    [
      (troop_remove_gold,"trp_player",25),
  ]],
  [anyone|plyr,"tavernkeeper_recettes_start",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 25),
    ], "J'aimerais faire de la potée aux choux.", "tavernkeeper_rec_choux",
    [
      (troop_remove_gold,"trp_player",25),
  ]],
  [anyone|plyr,"tavernkeeper_recettes_start",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 25),
    ], "Je pensse que la soupe de poisson devrais etre intéressante", "tavernkeeper_rec_poisson",
    [
      (troop_remove_gold,"trp_player",25),
  ]],
  [anyone|plyr,"tavernkeeper_recettes_start", [], "Ca seras tout pour le moment.", "tavernkeeper_pretalk",[]],
  
  
  [anyone,"tavernkeeper_rec_soup", [], "Merci bien messire, autre chose ?", "tavernkeeper_recettes_start",[(troop_add_item, "trp_player", "itm_plan_9", 0),]],
  [anyone,"tavernkeeper_rec_choux", [], "Merci bien messire, autre chose ?", "tavernkeeper_recettes_start",[(troop_add_item, "trp_player", "itm_plan_10", 0),]],
  [anyone,"tavernkeeper_rec_poisson", [], "Merci bien messire, autre chose ?", "tavernkeeper_recettes_start",[(troop_add_item, "trp_player", "itm_plan_11", 0),]],
  
  [anyone|plyr,"tavernkeeper_cuisinier_4", [], "Ca seras tout pour le moment.", "tavernkeeper_pretalk",[]],
  
  
  #1429 jeu du pile ou face tavernier
  
  [anyone|plyr,"tavernkeeper_talk", [
      # (store_current_hours,":cur_hours"),
      # (val_sub, ":cur_hours", 6),
      # (gt, ":cur_hours", "$gamble_last_time"),
      ], "Voullez vous jouer quelques pieces aux dés ?.", "tavernkeeper_coin",[]],
  
  [anyone,"tavernkeeper_coin", [
      ], "Bien sur...C'est pas comme si j'avais trop de travail.", "generique_des",[]],
  
  #
  [anyone|plyr,"tavernkeeper_talk", [], "Puis je vous poser une question délicate ?.", "tavernkeeper_discut",[]],
  [anyone,"tavernkeeper_discut", [], "A propos de quois ?...", "tavernkeeper_choix",[]],
  [anyone,"tavernkeeper_prechoix", [], "De quois voulez vous discuter ?...", "tavernkeeper_choix",[]],
  [anyone|plyr,"tavernkeeper_choix", [], "A propos des Dames", "tavernkeeper_dame",[]],
  [anyone,"tavernkeeper_dame",
    [
      (store_encountered_party,reg(3)),
      (store_faction_of_party,reg(4),reg(3)),
      (store_relation,reg(5),"fac_player_supporters_faction",reg(4)),
      (lt, reg(5), -3),
    ], "Je ne puis rien vous dire a ce propos,partez maintenant...", "close_window",
    
    []],
  
  [anyone,"tavernkeeper_dame", [], "...que voulez vous savoir exactement ?", "tavernkeeper_dame_2",[]],
  [anyone|plyr,"tavernkeeper_dame_2", [], "Quel interet y a t'il a se marier...", "tavernkeeper_dame_3",[]],
  [anyone,"tavernkeeper_dame_3", [], "Ha les dames...elles disent qu'elles veulent votre bien,et cherir votre descendance,mais n'importe que votre bourse.je veux dire...vos Ecus,naturelement. ", "tavernkeeper_prechoix",[]],
  
  [anyone|plyr,"tavernkeeper_choix", [], "Je pense que nous sommes vaincus d'avance...", "tavernkeeper_defeat",[]],
  [anyone,"tavernkeeper_defeat",
    [
      (store_encountered_party,reg(3)),
      (store_faction_of_party,reg(4),reg(3)),
      (store_relation,reg(5),"fac_player_supporters_faction",reg(4)),
      (lt, reg(5), -3),
    ], "Je n'ai rien a vous dire sur ca...", "close_window",
    
    []],
  
  [anyone,"tavernkeeper_defeat", [], "Nous ne devons pas perdre espoir...meme si nous étions vaincus,nous nous reléverons toujours,dieu veux que la France reviene a son peuple,ayez la foi.", "tavernkeeper_defeat_2",[]],
  [anyone|plyr,"tavernkeeper_defeat_2", [], "Vous avez raison...gardons la foi et dieu nous menera a la victoire.", "tavernkeeper_defeat_3",[]],
  [anyone|plyr,"tavernkeeper_defeat_2", [], "Je doit vraiment etre dans le petrin pour discuter de ca avec le tavernier...", "tavernkeeper_prechoix",[]],
  [anyone,"tavernkeeper_defeat_3", [], "Voila qui es bien parlé...je vous sert autre chose ?.", "tavernkeeper_prechoix",[]],
  
  [anyone|plyr,"tavernkeeper_choix", [], "Que dois je faire,si jamais j' étais blessé ?", "tavernkeeper_bless",[]],
  [anyone,"tavernkeeper_bless", [], "Et bien...si par malheur vous seriez soufrant,vous pouriez vous reposer a l'abrit dans une taverne,et si vous etiez gravement touché,vous devriez chercher un pretre pour qu'il vous soigne avec sa medecine.", "tavernkeeper_prechoix",[]],
  
  [anyone|plyr,"tavernkeeper_choix", [], "Qui pourais m'apprendre a me battre ?", "tavernkeeper_train",[]],
  [anyone,"tavernkeeper_train", [], "Vous trouverez surement des soldats prets a enseigner leur savoir fair a des novices si vous les payez corectement,commencez a chercher dans les villes et demandez autour de vous.", "tavernkeeper_prechoix",[]],
  [anyone|plyr,"tavernkeeper_choix", [], "Vous devez entendre des histoires incroyables dans votre taverne ?", "tavernkeeper_hist",[]],
  
  [anyone,"tavernkeeper_prehist", [], "Voulez vous entendre une autre histoire ?", "tavernkeeper_hist2",[]],
  
  [anyone,"tavernkeeper_hist", [], "Il se dit que le roi charles VI etait fol...fol au point de charger ses rabateurs a la chasse en hurlant,si cette anegdote fait rire dans les chaumières,je suppose que la royauté n'en menais pas large...eh...attendez,je viens de comprendre pourquois l'anglettere a déclaré la guerre....", "tavernkeeper_prehist",[]],
  
  [anyone|plyr,"tavernkeeper_hist2", [], "Oui,une autre histoire...je l'éspère un peut meilleure.", "tavernkeeper_histmieu",[]],
  
  [anyone,"tavernkeeper_histmieu", [], "Ha,tres bien...laissez moi réfléchir...oui,avez vous entendue parler de la bete a trois cornes ? oui messire,il paraitrais qu'elle se cache dans les chateaux en ruines et ne sort que quand elle as faim,certains disent que c'est satan lui meme,d'autres pensent que la bete a du naitre au debut de la guerre pour elle meme faire la guerre aux hommes et les vaincres tous....", "tavernkeeper_prehist2",[]],
  
  [anyone,"tavernkeeper_prehist2", [], "En voulez vous une autre ?", "tavernkeeper_hist3",[]],
  
  [anyone|plyr,"tavernkeeper_hist3", [], "Oui...et reservez moi a boire.", "tavernkeeper_talkencore",[]],
  
  [anyone,"tavernkeeper_talkencore", [], "Ecoutez bien messire...avez vous entendu parler de Jeanne la pucelle ? cette petite bergere venue de Domrémy...il parait,et ca je ne l'invente pas,qu'elle aurais battu a plate couture tout un regiment de soldats anglais,meme mieux,elle aurais capturée une forteresse a elle toute seule,la simple vue de sa banière aurais envoutée les soldats qui se seraient jetés dans le fleuve...certains disent qu'elle es un arcange de dieu,d'autres pensent qu'elle es envoyée par le diable pour tous nous convertir a sa religion...c'est ce qui ce dit en tout cas...et bien messire,je ne puis vous parler d'avantage,il se fait tard.", "tavernkeeper_pretalk",[]],
  
  [anyone|plyr,"tavernkeeper_hist3", [], "vous venez de l'inventer...dans le seul but de me faire boire...j'ai vraiment l'air d'un paysan ?", "tavernkeeper_pretalk",[]],
  
  [anyone|plyr,"tavernkeeper_hist2", [], "J'en es assez entendue...c'est idiot.", "tavernkeeper_pretalk",[]],
  
  [anyone|plyr,"tavernkeeper_choix", [], "J'ai mieux a faire que de bavarder.", "tavernkeeper_pretalk",[]],
  
  
  
  [anyone|plyr,"tavernkeeper_talk", [], "Je pensse que je ferais mieux d'y aller maintenant...", "close_window",[]],
  
  #Tavern Talk (with companions)
  #  [anyone, "companion_recruit_yes", [(neg|hero_can_join, "p_main_party"),], "I don't think can lead any more men than you do now.\
  # You need to release someone from service if you want me to join your party.", "close_window", []],
  
  
  
  
  #Tavern Talk (with ransom brokers)
  #                 (eq, "$g_talk_troop", "trp_auberge_client_4"),
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_auberge_client_4"),
      
    ],
    "Laisse moi boire tranquile.", "afight_alcool1",
    [
      
  ]],
  
  [anyone|plyr ,"afight_alcool1", [],  "Je n'aime pas boire seul.", "afight_alcool2", []],
  
  [anyone|plyr ,"afight_alcool1", [],  "Tu peut boire tout ton saoul, adieu.", "close_window", []],
  
  [anyone ,"afight_alcool2", [],"Ah oui ? que dirais tu d'un concourt dans ce cas ? on met l'argent sur la table et celui qui tiens encore debout part avec, qu'en pensse tu ?", "afight_alcool3", []],
  
  
  
  [anyone|plyr ,"afight_alcool3", [],  "Un concourt ? c'est d'accord, il me fallais justement une excuse pour boire comme un Templier.", "afight_alcoolstart", []],
  
  [anyone|plyr ,"afight_alcool3", [],  "Je pensse que j'ai mieux a faire que de dormire sur le sol de la taverne.", "close_window", []],
  
  
  [anyone ,"afight_alcoolstart", [],"Ici on boit de l'Hydromel, tu pensse etre assez fort ? Alors combien tu mise fot en cul ?", "afight_alcoolmise", []],
  
  
  [anyone|plyr,"afight_alcoolmise", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",10),
      ], "10 ecus.", "afight_alcoolmiseend",[
      (assign, reg6, 10),]],
  [anyone|plyr,"afight_alcoolmise", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",20),
      ], "20 ecus.", "afight_alcoolmiseend",[
      (assign, reg6, 20),]],
  [anyone|plyr,"afight_alcoolmise", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",30),
      ], "30 ecus.", "afight_alcoolmiseend",[
      (assign, reg6, 30),]],
  [anyone|plyr,"afight_alcoolmise", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",40),
      ], "40 ecus.", "afight_alcoolmiseend",[
      (assign, reg6, 40),]],
  [anyone|plyr,"afight_alcoolmise", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",50),
      ], "50 ecus.", "afight_alcoolmiseend",[
      (assign, reg6, 50),]],
  [anyone|plyr,"afight_alcoolmise", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",100),
      ], "100 ecus.", "afight_alcoolmiseend",[
      (assign, reg6, 100),]],
  [anyone|plyr,"afight_alcoolmise", [
      ], "Ca suffit.", "afight_alcoolmiseendno",[]],
  
  
  [anyone,"afight_alcoolmiseendno", [
      ], "Freluquet...", "close_window",[]],
  
  
  
  
  [anyone ,"afight_alcoolmiseend", [],"Le premier verre...ensemble.", "afight_begin",
    [
      
  ]],
  
  
  [anyone ,"afight_begin",
    [
    ],
    "RHA! c'est bon, hein ? encore.", "afight_begin2",
    [
      (play_sound, "snd_drunk_concourt"),
  ]],
  
  
  #
  
  
  [anyone|plyr ,"afight_begin2", [],  "Ca n'etait que pour s'échaufer, un autre.", "afight_begin_round2",
    [
  ]],
  [anyone|plyr ,"afight_begin2", [],  "Non, ca ira, merci pour le verre.", "close_window", []],
  
  #round 2
  
  [anyone ,"afight_begin_round2",
    [
    ],
    "Harf!...pas mauvais.", "afight_begin3",
    [
      (play_sound, "snd_drunk_concourt"),
  ]],
  #
  
  
  [anyone|plyr ,"afight_begin3", [],  "Déja fatigué l'ami ? allez, le troisieme.", "afight_begin4",
    [
      (call_script, "script_jet_de_force_cboissons"),
  ]],
  [anyone|plyr ,"afight_begin3", [],  "Ca ira, merci pour le verre.", "close_window", []],
  
  
  #round 3
  [anyone ,"afight_begin4",
    [
      (ge,"$drunk_fight_win",1),
    ],
    "He, he he he...ha, ha ha !", "afight_begin5",
    [
      (assign, "$drunk_fight_win", 0),
      (play_sound, "snd_drunk_concourt"),
  ]],
  
  
  #repter !!!
  [anyone|plyr ,"afight_begin4",
    [
      (ge,"$drunk_fight_win",0),
    ],
    "Je me sens mal...", "close_window",
    [
      (play_sound, "snd_drunk_ko"),
      (troop_remove_gold,"trp_player",reg6),
      (change_screen_return),
      (finish_mission),
  ]],
  
  #
  
  
  [anyone|plyr ,"afight_begin5", [],  "Encore...un dernier pur la rute, hips!", "afight_begin6",
    [
      (call_script, "script_jet_de_force_cboissons"),
  ]],
  [anyone|plyr ,"afight_begin5", [],  "Ca suffit...merci, aretons la.", "close_window", []],
  
  
  
  #round 4
  
  [anyone ,"afight_begin6",
    [
      (ge,"$drunk_fight_win",1),
    ],
    "Ah...tu m'as pas dit d'ou tu vnais, hips! allez... dernier.", "afight_begin7",
    [
      (assign, "$drunk_fight_win", 0),
      (play_sound, "snd_drunk_concourt"),
  ]],
  
  
  #repter !!!
  [anyone|plyr ,"afight_begin6",
    [
      (ge,"$drunk_fight_win",0),
    ],
    "...", "close_window",
    [
      (play_sound, "snd_drunk_ko"),
      (troop_remove_gold,"trp_player",reg6),
      (change_screen_return),
      (finish_mission),
  ]],
  
  
  [anyone|plyr ,"afight_begin7", [],  "Dernié ver, et t'as gagné, hips.", "afight_begin8",
    [
      
  ]],
  [anyone|plyr ,"afight_begin7", [],  "Besoin de dormir, garde les sous, hips.", "close_window", []],
  
  #round 5
  
  
  
  [anyone ,"afight_begin8",
    [
      
    ],
    "...", "aclose_drunk_f",
    [
      (agent_deliver_damage_to_agent, "$g_talk_agent", "$g_talk_agent", 800),
      (play_sound, "snd_drunk_ko"),
      # (store_current_hours,":cur_hours"),
      #(assign, "$gamble_last_time", ":cur_hours")
  ]],
  
  
  [anyone|plyr ,"aclose_drunk_f",
    [
    ],
    "Je vais prendre cet or, fait de beaux reves l'ami...", "close_window",
    [
      (troop_add_gold,"trp_player",reg6),
      (assign, "$drunk_fight_win", 0),
  ]],
  
  
  
  
  
  
  
  #                 (eq, "$g_talk_troop", "trp_auberge_client_4"),
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_alcolo_1"),
      
    ],
    "Laisse moi boire tranquile.", "fight_alcool1",
    [
      
  ]],
  
  [anyone|plyr ,"fight_alcool1", [],  "Je n'aime pas boire seul.", "fight_alcool2", []],
  
  [anyone|plyr ,"fight_alcool1", [],  "Tu peut boire tout ton saoul, adieu.", "close_window", []],
  
  [anyone ,"fight_alcool2", [],"Ah oui ? que dirais tu d'un concourt dans ce cas ? on met l'argent sur la table et celui qui tiens encore debout part avec, qu'en pensse tu ?", "fight_alcool3", []],
  
  
  
  [anyone|plyr ,"fight_alcool3", [],  "Un concourt ? c'est d'accord, il me fallais justement une excuse pour boire comme un Templier.", "fight_alcoolstart", []],
  
  [anyone|plyr ,"fight_alcool3", [],  "Je pensse que j'ai mieux a faire que de dormire sur le sol de la taverne.", "close_window", []],
  
  
  [anyone ,"fight_alcoolstart", [],"Ici on boit de l'Hydromel, tu pensse etre assez fort ? Alors combien tu mise fot en cul ?", "fight_alcoolmise", []],
  
  
  [anyone|plyr,"fight_alcoolmise", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",10),
      ], "10 ecus.", "fight_alcoolmiseend",[
      (assign, reg6, 10),]],
  [anyone|plyr,"fight_alcoolmise", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",20),
      ], "20 ecus.", "fight_alcoolmiseend",[
      (assign, reg6, 20),]],
  [anyone|plyr,"fight_alcoolmise", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",30),
      ], "30 ecus.", "fight_alcoolmiseend",[
      (assign, reg6, 30),]],
  [anyone|plyr,"fight_alcoolmise", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",40),
      ], "40 ecus.", "fight_alcoolmiseend",[
      (assign, reg6, 40),]],
  [anyone|plyr,"fight_alcoolmise", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",50),
      ], "50 ecus.", "fight_alcoolmiseend",[
      (assign, reg6, 50),]],
  [anyone|plyr,"fight_alcoolmise", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",100),
      ], "100 ecus.", "fight_alcoolmiseend",[
      (assign, reg6, 100),]],
  [anyone|plyr,"fight_alcoolmise", [
      ], "Ca suffit.", "fight_alcoolmiseendno",[]],
  
  
  [anyone,"fight_alcoolmiseendno", [
      ], "Freluquet...", "close_window",[]],
  
  
  
  
  [anyone ,"fight_alcoolmiseend", [],"Le premier verre...ensemble.", "fight_begin",
    [
      
  ]],
  
  
  [anyone ,"fight_begin",
    [
    ],
    "RHA! c'est bon, hein ? encore.", "fight_begin2",
    [
      (play_sound, "snd_drunk_concourt"),
  ]],
  
  
  #
  
  
  [anyone|plyr ,"fight_begin2", [],  "Ca n'etait que pour s'échaufer, un autre.", "fight_begin_round2",
    [
  ]],
  [anyone|plyr ,"fight_begin2", [],  "Non, ca ira, merci pour le verre.", "close_window", []],
  
  #round 2
  
  [anyone ,"fight_begin_round2",
    [
    ],
    "Harf!...pas mauvais.", "fight_begin3",
    [
      (play_sound, "snd_drunk_concourt"),
  ]],
  #
  
  
  [anyone|plyr ,"fight_begin3", [],  "Déja fatigué l'ami ? allez, le troisieme.", "fight_begin4",
    [
      (call_script, "script_jet_de_force_cboissons"),
  ]],
  [anyone|plyr ,"fight_begin3", [],  "Ca ira, merci pour le verre.", "close_window", []],
  
  
  #round 3
  [anyone ,"fight_begin4",
    [
      (ge,"$drunk_fight_win",1),
    ],
    "He, he he he...ha, ha ha !", "fight_begin5",
    [
      (assign, "$drunk_fight_win", 0),
      (play_sound, "snd_drunk_concourt"),
  ]],
  
  
  #repter !!!
  [anyone|plyr ,"fight_begin4",
    [
      (ge,"$drunk_fight_win",0),
    ],
    "Je me sens mal...", "close_window",
    [
      (play_sound, "snd_drunk_ko"),
      (troop_remove_gold,"trp_player",reg6),
      (jump_to_menu, "mnu_town"),
      
      (finish_mission),
  ]],
  
  #
  
  
  [anyone|plyr ,"fight_begin5", [],  "Encore...un dernier pur la rute, hips!", "fight_begin6",
    [
      (call_script, "script_jet_de_force_cboissons"),
  ]],
  [anyone|plyr ,"fight_begin5", [],  "Ca suffit...merci, aretons la.", "close_window", []],
  
  
  
  #round 4
  
  [anyone ,"fight_begin6",
    [
      (ge,"$drunk_fight_win",1),
    ],
    "Ah...tu m'as pas dit d'ou tu vnais, hips! allez... dernier.", "fight_begin7",
    [
      (assign, "$drunk_fight_win", 0),
      (play_sound, "snd_drunk_concourt"),
  ]],
  
  
  #repter !!!
  [anyone|plyr ,"fight_begin6",
    [
      (ge,"$drunk_fight_win",0),
    ],
    "...", "close_window",
    [
      (play_sound, "snd_drunk_ko"),
      (troop_remove_gold,"trp_player",reg6),
      (jump_to_menu, "mnu_town"),
      (finish_mission),
  ]],
  
  
  [anyone|plyr ,"fight_begin7", [],  "Dernié ver, et t'as gagné, hips.", "fight_begin8",
    [
      
  ]],
  [anyone|plyr ,"fight_begin7", [],  "Besoin de dormire, garde les sous, hips.", "close_window", []],
  
  #round 5
  
  
  
  [anyone ,"fight_begin8",
    [
      
    ],
    "...", "close_drunk_f",
    [
      (agent_deliver_damage_to_agent, "$g_talk_agent", "$g_talk_agent", 800),
      (play_sound, "snd_drunk_ko"),
      # (store_current_hours,":cur_hours"),
      #(assign, "$gamble_last_time", ":cur_hours")
  ]],
  
  
  [anyone|plyr ,"close_drunk_f",
    [
    ],
    "Je vais prendre cet or, fait de beaux reves l'ami...", "close_window",
    [
      (troop_add_gold,"trp_player",reg6),
      (assign, "$drunk_fight_win", 0),
  ]],
  
  
  
  #pugilat
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_organisateur"),
    ],
    "Messire, approchez. vous semblez fort au combat, estes vous soldat ?", "start_pugilat",
    [
  ]],
  
  [anyone|plyr ,"start_pugilat", [],  "On peut dire ca, que puis je pour vous ?", "start_pugilat2", []],
  
  [anyone|plyr ,"start_pugilat", [],  "Non je suis un marchand, adieu.", "close_window", []],
  
  [anyone ,"start_pugilat2", [],"J'organise des combats dans les bassements de la taverne, si vous etes interessé vous pourrez gagner de l'argent en misant sur vous tout en me rapportant des écus a moi meme. qu'en dites vous cela ne semble pas honnete ? naturelement ce ne sont pas des combats a mort vous ne risquerez qu'une cote cassée Ou une entaille sur le bras.", "start_pugilat3", []],
  
  [anyone|plyr ,"start_pugilat3", [],  "Je suis votre homme.", "start_pugilatok", []],
  [anyone|plyr ,"start_pugilat3", [],  "Avec quelle sorte d'armes nous battons nous ?", "start_pugilatarmes", []],
  
  [anyone ,"start_pugilatarmes", [],"Point d'inquietudes pour un champion tel que vous, vous vous batterez avec une simple dague, a peine affutée histoire de montrer la couleure du sang aux parieurs, mais rien de bien impressionnant pour un combatant, naturelement vous etes d'accord, n'est ce pas ? bien...", "start_pugilat3", []],
  
  [anyone|plyr ,"start_pugilat3", [],  "Je n'éprouve nule plaisire a me blésser de mon plein gré.", "close_window", []],
  
  [anyone ,"start_pugilatok", [],"Magnifique, magnifique...entrez simplement par cette porte et ne vous faites pas voir, bonne chance.", "close_window",
    [
      (assign,"$pugilatfinis",0),
      (jump_to_menu, "mnu_pugilat"),
      (finish_mission),
  ]],
  
  #1429E DIALOGUES SUITE
  
  #1spectacteur pugila
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_spectapugilat_1"),
    ],
    "Donne nous en pour notre argent.", "start_pugilatspecta",
    [
      
  ]],
  
  [anyone|plyr ,"start_pugilatspecta", [],  "Il y aurra bien assez de sang.", "close_window", []],
  [anyone|plyr ,"start_pugilatspecta", [],  "Quelle horde d'animeaux etes vous donc ?", "close_window", []],
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_spectapugilat_2"),
    ],
    "On veux du spectacle.", "start_pugilatspecta2",
    [
      
  ]],
  
  [anyone|plyr ,"start_pugilatspecta2", [],  "On est tous la pour ca.", "close_window", []],
  [anyone|plyr ,"start_pugilatspecta2", [],  "Espece de porc.", "close_window", []],
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_spectapugilat_3"),
    ],
    "Va parler au responssable des paris...sache que je ne miseras pas sur toi, alors tache de perdre.", "start_pugilatspecta3",
    [
      
  ]],
  
  [anyone|plyr ,"start_pugilatspecta3", [],  "Et bien...Bonne chance.", "close_window", []],
  [anyone|plyr ,"start_pugilatspecta3", [],  "Je me ferais un plaisire de te faire perdre de l'argent.", "close_window", []],
  #combatant
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_combatant_pugilat"),
    ],
    "Quand j'en aurais fini avec toi tu pisseras jamais plus comme avant.", "start_pugilatspectafight",
    [
      
  ]],
  
  [anyone|plyr ,"start_pugilatspectafight", [],  "Tu as l'air bien sure de toi pour quelqu'un qui va perdre.", "close_window", []],
  [anyone|plyr ,"start_pugilatspectafight", [],  "Pourquois tant de haine ? et si on se contentais de....", "start_pugilatspectafightof", []],
  
  [anyone ,"start_pugilatspectafightof", [],"Va dire au parieurs que je suis pret a tuer un autre fils de chienne.", "close_window", []],
  
  
  
  #parieur
  
  
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_parieur_1"),
      (eq, "$pugilatfinis", 1),
    ],
    "Le vainqueur est... vous...Incroyable.", "start_pugilatparieurwins",
    [
      
  ]],
  
  [anyone|plyr ,"start_pugilatparieurwins",
    [
      (this_or_next|eq, "$pari_pugila_100", 1),
      (this_or_next|eq, "$pari_pugila_200", 1),
      (eq, "$pari_pugila_300", 1),
      ],  "Et pour mes gains ?", "start_pugilatparieur_mfoi", []],
  
  
  [anyone|plyr ,"start_pugilatparieurwins",
    [
      (this_or_next|eq, "$pari_pugila_100", 0),
      (this_or_next|eq, "$pari_pugila_200", 0),
      (eq, "$pari_pugila_300", 0),
    ],  "Ca n'etait pas si dur, trouvez autre chose la prochaine fois.", "close_window",
    [
      (jump_to_menu, "mnu_town"),
      (finish_mission,0),#
  ]],
  
  [anyone ,"start_pugilatparieur_mfoi", [],"Comment ca ?", "start_pugilatparieur_mfoi2",[]],
  
  
  [anyone|plyr ,"start_pugilatparieur_mfoi2", [],  "Ces Messires aimeraient peut etre parier sur un combat entre vous et moi...", "start_pugilatparieur_mfoi3", []],
  
  
  [anyone ,"start_pugilatparieur_mfoi3", [],"Ah! oui bien sur, les paris...voila, bien le bonjour.", "close_window",
    [
      (call_script, "script_c_g_pugilat"),
      (assign, "$pugilatfinis", 0),
      (jump_to_menu, "mnu_town"),
      (finish_mission,0),#
  ]],
  
  
  
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_parieur_1"),
    ],
    "Vous etes prets messires ?", "start_pugilatparieur",
    [
      
  ]],
  
  [anyone|plyr ,"start_pugilatparieur", [],  "Je veux parier sur moi.", "start_pugilatparieur_tobelt", []],
  [anyone|plyr ,"start_pugilatparieur", [],  "Je suis pret, je combaterais pour rien, juste pour me tenire en forme...", "pugi_to_fighttfait", []],
  [anyone|plyr ,"start_pugilatparieur", [],  "Je veux partire d'ici tout de suite.", "start_pugilatparieursortie", []],
  
  [anyone ,"start_pugilatparieursortie", [],"Quois, c'est une blague ? oh j'ai compris, fout le camp fillette.", "close_window",
    [
      (jump_to_menu, "mnu_town"),
      
      (finish_mission,0),#
  ]],
  
  
  [anyone ,"start_pugilatparieur_tobelt", [],"Bien sure, combien tu veux perdre ?", "pugi_to_fightt",
    [
  ]],
  
  
  
  [anyone|plyr,"pugi_to_fightt", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",20),
      ], "20 ecus.", "pugi_to_fighttfait",[
      (troop_remove_gold,"trp_player",20),
      (assign, "$pari_pugila_100", 1),
  ]],
  
  [anyone|plyr,"pugi_to_fightt", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",50),
      ], "50 ecus.", "pugi_to_fighttfait",[
      (troop_remove_gold,"trp_player",50),
      (assign, "$pari_pugila_200", 1),
  ]],
  
  
  [anyone|plyr,"pugi_to_fightt", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge,":gold",100),
      ], "100 ecus.", "pugi_to_fighttfait",[
      (troop_remove_gold,"trp_player",100),
      (assign, "$pari_pugila_300", 1),
  ]],
  
  
  
  [anyone|plyr,"pugi_to_fightt", [
      ], "En fait rien.", "pugi_to_fighttrien",[]],
  
  
  [anyone,"pugi_to_fighttrien", [
      ], "C'est très drole...", "close_window",[]],
  
  
  
  [anyone ,"pugi_to_fighttfait", [],"Messires, pas de coups de jarnac et ne terminez pas trop vite, laissez nous le temps d'aprecier...", "pugi_to_fighttfait2",
    [
  ]],
  
  [anyone ,"pugi_to_fighttfait2", [],"Combatez !!!", "close_window",
    [(team_set_relation, 0, 1, 0),(team_set_relation, 0, 2, -1),(team_set_relation, 1, 0, 0),(team_set_relation, 1, 2, 0),(team_set_relation, 2, 0, -1),(team_set_relation, 2, 1, 0),(mission_disable_talk),
  ]],
  
  
  #ribaude taverne
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_courtisane_taverne"),
    ],
    "Le bonsoir Monseigneur, ces muscles...ils ont l'air meurtris laissez moi vous aider a vous detendre...pour quele pieces bien entendu.", "start_ribaude_tavern",
    [
      (play_sound, "snd_ribaudes"),
  ]],
  
  [anyone|plyr ,"start_ribaude_tavern", [],  "Combien ?", "start_ribaude_tavernok", []],
  [anyone|plyr ,"start_ribaude_tavern", [],  "Je n'ai pas besoin de ca.", "close_window", []],
  
  [anyone ,"start_ribaude_tavernok", [],"Qu'est ce que 200 écus représentent...", "start_ribaude_tavernok2",
    [
  ]],
  
  [anyone|plyr ,"start_ribaude_tavernok2", [],  "C'est une somme, que peut tu bien vendre a ce prix ?", "start_ribaude_tavernok3", []],
  [anyone|plyr ,"start_ribaude_tavernok2", [],  "200 écus, justement.", "close_window", []],
  
  [anyone ,"start_ribaude_tavernok3", [],"Et bien vous serez mon Seigneur, et en tant que votre fidele servante je n'aurais cure que de vous satisfaire...pour la soiré bien sur, j'ai des betes et un grand pere a nourire au levé du jour.", "start_ribaude_tavernok4",
    [
  ]],
  
  
  [anyone|plyr ,"start_ribaude_tavernok4", [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 200),
    ],
    "D'accord, a condition que tu ne parle plus.", "start_ribaude_tavernok4go", [    (troop_remove_gold,"trp_player",200),]],
  
  [anyone|plyr ,"start_ribaude_tavernok4", [],  "Pas cette fois.", "close_window", []],
  
  
  
  [anyone ,"start_ribaude_tavernok4go", [],  "Bien Monseigneur, Suivez moi.", "close_window",
    [
      (jump_to_menu, "mnu_courtesan_accept5"),
      (finish_mission),
  ]],
  
  
  #dial attaque franc macon a loge secrete orleans
  [anyone,"start", [(eq, "$g_talk_troop", "trp_f_macon_hache2m"),
      # (eq, "$quete_templiers_encore_poss", 1),
    ],
    "Halte! Ou croit tu aller mécreant ?", "maconique_loge_s",#><<<<<<<<<<<<<<<<<<<<<<<<<
    [
  ]],
  
  [anyone|plyr ,"maconique_loge_s", [],  "Nous pouvons peut etre trouver un arangement...", "maconique_loge_s2", []],
  
  [anyone ,"maconique_loge_s2", [],"Nous éssayerons d'en trouver un aprés ta mort.", "close_window",
    [
      (mission_disable_talk),
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 1, 0, -1),
      (play_sound, "snd_man_warcry"),
  ]],
  
  
  
  
  #dial attaque franc macon a sortie rennes le chateau
  [anyone,"start", [(eq, "$g_talk_troop", "trp_f_macon_bouclier"),
      # (eq, "$quete_templiers_encore_poss", 1),
    ],
    "J'accuse ! Tenter de dérober les biens de la Fanc Maconerie est passible de la peine capitale.", "maconique_p_capitale",#><<<<<<<<<<<<<<<<<<<<<<<<<
    [
  ]],
  
  [anyone|plyr ,"maconique_p_capitale", [],  "Et si vous m'expliquier ce qu'il se passe...", "maconique_p_capitale3", []],
  
  [anyone ,"maconique_p_capitale3", [],"Assez parlé, place aux actes.", "close_window",
    [
      (mission_disable_talk),
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 1, 0, -1),
      (play_sound, "snd_man_warcry"),
      #(assign, "$rennes_chat_prem_macon", 1),
  ]],
  
  
  
  
  #dial viel aventurier mission accept? en attente sortie taverne
  [anyone,"start", [(eq, "$g_talk_troop", "trp_v_aventurier"),
      (eq, "$quete_templiers_donne", 1),
    ],
    "Vous le le regretterez pas Messire, soyez en assuré, je vous ai dit tout ce que je savais.", "fin_quete_temp",
    [
  ]],
  
  [anyone|plyr ,"fin_quete_temp", [],  "Dans ce cas en route, adieu.", "close_window", []],
  
  
  
  
  
  
  #dial viel aventurier mission refus? mais encore possible
  [anyone,"start", [(eq, "$g_talk_troop", "trp_v_aventurier"),
      (eq, "$quete_templiers_encore_poss", 1),
    ],
    "Vous revoila, estes vous interessé par ma précieuse information finalement ?", "maconique_deux_chanceviela",#><<<<<<<<<<<<<<<<<<<<<<<<<
    [
  ]],
  
  [anyone|plyr ,"maconique_deux_chanceviela", [],  "Rappellez moi votre histoire.", "maconique_deux_chanceviela2", []],
  [anyone|plyr ,"maconique_deux_chanceviela", [],  "Pas pour le moment, nous verons plus tard.", "close_window", []],
  
  [anyone ,"maconique_deux_chanceviela2", [],"Etiez vous donc saoul quand je vous en ai parlé ? les indices, l'ordre du temple, l'organisation maconique, et surtout le tresort ! Je vous rappelle que je vend l'information qui vous metterais sur la piste du butin des templiers, c'est toujours 3000 piéces.", "maconique_deux_chanceviela3",
    [
  ]],
  
  
  [anyone|plyr ,"maconique_deux_chanceviela3",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 3000),
    ],  "C'est d'accord, je vais tenter ma chance.", "maconique_deux_chancevielaok",
    [
      (troop_remove_gold, "trp_player", 3000),
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Un Aventurier d'un age avancé m'as vendu une histoire aussi incroyable que cela puisse paraitre j'ai accepté son offre, je doit trouver la carte des temples secrets de l'ordre des templiers afin de retrouver leurs trésorts, le viel aventurier m'as aussi parlé de l'ordre des francs macons a la recherche de l'or du temple également, je ferais mieux d'etre prudent.Le prochain indice indique qu'il faut trouver le manuscrit secret des croyances et rites des templiers dissimulé dans une logue secrete de la bibliothèque du monastere de Carmel de Micy a Orléans"),
      (call_script, "script_start_quest", "qst_tresort_t", "$g_talk_troop"),
      
  ]],
  [anyone|plyr ,"maconique_deux_chanceviela3", [],  "Pas pour le moment, Je doit y réfléchire.", "maconique_deux_chanceviela2no", []],
  
  [anyone ,"maconique_deux_chanceviela2no", [],"Et bien je vais continuer a voyager tant que personne ne m'aura liberé de ce fichu tresort, je ne pensse qu'a ca.", "close_window",
    [
  ]],
  
  
  
  
  
  
  [anyone ,"maconique_deux_chancevielaok", [],"Vous faites une bonne affaire croyez moi, bien... vous devrez rechercher la carte des temples secrets, c'est la qu'ils entreposaient l'or des croisades et de leurs nombreux revenus. Pour l'heure l'indice vous enménera a la bibliothèque du monastere de Carmel de Micy d'Orléans, bonne chance pour la suite.", "close_window",
    [
      #set flag ou quartier d?loqu?si quete active reporter a deuxieme chance !!!!!!!!!!!!!!!!
      #############  ##############  ############  ###################
      (assign, "$quete_templiers_donne", 1),
      
  ]],
  
  
  #dial viel aventurier  (assign, "$quete_templiers_donne", 1), a mission accept? !
  [anyone,"start", [(eq, "$g_talk_troop", "trp_v_aventurier"),
      
    ],
    "Messire, vous avez devans vous un homme épuisé, mais un homme qui as aussi la meilleure proposition que vous n'ayez jamais entendue a vous faire, que dites vous de cela ?", "dia_temp_startt",
    [
      (play_sound, "snd_maitre_guild"),
  ]],
  
  [anyone|plyr ,"dia_temp_startt", [],  "Ca ne coute rien d'écouter, de quois s'agit il ?", "dia_temp_startt_interet", []],
  [anyone|plyr ,"dia_temp_startt", [],  "J'en dit que vous aurez désaoulé aprés une bonne nuit de someil, adieu.", "close_window", [(assign, "$quete_templiers_encore_poss", 1),]],
  
  [anyone ,"dia_temp_startt_interet", [],"Et bien voila mon histoire, mais d'abord que connaissez vous de l'ordre des templiers ? vous devez savoir qu'ils étaient très puissant et très riches, les dérniers representants furent executés en 1310 par le roi Capetien, n'ayant plus de menbres officiels l'or que cet ordre as put rassembler reste donc bien dissimulé et peut de personnes connaissent son existance meme.", "dia_temp_startt_interetsuit",
    [
  ]],
  
  
  [anyone|plyr ,"dia_temp_startt_interetsuit", [],  "Et vous, comment savez vous cela ?", "dia_temp_startt_interetsuit2", []],
  
  [anyone ,"dia_temp_startt_interetsuit2", [],"J'ai oui dire de cette...légende dans un monastere alors que j'acconpagnais le seigneur que je devais protéger lors de sa quete de l'or des templiers, il fut assassiné malgrés ma garde et j'ai depuis lors décidé de poursuivre moi meme la quete quand je me suis appercu que j'en savais bien assez.", "dia_temp_startt_interetsuit3",
    [
  ]],
  
  [anyone|plyr ,"dia_temp_startt_interetsuit3", [],  "Ca as l'air tout de meme assez dangereux, avez vous découvert qui avais tué le seigneur que vous protégiez ? et qui je suppose on commencé a s'en prendre a vous dés lors que vous avez récupperé l'affaire de votre seigneur.", "dia_temp_startt_interetfin", []],
  
  
  
  [anyone ,"dia_temp_startt_interetfin", [],"Vous avez vu juste, j'ai fini par découvrire qu'il s'agis d'une societe secrete dont ses menbres se nomment eux meme les francs macons.", "dia_temp_startt_interetfin2",
    [
  ]],
  
  [anyone|plyr ,"dia_temp_startt_interetfin2", [],  "Mais qu'est ce que ceci a avoir avec moi ?", "dia_temp_startt_interetsuit_etfin", []],
  
  [anyone ,"dia_temp_startt_interetsuit_etfin", [],"Je suis las de cette quete, cela fait si longtemps que je l'ai commencé, j'aimerais a present m'endormire sans avoir a garder la main sur le pommeau de mon épée, aussi je vend la dérniére information que j'ai put j'ai pu receuillir lors de mes voyages, cette quete peut vous passionner au point meme de vous rendent fou, au pire vous n'aurez qu'a la vendre vous meme dans une autre taverne dans une autre époque, qui sait dans combien de mains est t'elle déja passée, je suis proche du but je le sent mais je doit m'aretter ici, la nuit est tombée pour moi et cela fait trop de saisons que je coure les forets de ville en ville a la recherche du prochain indice, donc cet information je la vend Messire et seulement 3000 écus qu'en dites vous ?", "dia_temp_starttpaye",
    [
  ]],
  
  
  [anyone|plyr ,"dia_temp_starttpaye",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 3000),
    ],
    "C'est d'accord, il me semble que l'emoi que vous inspire cette histoire prouve qu'elle est réelle.", "dia_temp_startt_quetelancee",
    [
      (troop_remove_gold, "trp_player", 3000),
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Un Aventurier d'un age avancé m'as vendu une histoire ! aussi incroyable que cela puisse paraitre j'ai accepté son offre, je doit trouver la carte des temples secrets de l'ordre des templiers afin de retrouver leurs trésorts, le viel aventurier m'as aussi parlé de l'ordre des francs macons a la recherche de l'or du temple également, je ferais mieux d'etre prudent.Le prochain indice indique qu'il faut trouver le manuscrit secret des croyances et rites des templiers dissimulé dans une logue secrete de la  du monastere de Carmel de Micy a Orléans"),
      (call_script, "script_start_quest", "qst_tresort_t", "$g_talk_troop"),
      
  ]],
  
  [anyone|plyr ,"dia_temp_starttpaye",
    [
      
    ],
    "J'en pensse que vous etes un exelent orateur et que vos perfidies pourront distraire quelques dames de la cour, Adieu", "close_window",
    [
      #lancer deuxieme dial avec "rppellez moi votre histoire"
      
      (assign, "$quete_templiers_encore_poss", 1),
  ]],
  
  [anyone|plyr ,"dia_temp_starttpaye",
    [
      
    ],
    "Cela ne m'intéresse pas pour le moment, nous verons plus tard si nous nous retrouverons", "close_window",
    [
      #lancer deuxieme dial avec "rppellez moi votre histoire"
      
      (assign, "$quete_templiers_encore_poss", 1),
  ]],
  
  
  
  [anyone ,"dia_temp_startt_quetelancee", [],"Vous faites une bonne affaire croyez moi, bien... vous devrez rechercher la carte des temples secrets, c'est la qu'ils entreposaient l'or des croisades et de leurs nombreux revenus. Pour l'heure l'indice vous enménera a la bibliothèque du monastere de Carmel de Micy d'Orléans, bonne chance pour la suite.", "close_window",
    [
      #set flag ou quartier d?loqu?si quete active reporter a deuxieme chance !!!!!!!!!!!!!!!!
      #############  ##############  ############  ###################
      (assign, "$quete_templiers_donne", 1),
      
  ]],
  ##############################################################################################################################################################################################
  
  
  #Dial moine interieur bibliotheque
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_moin_orleans_interieur"),
      (check_quest_active, "qst_ouvrire_loge"),
      (neg|check_quest_succeeded, "qst_ouvrire_loge"),
      (neg|check_quest_failed, "qst_ouvrire_loge"),
      (neg|check_quest_finished, "qst_ouvrire_loge"),
    ],
    "Encore vous ? que voullez vous ?", "moine_orl_jour",#><<<<<<<<<<<<<<<<<<<<<<<<<
    
    [
      #(play_sound,"snd_eternue"),
  ]],
  
  
  [anyone|plyr ,"moine_orl_jour", [],  "Comment va votre rhume ?", "moine_orl_jourrhum", []],
  [anyone|plyr ,"moine_orl_jour", [],  "Votre compagnie est des plus insuportable, je préfère revenire plus tard.", "close_window", []],
  
  
  [anyone ,"moine_orl_jourrhum", [],"Beaucoup mieux, merci de faire semblant de vous en souccier.", "moine_orl_jourrhum2",
    [
  ]],
  
  [anyone|plyr ,"moine_orl_jourrhum2", [],  "Etes vous...toute la journée ainssi cloitré ? pourquois ne pas prendre un peut l'air ?", "moine_orl_jourrhum3", []],
  
  
  [anyone ,"moine_orl_jourrhum3", [],"Et qui va s'occupper des livres, vous ? il faut classer ce qui as été retiré des étagère, écrire l'ordre du jour, et tout ce qui s'en suit.", "moine_orl_jourrhum4",
    [
  ]],
  
  [anyone|plyr ,"moine_orl_jourrhum4", [],  "Rassurez moi, vous dormez quand meme ?", "moine_orl_jourrhum5", []],
  
  
  [anyone ,"moine_orl_jourrhum5", [],"Bien entendu, quelle question. Je me retire dans mes appartements pour la nuit...pourquois sommes nous en train de parler de ceci ? voulliez vous me divertire ? Et bien vous me faites simplement perdre mon temps, je ne vous retiens pas...", "close_window",
    [
  ]],
  
  # faire dial une fois le moyen d'ouvrire la porte secrete "vous ne sortez jamais..."
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_moin_orleans_interieur"),
      (check_quest_active, "qst_rennes_chateau"),
      (neg|check_quest_succeeded, "qst_rennes_chateau"),
      (neg|check_quest_failed, "qst_rennes_chateau"),
      (neg|check_quest_finished, "qst_rennes_chateau"),
    ],
    "...NON, je ne veux plus parler avec vous.", "moine_orleans_intend",#><<<<<<<<<<<<<<<<<<<<<<<<<
    
    [
      (play_sound,"snd_eternue"),
  ]],
  
  
  [anyone|plyr ,"moine_orleans_intend", [],  "Vous devriez sortire un peut d'ici.", "moine_orleans_intend2", []],
  
  
  [anyone ,"moine_orleans_intend2", [],"Encore des sarcasmes ?!", "close_window",
    [
  ]],
  
  
  
  #apr? avoir vu fresque et message
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_moin_orleans_interieur"),
      (eq, "$debloque_dial_bibliotequaire", 1),
    ],
    "...Oui ?", "moine_orleans_interieur_vue",#><<<<<<<<<<<<<<<<<<<<<<<<<
    
    [
      (play_sound,"snd_eternue"),
  ]],
  
  
  [anyone|plyr ,"moine_orleans_interieur_vue", [],  "Que represente la fresque du fond avec un guerrier ?", "moine_orleans_interieur_vue2", []],
  
  
  
  
  [anyone ,"moine_orleans_interieur_vue2", [],"Et bien...Je ne saurrais quois répondre...Un instant! oui, je me souviens avoir lu quelque chose dans un manuscrit a propos de cette fresque il y as bien longtemps, vous rendez vous compte ? un livre entreposé dans un lieux qui décrit le lieux lui meme, c'est précisément cela qui m'as marqué !", "moine_orleans_interieur_sarcasme",
    [
  ]],
  
  
  [anyone|plyr ,"moine_orleans_interieur_sarcasme", [],  "En effet, c'est incroyable...", "moine_orleans_interieur_sarcasme2", []],
  
  
  [anyone ,"moine_orleans_interieur_sarcasme2", [],"Un instant, serais ce un sarcasme ? Insinueriez vous que ma vie n'est point passionnante ?", "moine_orleans_interieur_sarcasme3",
    [
  ]],
  
  
  [anyone|plyr ,"moine_orleans_interieur_sarcasme3", [],  "Absolument pas, je disait juste que c'est incroyable ! mais alors, a propos de la fresque ...", "moine_orleans_interieur_sarcasmefin", []],
  
  [anyone ,"moine_orleans_interieur_sarcasmefin", [],"Ah! oui, j'ai donc lu qu'il s'agis de...impossible de me rappeller de ce nom vous le comprendrez, mais je me souviens que les armoiries peintes sur le bouclier sont celles du bourg de Renne le chateau en Provence.", "moine_orleans_interieur_sarcasmefin2",
    [
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le moine scribe de la bibliothèque d'Orléans m'as remis malgrés lui sur la piste du tréort des templiers. Je doit enqueter sur le personnage peint sur la fresque du mur dans le monastere d'Orléans, ils semblerais que les armoiries peintes correspondes avec celles du seigneur de Rennes le chateau en Provence."),
      (call_script, "script_start_quest", "qst_rennes_chateau", "$g_talk_troop"),
  ]],
  
  [anyone ,"moine_orleans_interieur_sarcasmefin2", [],"Si vous avez tant d'interet pour cette fresque et ce seigneur pourquois ne pas faire le voyage jusqu'en Provence pour aller voir de vos yeux d'autres fresques le représentant ? Avec un peut de chance vous retrouverez meme son armure dans son chateaux, Et oui cela est bien un sarcasme, Maintenant pardonnez mon impatience mais cessez de me tourmenter avec de telles futilités et laissez moi profiter de l'humidité.", "close_window",
    [
  ]],
  #### apres premier dial
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_moin_orleans_interieur"),
      (eq, "$dialsuivant_bibliotec", 1),
    ],
    "...Ce rhume est vraiment agacant, que voullez vous encore ?", "trp_moin_orleans_interieur_s2",#><<<<<<<<<<<<<<<<<<<<<<<<<
    [
      (play_sound,"snd_eternue"),
      
  ]],
  
  
  [anyone|plyr ,"trp_moin_orleans_interieur_s2", [],  "Puis je poser quelques questions ?", "trp_moin_orleans_interieur_s3", []],
  
  
  
  
  [anyone ,"trp_moin_orleans_interieur_s3", [],"Oh seigneur...bien, je vous écoute mais faites vite...", "trp_moin_orleans_interieur_s4",
    [
  ]],
  
  [anyone|plyr ,"trp_moin_orleans_interieur_s4", [],  "Les livres sont ils tous dans cette pièce ?", "trp_moin_orleans_interieur_livre", []],
  [anyone|plyr ,"trp_moin_orleans_interieur_s4", [],  "Que représentent ces fresques murales derrière vous ?", "trp_moin_orleans_interieur_fresq", []],
  [anyone|plyr ,"trp_moin_orleans_interieur_s4", [],  "Ca seras tout pour l'instant.", "close_window", []],
  
  [anyone ,"trp_moin_orleans_interieur_livre", [],"Non bien entendu, c'est la salle de lecture et d'écriture, ici nous relisont ce que nos ancetres écrivent depuis la nuit des temps et nous écrivons pour les generations a venire. Demandez moi un ouvrage et je vous l'apporterais...Si je le puis.", "trp_moin_orleans_interieur_s4",
    [
  ]],
  
  [anyone ,"trp_moin_orleans_interieur_fresq", [],"Et bien c'est évident ! les fresques représentent le jugement dérnier et les enfer, la fresque centrale est...disont endomagée par le temps, elle ne pouvais qu'etre en rapport avec les deux autres, je dirais que la fresque centrale représentais le paradis, le salut par la priere, mais aucune importance cela est juste décoratif vous savez.", "trp_moin_orleans_interieur_s4",
    [
  ]],
  
  #### start
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_moin_orleans_interieur"),
    ],
    "...Pardonnez moi, ces murs sont si humides... attendez! qui vous as permis d'entrer ici je vous prie ?", "trp_moin_orleans_interieur_sart",#><<<<<<<<<<<<<<<<<<<<<<<<<
    [
      (play_sound,"snd_eternue"),
      (assign, "$dialsuivant_bibliotec", 1),
  ]],
  
  
  [anyone|plyr ,"trp_moin_orleans_interieur_sart", [],  "Frere Patrique m'as autorisé l'accés de la bibliothèque.", "trp_moin_orleans_interieur_sart2", []],
  
  
  
  
  [anyone ,"trp_moin_orleans_interieur_sart2", [],"Bon, et bien veillez a ne point meéranger...", "close_window",
    [
  ]],
  
  
  
  
  
  ###############################################################################################################################################################################################
  #######################################################
  
  ##### moine figurant
  [anyone,"start", [(eq, "$g_talk_troop", "trp_moin_orleans2"),
    ],
    "Mon frere, si vous voullez des rensseignements adressez vous a frere Patrique.", "moine_orleans_freer",#><<<<<<<<<<<<<<<<<<<<<<<<<
    [   (play_sound,"snd_monfrere"),
  ]],
  
  
  [anyone|plyr ,"moine_orleans_freer", [],  "Je vous remercie.", "close_window", []],
  
  
  
  ##### entree scene version 2 de nuit
  [anyone,"start", [(eq, "$g_talk_troop", "trp_moin_orleans"),
      # (eq, "$entree_libre_monastorleans", 1),
      (check_quest_active, "qst_ouvrire_loge"),
      (neg|check_quest_succeeded, "qst_ouvrire_loge"),
      (neg|check_quest_failed, "qst_ouvrire_loge"),
      (neg|check_quest_finished, "qst_ouvrire_loge"),
      (is_currently_night),
    ],
    "Mon frere? que puis je pour vous a cette heure tardive ?", "moine_orleans_laissepassenui",#><<<<<<<<<<<<<<<<<<<<<<<<<
    [   (play_sound,"snd_monfrere2"),
  ]],
  
  [anyone|plyr ,"moine_orleans_laissepassenui", [],  "Je désire entrer de nouveau.", "moine_orleans_laissepassenui2", []],
  [anyone|plyr ,"moine_orleans_laissepassenui", [],  "Rien pour le moment, salutaions.", "close_window", []],
  
  [anyone ,"moine_orleans_laissepassenui2", [],"Certes, mais tachez de dormir un peut ou vous risquez de tomber malade.", "close_window",
    [
      #script entr?...
      (call_script, "script_entree_monastere_orl_fin"),
  ]],
  
  ##### entree scene version 2 de jour
  [anyone,"start", [(eq, "$g_talk_troop", "trp_moin_orleans"),
      # (eq, "$entree_libre_monastorleans", 1),
      (check_quest_active, "qst_ouvrire_loge"),
      (neg|check_quest_succeeded, "qst_ouvrire_loge"),
      (neg|check_quest_failed, "qst_ouvrire_loge"),
      (neg|check_quest_finished, "qst_ouvrire_loge"),
      (neg|is_currently_night),
    ],
    "Mon frere? que puis je pour vous ?", "moine_orleans_laissepasse1",#><<<<<<<<<<<<<<<<<<<<<<<<<
    [   (play_sound,"snd_monfrere2"),
  ]],
  
  [anyone|plyr ,"moine_orleans_laissepasse1", [],  "Je désire entrer de nouveau.", "moine_orleans_laissepasse12", []],
  [anyone|plyr ,"moine_orleans_laissepasse1", [],  "Rien pour le moment, salutaions.", "close_window", []],
  
  [anyone ,"moine_orleans_laissepasse12", [],"Certes mon frere, rigueur et discipline sont les pierres qui balisent le chemin du savoir.", "close_window",
    [
      #script entr?...
      (call_script, "script_entree_monastere_orl"),
  ]],
  
  
  ##### entree libre
  [anyone,"start", [(eq, "$g_talk_troop", "trp_moin_orleans"),
      (eq, "$entree_libre_monastorleans", 1),
    ],
    "Mon frere? que puis je pour vous ?", "moine_orleans_laissepasse",#><<<<<<<<<<<<<<<<<<<<<<<<<
    [   (play_sound,"snd_monfrere2"),
  ]],
  
  [anyone|plyr ,"moine_orleans_laissepasse", [],  "Je désire entrer de nouveau.", "moine_orleans_laissepasse_encore", []],
  [anyone|plyr ,"moine_orleans_laissepasse", [],  "Rien pour le moment, salutaions.", "close_window", []],
  
  [anyone ,"moine_orleans_laissepasse_encore", [],"Certes mon frere, rigueur et discipline sont les pierres qui balisent le chemin du savoir.", "close_window",
    [
      #script entr?...
      (call_script, "script_entree_monastere_orl"),
  ]],
  
  
  
  
  
  
  #dial moine Carmel de Micy a Orléans
  [anyone,"start", [(eq, "$g_talk_troop", "trp_moin_orleans"),
      
      (store_current_hours,":cur_hours"),
      (val_sub, ":cur_hours", 24),
      (gt, ":cur_hours", "$gamble_last_time"),
      
    ],
    "Le bonjour mon frere, que puis je pour vous ?", "moine_orleans_q",#><<<<<<<<<<<<<<<<<<<<<<<<<
    [(play_sound,"snd_monfrere2"),
  ]],
  
  [anyone|plyr ,"moine_orleans_q", [],  "Je désire étudier certains de vos livres, ils paraitrais que vous possédez une incroyable bibliothèque.", "moine_orleans_q2", []],
  [anyone|plyr ,"moine_orleans_q", [],  "Rien pour le moment, salutaions.", "close_window", []],
  
  [anyone ,"moine_orleans_q2", [],"Certes mon frere vous me flattez, mais qu'est ce qui vous intéresse précisément ? il vous faudrais une bonne raison pour que je vous laisse pénetrer notre enceinte.", "moine_orleans_qwhy",
    [
  ]],
  
  
  [anyone|plyr ,"moine_orleans_qwhy", [],  "J'étudie les arts de la caligraphie et je souhaite perfectioner ma maitrise en étudiant vos manuscrits anciens.", "moine_orleans_qwhyok1", []],
  [anyone|plyr ,"moine_orleans_qwhy", [],  "J'aimerais juste jetter un oeil, peut etre que nous pouvons nous arranger en échange d'une donnation.", "moine_orleans_qwhyfail1", []],
  [anyone|plyr ,"moine_orleans_qwhy", [],  "J'ai été pretre ici meme, je voudrais me remémorer ce passage de ma vie en revisitant quelques endroits.", "moine_orleans_qwhyfail2", []],
  [anyone|plyr ,"moine_orleans_qwhy", [],  "J'enquete sur la descendance d'une noble famille, quelques manuscrits que vous possédez pourraient m'en apprendre d'avantage .", "moine_orleans_qwhyok2_etquest", []],
  
  
  [anyone|plyr ,"moine_orleans_qwhy", [],  "Je reviendrais plus tard.", "close_window", []],
  
  
  [anyone ,"moine_orleans_qwhyok1", [],"Ainsi vous partagez nostre art, pourtant vous n'estes pas frere n'est ce pas ?", "moine_orleans_qwhy22",[]],
  #a faire
  [anyone ,"moine_orleans_qwhyfail1", [],"Que dites vous la ? Ai je mal entendu ou vous voullez me corompre, hors de ma vue misérable", "close_window",
    [
      #time gamble last time et variable pour avoir dial suivant...+ autre variable pour avoir "vous revoila ?"
      (store_current_hours,":cur_hours"),
      (assign, "$gamble_last_time", ":cur_hours"),
      (assign, "$dial_gamblelt_monastorleans", 1),  ##################################################
  ]],
  ##a faire
  [anyone ,"moine_orleans_qwhyfail2", [],"Vous etiez frere ici meme vous dites ? je ne me rappelle absolument pas pas de vostre visage, vous n'estes qu'un voleur qui souhaite dérober des manuscrits, GARDES... par ici !", "close_window",
    [
      (jump_to_menu,"mnu_captivity_start_castle_defeat"),
      (finish_mission,0),
      
  ]],
  ###a faire
  [anyone ,"moine_orleans_qwhyok2_etquest", [],"Vraiment ? Certes, je pourrais vous laisser entrer, mais je doit etre sur de vos intentions, pour quelle famille travaillez vous ?", "moine_orleans_qwhyfam",[]],
  
  [anyone|plyr ,"moine_orleans_qwhyfam", [],  "Gilles de Rais baron de provence.", "moine_orleans_repfailll", []],
  [anyone|plyr ,"moine_orleans_qwhyfam", [],  "Messire Etiennes de Vignolles, que les anglois appellent la Hire.", "moine_orleans_repvictory", []],
  [anyone|plyr ,"moine_orleans_qwhyfam", [],  "Francois forgeron, seigneur du chateau de la loire.", "moine_orleans_repfailll", []],
  [anyone|plyr ,"moine_orleans_qwhyfam", [],  "Jean Poton de Xaintrailles duc de Paris.", "moine_orleans_repfailll", []],
  
  [anyone ,"moine_orleans_repfailll", [],"Vous vous amusez de moi ? j'ai austre chose a faire, maintenant partez.", "close_window",
    [
      (store_current_hours,":cur_hours"),
      (assign, "$gamble_last_time", ":cur_hours"),
      (assign, "$dial_gamblelt_monastorleans", 1),  ##################################################
  ]],
  
  [anyone ,"moine_orleans_repvictory", [],"Certes, je vais vous laisser entrer Messire, cela a l'air important, loing de moi l'idée de faire obstacle aux affaires de nobles seigneurs.", "moine_orleans_entreeok",
    [
      (assign, "$entree_libre_monastorleans", 1),
  ]],
  
  
  
  
  
  
  [anyone|plyr ,"moine_orleans_qwhy22", [],  "En effet, je suis une simple personne lettrée ou ce que l'on appelle comunément un scribe.", "moine_orleans_qwhy22ok", []],
  [anyone|plyr ,"moine_orleans_qwhy22", [],  "Vous vous trompez mon pere, j'ai bien été un frere dans un austre monastere, j'était affecté a l'écriture.", "moine_orleans_qwhy22fai", []],
  
  
  [anyone ,"moine_orleans_qwhy22fai", [],"Que me racontez vous donc ? qui estes vous ? vous dites que vous avez été frere et vous m'appellez mon pere au lieu de frere, puis vous me parlez d'affectation a l'ecriture...nous ne somme pas des soldats voyons, qui que vous soyez partez sur le champ avant que je n'appelle la garde.", "close_window",
    [
      #time gamble last time et variable pour avoir dial suivant...+ autre variable pour avoir "vous revoila ?"
      (store_current_hours,":cur_hours"),
      (assign, "$gamble_last_time", ":cur_hours"),
      (assign, "$dial_gamblelt_monastorleans", 1),  ##################################################
  ]],
  
  [anyone ,"moine_orleans_qwhy22ok", [],"Certes mon frere, certes...C'est d'accord, je vous laisse entrer pour l'étude de l'art de l'écriture, veillez cependant a ne pas nous troubler avec des questions.", "moine_orleans_entreeok",
    [
      #win assigner variable debloque dial entrer...quand je veux autant que je veux
      (assign, "$entree_libre_monastorleans", 1), #####################################################       moine_orleans_entreeok <<<<  vers topc entree <<<<<<<<<<<<<<<<<<<<<<<<<
  ]],
  
  
  [anyone|plyr ,"moine_orleans_entreeok", [],  "Je vous remercie de tout coeur, j'aimerais entrer sans délais.", "moine_orleans_qwhy22okscript", []],
  [anyone|plyr ,"moine_orleans_entreeok", [],  "Je vous remercie mon frere, je reviens bientot.", "close_window", []],
  
  [anyone ,"moine_orleans_qwhy22okscript", [],"Une telle fougue fait plaisire a voir, tachez d'en apprendre le plus possible sur l'écriture.", "close_window",
    [
      #script entr?...
      (call_script, "script_entree_monastere_orl"),
  ]],
  
  
  
  
  # # # # suite construction premier dial reponsses...
  
  
  #  [anyone ,"moine_orleans_q2", [],"Certes mon frere vous me flattez, mais qu'est ce qui vous intéresse précisément ? il vous faudrais une bonne raison pour que je vous laisse pénetrer notre enceinte.", "moine_orleans_qwhy",[]],
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  # # # ## # # ## # # ## # # ## # # ## # # ## # # ## # # #
  
  
  
  
  ##### en attente
  [anyone,"start", [(eq, "$g_talk_troop", "trp_moin_orleans"),
      (eq, "$dial_gamblelt_monastorleans", 1),
    ],
    "Encore vous ? cessez de nous importuner, partez sur le champs", "moine_orleans_lfailpasse",#><<<<<<<<<<<<<<<<<<<<<<<<<
    [
  ]],
  
  
  [anyone|plyr ,"moine_orleans_lfailpasse", [],  "Tout ceci est un affreux malentendu, nous en reparlerons quand vous serrez calmé.", "close_window",
    [
      
  ]],
  
  
  
  ##### en attente  de 24 heures au cas ou au debut du jeu
  [anyone,"start", [(eq, "$g_talk_troop", "trp_moin_orleans"),
      (eq, "$dial_gamblelt_monastorleans", 0),
    ],
    "Salutations mon frere, que puis je pour vous ?", "moine_orleans_lfailpasse_attente",#><<<debut du jeu pas encore 24 heures <
    [(play_sound,"snd_monfrere2"),
  ]],
  
  
  [anyone|plyr ,"moine_orleans_lfailpasse_attente", [],  "J'aimerais entrer pour étudier certains de vos livres.", "moine_orleans_lfailpasse_attente2", []],
  
  [anyone ,"moine_orleans_lfailpasse_attente2", [],"Pas pour le moment mon frere, nous sommes en prières nous en parlerons plus tard.", "close_window",[]],
  
  
  
  ###########################
  [anyone,"start", [(eq, "$g_talk_troop", "trp_mendiant_rc"),
    ],
    "Fout l'camp.", "clochard_de_renne",#><<<debut du jeu pas encore 24 heures <
    [
  ]],
  
  
  [anyone|plyr ,"clochard_de_renne", [],  "Je n'aime pas ce ton.", "close_window", []],
  
  
  ###################################################### ##################################################### #####################################################
  [anyone,"start", [(is_between, "$g_talk_troop", ransom_brokers_begin, ransom_brokers_end),
      (eq, "$g_talk_troop_met", 0)],
    "Greetings to you, {sir/madam}. You look like someone who should get to know me.", "ransom_broker_intro",[]],
  
  [anyone|plyr,"ransom_broker_intro",[], "Why is that?", "ransom_broker_intro_2",[]],
  [anyone, "ransom_broker_intro_2", [], "I broker ransoms for the poor wretches who are captured in these endless wars. " +
    "Normally I travel between the salt mines and the slave markets on the coast, on commission from those whose relatives have gone missing. " +
    "But if I'm out on my errands of mercy, and I come across a fellow dragging around a captive or two, " +
    "well, there's no harm in a little speculative investment, is there? " +
    "And you look like the type who might have a prisoner to sell.", "ransom_broker_info_talk",[(assign, "$ransom_broker_families_told",0),
      (assign, "$ransom_broker_prices_told",0),
      (assign, "$ransom_broker_ransom_me_told",0),
  ]],
  
  [anyone|plyr,"ransom_broker_info_talk",[(eq, "$ransom_broker_families_told",0)], "What if their families can't pay?", "ransom_broker_families",[]],
  [anyone, "ransom_broker_families", [], "Oh, then I spin them a few heartwarming tales of life on the galleys. " +
    "You'd be surprised what sorts of treasures a peasant can dig out of his cowshed or wheedle out of his cousins, " +
    "assuming he's got the proper motivation! " +
    "And if in the end they cannot come up with the silver, then there are always slave merchants who are looking for galley slaves. " +
    "One cannot do Heaven's work with an empty purse, you see.", "ransom_broker_info_talk",[(assign, "$ransom_broker_families_told",1)]],
  [anyone|plyr,"ransom_broker_info_talk",[(eq, "$ransom_broker_prices_told",0)], "What can I get for a prisoner?", "ransom_broker_prices",[]],
  [anyone, "ransom_broker_prices", [], "It varies. I fancy that I have a fine eye for assessing a ransom. " +
    "There are a dozen little things about a man that will tell you whether he goes to bed hungry, or dines each night on soft dumplings and goose. " +
    "The real money of course is in the gentry, and if you ever want to do my job you'll want to learn about every landowning family in France, " +
    "their estates, their heraldry, their offspring both lawful and bastard, and, of course, their credit with the merchants.", "ransom_broker_info_talk",[(assign, "$ransom_broker_prices_told",1)]],
  [anyone|plyr,"ransom_broker_info_talk",[(eq, "$ransom_broker_ransom_me_told",0)], "Would you be able to ransom me if I were taken?", "ransom_broker_ransom_me",[]],
  [anyone, "ransom_broker_ransom_me", [], "Of course. I'm welcome in every court in France. " +
    "There's not many who can say that! So always be sure to keep a pot of denars buried somewhere, " +
    "and a loyal servant who can find it in a hurry.", "ransom_broker_info_talk",[(assign, "$ransom_broker_ransom_me_told",1)]],
  [anyone|plyr,"ransom_broker_info_talk",[], "That's all I need to know. Thank you.", "ransom_broker_pretalk",[]],
  
  [anyone,"start", [(is_between, "$g_talk_troop", ransom_brokers_begin, ransom_brokers_end),
    ],
    "Greetings. If you have any prisoners, I will be happy to buy them from you.", "ransom_broker_talk",[]],
  [anyone,"ransom_broker_pretalk", [],
    "Anyway, if you have any prisoners, I will be happy to buy them from you.", "ransom_broker_talk",[]],
  
  [anyone|plyr,"ransom_broker_talk",
    [[store_num_regular_prisoners,reg(0)],[ge,reg(0),1]],
    "Then you'd better bring your purse. I have got prisoners to sell.", "ransom_broker_sell_prisoners",[]],
  [anyone|plyr,"ransom_broker_talk", [], "Tell me about what you do again.", "ransom_broker_intro_2",[]],
  
  
  [anyone|plyr,"ransom_broker_talk",[
      ], "I wish to ransom one of my companions.", "ransom_broker_ransom_companion",[]],
  
  [anyone,"ransom_broker_ransom_companion",[], "Whom do you wish to ransom?", "ransom_broker_ransom_companion_choose",[]],
  
  [anyone|plyr|repeat_for_troops,"ransom_broker_ransom_companion_choose",[
      (store_repeat_object, ":imprisoned_companion"),
      (neg|troop_slot_eq, ":imprisoned_companion", slot_troop_occupation, slto_kingdom_hero),
      (is_between, ":imprisoned_companion", companions_begin, companions_end),
      (troop_slot_ge, ":imprisoned_companion", slot_troop_prisoner_of_party, centers_begin),
      (str_store_troop_name, s4, ":imprisoned_companion"),
      ], "{s4}", "ransom_broker_ransom_companion_name_sum",[
      
      (store_repeat_object, "$companion_to_be_ransomed"),
  ]],
  
  [anyone|plyr,"ransom_broker_ransom_companion_choose",[
      ], "Never mind", "ransom_broker_pretalk",[]],
  
  
  [anyone,"ransom_broker_ransom_companion_name_sum",[], "Let me check my ledger, here... Yes. Your friend is being held in the dungeon at {s7}. How interesting! I remember hearing that the rats down there are unusually large -- like mastiffs, they say... Now... For the very reasonable sum of {reg5} denars, which includes both the ransom and my commission and expenses, we can arrange it so that {s5} can once again enjoy {reg4?her:his} freedom. What do you say?", "ransom_broker_ransom_companion_verify",[
      (str_store_troop_name, s5, "$companion_to_be_ransomed"),
      (troop_get_type, reg4, "$companion_to_be_ransomed"),
      
      (troop_get_slot, ":prison_location", "$companion_to_be_ransomed", slot_troop_prisoner_of_party),
      (str_store_party_name, s7, ":prison_location"),
      
      (store_character_level, ":companion_level", "$companion_to_be_ransomed"),
      (store_add, "$companion_ransom_amount", ":companion_level", 20),
      (val_mul, "$companion_ransom_amount", ":companion_level"),
      (val_mul, "$companion_ransom_amount", 5), #Level 1: 110, level 40: 12,000
      (assign, reg5, "$companion_ransom_amount"),
  ]],
  
  [anyone|plyr,"ransom_broker_ransom_companion_verify",[
      (store_troop_gold, ":player_gold", "trp_player"),
      (ge, ":player_gold", "$companion_ransom_amount"),
      
      ], "Here's your money.", "ransom_broker_ransom_companion_accept",[
      (troop_remove_gold, "trp_player", "$companion_ransom_amount"),
      
      
      
      
      (troop_set_slot, "$companion_to_be_ransomed", slot_troop_occupation, slto_player_companion),
      (troop_set_slot, "$companion_to_be_ransomed", slot_troop_current_mission, npc_mission_rejoin_when_possible),
      (troop_set_slot, "$companion_to_be_ransomed", slot_troop_days_on_mission, 1),
      
      (try_begin),
        (troop_get_slot, ":held_at_prison", "$companion_to_be_ransomed", slot_troop_prisoner_of_party),
        (party_count_prisoners_of_type, ":holding_as_prisoner",  ":held_at_prison", "$companion_to_be_ransomed"),
        (gt, ":holding_as_prisoner", 0),
        (party_remove_prisoners, ":held_at_prison", "$companion_to_be_ransomed", 1),
      (try_end),
      (troop_set_slot, "$companion_to_be_ransomed", slot_troop_prisoner_of_party, -1),
      
      (troop_set_slot, "$companion_to_be_ransomed", slot_troop_personalityclash_penalties, 0),
      (troop_set_slot, "$companion_to_be_ransomed", slot_troop_morality_penalties, 0),
      
  ]],
  
  [anyone|plyr,"ransom_broker_ransom_companion_verify",[
      ], "I can't afford that right now.", "ransom_broker_ransom_companion_refuse",[]],
  
  
  [anyone,"ransom_broker_ransom_companion_accept",[], "Splendid! In a few days, I would think, you should find {s5} riding to rejoin you, blinking in the sunlight and no doubt very grateful! Is there any other way in which I can help you?", "ransom_broker_talk",[
      (str_store_troop_name, s5, "$companion_to_be_ransomed"),
      
  ]],
  
  [anyone,"ransom_broker_ransom_companion_refuse",[], "Of course, of course... Never mind what they say about the rats, by the way -- I've never actually seen one myself, on account of the pitch-black darkness. Anyway, I'm sure that {s5} will understand why it's important for you to control expenditures. Now... Was there anything else?", "ransom_broker_talk",[
      (str_store_troop_name, s5, "$companion_to_be_ransomed"),
  ]],
  
  
  [anyone|plyr,"ransom_broker_talk",[], "Not this time. Good-bye.", "close_window",[]],
  [anyone,"ransom_broker_sell_prisoners", [],
    "Let me see what you have...", "ransom_broker_sell_prisoners_2",
    [[change_screen_trade_prisoners]]],
  #  [anyone, "ransom_broker_sell_prisoners_2", [], "You take more prisoners, bring them to me. I will pay well.", "close_window",[]],
  [anyone, "ransom_broker_sell_prisoners_2", [], "I will be staying here for a few days. Let me know if you need my services.", "close_window",[]],
  
  
  #Tavern Talk (with travelers)
  [anyone, "start", [(is_between, "$g_talk_troop", tavern_travelers_begin, tavern_travelers_end),
      (str_store_troop_name, s10, "$g_talk_troop"),
      (eq,"$g_talk_troop_met",0),
    ],
    "Greetings, friend. You look like the kind of {man/person} who'd do well to know me. " +
    "I travel a lot all across France and keep an open ear. " +
    "I can provide you information that you might find useful. For a meager price of course.", "tavern_traveler_talk", [(assign, "$traveler_land_asked", 0)]],
  
  [anyone, "start",
    [
      (is_between, "$g_talk_troop", tavern_travelers_begin, tavern_travelers_end),
      (gt, "$last_lost_companion", 0),
      (assign, ":companion_found_town", -1),
      (troop_get_slot, ":companion_found_town", "$last_lost_companion", slot_troop_cur_center),
      (is_between, ":companion_found_town", towns_begin, towns_end),
      (str_store_troop_name, s10, "$last_lost_companion"),
      (str_store_party_name, s11, ":companion_found_town"),
    ],
    "Greetings, {playername}. I saw your companion {s10} at a tavern in {s11} some days ago. I thought you might like to know.", "tavern_traveler_lost_companion_thanks",
    [(assign, "$last_lost_companion", 0)]],
  
  [anyone|plyr, "tavern_traveler_lost_companion_thanks", [(troop_get_type, reg3, "$last_lost_companion")], "Thanks. I'll go and find {reg3?her:him} there.", "tavern_traveler_pretalk", []],
  [anyone|plyr, "tavern_traveler_lost_companion_thanks", [], "Thanks, but I don't really care.", "tavern_traveler_pretalk", []],
  
  [anyone, "start", [(is_between, "$g_talk_troop", tavern_travelers_begin, tavern_travelers_end),
    ],
    "Greetings, {playername}.", "tavern_traveler_talk", [(assign, "$traveler_land_asked", 0)]],
  
  
  
  [anyone, "tavern_traveler_pretalk", [], "Yes?", "tavern_traveler_talk", []],
  
  [anyone|plyr, "tavern_traveler_talk", [(eq, "$traveler_land_asked", 0)], "What can you tell me about this land?", "tavern_traveler_tell_kingdoms", [(assign, "$traveler_land_asked", 1)]],
  [anyone, "tavern_traveler_tell_kingdoms", [], "France is divided by rival claiments to the throne, who can neither of them manage to live in peace with the other, " +
    "nor completely eliminate them. " +
    "As a result, there's seldom a break to the bitter wars which plague this land and drain its life blood. " +
    "Well, at least this must be a good place to be for an adventurer such as yourself. " +
    "With some luck and skill, you can make a name for yourself here, amass a fortune perhaps, or gain great power. " +
    "Opportunities are endless and so are the rewards, if you are willing to risk your life for them.", "tavern_traveler_tell_kingdoms_2", []],
  
  [anyone|plyr, "tavern_traveler_tell_kingdoms_2", [], "Tell me more about these opportunities.", "tavern_traveler_tell_kingdoms_3", []],
  [anyone|plyr, "tavern_traveler_tell_kingdoms_2", [], "Thank you. That was all I needed to know", "close_window", []],
  
  [anyone, "tavern_traveler_tell_kingdoms_3", [(gt, "$player_has_homage", 0)], "Well, you probably know everything I could tell you already. You seem to be doing pretty well.",
    "tavern_traveler_tell_kingdoms_4", []],
  [anyone, "tavern_traveler_tell_kingdoms_3", [], "The kingdoms will pay good money for mercenaries if they are engaged in a war. " +
    "If you have done a bit of fighting, speaking with one of their lords will probably result in being offered a mercenary contract. " +
    "However the real rewards come if you can manage to become a vassal to a king. " +
    "A vassal can own villages, castles and towns and get rich with the taxes and revenues of these estates. " +
    "Normally, only nobles of the realm own land in this way, " +
    "but in time of war, a king will not hesitate to accept someone who distinguishes {himself/herself} on the battlefield as a vassal, and grant {him/her} the right to own land.",
    "tavern_traveler_tell_kingdoms_4a", []],
  
  [anyone, "tavern_traveler_tell_kingdoms_4a", [], "It is not unheard-of for adventurers to renounce allegiance to a European king altogether, declare themselves kings, and claim land in their own name. This is a difficult path, however, as the great nobles of the land, with their long ancestries, are not likely to accept such upstarts as their monarch. Such rulers would need to be very careful in establishing their right to rule, or they would be set upon from all sides.",
    "tavern_traveler_tell_kingdoms_4", []],
  
  
  [anyone, "tavern_traveler_tell_kingdoms_4", [], "It might be easier for an adventurer like yourself to pledge support to an existing king's rival. " +
    "There are many such pretenders in France -- those who are born to the right family, who go around and stir up trouble saying they have a better claim to the throne than the current king. " +
    "If those claim holders could find supporters, they could easily start civil wars and perhaps even replace the king one day.",
    "tavern_traveler_tell_kingdoms_5", []],
  
  [anyone|plyr, "tavern_traveler_tell_kingdoms_5", [], "Interesting. Where can I find these claim holders?", "tavern_traveler_tell_kingdoms_6", []],
  [anyone|plyr, "tavern_traveler_tell_kingdoms_5", [], "I guess I heard enough already. Thank you.", "close_window", []],
  
  [anyone, "tavern_traveler_tell_kingdoms_6", [], "A claim holder's life would be in danger in his own country of course. " +
    "Therefore, they usually stay at rival courts, raising support and hoping to find someone willing to champion their cause. " +
    "I usually hear news about some of them, and may be able to tell you their location with some precision. " +
    "But of course, I would ask for a little something for such a service.",
    "tavern_traveler_pretalk", [(assign, "$traveller_claimants_mentioned", 1)]],
  
  [anyone|plyr, "tavern_traveler_talk", [(eq, "$traveller_claimants_mentioned", 1)], "I want to know the location of a claimant.", "tavern_traveler_pretender_location", []],
  [anyone, "tavern_traveler_pretender_location", [], "Whose location do you want to know?", "tavern_traveler_pretender_location_ask", []],
  
  [anyone|plyr|repeat_for_troops, "tavern_traveler_pretender_location_ask",
    [
      (store_repeat_object, ":troop_no"),
      (is_between, ":troop_no", pretenders_begin, pretenders_end),
      (neg|troop_slot_eq, ":troop_no", slot_troop_occupation, slto_kingdom_hero),
      (troop_slot_ge, ":troop_no", slot_troop_cur_center, 1),
      (str_store_troop_name, s11, ":troop_no"),
      (neq, ":troop_no", "$supported_pretender"),
    ],  "{s11}", "tavern_traveler_pretender_location_ask_2",
    [
      (store_repeat_object, "$temp"),
  ]],
  
  [anyone|plyr, "tavern_traveler_pretender_location_ask",
    [],  "Never mind.", "tavern_traveler_pretalk", []],
  
  
  [anyone, "tavern_traveler_pretender_location_ask_2", [], "I can reveal this information to you for a small price, let's say 30 denars.", "tavern_traveler_pretender_location_ask_money", []],
  
  [anyone|plyr, "tavern_traveler_pretender_location_ask_money",
    [
      (store_troop_gold, ":cur_gold", "trp_player"),
      (ge, ":cur_gold", 30),
    ],
    "All right. Here is 30 denars.", "tavern_traveler_pretender_location_tell",
    [
      (troop_remove_gold, "trp_player", 30),
  ]],
  
  [anyone|plyr, "tavern_traveler_pretender_location_ask_money", [], "Never mind.", "tavern_traveler_pretalk", []],
  
  [anyone, "tavern_traveler_pretender_location_tell", [], "{s15} is currently at {s11}.", "tavern_traveler_pretalk",
    [
      (str_store_troop_name, s15, "$temp"),
      (troop_get_slot, ":cur_center", "$temp", slot_troop_cur_center),
      (str_store_party_name, s11, ":cur_center"),
  ]],
  
  
  [anyone|plyr, "tavern_traveler_talk", [], "I am looking for one of my companions...", "tavern_traveler_companion_location", []],
  
  [anyone, "tavern_traveler_companion_location", [], "Maybe I can help you. Who are you looking for?", "tavern_traveler_companion_location_ask", []],
  
  [anyone|plyr|repeat_for_troops, "tavern_traveler_companion_location_ask",
    [
      (store_repeat_object, ":troop_no"),
      (is_between, ":troop_no", companions_begin, companions_end),
      
      (troop_slot_ge, ":troop_no", slot_troop_playerparty_history, 1),
      
      
      (assign, ":continue", 0),
      (try_begin),
        (this_or_next|troop_slot_ge, ":troop_no", slot_troop_cur_center, 1),
        (troop_slot_ge, ":troop_no", slot_troop_prisoner_of_party, 0),
        
        (assign, ":continue", 1),
      (try_end),
      
      (eq, ":continue", 1),
      
      (str_store_troop_name, s11, ":troop_no"),
    ],
    "{s11}", "tavern_traveler_companion_location_ask_2",
    [
      (store_repeat_object, "$temp"),
  ]],
  
  [anyone|plyr, "tavern_traveler_companion_location_ask",
    [],  "Never mind.", "tavern_traveler_pretalk", []],
  
  [anyone, "tavern_traveler_companion_location_ask_2", [(str_store_troop_name, s15, "$temp")], "I guess I know where {s15} is. For 30 denars, I'll tell you.", "tavern_traveler_companion_location_ask_money", []],
  
  [anyone|plyr, "tavern_traveler_companion_location_ask_money",
    [
      (store_troop_gold, ":cur_gold", "trp_player"),
      (ge, ":cur_gold", 30),
    ], "All right. Here is 30 denars.", "tavern_traveler_companion_location_tell",
    [
      (troop_remove_gold, "trp_player", 30),
  ]],
  
  [anyone|plyr, "tavern_traveler_companion_location_ask_money", [], "Never mind.", "tavern_traveler_pretalk", []],
  
  [anyone, "tavern_traveler_companion_location_tell", [], "{s15} is currently at {s11}.{s12}", "tavern_traveler_pretalk",
    [
      (str_store_troop_name, s15, "$temp"),
      
      (try_begin),
        (troop_slot_ge, "$temp", slot_troop_cur_center, 1),
        (troop_get_slot, ":cur_center", "$temp", slot_troop_cur_center),
        (str_store_string, s12, "str_space"),
      (else_try),
        (troop_get_slot, ":cur_center", "$temp", slot_troop_prisoner_of_party),
        
        (try_begin),
          (is_between, ":cur_center", towns_begin, towns_end),
          (str_store_string, s13, "str_town"),
        (else_try),
          (str_store_string, s13, "str_castle"),
        (try_end),
        (troop_get_type, reg4, "$temp"),
        (str_store_string, s12, "str__but_he_is_holding_there_as_a_prisoner_at_dungeon_of_s13"), #[TODO : Control Grammer] New text, control grammer of text later. s13 can be "castle" or "town".
      (try_end),
      
      (try_begin),
        (party_is_active, ":cur_center"),
        (str_store_party_name, s11, ":cur_center"),
      (else_try),
        (str_store_party_name, s11, "str_prisoner_at_large"),
      (try_end),
  ]],
  
  [anyone|plyr, "tavern_traveler_talk", [],
    "Farewell.", "close_window", []],
  
  [anyone, "start", [(is_between, "$g_talk_troop", tavern_travelers_begin, tavern_travelers_end),
      (party_get_slot, ":info_faction", "$g_encountered_party", slot_center_traveler_info_faction),
      (str_store_faction_name, s17, ":info_faction"),
    ],
    "Greetings. They say you're the kind of {man/woman} who'd be interested to hear that I travel frequently to {s17}. I'll tell you all I know for a mere 100 denars.", "tavern_traveler_answer", []],
  
  [anyone|plyr, "tavern_traveler_answer", [(store_troop_gold, ":cur_gold", "trp_player"),
      (ge, ":cur_gold", 100)],
    "Here's 100 denars. Tell me what you know.", "tavern_traveler_continue", [(party_get_slot, ":info_faction", "$g_encountered_party", slot_center_traveler_info_faction),
      (call_script, "script_update_faction_traveler_notes", ":info_faction"),
      (change_screen_notes, 2, ":info_faction"),
  ]],
  
  [anyone|plyr, "tavern_traveler_answer", [],
    "Sorry friend. I am not interested.", "close_window", []],
  
  [anyone, "tavern_traveler_continue", [],
    "Well, that's all I can tell you. Good bye.", "close_window", [(troop_remove_gold, "trp_player", 100),]],
  
  #Tavern Talk (with book sellers)
  [anyone, "start", [(is_between, "$g_talk_troop", tavern_booksellers_begin, tavern_booksellers_end),
    ],
    "Good day {sir/madam}, will you be looking at my books?", "bookseller_talk", []],
  [anyone|plyr, "bookseller_talk", [], "Yes. Show me what you have for sale.", "bookseller_buy", []],
  
  [anyone,"bookseller_buy", [], "Of course {sir/madam}.", "book_trade_completed",[[change_screen_trade]]],
  [anyone,"book_trade_completed", [], "Anything else?", "bookseller_talk",[]],
  
  [anyone|plyr,"bookseller_talk", [], "Nothing. Thanks.", "close_window",[]],
  
  
  
  #Tavern Talk (with minstrels)
  [anyone, "start", [(is_between, "$g_talk_troop", tavern_minstrels_begin, tavern_minstrels_end),
    ],
    "Greetings to you, {most noble sir/most noble lady}.", "minstrel_1", []],
  
  [anyone|plyr, "minstrel_1", [(eq, "$minstrels_introduced", 0),],
    "What is it you do?", "minstrel_job_description",
    [(assign, "$minstrels_introduced", 1), ]],
  
  [anyone|plyr, "minstrel_1", [(eq, "$minstrels_introduced", 1)  ],
    "I have some questions about courtship in France",
    "minstrel_courtship_questions", []],
  
  [anyone|plyr, "minstrel_1", [(eq, "$minstrels_introduced", 1)  ],
    "Can you teach me any poems?",
    "minstrel_courtship_poem", []],
  
  
  [anyone, "minstrel_courtship_poem", [
      (eq, "$allegoric_poem_recitations", 0),
      (this_or_next|eq, "$g_talk_troop", "trp_tavern_minstrel_1"),
      (eq, "$g_talk_troop", "trp_tavern_minstrel_5"),
    ],
    "I can teach you the poem, 'The Storming of the Castle of Love.' It is short enough to be easily learned. It is an allegoric poem, replete with symbols and metaphor. It describes how a brave but rough warrior wins the heart of his lady by learning the virtues of chivalry, becoming a true and noble knight. Its theme -- that the role of a woman is to inspire but also civilize a man -- is appreciated by some noble ladies, but not all.",
    "minstrel_courtship_poem_teach", [
      (assign, "$poem_selected", courtship_poem_allegoric),
  ]],
  
  [anyone, "minstrel_courtship_poem", [
      (eq, "$mystic_poem_recitations", 0),
      (this_or_next|eq, "$g_talk_troop", "trp_tavern_minstrel_3"),
      (eq, "$g_talk_troop", "trp_tavern_minstrel_1"),
    ],
    "I can teach you the poem, 'The Heart's Desire.' It is a lyrical poem, which can be interpreted either erotically or spiritually. The lover realizes the majesty of the divine by gazing upon the body of his beloved. I believe that it appeals to women of a certain romantic temperament, but you risk scandalizing or boring others.",
    "minstrel_courtship_poem_teach", [
      (assign, "$poem_selected", courtship_poem_mystic),
  ]],
  
  #ashik poem
  [anyone, "minstrel_courtship_poem", [
      (eq, "$tragic_poem_recitations", 0),
      (this_or_next|eq, "$g_talk_troop", "trp_tavern_minstrel_3"),
      (eq, "$g_talk_troop", "trp_tavern_minstrel_2"),  ],
    "I can teach you the tale of Kais and Layala. It is a sad and simple story -- the shepherd boy Kais and the nobleman's daughter Layala love each other, but they can never marry. The poem is Kais' lament as he wanders alone, unwilling to forget his true love, driving himself mad with longing. Some ladies melt at the sweetness of his sorrows; others glaze over at his self-pity.",
    "minstrel_courtship_poem_teach", [
      (assign, "$poem_selected", courtship_poem_tragic),
      
  ]],
  
  
  #nord saga
  [anyone, "minstrel_courtship_poem", [
      (eq, "$heroic_poem_recitations", 0),
      (this_or_next|eq, "$g_talk_troop", "trp_tavern_minstrel_4"),
      (eq, "$g_talk_troop", "trp_tavern_minstrel_2"),
      
    ],
    "I can teach you part of the saga of Helgerad and Kara. It is a heroic tale, full of blood and battle. The shieldmaiden Kara chooses the warrior Helgered as her lover, as he is the only man who can defeat her in combat. Her father, who pledged her to another, comes with his sons and his huscarls to kill Helgered. They fight, and Helgered and Kara slaughter the entire host except for Kara's beloved younger brother -- who, alas, grows up to avenge his father by slaying Helgered. The depiction of warrior and shieldmaiden as equals will appeal to some women, but a mail-wearing, blood-spattered heroine will shock and repulse others.",
    "minstrel_courtship_poem_teach", [
      (assign, "$poem_selected", courtship_poem_heroic),
  ]],
  
  
  [anyone, "minstrel_courtship_poem", [
      (eq, "$comic_poem_recitations", 0),
      (this_or_next|eq, "$g_talk_troop", "trp_tavern_minstrel_5"),
      (eq, "$g_talk_troop", "trp_tavern_minstrel_4"),
    ],
    "I can teach you the poem, 'An Argument in the Garden.' It is a comic poem, which satirizes the conventions of courtly love. A lover steals into a garden in Veluca, and plies her with lots of witty lines to persuade his lover to submit to his embraces. She shoots down all of his advances one by one, then when he is downcast, she takes him in her arms and tells him that she wanted him all along, except on her terms, not his. A lady with a sense of humor may find it amusing, but others might feel that they are the ones who are being mocked.",
    "minstrel_courtship_poem_teach", [
      (assign, "$poem_selected", courtship_poem_comic),
  ]],
  
  
  [anyone, "minstrel_courtship_poem_teach", [],
    "To teach it to you, I will need some hours of your time -- and, of course, a small fee for my services. About 300 denars would suffice.",
    "minstrel_courtship_poem_teach_2", []],
  
  [anyone, "minstrel_courtship_poem", [],
    "I believe you already know the poems I am best equipped to teach.",
    "minstrel_pretalk", []],
  
  [anyone|plyr, "minstrel_courtship_poem_teach_2", [
      (store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", 300),
    ],
    "Yes -- teach me that one",
    "minstrel_courtship_poem_teach_3", []],
  
  [anyone|plyr, "minstrel_courtship_poem_teach_2", [],
    "Never mind",
    "minstrel_pretalk", []],
  
  
  [anyone, "minstrel_courtship_poem_teach_3", [
      (eq, "$poem_selected", courtship_poem_allegoric),
    ],
    "Very well -- repeat after me:^" +
    "I deflected her skeptical questioning darts^" +
    "with armor made of purest devotion^" +
    "purged in the forge of my heart^" +
    "from the slag of any baser emotion",
    "minstrel_courtship_poem_teach_4", []],
  
  
  [anyone, "minstrel_courtship_poem_teach_3", [
      (eq, "$poem_selected", courtship_poem_mystic),
    ],
    "Very well -- repeat after me:^" +
    "You are the first and the last^" +
    "the outer and the inner^" +
    "When I drink from the cup of love^" +
    "I escape the tread of time^" +
    "A moment in solitude with you^" +
    "Would have no beginning and no end",
    "minstrel_courtship_poem_teach_4", []],
  
  
  [anyone, "minstrel_courtship_poem_teach_3", [
      (eq, "$poem_selected", courtship_poem_tragic),
    ],
    "Very well -- repeat after me:^" +
    "The wind that blows the dry steppe dust^" +
    "Stirs the curtains in your tower^" +
    "The moon that lights my drunken path home^" +
    "Looks on you sleeping in your bower^" +
    "If I cried out to the wind^" +
    "Could it carry a message from my lips?^" +
    "If I wept before the moon^" +
    "Would it grant me just a glimpse?",
    "minstrel_courtship_poem_teach_4", [
  ]],
  
  
  [anyone, "minstrel_courtship_poem_teach_3", [
      (eq, "$poem_selected", courtship_poem_heroic),
    ],
    "Very well -- repeat after me:^" +
    "A light pierced the gloom over Wercheg cliffs...^" +
    "Where charge of surf broke on shieldwall of shore^" +
    "Grey-helmed and grey-cloaked the maiden stood^" +
    "On wave-steed's prow, the sailcloth snapping^" +
    "Over din of oars, of timbers cracking^" +
    "She cried out to her hearth-brothers, arrayed for war",
    "minstrel_courtship_poem_teach_4", [
  ]],
  
  
  [anyone, "minstrel_courtship_poem_teach_3", [
      (eq, "$poem_selected", courtship_poem_comic),
    ],
    "Very well -- repeat after me:^All the silks of Veluca, all the furs of Khudan^Would buy you not the briefest kiss^What I bestow, I bestow for love^And the sake of my own happiness^But brought you a gift? Let us see! Let us see!^Or should tell my father how you came to see me?",
    "minstrel_courtship_poem_teach_4", [
  ]],
  
  
  [anyone|plyr, "minstrel_courtship_poem_teach_4", [
      (eq, "$poem_selected", courtship_poem_allegoric),
    ],
    "'I deflected her skeptical questioning darts...'",
    "minstrel_learn_poem_continue", [
      (troop_remove_gold, "trp_player", 300),
      (val_add, "$allegoric_poem_recitations", 1),
  ]],
  
  
  [anyone|plyr, "minstrel_courtship_poem_teach_4", [
      (eq, "$poem_selected", courtship_poem_mystic),
    ],
    "'You are the first and the last..'",
    "minstrel_learn_poem_continue", [
      (troop_remove_gold, "trp_player", 300),
      (val_add, "$mystic_poem_recitations", 1),
  ]],
  
  
  
  
  [anyone|plyr, "minstrel_courtship_poem_teach_4", [
      (eq, "$poem_selected", courtship_poem_tragic),
    ],
    "'The wind that blows the dry steppe dust...'",
    "minstrel_learn_poem_continue", [
      (troop_remove_gold, "trp_player", 300),
      (val_add, "$tragic_poem_recitations", 1),
  ]],
  
  
  [anyone|plyr, "minstrel_courtship_poem_teach_4", [
      (eq, "$poem_selected", courtship_poem_heroic),
    ],
    "'A light pierced the gloom over Wercheg cliffs...'",
    "minstrel_learn_poem_continue", [
      (troop_remove_gold, "trp_player", 300),
      (val_add, "$heroic_poem_recitations", 1),
  ]],
  
  
  [anyone|plyr, "minstrel_courtship_poem_teach_4", [
      (eq, "$poem_selected", courtship_poem_comic),
    ],
    "'All the silks of Veluca...'",
    "minstrel_learn_poem_continue", [
      (troop_remove_gold, "trp_player", 300),
      (val_add, "$comic_poem_recitations", 1),
  ]],
  
  
  [anyone|plyr, "minstrel_courtship_poem_teach_4", [
    ],
    "Pshaw... What kind of doggerel is that?",
    "minstrel_courtship_poem_teach_reject", []],
  
  [anyone, "minstrel_courtship_poem_teach_reject", [
    ],
    "Very well. If the poem is not to your taste, then keep your money. But remember -- with poets and with lovers, what is important is not what pleases you. What is important is what your pleases your audience. If you wish to learn the poem, I am still willing to teach.",
    "minstrel_pretalk", []],
  
  
  [anyone, "minstrel_learn_poem_continue", [
    ],
    "Very good -- but there are many stanzas to go. Now, listen closely...", "close_window",
    [
      (try_begin),
        (try_begin),
          (eq, "$poem_selected", courtship_poem_mystic),
          (set_achievement_stat, ACHIEVEMENT_ROMANTIC_WARRIOR, 0, 1),
        (else_try),
          (eq, "$poem_selected", courtship_poem_tragic),
          (set_achievement_stat, ACHIEVEMENT_ROMANTIC_WARRIOR, 1, 1),
        (else_try),
          (eq, "$poem_selected", courtship_poem_heroic),
          (set_achievement_stat, ACHIEVEMENT_ROMANTIC_WARRIOR, 2, 1),
        (else_try),
          (eq, "$poem_selected", courtship_poem_comic),
          (set_achievement_stat, ACHIEVEMENT_ROMANTIC_WARRIOR, 3, 1),
        (else_try),
          (eq, "$poem_selected", courtship_poem_allegoric),
          (set_achievement_stat, ACHIEVEMENT_ROMANTIC_WARRIOR, 4, 1),
        (try_end),
        
        (assign, ":number_of_poems_player_know", 0),
        (try_for_range, ":poem_number", 0, 5),
          (get_achievement_stat, ":poem_is_known", ACHIEVEMENT_ROMANTIC_WARRIOR, ":poem_number"),
          (eq, ":poem_is_known", 1),
          (val_add, ":number_of_poems_player_know", 1),
        (try_end),
        
        (try_begin),
          (ge, ":number_of_poems_player_know", 3),
          (unlock_achievement, ACHIEVEMENT_ROMANTIC_WARRIOR),
        (try_end),
      (try_end),
      
      (assign, "$g_leave_town",1),
      (rest_for_hours, 2, 2, 0),
      (finish_mission),
  ]],
  
  
  [anyone|plyr, "minstrel_1", [(eq, "$minstrels_introduced", 1)  ],
    "Can you tell me anything about the eligible maidens in this realm?",
    "minstrel_gossip", [
  ]],
  
  [anyone, "minstrel_gossip",
    [],
    "About whom did you wish to know?",
    "minstrel_gossip_select", []],
  
  [anyone|plyr,"minstrel_gossip_select",
    [],
    "Just tell me the latest piece of gossip",
    "minstrel_gossip_maiden_selected_2", [
      
      (assign, "$lady_selected", -1),
      (assign, "$romantic_rival", -1),
      
      (try_for_range, ":log_entry", 0, "$num_log_entries"),
        (troop_get_slot, ":lady", "trp_log_array_actor", ":log_entry"),
        (is_between, ":lady", kingdom_ladies_begin, kingdom_ladies_end),
        (neg|troop_slot_eq, "trp_player", slot_troop_spouse, ":lady"),
        
        (troop_get_slot, ":type", "trp_log_array_entry_type", ":log_entry"),
        (is_between, ":type", 50, 65), #excludes log entries in which a party is an actor
        
        (store_faction_of_troop, ":lady_faction", ":lady"),
        (store_faction_of_party, ":town_faction", "$g_encountered_party"),
        (eq, ":lady_faction", ":town_faction"),
        (assign, "$lady_selected", ":lady"),
        (try_begin),
          (eq, "$cheat_mode", 1),
          (str_store_troop_name, s4, ":lady"),
          (troop_get_slot, reg4, "trp_log_array_entry_type", ":log_entry"),
          (assign, reg5, "$num_log_entries"),
          (display_message, "str_log_entry_type_reg4_for_s4_total_entries_reg5"),
        (try_end),
      (try_end),
      
  ]],
  
  
  [anyone|plyr|repeat_for_troops,"minstrel_gossip_select",
    [
      (store_repeat_object, "$temp"),
      (troop_slot_eq, "$temp", slot_troop_occupation, slto_kingdom_lady),
      (troop_slot_eq, "$temp", slot_troop_spouse, -1),
      (store_faction_of_troop, ":lady_faction", "$temp"),
      (store_faction_of_party, ":town_faction", "$g_encountered_party"),
      (eq, ":lady_faction", ":town_faction"),
      (str_store_troop_name, s10, "$temp"),
    ],
    "{s10}",
    "minstrel_gossip_maiden_selected", [
      (store_repeat_object, "$lady_selected"),
  ]],
  
  [anyone|plyr,"minstrel_gossip_select",
    [], "Never mind", "minstrel_pretalk", []],
  
  
  [anyone,"minstrel_gossip_maiden_selected",
    [
      (try_begin),
        (eq, "$cheat_mode", 1),
        (assign, reg3, "$lady_selected"),
        (display_message, "@{!}DEBUG: Gossip for troop {reg3}"),
        (gt, reg3, -1),
        (display_message, "@{!}DEBUG: {s3}"),
      (try_end),
      
      (try_begin),
        (gt, "$lady_selected", -1),
        (str_store_troop_name, s9, "$lady_selected"), #lady
        
        
        (str_store_string, s10, "str_error__reputation_type_for_s9_not_within_range"),
        (try_begin),
          (troop_slot_eq, "$lady_selected", slot_lord_reputation_type, lrep_conventional),
          (str_store_string, s16, "str_they_say_that_s9_is_a_most_conventional_maiden__devoted_to_her_family_of_a_kind_and_gentle_temperament_a_lady_in_all_her_way"),
        (else_try),
          (troop_slot_eq, "$lady_selected", slot_lord_reputation_type, lrep_otherworldly),
          (str_store_string, s16, "str_they_say_that_s9_is_a_bit_of_a_romantic_a_dreamer__of_a_gentle_temperament_yet_unpredictable_she_is_likely_to_be_led_by_her_passions_and_will_be_trouble_for_her_family_ill_wager"),
        (else_try),
          (troop_slot_eq, "$lady_selected", slot_lord_reputation_type, lrep_ambitious),
          (str_store_string, s16, "str_they_say_that_s9_is_determined_to_marry_well_and_make_her_mark_in_the_world_she_may_be_a_tremendous_asset_for_her_husband__provided_he_can_satisfy_her_ambition"),
        (else_try),
          (troop_slot_eq, "$lady_selected", slot_lord_reputation_type, lrep_adventurous),
          (str_store_string, s16, "str_they_say_that_s9_loves_to_hunt_and_ride_maybe_she_wishes_she_were_a_man_whoever_she_marries_will_have_a_tough_job_keeping_the_upper_hand_i_would_say"),
        (else_try),
          (troop_slot_eq, "$lady_selected", slot_lord_reputation_type, lrep_moralist),
          (str_store_string, s16, "str_they_say_that_s9_is_a_lady_of_the_highest_moral_standards_very_admirable_very_admirable__and_very_hard_to_please_ill_warrant"),
        (try_end),
        
        (call_script, "script_add_rumor_string_to_troop_notes", "$lady_selected", -1, 16),
      (try_end),
    ],
    "{s16}",
    "minstrel_gossip_maiden_selected_2", [
  ]],
  
  
  [anyone,"minstrel_gossip_maiden_selected_2",
    [
      (troop_slot_eq, "trp_player", slot_troop_spouse, "$lady_selected"),
      (is_between, "$lady_selected", kingdom_ladies_begin, kingdom_ladies_end),
    ],
    "She is married to you, of course! Clearly, no one would dream that she would do anything to engender gossip.",
    "minstrel_postgossip",
    []],
  
  
  [anyone,"minstrel_gossip_maiden_selected_2",
    [
      (gt, "$lady_selected", -1),
      (assign, ":lady", "$lady_selected"),
      (neg|troop_slot_ge, ":lady", slot_troop_spouse, active_npcs_begin),
      (troop_get_slot, ":betrothed", ":lady", slot_troop_betrothed),
      (is_between, ":betrothed", active_npcs_begin, active_npcs_end),
      
      (str_store_troop_name, s9, ":lady"),
      (str_store_troop_name, s11, ":betrothed"),
      
      (str_store_string, s12, "str_s9_is_now_betrothed_to_s11_soon_we_believe_there_shall_be_a_wedding"),
      (try_begin),
        (troop_slot_eq, ":lady", slot_troop_met, 2),
        (assign, "$romantic_rival", ":betrothed"),
      (try_end),
    ],
    "{s12}.",
    "minstrel_postgossip", []],
  
  
  
  
  
  [anyone,"minstrel_gossip_maiden_selected_2",
    [
      (try_begin),
        (is_between, "$lady_selected", kingdom_ladies_begin, kingdom_ladies_end),
        (str_store_string, s12, "str_i_have_not_heard_any_news_about_her"),
        
        (str_store_troop_name, s9, "$lady_selected"), #lady
        
        (try_begin),
          (eq, "$cheat_mode", 1), #for some reason, speaking to tavern merchant does not yield rumor. Try for Lady Baoth, Lord Etr
          (display_message, "str_searching_for_rumors_for_s9"),
        (try_end),
        
        (assign, "$romantic_rival", -1),
        (assign, ":last_lady_noted", 0),
        (try_for_range, ":log_entry", 0, "$num_log_entries"),
          (troop_slot_eq, "trp_log_array_actor", ":log_entry", "$lady_selected"),
          
          
          #Presumably possible for some events involving a lady to not involve troops
          (troop_get_slot, ":suitor", "trp_log_array_troop_object", ":log_entry"),
          (str_clear, s11),
          (try_begin),
            (is_between, ":suitor", 0, kingdom_ladies_end),
            (str_store_troop_name, s11, ":suitor"),
          (try_end),
          
          (troop_get_slot, ":third_party", "trp_log_array_center_object", ":log_entry"),
          (str_clear, s10),
          (try_begin),
            (is_between, ":third_party", 0, kingdom_ladies_end),
            (str_store_troop_name, s10, ":third_party"),
          (try_end),
          
          (assign, ":lady", "$lady_selected"),
          
          (try_begin),
            (troop_slot_eq, "trp_log_array_entry_type",  ":log_entry", logent_lady_favors_suitor),
            (str_store_string, s12, "str_they_say_that_s9_has_shown_favor_to_s11_perhaps_it_will_not_be_long_until_they_are_betrothed__if_her_family_permits"),
            (assign, ":last_lady_noted", ":lady"),
            (assign, ":last_suitor_noted", ":suitor"),
            
            (try_begin),
              (troop_slot_eq, ":lady", slot_troop_met, 2),
              (this_or_next|troop_slot_eq, ":suitor", slot_troop_love_interest_1, ":lady"),
              (this_or_next|troop_slot_eq, ":suitor", slot_troop_love_interest_2, ":lady"),
              (troop_slot_eq, ":suitor", slot_troop_love_interest_3, ":lady"),
              
              (assign, "$romantic_rival", ":suitor"),
            (try_end),
          (else_try),
            (troop_slot_eq, "trp_log_array_entry_type",  ":log_entry", logent_lady_betrothed_to_suitor_by_family),
            (str_store_string, s12, "str_they_say_that_s9_has_been_forced_by_her_family_into_betrothal_with_s11"),
            (assign, ":last_lady_noted", ":lady"),
            (assign, ":last_suitor_noted", ":suitor"),
            
            (try_begin),
              (troop_slot_eq, ":lady", slot_troop_met, 2),
              (assign, "$romantic_rival", ":suitor"),
            (try_end),
          (else_try),
            (troop_slot_eq, "trp_log_array_entry_type",  ":log_entry", logent_lady_betrothed_to_suitor_by_choice),
            (str_store_string, s12, "str_they_say_that_s9_has_agreed_to_s11s_suit_and_the_two_are_now_betrothed"),
            (assign, ":last_lady_noted", ":lady"),
            (assign, ":last_suitor_noted", ":suitor"),
            
            (try_begin),
              (troop_slot_eq, ":lady", slot_troop_met, 2),
              (this_or_next|troop_slot_eq, ":suitor", slot_troop_love_interest_1, ":lady"),
              (this_or_next|troop_slot_eq, ":suitor", slot_troop_love_interest_2, ":lady"),
              (troop_slot_eq, ":suitor", slot_troop_love_interest_3, ":lady"),
              
              
              (assign, "$romantic_rival", ":suitor"),
            (try_end),
            
          (else_try),
            (troop_slot_eq, "trp_log_array_entry_type",  ":log_entry", logent_lady_betrothed_to_suitor_by_pressure),
            (str_store_string, s12, "str_they_say_that_s9_under_pressure_from_her_family_has_agreed_to_betrothal_with_s11"),
            (assign, ":last_lady_noted", ":lady"),
            (assign, ":last_suitor_noted", ":suitor"),
            
            (try_begin),
              (troop_slot_eq, ":lady", slot_troop_met, 2),
              (this_or_next|troop_slot_eq, ":suitor", slot_troop_love_interest_1, ":lady"),
              (this_or_next|troop_slot_eq, ":suitor", slot_troop_love_interest_2, ":lady"),
              (troop_slot_eq, ":suitor", slot_troop_love_interest_3, ":lady"),
              
              (assign, "$romantic_rival", ":suitor"),
            (try_end),
            
          (else_try),
            
            (troop_slot_eq, "trp_log_array_entry_type",  ":log_entry", logent_lady_rejects_suitor),
            (str_store_string, s12, "str_they_say_that_s9_has_refused_s11s_suit"),
            (assign, ":last_lady_noted", ":lady"),
            (assign, ":last_suitor_noted", ":suitor"),
            
          (else_try),
            
            (troop_slot_eq, "trp_log_array_entry_type",  ":log_entry", logent_lady_rejected_by_suitor),
            (str_store_string, s12, "str_they_say_that_s11_has_tired_of_pursuing_s9"),
            (assign, ":last_lady_noted", ":lady"),
            (assign, ":last_suitor_noted", ":suitor"),
            
            
          (else_try),
            (troop_slot_eq, "trp_log_array_entry_type",  ":log_entry", logent_lady_father_rejects_suitor),
            (str_store_string, s12, "str_they_say_that_s9s_family_has_forced_her_to_renounce_s11_whom_she_much_loved"),
            (assign, ":last_lady_noted", ":lady"),
            (assign, ":last_suitor_noted", ":suitor"),
            
          (else_try),
            (troop_slot_eq, "trp_log_array_entry_type",  ":log_entry", logent_lady_elopes_with_lord),
            (str_store_string, s12, "str_they_say_that_s9_has_run_away_with_s11_causing_her_family_much_grievance"),
            (assign, ":last_lady_noted", ":lady"),
            (assign, ":last_suitor_noted", ":suitor"),
            
          (else_try),
            (troop_slot_eq, "trp_log_array_entry_type",  ":log_entry", logent_lady_marries_lord),
            (str_store_string, s12, "str_they_say_that_s9_and_s11_have_wed"),
            (assign, ":last_lady_noted", ":lady"),
            (assign, ":last_suitor_noted", ":suitor"),
          (else_try),
            (troop_get_slot, ":suitor", ":lady", slot_lady_last_suitor),
            (is_between, ":suitor", active_npcs_begin, active_npcs_end),
            (str_store_troop_name, s11, ":suitor"),
            
            (str_store_string, s12, "str_they_say_that_s9_was_recently_visited_by_s11_who_knows_where_that_might_lead"),
            (assign, ":last_lady_noted", ":lady"),
            (assign, ":last_suitor_noted", ":suitor"),
            (try_begin),
              (troop_slot_eq, ":lady", slot_troop_met, 2),
              (this_or_next|troop_slot_eq, ":suitor", slot_troop_love_interest_1, ":lady"),
              (this_or_next|troop_slot_eq, ":suitor", slot_troop_love_interest_2, ":lady"),
              (troop_slot_eq, ":suitor", slot_troop_love_interest_3, ":lady"),
              
              (assign, "$romantic_rival", ":suitor"),
            (try_end),
          (try_end),
          
        (try_end),
        
        (try_begin),
          (neq, ":last_suitor_noted", "$romantic_rival"),
          (assign, "$romantic_rival", -1),
        (try_end),
        
        (try_begin),
          (gt, ":last_lady_noted", 0),
          (call_script, "script_add_rumor_string_to_troop_notes", ":last_lady_noted", ":last_suitor_noted", 12),
        (try_end),
      (else_try),
        (eq, "$lady_selected", -1),
        (str_store_string, s12, "str_there_is_not_much_to_tell_but_it_is_still_early_in_the_season"),
      (else_try),
        (assign, reg4, "$lady_selected"),
        (str_store_troop_name, s9, "$lady_selected"),
        (str_store_string, s12, "str_error_lady_selected_=_s9"),
      (try_end),
    ],
    "{s12}.",
    "minstrel_postgossip", []],
  
  [anyone|plyr, "minstrel_postgossip", [],
    "Very interesting -- but let us speak of something else.",
    "minstrel_pretalk", []],
  
  [anyone|plyr, "minstrel_postgossip", [],
    "Very interesting -- is there any more news?",
    "minstrel_gossip", []],
  
  [anyone|plyr, "minstrel_postgossip", [
      (is_between, "$romantic_rival", active_npcs_begin, active_npcs_end),
      (neg|check_quest_active, "qst_duel_courtship_rival"),
      (neg|troop_slot_ge, "trp_player", slot_troop_spouse, kingdom_ladies_begin),
    ],
    "What? I'll make that miscreant face my sword",
    "minstrel_duel_confirm", []],
  
  [anyone, "minstrel_duel_confirm", [
      (str_store_troop_name, s11, "$romantic_rival"),
    ],
    "Do you mean that? {s11} will be honor-bound to fight you, but challenging a lord to duel over a woman is seen as a bit hot-headed, even in this warlike age.",
    "minstrel_duel_confirm_2", []],
  
  [anyone|plyr, "minstrel_duel_confirm_2", [
      (str_store_troop_name, s11, "$romantic_rival"),
      (str_store_troop_name, s12, "$lady_selected"),
    ],
    "Yes -- I intend to force {s11} to relinquish his suit of {s12}",
    "minstrel_duel_issued", []],
  
  [anyone|plyr, "minstrel_duel_confirm_2", [
    ],
    "No -- I let my passions run away with me, there",
    "minstrel_pretalk", []],
  
  [anyone, "minstrel_duel_issued", [
    ],
    "As you wish. I'll spead the word of your intentions, so that {s13} does not try to back out...",
    "minstrel_pretalk", [
      (str_store_troop_name, s11, "$lady_selected"),
      (str_store_troop_name_link, s13, "$romantic_rival"),
      (str_store_string, s2, "str_you_intend_to_challenge_s13_to_force_him_to_relinquish_his_suit_of_s11"),
      (setup_quest_text, "qst_duel_courtship_rival"),
      (call_script, "script_start_quest", "qst_duel_courtship_rival", "$lady_selected"),
      (quest_set_slot, "qst_duel_courtship_rival", slot_quest_giver_troop, "$lady_selected"),
      
      (quest_set_slot, "qst_duel_courtship_rival", slot_quest_target_troop, "$romantic_rival"),
      (quest_set_slot, "qst_duel_courtship_rival", slot_quest_xp_reward, 400),
      (quest_set_slot, "qst_duel_courtship_rival", slot_quest_expiration_days, 60),
      (quest_set_slot, "qst_duel_courtship_rival", slot_quest_current_state, 0),
  ]],
  
  
  
  
  [anyone|plyr, "minstrel_1", [(eq, "$minstrels_introduced", 1)  ],
    "Do you know of any ongoing feasts?",
    "minstrel_courtship_locations", []],
  
  [anyone, "minstrel_courtship_locations", [
      
      (str_clear, s12),
      (assign, ":feast_found", 0),
      (try_for_range, ":kingdom", kingdoms_begin, kingdoms_end),
        (faction_slot_eq, ":kingdom", slot_faction_ai_state, sfai_feast),
        (assign, ":feast_found", 1),
        
        (faction_get_slot, ":feast_venue", ":kingdom", slot_faction_ai_object),
        (str_store_party_name, s4, ":feast_venue"),
        (str_store_faction_name, s3, ":kingdom"),
        
        (store_current_hours, ":hour"),
        (store_sub, ":hours_since_start", ":hour", 72),
        (faction_get_slot, ":feast_time", ":kingdom", slot_faction_last_feast_start_time),
        (val_add, ":hours_since_start", ":feast_time"),
        
        (try_begin),
          (gt, ":hours_since_start", 48),
          (str_store_string, s12, "str_s12there_is_a_feast_of_the_s3_in_progress_at_s4_but_it_has_been_going_on_for_a_couple_of_days_and_is_about_to_end_"),
        (else_try),
          (gt, ":hours_since_start", 24),
          (str_store_string, s12, "str_s12there_is_a_feast_of_the_s3_in_progress_at_s4_which_should_last_for_at_least_another_day_"),
        (else_try),
          (str_store_string, s12, "str_s12there_is_a_feast_of_the_s3_in_progress_at_s4_which_has_only_just_begun_"),
        (try_end),
      (try_end),
      
      (try_begin),
        (eq, ":feast_found", 0),
        (str_store_string, s12, "str_not_at_this_time_no"),
      (else_try),
        (str_store_string, s12, "str_s12the_great_lords_bring_their_daughters_and_sisters_to_these_occasions_to_see_and_be_seen_so_they_represent_an_excellent_opportunity_to_make_a_ladys_acquaintance"),
      (try_end),
      
    ],
    "{s12}",
    "minstrel_pretalk", []],
  
  [anyone|plyr, "minstrel_1", [],
    "Good-bye.", "close_window", []],
  
  [anyone, "minstrel_courtship_questions", [],
    "What do you wish to know?",
    "minstrel_courtship_questions_2", []],
  
  [anyone, "minstrel_courtship_prequestions", [],
    "Can I answer any other questions for you?",
    "minstrel_courtship_questions_2", []],
  
  [anyone|plyr, "minstrel_courtship_questions_2", [
      (eq, "$minstrels_discussed_love", 1),
    ],
    "Is there a place for me in the game of love?",
    "minstrel_player_role", [
      (assign, "$minstrels_discussed_player_role", 1),
  ]],
  
  [anyone|plyr, "minstrel_courtship_questions_2", [
      (eq, "$minstrels_discussed_player_role", 1),
    ],
    "How would a suitor meet a lady?",
    "minstrel_player_advice_meet", [
      (assign, "$minstrels_discussed_meetings", 1),
  ]],
  
  [anyone|plyr, "minstrel_courtship_questions_2", [
      (eq, "$minstrels_discussed_meetings", 1),
    ],
    "Having met a lady, how would the suitor woo her?",
    "minstrel_player_advice_woo", [
  ]],
  
  
  
  [anyone|plyr, "minstrel_courtship_questions_2", [],
    "Tell me about marriage and love among the nobility of France",
    "minstrel_nobles", [
      (assign, "$minstrels_discussed_love", 1),
  ]],
  
  [anyone, "minstrel_nobles", [],
    "Nobles are an odd lot. In France, a daughter is a political asset, to be given away to a lord with whom her father wishes to make an alliance. Yet the great families of this land idealize pure love between man and woman, and I have seen many a hardened warrior weep copious tears at the doomed ardour of Sahira and Janun in the songs -- even as he made plans to break his own daughter's heart.",
    "minstrel_nobles_2", []],
  
  [anyone, "minstrel_nobles_2", [],
    "Fathers differ, of course. Some nobles will let their daughters choose a husband who pleases them. Others, however, feel that to allow their daughters any choice at all would be to diminish their own authority, and insist on imposing a groom whether she likes it or not.",
    "minstrel_nobles_3", []],
  
  [anyone, "minstrel_nobles_3", [], "But the majority will steer a middle course -- they will want to make the final decision about a groom, but will weigh their daughter's preferences heavily. Among other factors, a happy marriage is more likely to produce heirs. So, there is a place for courtship, and for the use of skill and passion to win a lady's heart.",
    "minstrel_prequestions", []],
  
  [anyone|plyr, "minstrel_courtship_questions_2", [
      (eq, "$minstrels_discussed_love", 1),
    ],
    "What if a lady and her father disagree about a suitor?",
    "minstrel_daughter_father", []],
  
  [anyone, "minstrel_daughter_father", [], "It happens sometimes that a bride elopes. This is a major blow to the father's prestige, leading to lasting enmities. Indeed, it is possible that a war may be fought over a woman. Now, that is a fine topic for a song.",
    "minstrel_daughter_father_2", []],
  
  [anyone, "minstrel_daughter_father_2", [], "In the end, however, most brides will submit to their parents' choice. A noblewoman's family is everything to her, and few are brave enough to risk its disapproval for the sake of man she barely knows. She may pine for her lover, but still accept the groom -- and without tragic love, what would we have to sing about?",
    "minstrel_prequestions", []],
  
  
  
  [anyone, "minstrel_player_role", [
      (troop_get_type, ":is_female", "trp_player"),
      (eq, ":is_female", 0),
    ], "Of course! High lords make a great deal of lineage, but in the end, lands and money speak louder than one's ancestors. Even though you are a foreigner, if you are coming up in the world, then many parents will consider you a fine catch.",
    "minstrel_player_role_2", []],
  
  [anyone, "minstrel_player_role_2", [
    ], "You will have to compete with many other lords of your realm, however, who will have an advantage -- they have known these ladies from childhood, and will have been sized up as grooms by carefully discerning mothers and aunts. Some ladies may be fascinated by the stranger, yet opt for the familiar.",
    "minstrel_player_role_3", []],
  
  [anyone, "minstrel_player_role_3", [
    ], "So know this -- you may have your heart broken. But to enter the arena of love fearing heartbreak is like entering the battlefield fearing the enemy's arrows. Be brave, and shrug off the sting of rejection, and victory may yet be yours.",
    "minstrel_prequestions", []],
  
  
  [anyone, "minstrel_player_role", [
    ], "Lady -- I will speak bluntly. Most of the lords of this land are looking for a demure maiden, whose skin as fair as snow -- and your skin is burnt brown by the sun. They want a maiden whose voice is soft as bells -- and your voice is hoarse from commanding men in battle. Also, athough the lords of France appreciate poems about love, most also want heirs, and few women can ride and fight while with child.",
    "minstrel_female_player_3", []],
  
  
  [anyone, "minstrel_female_player_3", [
    ], "However, not all lords will be so conventionally minded. We poets sing of shield maidens and of huntresses, of women who forged their own path without having sacrificed the chance for love. I would not tell you that it would be easy for you to find a devoted husband who will accept your ways, but I would not say that it is impossible.",
    "minstrel_prequestions", []],
  
  
  [anyone|plyr, "minstrel_courtship_questions_2", [
      (eq, "$minstrels_discussed_love", 1),
    ],
    "What advantage is there in seeking a {wife/husband}?",
    "minstrel_spouse_benefits", []],
  
  [anyone, "minstrel_spouse_benefits", [
      (troop_get_type, ":is_female", "trp_player"),
      (eq, ":is_female", 0),
    ],
    "Ah! You are quite the romantic, I see! Well, aside from the obvious benefits of love, companionship and other, em, domestic matters, to marry among the nobility brings great assets. You may forge a strong alliance with the bride's family, and a wife may also assist you in manipulating the politics of the realm to your advantage.",
    "minstrel_wife_benefits_2", []],
  
  [anyone, "minstrel_wife_benefits_2", [
    ],
    "What's more, most of the great families of France have at some point intermarried with royalty, which would boost your own claim to rule -- should you ever choose to assert it...",
    "minstrel_prequestions", []],
  
  [anyone, "minstrel_spouse_benefits", [
      (troop_get_type, ":is_female", "trp_player"),
      (eq, ":is_female", 1),
    ],
    "Ah! You are quite the romantic, I see! Well, aside from the obvious benefits of love, companionship and other, em, domestic matters, to marry among the nobility brings great assets. You may have access to the groom's castles and properties, and be able to work with him to advance both of your standings in the realm.",
    "minstrel_wife_benefits_2", []],
  
  
  
  [anyone, "minstrel_player_advice_meet", [
    ], "Every so often, a king or great lord of the land will hold a feast. In towns they will often be accompanied by tournaments, and in castles they will be accompanied by hunts. The feasts provide a chance for the lords to repair some of the rivalries that may undermine the strength of the realm. They also provide an opportunity for families to show off their eligible daughters, and ladies will often be allowed to mingle unsupervised with the guests.",
    "minstrel_player_advice_meet_2", []],
  
  [anyone, "minstrel_player_advice_meet_2", [
    ], "If you have the opportunity, you may attempt to pay the lady a compliment. This indicates to her that you are a potential suitor, and she will usually know if she wishes you to continue your suit. Incidentally, if you come to her fresh from having distinguished yourself in the tournament or in the hunt, then you may make a stronger first impression than otherwise.",
    "minstrel_prequestions", []],
  
  
  [anyone, "minstrel_player_advice_woo", [
    ], "To woo a lady takes a certain amount of time and patience, and several meetings spaced over a period of months. A lady who is interested in you will often find ways of letting you know if she wishes you to come visit her. Alternately, you may simply go and ask her father or brother for permission. If you do not have permission from her guardian, it may be possible to arrange an assignation through other means.",
    "minstrel_player_advice_woo_2", []],
  
  [anyone, "minstrel_player_advice_woo_2", [
    ], "Having arranged an assignment, you may then attempt to charm her and win her favor. Perhaps one of the most difficult aspects of this is finding a topic of conversation. Most noblewomen lead a cloistered life, at least until they are married, and thus will have little to say that will interest you. On other hand, she will soon tire of hearing of your own deeds in the outside world.",
    "minstrel_player_advice_woo_3", []],
  
  [anyone, "minstrel_player_advice_woo_3", [
    ], "One time-tested mode of courtship is simply to recite a popular poem, and discuss it. This way, you are both on an equal footing, and neither will have an advantage in knowledge or experience. Of course, different ladies will have different tastes in poetry.",
    "minstrel_player_advice_woo_4", []],
  
  [anyone, "minstrel_player_advice_woo_4", [
    ], "At some point, you will be able to discuss directly the issue of marriage. She will then let you know if you measure up to what she wants in a husband. Some ladies will coolly assess who is the most prestigious of her suitors, others will be guided by their passions. Some will look to your companions, to see whether you are the kind of husband who will treat her as an equal, while others will follow the lead of their fathers.",
    "minstrel_player_advice_woo_5", []],
  
  [anyone, "minstrel_player_advice_woo_5", [
    ], "At any rate, it is a challenging business -- and do not forget, you may find that your suit prospers with a lady, only to have it falter on a father's political ambitions. So you must ask yourself: are you willing to risk disappointment and heartbreak? Alternately, are you willing to throw away your standing in society, to make enemies of allies, in pursuit of a forbidden love? Because if you are, then perhaps some day we will write poems about you.",
    "minstrel_prequestions", []],
  
  
  [anyone|plyr, "minstrel_courtship_questions_2", [],
    "What is it that you poets and musicians do again?",
    "minstrel_job_description", []],
  
  [anyone, "minstrel_job_description", [],
    "I compose and write songs for the lords of the land, and their ladies. Sometimes I sing about war, sometimes about the virtues of kings, and sometimes, for the more sophisticated audiences, about the virtues of wine. For most audiences, however, I sing of love.", "minstrel_courtship_prequestions", []],
  
  [anyone|plyr, "minstrel_courtship_questions_2", [],
    "No, that is all.",
    "minstrel_pretalk", []],
  
  [anyone, "minstrel_prequestions", [
    ], "Do you have any other questions?",
    "minstrel_courtship_questions_2", []],
  
  [anyone, "minstrel_pretalk", [],
    "Is there anything else?",
    "minstrel_1", []],
  
  
  
  
  
  
  
  
  #Tavern Talk (with farmers)
  [anyone, "start", [(eq, "$talk_context", tc_tavern_talk),
      (eq, "$g_talk_troop", "trp_farmer_from_bandit_village"),
      (neg|check_quest_active, "qst_eliminate_bandits_infesting_village"),
      (neg|check_quest_active, "qst_deal_with_bandits_at_lords_village"),
      (assign, ":end_cond", villages_end),
      (try_for_range, ":cur_village", villages_begin, ":end_cond"),
        (party_slot_eq, ":cur_village", slot_village_bound_center, "$g_encountered_party"),
        (party_slot_ge, ":cur_village", slot_village_infested_by_bandits, 1),
        (str_store_party_name, s1, ":cur_village"),
        (quest_set_slot, "qst_eliminate_bandits_infesting_village", slot_quest_target_center, ":cur_village"),
        (quest_set_slot, "qst_eliminate_bandits_infesting_village", slot_quest_current_state, 0),
        (party_get_slot, ":village_elder", ":cur_village", slot_town_elder),
        (quest_set_slot, "qst_eliminate_bandits_infesting_village", slot_quest_giver_troop, ":village_elder"),
        (quest_set_slot, "qst_eliminate_bandits_infesting_village", slot_quest_giver_center, ":cur_village"),
        (assign, ":end_cond", 0),
      (try_end),
    ],
    "{My lord/Madam}, you look like a {man/lady} of the sword and someone who could help us. " +
    "Will you hear my plea?", "farmer_from_bandit_village_1", []],
  
  [anyone|plyr, "farmer_from_bandit_village_1", [],
    "What is the matter, my good man?", "farmer_from_bandit_village_2", []],
  [anyone|plyr, "farmer_from_bandit_village_1", [],
    "What are you burbling about peasant? Speak out.", "farmer_from_bandit_village_2", []],
  
  [anyone, "farmer_from_bandit_village_2", [],
    "A band of brigands have taken refuge in our village. They take everything we have, force us to serve them, and do us much evil. " +
    "If one of us so much as breathes a word of protest, they kill the poor soul on the spot right away. " +
    "Our lives have become unbearable. I risked my skin and ran away to find someone who can help us.", "farmer_from_bandit_village_3", []],
  [anyone|plyr, "farmer_from_bandit_village_3", [],
    "Why don't you go to the lord of your village? He should take care of the vermin.", "farmer_from_bandit_village_4", []],
  [anyone, "farmer_from_bandit_village_4", [],
    "I did, {sir/madam}, but our lord's men did not let me see him and said he was occupied with more important matters and that we should deal with our own problem ourselves. " +
    "Please {sir/madam}, you look like a {man/lady} of valor and a fearsome warrior, and you have no doubt many friends and soldiers at your service. " +
    "If there is anyone who can help us, it's you.", "farmer_from_bandit_village_5", [(assign, "$temp", 0)]],
  [anyone|plyr, "farmer_from_bandit_village_5", [],
    "Very well, I'll help you. Where is this village?", "farmer_from_bandit_village_accepted", []],
  [anyone|plyr, "farmer_from_bandit_village_5", [],
    "I can't be bothered with this right now.", "farmer_from_bandit_village_denied", []],
  [anyone|plyr, "farmer_from_bandit_village_5", [(eq, "$temp", 0)],
    "Why would I fight these bandits? What's in it for me?", "farmer_from_bandit_village_barter", []],
  
  
  [anyone, "farmer_from_bandit_village_accepted", [],
    "God bless you, {sir/madam}. Our village is {s7}. It is not too far from here.", "close_window",
    [(quest_get_slot, ":target_center", "qst_eliminate_bandits_infesting_village", slot_quest_target_center),
      (str_store_party_name_link,s7,":target_center"),
      (setup_quest_text, "qst_eliminate_bandits_infesting_village"),
      (str_store_string, s2, "@A villager from {s7} begged you to save their village from the bandits that took refuge there."),
      (call_script, "script_start_quest", "qst_eliminate_bandits_infesting_village", "$g_talk_troop"),
  ]],
  
  [anyone, "farmer_from_bandit_village_denied", [],"As you say {sir/madam}. Forgive me for bothering you.", "close_window", []],
  
  [anyone, "farmer_from_bandit_village_barter", [],
    "We are but poor farmers {sir/madam}, and the bandits have already got most of what we have on this world. " +
    "but we'll be glad to share with you whatever we have got. " +
    "And we'll always be in your gratitude if you help us.", "farmer_from_bandit_village_5", [(assign, "$temp", 1)]],
  
  [anyone, "start", [(eq, "$talk_context", tc_tavern_talk),
      (eq, "$g_talk_troop", "trp_farmer_from_bandit_village"),
      (check_quest_active, "qst_eliminate_bandits_infesting_village"),
    ],
    "Thank you for helping us {sir/madam}. Crush those bandits!", "close_window", []],
  
  
  #qsqs
  
  [anyone,"start", [
      (eq,"$talk_context",tc_tavern_talk),
      (neg|troop_is_hero, "$g_talk_troop"),
      (is_between,"$g_talk_troop",walkers_begin,walkers_end),
    ],
    "A votre santé messire.", "tw_sante", [(assign, "$dial_town_walker_entree_foret", 0),(assign, "$dial_town_walker_foret", 0),]],
  [anyone|plyr,"tw_sante", [], "A la votre.", "close_window",[]],
  
  #tvarn pack begin
  
  #  [anyone|plyr,"start",[(eq,"$talk_context",tc_tavern_talk),(is_between,"$g_talk_troop",walkers_begin,walkers_end)],
  #  "Inutile de les déranger...","close_window",[]],
  
  
  
  
  
  #Tavern Talk (with troops)
  
  [anyone, "start", [
      (eq, "$talk_context", tc_tavern_talk),
      (neg|troop_is_hero, "$g_talk_troop"),
      (neg|is_between, "$g_talk_troop", "trp_swadian_merchant", "trp_startup_merchants_end"),
      (party_get_slot, ":mercenary_troop", "$g_encountered_party", slot_center_mercenary_troop_type),
      (party_get_slot, ":mercenary_amount", "$g_encountered_party", slot_center_mercenary_troop_amount),
      (gt, ":mercenary_amount", 0),
      (store_sub, reg3, ":mercenary_amount", 1),
      (store_sub, reg4, reg3, 1),
      (call_script, "script_game_get_join_cost", ":mercenary_troop"),
      (assign, ":join_cost", reg0),
      (store_mul, reg5, ":mercenary_amount", reg0),
      (party_get_free_companions_capacity, ":free_capacity", "p_main_party"),
      (val_min, ":mercenary_amount", ":free_capacity"),
      (store_troop_gold, ":cur_gold", "trp_player"),
      (try_begin),
        (gt, ":join_cost", 0),
        (val_div, ":cur_gold", ":join_cost"),
        (val_min, ":mercenary_amount", ":cur_gold"),
      (try_end),
      (assign, "$temp", ":mercenary_amount"),
    ],
    "Do you have a need for mercenaries, {sir/madam}? " +
    "{reg3?Me and {reg4?{reg3} of my mates:one of my mates} are:I am} looking for a master. " +
    "We'll join you for {reg5} denars.", "mercenary_tavern_talk", []],
  
  [anyone, "start", [
      (eq, "$talk_context", tc_tavern_talk),
    ],
    "Any orders, {sir/madam}?", "mercenary_after_recruited", []],
  
  [anyone|plyr, "mercenary_after_recruited", [],
    "Make your preparations. We'll be moving at dawn.", "mercenary_after_recruited_2", []],
  [anyone|plyr, "mercenary_after_recruited", [],
    "Take your time. We'll be staying in this town for a while.", "mercenary_after_recruited_2", []],
  
  [anyone, "mercenary_after_recruited_2", [], "Yes {sir/madam}. We'll be ready when you tell us to leave.", "close_window", []],
  
  [anyone|plyr, "mercenary_tavern_talk", [(party_get_slot, ":mercenary_amount", "$g_encountered_party", slot_center_mercenary_troop_amount),
      (eq, ":mercenary_amount", "$temp"),
      (party_get_slot, ":mercenary_troop", "$g_encountered_party", slot_center_mercenary_troop_type),
      (call_script, "script_game_get_join_cost", ":mercenary_troop"),
      (store_mul, reg5, "$temp", reg0),
    ],
    "All right. I will hire all of you. Here is {reg5} denars.", "mercenary_tavern_talk_hire", []],
  
  [anyone|plyr, "mercenary_tavern_talk", [(party_get_slot, ":mercenary_amount", "$g_encountered_party", slot_center_mercenary_troop_amount),
      (lt, "$temp", ":mercenary_amount"),
      (gt, "$temp", 0),
      (assign, reg6, "$temp"),
      (party_get_slot, ":mercenary_troop", "$g_encountered_party", slot_center_mercenary_troop_type),
      (call_script, "script_game_get_join_cost", ":mercenary_troop"),
      (store_mul, reg5, "$temp", reg0),
    ],
    "All right. But I can only hire {reg6} of you. Here is {reg5} denars.", "mercenary_tavern_talk_hire", []],
  
  
  [anyone, "mercenary_tavern_talk_hire", [(store_random_in_range, ":rand", 0, 4),
      (try_begin),
        (eq, ":rand", 0),
        (gt, "$temp", 1),
        (str_store_string, s17,
        "@You chose well, {sir/madam}. My lads know how to keep their word and earn their pay."),
      (else_try),
        (eq, ":rand", 1),
        (str_store_string, s17,
        "@Well done, {sir/madam}. Keep the money and wine coming our way, and there's no foe in France you need fear."),
      (else_try),
        (eq, ":rand", 2),
        (str_store_string, s17,
        "@We are at your service, {sir/madam}. Point us in the direction of those who need hurting, and we'll do the rest."),
      (else_try),
        (str_store_string, s17,
        "str_you_will_not_be_disappointed_sirmadam_you_will_not_find_better_warriors_in_all_calradia"),
      (try_end),],
    "{s17}", "close_window", [
      (party_get_slot, ":mercenary_troop", "$g_encountered_party", slot_center_mercenary_troop_type),
      (call_script, "script_game_get_join_cost", ":mercenary_troop"),
      (store_mul, ":total_cost", "$temp", reg0),
      (troop_remove_gold, "trp_player", ":total_cost"),
      (party_add_members, "p_main_party", ":mercenary_troop", "$temp"),
      (party_set_slot, "$g_encountered_party", slot_center_mercenary_troop_amount, 0),
  ]],
  
  [anyone|plyr, "mercenary_tavern_talk", [(eq, "$temp", 0),
      (party_get_free_companions_capacity, ":free_capacity", "p_main_party"),
      (ge, ":free_capacity", 1)],
    "That sounds good. But I can't afford to hire any more men right now.", "tavern_mercenary_cant_lead", []],
  
  [anyone, "tavern_mercenary_cant_lead", [], "That's a pity. Well, {reg3?we will:I will} be lingering around here for a while, " +
    "if you need to hire anyone.", "close_window", []],
  
  [anyone|plyr, "mercenary_tavern_talk", [(eq, "$temp", 0),
      (party_get_free_companions_capacity, ":free_capacity", "p_main_party"),
      (eq, ":free_capacity", 0)],
    "That sounds good. But I can't lead any more men right now.", "tavern_mercenary_cant_lead", []],
  
  
  [anyone|plyr, "mercenary_tavern_talk", [],
    "Sorry. I don't need any other men right now.", "close_window", []],
  
  
  #Trainers
  [anyone,"start", [(is_between, "$g_talk_troop", training_gound_trainers_begin, training_gound_trainers_end),
      (eq, "$g_talk_troop_met", 0)],
    "Good day to you {lad/lass}. You look like another adventurer who has come to try {his/her} chance in these lands. " +
    "Well, trust my word, you won't be able to survive long here unless you know how to fight yourself out of a tight spot.", "trainer_intro_1",[]],
  
  [anyone|plyr, "trainer_intro_1", [],
    "Thank you for your advice. This place looks like a training field. Maybe I can learn about fighting here?", "trainer_intro_2", []],
  
  [anyone,"trainer_intro_2", [],
    "Indeed you can. I am a veteran soldier... fought a good deal in the wars in my time. But these days, I train young novices in this area. " +
    "I can find you some opponents to practice with if you like. Or if you have any questions about the theory of combat, feel free to ask.", "trainer_intro_3",[]],
  
  [anyone|plyr, "trainer_intro_3", [],
    "Yes, I do have a few questions.", "trainer_intro_4a", []],
  [anyone|plyr, "trainer_intro_3", [],
    "Actually, I can move on to practice.", "trainer_intro_4b", []],
  
  [anyone, "trainer_intro_4a", [],
    "Well, ask anything you like.", "trainer_talk_combat", []],
  [anyone, "trainer_intro_4b", [],
    "Good. It's good to find someone eager for practice. Let's see what you will do.", "trainer_practice_1", []],
  
  [anyone,"start", [(is_between, "$g_talk_troop", training_gound_trainers_begin, training_gound_trainers_end),
      (neq,"$waiting_for_training_fight_result", 0),
      (neq,"$training_fight_won", 0)],
    "That was a good fight. ", "trainer_practice_1",
    [(val_sub, "$num_opponents_to_beat_in_a_row", 1),
      (assign,"$waiting_for_training_fight_result",0),
  ]],
  [anyone,"start", [(is_between, "$g_talk_troop", training_gound_trainers_begin, training_gound_trainers_end),
      (neq, "$waiting_for_training_fight_result", 0)],
    "Ha! Looks like you've developed a bit of a limp there. Don't worry, even losses have their value, provided you learn from them. Shake the stars out of your eyes and get back in there. There's no other way to win.", "trainer_practice_1",
    [(assign,"$num_opponents_to_beat_in_a_row",3),(assign,"$waiting_for_training_fight_result",0)]],
  
  [anyone,"start", [(is_between, "$g_talk_troop", training_gound_trainers_begin, training_gound_trainers_end)],
    "Good day. Ready for some training today?", "trainer_talk",[]],
  
  [anyone,"trainer_pretalk", [],
    "Ah, are you ready for some training?", "trainer_talk",[]],
  
  [anyone|plyr,"trainer_talk", [],
    "I am ready for some practice.", "trainer_practice_1",[]],
  
  [anyone|plyr,"trainer_talk", [],
    "First, tell me something about combat...", "trainer_combat_begin",[]],
  
  ##    [anyone|plyr,"trainer_talk", [],
  ##   "I have some novice soldiers with me. Can you train them?", "trainer_train_novices_1",[]],
  
  [anyone|plyr,"trainer_talk", [],
    "I need to leave now. Farewell.", "close_window",[]],
  
  
  [anyone,"trainer_combat_begin", [],
    "What do you want to know?", "trainer_talk_combat",[]],
  [anyone,"trainer_combat_pretalk", [],
    "What else do you want to know?", "trainer_talk_combat",[]],
  
  [anyone|plyr,"trainer_talk_combat", [], "Tell me about defending myself.", "trainer_explain_defense",[]],
  [anyone|plyr,"trainer_talk_combat", [], "Tell me about attacking with weapons.", "trainer_explain_attack",[]],
  [anyone|plyr,"trainer_talk_combat", [], "Tell me about fighting on horseback.", "trainer_explain_horseback",[]],
  #    [anyone|plyr,"trainer_talk_combat", [], "Tell me about using ranged weapons.", "trainer_explain_ranged",[]],
  #    [anyone|plyr,"trainer_talk_combat", [], "Tell me about weapon types.", "trainer_explain_weapon_types",[]],
  [anyone|plyr,"trainer_talk_combat", [], "I guess I know all the theory I need. Let's talk about something else.", "trainer_pretalk",[]],
  
  [anyone,"trainer_explain_defense", [], "Good question. The first thing you should know as a fighter is how to defend yourself. " +
    "Keeping yourself out of harm's way is the first rule of combat, and it is much more important than giving harm to others. " +
    "Everybody can swing a sword around and hope to cut some flesh, but only those fighters that are experts at defense live to tell of it.",
    "trainer_explain_defense_2",[]],
  [anyone,"trainer_explain_defense_2", [], "Now. Defending yourself is easiest if you are equipped with a shield. " +
    "Just block with your shield. [Hold down the right mouse button to defend yourself with the shield.] In this state, you will be able to deflect all attacks that come from your front. However, you will still be open to strikes from your sides or your back.", "trainer_explain_defense_3",[]],
  [anyone|plyr,"trainer_explain_defense_3", [], "What if I don't have a shield?", "trainer_explain_defense_4",[]],
  [anyone,"trainer_explain_defense_4", [], "Then you will have to use your weapon to block your opponent. " +
    "This is a bit more difficult than defending with a shield. " +
    "Defending with a weapon, you can block against only ONE attack direction. " +
    "That is, you block against either overhead swings, side swings or thrusts. " +
    "Therefore you must watch your opponent carefully and start to block AFTER he starts his attack. " +
    "In this way you will be able to block against the direction of his current attack. " +
    "If you start to block BEFORE he makes his move, he may just attack in another direction than the one you are blocking against and score a hit.", "trainer_combat_pretalk",[]],
  [anyone,"trainer_explain_attack", [], "Good question. Attacking is the best defence, they say. " +
    "A tactic many fighters find useful is taking an offensive stance and readying your weapon for attack, waiting for the right moment for swinging it. " +
    "[You can ready your weapon for attack by pressing and holding down the left mouse button.]", "trainer_explain_attack_2",[]],
  [anyone|plyr,"trainer_explain_attack_2", [], "That sounds useful.", "trainer_explain_attack_3",[]],
  [anyone,"trainer_explain_attack_3", [], "It is a good tactic, but remember that, your opponent may see that and take a defensive stance against the direction you are swinging your weapon. " +
    "If that happens, you must break your attack and quickly attack from another direction " +
    "[You may cancel your current attack by quickly tapping the right mouse button].", "trainer_explain_attack_4",[]],
  [anyone|plyr,"trainer_explain_attack_4", [], "If my opponent is defending against the direction I am attacking from, I will break and use another direction.", "trainer_explain_attack_5",[]],
  [anyone,"trainer_explain_attack_5", [], "Yes, selecting the direction you swing your weapon is a crucial skill. " +
    "There are four main directions you may use: right swing, left swing, overhead swing and thrust. You must use each one wisely. " +
    "[to control your swing direction with default controls, move your mouse in the direction you want to swing from as you press the left mouse button].", "trainer_combat_pretalk",[]],
  [anyone,"trainer_explain_horseback", [], "Very good question. A horse may be a warrior's most powerful weapon in combat. " +
    "It gives you speed, height, power and initiative. A lot of deadly weapons will become even deadlier on horseback. " +
    "However you must pay particular attention to horse-mounted enemies couching their lances, as they may take down any opponent in one hit. " +
    "[To use the couched lance yourself, wield a lance or similar weapon, and speed up your horse without pressing attack or defense buttons. " +
      "after you reach a speed, you'll lower your lance. Then try to target your enemies by maneuvering your horse.]", "trainer_combat_pretalk",[]],
  
  [anyone,"trainer_practice_1", [(eq,"$training_system_explained", 0)],
    "I train novices in four stages, each tougher than the one before. " +
    "To finish a stage and advance to the next one, you have to win three fights in a row.", "trainer_practice_1",
    [
      (assign, "$num_opponents_to_beat_in_a_row", 3),
      (assign, "$novicemaster_opponent_troop", "trp_novice_fighter"),
      (assign, "$training_system_explained", 1),
  ]],
  [anyone,"trainer_practice_1",
    [(ge,"$novice_training_difficulty",4)],
    "You have passed all stages of training. But if you want you can still practice. Are you ready?", "novicemaster_are_you_ready",
    [(assign,"$num_opponents_to_beat_in_a_row",99999)]],
  [anyone,"trainer_practice_1",
    [(eq,"$num_opponents_to_beat_in_a_row",0),(eq,"$novice_training_difficulty",0)],
    "Way to go {lad/lass}. With this victory, you have advanced to the next training level. From now on your opponents will be regular fighters, not the riff-raff off the street, so be on your toes.",
    "trainer_practice_1",
    [[assign,"$num_opponents_to_beat_in_a_row",3],
      [val_add,"$novice_training_difficulty",1],
      [add_xp_to_troop,100],
      [assign,"$novicemaster_opponent_troop","trp_regular_fighter"]]],
  [anyone,"trainer_practice_1",
    [[eq,"$num_opponents_to_beat_in_a_row",0],[eq,"$novice_training_difficulty",1]],
    "Way to go {lad/lass}. Welcome to the third training level. From now on your opponents will be veteran fighters; soldiers and arena regulars and the like. These guys know some dirty tricks, so keep your defense up.",
    "trainer_practice_1",
    [[assign,"$num_opponents_to_beat_in_a_row",3],
      [val_add,"$novice_training_difficulty",1],
      [add_xp_to_troop,100],
      [assign,"$novicemaster_opponent_troop","trp_veteran_fighter"]]],
  [anyone,"trainer_practice_1",
    [[eq,"$num_opponents_to_beat_in_a_row",0],[eq,"$novice_training_difficulty",2]],
    "You've got the heart of a champion, {lad/lass}, and the sword arm to match. From now on your opponents will be champion fighters. " +
    "These are the cream of the crop, the finest warriors I have trained. If you can best three of them in a row, you will join their ranks.",
    "trainer_practice_1",
    [[assign,"$num_opponents_to_beat_in_a_row",3],
      [val_add,"$novice_training_difficulty",1],
      [add_xp_to_troop,100],
      [assign,"$novicemaster_opponent_troop","trp_champion_fighter"]]],
  [anyone,"trainer_practice_1",
    [[eq,"$num_opponents_to_beat_in_a_row",0],[eq,"$novice_training_difficulty",3]],
    "It does my heart good to see such a promising talent. You have passed all tiers of training. You can now tell everyone that you have been trained by the master of the training field.",
    "novicemaster_finish_training",
    [[assign,"$num_opponents_to_beat_in_a_row",3],
      [val_add,"$novice_training_difficulty",1],
      [add_xp_to_troop,300]]],
  [anyone|plyr,"novicemaster_finish_training", [], "Thank you master.", "novicemaster_finish_training_2",[]],
  [anyone,"novicemaster_finish_training_2", [], "I wish you good luck in the tournaments. And, don't forget, " +
    "if you want to practice your swordwork anytime, just come and say the word.", "close_window",[]],
  [anyone,"trainer_practice_1",
    [
      (assign, reg8, "$num_opponents_to_beat_in_a_row"),
      (str_store_troop_name, s9, "$novicemaster_opponent_troop"),
    ],
    "Your next opponent will be a {s9}. You need to win {reg8} more " +
    "fights in a row to advance to the next stage. Are you ready?", "novicemaster_are_you_ready",
    []],
  [anyone|plyr,"novicemaster_are_you_ready", [], "Yes I am.", "novicemaster_ready_to_fight",[]],
  [anyone,"novicemaster_ready_to_fight", [], "Here you go then. Good luck.", "close_window",
    [
      (assign, "$training_fight_won", 0),
      (assign, "$waiting_for_training_fight_result", 1),
      (modify_visitors_at_site, "$g_training_ground_melee_training_scene"),
      (reset_visitors),
      (assign, reg0, 0),
      (assign, reg1, 1),
      (assign, reg2, 2),
      (assign, reg3, 3),
      (shuffle_range, 0, 4),
      (set_visitor, reg0, "trp_player"),
      (set_visitor, reg1, "$novicemaster_opponent_troop"),
      (set_visitor, 4, "$g_talk_troop"),
      (set_jump_mission, "mt_training_ground_trainer_training"),
      (jump_to_scene, "$g_training_ground_melee_training_scene"),
  ]],
  
  [anyone|plyr,"novicemaster_are_you_ready", [], "Just a minute. I am not ready yet.", "novicemaster_not_ready",[]],
  [anyone,"novicemaster_not_ready", [], "Hey, You will never make it if you don't practice.", "close_window",[]],
  
  
  #Crooks
  
  ##  [anyone ,"start", [(is_between,"$g_talk_troop",crooks_begin,crooks_end),(eq,"$g_talk_troop_met",0),(eq,"$sneaked_into_town",0),(store_random_in_range, reg2, 2)],
  ##   "You {reg2?looking for:want} something?:", "crook_intro_1",[]],
  ##  [anyone|plyr,"crook_intro_1",[],"I am trying to learn my way around the town.", "crook_intro_2",[]],
  ##
  ##  [anyone,"crook_intro_2",[(eq,"$crook_talk_order",0),(val_add,"$crook_talk_order",1),(str_store_troop_name,s1,"$g_talk_troop")],
  ##"Then you came to the right guy. My name is {s1}, and I know everyone and everything that goes around in this town.\
  ## Anyone you want to meet, I can arrange it. Anything you need to know, I can find out. For the the right price, of course. Do you have gold?", "crook_intro_2a",[]],
  ##  [anyone|plyr,"crook_intro_2a",[],"I have gold. Plenty of it.", "crook_intro_2a_1a",[]],
  ##  [anyone|plyr,"crook_intro_2a",[],"Not really.", "crook_intro_2a_1b",[]],
  ##  [anyone,"crook_intro_2a_1a",[],"Good. That means you and I will be great friends.", "crook_talk",[]],
  ##  [anyone,"crook_intro_2a_1b",[],"Then you should look into earning some. Listen to me now, for I'll give you some free advice.\
  ## The easiest way to make money is to fight in the tournaments and bet on yourself. If you are good, you'll quickly get yourself enough money to get going.", "crook_talk",[]],
  ##
  ##  [anyone,"crook_intro_2",[(eq,"$crook_talk_order",1),(val_add,"$crook_talk_order",1),(str_store_troop_name,s1,"$g_talk_troop")],
  ##"Then you need to go no further. I am {s1}, and I can provide you anything... For the the right price.", "crook_intro_2b",[]],
  ##  [anyone|plyr,"crook_intro_2b",[],"Are you a dealer?", "crook_intro_2b_1",[]],
  ##  [anyone,"crook_intro_2b_1",[],"A dealer? Yes. I deal in knowledge... connections.. lies... secrets... Those are what I deal in. Interested?", "crook_talk",[]],
  ##
  ##  [anyone,"crook_intro_2",[(eq,"$crook_talk_order",2),(val_add,"$crook_talk_order",1),(str_store_troop_name,s1,"$g_talk_troop")],
  ##"Then this is your lucky day. Because you are talking to {s1}, and I know every piss-stained brick of this wicked town.\
  ##I know every person, every dirty little secret. And all that knowledge can be yours. For a price.", "crook_talk",[]],
  ##
  ##  [anyone,"crook_intro_2",[(val_add,"$crook_talk_order",1),(str_store_troop_name,s1,"$g_talk_troop")],
  ## "Then {s1} is at your service {sir/madam}. If you want to know what's really going on in this town, or arrange a meeting in secret, then come to me. I can help you.", "crook_talk",[]],
  ##
  ##  [anyone ,"start", [(is_between,"$g_talk_troop",crooks_begin,crooks_end),(eq,"$g_talk_troop_met",0),(eq,"$sneaked_into_town",1),(eq,"$crook_sneak_intro_order",0),(val_add,"$crook_sneak_intro_order",1)],
  ##   "Good day. {playername} right?", "crook_intro_sneak_1",[]],
  ##  [anyone|plyr,"crook_intro_sneak_1", [], "You must be mistaken. I'm just a poor pilgrim. I don't answer to that name.", "crook_intro_sneak_2",[]],
  ##  [anyone,"crook_intro_sneak_2", [(str_store_troop_name,s1,"$g_talk_troop")], "Of course you do. And if the town guards knew you were here, they'd be upon you this minute.\
  ## But don't worry. Noone knows it is {playername} under that hood. Except me of course. But I am {s1}. It is my business to know things.", "crook_intro_sneak_3",[]],
  ##  [anyone|plyr,"crook_intro_sneak_3", [], "You won't tip off the guards about my presence?", "crook_intro_sneak_4",[]],
  ##  [anyone,"crook_intro_sneak_4", [], "What? Of course not! Well, maybe I would, but the new captain of the guards is a dung-eating cheat.\
  ## I led him to this fugitive, and the man was worth his weight in silver as prize money. But I swear, I didn't see a penny of it.\
  ## The bastard took it all to himself. So your secret is safe with me.", "crook_intro_sneak_5",[]],
  ##  [anyone,"crook_intro_sneak_5", [], "Besides, I heard you have a talent for surviving any kind of ordeal.\
  ## I wouldn't want you to survive this one as well and then come after me with a sword. Ha-hah.", "crook_talk",[]],
  ##
  ##
  ##  [anyone ,"start", [(is_between,"$g_talk_troop",crooks_begin,crooks_end),(eq,"$g_talk_troop_met",0),(eq,"$sneaked_into_town",1),(str_store_troop_name,s1,"$g_talk_troop")],
  ##   "{s1} is at your service {sir/madam}. If you want to know what's really going on in this town, or arrange a meeting in secret, then come to me. I can help you.", "crook_talk",[]],
  ##
  ##  [anyone ,"start", [(is_between,"$g_talk_troop",crooks_begin,crooks_end),(store_character_level, ":cur_level", "trp_player"),(lt,":cur_level",8)],
  ##   "{You again?/Delighted to see you again my pretty.}", "crook_talk",[]],
  ##  [anyone ,"start", [(is_between,"$g_talk_troop",crooks_begin,crooks_end)],
  ##   "I see that you need my services {sir/madam}...", "crook_talk",[]],
  ##  [anyone ,"crook_pretalk", [],
  ##   "Is that all?", "crook_talk",[]],
  
  
  
  ##  [anyone|plyr,"crook_talk", [], "I'm looking for a person...", "crook_search_person",[]],
  ##  [anyone|plyr,"crook_talk", [], "I want you to arrange me a meeting with someone...", "crook_request_meeting",[]],
  ##  [anyone|plyr,"crook_talk", [], "[Leave]", "close_window",[]],
  
  
  
  #  [anyone,"crook_enter_dungeon", [],
  #   "Alright but this will cost you 50 denars.", "crook_enter_dungeon_2", []],
  
  #  [anyone|plyr, "crook_enter_dungeon_2", [(store_troop_gold, ":cur_gold", "trp_player"),
  #                                            (ge, ":cur_gold", 50)],
  #   "TODO: Here it is. 50 denars.", "crook_enter_dungeon_3_1",[(troop_remove_gold, "trp_player", 50)]],
  
  #  [anyone|plyr, "crook_enter_dungeon_2", [(store_troop_gold, ":cur_gold", "trp_player"),
  #                                            (ge, ":cur_gold", 50)],
  #   "Never mind then.", "crook_pretalk",[]],
  
  #  [anyone|plyr, "crook_enter_dungeon_2", [(store_troop_gold, ":cur_gold", "trp_player"),
  #                                            (lt, ":cur_gold", 50)],
  #   "TODO: I don't have that much money.", "crook_enter_dungeon_3_2",[]],
  
  #  [anyone,"crook_enter_dungeon_3_1", [],
  #   "TODO: There you go.", "close_window", [(call_script, "script_enter_dungeon", "$current_town", "mt_visit_town_castle")]],
  
  #  [anyone,"crook_enter_dungeon_3_2", [],
  #   "TODO: Come back later then.", "crook_pretalk",[]],
  
  
  ##  [anyone, "crook_request_meeting", [],
  ##   "Who do you want to meet with?", "crook_request_meeting_2",[]],
  ##  [anyone|plyr|repeat_for_troops,"crook_request_meeting_2", [(store_encountered_party, ":center_no"),
  ##                                                             (store_repeat_object, ":troop_no"),
  ##                                                             (is_between, ":troop_no", heroes_begin, heroes_end),
  ##                                                             (troop_get_slot, ":cur_center", ":troop_no", slot_troop_cur_center),
  ##                                                             (call_script, "script_get_troop_attached_party", ":troop_no"),
  ##                                                             (assign, ":cur_center_2", reg0),
  ##                                                             (this_or_next|eq, ":cur_center", ":center_no"),
  ##                                                             (eq, ":cur_center_2", ":center_no"),
  ##                                                             (neg|party_slot_eq, ":center_no", slot_town_lord, ":troop_no"),#Neglect the ruler of the center
  ##                                                             (str_store_troop_name, s1, ":troop_no")],
  ##   "{s1}", "crook_request_meeting_3", [(store_repeat_object, "$selected_troop")]],
  ##
  ##  [anyone|plyr,"crook_request_meeting_2", [], "Never mind.", "crook_pretalk", []],
  ##
  ##  [anyone,"crook_request_meeting_3", [],
  ##   "Alright but this will cost you 50 denars.", "crook_request_meeting_4", []],
  ##
  ##  [anyone|plyr, "crook_request_meeting_4", [(store_troop_gold, ":cur_gold", "trp_player"),
  ##                                            (ge, ":cur_gold", 50)],
  ##   "TODO: Here it is. 50 denars.", "crook_search_person_5_1",[(troop_remove_gold, "trp_player", 50)]],
  ##
  ##  [anyone|plyr, "crook_request_meeting_4", [(store_troop_gold, ":cur_gold", "trp_player"),
  ##                                            (ge, ":cur_gold", 50)],
  ##   "Never mind then.", "crook_pretalk",[]],
  ##
  ##  [anyone|plyr, "crook_request_meeting_4", [(store_troop_gold, ":cur_gold", "trp_player"),
  ##                                            (lt, ":cur_gold", 50)],
  ##   "TODO: I don't have that much money.", "crook_search_person_5_2",[]],
  ##
  ##  [anyone, "crook_search_person_5_1", [],
  ##   "TODO: Ok.", "close_window",[(party_get_slot, ":town_alley", "$g_encountered_party", slot_town_alley),
  ##                                (modify_visitors_at_site,":town_alley"),(reset_visitors),
  ##                                (set_visitor,0,"trp_player"),
  ##                                (set_visitor,17,"$selected_troop"),
  ##                                (set_jump_mission,"mt_conversation_encounter"),
  ##                                (jump_to_scene,":town_alley"),
  ##                                (assign, "$talk_context", tc_back_alley),
  ##                                (change_screen_map_conversation, "$selected_troop")]],
  ##
  ##  [anyone, "crook_search_person_5_2", [],
  ##   "TODO: Come back later then.", "crook_pretalk",[]],
  ##
  ##  [anyone, "crook_search_person", [],
  ##   "TODO: Who are you searching for?", "crook_search_person_2",[]],
  ##  [anyone|plyr|repeat_for_factions,"crook_search_person_2", [(store_repeat_object, ":faction_no"),
  ##                                                             (is_between, ":faction_no", kingdoms_begin, kingdoms_end),
  ##                                                             (str_store_faction_name, s1, ":faction_no")],
  ##   "TODO: I'm looking for a {s1}.", "crook_search_person_3", [(store_repeat_object, "$selected_faction")]],
  ##
  ##  [anyone|plyr,"crook_search_person_2", [], "Never mind.", "crook_pretalk", []],
  ##
  ##
  ##  [anyone, "crook_search_person_3", [],
  ##   "TODO: Who?", "crook_search_person_4",[]],
  ##
  ##  [anyone|plyr|repeat_for_troops,"crook_search_person_4", [(store_repeat_object, ":troop_no"),
  ##                                                           (is_between, ":troop_no", heroes_begin, heroes_end),
  ##                                                           (store_troop_faction, ":faction_no", ":troop_no"),
  ##                                                           (eq, ":faction_no", "$selected_faction"),
  ##                                                           (str_store_troop_name, s1, ":troop_no")],
  ##   "{s1}", "crook_search_person_5", [(store_repeat_object, "$selected_troop")]],
  ##
  ##  [anyone|plyr,"crook_search_person_4", [], "Never mind.", "crook_pretalk", []],
  ##
  ##  [anyone, "crook_search_person_5", [(call_script, "script_get_information_about_troops_position", "$selected_troop", 0),
  ##                                     (eq, reg0, 1),
  ##                                     (str_store_troop_name, s1, "$selected_troop")],
  ##   "TODO: I know where {s1} is at the moment, but hearing it will cost you 50 denars.", "crook_search_person_6",[]],
  ##
  ##  [anyone, "crook_search_person_5", [],
  ##   "TODO: Sorry I don't know anything.", "crook_pretalk",[]],
  ##
  ##  [anyone|plyr, "crook_search_person_6", [(store_troop_gold, ":cur_gold", "trp_player"),
  ##                                          (ge, ":cur_gold", 50)],
  ##   "TODO: Here it is. 50 denars.", "crook_search_person_7_1",[(troop_remove_gold, "trp_player", 50)]],
  ##
  ##  [anyone|plyr, "crook_search_person_6", [(store_troop_gold, ":cur_gold", "trp_player"),
  ##                                          (ge, ":cur_gold", 50)],
  ##   "Never mind then.", "crook_pretalk",[]],
  ##
  ##  [anyone|plyr, "crook_search_person_6", [(store_troop_gold, ":cur_gold", "trp_player"),
  ##                                          (lt, ":cur_gold", 50)],
  ##   "TODO: I don't have that much money.", "crook_search_person_7_2",[]],
  ##
  ##  [anyone, "crook_search_person_7_1", [(call_script, "script_get_information_about_troops_position", "$selected_troop", 0)],
  ##   "{s1}", "crook_pretalk",[]],
  ##
  ##  [anyone, "crook_search_person_7_2", [],
  ##   "TODO: Come back later then.", "crook_pretalk",[]],
  ##
  
  [anyone|auto_proceed,"start", [
      (is_between,"$g_talk_troop","trp_town_1_master_craftsman", "trp_zendar_chest"),
      (party_get_slot, ":days_until_complete", "$g_encountered_party", slot_center_player_enterprise_days_until_complete),
      (ge, ":days_until_complete", 2),
      (assign, reg4, ":days_until_complete"),
    ],
    "{!}.", "start_craftsman_soon",[]],
  
  [anyone,"start_craftsman_soon", [
    ],
    "Good day, my {lord/lady}. We hope to begin production in about {reg4} days", "close_window",[]],
  
  [anyone,"start", [
      (is_between,"$g_talk_troop","trp_town_1_master_craftsman", "trp_zendar_chest"),
    ],
    "Good day, my {lord/lady}. We are honored that you have chosen to visit us. What do you require?", "master_craftsman_talk",[]],
  
  [anyone,"master_craftsman_pretalk", [],
    "Very good, my {lord/lady}. Do you require anything else?", "master_craftsman_talk",[]],
  
  [anyone|plyr,"master_craftsman_talk", [],
    "Let's go over the accounts.", "master_craftsman_accounts",[]],
  
  [anyone|plyr,"master_craftsman_talk", [],
    "Let's check the inventories.", "master_craftsman_pretalk",[
      (change_screen_loot, "$g_talk_troop"),
  ]],
  
  [anyone|plyr,"master_craftsman_talk", [
      (party_slot_eq, "$g_encountered_party", slot_center_player_enterprise_production_order, 1),
    ],
    "I'd like you to sell goods as they are produced.", "master_craftsman_pretalk",[
      (party_set_slot, "$g_encountered_party", slot_center_player_enterprise_production_order, 0),
  ]],
  
  [anyone|plyr,"master_craftsman_talk", [
      (party_slot_eq, "$g_encountered_party", slot_center_player_enterprise_production_order, 0),
    ],
    "I'd like you to keep all goods in the warehouse until I arrive.", "master_craftsman_pretalk",[
      (party_set_slot, "$g_encountered_party", slot_center_player_enterprise_production_order, 1),
  ]],
  
  [anyone,"master_craftsman_accounts", [
    ], "We currently produce {s3} worth {reg1} denars each week, while the quantity of {s4} needed to manufacture it costs {reg2}, and labor and upkeep are {reg3}.{s9} This means that we theoretically make a {s12} of {reg0} denars a week, assuming that we have no raw materials in the inventories, and that we sell directly to the market.", "master_craftsman_pretalk",
    [
      (party_get_slot, ":item_produced", "$g_encountered_party", slot_center_player_enterprise),
      (call_script, "script_process_player_enterprise", ":item_produced", "$g_encountered_party"),
      
      (try_begin),
        (ge, reg0, 0),
        (str_store_string, s12, "str_profit"),
      (else_try),
        (str_store_string, s12, "str_loss"),
      (try_end),
      
      (str_store_item_name, s3, ":item_produced"),
      (item_get_slot, ":primary_raw_material", ":item_produced", slot_item_primary_raw_material),
      (str_store_item_name, s4, ":primary_raw_material"),
      
      (item_get_slot, ":secondary_raw_material", ":item_produced", slot_item_secondary_raw_material),
      (str_clear, s9),
      (try_begin),
        (gt, ":secondary_raw_material", 0),
        (str_store_item_name, s11, ":secondary_raw_material"),
        (str_store_string, s9, "str_describe_secondary_input"),
      (try_end),
  ]],
  
  
  
  [anyone|plyr,"master_craftsman_talk", [
      ], "Could you explain my options related to production?", "master_craftsman_production_options",[]],
  
  [anyone,"master_craftsman_production_options", [
      (str_store_party_name, s5, "$g_encountered_party"),
      ], "Certainly, my {lord/lady}. Most of the time, the most profitable thing for you to do would be to let us buy raw materials and sell the finished goods directly to the market. Because of our longstanding relations with the local merchants, we can usually get a very good price.", "master_craftsman_production_options_2",[]],
  
  [anyone,"master_craftsman_production_options_2", [
      (str_store_party_name, s5, "$g_encountered_party"),
      ], "However, if you find that you can acquire raw materials cheaper outside {s5}, you may place them in the inventories, and we will use them instead of buying from the market. Likewise, if you feel that you can get a better price for the finished goods elsewhere, then you may ask us to deposit what we produce in our warehouses for you to take.", "master_craftsman_pretalk",[]],
  
  [anyone|plyr,"master_craftsman_talk", [
      ], "It will no longer be possible for me to continue operating this enterprise.", "master_craftsman_auction_price",[]],
  
  [anyone,"master_craftsman_auction_price", [
      (party_get_slot, ":item_produced", "$g_encountered_party", slot_center_player_enterprise),
      (item_get_slot, ":base_price",":item_produced", slot_item_base_price),
      (item_get_slot, ":number_runs", ":item_produced", slot_item_output_per_run),
      (store_mul, "$liquidation_price", ":base_price", ":number_runs"),
      (val_mul, "$liquidation_price", 4),
      
      (troop_get_inventory_capacity, ":total_capacity", "$g_talk_troop"),
      (try_for_range, ":capacity_iterator", 0, ":total_capacity"),
        (troop_get_inventory_slot, ":item_in_slot", "$g_talk_troop", ":capacity_iterator"),
        (gt, ":item_in_slot", 0),
        (item_get_slot, ":price_for_inventory_item", ":item_in_slot", slot_item_base_price),
        #		(troop_inventory_slot_get_item_amount, ":item_ammo", "$g_talk_troop", ":capacity_iterator"),
        #		(troop_inventory_slot_get_item_max_amount, ":item_max_ammo", "$g_talk_troop", ":capacity_iterator"),
        #		(try_begin),
        #			(lt, ":item_ammo", ":item_max_ammo"),
        #			(val_mul, ":price_for_inventory_item", ":item_ammo"),
        #			(val_div, ":price_for_inventory_item", ":item_max_ammo"),
        #		(try_end),
        
        (store_sub, ":item_slot_no", ":item_in_slot", trade_goods_begin),
        (val_add, ":item_slot_no", slot_town_trade_good_prices_begin),
        (party_get_slot, ":index", "$g_encountered_party", ":item_slot_no"),
        (val_mul, ":price_for_inventory_item", ":index"),
        (val_div, ":price_for_inventory_item", 1200),
        #modify by site
        #divide by 1200 not 1000
        (val_add, "$liquidation_price", ":price_for_inventory_item"),
      (try_end),
      
      (assign, reg4, "$liquidation_price"),
      
      ], "A pity, my {lord/lady}. If we sell the land and the equipment, and liquidate the inventories, I estimate that we can get {reg4} denars.", "master_craftsman_auction_decide",[]],
  
  [anyone|plyr,"master_craftsman_auction_decide", [
      ], "That sounds reasonable. Please proceed with the sale.", "master_craftsman_liquidation",[
      (troop_add_gold, "trp_player", "$liquidation_price"),
      (troop_clear_inventory, "$g_talk_troop"),
      (party_set_slot, "$g_encountered_party", slot_center_player_enterprise, 0),
      (party_set_slot, "$g_encountered_party", slot_center_player_enterprise_production_order, 0),
      
  ]],
  
  [anyone|plyr,"master_craftsman_auction_decide", [
      ], "Hmm. Let's hold off on that.", "master_craftsman_pretalk",[]],
  
  [anyone,"master_craftsman_liquidation", [
      ], "As you wish. It was an honor to have been in your employ.", "close_window",[
      (finish_mission),
  ]],
  
  [anyone|plyr,"master_craftsman_talk", [
      (eq, 1, 0),
      ], "{!}As you wish, {sir/my lady}. It was an honor to work in your employ.", "close_window",[]],
  
  [anyone|plyr,"master_craftsman_talk", [],
    "That is all for now.", "close_window",[]],
  
  
  
  
  
  #Mayor talk (town elder)
  
  [anyone ,"start", [(is_between,"$g_talk_troop",mayors_begin,mayors_end),(eq,"$g_talk_troop_met",0),
      (this_or_next|eq, "$players_kingdom", "$g_encountered_party_faction"),
      (             eq, "$g_encountered_party_faction", "fac_player_supporters_faction"),],
    "Good day, my lord.", "mayor_begin",[(play_sound, "snd_maitre_guild"),]],
  [anyone ,"start", [(is_between,"$g_talk_troop",mayors_begin,mayors_end),(eq,"$g_talk_troop_met",0),
      (str_store_party_name, s9, "$current_town")],
    "Hello stranger, you seem to be new to {s9}. I am the guild master of the town.", "mayor_talk",[(play_sound, "snd_maitre_guild"),]],
  
  [anyone ,"start", [(is_between,"$g_talk_troop",mayors_begin,mayors_end)],
    "Good day, {playername}.", "mayor_begin",
    [
      #Delete last offered quest if peace is formed.
      (try_begin),
        (eq, "$merchant_offered_quest", "qst_persuade_lords_to_make_peace"),
        (party_get_slot, ":target_faction", "qst_persuade_lords_to_make_peace", slot_quest_target_faction),
        (party_get_slot, ":object_faction", "qst_persuade_lords_to_make_peace", slot_quest_object_faction),
        (store_relation, ":reln", ":target_faction", ":object_faction"),
        (ge, ":reln", 0),
        (assign, "$merchant_quest_last_offerer", -1),
        (assign, "$merchant_offered_quest", -1),
      (try_end),
  ]],
  
  
  [anyone,"mayor_begin", [(check_quest_active, "qst_persuade_lords_to_make_peace"),
      (quest_slot_eq, "qst_persuade_lords_to_make_peace", slot_quest_giver_troop, "$g_talk_troop"),
      (check_quest_succeeded, "qst_persuade_lords_to_make_peace"),
      (quest_get_slot, ":quest_target_troop", "qst_persuade_lords_to_make_peace", slot_quest_target_troop),
      (quest_get_slot, ":quest_object_troop", "qst_persuade_lords_to_make_peace", slot_quest_object_troop),
      (val_mul, ":quest_target_troop", -1),
      (val_mul, ":quest_object_troop", -1),
      (quest_get_slot, ":quest_target_faction", "qst_persuade_lords_to_make_peace", slot_quest_target_faction),
      (quest_get_slot, ":quest_object_faction", "qst_persuade_lords_to_make_peace", slot_quest_object_faction),
      (str_store_troop_name, s12, ":quest_target_troop"),
      (str_store_troop_name, s13, ":quest_object_troop"),
      (str_store_faction_name, s14, ":quest_target_faction"),
      (str_store_faction_name, s15, ":quest_object_faction"),
      (str_store_party_name, s19, "$current_town"),
    ],
    "{playername}, it was an incredible feat to get {s14} and {s15} make peace, and you made it happen. " +
    "Your involvement has not only saved our town from disaster, but it has also saved thousands of lives, and put an end to all the grief this bitter war has caused. " +
    "As the townspeople of {s19}, know that we'll be good on our word, and we are ready to pay the {reg12} denars we promised.", "lord_persuade_lords_to_make_peace_completed",
    [(quest_get_slot, ":quest_target_faction", "qst_persuade_lords_to_make_peace", slot_quest_target_faction),
      (quest_get_slot, ":quest_object_faction", "qst_persuade_lords_to_make_peace", slot_quest_object_faction),
      #Forcing 2 factions to make peace within 72 hours.
      (assign, "$g_force_peace_faction_1", ":quest_target_faction"),
      (assign, "$g_force_peace_faction_2", ":quest_object_faction"),
      (quest_get_slot, ":quest_reward", "qst_persuade_lords_to_make_peace", slot_quest_gold_reward),
      (assign, reg12, ":quest_reward"),
      #TODO: Change these values
      (add_xp_as_reward, 4000),
  ]],
  
  
  [anyone|plyr,"lord_persuade_lords_to_make_peace_completed", [],
    "Thank you. Let me have the money.", "lord_persuade_lords_to_make_peace_pay",[]],
  [anyone|plyr,"lord_persuade_lords_to_make_peace_completed", [],
    "No need for a payment. I only did what was right.", "lord_persuade_lords_to_make_peace_no_pay",[]],
  
  [anyone ,"lord_persuade_lords_to_make_peace_pay", [],
    "Oh, yes, of course. We had already got the money for you. " +
    "Here, please accept these {reg12} denars together with our most sincere thanks. " +
    "Me and the people of our town will not forget your help.", "close_window",
    [(quest_get_slot, ":quest_reward", "qst_persuade_lords_to_make_peace", slot_quest_gold_reward),
      (call_script, "script_troop_add_gold", "trp_player", ":quest_reward"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 5),
      (call_script, "script_end_quest", "qst_persuade_lords_to_make_peace"),
      (quest_get_slot, ":quest_reward", "qst_persuade_lords_to_make_peace", slot_quest_gold_reward),
      (assign, reg12, ":quest_reward")
  ]],
  
  [anyone ,"lord_persuade_lords_to_make_peace_no_pay", [],
    "You are indeed an extraordenary person, {sir/madame}, and it is an honour for me to have known you. " +
    "You not only did what was impiossible and put an end to this terrible war, but you won't even accept a reward for it. " +
    "Very well, I will not insist on the matter, but please know that you will have our eternal respect and gratitude.", "close_window",
    [
      (call_script, "script_change_player_honor", 3),
      (call_script, "script_change_player_relation_with_center", "$current_town", 8),
      (call_script, "script_end_quest", "qst_persuade_lords_to_make_peace"),
  ]],
  
  [anyone,"mayor_begin", [(check_quest_active, "qst_deal_with_night_bandits"),
      (quest_slot_eq, "qst_deal_with_night_bandits", slot_quest_giver_troop, "$g_talk_troop"),
      (check_quest_succeeded, "qst_deal_with_night_bandits"),
    ],
    "Very nice work, {playername}, you made short work of those lawless curs. " +
    "Thank you kindly for all your help, and please accept this bounty of 150 denars.", "lord_deal_with_night_bandits_completed",
    [
      (add_xp_as_reward,200),
      (call_script, "script_troop_add_gold", "trp_player", 150),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
      (call_script, "script_end_quest", "qst_deal_with_night_bandits"),
  ]],
  
  
  [anyone|plyr,"lord_deal_with_night_bandits_completed", [],
    "It was my pleasure, {s65}.", "close_window",[]],
  
  # Ryan BEGIN
  [anyone,"mayor_begin", [(check_quest_active, "qst_deal_with_looters"),
      (quest_slot_eq, "qst_deal_with_looters", slot_quest_giver_troop, "$g_talk_troop"),
    ],
    "Ah, {playername}. Have you any progress to report?", "mayor_looters_quest_response",
    [
  ]],
  
  [anyone|plyr,"mayor_looters_quest_response",
    [
      (store_num_parties_destroyed_by_player, ":num_looters_destroyed", "pt_looters"),
      (party_template_get_slot,":previous_looters_destroyed","pt_looters",slot_party_template_num_killed),
      (val_sub,":num_looters_destroyed",":previous_looters_destroyed"),
      (quest_get_slot,":looters_paid_for","qst_deal_with_looters",slot_quest_current_state),
      (lt,":looters_paid_for",":num_looters_destroyed"),
    ],
    "I've killed some looters.", "mayor_looters_quest_destroyed",[]],
  [anyone|plyr,"mayor_looters_quest_response", [(eq,1,0)
    ],
    "I've brought you some goods.", "mayor_looters_quest_goods",[]],
  [anyone|plyr,"mayor_looters_quest_response", [
    ],
    "Not yet, sir. Farewell.", "close_window",[]],
  
  [anyone,"mayor_looters_quest_destroyed", [],
    "Aye, my scouts saw the whole thing. That should make anyone else think twice before turning outlaw! " +
    "The bounty is 40 denars for every band, so that makes {reg1} in total. Here is your money, as promised.",
    "mayor_looters_quest_destroyed_2",[
      (store_num_parties_destroyed_by_player, ":num_looters_destroyed", "pt_looters"),
      (party_template_get_slot,":previous_looters_destroyed","pt_looters",slot_party_template_num_killed),
      (val_sub,":num_looters_destroyed",":previous_looters_destroyed"),
      (quest_get_slot,":looters_paid_for","qst_deal_with_looters",slot_quest_current_state),
      (store_sub,":looter_bounty",":num_looters_destroyed",":looters_paid_for"),
      (val_mul,":looter_bounty",40),
      (assign,reg1,":looter_bounty"),
      (call_script, "script_troop_add_gold", "trp_player", ":looter_bounty"),
      (assign,":looters_paid_for",":num_looters_destroyed"),
      (quest_set_slot,"qst_deal_with_looters",slot_quest_current_state,":looters_paid_for"),
  ]],
  [anyone,"mayor_looters_quest_destroyed_2", [
      (quest_get_slot,":total_looters","qst_deal_with_looters",slot_quest_target_amount),
      (quest_slot_ge,"qst_deal_with_looters",slot_quest_current_state,":total_looters"), # looters paid for >= total looters
      (quest_get_slot,":xp_reward","qst_deal_with_looters",slot_quest_xp_reward),
      (quest_get_slot,":gold_reward","qst_deal_with_looters",slot_quest_gold_reward),
      (add_xp_as_reward, ":xp_reward"),
      (call_script, "script_troop_add_gold", "trp_player", ":gold_reward"),
      (call_script, "script_change_troop_renown", "trp_player", 1),
      (call_script, "script_change_player_relation_with_center", "$current_town", 5),
      (call_script, "script_end_quest", "qst_deal_with_looters"),
      (try_for_parties, ":cur_party_no"),
        (party_get_template_id, ":cur_party_template", ":cur_party_no"),
        (eq, ":cur_party_template", "pt_looters"),
        (party_set_flags, ":cur_party_no", pf_quest_party, 0),
      (try_end),
    ],
    "And that's not the only good news! Thanks to you, the looters have ceased to be a threat. We've not had a single attack reported for some time now. " +
    "If there are any of them left, they've either run off or gone deep into hiding. That's good for business, " +
    "and what's good for business is good for the town! " +
    "I think that concludes our arrangement, {playername}. Please accept this silver as a token of my gratitude. Thank you, and farewell.",
    "close_window",[
  ]],
  [anyone,"mayor_looters_quest_destroyed_2", [],
    "Anything else you need?",
    "mayor_looters_quest_response",[
  ]],
  
  [anyone,"mayor_looters_quest_goods", [
      (quest_get_slot,reg1,"qst_deal_with_looters",slot_quest_target_item),
    ],
    "Hah, I knew I could count on you! Just tell me which item to take from your baggage, and I'll send some men to collect it. " +
    "I still need {reg1} denars' worth of goods.",
    "mayor_looters_quest_goods_response",[
  ]],
  [anyone|plyr|repeat_for_100,"mayor_looters_quest_goods_response", [
      (store_repeat_object,":goods"),
      (val_add,":goods",trade_goods_begin),
      (is_between,":goods",trade_goods_begin,trade_goods_end),
      (player_has_item,":goods"),
      (str_store_item_name,s5,":goods"),
    ],
    "{s5}.", "mayor_looters_quest_goods_2",[
      (store_repeat_object,":goods"),
      (val_add,":goods",trade_goods_begin),
      (troop_remove_items,"trp_player",":goods",1),
      (assign,":value",reg0),
      (call_script, "script_troop_add_gold", "trp_player", ":value"),
      (quest_get_slot,":gold_num","qst_deal_with_looters",slot_quest_target_item),
      (val_sub,":gold_num",":value"),
      (quest_set_slot,"qst_deal_with_looters",slot_quest_target_item,":gold_num"),
      (str_store_item_name,s6,":goods"),
  ]],
  [anyone|plyr,"mayor_looters_quest_goods_response", [
    ],
    "Nothing at the moment, sir.", "mayor_looters_quest_goods_3",[]],
  
  [anyone,"mayor_looters_quest_goods_3", [
    ],
    "Anything else you need?",
    "mayor_looters_quest_response",[
  ]],
  
  [anyone,"mayor_looters_quest_goods_2", [
      (quest_slot_ge,"qst_deal_with_looters",slot_quest_target_item,1),
      (quest_get_slot,reg1,"qst_deal_with_looters",slot_quest_target_item),
    ],
    "Excellent, here is the money for your {s6}. Do you have any more goods to give me? I still need {reg1} denars' worth of goods.",
    "mayor_looters_quest_goods_response",[
  ]],
  [anyone,"mayor_looters_quest_goods_2", [
      (neg|quest_slot_ge,"qst_deal_with_looters",slot_quest_target_item,1),
      (quest_get_slot,":xp_reward","qst_deal_with_looters",slot_quest_xp_reward),
      (quest_get_slot,":gold_reward","qst_deal_with_looters",slot_quest_gold_reward),
      (add_xp_as_reward, ":xp_reward"),
      (call_script, "script_troop_add_gold", "trp_player", ":gold_reward"),
      #      (call_script, "script_change_troop_renown", "trp_player", 1),
      (call_script, "script_change_player_relation_with_center", "$current_town", 3),
      (call_script, "script_end_quest", "qst_deal_with_looters"),
      (try_for_parties, ":cur_party_no"),
        (party_get_template_id, ":cur_party_template", ":cur_party_no"),
        (eq, ":cur_party_template", "pt_looters"),
        (party_set_flags, ":cur_party_no", pf_quest_party, 0),
      (try_end),
    ],
    "Well done, {playername}, that's the last of the goods I need. Here is the money for your {s6}, and a small bonus for helping me out. " +
    "I'm afraid I won't be paying for any more goods, nor bounties on looters, but you're welcome to keep hunting the bastards if any remain. " +
    "Thank you for your help, I won't forget it.",
    "close_window",[
  ]],
  # Ryan END
  
  
  
  [anyone,"mayor_begin", [(check_quest_active, "qst_move_cattle_herd"),
      (quest_slot_eq, "qst_move_cattle_herd", slot_quest_giver_troop, "$g_talk_troop"),
      (check_quest_succeeded, "qst_move_cattle_herd"),
    ],
    "Good to see you again {playername}. I have heard that you have delivered the cattle successfully. " +
    "I will tell the merchants how reliable you are. " +
    "And here is your pay, {reg8} denars.", "close_window",
    [(quest_get_slot, ":quest_gold_reward", "qst_move_cattle_herd", slot_quest_gold_reward),
      (call_script, "script_troop_add_gold", "trp_player", ":quest_gold_reward"),
      (store_div, ":xp_reward", ":quest_gold_reward", 3),
      (add_xp_as_reward, ":xp_reward"),
      (call_script, "script_change_troop_renown", "trp_player", 1),
      (call_script, "script_change_player_relation_with_center", "$current_town", 3),
      (call_script, "script_end_quest", "qst_move_cattle_herd"),
      (assign, reg8, ":quest_gold_reward"),
  ]],
  
  [anyone,"mayor_begin", [(check_quest_active, "qst_move_cattle_herd"),
      (quest_slot_eq, "qst_move_cattle_herd", slot_quest_giver_troop, "$g_talk_troop"),
      (check_quest_failed, "qst_move_cattle_herd"),
    ],
    "I heard that you have lost the cattle herd on your way to {s9}. " +
    "I had a very difficult time explaining your failure to the owner of that herd, {sir/madam}. " +
    "Do you have anything to say?", "move_cattle_herd_failed",
    []],
  
  [anyone|plyr ,"move_cattle_herd_failed", [],
    "I am sorry. But I was attacked on the way.", "move_cattle_herd_failed_2",[]],
  [anyone|plyr ,"move_cattle_herd_failed", [],
    "I am sorry. The stupid animals wandered off during the night.", "move_cattle_herd_failed_2",[]],
  
  [anyone,"move_cattle_herd_failed_2", [],
    "Well, it was your responsibility to deliver that herd safely, no matter what. " +
    "You should know that the owner of the herd demanded to be compensated for his loss, and I had to pay him 1000 denars. " +
    "So you now owe me that money.", "merchant_ask_for_debts",
    [(assign, "$debt_to_merchants_guild", 1000),
      (call_script, "script_end_quest", "qst_move_cattle_herd"),]],
  
  [anyone,"mayor_begin", [(check_quest_active, "qst_kidnapped_girl"),
      (quest_slot_eq, "qst_kidnapped_girl", slot_quest_current_state, 4),
      (quest_slot_eq, "qst_kidnapped_girl", slot_quest_giver_troop, "$g_talk_troop"),
    ],
    "{playername} -- I am in your debt for bringing back my friend's daughter. " +
    "Please take these {reg8} denars that I promised you. " +
    "My friend wished he could give more but paying that ransom brought him to his knees.", "close_window",
    [(quest_get_slot, ":quest_gold_reward", "qst_kidnapped_girl", slot_quest_gold_reward),
      (call_script, "script_troop_add_gold", "trp_player", ":quest_gold_reward"),
      (assign, reg8, ":quest_gold_reward"),
      (assign, ":xp_reward", ":quest_gold_reward"),
      (val_mul, ":xp_reward", 2),
      (val_add, ":xp_reward", 100),
      (add_xp_as_reward, ":xp_reward"),
      (call_script, "script_change_troop_renown", "trp_player", 3),
      (call_script, "script_change_player_relation_with_center", "$current_town", 2),
      (call_script, "script_end_quest", "qst_kidnapped_girl"),
  ]],
  
  [anyone,"mayor_begin", [(check_quest_active, "qst_track_down_bandits"),
      (check_quest_succeeded, "qst_track_down_bandits"),
      (quest_slot_eq, "qst_track_down_bandits", slot_quest_giver_troop, "$g_talk_troop"),
    ],
    "Well -- it sounds like you were able to track down the bandits, and show them what happens to those who would disrupt the flow of commerce. " +
    "Here is your reward: {reg5} denars. " +
    "It is well earned, and we are most grateful.",
    "mayor_friendly_pretalk", [(quest_get_slot, ":quest_gold_reward", "qst_track_down_bandits", slot_quest_gold_reward),
      (call_script, "script_troop_add_gold", "trp_player", ":quest_gold_reward"),
      (assign, ":xp_reward", ":quest_gold_reward"),
      (val_mul, ":xp_reward", 2),
      (add_xp_as_reward, ":xp_reward"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 2),
      (call_script, "script_change_troop_renown", "trp_player", 3),
      (call_script, "script_end_quest", "qst_track_down_bandits"),
      (assign, reg5, ":quest_gold_reward"),
  ]],
  
  [anyone,"mayor_begin", [(check_quest_active, "qst_troublesome_bandits"),
      (check_quest_succeeded, "qst_troublesome_bandits"),
      (quest_slot_eq, "qst_troublesome_bandits", slot_quest_giver_troop, "$g_talk_troop"),
    ],
    "I have heard about your deeds. You have given those bandits the punishment they deserved. " +
    "You are really as good as they say. " +
    "Here is your reward: {reg5} denars. " +
    "I would like to give more but those bandits almost brought me to bankruptcy.",
    "mayor_friendly_pretalk", [(quest_get_slot, ":quest_gold_reward", "qst_troublesome_bandits", slot_quest_gold_reward),
      (call_script, "script_troop_add_gold", "trp_player", ":quest_gold_reward"),
      (assign, ":xp_reward", ":quest_gold_reward"),
      (val_mul, ":xp_reward", 2),
      (add_xp_as_reward, ":xp_reward"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 2),
      (call_script, "script_change_troop_renown", "trp_player", 3),
      (call_script, "script_end_quest", "qst_troublesome_bandits"),
      (assign, reg5, ":quest_gold_reward"),
  ]],
  
  #destroy lair quest end dialogs taken from here
  
  [anyone,"mayor_begin", [(ge, "$debt_to_merchants_guild", 50)],
    "According to my accounts, you owe the merchants guild {reg1} denars. " +
    "I'd better collect that now.", "merchant_ask_for_debts",[(assign,reg(1),"$debt_to_merchants_guild")]],
  [anyone|plyr,"merchant_ask_for_debts", [[store_troop_gold,reg(5),"trp_player"],[ge,reg(5),"$debt_to_merchants_guild"]],
    "Alright. I'll pay my debt to you.", "merchant_debts_paid",[[troop_remove_gold, "trp_player","$debt_to_merchants_guild"],
      [assign,"$debt_to_merchants_guild",0]]],
  [anyone, "merchant_debts_paid", [], "Excellent. I'll let my fellow merchants know that you are clear of any debts.", "mayor_pretalk",[]],
  
  [anyone|plyr, "merchant_ask_for_debts", [], "I'm afraid I can't pay that sum now.", "merchant_debts_not_paid",[]],
  [anyone, "merchant_debts_not_paid", [(assign,reg(1),"$debt_to_merchants_guild")], "In that case, I am afraid, I can't deal with you. Guild rules... " +
    "Come back when you can pay the {reg1} denars. " +
    "And know that we'll be charging an interest to your debt. " +
    "So the sooner you pay it, the better.", "close_window",[]],
  
  
  [anyone,"mayor_begin", [], "What can I do for you?", "mayor_talk", []],
  [anyone,"mayor_friendly_pretalk", [], "Now... What else may I do for you?", "mayor_talk",[]],
  [anyone,"mayor_pretalk", [], "Yes?", "mayor_talk",[]],
  
  [anyone|plyr,"mayor_talk", [], "Can you tell me about what you do?", "mayor_info_begin",[]],
  
  [anyone|plyr,"mayor_talk", [(store_partner_quest, ":partner_quest"),
      (lt, ":partner_quest", 0),
      (neq, "$merchant_quest_last_offerer", "$g_talk_troop")],
    "Do you happen to have a job for me?", "merchant_quest_requested",[
      (assign,"$merchant_quest_last_offerer", "$g_talk_troop"),
      (call_script, "script_get_quest", "$g_talk_troop"),
      (assign, "$random_merchant_quest_no", reg0),
      (assign,"$merchant_offered_quest","$random_merchant_quest_no"),
  ]],
  
  [anyone|plyr,"mayor_talk", [(store_partner_quest, ":partner_quest"),
      (lt, ":partner_quest", 0),
      (eq,"$merchant_quest_last_offerer", "$g_talk_troop"),
      (gt,"$merchant_offered_quest", 0) #not sure why was zero
    ],
    "About that job you offered me...", "merchant_quest_last_offered_job",[]],
  
  [anyone|plyr,"mayor_talk", [(store_partner_quest,reg(2)),(ge,reg(2),0)],
    "About the job you gave me...", "merchant_quest_about_job",[]],
  
  [anyone|plyr,"mayor_talk",[], "I have some questions of a political nature.", "mayor_political_talk",[]],
  
  [anyone|plyr,"mayor_talk",[], "How is trade around here?", "mayor_economy_report_1",[
      (call_script, "script_merchant_road_info_to_s42", "$g_encountered_party"), #also does items to s32
  ]],
  
  [anyone|plyr,"mayor_talk",[
      ], "How does the wealth of this region compare with the rest of France?", "mayor_wealth_comparison_1",[
  ]],
  
  
  [anyone|plyr,"mayor_talk",[
      (item_slot_ge, "itm_velvet", slot_item_secondary_raw_material, "itm_raw_dyes"), #ie, the item information has been updated, to ensure savegame compatibility
      ], "I wish to buy land in this town for a productive enterprise", "mayor_investment_possible",[
  ]],
  
  
  
  
  
  [anyone,"mayor_investment_possible",[
      (party_slot_ge, "$g_encountered_party", slot_center_player_enterprise, 1),
      (party_get_slot, ":item_produced", "$g_encountered_party", slot_center_player_enterprise),
      (call_script, "script_get_enterprise_name", ":item_produced"),
      (str_store_string, s4, reg0),
      ], "You already operate a {s4} here. There probably aren't enough skilled tradesmen to start a second enterprise.", "mayor_pretalk",[
  ]],
  
  [anyone,"mayor_investment_possible",[
      (ge, "$cheat_mode", 3)
      ], "{!}CHEAT: Yes, we're playtesting this feature, and you're in cheat mode. Go right ahead.", "mayor_investment_advice",[
  ]],
  
  [anyone,"mayor_investment_possible",[
      (lt,"$g_encountered_party_relation",0),
      (str_store_string, s9, "str_enterprise_enemy_realm"),
      ], "{s9}", "mayor_pretalk",[
  ]],
  
  [anyone,"mayor_investment_possible",[
      (party_slot_eq, "$g_encountered_party", slot_town_lord, "trp_player"),
      ], "Of course, {sir/my lady}. You are the lord of this town, and no one is going to stop you.", "mayor_investment_advice",[
  ]],
  
  [anyone,"mayor_investment_possible",[
      (party_get_slot, ":town_liege", "$g_encountered_party", slot_town_lord),
      (is_between, ":town_liege", active_npcs_begin, active_npcs_end),
      (call_script, "script_troop_get_relation_with_troop", "trp_player", ":town_liege"),
      (assign, ":relation", reg0),
      (lt, ":relation", 0),
      (str_store_troop_name, s4, ":town_liege"),
      ], "Well... Given your relationship with our liege, {s4}, I think that you will not find many here who are brave enough to sell you any land.", "mayor_investment",[
  ]],
  
  [anyone|auto_proceed,"mayor_investment",[], "{!}.", "mayor_pretalk",[]],
  
  
  [anyone,"mayor_investment_possible",[
      (neg|party_slot_ge, "$current_town", slot_center_player_relation, 0),
      ], "Well... To be honest, I think that we in the guild would like to know you a little better. We can be very particular about outsiders coming in here and buying land.", "mayor_pretalk",[
  ]],
  
  [anyone,"mayor_investment_possible",[
      ], "Very good, {sir/my lady}. We in the guild know and trust you, and I think I could find someone to sell you the land you need.", "mayor_investment_advice",[]],
  
  
  [anyone,"mayor_investment_advice",[], "A couple of things to keep in mind -- skilled laborers are always at a premium, so I doubt that you will be able to open up more than one enterprise here. In order to make a profit for yourself, you should choose a commodity which is in relatively short supply, but for which the raw materials are cheap. What sort of enterprise would you like to start?", "investment_choose_enterprise",[
  ]],
  
  [anyone|plyr,"investment_choose_enterprise",[], "A mill and bakery, to make bread from grain", "investment_summary",[
      (assign, "$enterprise_production", "itm_bread"),
  ]],
  
  [anyone|plyr,"investment_choose_enterprise",[], "A brewery, to make ale from grain", "investment_summary",[
      (assign, "$enterprise_production", "itm_ale"),
  ]],
  
  [anyone|plyr,"investment_choose_enterprise",[], "A tannery, to make leather from hides", "investment_summary",[
      (assign, "$enterprise_production", "itm_leatherwork"),
  ]],
  
  [anyone|plyr,"investment_choose_enterprise",[], "A wine press, to make wine from grapes", "investment_summary",[
      (assign, "$enterprise_production", "itm_wine"),
  ]],
  
  [anyone|plyr,"investment_choose_enterprise",[], "An oil press, to make oil from olives", "investment_summary",[
      (assign, "$enterprise_production", "itm_oil"),
  ]],
  
  [anyone|plyr,"investment_choose_enterprise",[], "An ironworks, to make tools from iron", "investment_summary",[
      (assign, "$enterprise_production", "itm_tools"),
  ]],
  
  [anyone|plyr,"investment_choose_enterprise",[], "A weavery and dyeworks, to make velvet from silk and dye", "investment_summary",[
      (assign, "$enterprise_production", "itm_velvet"),
  ]],
  
  [anyone|plyr,"investment_choose_enterprise",[], "A weavery, to make wool cloth from wool", "investment_summary",[
      (assign, "$enterprise_production", "itm_wool_cloth"),
  ]],
  
  [anyone|plyr,"investment_choose_enterprise",[], "A weavery, to make linen from flax", "investment_summary",[
      (assign, "$enterprise_production", "itm_linen"),
  ]],
  
  [anyone|plyr,"investment_choose_enterprise",[], "Never mind", "mayor_pretalk",[
  ]],
  
  [anyone,"investment_summary",[], "Very good, sir. The land and the materials on which you may build your {s3} will cost you {reg7} denars. Right now, your {s3} will produce {s4} worth {reg1} denars each week, while the {s6} needed to manufacture that batch will be {reg2} and labor and upkeep will be {reg3}.{s9} I should guess that your profit would be {reg0} denars a week. This assumes of course that prices remain constant -- which, I can virtually guarantee you, they will not. Do you wish to proceed?", "mayor_investment_confirm",
    [
      #(item_get_slot, ":base_price", "$enterprise_production", slot_item_base_price),
      #(item_get_slot, ":number_runs", "$enterprise_production", slot_item_output_per_run),
      #(store_mul, "$enterprise_cost", ":base_price", ":number_runs"),
      #(val_mul, "$enterprise_cost", 5),
      (item_get_slot, "$enterprise_cost", "$enterprise_production", slot_item_enterprise_building_cost),
      
      (assign, reg7, "$enterprise_cost"),
      
      (str_store_item_name, s4, "$enterprise_production"),
      
      (call_script, "script_get_enterprise_name", "$enterprise_production"),
      (str_store_string, s3, reg0),
      
      (call_script, "script_process_player_enterprise", "$enterprise_production", "$g_encountered_party"),
      #reg0: Profit per cycle
      #reg1: Selling price of total goods
      #reg2: Selling price of total goods
      
      (item_get_slot, ":primary_raw_material", "$enterprise_production", slot_item_primary_raw_material),
      (str_store_item_name, s6, ":primary_raw_material"),
      
      (str_clear, s9),
      (assign, ":cost_of_secondary_input", reg10),
      (try_begin),
        (gt, ":cost_of_secondary_input", 0),
        (item_get_slot, ":secondary_raw_material", "$enterprise_production", slot_item_secondary_raw_material),
        (str_store_item_name, s11, ":secondary_raw_material"),
        (str_store_string, s9, "str_describe_secondary_input"),
      (try_end),
  ]],
  
  
  [anyone|plyr,"mayor_investment_confirm",[
      (store_troop_gold, ":player_gold", "trp_player"),
      (ge, ":player_gold","$enterprise_cost"),
      ], "Yes. Here is money for the land.", "mayor_investment_purchase",[
      (party_set_slot, "$g_encountered_party", slot_center_player_enterprise, "$enterprise_production"),
      (party_set_slot, "$g_encountered_party", slot_center_player_enterprise_days_until_complete, 7),
      
      (troop_remove_gold, "trp_player", "$enterprise_cost"),
      (store_sub, ":current_town_order", "$current_town", towns_begin),
      (store_add, ":craftsman_troop", ":current_town_order", "trp_town_1_master_craftsman"),
      (try_begin),
        (eq, "$enterprise_production", "itm_bread"),
        (troop_set_name, ":craftsman_troop", "str_master_miller"),
      (else_try),
        (eq, "$enterprise_production", "itm_ale"),
        (troop_set_name, ":craftsman_troop", "str_master_brewer"),
      (else_try),
        (eq, "$enterprise_production", "itm_oil"),
        (troop_set_name, ":craftsman_troop", "str_master_presser"),
      (else_try),
        (eq, "$enterprise_production", "itm_tools"),
        (troop_set_name, ":craftsman_troop", "str_master_smith"),
      (else_try),
        (eq, "$enterprise_production", "itm_wool_cloth"),
        (troop_set_name, ":craftsman_troop", "str_master_weaver"),
      (else_try),
        (eq, "$enterprise_production", "itm_linen"),
        (troop_set_name, ":craftsman_troop", "str_master_weaver"),
      (else_try),
        (eq, "$enterprise_production", "itm_leatherwork"),
        (troop_set_name, ":craftsman_troop", "str_master_tanner"),
      (else_try),
        (eq, "$enterprise_production", "itm_velvet"),
        (troop_set_name, ":craftsman_troop", "str_master_dyer"),
      (else_try),
        (eq, "$enterprise_production", "itm_wine"),
        (troop_set_name, ":craftsman_troop", "str_master_vinter"),
      (try_end),
  ]],
  
  [anyone|plyr,"mayor_investment_confirm",[], "No -- that's not economical for me at the moment.", "mayor_pretalk",[
  ]],
  
  [anyone,"mayor_investment_purchase",[], "Very good. Your enterprise should be up and running in about a week. When next you come, and thereafter, you should speak to your {s4} about its operations.", "mayor_pretalk",[
      (store_sub, ":current_town_order", "$current_town", towns_begin),
      (store_add, ":craftsman_troop", ":current_town_order", "trp_town_1_master_craftsman"),
      (str_store_troop_name, s4, ":craftsman_troop"),
      
  ]],
  
  
  
  
  [anyone|plyr,"mayor_talk", [], "[Leave]", "close_window",[]],
  
  [anyone, "mayor_info_begin", [(str_store_party_name, s9, "$current_town")],
    "I am the guildmaster of {s9}. You can say I am the leader of the good people of {s9}. " +
    "I can help you find a job if you are looking for some honest work.", "mayor_info_talk",[(assign, "$mayor_info_lord_told",0)]],
  
  [anyone|plyr,"mayor_info_talk",[(eq, "$mayor_info_lord_told",0)], "Who rules this town?", "mayor_info_lord",[]],
  [anyone, "mayor_info_lord", [(party_get_slot, ":town_lord","$current_town",slot_town_lord),(str_store_troop_name, s10, ":town_lord")],
    "Our town's lord and protector is {s10}. He owns the castle and sometimes resides there, and collects taxes from the town. " +
    "However we regulate ourselves in most of the matters that concern ourselves. " +
    "As the town's guildmaster I have the authority to decide those things.", "mayor_info_talk",[(assign, "$mayor_info_lord_told",1)]],
  
  [anyone|plyr,"mayor_info_talk",[], "That's all I need to know. Thanks.", "mayor_pretalk",[]],
  
  
  [anyone, "mayor_political_talk", [(faction_get_slot, ":faction_leader","$g_encountered_party_faction",slot_faction_leader),
      (str_store_troop_name, s10, ":faction_leader"),
      (party_get_slot, ":town_lord","$current_town",slot_town_lord),
      (try_begin),
        (eq, ":town_lord", "trp_player"),
        (str_store_string, s10, "str_your_excellency"),
      (else_try),
        (is_between, ":town_lord", active_npcs_begin, active_npcs_end),
        (neq, ":town_lord", ":faction_leader"),
        (str_store_troop_name, s11, ":town_lord"),
        (neq, ":town_lord", ":faction_leader"),
        (str_store_string, s10, "str_s10_and_s11"),
      (try_end),
    ],
    "Politics? Good heaven, the guild has nothing to do with politics. We are loyal servants of {s10}. We merely govern our own affairs, and pass on the townspeople's concerns to our lords and masters, and maybe warn them from time to time against evil advice. Anyway, what did you wish to ask?", "mayor_political_questions",[]],
  
  [anyone,"mayor_prepolitics",[ (faction_get_slot, ":faction_leader","$g_encountered_party_faction",slot_faction_leader),
      (try_begin),
        (eq, ":faction_leader", "trp_player"),
        (str_store_string, s9, "str_your_loyal_subjects"),
      (else_try),
        (str_store_troop_name, s10, ":faction_leader"),
        (str_store_string, s9, "str_loyal_subjects_of_s10"),
      (try_end),
      ], "Did I mention that we here are all {s9}? Because I can't stress that enough... Anyway... Is there anything else?", "mayor_political_questions",[]],
  
  [anyone|plyr,"mayor_political_questions",[], "What is the cause of all these wars in France?", "mayor_war_description_1",[
  ]],
  #HYW
  [anyone,"mayor_war_description_1",[ (faction_get_slot, ":faction_leader","$g_encountered_party_faction",slot_faction_leader),
      (str_store_troop_name, s10, ":faction_leader"),
      (str_store_string, s22, "str_the"),
      #								(try_begin),
      #									(eq, "$g_encountered_party_faction", "fac_kingdom_5"),
      #									(str_store_string, s22, "str_we"),
      #								(try_end),
      (val_max, "$g_mayor_given_political_dialog", 1),
      #HYW
      ], "Well, to answer your question generally, each monarch claims to be the rightful heir to the old Calradic emperors. Some of these claims are based on forgotten dynastic marriages and others are based on obscure promises, while {s22} Rhodoks invoke the empire's unwritten constitution. So in theory, any one realm has the right to declare war on any other realm at any time.", "mayor_war_description_2",[]],
  
  [anyone,"mayor_war_description_2",[ (faction_get_slot, ":faction_leader","$g_encountered_party_faction",slot_faction_leader),
      (str_store_troop_name, s10, ":faction_leader"),
      (troop_get_type, reg4, ":faction_leader"),
      ], "In practice, to make war is exhausting work. It is easy enough to lay waste to the enemy's farmland, but crops will grow back, and it is a far different matter to capture an enemy stronghold and to hold it. So the monarchs of Europe will fight a little, sign a truce, fight a little more, and so on and so forth. Often, a monarch will go to war when another realm provokes them. At such times, some bad influences who look to enrich themselves with ransoms and pillage will clamor for retribution, and thus the damage caused by war to a monarch's treasury is less than the damage caused by doing nothing would be to his authority... I'm of course not talking about {s10}, as no one would ever question {reg4?her:his} authority", "mayor_war_description_3",[]],
  
  [anyone,"mayor_war_description_3",[
      (faction_get_slot, ":faction_leader","$g_encountered_party_faction",slot_faction_leader),
      (troop_get_type, reg4, ":faction_leader"),
      
      ], "I would stress again that we in the guild have nothing to do with politics. But if {s10} were to ask for my advice on these matters, as a loyal subject, I would tell {reg4?her:him} that while {reg4?her:his} claim to the throne is truly just, even the most legitimate claim must be backed by armed men, and armed men want money, and money comes from trade, and war ruins trade, so sometimes the best way to push a claim is not to push it, if you know what I mean...", "mayor_war_description_4",[]],
  
  [anyone,"mayor_war_description_4",[
      (str_store_party_name, s4, "$g_encountered_party"),
      (faction_get_slot, ":faction_leader","$g_encountered_party_faction",slot_faction_leader),
      (troop_get_type, reg4, ":faction_leader"),
      
      ], "You may tell {s10} this if you see {reg4?her:him}. Don't mention my name specifically -- just say 'the people of {s4}' told you this. Our personal opinion, of course, as to what would be in {s10}'s best interests. None of us would ever dream of questioning a monarch's sovereign right to push {reg4?her:his} legitimate claims.", "mayor_prepolitics",[
  ]],
  
  [anyone|plyr,"mayor_political_questions",[
      (faction_get_slot, ":faction_leader","$g_encountered_party_faction",slot_faction_leader),
      (str_store_troop_name, s10, ":faction_leader"),
      (ge, "$g_mayor_given_political_dialog", 1),
      
      ], "What is {s10}'s policy in regards to the other realms of Europe?", "mayor_politics_assess",[
  ]],
  
  [anyone,"mayor_politics_assess",[], "Which realm did you have in mind?", "mayor_politics_assess_realm",[
  ]],
  
  [anyone|plyr|repeat_for_factions,"mayor_politics_assess_realm",[
      (store_repeat_object, ":faction"),
      (is_between, ":faction", kingdoms_begin, kingdoms_end),
      (faction_slot_eq, ":faction", slot_faction_state, sfs_active),
      (neq, ":faction", "$g_encountered_party_faction"),
      (str_store_faction_name, s11, ":faction"),
      ], "{s11}", "mayor_politics_give_realm_assessment",[
      (store_repeat_object, "$faction_selected"),
  ]],
  
  [anyone,"mayor_politics_give_realm_assessment",[], "{s14}", "mayor_prepolitics",[
      (call_script, "script_npc_decision_checklist_peace_or_war", "$g_encountered_party_faction", "$faction_selected", -1),
  ]],
  
  [anyone|plyr,"mayor_political_questions",[], "What can you say about the internal politics of the realms?", "mayor_internal_politics",[
  ]],
  
  [anyone,"mayor_internal_politics",[
      (str_store_faction_name, s4, "$g_encountered_party_faction"),
      (faction_get_slot, ":leader", "$g_encountered_party_faction", slot_faction_leader),
      (str_store_troop_name, s5, ":leader"),
      (troop_get_type, reg4, ":leader"),
      ], "Well, here in the {s4} we are all united by our love for {s5} and support for {reg4?her:his} legitimate claim to the rulership of all France. But I have heard some talk of internal bickering in other realms...", "mayor_internal_politics_2",[
  ]],
  
  [anyone,"mayor_internal_politics_2",[], "The lords of a realm often have very different ideas about honor, strategy, and the way a nobleman should behave. In addition, they compete with each other for the ruler's favor, and are constantly weighing up their position -- how they stand, how their friends and family stand, and how their enemies stand.", "mayor_internal_politics_3", []],
  
  [anyone,"mayor_internal_politics_3",[], "Underlying all the tensions is the possibility that a lord may abandon his liege, and pledge vassalhood to another. In theory, each lord has sworn an oath of vassalage, but in practice, a vassal can always find an excuse to absolve himself. The vassal may claim that the liege has failed to hold up his end of the bargain, to protect the vassal and treat him justly. Or, the vassal may claim that his liege is in fact a usurper, and another has a better claim to the kingship.", "mayor_internal_politics_4", []],
  
  [anyone,"mayor_internal_politics_4",[], "Lieges and vassals still watch each other carefully. If a king believes that his vassal is going to change sides or rebel, he may indict the vassal for treason and seize his properties. Likewise, if a vassal fears that he will be indicted, he may rebel. Usually, whoever makes the first move will be able to control the vassal's fortresses.", "mayor_internal_politics_5", []],
  
  [anyone,"mayor_internal_politics_5",[], "Now, men do not trust a vassal who turns coat easily, nor do they trust a king who lightly throws around charges of treason. Those two factors can keep a realm together. But if relations between a vassal and a liege deteriorate far enough, things can become very tense indeed... In other lands, of course. These things could never happen here in the {s4}.", "mayor_prepolitics", []],
  
  [anyone|plyr, "mayor_political_questions", [], "That is all. Thank you.", "mayor_pretalk", []],
  
  
  [anyone,"merchant_quest_about_job", [], "What about it?", "merchant_quest_about_job_2",[]],
  [anyone|plyr,"merchant_quest_about_job_2", [], "What if I can't finish it?", "merchant_quest_what_if_fail",[]],
  [anyone|plyr,"merchant_quest_about_job_2", [], "Well, I'm still working on it.", "merchant_quest_about_job_working",[]],
  [anyone,"merchant_quest_about_job_working", [], "Good. I'm sure you will handle it.", "mayor_pretalk",[]],
  
  
  [anyone,"merchant_quest_last_offered_job", [], "Eh, you want to reconsider that. Good...", "merchant_quest_brief",
    [[assign,"$random_merchant_quest_no","$merchant_offered_quest"]]],
  
  
  [anyone,"merchant_quest_what_if_fail", [(store_partner_quest,":partner_quest"),(eq,":partner_quest","qst_deliver_wine")],
    "I hope you don't fail. In that case, I'll have to ask for the price of the cargo you were carrying.", "mayor_pretalk",[]],
  [anyone,"merchant_quest_what_if_fail", [], "Well, just do your best to finish it.", "mayor_pretalk",[]],
  
  [anyone,"merchant_quest_taken", [], "Excellent. I am counting on you then. Good luck.", "mayor_pretalk",
    []],
  [anyone,"merchant_quest_stall", [], "Well, the job will be available for a few more days I guess. Tell me if you decide to take it.", "mayor_pretalk",[]],
  
  
  [anyone,"mayor_economy_report_1", [], "{s32}", "mayor_economy_report_2",
    []],
  
  [anyone,"mayor_economy_report_2", [], "{s42}", "mayor_economy_report_3",
    []],
  
  [anyone,"mayor_economy_report_3", [], "{s47}", "mayor_pretalk",
    []],
  
  
  ###################################################################3
  # Random Merchant quests....
  ##############################
  
  # Ryan BEGIN
  # deal with looters
  
  [anyone,"merchant_quest_requested",
    [
      (eq,"$random_merchant_quest_no","qst_deal_with_looters"),
    ],
    "Well, you look able enough. I think I might have something you could do.", "merchant_quest_brief", []],
  
  [anyone,"merchant_quest_brief",
    [
      (eq,"$random_merchant_quest_no","qst_deal_with_looters"),
      (try_begin),
        (party_slot_eq,"$g_encountered_party",slot_party_type,spt_town),
        (str_store_string,s5,"@town"),
      (else_try),
        (party_slot_eq,"$g_encountered_party",slot_party_type,spt_village),
        (str_store_string,s5,"@village"),
      (try_end),
    ],
    "We've had some fighting near the {s5} lately, with all the chaos that comes with it, " +
    "and that's led some of our less upstanding locals to try and make their fortune out of looting the shops and farms during the confusion. " +
    "A lot of valuable goods were taken. I need somebody to teach those bastards a lesson. " +
    "Sound like your kind of work?", "merchant_quest_looters_choice", []],
  
  [anyone|plyr,"merchant_quest_looters_choice", [], "Aye, I'll do it.", "merchant_quest_looters_brief", []],
  
  [anyone|plyr,"merchant_quest_looters_choice", [], "I'm afraid I can't take the job at the moment.", "merchant_quest_stall",[]],
  
  [anyone,"merchant_quest_looters_brief", [
      (try_begin),
        (party_slot_eq,"$g_encountered_party",slot_party_type,spt_town),
        (str_store_string,s5,"@town"),
      (else_try),
        (party_slot_eq,"$g_encountered_party",slot_party_type,spt_village),
        (str_store_string,s5,"@village"),
      (try_end),
      
      #     (party_get_slot,":merchant","$current_town",slot_town_merchant),
      #     (troop_clear_inventory,":merchant"),
      (store_random_in_range,":random_num_looters",3,7),
      (quest_set_slot,"qst_deal_with_looters",slot_quest_target_amount,":random_num_looters"),
      (try_for_range,":unused",0,":random_num_looters"),
        (store_random_in_range,":random_radius",5,14),
        (set_spawn_radius,":random_radius"),
        (spawn_around_party,"$g_encountered_party","pt_looters"),
        (party_set_flags, reg0, pf_quest_party, 1),
        (party_set_ai_behavior, reg0, ai_bhvr_patrol_location),
        (party_set_ai_patrol_radius, reg0, 2),
        (party_get_position, pos0, reg0),
        (party_set_ai_target_position, reg0, pos0),
      (try_end),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_party_name_link, s13, "$g_encountered_party"),
      (str_store_party_name, s4, "$g_encountered_party"),
      (setup_quest_text, "qst_deal_with_looters"),
      (str_store_string, s2, "@The Guildmaster of {s13} has asked you to deal with looters in the surrounding countryside."),
      (call_script, "script_start_quest", "qst_deal_with_looters", "$g_talk_troop"),
      (assign, "$g_leave_encounter",1),
    ],
    "Excellent! You'll find the looters roaming around the countryside, probably trying to rob more good people. " +
    "Kill or capture the bastards, I don't care what you do with them. " +
    "I'll pay you a bounty of 40 denars on every band of looters you destroy, " +
    "until all the looters are dealt with.", "close_window",
    []],
  # Ryan END
  
  #The following few quests are non-random -- they will be checked every time a player asks for a job. If circumstances allow it, then the player will
  [anyone,"merchant_quest_requested", [
      (eq,"$random_merchant_quest_no","qst_retaliate_for_border_incident"),
      
      (quest_get_slot, ":target_faction", "qst_retaliate_for_border_incident", slot_quest_target_faction),
      (call_script, "script_faction_get_adjective_to_s10", ":target_faction"),
      
      (faction_get_slot, ":leader", "$g_encountered_party_faction", slot_faction_leader),
      (str_store_troop_name, s5, ":leader"),
      
    ], "Well, there is a very great favor which you could do us... As you may have heard, some {s10}s have come across the border to attack our people. {s5} is under great pressure from some of the more bellicose of his vassals to respond with a declaration of war. Unfortunately, while the great lords of this land grow rich from bloodshed, we of the commons will be caught in the middle, and will suffer.",
    "merchant_quest_explain_2", []],
  
  [anyone,"merchant_quest_explain_2", [
      (eq,"$random_merchant_quest_no","qst_retaliate_for_border_incident"),
      (quest_get_slot, ":target_troop", "qst_retaliate_for_border_incident", slot_quest_target_troop),
      (str_store_troop_name, s7, ":target_troop"),
      
    ],
    "We are not saying that {s5} should overlook this aggression -- far from it! But if he charges one of his own lords to respond, then the cycle of provocation will necessarily lead to a full-fledged confrontation. Now, if an outsider were to step in and defeat a {s10} lord in battle, then honor would be done, and it would defuse the clamor for war. If the defeated lord were a known troublemaker -- {s7} -- then the {s10}s might be able to overlook it.",
    "merchant_quest_brief",[]],
  
  [anyone,"merchant_quest_brief", [
      (eq,"$random_merchant_quest_no","qst_retaliate_for_border_incident"),
      (quest_get_slot, ":target_troop", "qst_retaliate_for_border_incident", slot_quest_target_troop),
      (str_store_troop_name, s7, ":target_troop"),
    ],
    "We need you to attack and defeat {s7}. This will not be an easy task, and that outsider would damage {his/her} relationship with the {s10}s, but we would be very grateful. We could not acknowledge a connection with that outsider, but we could be sure that {he/she} would be handsomely rewarded... Could you do this?",
    "merchant_quest_retaliate_confirm",[]],
  
  [anyone|plyr,"merchant_quest_retaliate_confirm", [], "Aye, I can do it.", "merchant_quest_track_bandits_brief", [
      #    (quest_set_slot, "qst_retaliate_for_border_incident", slot_quest_target_troop, "$g_target_leader"),
      #    (quest_set_slot, "qst_retaliate_for_border_incident", slot_quest_target_faction, "$g_target_faction"),
      
      (str_store_faction_name, s11, "$g_encountered_party_faction"),
      (setup_quest_text, "qst_retaliate_for_border_incident"),
      (str_store_string, s2, "str_track_down_s7_and_defeat_him_defusing_calls_for_war_within_the_s11"),
      (call_script, "script_start_quest", "qst_retaliate_for_border_incident", "$g_talk_troop"),
  ]],
  
  [anyone|plyr,"merchant_quest_retaliate_confirm", [], "I would prefer not to get mixed up in such things", "merchant_pretalk", [
      (quest_set_slot, "qst_retaliate_for_border_incident", slot_quest_dont_give_again_remaining_days, 5),
  ]],
  
  
  
  [anyone,"destroy_lair_quest_brief", [
      (eq,"$random_quest_no", "qst_destroy_bandit_lair"),
      (quest_get_slot, ":bandit_lair", "qst_destroy_bandit_lair", slot_quest_target_party),
      (party_get_template_id, ":bandit_type", ":bandit_lair"),
      (eq, ":bandit_type", "pt_sea_raider_lair"),
    ],
    "The raiders are likely to have laid up their ships in a well-concealed cove, somewhere along the coastline, preferably next to a small stream where they have some water. The best way to discover its location would be to find a group of sea raiders who appear to be heading back to their base to resupply, and follow them.", "merchant_quest_track_bandit_lair_choice",
    []],
  
  [anyone,"destroy_lair_quest_brief", [
      (eq,"$random_quest_no", "qst_destroy_bandit_lair"),
      (quest_get_slot, ":bandit_lair", "qst_destroy_bandit_lair", slot_quest_target_party),
      (party_get_template_id, ":bandit_type", ":bandit_lair"),
      (eq, ":bandit_type", "pt_desert_bandit_lair"),
    ],
    "Bandits such as these usually establish their hideouts in the foothills on the edge of the desert, often in a canyon near a spring. This gives them both water and concealment. The best way to discover its location would be to find a group of desert bandits who appear to be heading back to their base to resupply, and follow them.", "merchant_quest_track_bandit_lair_choice",
    []],
  
  [anyone,"destroy_lair_quest_brief", [
      (eq,"$random_quest_no", "qst_destroy_bandit_lair"),
      (quest_get_slot, ":bandit_lair", "qst_destroy_bandit_lair", slot_quest_target_party),
      (party_get_template_id, ":bandit_type", ":bandit_lair"),
      (eq, ":bandit_type", "pt_mountain_bandit_lair"),
    ],
    "Bandits such as these will usually establish a base in the highlands, often on an steep ledge where they have a view of the surrounding countryside. This makes them difficult to surprise. The best way to discover its location would be to find a group of mountain bandits who appear to be heading back to their base to resupply, and follow them.", "merchant_quest_track_bandit_lair_choice",
    []],
  
  [anyone,"destroy_lair_quest_brief", [
      (eq,"$random_quest_no", "qst_destroy_bandit_lair"),
      (quest_get_slot, ":bandit_lair", "qst_destroy_bandit_lair", slot_quest_target_party),
      (party_get_template_id, ":bandit_type", ":bandit_lair"),
      (eq, ":bandit_type", "pt_forest_bandit_lair"),
    ],
    "Bandits such as these will usually set up their encampments deep in the woods, sometimes in the middle of a swamp. The best way to discover its location would be to find a group of forest bandits who appear to be heading back to their base to resupply, and follow them.", "merchant_quest_track_bandit_lair_choice",
    []],
  
  [anyone,"destroy_lair_quest_brief", [
      (eq,"$random_quest_no", "qst_destroy_bandit_lair"),
      (quest_get_slot, ":bandit_lair", "qst_destroy_bandit_lair", slot_quest_target_party),
      (party_get_template_id, ":bandit_type", ":bandit_lair"),
      (eq, ":bandit_type", "pt_steppe_bandit_lair"),
    ],
    "Bandits such as these will usually set up their encampments in the woodland on the steppe, where they have some concealment. The best way to discover its location would be to find a group of steppe bandits who appear to be heading back to their base to resupply, and follow them.", "merchant_quest_track_bandit_lair_choice",
    []],
  
  [anyone,"destroy_lair_quest_brief", [
      (eq,"$random_quest_no", "qst_destroy_bandit_lair"),
      (quest_get_slot, ":bandit_lair", "qst_destroy_bandit_lair", slot_quest_target_party),
      (party_get_template_id, ":bandit_type", ":bandit_lair"),
      (eq, ":bandit_type", "pt_taiga_bandit_lair"),
    ],
    "Bandits such as these will usually set up their encampments deep in the woods. The best way to discover its location would be to find a group of tundra bandits who appear to be heading back to their base to resupply, and follow them.", "merchant_quest_track_bandit_lair_choice",
    []],
  
  [anyone|plyr,"merchant_quest_track_bandit_lair_choice", [], "Aye, I'll do it.", "merchant_quest_destroy_lair_brief", [
      
      (quest_get_slot, ":target_party", "qst_destroy_bandit_lair", slot_quest_target_party),
      (party_set_flags, ":target_party", pf_quest_party, 1),
      #    (quest_set_slot, "qst_track_down_bandits", slot_quest_target_party, "$g_bandit_party_for_bounty"), #WHY IS THIS COMMENTED OUT?
      (quest_set_slot, "qst_destroy_bandit_lair", slot_quest_giver_troop, "$g_talk_troop"),
      (quest_set_slot, "qst_destroy_bandit_lair", slot_quest_giver_center, "$g_encountered_party"),
      
      (str_store_troop_name_link, s11, "$g_talk_troop"),
      (str_store_party_name, s9, ":target_party"),
      (setup_quest_text, "qst_destroy_bandit_lair"),
      (str_store_string, s2, "str_bandit_lair_quest_description"),
      (call_script, "script_start_quest", "qst_destroy_bandit_lair", "$g_talk_troop"),
  ]],
  
  [anyone|plyr,"merchant_quest_track_bandit_lair_choice", [], "I'm afraid I can't take the job at the moment.", "lord_pretalk",[
      (quest_set_slot, "qst_destroy_bandit_lair", slot_quest_dont_give_again_remaining_days, 1),
  ]],
  
  [anyone,"merchant_quest_destroy_lair_brief", [
    ], "Very good. We will await word of your success.", "close_window",
    [
      (assign, "$g_leave_encounter", 1),
  ]],
  
  
  
  [anyone,"merchant_quest_requested", [
      (eq,"$random_merchant_quest_no", "qst_track_down_bandits"),
    ], "We have heard that {s4}, some travellers on the road {reg4?to:from} {s5} were attacked by {s7}.", "merchant_quest_brief",
    [
      (call_script,"script_merchant_road_info_to_s42", "$g_encountered_party"),
      (assign, "$g_bandit_party_for_bounty", reg0),
      (assign, ":origin", reg1),
      (assign, ":destination", reg2),
      (assign, ":hours_ago", reg3),
      (try_begin),
        (lt, ":hours_ago", 24),
        (str_store_string, s4, "str_a_short_while_ago"),
      (else_try),
        (lt, ":hours_ago", 48),
        (str_store_string, s4, "str_one_day_ago"),
      (else_try),
        (lt, ":hours_ago", 72),
        (str_store_string, s4, "str_two_days_day_ago"),
      (else_try),
        (lt, ":hours_ago", 144),
        (str_store_string, s4, "str_earlier_this_week"),
      (else_try),
        (str_store_string, s4, "str_about_a_week_ago"),
      (try_end),
      
      
      (try_begin),
        (eq, ":origin", "$g_encountered_party"),
        (str_store_party_name, s5, ":destination"),
        (assign, reg4, 0),
      (else_try),
        (eq, ":destination", "$g_encountered_party"),
        (str_store_party_name, s5, ":origin"),
        (assign, reg4, 1),
      (try_end),
      
      (str_store_party_name, s7, "$g_bandit_party_for_bounty"),
      ###
      (quest_set_slot, "qst_track_down_bandits", slot_quest_target_party, "$g_bandit_party_for_bounty"),
  ]],
  
  [anyone,"merchant_quest_brief", [
      (eq,"$random_merchant_quest_no", "qst_track_down_bandits"),
      (quest_get_slot, ":target_party", "qst_track_down_bandits", slot_quest_target_party),
      (str_store_party_name, s4, ":target_party"),
    ],
    "We would like you to track these {s4} down. The merchants of the town were able to get a description of their leader, and have put together a bounty. If you can hunt them down and destroy them, we'll make it worth your while...", "merchant_quest_track_bandits_choice",
    []],
  
  [anyone|plyr,"merchant_quest_track_bandits_choice", [], "Aye, I'll do it.", "merchant_quest_track_bandits_brief", [
      (assign, "$merchant_offered_quest", 0),
      (assign,"$merchant_quest_last_offerer", "$g_talk_troop"),
      
      (quest_get_slot, ":target_party", "qst_track_down_bandits", slot_quest_target_party),
      (party_set_flags, ":target_party", pf_quest_party, 1),
      #    (quest_set_slot, "qst_track_down_bandits", slot_quest_target_party, "$g_bandit_party_for_bounty"), #WHY IS THIS COMMENTED OUT?
      (quest_set_slot, "qst_track_down_bandits", slot_quest_giver_troop, "$g_talk_troop"),
      (quest_set_slot, "qst_track_down_bandits", slot_quest_giver_center, "$g_encountered_party"),
      
      (str_store_party_name_link, s8, "$g_encountered_party"),
      (str_store_party_name, s9, ":target_party"),
      (setup_quest_text, "qst_track_down_bandits"),
      (str_store_string, s2, "str_track_down_the_s9_who_attacked_travellers_near_s8_then_report_back_to_the_town"),
      (call_script, "script_start_quest", "qst_track_down_bandits", "$g_talk_troop"),
  ]],
  
  
  [anyone,"merchant_quest_track_bandits_brief", [
    ], "Very good. The band may not have lingered long in the area, but chances are that they will be spotted by other travellers on the road.", "close_window",
    [
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [anyone|plyr,"merchant_quest_track_bandits_choice", [], "I'm afraid I can't take the job at the moment.", "merchant_quest_stall",[
      (quest_set_slot, "qst_track_down_bandits", slot_quest_dont_give_again_remaining_days, 1),
  ]],
  
  
  
  #Random quests begin here. Deliver wine:
  [anyone,"merchant_quest_requested", [(eq,"$random_merchant_quest_no","qst_deliver_wine"),], "You're looking for a job? " +
    "Actually I was looking for someone to deliver some {s4}. " +
    "Perhaps you can do that...", "merchant_quest_brief",
    [(quest_get_slot, ":quest_target_item", "qst_deliver_wine", slot_quest_target_item),
      (str_store_item_name, s4, ":quest_target_item"),
  ]],
  
  [anyone,"merchant_quest_brief", [(eq,"$random_merchant_quest_no","qst_deliver_wine")],
    "I have a cargo of {s6} that needs to be delivered to the tavern in {s4}. " +
    "If you can take {reg5} units of {s6} to {s4} in 7 days, you may earn {reg8} denars. " +
    "What do you say?", "merchant_quest_brief_deliver_wine",
    [(quest_get_slot, reg5, "qst_deliver_wine", slot_quest_target_amount),
      (quest_get_slot, reg8, "qst_deliver_wine", slot_quest_gold_reward),
      (quest_get_slot, ":quest_target_item", "qst_deliver_wine", slot_quest_target_item),
      (quest_get_slot, ":quest_target_center", "qst_deliver_wine", slot_quest_target_center),
      (str_store_troop_name, s9, "$g_talk_troop"),
      (str_store_party_name_link, s3, "$g_encountered_party"),
      (str_store_party_name_link, s4, ":quest_target_center"),
      (str_store_item_name, s6, ":quest_target_item"),
      (setup_quest_text,"qst_deliver_wine"),
      (str_store_string, s2, "@{s9} of {s3} asked you to deliver {reg5} units of {s6} to the tavern in {s4} in 7 days."),
      #s2 should not be changed until the decision is made
  ]],
  
  [anyone|plyr,"merchant_quest_brief_deliver_wine", [(store_free_inventory_capacity,":capacity"),
      (quest_get_slot, ":quest_target_amount", "qst_deliver_wine", slot_quest_target_amount),
      (ge, ":capacity", ":quest_target_amount"),
    ],
    "Alright. I will make the delivery.", "merchant_quest_taken",
    [(quest_get_slot, ":quest_target_amount", "qst_deliver_wine", slot_quest_target_amount),
      (quest_get_slot, ":quest_target_item", "qst_deliver_wine", slot_quest_target_item),
      (troop_add_items, "trp_player", ":quest_target_item",":quest_target_amount"),
      (call_script, "script_start_quest", "qst_deliver_wine", "$g_talk_troop"),
  ]],
  
  [anyone|plyr,"merchant_quest_brief_deliver_wine", [], "I am afraid I can't carry all that cargo now.", "merchant_quest_stall",[]],
  
  #escort merchant caravan:
  [anyone,"merchant_quest_requested", [(eq,"$random_merchant_quest_no","qst_escort_merchant_caravan")], "You're looking for a job? " +
    "Actually I was looking for someone to escort a caravan. " +
    "Perhaps you can do that...", "merchant_quest_brief",
    []],
  
  [anyone,"merchant_quest_brief", [(eq, "$random_merchant_quest_no", "qst_escort_merchant_caravan")],
    "I am going to send a caravan of goods to {s8}. " +
    "However with all those bandits and deserters on the roads, I don't want to send them out without an escort. " +
    "If you can lead that caravan to {s8} in 15 days, you will earn {reg8} denars. " +
    "Of course your party needs to be at least {reg4} strong to offer them any protection.", "escort_merchant_caravan_quest_brief",
    [(quest_get_slot, reg8, "qst_escort_merchant_caravan", slot_quest_gold_reward),
      (quest_get_slot, reg4, "qst_escort_merchant_caravan", slot_quest_target_amount),
      (quest_get_slot, ":quest_target_center", "qst_escort_merchant_caravan", slot_quest_target_center),
      (str_store_party_name, s8, ":quest_target_center"),
  ]],
  
  [anyone|plyr,"escort_merchant_caravan_quest_brief", [(store_party_size_wo_prisoners, ":party_size", "p_main_party"),
      (quest_get_slot, ":quest_target_amount", "qst_escort_merchant_caravan", slot_quest_target_amount),
      (ge,":party_size",":quest_target_amount"),
    ],
    "Alright. I will escort the caravan.", "merchant_quest_taken",
    [(quest_get_slot, ":quest_target_center", "qst_escort_merchant_caravan", slot_quest_target_center),
      (set_spawn_radius, 1),
      (spawn_around_party,"$g_encountered_party","pt_merchant_caravan"),
      (assign, ":quest_target_party", reg0),
      (party_set_ai_behavior, ":quest_target_party", ai_bhvr_track_party),
      (party_set_ai_object, ":quest_target_party", "p_main_party"),
      (party_set_flags, ":quest_target_party", pf_default_behavior, 0),
      (quest_set_slot, "qst_escort_merchant_caravan", slot_quest_target_party, ":quest_target_party"),
      (quest_set_slot, "qst_escort_merchant_caravan", slot_quest_current_state, 0),
      (str_store_party_name_link, s8, ":quest_target_center"),
      (setup_quest_text, "qst_escort_merchant_caravan"),
      (str_store_string, s2, "@Escort the merchant caravan to the town of {s8}."),
      (call_script, "script_start_quest", "qst_escort_merchant_caravan", "$g_talk_troop"),
  ]],
  
  [anyone|plyr,"escort_merchant_caravan_quest_brief", [(store_party_size_wo_prisoners, ":party_size", "p_main_party"),
      (quest_get_slot, ":quest_target_amount", "qst_escort_merchant_caravan", slot_quest_target_amount),
      (lt,":party_size",":quest_target_amount"),],
    "I am afraid I don't have that many soldiers with me.", "merchant_quest_stall",[]],
  [anyone|plyr,"escort_merchant_caravan_quest_brief", [(store_party_size_wo_prisoners, ":party_size", "p_main_party"),
      (quest_get_slot, ":quest_target_amount", "qst_escort_merchant_caravan", slot_quest_target_amount),
      (ge,":party_size",":quest_target_amount"),],
    "Sorry. I can't do that right now", "merchant_quest_stall",[]],
  
  [party_tpl|pt_merchant_caravan,"start", [(quest_get_slot, ":quest_target_party", "qst_escort_merchant_caravan", slot_quest_target_party),
      (eq,"$g_encountered_party",":quest_target_party"),
      (quest_slot_eq,"qst_escort_merchant_caravan", slot_quest_current_state, 2),
    ],
    "We can cover the rest of the way ourselves. Thanks.", "close_window",[(assign, "$g_leave_encounter", 1)]],
  
  [party_tpl|pt_merchant_caravan,"start", [(quest_get_slot, ":quest_target_party", "qst_escort_merchant_caravan", slot_quest_target_party),
      (eq,"$g_encountered_party",":quest_target_party"),
      (quest_get_slot, ":quest_target_center", "qst_escort_merchant_caravan", slot_quest_target_center),
      (store_distance_to_party_from_party, ":dist", ":quest_target_center",":quest_target_party"),
      (lt,":dist",4),
      (quest_slot_eq, "qst_escort_merchant_caravan", slot_quest_current_state, 1),
    ],
    "Well, we have almost reached {s21}. We can cover the rest of the way ourselves. " +
    "Here's your pay... {reg14} denars. " +
    "Thanks for escorting us. Good luck.", "close_window",[(quest_get_slot, ":quest_target_party", "qst_escort_merchant_caravan", slot_quest_target_party),
      (quest_get_slot, ":quest_target_center", "qst_escort_merchant_caravan", slot_quest_target_center),
      (quest_get_slot, ":quest_giver_center", "qst_escort_merchant_caravan", slot_quest_giver_center),
      (quest_get_slot, ":quest_gold_reward", "qst_escort_merchant_caravan", slot_quest_gold_reward),
      (party_set_ai_behavior, ":quest_target_party", ai_bhvr_travel_to_party),
      (party_set_ai_object, ":quest_target_party", ":quest_target_center"),
      (party_set_flags, ":quest_target_party", pf_default_behavior, 0),
      (str_store_party_name, s21, ":quest_target_center"),
      (call_script, "script_change_player_relation_with_center", ":quest_giver_center", 1),
      (call_script, "script_end_quest","qst_escort_merchant_caravan"),
      (quest_set_slot, "qst_escort_merchant_caravan", slot_quest_current_state, 2),
      (call_script, "script_troop_add_gold", "trp_player", ":quest_gold_reward"),
      (assign, ":xp_reward", ":quest_gold_reward"),
      (val_mul, ":xp_reward", 5),
      (val_add, ":xp_reward", 100),
      (add_xp_as_reward, ":xp_reward"),
      (call_script, "script_change_troop_renown", "trp_player", 2),
      (assign, reg14, ":quest_gold_reward"),
      (assign, "$g_leave_encounter", 1),
  ]],
  
  [party_tpl|pt_merchant_caravan,"start", [(quest_get_slot, ":quest_target_party", "qst_escort_merchant_caravan", slot_quest_target_party),
      (eq,"$g_encountered_party",":quest_target_party"),
      (quest_slot_eq, "qst_escort_merchant_caravan", slot_quest_current_state, 0),
    ],
    "Greetings. You must be our escort, right?", "merchant_caravan_intro_1",[(quest_set_slot, "qst_escort_merchant_caravan", slot_quest_current_state, 1),]],
  
  [anyone|plyr,"merchant_caravan_intro_1", [], "Yes. My name is {playername}. I will lead you to {s1}.",
    "merchant_caravan_intro_2",[(quest_get_slot, ":quest_target_center", "qst_escort_merchant_caravan", slot_quest_target_center),
      (str_store_party_name, s1, ":quest_target_center"),
  ]],
  
  [anyone,"merchant_caravan_intro_2", [], "Well, It is good to know we won't travel alone. What do you want us to do now?", "escort_merchant_caravan_talk",[]],
  
  [party_tpl|pt_merchant_caravan,"start", [(quest_get_slot, ":quest_target_party", "qst_escort_merchant_caravan", slot_quest_target_party),
      (eq, "$g_encountered_party", ":quest_target_party"),
    ],
    "Eh. We've made it this far... What do you want us to do?", "escort_merchant_caravan_talk",[]],
  
  [anyone|plyr,"escort_merchant_caravan_talk", [], "You follow my lead. I'll take you through a safe route.", "merchant_caravan_follow_lead",[]],
  [anyone,"merchant_caravan_follow_lead", [], "Alright. We'll be right behind you.", "close_window",[(assign, "$escort_merchant_caravan_mode", 0),
      (assign, "$g_leave_encounter", 1)]],
  [anyone|plyr,"escort_merchant_caravan_talk", [], "You stay here for a while. I'll go ahead and check the road.", "merchant_caravan_stay_here",[]],
  [anyone,"merchant_caravan_stay_here", [], "Alright. We'll be waiting here for you.", "close_window",[(assign, "$escort_merchant_caravan_mode", 1),
      (assign, "$g_leave_encounter", 1)]],
  #  [anyone|plyr,"escort_merchant_caravan_talk", [], "You go ahead to {s1}. I'll catch up with you.", "merchant_caravan_go_to_destination",[]],
  #  [anyone,"merchant_caravan_go_to_destination", [], "Alright. But stay close.", "close_window",[[assign,"escort_merchant_caravan_mode",2]]],
  
  
  # Troublesome bandits:
  [anyone,"merchant_quest_requested", [(eq, "$random_merchant_quest_no", "qst_troublesome_bandits")],
    "Actually, I was looking for an able adventurer like you. " +
    "There's this group of particularly troublesome bandits. " +
    "They have infested the vicinity of our town and are preying on my caravans. " +
    "They have avoided all the soldiers and the militias up to now. " +
    "If someone doesn't stop them soon, I am going to be ruined...", "merchant_quest_brief",
    []],
  
  [anyone,"merchant_quest_brief", [(eq,"$random_merchant_quest_no", "qst_troublesome_bandits")],
    "I will pay you {reg8} denars if you hunt down those troublesome bandits. " +
    "It's dangerous work. But I believe that you are the {man/one} for it. " +
    "What do you say?", "troublesome_bandits_quest_brief",[(quest_get_slot, reg8, "qst_troublesome_bandits", slot_quest_gold_reward),
  ]],
  
  [anyone|plyr,"troublesome_bandits_quest_brief", [],
    "Very well. I will hunt down those bandits.", "merchant_quest_taken_bandits",
    [(set_spawn_radius,7),
      (quest_get_slot, ":quest_giver_center", "qst_troublesome_bandits", slot_quest_giver_center),
      (spawn_around_party,":quest_giver_center","pt_troublesome_bandits"),
      (quest_set_slot, "qst_troublesome_bandits", slot_quest_target_party, reg0),
      (store_num_parties_destroyed,"$qst_troublesome_bandits_eliminated","pt_troublesome_bandits"),
      (store_num_parties_destroyed_by_player, "$qst_troublesome_bandits_eliminated_by_player", "pt_troublesome_bandits"),
      (str_store_troop_name, s9, "$g_talk_troop"),
      (str_store_party_name_link, s4, "$g_encountered_party"),
      (setup_quest_text,"qst_troublesome_bandits"),
      (str_store_string, s2, "@Merchant {s9} of {s4} asked you to hunt down the troublesome bandits in the vicinity of the town."),
      (call_script, "script_start_quest", "qst_troublesome_bandits", "$g_talk_troop"),
  ]],
  [anyone,"merchant_quest_taken_bandits", [], "You will? Splendid. Good luck to you.", "close_window",
    []],
  
  [anyone|plyr,"troublesome_bandits_quest_brief", [],
    "Sorry. I don't have time for this right now.", "merchant_quest_stall",[]],
  
  # Kidnapped girl:
  [anyone,"merchant_quest_requested", [(eq, "$random_merchant_quest_no", "qst_kidnapped_girl")],
    "Actually, I was looking for a reliable {man/helper} that can undertake an important mission. " +
    "A group of bandits have kidnapped the daughter of a friend of mine and are holding her for ransom. " +
    "My friend is ready to pay them, but we still need " +
    "someone to take the money to those rascals and bring the girl back to safety.", "merchant_quest_brief",
    []],
  
  [anyone,"merchant_quest_brief", [(eq, "$random_merchant_quest_no", "qst_kidnapped_girl")],
    "The amount the bandits ask as ransom is {reg12} denars. " +
    "I will give you that money once you accept to take the quest. " +
    "You have 15 days to take the money to the bandits who will be waiting near the village of {s4}. " +
    "Those bastards said that they are going to kill the poor girl if they don't get the money by that time. " +
    "You will get your pay of {reg8} denars when you bring the girl safely back here.",
    "kidnapped_girl_quest_brief",[(quest_get_slot, ":quest_target_center", "qst_kidnapped_girl", slot_quest_target_center),
      (str_store_party_name, s4, ":quest_target_center"),
      (quest_get_slot, reg8, "qst_kidnapped_girl", slot_quest_gold_reward),
      (quest_get_slot, reg12, "qst_kidnapped_girl", slot_quest_target_amount),
  ]],
  
  [anyone|plyr,"kidnapped_girl_quest_brief", [],
    "All right. I will take the ransom money to the bandits and bring back the girl.",
    "kidnapped_girl_quest_taken",[(set_spawn_radius, 4),
      (quest_get_slot, ":quest_target_center", "qst_kidnapped_girl", slot_quest_target_center),
      (quest_get_slot, ":quest_target_amount", "qst_kidnapped_girl", slot_quest_target_amount),
      (spawn_around_party,":quest_target_center","pt_bandits_awaiting_ransom"),
      (assign, ":quest_target_party", reg0),
      (quest_set_slot, "qst_kidnapped_girl", slot_quest_target_party, ":quest_target_party"),
      (party_set_ai_behavior, ":quest_target_party", ai_bhvr_hold),
      (party_set_ai_object, ":quest_target_party", "p_main_party"),
      (party_set_flags, ":quest_target_party", pf_default_behavior, 0),
      (call_script, "script_troop_add_gold", "trp_player", ":quest_target_amount"),
      (assign, reg12, ":quest_target_amount"),
      (str_store_troop_name, s1, "$g_talk_troop"),
      (str_store_party_name_link, s4, "$g_encountered_party"),
      (str_store_party_name_link, s3, ":quest_target_center"),
      (setup_quest_text, "qst_kidnapped_girl"),
      (str_store_string, s2, "@Guildmaster of {s4} gave you {reg12} denars to pay the ransom of a girl kidnapped by bandits. " +
        "You are to meet the bandits near {s3} and pay them the ransom fee. " +
      "After that you are to bring the girl back to {s4}."),
      (call_script, "script_start_quest", "qst_kidnapped_girl", "$g_talk_troop"),
  ]],
  
  [anyone,"kidnapped_girl_quest_taken", [], "Good. I knew we could trust you at this. " +
    "Here is the ransom money, {reg12} denars. " +
    "Count it before taking it. " +
    "And please, don't attempt to do anything rash. " +
    "Keep in mind that the girl's well being is more important than anything else...", "close_window",
    []],
  
  [anyone|plyr,"kidnapped_girl_quest_brief", [],
    "Sorry. I don't have time for this right now.", "merchant_quest_stall",[]],
  
  
  [trp_kidnapped_girl,"start",
    [
      (eq, "$talk_context", tc_entering_center_quest_talk),
    ],
    "Thank you so much for bringing me back! " +
    "I can't wait to see my family. Good-bye.",
    "close_window",
    [(remove_member_from_party, "trp_kidnapped_girl"),
      (quest_set_slot, "qst_kidnapped_girl", slot_quest_current_state, 4),
  ]],
  
  
  
  [trp_kidnapped_girl|plyr,"kidnapped_girl_liberated_map", [], "Yes. Come with me. We are going home.", "kidnapped_girl_liberated_map_2a",[]],
  [trp_kidnapped_girl,"kidnapped_girl_liberated_map_2a", [(neg|party_can_join)], "Unfortunately. You do not have room in your party for me.", "close_window",[(assign, "$g_leave_encounter",1)]],
  [trp_kidnapped_girl,"kidnapped_girl_liberated_map_2a", [], "Oh really? Thank you so much!",
    "close_window", [(party_join),
      (quest_set_slot, "qst_kidnapped_girl", slot_quest_current_state, 3),
      (assign, "$g_leave_encounter",1)]],
  [trp_kidnapped_girl|plyr,"kidnapped_girl_liberated_map", [], "Wait here a while longer. I'll come back for you.", "kidnapped_girl_liberated_map_2b",[]],
  [trp_kidnapped_girl,"kidnapped_girl_liberated_map_2b", [], "Oh, please {sir/madam}, do not leave me here all alone!", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  
  [trp_kidnapped_girl,"start", [],
    "Oh {sir/madam}. Thank you so much for rescuing me. Will you take me to my family now?", "kidnapped_girl_liberated_map",[]],
  
  [trp_kidnapped_girl|plyr,"kidnapped_girl_liberated_battle", [], "Yes. Come with me. We are going home.", "kidnapped_girl_liberated_battle_2a",[]],
  [trp_kidnapped_girl,"kidnapped_girl_liberated_battle_2a", [(neg|hero_can_join, "p_main_party")], "Unfortunately. You do not have room in your party for me.", "kidnapped_girl_liberated_battle_2b",[]],
  [trp_kidnapped_girl,"kidnapped_girl_liberated_battle_2a", [], "Oh really? Thank you so much!",
    "close_window",[(party_add_members, "p_main_party","trp_kidnapped_girl",1),
      (quest_set_slot, "qst_kidnapped_girl", slot_quest_current_state, 3),
  ]],
  [trp_kidnapped_girl|plyr,"kidnapped_girl_liberated_battle", [], "Wait here a while longer. I'll come back for you.", "kidnapped_girl_liberated_battle_2b",[]],
  [trp_kidnapped_girl,"kidnapped_girl_liberated_battle_2b", [], "Oh, please {sir/madam}, do not leave me here all alone!",
    "close_window", [(add_companion_party,"trp_kidnapped_girl"),
      (assign, "$g_leave_encounter",1)]],
  
  [trp_kidnapped_girl,"start", [], "Can I come with you now?", "kidnapped_girl_liberated_map",[]],
  
  
  [party_tpl|pt_bandits_awaiting_ransom,"start", [(quest_slot_eq, "qst_kidnapped_girl", slot_quest_current_state, 0),],
    "Are you the one that brought the ransom? " +
    "Quick, give us the money now.", "bandits_awaiting_ransom_intro_1",[(quest_set_slot, "qst_kidnapped_girl", slot_quest_current_state, 1),]],
  [party_tpl|pt_bandits_awaiting_ransom,"start", [(quest_slot_eq, "qst_kidnapped_girl", slot_quest_current_state, 1),],
    "You came back? " +
    "Quick, give us the money now.", "bandits_awaiting_ransom_intro_1",[]],
  [party_tpl|pt_bandits_awaiting_ransom|plyr, "bandits_awaiting_ransom_intro_1", [(store_troop_gold, ":cur_gold"),
      (quest_get_slot, ":quest_target_amount", "qst_kidnapped_girl", slot_quest_target_amount),
      (ge, ":cur_gold", ":quest_target_amount")
    ],
    "Here, take the money. Just set the girl free.", "bandits_awaiting_ransom_pay",[]],
  [party_tpl|pt_bandits_awaiting_ransom, "bandits_awaiting_ransom_pay", [],
    "Heh. You've brought the money all right. " +
    "You can take the girl now. " +
    "It was a pleasure doing business with you...", "close_window",
    [(quest_get_slot, ":quest_target_amount", "qst_kidnapped_girl", slot_quest_target_amount),
      (quest_get_slot, ":quest_target_party", "qst_kidnapped_girl", slot_quest_target_party),
      (quest_get_slot, ":quest_target_center", "qst_kidnapped_girl", slot_quest_target_center),
      (troop_remove_gold, "trp_player", ":quest_target_amount"),
      (remove_member_from_party, "trp_kidnapped_girl", ":quest_target_party"),
      (set_spawn_radius, 1),
      (spawn_around_party, ":quest_target_party", "pt_kidnapped_girl"),
      (assign, ":girl_party", reg0),
      (party_set_ai_behavior, ":girl_party", ai_bhvr_hold),
      (party_set_flags, ":girl_party", pf_default_behavior, 0),
      (quest_set_slot, "qst_kidnapped_girl", slot_quest_current_state, 2),
      (party_set_ai_behavior, ":quest_target_party", ai_bhvr_travel_to_party),
      (party_set_ai_object, ":quest_target_party", ":quest_target_center"),
      (party_set_flags, ":quest_target_party", pf_default_behavior, 0),
      (add_gold_to_party, ":quest_target_amount", ":quest_target_party"),
      (assign, "$g_leave_encounter",1),
  ]],
  
  [anyone|plyr, "bandits_awaiting_ransom_intro_1", [],
    "No way! You release the girl first.", "bandits_awaiting_ransom_b",[]],
  [anyone, "bandits_awaiting_ransom_b", [],
    "You fool! Stop playing games and give us the money! ", "bandits_awaiting_ransom_b2",[]],
  [anyone|plyr, "bandits_awaiting_ransom_b2", [(store_troop_gold, ":cur_gold"),
      (quest_get_slot, ":quest_target_amount", "qst_kidnapped_girl", slot_quest_target_amount),
      (ge, ":cur_gold", ":quest_target_amount")],
    "All right. Here's your money. Let the girl go now.", "bandits_awaiting_ransom_pay",[]],
  [anyone|plyr, "bandits_awaiting_ransom_b2", [],
    "I had left the money in a safe place. Let me go fetch it.", "bandits_awaiting_ransom_no_money",[]],
  [anyone, "bandits_awaiting_ransom_no_money", [],
    "Are you testing our patience or something?  Go and bring that money here quickly.", "close_window",[(assign, "$g_leave_encounter",1)]],
  [anyone|plyr, "bandits_awaiting_ransom_b2", [],
    "I have no intention to pay you anything. I demand that you release the girl now!", "bandits_awaiting_ransom_fight",[]],
  [anyone, "bandits_awaiting_ransom_fight", [],
    "You won't be demanding anything when you're dead.", "close_window",[(encounter_attack),]],
  
  [party_tpl|pt_bandits_awaiting_ransom,"start", [(quest_slot_ge, "qst_kidnapped_girl", slot_quest_current_state, 2),],
    "What's it? You have given us the money. We have no more business.", "bandits_awaiting_remeet",[]],
  [anyone|plyr,"bandits_awaiting_remeet", [],
    "Sorry to bother you. I'll be on my way now.", "close_window",[(assign, "$g_leave_encounter",1)]],
  [anyone|plyr,"bandits_awaiting_remeet", [],
    "We have one more business. You'll give the money back to me.", "bandits_awaiting_remeet_2",[]],
  [anyone,"bandits_awaiting_remeet_2", [],
    "Oh, that business! Of course. Let us get down to it.", "close_window",[(encounter_attack)]],
  
  [party_tpl|pt_kidnapped_girl,"start", [],
    "Oh {sir/madam}. Thank you so much for rescuing me. Will you take me to my family now?", "kidnapped_girl_encounter_1",[]],
  [anyone|plyr,"kidnapped_girl_encounter_1", [], "Yes. Come with me. I'll take you home.", "kidnapped_girl_join",[]],
  [anyone,"kidnapped_girl_join", [(neg|party_can_join)], "Unfortunately. You do not have room in your party for me.", "close_window",[(assign, "$g_leave_encounter",1)]],
  [anyone,"kidnapped_girl_join", [], "Oh, thank you so much!",
    "close_window",[(party_join),
      (quest_set_slot, "qst_kidnapped_girl", slot_quest_current_state, 3),
      (assign, "$g_leave_encounter",1)]],
  [anyone|plyr,"kidnapped_girl_encounter_1", [], "Wait here a while longer. I'll come back for you.", "kidnapped_girl_wait",[]],
  [anyone,"kidnapped_girl_wait", [], "Oh, please {sir/madam}, do not leave me here all alone!", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  [anyone|plyr,"merchant_quest_about_job_2", [(store_partner_quest, ":partner_quest"),
      (eq, ":partner_quest", "qst_kidnapped_girl"),
      (quest_slot_eq, "qst_kidnapped_girl", slot_quest_current_state, 3),
      (neg|main_party_has_troop, "trp_kidnapped_girl")],
    "Unfortunately I lost the girl on the way here...", "lost_kidnapped_girl",[]],
  [anyone,"lost_kidnapped_girl", [],
    "Oh no! How am I going to tell this to my friend?", "lost_kidnapped_girl_2",[]],
  [anyone|plyr,"lost_kidnapped_girl_2", [],
    "I'm sorry. I could do nothing about it.", "lost_kidnapped_girl_3",[]],
  [anyone,"lost_kidnapped_girl_3", [],
    "You let me down {playername}. I had trusted you. " +
    "I will let people know of your incompetence at this task. " +
    "Also, I want back that {reg8} denars I gave you as the ransom fee.", "lost_kidnapped_girl_4",
    [(quest_get_slot, reg8, "qst_kidnapped_girl", slot_quest_target_amount),
      (try_for_parties, ":cur_party"),
        (party_count_members_of_type, ":num_members", ":cur_party", "trp_kidnapped_girl"),
        (gt, ":num_members", 0),
        (party_remove_members, ":cur_party", "trp_kidnapped_girl", 1),
        (party_remove_prisoners, ":cur_party", "trp_kidnapped_girl", 1),
      (try_end),
      (call_script, "script_end_quest", "qst_kidnapped_girl"),
      (call_script, "script_change_troop_renown", "trp_player", -5),
  ]],
  [anyone|plyr, "lost_kidnapped_girl_4", [(store_troop_gold,":gold"),
      (quest_get_slot, ":quest_target_amount", "qst_kidnapped_girl", slot_quest_target_amount),
      (ge,":gold",":quest_target_amount"),
    ],
    "Of course. Here you are...", "merchant_quest_about_job_5a",[(quest_get_slot, ":quest_target_amount", "qst_kidnapped_girl", slot_quest_target_amount),
      (troop_remove_gold, "trp_player",":quest_target_amount"),
  ]],
  [anyone,"merchant_quest_about_job_5a", [],
    "At least you have the decency to return the money.", "close_window",[]],
  [anyone|plyr,"lost_kidnapped_girl_4", [],
    "Sorry. I don't have that amount with me.", "merchant_quest_about_job_5b",[]],
  [anyone,"merchant_quest_about_job_5b", [],
    "Do you expect me to believe that? You are going to pay that ransom fee back! Go and bring the money now!",
    "close_window",[(quest_get_slot, ":quest_target_amount", "qst_kidnapped_girl", slot_quest_target_amount),
      (val_add, "$debt_to_merchants_guild", ":quest_target_amount"),
  ]],
  
  
  #  Give us the money now. Quick.
  # Here, take the money. Just set the girl free.
  # Heh, It was a pleasure doing business with you.
  
  # You set the girl free first. You'll have the money afterwards.
  # Stop playing games.
  
  #persuade_lords_to_make_peace
  [anyone,"merchant_quest_requested", [(eq, "$random_merchant_quest_no", "qst_persuade_lords_to_make_peace"),
      (quest_get_slot, ":quest_target_faction", "qst_persuade_lords_to_make_peace", slot_quest_target_faction),
      (quest_get_slot, ":quest_object_troop", "qst_persuade_lords_to_make_peace", slot_quest_object_troop),
      (quest_get_slot, ":quest_target_troop", "qst_persuade_lords_to_make_peace", slot_quest_target_troop),
      (str_store_troop_name_link, s12, ":quest_object_troop"),
      (str_store_troop_name_link, s13, ":quest_target_troop"),
      (str_store_faction_name_link, s14, ":quest_target_faction"),
      (str_store_faction_name_link, s15, "$g_encountered_party_faction"),],
    "This war between {s15} and {s14} has brought our town to the verge of ruin. " +
    "Our caravans get raided before they can reach their destination. " +
    "Our merchants are afraid to leave the safety of the town walls. " +
    "And as if those aren't enough, the taxes to maintain the war take away the last bits of our savings. " +
    "If peace does not come soon, we can not hold on for much longer.", "merchant_quest_persuade_peace_1",
    []],
  
  [anyone|plyr,"merchant_quest_persuade_peace_1", [], "You are right. But who can stop this madness called war?", "merchant_quest_brief",[]],
  [anyone|plyr,"merchant_quest_persuade_peace_1", [], "It is your duty to help the nobles in their war effort. You shouldn't complain about it.", "merchant_quest_persuade_peace_reject",[]],
  
  [anyone,"merchant_quest_persuade_peace_reject", [], "Hah. The nobles fight their wars for their greed and their dreams of glory. " +
    "And it is poor honest folk like us who have to bear the real burden. " +
    "But you obviously don't want to hear about that.", "close_window",[]],
  
  [anyone,"merchant_quest_brief", [(eq,"$random_merchant_quest_no","qst_persuade_lords_to_make_peace")],
    "There have been attempts to reconcile the two sides and reach a settlement. " +
    "However, there are powerful lords on both sides whose interests lie in continuing the war. " +
    "These men urge all others not to heed to the word of sensible men, but to keep fighting. " +
    "While these leaders remain influential, no peace settlement can be reached.", "merchant_quest_persuade_peace_3",[]],
  
  [anyone|plyr,"merchant_quest_persuade_peace_3", [], "Who are these warmongers who block the way of peace?", "merchant_quest_persuade_peace_4",[]],
  [anyone|plyr,"merchant_quest_persuade_peace_3", [], "Who are these lords you speak of?", "merchant_quest_persuade_peace_4",[]],
  
  [anyone,"merchant_quest_persuade_peace_4", [], "They are {s12} from {s15} and {s13} from {s14}. Until they change their mind or lose their influence, " +
    "there will be no chance of having peace between the two sides.", "merchant_quest_persuade_peace_5",[
      (quest_get_slot, ":quest_target_faction", "qst_persuade_lords_to_make_peace", slot_quest_target_faction),
      (quest_get_slot, ":quest_object_troop", "qst_persuade_lords_to_make_peace", slot_quest_object_troop),
      (quest_get_slot, ":quest_target_troop", "qst_persuade_lords_to_make_peace", slot_quest_target_troop),
      (str_store_troop_name_link, s12, ":quest_object_troop"),
      (str_store_troop_name_link, s13, ":quest_target_troop"),
      (str_store_faction_name_link, s14, ":quest_target_faction"),
      (str_store_faction_name_link, s15, "$g_encountered_party_faction"),
  ]],
  
  [anyone|plyr,"merchant_quest_persuade_peace_5", [], "What can be done about this?", "merchant_quest_persuade_peace_6",[]],
  [anyone|plyr,"merchant_quest_persuade_peace_5", [], "Alas, it seems nothing can be done about it.", "merchant_quest_persuade_peace_6",[]],
  
  [anyone,"merchant_quest_persuade_peace_6", [], "There is a way to resolve the issue. " +
    "A particularly determined person can perhaps persuade one or both of these lords to accept making peace. " +
    "And even if that fails, it can be possible to see that these lords are defeated by force and taken prisoner. " +
    "If they are captive, they will lose their influence and they can no longer oppose a settlement... What do you think? Can you do it?",
    "merchant_quest_persuade_peace_7",[]],
  
  [anyone|plyr,"merchant_quest_persuade_peace_7", [], "It seems difficult. But I will try.", "merchant_quest_persuade_peace_8",[]],
  [anyone|plyr,"merchant_quest_persuade_peace_7", [], "If the price is right, I may.", "merchant_quest_persuade_peace_8",[]],
  [anyone|plyr,"merchant_quest_persuade_peace_7", [], "Forget it. This is not my problem.", "merchant_quest_persuade_peace_8",[]],
  
  [anyone,"merchant_quest_persuade_peace_8", [], "Most of the merchants in the town will gladly open up their purses to support such a plan. " +
    "I think we can collect {reg12} denars between ourselves. " +
    "We will be happy to reward you with that sum, if you can work this out. " +
    "Convince {s12} and {s13} to accept a peace settlement, " +
    "and if either of them proves too stubborn, make sure he falls captive and can not be ransomed until a peace deal is settled.",
    "merchant_quest_persuade_peace_9",[
      (quest_get_slot, ":quest_object_troop", "qst_persuade_lords_to_make_peace", slot_quest_object_troop),
      (quest_get_slot, ":quest_target_troop", "qst_persuade_lords_to_make_peace", slot_quest_target_troop),
      (str_store_troop_name_link, s12, ":quest_object_troop"),
      (str_store_troop_name_link, s13, ":quest_target_troop"),
      (quest_get_slot, ":quest_reward", "qst_persuade_lords_to_make_peace", slot_quest_gold_reward),
      (assign, reg12, ":quest_reward")]],
  
  [anyone|plyr,"merchant_quest_persuade_peace_9", [], "All right. I will do my best.", "merchant_quest_persuade_peace_10",[]],
  [anyone|plyr,"merchant_quest_persuade_peace_9", [], "Sorry. I can not do this.", "merchant_quest_persuade_peace_no",[]],
  
  [anyone,"merchant_quest_persuade_peace_10", [], "Excellent. You will have our blessings. " +
    "I hope you can deal with those two old goats. " +
    "We will be waiting and hoping for the good news.", "close_window",[
      (str_store_party_name_link, s4, "$g_encountered_party"),
      (quest_get_slot, ":quest_target_faction", "qst_persuade_lords_to_make_peace", slot_quest_target_faction),
      (quest_get_slot, ":quest_object_troop", "qst_persuade_lords_to_make_peace", slot_quest_object_troop),
      (quest_get_slot, ":quest_target_troop", "qst_persuade_lords_to_make_peace", slot_quest_target_troop),
      (quest_get_slot, ":quest_reward", "qst_persuade_lords_to_make_peace", slot_quest_gold_reward),
      (assign, reg12, ":quest_reward"),
      (str_store_troop_name_link, s12, ":quest_object_troop"),
      (str_store_troop_name_link, s13, ":quest_target_troop"),
      (str_store_faction_name_link, s14, ":quest_target_faction"),
      (str_store_faction_name_link, s15, "$g_encountered_party_faction"),
      (setup_quest_text,"qst_persuade_lords_to_make_peace"),
      (str_store_string, s2, "@Guildmaster of {s4} promised you {reg12} denars if you can make sure that " +
        "{s12} and {s13} no longer pose a threat to a peace settlement between {s15} and {s14}. " +
      "In order to do that, you must either convince them or make sure they fall captive and remain so until a peace agreement is made."),
      (call_script, "script_start_quest", "qst_persuade_lords_to_make_peace", "$g_talk_troop"),
      (quest_get_slot, ":quest_object_troop", "qst_persuade_lords_to_make_peace", slot_quest_object_troop),
      (quest_get_slot, ":quest_target_troop", "qst_persuade_lords_to_make_peace", slot_quest_target_troop),
      (call_script, "script_report_quest_troop_positions", "qst_persuade_lords_to_make_peace", ":quest_object_troop", 3),
      (call_script, "script_report_quest_troop_positions", "qst_persuade_lords_to_make_peace", ":quest_target_troop", 4),
  ]],
  
  [anyone,"merchant_quest_persuade_peace_no", [], "Don't say no right away. Think about this for some time. " +
    "If there is a {man/lady} who can manage to do this, it is you.",
    "close_window",[]],
  
  
  #deal with night bandits
  [anyone,"merchant_quest_requested",
    [
      (eq, "$random_merchant_quest_no", "qst_deal_with_night_bandits"),
    ],
    "Do I indeed! There's a group of bandits infesting the town, and I'm at the end of my rope as to how to deal with them. " +
    "They've been ambushing and robbing townspeople under the cover of night, " +
    "and then fading away quick as lightning when the guards finally show up. We've not been able to catch a one of them. " +
    "They only attack lone people, never daring to show themselves when there's a group about. " +
    "I need someone who can take on these bandits alone and win. That seems to be the only way of bringing them to justice. " +
    "Are you up to the task?", "merchant_quest_deal_with_night_bandits",
    []],
  
  [anyone,"merchant_quest_brief",
    [
      (eq,"$random_merchant_quest_no","qst_deal_with_night_bandits"),
    ],
    "There's a group of bandits infesting the town, and I'm at the end of my rope as to how to deal with them. " +
    "They've been ambushing and robbing townspeople under the cover of night, " +
    "and then fading away quick as lightning when the guards finally show up. We've not been able to catch a one of them. " +
    "They only attack lone people, never daring to show themselves when there's a group about. " +
    "I need someone who can take on these bandits alone and win. That seems to be the only way of bringing them to justice. " +
    "Are you up to the task?", "merchant_quest_deal_with_night_bandits",
    []],
  
  [anyone|plyr,"merchant_quest_deal_with_night_bandits", [],
    "Killing bandits? Why, certainly!",
    "deal_with_night_bandits_quest_taken",
    [
      (str_store_party_name_link, s14, "$g_encountered_party"),
      (setup_quest_text, "qst_deal_with_night_bandits"),
      (str_store_string, s2, "@The Guildmaster of {s14} has asked you to deal with a group of bandits terrorising the streets of {s14}. They only come out at night, and only attack lone travellers on the streets."),
      (call_script, "script_start_quest", "qst_deal_with_night_bandits", "$g_talk_troop"),
  ]],
  
  [anyone|plyr, "merchant_quest_deal_with_night_bandits", [],
    "My apologies, I'm not interested.", "merchant_quest_stall",[]],
  
  [anyone,"deal_with_night_bandits_quest_taken", [], "That takes a weight off my shoulders, {playername}. " +
    "You can expect a fine reward if you come back successful. Just don't get yourself killed, eh?", "mayor_pretalk",[]],
  
  
  #move cattle herd
  [anyone,"merchant_quest_requested", [(eq, "$random_merchant_quest_no", "qst_move_cattle_herd"),
      (quest_get_slot, ":target_center", "qst_move_cattle_herd", slot_quest_target_center),
      (str_store_party_name,s13,":target_center"),],
    "One of the merchants here is looking for herdsmen to take his cattle to the market at {s13}.", "merchant_quest_brief",
    []],
  
  [anyone,"merchant_quest_brief",
    [
      (eq,"$random_merchant_quest_no","qst_move_cattle_herd"),
      (quest_get_slot, reg8, "qst_move_cattle_herd", slot_quest_gold_reward),
      (quest_get_slot, ":target_center", "qst_move_cattle_herd", slot_quest_target_center),
      (str_store_party_name, s13, ":target_center"),
    ],
    "The cattle herd must be at {s13} within 30 days. Sooner is better, much better, " +
    "but it must be absolutely no later than 30 days. " +
    "If you can do that, I'd be willing to pay you {reg8} denars for your trouble. Interested?", "move_cattle_herd_quest_brief",
    []],
  
  [anyone|plyr,"move_cattle_herd_quest_brief", [],  "Aye, I can take the herd to {s13}.",
    "move_cattle_herd_quest_taken",
    [
      (call_script, "script_create_cattle_herd", "$g_encountered_party", 0),
      (quest_set_slot, "qst_move_cattle_herd", slot_quest_target_party, reg0),
      (str_store_party_name_link, s10,"$g_encountered_party"),
      (quest_get_slot, ":target_center", "qst_move_cattle_herd", slot_quest_target_center),
      (str_store_party_name_link, s13, ":target_center"),
      (quest_get_slot, reg8, "qst_move_cattle_herd", slot_quest_gold_reward),
      (setup_quest_text, "qst_move_cattle_herd"),
      (str_store_string, s2, "@Guildmaster of {s10} asked you to move a cattle herd to {s13}. You will earn {reg8} denars in return."),
      (call_script, "script_start_quest", "qst_move_cattle_herd", "$g_talk_troop"),
  ]],
  [anyone|plyr,"move_cattle_herd_quest_brief", [],
    "I am sorry, but no.", "merchant_quest_stall",[]],
  
  [anyone,"move_cattle_herd_quest_taken", [], "Splendid. You can find the herd right outside the town. " +
    "After you take the animals to {s13}, return back to me and I will give you your pay.", "mayor_pretalk",[]],
  
  
  #################################################
  #################### Random merchant quests end
  
  [anyone,"merchant_quest_requested", [], "I am afraid I can't offer you a job right now.", "mayor_pretalk",[]],
  
  
  #Village elders
  
  [anyone,"start", [(is_between,"$g_talk_troop",village_elders_begin,village_elders_end),
      (store_partner_quest,":elder_quest"),
      (eq,":elder_quest","qst_deliver_cattle"),
      (check_quest_succeeded, ":elder_quest"),
      (quest_get_slot, reg5, "qst_deliver_cattle", slot_quest_target_amount)],
    "My good {sir/madam}. Our village is grateful for your help. Thanks to the {reg5} heads of cattle you have brought, we can now raise our own herd.", "village_elder_deliver_cattle_thank",
    [(add_xp_as_reward, 400),
      #    (quest_get_slot, ":num_cattle", "qst_deliver_cattle", slot_quest_target_amount),
      #    (party_set_slot, "$current_town", slot_village_number_of_cattle, ":num_cattle"),
      (call_script, "script_change_center_prosperity", "$current_town", 4),
      (call_script, "script_change_player_relation_with_center", "$current_town", 5),
      (call_script, "script_end_quest", "qst_deliver_cattle"),
      #Troop commentaries begin
      (call_script, "script_add_log_entry", logent_helped_peasants, "trp_player",  "$current_town", -1, -1),
      #Troop commentaries end
      
  ]],
  
  [anyone,"village_elder_deliver_cattle_thank", [],
    "My good {lord/lady}, please, is there anything I can do for you?", "village_elder_talk",[]],
  
  
  ##  [anyone,"start",
  ##   [
  ##     (is_between, "$g_talk_troop", village_elders_begin, village_elders_end),
  ##     (store_partner_quest, ":elder_quest"),
  ##     (eq, ":elder_quest", "qst_train_peasants_against_bandits"),
  ##     (check_quest_succeeded, ":elder_quest"),
  ##     (quest_get_slot, reg5, "qst_train_peasants_against_bandits", slot_quest_target_amount)],
  ##   "Oh, thank you so much for training our men. Now we may stand a chance against those accursed bandits if they come again.", "village_elder_train_peasants_against_bandits_thank",
  ##   [
  ##     (add_xp_as_reward, 400),
  ##     (call_script, "script_change_player_relation_with_center", "$current_town", 5),
  ##     (call_script, "script_end_quest", "qst_train_peasants_against_bandits"),
  ##     (call_script, "script_add_log_entry", logent_helped_peasants, "trp_player",  "$current_town", -1, -1),
  ##    ]],
  
  #  [anyone,"village_elder_train_peasants_against_bandits_thank", [],
  #   "Now, good {sire/lady}, is there anything I can do for you?", "village_elder_talk",[]],
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_braconnier_2"),
    ],
    "Qu'est c'que tu veux ?", "brac_starts", [(play_sound, "snd_alt"),]],
  
  [anyone|plyr ,"brac_starts", [],  "Je ne fait que passer.", "close_window", []],
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_braconnier_3"),
    ],
    "Qui va la ?", "brac_startq", [(play_sound, "snd_alt"),]],
  
  [anyone|plyr ,"brac_startq", [],  "Ne faites pas attention a moi.", "close_window", []],
  
  
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_braconnier_1"),
    ],
    "Qui va la ?", "brac_start", [(play_sound, "snd_alt"),]],
  
  [anyone|plyr ,"brac_start", [],  "cessez de braconner Truandaille et retournez labourer vos champs.", "brac_start2", []],
  
  
  [anyone ,"brac_start2", [],"si on ne prend pas le gibier on mourera de faim, le seigneur ne nous laisse pas assez de victuailles et jamais de viande, toi tu n'aime pas la viande l'ami ? Attend, on peut peut etre s'aranger, tu regarde ailleurs et on te laisse la vie qu'est c'que t'en dit toi ?", "brac_start3",[]],
  
  
  [anyone|plyr ,"brac_start3", [],  "Je comprend...je dirais que je ne vous ai pas vu.", "close_window",
    [
      
      (call_script, "script_fail_quest", "qst_braconage"),
      (assign,"$braconniers_mort",1),
      
  ]],
  
  [anyone|plyr ,"brac_start3", [],  "Mensonges...le braconnage vous permet de vous payer a boire, sans compter que j'aime pas ta tete.", "brac_sfight", []],
  
  
  
  
  
  
  
  [anyone ,"brac_sfight", [],"Meurt !", "close_window",
    [
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 1, 0, -1),
      (mission_disable_talk),
  ]],
  
  
  
  
  
  #################### BRACONNIER WIN ######################## copier...
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_18_elder"),
      #ajouter  sa quete a son village>>>>>>>>>>>>>>>>>>>>> assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 12),
      (check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_failed, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
      
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finwin",[]],# finire avec village_elder_talk
  
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_70_elder"),
      #ajouter  sa quete a son village>>>>>>>>>>>>>>>>>>>>> assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 11),
      (check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_failed, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
      
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finwin",[]],# finire avec village_elder_talk
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_79_elder"),
      #ajouter  sa quete a son village>>>>>>>>>>>>>>>>>>>>> assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 10),
      (check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_failed, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
      
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finwin",[]],# finire avec village_elder_talk
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_78_elder"),
      #ajouter  sa quete a son village>>>>>>>>>>>>>>>>>>>>> assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 9),
      (check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_failed, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
      
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finwin",[]],# finire avec village_elder_talk
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_42_elder"),
      #ajouter  sa quete a son village>>>>>>>>>>>>>>>>>>>>> assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 8),
      (check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_failed, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
      
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finwin",[]],# finire avec village_elder_talk
  
  
  
  
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_27_elder"),
      #ajouter  sa quete a son village>>>>>>>>>>>>>>>>>>>>> assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 7),
      (check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_failed, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
      
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finwin",[]],# finire avec village_elder_talk
  
  
  
  
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_83_elder"),
      #ajouter  sa quete a son village>>>>>>>>>>>>>>>>>>>>> assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 6),
      (check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_failed, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
      
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finwin",[]],# finire avec village_elder_talk
  
  
  
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_59_elder"),
      #ajouter  sa quete a son village>>>>>>>>>>>>>>>>>>>>> assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 5),
      (check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_failed, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
      
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finwin",[]],# finire avec village_elder_talk
  
  
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_84_elder"),
      #ajouter  sa quete a son village>>>>>>>>>>>>>>>>>>>>> assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 4),
      (check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_failed, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
      
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finwin",[]],# finire avec village_elder_talk
  
  
  
  
  
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_56_elder"),
      #ajouter  sa quete a son village>>>>>>>>>>>>>>>>>>>>> assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 3),
      (check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_failed, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
      
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finwin",[]],# finire avec village_elder_talk
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_39_elder"),
      #ajouter  sa quete a son village>>>>>>>>>>>>>>>>>>>>> assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 2),
      (check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_failed, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
      
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finwin",[]],# finire avec village_elder_talk
  
  
  
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_26_elder"),
      #ajouter  sa quete a son village>>>>>>>>>>>>>>>>>>>>> assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 1),
      (check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_failed, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
      
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finwin",[]],# finire avec village_elder_talk
  
  
  
  
  
  [anyone|plyr,"bracon_village_finwin", [],"Il n'y as plus de braconnier dans votre foret pour le moment, vous pouvez dormire tranquile.", "bracon_village_finwin2",
    [
      #finre quete et relation -2
      (call_script, "script_end_quest", "qst_braconage"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 2),
      (call_script, "script_ptquest_flag_off"),
  ]],
  
  
  [anyone,"bracon_village_finwin2", [], "Des mots doux a mes oreilles, merci mille fois Mon seigneur, comme promis voila les victuailles fraiches, j'éspére que vous reviendrez bientot patrouiller la foret, ces marauds sont tenaces vous savez.", "village_elder_pretalk",
    [
      # script victuailles al?toires variable ratachement village a O !
      (call_script, "script_random_recompensse_braco"),
      (assign,"$village_ancien_braconnier",0),
  ]],
  
  
  
  
  
  
  
  
  #################### BRACONNIER FAILLED ######################## copier...
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_18_elder"),
      #ajouter  sa quete a son village >>>>>assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 12),
      (check_quest_failed, "qst_braconage"),
      (neg|check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finfail",[]],# finire avec village_elder_talk
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_70_elder"),
      #ajouter  sa quete a son village >>>>>assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 11),
      (check_quest_failed, "qst_braconage"),
      (neg|check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finfail",[]],# finire avec village_elder_talk
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_79_elder"),
      #ajouter  sa quete a son village >>>>>assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 10),
      (check_quest_failed, "qst_braconage"),
      (neg|check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finfail",[]],# finire avec village_elder_talk
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_78_elder"),
      #ajouter  sa quete a son village >>>>>assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 9),
      (check_quest_failed, "qst_braconage"),
      (neg|check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finfail",[]],# finire avec village_elder_talk
  
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_42_elder"),
      #ajouter  sa quete a son village >>>>>assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 8),
      (check_quest_failed, "qst_braconage"),
      (neg|check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finfail",[]],# finire avec village_elder_talk
  
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_27_elder"),
      #ajouter  sa quete a son village >>>>>assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 7),
      (check_quest_failed, "qst_braconage"),
      (neg|check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finfail",[]],# finire avec village_elder_talk
  
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_83_elder"),
      #ajouter  sa quete a son village >>>>>assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 6),
      (check_quest_failed, "qst_braconage"),
      (neg|check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finfail",[]],# finire avec village_elder_talk
  
  
  
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_59_elder"),
      #ajouter  sa quete a son village >>>>>assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 5),
      (check_quest_failed, "qst_braconage"),
      (neg|check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finfail",[]],# finire avec village_elder_talk
  
  
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_84_elder"),
      #ajouter  sa quete a son village >>>>>assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 4),
      (check_quest_failed, "qst_braconage"),
      (neg|check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finfail",[]],# finire avec village_elder_talk
  
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_56_elder"),
      #ajouter  sa quete a son village >>>>>assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 3),
      (check_quest_failed, "qst_braconage"),
      (neg|check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finfail",[]],# finire avec village_elder_talk
  
  
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_39_elder"),
      #ajouter  sa quete a son village >>>>>assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 2),
      (check_quest_failed, "qst_braconage"),
      (neg|check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finfail",[]],# finire avec village_elder_talk
  
  
  
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_village_26_elder"),
      #ajouter  sa quete a son village >>>>>assigner variable ratachante village a 0 a fin de dialogue !!!
      
      (eq, "$village_ancien_braconnier", 1),
      (check_quest_failed, "qst_braconage"),
      (neg|check_quest_succeeded, "qst_braconage"),
      (neg|check_quest_finished, "qst_braconage"),
      
    ],
    "Et bien Messire, des nouvelles des braconniers ?", "bracon_village_finfail",[]],# finire avec village_elder_talk
  
  
  
  
  
  [anyone|plyr,"bracon_village_finfail", [],"Je doit l'admetre je les ai sous éstimés, ces paysans étaient bien une trentaine, impossible de les combattre a moi tout seul.", "bracon_village_finfail2",
    [
      #finre quete et relation -2
      (call_script, "script_end_quest", "qst_braconage"),
      (call_script, "script_change_player_relation_with_center", "$current_town", -2),
      (call_script, "script_ptquest_flag_off"),
  ]],
  
  
  [anyone,"bracon_village_finfail2", [], "Vraiment ? mais...nostre village ne compte meme pas autant d'habitants, ils doivent venire d'ailleurs pour sur...c'est bien ca...", "village_elder_pretalk",
    [(assign,"$village_ancien_braconnier",0),]],
  
  
  
  
  
  
  
  
  
  
  
  
  
  #mette au desus : quete active "avez vous cherch?les braconniers ? et vers village_elder_talk et encore au dessus mission accomplie/et failed...
  [anyone,"start", [
      (this_or_next|eq, "$g_talk_troop", "trp_village_26_elder"),
      (this_or_next|eq, "$g_talk_troop", "trp_village_39_elder"),
      (this_or_next|eq, "$g_talk_troop", "trp_village_56_elder"),
      (this_or_next|eq, "$g_talk_troop", "trp_village_84_elder"),
      (this_or_next|eq, "$g_talk_troop", "trp_village_59_elder"),
      (this_or_next|eq, "$g_talk_troop", "trp_village_83_elder"),
      (this_or_next|eq, "$g_talk_troop", "trp_village_27_elder"),
      (this_or_next|eq, "$g_talk_troop", "trp_village_42_elder"),
      (this_or_next|eq, "$g_talk_troop", "trp_village_78_elder"),
      (this_or_next|eq, "$g_talk_troop", "trp_village_79_elder"),
      (this_or_next|eq, "$g_talk_troop", "trp_village_70_elder"),
      (eq, "$g_talk_troop", "trp_village_18_elder"),
      #si pas quete active et temps ?oul?avant la prochaine possibilit?de refaire 48 heures ou 72
      (neg|check_quest_active, "qst_braconage"),
      
      (store_current_hours,":cur_hours"),
      (val_sub, ":cur_hours", 48),
      (gt, ":cur_hours", "$gamble_last_time"),
      # (eq,"$g_talk_troop_met",0),
      (str_store_party_name, s9, "$current_town")],
    "Bienvenue a {s9} Messire. Pardonnez moi mais Puis je vous demander un service ?", "bracon_village_elder_talk",[]],# finire avec village_elder_talk
  
  
  [anyone|plyr,"bracon_village_elder_talk", [],"Certainement, qu'y as t'il ?", "bracon_village_elder_talksuite",[(store_current_hours,":cur_hours"),
      (assign, "$gamble_last_time", ":cur_hours"),]],# renouvlable quete dans 48 heures ou +
  [anyone|plyr,"bracon_village_elder_talk", [],"Je suis navré mais je n'ai point le temps.", "bracon_village_elder_talkfail",[]],
  
  
  
  
  [anyone,"bracon_village_elder_talkfail", [], "Bien, je n'aurais pas du demander...que voulliez vous Messire ?", "village_elder_talk",[]],
  
  [anyone,"bracon_village_elder_talksuite", [], "Je suis inquiet de la situation, la foret avoisinante appartenant a nostre seigneur est constament vidée de son gibier par des braconniers, comme vous le savez sans doute il est interdit a un cerf de chasser sur les terres de son seigneur, je ne sait pas exactement qui se livre a cette activité bien que j'en ai quelques idées, je sait surtout que je risque d'etre renvoyé par mon seigneur si je ne trouve pas un solutionement, quois qu'il en soit nous recrutons de gardes pour veiller sur la foret et son gibier, qu'en penssez vous Messire? oh...et naturelement vous seriez récompenssé, nous sommes autorisés a vous remetre des victuailles en échange de vostre garde. ", "village_elder_suite2",[]],
  
  
  [anyone|plyr,"village_elder_suite2", [],"Pour des victuailles ? c'est d'accord je protégerais vostre foret.", "village_elder_suitequestgo",
    [
      (call_script, "script_ptquest_flag_and_assign_s9"),
      (play_sound,"snd_start_quest"),
      (str_store_party_name, s9, "$current_town"),
      (str_store_string, s2, "@L'ancien du village de {s9} m'a demandé de patrouiller das la foret de {s9} pour en chasser les braconniers, la chasse étant interdite aux paysants."),
      (call_script, "script_start_quest", "qst_braconage", "$g_talk_troop"),
      
  ]],
  
  [anyone,"village_elder_suitequestgo", [], "C'est etendu, je vous remercie Messire, suivez simplement le sentier de la foret, que vous y trouviez des braconniers ou non vous aurez fait votre tour de garde, et donc bien mérité vostre récompensse.", "village_elder_pretalk",
    [
      (call_script, "script_assign_ancien_village_aquete"),
  ]],
  
  [anyone|plyr,"village_elder_suite2", [],"Je n'ai pas le temps de courire la foret vous m'en voyez navré.", "bracon_village_elder_talkfail",[]],
  
  
  
  
  [anyone,"start", [(is_between,"$g_talk_troop", village_elders_begin, village_elders_end),(eq,"$g_talk_troop_met",0),
      (str_store_party_name, s9, "$current_town")],
    "Good day, {sir/madam}, and welcome to {s9}. I am the elder of this village.", "village_elder_talk",[]],
  
  [anyone,"start", [(is_between,"$g_talk_troop", village_elders_begin, village_elders_end),(eq,"$g_talk_troop_met",0),
      (str_store_party_name, s9, "$current_town"),
      (party_slot_eq, "$current_town", slot_town_lord, "trp_player")],
    "Welcome to {s9}, my {lord/lady}. We were rejoiced by the news that you are the new {lord/lady} of our humble village. " +
    "I am the village elder and I will be honoured to serve you in any way I can.", "village_elder_talk",[]],
  
  [anyone ,"start", [(is_between,"$g_talk_troop",village_elders_begin,village_elders_end),
      (party_slot_eq, "$current_town", slot_town_lord, "trp_player")],
    "{My lord/My lady}, you honour our humble village with your presence.", "village_elder_talk",[]],
  
  [anyone ,"start", [(is_between,"$g_talk_troop",village_elders_begin,village_elders_end)],
    "Good day, {sir/madam}.", "village_elder_talk",[]],
  
  [anyone ,"village_elder_pretalk", [],
    "Is there anything else I can do for you?", "village_elder_talk",[]],
  
  
  
  
  
  
  
  #dial ancien village rennes chateau
  [anyone|plyr,"village_elder_talk", [(eq, "$g_talk_troop", "trp_village_80_elder"),
      #(eq, "$quete_templiers_encore_poss", 1),
      (check_quest_active, "qst_rennes_chateau"),
      (neg|check_quest_succeeded, "qst_rennes_chateau"),
      (neg|check_quest_failed, "qst_rennes_chateau"),
      (neg|check_quest_finished, "qst_rennes_chateau"),
    ],
    "Je m'intéresse a l'histoire de ce village, puis je vous poser quelques questions ?", "maconique_village_questions",
    [
  ]],
  
  
  [anyone ,"maconique_village_questions", [],"Vraiment ? bien si je peut vous aider...je suppose que c'est le chateau qui vous intéresse.", "maconique_village_questions3",
    [
  ]],
  
  
  
  
  [anyone|plyr ,"maconique_village_questions3", [],  "Parlez moi de l'histoire de ce chateau.", "maconique_village_chateau", []],
  [anyone|plyr ,"maconique_village_questions3", [],  "J'aimerais jetter un oeil au vieux chateaux, pouvez vous m'y faire entrer ?", "maconique_village_oeil", []],
  [anyone|plyr ,"maconique_village_questions3", [],  "Connaissez vous l'ancien seigneur de ce village ? ses armoiries sont un lion sur un trone tennant une hallbarde...", "maconique_village_hallbard", []],
  [anyone|plyr ,"maconique_village_questions3", [],  "Ca sera tout pour le moment.", "close_window", []],
  
  
  
  
  [anyone ,"maconique_village_hallbard", [],"Il ne peut s'agire que de Messire Godefroy de Villieux, il n'aura point eu de descendance etant mort en croisade vers l'année mille deux cent, le roi de lépoque confia alors les terres a de nouveaux seigneurs, je ne voie pas ce qu'il y as a en dire de plus.", "maconique_village_hallbardsuit",
    [
  ]],
  [anyone|plyr ,"maconique_village_hallbardsuit", [],  "Sauriez vous si on lui connaissait des amis ou ennemis, ce genre de choses ?", "maconique_village_hallbardsuit2", []],
  [anyone ,"maconique_village_hallbardsuit2", [],"Abssolument pas, puis je faire autre chose pour vous Messire ?", "maconique_village_questions3",
    [
  ]],
  
  
  
  [anyone ,"maconique_village_chateau", [],"Vous ne trouverez pas grand monde pour vous en parler de bon coeur Messire, on dit le chateau hanté par Godefroy en personne, les gens par ici sont simples et très superstitieux vous savez, moi je ne crois pas a ces histoires, mais tout va bien quand je ne doit pas m'en approcher si vous voyez ce que je veux dire. voullez vous austre chose ?", "maconique_village_questions3",
    [
  ]],
  
  
  
  
  
  
  
  
  [anyone ,"maconique_village_oeil", [],"Il est interdit de penetrer dériére le mur, mais si cela est vraiment important pour vous, je peut en faire la demande a mon seigneur pour qu'il vous en donne la permission...ou pas, je suis désolé.", "maconique_village_oeil2",
    [
  ]],
  
  [anyone|plyr ,"maconique_village_oeil2", [],  "Il doit bien y avoir un autre moyen, peut etre que si vous acceptiez de ramasser la boursse que je viens de faire tomber par par mégarde, vous pourriez garder son contenue et m'ouvrire la porte juste aprés.", "maconique_village_hallbardsuit3", []],
  
  
  [anyone ,"maconique_village_hallbardsuit3", [],"Et...que contiens cette boursse exactement ?", "maconique_village_hallbardsuit4",
    [
  ]],
  
  
  [anyone|plyr ,"maconique_village_hallbardsuit4",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 10),
      ],  "10 écus.", "maconique_village_cinq", []],
  [anyone|plyr ,"maconique_village_hallbardsuit4",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 50),
      ],  "50 écus.", "maconique_village_cinq", []],
  [anyone|plyr ,"maconique_village_hallbardsuit4",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 100),
      ],  "100 écus.", "maconique_village_cent", []],
  [anyone|plyr ,"maconique_village_hallbardsuit4", [],  "Je n'ai pas assez d'or.", "close_window", []],
  
  [anyone ,"maconique_village_cinq", [],"C'est une plaisanterie ? Je ne suis pas intéressé.", "close_window",
    [
  ]],
  
  [anyone ,"maconique_village_cent", [],"C'est d'accord, je vais vous ouvrire la porte discretement, vous etes seul responssable de ce qui vous arrivera de l'autre coté du mur, alors ne vennez pas vous plaidre si vous vous faites tuer...et bien je veux dire... .", "maconique_village_centok",
    [
  ]],
  
  
  [anyone|plyr ,"maconique_village_centok", [],  "Oui j'ai compris, ouvrez juste cette porte maintenant.", "maconique_village_centfin", [ (troop_remove_gold, "trp_player", 100),]],
  [anyone|plyr ,"maconique_village_centok", [],  "Bien, je reviendrais plus tard.", "close_window", []],
  
  [anyone ,"maconique_village_centfin", [],"Comme vous voudrez, je ne veux meme pas savoir ce que vous aurez vu la bas.", "close_window",
    [
      (call_script, "script_entre_rennes_chat"),
  ]],
  
  
  
  #steel edition dials
  #auberges
  
  #camelots
  
  [anyone,"start", [
      (this_or_next|eq, "$g_talk_troop", "trp_camelot_1"),
      (this_or_next|eq, "$g_talk_troop", "trp_camelot_2"),
      (this_or_next|eq, "$g_talk_troop", "trp_camelot_3"),
      (eq, "$g_talk_troop", "trp_camelot_4"),
    ],
    "Messire, approchez, venez jetter un oeil a mes marchandises.", "camelot_start", []],
  [anyone|plyr,"camelot_start", [], "Que vendez vous ?", "camelot_vente",[]],
  [anyone|plyr,"camelot_start", [], "Je ne suis pas interessé.", "close_window",[]],
  
  
  
  
  [anyone,"camelot_vente", [],"La question est, que n'ai je pas a vendre, voyez par vous meme quelque chose vous interessera forcement.", "camelot_vente_pretalk",[[change_screen_trade]]],
  
  
  [anyone,"camelot_vente_pretalk", [],"Ca sera tout Messire ?", "camelot_start",[]],
  
  
  #aubergiste trp_auberge_troop_9
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_troop_9"),
      
    ],
    "Bien le bonjour Messire, bienvenu dans mon auberge, c'est pour une chambre ou pour vous restaurer ?", "aubergiste_startc", [(play_sound, "snd_taverniers_h"),]],
  [anyone|plyr,"aubergiste_startc", [], "J'ai faim! qu'avez vous a vendre ?", "aubergiste_ventec",[]],
  [anyone|plyr,"aubergiste_startc", [], "Je cherche du travail, connaissez vous quelqu'un qui aurait besoin d'un homme d'arme  ?", "aubergiste_dials_quetesc",[]],
  
  #
  
  [anyone,"aubergiste_ventec", [],"Voila le manger, si vous n'en avez pas assez j'en ai autant au grenier.", "aubergiste_pretalkc",[[change_screen_trade]]],
  
  
  [anyone,"aubergiste_pretalkc", [],"Autre chose ?", "aubergiste_startc",[]],
  
  #
  [anyone,"aubergiste_dials_quetesc", [],"Non Messire, je ne voie personne pour le moment.", "aubergiste_startc",[]],
  
  
  
  
  [anyone|plyr,"aubergiste_startc", [], "Je doit partir...", "close_window",[]],
  
  
  
  #aubergiste trp_auberge_troop_10
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_troop_10"),
      
    ],
    "Bien le bonjour Messire, bienvenu dans mon auberge, c'est pour une chambre ou pour vous restaurer ?", "aubergiste_startb", [(play_sound, "snd_taverniers_h"),]],
  [anyone|plyr,"aubergiste_startb", [], "J'ai faim! qu'avez vous a vendre ?", "aubergiste_venteb",[]],
  [anyone|plyr,"aubergiste_startb", [], "Je cherche du travail, connaissez vous quelqu'un qui aurait besoin d'un homme d'arme  ?", "aubergiste_dials_quetesb",[]],
  
  #
  
  [anyone,"aubergiste_venteb", [],"Voila le manger, si vous n'en avez pas assez j'en ai autant au grenier.", "aubergiste_pretalkb",[[change_screen_trade]]],
  
  
  [anyone,"aubergiste_pretalkb", [],"Autre chose ?", "aubergiste_startb",[]],
  
  #
  [anyone,"aubergiste_dials_quetesb", [],"Non Messire, je ne voie personne pour le moment.", "aubergiste_startb",[]],
  
  
  
  
  [anyone|plyr,"aubergiste_startb", [], "Je doit partir...", "close_window",[]],
  
  
  #aubergiste trp_auberge_troop_11 quete termine
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_troop_11"),
      
      (check_quest_finished, "qst_pnj_perdu_foretaub"),
      
    ],
    "Bien le bonjour Messire, bienvenu dans mon auberge, c'est pour une chambre ou pour vous restaurer ?", "aubergiste_starta", [(play_sound, "snd_taverniers_h"),]],
  [anyone|plyr,"aubergiste_starta", [], "J'ai faim! qu'avez vous a vendre ?", "aubergiste_ventea",[]],
  [anyone|plyr,"aubergiste_starta", [], "Je cherche du travail, connaissez vous quelqu'un qui aurait besoin d'un homme d'arme ?", "aubergiste_dials_quetesa",[]],
  
  #
  
  [anyone,"aubergiste_ventea", [],"Voila le manger, si vous n'en avez pas assez j'en ai autant au grenier.", "aubergiste_pretalka",[[change_screen_trade]]],
  
  
  [anyone,"aubergiste_pretalka", [],"Autre chose ?", "aubergiste_starta",[]],
  
  #
  [anyone,"aubergiste_dials_quetesa", [],"Non Messire, je ne voie personne pour le moment.", "aubergiste_starta",[]],
  
  
  
  
  [anyone|plyr,"aubergiste_starta", [], "Je doit partir...", "close_window",[]],
  
  #win
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_troop_11"),
      
      (check_quest_active, "qst_pnj_perdu_foretaub"),
      (check_quest_succeeded, "qst_pnj_perdu_foretaub"),
      (neg|check_quest_failed, "qst_pnj_perdu_foretaub"),
      (neg|check_quest_finished, "qst_pnj_perdu_foretaub"),
      
    ],
    "Messire, dépéchez vous d'aller seccourir mon client, je craint le pire.", "aub_craint_pire",
    [
      (call_script, "script_end_quest", "qst_pnj_perdu_foretaub"),
  ]],
  
  [anyone|plyr,"aub_craint_pire", [
      ], "Votre client est saint et sauf, il passera peut etre quelques jours devans la cheminée de votre auberge, ce qui vous ramènera peut etre plus d'argent, et ce qui me fait me rappeller de cette grosse somme promise en récompensse.", "aub_craint_pire2",[]],
  
  [anyone,"aub_craint_pire2", [],"Par Saint Nicolas, vous l'avez trouvé ! la somme ? oh...oui, et bien voici après tout si vous n'aviez rien fait je serais dans de sales draps en ce moment.", "close_window",
    [
      (troop_add_gold, "trp_player", 400),
  ]],
  
  
  
  
  #en attente
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_troop_11"),
      
      (check_quest_active, "qst_pnj_perdu_foretaub"),
      (neg|check_quest_succeeded, "qst_pnj_perdu_foretaub"),
      (neg|check_quest_failed, "qst_pnj_perdu_foretaub"),
      (neg|check_quest_finished, "qst_pnj_perdu_foretaub"),
      
    ],
    "Messire, dépéchez vous d'aller seccourir mon client je vous prie.", "aub_attente_scclient", []],
  [anyone|plyr,"aub_attente_scclient", [], "Fort bien, je vais le sortir de ce mauvais pas.", "close_window",[]],
  
  #
  
  [anyone,"aubergiste_pbrob_okgo", [],"Un de mes client ivre est parti se promener dans la foret, et cet idiot risque sa vie avec le froid qu'il reigne la bas, vu que c'est un marchand connu sa mort risque de m'ettre attribuée et on fermera sans aucun doute mon auberge, si vous me le ramenez vivant il y aura une grosse some en écus pour vous, si vous etes d'accord surtout dépéchez vous !", "aubergiste_depech_vous",[]],
  
  
  ### lance quete foret glac?
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_troop_11"),
      
      
      
    ],
    "Messire, aurriez vous un instant ? il se passe une chose grave dans mon auberge, vou pouvez peut etre m'aider.", "aubergiste_startagrave", [(play_sound, "snd_taverniers_h"),]],
  [anyone|plyr,"aubergiste_startagrave", [], "Que se passe t-il ?", "aubergiste_pbrob_okgo",[]],
  [anyone|plyr,"aubergiste_startagrave", [], "J'ai bien assez de problèmes, trouvez quelqu'un d'autre.", "close_window",[]],
  
  #
  
  [anyone,"aubergiste_pbrob_okgo", [],"Un de mes client ivre est parti se promener dans la foret, et cet idiot risque sa vie avec le froid qu'il reigne la bas, vu que c'est un marchand connu sa mort risque de m'ettre attribuée et on fermera sans aucun doute mon auberge, si vous me le ramenez vivant il y aura une grosse some en écus pour vous, si vous etes d'accord surtout dépéchez vous !", "aubergiste_depech_vous",[]],
  
  
  
  
  [anyone|plyr,"aubergiste_depech_vous", [], "Très bien, je part a sa recherche.", "aubergiste_depech_ok",
    [
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Le patron de l'auberge proche de Rouen m'as demandé d'aller secourir un client important perdu dans la foret, il va mourrir de froid si je ne le retrouve pas rapidement, l'aubergiste m'as aussi parlé d'une belle somme en récompense."),
      (call_script, "script_start_quest", "qst_pnj_perdu_foretaub", "$g_talk_troop"),
      
  ]],
  [anyone|plyr,"aubergiste_depech_vous", [], "Je doit partir, je ne peut vous aider...", "close_window",[]],
  
  [anyone,"aubergiste_depech_ok", [],"Parfait, parfait mais surtout ne trainez point la bas ou vous risquerez d'etre gelé vous aussi et nous ne serions pas avancés.", "close_window",[]],
  
  
  #aubergiste trp_auberge_troop_12
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_troop_12"),
      (check_quest_succeeded, "qst_auberge_quete_1"),
      (check_quest_finished, "qst_auberge_quete_1"),
    ],
    "Le bonjour Messire, content de vous revoir dans mon auberge, c'est pour une chambre ou pour vous restaurer ?", "aubergiste_startaz", [(play_sound, "snd_taverniers_h"),]],
  [anyone|plyr,"aubergiste_startaz", [], "J'ai faim! qu'avez vous a vendre ?", "aubergiste_venteaz",[]],
  [anyone|plyr,"aubergiste_startaz", [], "Je cherche du travail, connaissez vous quelqu'un qui aurait besoin d'un homme d'arme  ?", "aubergiste_dials_quetesaz",[]],
  
  #
  
  [anyone,"aubergiste_venteaz", [],"Voila les victuailles.", "aubergiste_pretalkaz",[[change_screen_trade]]],
  
  
  [anyone,"aubergiste_pretalkaz", [],"Autre chose ?", "aubergiste_startaz",[]],
  
  #
  [anyone,"aubergiste_dials_quetesaz", [],"Non Messire, je ne voie personne pour le moment.", "aubergiste_startaz",[]],
  
  
  
  
  [anyone|plyr,"aubergiste_startaz", [], "Je doit partir...", "close_window",[]],
  
  
  #si sa quete accomplie
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_troop_12"),
      (check_quest_succeeded, "qst_auberge_quete_1"),
      (neg|check_quest_failed, "qst_auberge_quete_1"),
      (neg|check_quest_finished, "qst_auberge_quete_1"),
      
    ],
    "Alors ? savez vous se qu'il se passe au manoir ?", "aubergiste_start3z", [(play_sound, "snd_taverniers_h"),]],
  
  
  
  [anyone|plyr,"aubergiste_start3z", [], "Un couple de chevreuils était prisonniers entre les murs, j'ai voulu les attrapper mais ils ont fuit, en tout cas vous n'aurrez plus de bruit la nuit.", "aubergiste_win",[]],
  [anyone,"aubergiste_win", [],"Exelente nouvelle, ces maudites betes auraient pu finir par se reproduire et je n'ose imaginer le boucan qu'elles auraient fait, voila les vivres comme promis, autre chose ?", "aubergiste_start3",
    [
      (call_script, "script_end_quest", "qst_auberge_quete_1"),
      (troop_add_item, "trp_player", "itm_bread", 0),
      (troop_add_item, "trp_player", "itm_sausc", 0),
      (troop_add_item, "trp_player", "itm_pate1", 0),
  ]],
  
  
  
  
  [anyone|plyr,"aubergiste_start3", [], "J'ai faim! qu'avez vous a vendre ?", "aubergiste_vente3",[]],
  [anyone|plyr,"aubergiste_start3", [], "Je cherche du travail, connaissez vous quelqu'un qui aurait besoin d'un homme d'arme  ?", "aubergiste_dials_quetes3",[]],
  
  #
  
  [anyone,"aubergiste_vente3", [],"Voila le manger, si vous n'en avez pas assez j'en ai autant au grenier.", "aubergiste_pretalk3",[[change_screen_trade]]],
  
  
  [anyone,"aubergiste_pretalk3", [],"Autre chose ?", "aubergiste_start3",[]],
  
  #
  
  
  [anyone,"aubergiste_dials_quetes3", [],"Non Messire, je ne voie personne pour le moment.", "aubergiste_start3",[]],
  
  
  
  
  [anyone|plyr,"aubergiste_start3", [], "Je doit partir...", "close_window",[]],
  
  
  
  
  
  
  
  
  
  #si sa quete active, attente
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_troop_12"),
      (check_quest_active, "qst_auberge_quete_1"),
      (neg|check_quest_succeeded, "qst_auberge_quete_1"),
      (neg|check_quest_failed, "qst_auberge_quete_1"),
      (neg|check_quest_finished, "qst_auberge_quete_1"),
    ],
    "Alors ? savez vous se qu'il se passe au manoir ?", "aubergiste_repons_start", [(play_sound, "snd_taverniers_h"),]],
  [anyone|plyr,"aubergiste_repons_start", [], "J'y travaille.", "aubergiste_vente_top",[]],
  [anyone,"aubergiste_vente_top", [],"Fort bien, voila qui fait plaisir a ettendre, que puis je pour vous en attendant ?", "aubergiste_start2",[]],
  
  [anyone|plyr,"aubergiste_start2", [], "J'ai faim! qu'avez vous a vendre ?", "aubergiste_vente2",[]],
  
  #
  
  [anyone,"aubergiste_vente2", [],"Voila le manger, si vous n'en avez pas assez j'en ai autant au grenier.", "aubergiste_pretalk2",[[change_screen_trade]]],
  
  
  [anyone,"aubergiste_pretalk2", [],"Autre chose ?", "aubergiste_start2",[]],
  
  #
  
  
  
  [anyone|plyr,"aubergiste_start2", [], "Je doit partir...", "close_window",[]],
  
  
  #####
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_troop_12"),
      (neg|check_quest_active, "qst_auberge_quete_1"),
      (neg|check_quest_succeeded, "qst_auberge_quete_1"),
      (neg|check_quest_failed, "qst_auberge_quete_1"),
      (neg|check_quest_finished, "qst_auberge_quete_1"),
    ],
    "Bien le bonjour Messire, bienvenu dans mon auberge, c'est pour une chambre ou pour vous restaurer ?", "aubergiste_starto", [(play_sound, "snd_taverniers_h"),]],
  [anyone|plyr,"aubergiste_starto", [], "J'ai faim! qu'avez vous a vendre ?", "aubergiste_venteo",[]],
  [anyone|plyr,"aubergiste_starto", [ (neg|check_quest_finished, "qst_auberge_quete_1"),], "Je cherche du travail, connaissez vous quelqu'un qui aurait besoin d'un homme d'arme  ?", "aubergiste_dials_queteso",[]],
  
  #
  
  [anyone,"aubergiste_venteo", [],"Voila le manger, si vous n'en avez pas assez j'en ai autant au grenier.", "aubergiste_pretalko",[[change_screen_trade]]],
  
  
  [anyone,"aubergiste_pretalko", [],"Autre chose ?", "aubergiste_starto",[]],
  
  #
  
  
  [anyone,"aubergiste_dials_queteso",
    [
      
    ],
    "Oui j'ai quelque chose pour vous, des bruits étranges viennent du manoir au dessus de la riviere, si vous allez voir ce qu'il se passe la bas je vous donnerai quelques vivres qu'en penssez vous ? j'ai peur que ces bruits fassent fuir les malheureux clients qu'il me reste.", "aubergiste_start_quete_manoiro",[]],
  
  
  
  
  
  #quete manoir strat
  [anyone|plyr,"aubergiste_start_quete_manoiro", [], "Des vivres pour simplement entrer dans une vielle baraque ? c'est d'accord.", "aubergiste_start_quete_manoir_oko",[]],
  [anyone|plyr,"aubergiste_start_quete_manoiro", [], "Je ne suis pas interessé, trouvez quelqu'un d'autre.", "aubergiste_starto",[]],
  
  
  
  
  
  #
  [anyone,"aubergiste_start_quete_manoir_oko", [], "Très bien, tennez prennez la clef et revennez me dire ce que vous avez vu la bas, bien sur pas un bruit aux clients, je compte sur vous.", "close_window",
    [
      (troop_add_item, "trp_player", "itm_cle_auberge_maison", 0),
      
  ]],
  [anyone|plyr,"aubergiste_starto", [], "Je doit partir...", "close_window",[]],
  
  
  #gardes auberges
  
  
  
  [anyone,"start", [
      (this_or_next|eq, "$g_talk_troop", "trp_auberge_troop_2"),
      (this_or_next|eq, "$g_talk_troop", "trp_auberge_troop_4"),
      (this_or_next|eq, "$g_talk_troop", "trp_auberge_troop_6"),
      (eq, "$g_talk_troop", "trp_auberge_troop_8"),
    ],
    "Le bonjour Messire, n'ayez craintes je garde l'entrée, veillez a ne pas faire d'histoires je vous ai a l'oeil.", "aubergiste_gardien", []],
  [anyone|plyr,"aubergiste_gardien", [], "Pensez vous que si j'avais envie de boire et de renversser les bancs vous m'en empecheriez ?", "close_window",[]],
  [anyone|plyr,"aubergiste_gardien", [], "Point d'inquietudes mon brave.", "close_window",[]],
  
  
  [anyone,"start", [
      (this_or_next|eq, "$g_talk_troop", "trp_auberge_troop_1"),
      (this_or_next|eq, "$g_talk_troop", "trp_auberge_troop_3"),
      (this_or_next|eq, "$g_talk_troop", "trp_auberge_troop_5"),
      (eq, "$g_talk_troop", "trp_auberge_troop_7"),
    ],
    "Bienvenu au relai Messire, avez vous besoin de chevaux frais ? vous pouvez aussi vous restaurer et dormir un peut a l'auberge elle est propre et sure vous savez.", "vendeur_cheuv_start", [(play_sound, "snd_taverniers_h"),]],
  [anyone|plyr,"vendeur_cheuv_start", [], "J'ai besoin d'un cheval.", "vendeur_cheuv_vente",[]],
  
  [anyone,"vendeur_cheuv_vente", [],"Vous ne serez pas décu Messire, ils viennent d'etre ferés et ils ont bu et mangé.", "vendeur_cheuv_pretalk",[[change_screen_trade]]],
  
  
  [anyone,"vendeur_cheuv_pretalk", [],"Voila Messire, au plaisir.", "vendeur_cheuv_start",[]],
  
  
  
  [anyone|plyr,"vendeur_cheuv_start", [], "Je doit reprendre la route...", "close_window",[]],
  
  
  
  
  ##refugies quete manoir auberge
  
  #femme
  
  #
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_manoir_troop_2"),
      (eq, "$refugie_donne_plans", 1),
    ],
    "Vous etes notre ange gardien, que la grace du seigneur soit sur vous.", "refugie_femme_off", []],
  [anyone|plyr,"refugie_femme_off",
    [
      
    ],
    "C'est naturel chere dame.", "close_window",
    [
      
  ]],
  #avant de donner bouffe a son mari
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_manoir_troop_2"),
    ],
    "Nous vivons l'enfer sur terre messire, ayez pitié.", "refugie_femme_on", []],
  [anyone|plyr,"refugie_femme_on",
    [
      
    ],
    "N'ayez craintes ma Dame.", "close_window",
    [
      
  ]],
  
  
  #
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_manoir_troop_1"),
      (eq, "$refugie_donne_plans", 1),
    ],
    "Encore merci a notre sauveur.", "refugie_off", []],
  [anyone|plyr,"refugie_off",
    [
      
    ],
    "Faites attention a vous deux.", "close_window",
    [
      
  ]],
  
  
  
  
  
  
  #si bouffe, leur donner
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_manoir_troop_1"),
      (check_quest_succeeded, "qst_auberge_quete_1"),
    ],
    "Vous revoila, comment vous remercier.", "refugie_in", []],
  [anyone|plyr,"refugie_in",
    [
      (player_has_item, "itm_bread"),
      (player_has_item, "itm_sausc"),
      (player_has_item, "itm_pate1"),
    ],
    "Voila quelques victuailles pour tenir un moment.", "refugie_dont",
    [
      (troop_remove_item, "trp_player","itm_bread"),
      (troop_remove_item, "trp_player","itm_sausc"),
      (troop_remove_item, "trp_player","itm_pate1"),
  ]],
  
  [anyone|plyr,"refugie_in", [], "Ca n'est rien, prennez soin de vous.", "close_window",[]],
  
  [anyone,"refugie_dont", [],"Vous etes notre sauveur Messire, que faire pour vous en retour...je suis artisant en temps de paix, tennez prennez ces plans je n'en ai pas utilité pour le moment, peut etre qu'ils vous seront utiles.", "close_window",
    [
      (assign, "$refugie_donne_plans", 1),
      (troop_add_item, "trp_player", "itm_plan_8", 0),
      (troop_add_item, "trp_player", "itm_plan_1", 0),
      (troop_add_item, "trp_player", "itm_plan_12", 0),
  ]],
  
  #
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_manoir_troop_1"),
      (eq, "$refugies_manoir_paris", 1),
    ],
    "Nous allons partir, n'est ce pas ce que vous voullez ?", "refugie_out", []],
  [anyone|plyr,"refugie_out", [], "Vous devez partir, il n'y as rien de personnel.", "close_window",[]],
  
  #
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_manoir_troop_1"),
      (neg|check_quest_succeeded, "qst_auberge_quete_1"),
      #   (neg|check_quest_failed, "qst_auberge_quete_1"),
      (neg|check_quest_finished, "qst_auberge_quete_1"),
    ],
    "Qui etes vous ? que voullez vous ?", "refugie_manoir", []],
  [anyone|plyr,"refugie_manoir", [], "Et vous que faites vous ici ? l'aubergiste m'envoie pour enqueter sur des bruits, buits dont vous etes la cause sans aucun doute.", "refugie_manoir2",[]],
  
  #
  
  [anyone,"refugie_manoir2", [],"Nous avons fuit les massacres dans notre village, nous avons marché sans nous arreter, nous sommes épuisés et nous ne savons pas ou aller ma femme et moi, j'implore votre pitié Messire.", "refugie_manoir3",[]],
  
  [anyone|plyr,"refugie_manoir3", [], "Je comprend, restez ici mais soyez discrets ou l'aubergiste envera des mercenaires qui ne poserons pas de questions et mettront le feu au manoir avec vos cadavres.", "refugie_manoirbon",[]],
  [anyone|plyr,"refugie_manoir3", [], "Vous ne pouvez pas rester, si je reviens demain et que vous etes encore la vous assisterez a un nouveau massacre.", "refugie_manoirmauvais",[(assign, "$refugies_manoir_paris", 1),]],
  
  [anyone,"refugie_manoirmauvais", [],"Bien...comme vous voudrez, nous partons sur le champ.", "close_window",
    [
      (call_script, "script_succeed_quest", "qst_auberge_quete_1"),
  ]],
  
  
  [anyone,"refugie_manoirbon", [],"Seigneur, merci...Merci Messire, nous ne ferons aucun bruit rassurez vous.", "refugie_manoirbonsuit",
    [
      (call_script, "script_succeed_quest", "qst_auberge_quete_1"),
  ]],
  [anyone|plyr,"refugie_manoirbonsuit", [], "Comment arrivez vous a survivre ici ?", "manoir_survie",[]],
  [anyone|plyr,"refugie_manoirbonsuit", [], "Bien, je compte sur vous.", "close_window",[]],
  
  [anyone,"manoir_survie", [],"Nous nous cachons le jour et nous sortons la nuit pour nous nourire des ordures de l'auberge, et parfois j'arrive a pecher un poisson que nous devons manger cru, nous ne savons pas ou aller nous sommes perdus et sans le sous.", "refugie_manoirbonsuit2",
    [
      
  ]],
  [anyone|plyr,"refugie_manoirbonsuit2", [], "Vous devriez aller en ville et trouver un travail, il vous faudra juste éviter les brigands, bonne chance.", "close_window",[]],
  
  
  
  
  #mercenaires auberges
  #hobelars
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_client_1"),
      (eq, "$hobelars_enbauche", 1),
      
    ],
    "Quels sont les ordres capitaine ?", "hobelar_ready",
    [
  ]],
  
  
  [anyone|plyr,"hobelar_ready", [], "Préparez-vous, nous partirons ?l'aube.", "close_window",[]],
  
  
  #######
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_client_1"),
      
      ##################
      (try_begin),
        (eq, "$premier_dial_hobelars", 0),
        (call_script, "script_nombre_hobelars"),
      (try_end),
      
      
      
      
      #####################
      
      
      
      
    ],
    "Avez-vous besoin de mercenaires messire ? {reg3} de mes compagnons et moi, sommes a la recherche d'un maitre. Nous nous joindrons ?vous pour {reg5} écus.", "hobelar_start_start",
    [
      (assign, "$premier_dial_hobelars", 1),
  ]],
  
  
  [anyone|plyr,"hobelar_start_start", [], "Pouvez vous me parler de votre spécialité dans une armée ?", "hobelar_start_spec",[]],
  [anyone,"hobelar_start_spec", [],"Nous sommes les Hobelars, des cavaliers légers sur des montures rapides, nous prennons vos ennemis a revers et nous pourchassons les fuyards pour en faire des prisonniers.", "hobelar_start_start",[]],
  
  
  
  [anyone|plyr,"hobelar_start_start",
    [
      #si j'ai la somme et place equipe
      
      (party_get_free_companions_capacity, ":free_capacity", "p_main_party"),
      (ge,":free_capacity",reg3),
      
      (store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", reg5),
      
      
      
    ],
    "C'est parfait, je vous recrute tous, voici {reg5} écus.", "hobelar_recrut",
    [
      (troop_remove_gold,"trp_player",reg5),
      (party_add_members, "p_main_party", "trp_auberge_client_1", reg3),
      (assign, "$hobelars_enbauche", 1),
  ]],
  [anyone|plyr,"hobelar_start_start", [], "Actuellement, je ne peux pas me permettre de recruter des hommes supplémentaires.", "close_window",[]],
  
  [anyone,"hobelar_recrut", [],"Quels sont vos ordres capitaine ?", "hobelar_recrut2",[]],
  
  
  
  
  
  [anyone|plyr,"hobelar_recrut2", [], "Préparez-vous, nous partirons ?l'aube.", "close_window",
    [
      #assigner 24 heures condition de presence troupe
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_4", ":cur_hours"),
  ]],
  
  
  
  #hacheurs
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_client_2"),
      (eq, "$hacheur_enbauche", 1),
      
    ],
    "Quels sont vos ordres capitaine ?", "hacheur_ready",
    [
  ]],
  
  
  [anyone|plyr,"hacheur_ready", [], "Préparez-vous, nous partirons ?l'aube.", "close_window",[]],
  ########
  
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_client_2"),
      
      ##################
      
      (try_begin),
        (eq, "$premier_dial_hacheur", 0),
        (call_script, "script_nombre_acheurs"),
      (try_end),
      
      
      
      #####################
      
      
      
      
    ],
    "Avez-vous besoin de mercenaires messire ? {reg4} de mes compagnons et moi, sommes a la recherche d'un maitre. Nous nous joindrons ?vous pour {reg6} écus.", "hacheur_start_start",
    [
      (assign, "$premier_dial_hacheur", 1),
  ]],
  
  
  [anyone|plyr,"hacheur_start_start", [], "Pouvez vous me parler de votre spécialité dans une armée ?", "hacheur_start_start_spec",[]],
  [anyone,"hacheur_start_start_spec", [],"Nous sommes des Hacheurs, nous brisons aisément les boucliers et juste en suite les os qui se protégaient derièrre, on nous appelle aussi les bouchers.", "hacheur_start_start",[]],
  
  
  
  [anyone|plyr,"hacheur_start_start",
    [
      #si j'ai la somme et place equipe
      
      (party_get_free_companions_capacity, ":free_capacity", "p_main_party"),
      (ge,":free_capacity",reg4),
      
      (store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", reg6),
      
      
      
    ],
    "C'est parfait, je vous recrute tous, voici vos {reg6} écus.", "hacheur_recrut",
    [
      (assign, "$hacheur_enbauche", 1),
      (troop_remove_gold,"trp_player",reg6),
      (party_add_members, "p_main_party", "trp_auberge_client_2", reg4),
  ]],
  [anyone|plyr,"hacheur_start_start", [], "Actuellement, je ne peux pas me permettre de recruter des hommes supplémentaires.", "close_window",[]],
  
  [anyone,"hacheur_recrut", [],"Quels sont vos ordres capitaine ?", "hacheur_recrut2",[]],
  
  
  
  
  
  [anyone|plyr,"hacheur_recrut2", [], "Préparez-vous, nous partirons ?l'aube.", "close_window",
    [
      #assigner 24 heures condition de presence troupe
      (store_current_hours,":cur_hours"),
      (assign, "$temp_attente_5", ":cur_hours"),
  ]],
  
  
  
  #messager auberge
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_client_3"),
    ],
    "Enfin un peut de repos pas vrai ? je suis messager et je passe mes journées a galoper comme un damné, que diriez vous de faire une petite partie ?", "aubergmessager_start", []],
  [anyone|plyr,"aubergmessager_start", [], "Pourquois pas.", "aubergmessager_start_game",[]],
  [anyone|plyr,"aubergmessager_start", [], "Pas le temps pour ca.", "close_window",[]],
  
  [anyone,"aubergmessager_start_game", [],"C'est parti alors, a quois jouons nous ?", "generique_des",[]],
  
  
  #
  
  #jouteur auberge
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_client_5"),
    ],
    "Le bonjour, estes vous de la  région ?", "jouteur_aub_start", []],
  [anyone|plyr,"jouteur_aub_start", [], "Je pourais dire cela si je restait une fois dans ma vie au meme endroit plus de trois jours, et vous ?", "jouteur_aub_start2",[]],
  [anyone|plyr,"jouteur_aub_start", [], "Pas du tout, adieu.", "close_window",[]],
  
  [anyone,"jouteur_aub_start2", [],"Je suis du sud mais je cours les tournois a travers la France c'est ainsi que je gagne ma vie.", "jouteur_aub_start3",[]],
  
  [anyone|plyr,"jouteur_aub_start3", [], "Ah oui ? il m'arrive moi meme de jouter, auriez vous des conseils ?", "jouteur_aub_start4",[]],
  [anyone|plyr,"jouteur_aub_start3", [], "Vraiment ? et bien bonne chance.", "close_window",[]],
  
  [anyone,"jouteur_aub_start4", [],"Et bien...d'accord a condition que vous me payez un verre.", "jouteur_aub_start5",[]],
  
  [anyone|plyr,"jouteur_aub_start5",
    [
      (store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", 5),
    ],
    "Naturelement, que pouvez vus m'apprendre ?", "jouteur_aub_startpay",[(troop_remove_gold,"trp_player",5),]],
  [anyone|plyr,"jouteur_aub_start5", [], "Dans ce cas une autre fois, j'ai peur d'etre fauché comme les blés.", "close_window",[]],
  
  
  [anyone,"jouteur_aub_startpay", [],"Très bien, tout d'abord tout est une question de distance et de timing, vous devez anticiper le coup, vous saurez a force d'entrainement a quel moment précis vous devrez tendre la lance et a quel endroit viser un peut trop a gauche ou tendre la lance un peut trop tot et la victoire vous échappe, il ne faut bien sur pas directement viser l'armure du concurrent mais un peut plus a gauche, et bien sur attention a ne pas accrocher la tete du cheval ou parlera longtemps de vous et de votre maladresse.", "jouteur_aub_end",[]],
  [anyone|plyr,"jouteur_aub_end", [], "Très intéressant, nous croiserons peut etre la lance a l'avenir qui sait, mes remerciements.", "close_window",[]],
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_client_6"),
    ],
    "Je vous offe un verre étranger, après trois saisons catastrophiques et la maladie de mes betes nous avons enfin des récoltes dignes de ce nom.", "payjoy_start", []],
  [anyone|plyr,"payjoy_start", [], "A quois était du vos mauvaises récoltes ?", "payjoy_start2",[]],
  [anyone|plyr,"payjoy_start", [], "C'est très bien pour vous, au revoir.", "close_window",[]],
  
  [anyone,"payjoy_start2", [],"Le temps, la peste a emportée plusieurs de mes ouvriers, la guerre a cause de qui des champs entiers ont été brulé, et le fléau de Dieu naturelement...", "close_window",[]],
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_client_8"),
    ],
    "Salutation etranger, allez vous bien ?", "med_auberge", []],
  [anyone|plyr,"med_auberge", [], "Pourquois cette question ?", "med_auberge2",[]],
  [anyone|plyr,"med_auberge", [], "Parfaitement comme toujours, adieu.", "close_window",[]],
  
  [anyone,"med_auberge2", [],"Je suis medecin et je voie que vous estes couvert de bléssures dont certaines ne sont pas cicatrisées, si vous le voullez je peut m'en occupper mais il faudra me payer bien sur.", "med_auberge3",[]],
  
  
  
  [anyone|plyr ,"med_auberge3", [(eq, "$blesse_a_tete", 1),],  "Je suis bléssure a la tête, faites quelque chose je vous en prie.", "med_auberge_tete", []],
  [anyone|plyr ,"med_auberge3", [(eq, "$blesse_au_bras", 1),],  "J'ai une bléssure au bras, pouvez vous faire quelque chose ?", "med_auberge_bras", []],
  [anyone|plyr ,"med_auberge3", [(eq, "$blesse_a_jambe", 1),],  "J'ai une bléssure a la jambe, pouvez vous faire quelque chose ?", "med_auberge_jambe", []],
  
  
  
  
  
  #tete##############################
  [anyone ,"med_auberge_tete", [],"Seigneur! comment faites vous pour etre encore vivant ? il faut refermer cette horible bléssure avant qu'elle ne s'infecte, cela vous coutera 200 écus je vous prie.", "med_auberge_tete2", []],
  [anyone|plyr ,"med_auberge_tete2",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 200),
    ],  "Tres bien, voici l'argent, faites vite, la doulleure es inssuportable.", "med_auberge_tete3",
    [
      (troop_remove_gold,"trp_player",200),
  ]],
  [anyone|plyr ,"med_auberge_tete2", [],  "Je n'ai pas la somme que vous demandez.", "med_auberge3s", []],
  [anyone ,"med_auberge3s", [],"Je suis navré, mais je ne puis rien faire dans ce cas, il faut bien que je paye ces médicaments.", "med_auberge3", []],
  
  [anyone ,"med_auberge_tete3", [],"Bien, faites attention la prochaine fois, vous allez finire par trépasser.", "med_auberge3",
    [
      #redoner stat et remetre variable a 0
      (call_script, "script_rest_bless_tete"),
  ]],
  #tete fin !
  
  #bras
  [anyone ,"med_auberge_bras", [],"En effet, votre bras es en piteux état, avez vous 100 écus pour payer les soins.", "med_auberge_bras2", []],
  [anyone|plyr ,"med_auberge_bras2",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 100),
    ],  "Tres bien, voici l'argent, faites vite, je peut a peine bouger le bras.", "med_auberge_bras3",
    [
      (troop_remove_gold,"trp_player",100),
  ]],
  [anyone|plyr ,"med_auberge_bras2", [],  "Je n'ai pas la somme que vous demandez.", "med_auberge_bras2s", []],
  [anyone ,"med_auberge_bras2s", [],"Je suis navré, mais je ne puis rien faire dans ce cas.", "med_auberge3", []],
  
  [anyone ,"med_auberge_bras3", [],"Bien, faites attention la prochaine fois, ce bras va finire par tomber ?", "med_auberge3",
    [
      #redoner stat et remetre variable a 0
      (call_script, "script_rest_bless_bras"),
  ]],
  #bras fin !
  
  
  #jambe
  [anyone ,"med_auberge_jambe", [],"Ca n'es point grave, cependant il faut netoyer la bléssure et changer le bandage régulièrement, les onguents et les bandages vous couterons 50 écus je vous prie.", "med_auberge_jambe2", []],
  [anyone|plyr ,"med_auberge_jambe2",
    [
      (store_troop_gold,":player_gold", "trp_player"),
      (ge, ":player_gold", 50),
    ],  "Tres bien, voici l'argent, faites vite, je tiens a peine debout.", "med_auberge_jambe3",
    [
      (troop_remove_gold,"trp_player",50),
  ]],
  [anyone|plyr ,"med_auberge_jambe2", [],  "Je n'ai pas la somme que vous demandez.", "med_auberge_jambe2s", []],
  [anyone ,"med_auberge_jambe2s", [],"Je suis navré, mais je ne puis rien faire dans ce cas.", "med_auberge3", []],
  
  [anyone ,"med_auberge_jambe3", [],"Je vous recomande d'etre plus prudent, personne ne voudrais d'un capitaine qui ne peut simplement marcher.", "med_auberge3",
    [
      #redoner stat et remetre variable a 0
      (call_script, "script_rest_bless_jambe"),
  ]],
  #jambe fin !################
  
  
  
  [anyone|plyr,"med_auberge3", [], "Ca ira pour le moment, merci.", "med_auberge_no",[]],
  
  [anyone,"med_auberge_no", [],"Comme vous voudrez, mais n'oubliez pas de vous faire soigner si vous estes blessé.", "close_window",[]],
  
  
  # quete cheval termin? <<<
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_client_7"),
      (neg|check_quest_active, "qst_cheval_perdu"),
      (check_quest_finished, "qst_cheval_perdu"),
    ],
    "Maudit cheval...steak ambulant!", "hivrey_fini_cheval", []],
  [anyone|plyr,"hivrey_fini_cheval", [], "Content de vous revoir également.", "close_window",[]],
  
  
  
  # quete cheval termin? = l'enlever
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_client_7"),
      (check_quest_active, "qst_cheval_perdu"),
      (check_quest_succeeded, "qst_cheval_perdu"),
      (neg|check_quest_finished, "qst_cheval_perdu"),
    ],
    "Maudit cheval...", "hivrey_quete_cheval_end", []],
  [anyone|plyr,"hivrey_quete_cheval_end", [], "Toujours a pied je voie, et la bouteille pour compagnon.", "hivrey_quete_cheval_end2",[]],
  [anyone|plyr,"hivrey_quete_cheval_end",
    [
      (store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", 5),
      
    ],
    "J'ai retrouvé votre cheval et je l'ai gardé, je vous paye un verre pour le dédomagement.", "hivrey_quete_cheval_end3",
    [
      (troop_remove_gold,"trp_player",5),
      
      (call_script, "script_end_quest", "qst_cheval_perdu"),
      (party_set_flags, "p_prairie_bourges", pf_always_visible, 0),
      (party_set_flags, "p_prairie_bourges", pf_disabled, 1),
  ]],
  
  [anyone,"hivrey_quete_cheval_end2", [],"Oui, ma chope ne risque pas de s'enfuire elle au moins.", "close_window",
    [
      (call_script, "script_end_quest", "qst_cheval_perdu"),
      (party_set_flags, "p_prairie_bourges", pf_always_visible, 0),
      (party_set_flags, "p_prairie_bourges", pf_disabled, 1),
      
      
  ]],
  [anyone,"hivrey_quete_cheval_end3", [],"Quois?! Ca n'est pas du tout son prix. mais d'un autre coté, comment refuser une chope.", "close_window",[]],
  
  
  
  # quete cheval en attente
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_client_7"),
      (check_quest_active, "qst_cheval_perdu"),
      (neg|check_quest_succeeded, "qst_cheval_perdu"),
      (neg|check_quest_finished, "qst_cheval_perdu"),
    ],
    "Maudit cheval...steak ambulant!", "hivrey_attente_cheval", []],
  [anyone|plyr,"hivrey_attente_cheval", [], "Content de vous revoir moi aussi.", "close_window",[]],
  
  
  
  #chercher cheval
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_client_7"),
    ],
    "Ne m'approche pas maudit cheval...oh, vous allez rire, j'ai achetté un cheval hier et il refuse d'avancer alors j'ai du faire la route a pied et ce cheval aurait du finir dans mon assiette si j'avais réussis l'attraper.", "hivrey_start", []],
  [anyone|plyr,"hivrey_start", [], "Et ou est t-il maintenant ?", "hivrey_start2",[]],
  [anyone|plyr,"hivrey_start", [], "Buvez tant que vous voudrez, ca ne vous amènera pas un nouveau cheval.", "close_window",[]],
  
  [anyone,"hivrey_start2", [],"Qui ca ?", "hivrey_start3",[]],
  
  [anyone|plyr,"hivrey_start3", [], "Le...cheval.", "hivrey_start4",[]],
  [anyone,"hivrey_start4", [],"Maudit cheval, je l'ai laissé dans les prés autour de Bourges, quand je pense que je l'avais payé une fortune...", "close_window",
    [
      (play_sound,"snd_start_quest"),
      (str_store_string, s2, "@Un ivrogne dans une auberge m'as dit avoir perdu son cheval dans les prés de Bourges, peut etre que la monture de valeure n'as pas voulu d'un tel cavalier, le cheval est peut etre encore la bas, je devrais aller voir."),
      (call_script, "script_start_quest", "qst_cheval_perdu", "$g_talk_troop"),
      (party_set_flags, "p_prairie_bourges", pf_disabled, 0),
      (party_set_flags, "p_prairie_bourges", pf_always_visible, 1),
      (party_set_flags, "p_prairie_bourges", pf_quest_party, 1),
  ]],
  
  
  
  
  
  
  
  
  
  #auberge musicien
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_auberge_barde"),
      
    ],
    "Messire, appreciez vous ma musique ?", "aub_musi_start", []],
  [anyone|plyr,"aub_musi_start",
    [
      (store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", 1),
    ],
    "En effet, voila pour vous, 1 écu. ", "aub_musi_end",
    [
      (troop_remove_gold,"trp_player",1),
  ]],
  [anyone|plyr,"aub_musi_start", [], "Certes.", "close_window",[]],
  
  [anyone|plyr,"aub_musi_start", [], "Comment voullez vous qu'on prenne une cuite dans un tel vacarme, fichez le camp.", "close_window",[]],
  
  [anyone,"aub_musi_end", [],"Je vous remercie.", "close_window",[]],
  
  
  
  
  #################
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_cvalier_invisible_quete_prairie_barder"),
    ],
    " ", "chev_camap_barder",
    [
      (play_sound,"snd_henissement"),
  ]],
  [anyone|plyr,"chev_camap_barder", [], "Cette bache est parfaite, j'éspère qu'elle n'est pas trop lourde tu semble fatigué, les muscles vont venir vite ne t'inquiéte pas.", "close_window",[]],
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_cvalier_invisible_quete_prairie"),
      (check_quest_succeeded, "qst_cheval_perdu"),
      
    ],
    " ", "chev_camap",
    [
      (play_sound,"snd_henissement"),
  ]],
  [anyone|plyr,"chev_camap", [], "Tout doux mon ami. Je devrais aller voir un vendeur de chevaux pour achetter une armure pour ce cheval.", "close_window",[]],
  
  
  
  
  
  [anyone,"start", [
      (eq, "$g_talk_troop", "trp_cvalier_invisible_quete_prairie"),
      (neg|check_quest_succeeded, "qst_cheval_perdu"),
      
    ],
    " ", "chev_quete",
    [
      (play_sound,"snd_henissement"),
  ]],
  [anyone|plyr,"chev_quete", [], "Tout doux mon ami. Je devrais aller voir un vendeur de chevaux pour achetter une armure pour ce cheval.", "close_window",
    [
      (call_script, "script_succeed_quest", "qst_cheval_perdu"),
      (troop_add_item, "trp_player", "itm_cheval_praire", 0),
  ]],
  
  #tvarn pack end
  
  #dial avec le cheval
  ##
  ####
  #   [anyone|plyr,"start",
  #    [
  #        (is_between,"$g_talk_troop","trp_cvalier_invisible_quete_prairie_barder","trp_cvalier_invisible_quete_prairie_barder_end"),
  #######   (eq, "$entre_camp", 1),
  #        ],
  #    "Cette bache est parfaite, j'éspère qu'elle n'est pas trop lourde tu semble fatigué, les muscles vont venir vite ne t'inquiéte pas.","close_window",
  #    [
  
  #        ]],
  
  
  
  
  #
  #   [anyone|plyr,"start",
  #   [
  #
  #          (is_between,"$g_talk_troop","trp_cvalier_invisible_quete_prairie","trp_cvalier_invisible_quete_prairie_end"),
  # (check_quest_succeeded, "qst_cheval_perdu"),
  #        ],
  #    "Tout doux mon ami. Je devrais aller voir un vendeur de chevaux pour achetter une armure pour ce cheval.","close_window",
  #    [
  
  #       ]],
  
  
  
  
  #   [anyone|plyr,"start",
  #    [
  #         (is_between,"$g_talk_troop","trp_cvalier_invisible_quete_prairie","trp_cvalier_invisible_quete_prairie_end"),
  # (neg|check_quest_succeeded, "qst_cheval_perdu"),
  #       ],
  #    "Cesse de manger cette herbe pourrie tu mérite mieux, tu viens avec moi.","close_window",
  #    [
  #  (call_script, "script_succeed_quest", "qst_cheval_perdu"),
  # (troop_add_item, "trp_player", "itm_cheval_praire", 0),
  
  #        ]],
  #
  
  
  ################# auberges FIN #################
  
  
  ###########DIALS VOLONTAIRES DE BROCELIAND DANS LES CAMPS mettre leurs autres dials en dessous
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_volontaire_grotte1"),
      (eq, "$entre_camp", 1),
    ],
    "{playername}, j'aimerais que vous sachiez que j'aspire a rentrer dans mon village de la foret de Lorges vivant, je vous suivrais jusqu'au bout mais...vos batailles risquent de ne pas etre les miennes.", "volont_camps_dial", []],
  
  [anyone|plyr ,"volont_camps_dial", [],  "Soit, vous retournerez bientot chez vous.", "volont_camps_dial2", []],###
  [anyone|plyr ,"volont_camps_dial", [],  "J'ai encore besoin de vous mon ami.", "close_window", []],###
  
  [anyone ,"volont_camps_dial2", [],"Merci de tout coeur messire.", "close_window", []],###
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_volontaire_grotte2"),
      (eq, "$entre_camp", 1),
    ],
    "Oui ? allez vous me demander de frotter votre armure ? dans ce cas la réponse est non merci.", "volont_camps_dialautre", []],
  
  [anyone|plyr ,"volont_camps_dialautre", [],  "C'est une exelente idée, j'y repenserais plus tard.", "close_window", []],###
  [anyone|plyr ,"volont_camps_dialautre", [],  "Absolument pas, si vous vous detendiez, qu'en pensez vous ?", "close_window", []],###
  
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_volontaire_grotte3"),
      (eq, "$entre_camp", 1),
    ],
    "{playername}, je pense rester avec vous un moment, j'ai compris qu'il y avais des écus a se faire en votre compagnie, et en remplissant ma part du marché, j'attendrais ma part des butins comme il se doit.", "volont_camps_nouv", []],
  
  [anyone|plyr ,"volont_camps_nouv", [],  "Je suis navré, mais vous devrez vous contenter de la solde comme les autres soldats.", "volont_camps_nouv2", []],###
  [anyone|plyr ,"volont_camps_nouv", [],  "Vous prendriez vous pour un homme d'armes par hasard ?", "close_window", []],###
  
  [anyone ,"volont_camps_nouv2", [],"Et bien...je prendrai ce qu'il me faut sur les cadavres que vous semez dans votre sillon dans ce cas, avec votre permission...ou pas.", "close_window", []],###
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_volontaire_grotte4"),
      (eq, "$entre_camp", 1),
    ],
    "{playername}, vous savez, etre constament sur les routes ce n'est pas vraiment ce que j'avais prévu de faire pour ma retraite.", "volont_camps_dialnne", []],
  
  [anyone|plyr ,"volont_camps_dialnne", [],  "Vous etes libre de partir dans ce cas.", "volont_camps_dialnne2", []],###
  [anyone|plyr ,"volont_camps_dialnne", [],  "J'ai encore besoin de vous mon ami.", "close_window", []],###
  
  [anyone ,"volont_camps_dialnne2", [],"Malgrés tout je vais rester, un soldat doit perir sur le champ de bataille, et a vrai dire ce qu'il me manque surtout c'est la boisson entre camarades les soirs de combats, la on se sent vraiment vivant.", "close_window", []],###
  
  
  
  
  
  
  
  ###########DIALS VOLONTAIRES DE BROCELIAND dans foret
  
  ###############################################       ######################################################
  #volontaire villageois quete finie rechercher des volontaires : ouvre sur dials complexs d'aventure, equipement, stats, ect...mercin...
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_volontaire_grotte1"),
      (eq, "$villageois_aubmine_rejoin", 1),#VARIABLE DONNEE A L'EMBAUCHE pour plus que les volontaires spawn et pour donner les dials complex d'aventure
      #            (neg|check_quest_active, "qst_volntaires_mine"),
      # (check_quest_succeeded, "qst_volntaires_mine"),
      # (check_quest_finished, "qst_volntaires_mine"),
    ],
    "Messire, que faisons nous a présent ?", "pays_aubermaventire", []],
  
  [anyone|plyr ,"pays_aubermaventire", [],  "Voyons votre équipement en détail.", "pays_aubermaventire_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"pays_aubermaventire", [],  "Nous devrions parler de ce que vous pourriez faire en combat.", "pays_aubermaventire_skill", []],###
  
  [anyone|plyr ,"pays_aubermaventire", [],  "Je m'en occupe ne vous inquitez pas.", "close_window", []],###
  
  
  [anyone ,"pays_aubermaventire_skill", [],"En combat ? et bien...piquer l'ennemi avec une pointe et fuir, voila a peut pret tout ce dont je suis capable.", "pays_aubermaventire_retour", [(change_screen_view_character)]],###
  [anyone ,"pays_aubermaventire_retour", [],"Autre chose ?", "pays_aubermaventire", []],###
  
  
  
  #volontaire villageois quete active rechercher des volontaires
  [anyone,"start", [(eq, "$g_talk_troop", "trp_volontaire_grotte1"),
      # (eq, "$no_spawn_garde_ent_auberge_mine", 1),
      ###quete active rechercher des volontaires
      (check_quest_active, "qst_volntaires_mine"),
      (neg|check_quest_succeeded, "qst_volntaires_mine"),
      (neg|check_quest_failed, "qst_volntaires_mine"),
      (neg|check_quest_finished, "qst_volntaires_mine"),
    ],
    "Messire, nous vous somme reconnaissants pour ce que vous avez fait.", "quete_volpays_aubermine", []],
  
  [anyone|plyr ,"quete_volpays_aubermine", [],  "J'ai besoin de volontaires pour en finir avec ces fripouilles, nous allons descendre dans la mine, joignez vous a nous et finissons en.", "quete_volpays_aubermine2", []],###
  [anyone|plyr ,"quete_volpays_aubermine", [],  "Ca n'était rien.", "close_window", []],###
  
  [anyone ,"quete_volpays_aubermine2", [],"Mon frere est resté en bas avec ces brutes, pas besoin d'en dire plus je vous suit.", "close_window",
    [
      (assign, "$villageois_aubmine_rejoin", 1),
      (party_add_members, "p_main_party", "trp_volontaire_grotte1", 1),
  ]],###
  
  
  
  #volontaire villageois premiere phrase
  [anyone,"start", [(eq, "$g_talk_troop", "trp_volontaire_grotte1"),
      # (eq, "$no_spawn_garde_ent_auberge_mine", 0),
    ],
    "Messire, qui qu vous soyez vennez en notre aide par pitié.", "pays_aubermine", []],
  
  [anyone|plyr ,"pays_aubermine", [],  "Je m'en occupe ne vous inquitez pas.", "close_window", []],###
  
  
  
  
  
  
  
  #volontaire Brandon aventure dials
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_volontaire_grotte2"),
      (eq, "$Brandon_aubmine_rejoin", 1),#VARIABLE DONNEE A L'EMBAUCHE pour plus que les volontaires spawn et pour donner les dials complex d'aventure
      #            (neg|check_quest_active, "qst_volntaires_mine"),
      # (check_quest_succeeded, "qst_volntaires_mine"),
      # (check_quest_finished, "qst_volntaires_mine"),
    ],
    "Surveillez bien vos arrières surtout.", "brandon_recruit_aventure", []],
  
  [anyone|plyr ,"brandon_recruit_aventure", [],  "Dites vous cela pour vous ? Dois je vous surveiller ?", "brandon_recruit_aventuresuspic", []],###
  [anyone ,"brandon_recruit_aventuresuspic", [],"Non, je dit ca pour vous, j'ai remarqué que vous laissez une ouverture béante lors de vos parades, un cheval pourais y entrer vous chier sur les bottes et repartir se coucher dans son pré sans rien avoir a craindre.", "brandon_recruit_aventure", []],###
  
  [anyone|plyr ,"brandon_recruit_aventure", [],  "Montrez moi votre équipement.", "brandon_recruit_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"brandon_recruit_aventure", [],  "Nous devrions parler de vos tactiques de combat.", "brandon_recruit__skill", []],###
  
  [anyone|plyr ,"brandon_recruit_aventure", [],  "En route.", "brandon_recruit_end", []],###
  [anyone ,"brandon_recruit_end", [],"Après vous.", "close_window", []],###
  
  
  [anyone ,"brandon_recruit__skill", [],"Besoin d'apprendre auprés d'un vrais combatant ?", "brandon_recruit_retour", [(change_screen_view_character)]],###
  [anyone ,"brandon_recruit_retour", [],"Avez vous fini de fouller dans mes affaires ? Tant mieux...", "brandon_recruit_aventure", []],###
  
  
  
  #volontaire Brandon quete active rechercher des volontaires
  [anyone,"start", [(eq, "$g_talk_troop", "trp_volontaire_grotte2"),
      # (eq, "$no_spawn_garde_ent_auberge_mine", 1),
      ###quete active rechercher des volontaires
      (check_quest_active, "qst_volntaires_mine"),
      (neg|check_quest_succeeded, "qst_volntaires_mine"),
      (neg|check_quest_failed, "qst_volntaires_mine"),
      (neg|check_quest_finished, "qst_volntaires_mine"),
    ],
    "Qui etes vous ? et que faites vous chez moi ? partez sur le champ.", "brandon_recruit_quetmine", []],
  
  [anyone|plyr ,"brandon_recruit_quetmine", [],  "J'ai besoin de volontaires pour combattre les troupes de ce De Penthièvre, Allez vous vous joindre a nous ?", "brandon_recruit_quetmine2", []],###
  [anyone|plyr ,"brandon_recruit_quetmine", [],  "Bien je m'en vais, mes excuses.", "close_window", []],###
  
  
  [anyone ,"brandon_recruit_quetmine2", [],"Vous n'etes donc pas des leurs comme je le croyais...et bien, c'est d'accord je vous suit, a condition que nous soyons assez nombreux pour les vaincre.", "brandon_recruit_quetmine3",[]],###
  [anyone|plyr ,"brandon_recruit_quetmine3", [],  "Etes vous un guerrier ?", "brandon_recruit_quetmine4", []],###
  [anyone ,"brandon_recruit_quetmine4", [],"C'est le moins que l'on puisse dire, je suis mercenaire, je fut envoyé en mission dans cette foret par le Duc en personne, mais n'ayant plus d'argent ni de moyen de terminer ma mission j'ai donc aretté de tourner en rond et j'ai fini par accepter un pot de vin de ces soudars pour ne plus fourer mon nez dans leurs affaires. mais je suis revenu voir si la situation avais changée ici et si je pouvais poursuivre ce contrat.", "brandon_recruit_quetmine5",[]],###
  [anyone|plyr ,"brandon_recruit_quetmine5", [],  "Mettons nous d'accord, je toucherai la plus grosse part de la prime du Duc.", "brandon_recruit_quetmine6", []],###
  [anyone ,"brandon_recruit_quetmine6", [],"Bien entendu...si vous vivez jusque la, dans le cas contraire je n'aurais qu'a me présenter seul face au Duc.", "brandon_recruit_quetmine7",[]],###
  [anyone|plyr ,"brandon_recruit_quetmine7", [],  "Et bien vu la facon dont se déroule les événements, que la part unique revienne au survivant, en route.", "close_window",
    [
      (assign, "$Brandon_aubmine_rejoin", 1),
      (party_add_members, "p_main_party", "trp_volontaire_grotte2", 1),
  ]],###
  
  
  
  
  
  
  #volontaire Brandon premiere phrase
  [anyone,"start", [(eq, "$g_talk_troop", "trp_volontaire_grotte2"),
      # (eq, "$no_spawn_garde_ent_auberge_mine", 0),
    ],
    "Qui etes vous ? et que faites vous chez moi ? partez sur le champ.", "brandon_prem_maison", []],
  
  [anyone|plyr ,"brandon_prem_maison", [],  "Bien je m'en vais, mes excuses.", "close_window", []],###
  
  
  
  
  #dial coupe gorge fix
  [anyone,"start", [(eq, "$g_talk_troop", "trp_volontaire_grotte3"),
      (eq, "$dial_cope_gorgefix", 1),
      
    ],
    "C'est d'accord, passe devans.", "fix_dialcg", []],
  
  [anyone|plyr ,"fix_dialcg", [],  "Bien, en route.", "close_window", [(assign, "$dial_cope_gorgefix", 0),]],###
  
  
  #volontaire coupe gorge aventure dials
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_volontaire_grotte3"),
      (eq, "$coupe_gorge_aubmine_rejoin", 1),#VARIABLE DONNEE A L'EMBAUCHE pour plus que les volontaires spawn et pour donner les dials complex d'aventure
      #            (neg|check_quest_active, "qst_volntaires_mine"),
      # (check_quest_succeeded, "qst_volntaires_mine"),
      # (check_quest_finished, "qst_volntaires_mine"),
    ],
    "T'as entendu ce bruit ?", "coupe_gorge_recruit_aventure", []],
  
  [anyone|plyr ,"coupe_gorge_recruit_aventure", [],  "Mais quel bruit ?", "coupe_gorge_recruit_aventurenop", []],###
  [anyone ,"coupe_gorge_recruit_aventurenop", [],"Ce que j'en sait...un geux qui arme une arbalète, un chevreuil...", "coupe_gorge_recruit_aventure", []],###
  
  [anyone|plyr ,"coupe_gorge_recruit_aventure", [],  "Fait moi voir ton équipement.", "coupe_gorge_recruit_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"coupe_gorge_recruit_aventure", [],  "Nous devrions parler de tactiques de combat.", "coupe_gorge_recruit_skill", []],###
  
  [anyone|plyr ,"coupe_gorge_recruit_aventure", [],  "Allons y.", "close_window", []],###
  
  
  
  [anyone ,"coupe_gorge_recruit_skill", [],"Et ben quois ? je suis archer, d'habitude je me contente d'intimider le gars que je dépouille et de temps en temps je tire une fléche sur un garde, je suis pas vraiment un bretteur si c'est ce que t'as cru.", "coupe_gorge_recruit_retour", [(change_screen_view_character)]],###
  [anyone ,"coupe_gorge_recruit_retour", [],"On bouge.", "coupe_gorge_recruit_aventure", []],###
  
  
  
  #volontaire Coupe gorge quete active rechercher des volontaires
  [anyone,"start", [(eq, "$g_talk_troop", "trp_volontaire_grotte3"),
      # (eq, "$no_spawn_garde_ent_auberge_mine", 1),
      ###quete active rechercher des volontaires
      #                     (check_quest_active, "qst_volntaires_mine"),
      #  (neg|check_quest_succeeded, "qst_volntaires_mine"),
      #  (neg|check_quest_failed, "qst_volntaires_mine"),
      # (neg|check_quest_finished, "qst_volntaires_mine"),
    ],
    "Plus un geste ou je te transperce de mes fléches, lache ton or et ton équipement et va t'en.", "cgorge_premdial_prem_maison", []],
  
  [anyone|plyr ,"cgorge_premdial_prem_maison", [],  "Un instant, etes vous avec De Penthièvre ?", "cgorge_premdial_prem_maison2", []],###
  [anyone ,"cgorge_premdial_prem_maison2", [],"Qu'est c'que ca change ? tu donne ce que t'as sur toi c'est tout, et si tu veux le savoir je suis avec moi meme et on va transpercer ta langue si tu te dépeche pas.", "cgorge_premdial_prem_maison3",[]],###
  
  [anyone|plyr ,"cgorge_premdial_prem_maison3", [],  "Tire si tu veux, mais qui t'aidera a te débarasser des troupes en armures qui empéchent les voyageurs de passer par ici ? tu m'aide a les faire partir et en suite je te donnerais de l'or qu'en pense tu ?", "cgorge_premdial_prem_maison4", []],###
  
  [anyone ,"cgorge_premdial_prem_maison4", [],"Tu vise juste l'ami, il se trouve que moi et les manteaux de fer on est pas très amis, mais si tu m'attire dans un piége et que j'en ressort vivant je ne te laisserais plus l'occasion d'ouvrir la bouche.", "cgorge_premdial_prem_maison5",[]],###
  [anyone|plyr ,"cgorge_premdial_prem_maison5", [],  "Il n'y as pas de piége, juste une proposition, ces troupes n'ont rien a faire ici et meme si tout nous oppose nous somme dans le meme bateau.", "cgorge_premdial_prem_maison6", []],###
  
  
  [anyone ,"cgorge_premdial_prem_maison6", [],"Hum...faut voire.", "close_window",
    [
      (assign, "$dial_cope_gorgefix", 1),
      (assign, "$coupe_gorge_aubmine_rejoin", 1),
      (party_add_members, "p_main_party", "trp_volontaire_grotte3", 1),
  ]],###
  
  
  
  
  #volontaire Artus aventure dials
  [anyone,"start", [(eq, "$g_talk_troop", "trp_volontaire_grotte4"),
      (eq, "$artus_fix_dial", 1),
      
    ],
    "Attention, les voila.", "fixartus_recruit_quetmine", []],
  
  [anyone|plyr ,"fixartus_recruit_quetmine", [],  "Savez vous ce que vous faites !?", "close_window", [(assign, "$artus_fix_dial", 0),]],###
  
  
  #############
  
  [anyone ,"artus_recruit_quetmine2", [],"Une expedition dites vous, avez vous au moins une chance de faire partir les manteaux de fer ? ou voullez vous simplement m'envoyer a la mort sans raison ?", "artus_recruit_quetmine3",[]],###
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_volontaire_grotte4"),
      (eq, "$artus_aubmine_rejoin", 1),#VARIABLE DONNEE A L'EMBAUCHE pour plus que les volontaires spawn et pour donner les dials complex d'aventure
      #            (neg|check_quest_active, "qst_volntaires_mine"),
      # (check_quest_succeeded, "qst_volntaires_mine"),
      # (check_quest_finished, "qst_volntaires_mine"),
    ],
    "Allez vous bien Messire ? je suis medecin ne l'oubliez point.", "artus_recruit_aventure", []],
  
  [anyone|plyr ,"artus_recruit_aventure", [],  "Arettez cette émoragie je vous prie.", "artus_recruit_emo", []],###
  [anyone ,"artus_recruit_emo", [],"Rien de bien méchant, je n'ai jamais vu un soldat ne pas supporter la vu du sang, vous irez bientot mieux.", "artus_recruit_aventure", [(call_script, "script_soins"), ]],###
  
  [anyone|plyr ,"artus_recruit_aventure", [],  "Montrez moi votre équipement.", "artus_recruit_aventure_retour", [(change_screen_equip_other),]],###
  [anyone|plyr ,"artus_recruit_aventure", [],  "Nous devrions parler de vos tactiques de combat.", "artus_recruit_aventure_skill", []],###
  
  [anyone|plyr ,"artus_recruit_aventure", [],  "Continuons.", "close_window", []],###
  
  
  [anyone ,"artus_recruit_aventure_skill", [],"De combat ? les seuls combats que j'ai mennés sont ceux armés d'un scie a emputation que j'ai livré contre des patiens inconscients vous savez...", "artus_recruit_aventure_retour", [(change_screen_view_character)]],###
  [anyone ,"artus_recruit_aventure_retour", [],"Avez vous fini ?", "artus_recruit_aventure", []],###
  
  
  
  #volontaire Artus quete active rechercher des volontaires
  [anyone,"start", [(eq, "$g_talk_troop", "trp_volontaire_grotte4"),
      # (eq, "$no_spawn_garde_ent_auberge_mine", 1),
      ###quete active rechercher des volontaires
      (check_quest_active, "qst_volntaires_mine"),
      (neg|check_quest_succeeded, "qst_volntaires_mine"),
      (neg|check_quest_failed, "qst_volntaires_mine"),
      (neg|check_quest_finished, "qst_volntaires_mine"),
    ],
    "Que faites vous ici Messire ?", "artus_recruit_quetmine", []],
  
  [anyone|plyr ,"artus_recruit_quetmine", [],  "J'ai besoin de volontaires pour combattre les troupes de ce De Penthièvre, qui que vous soyez, allez vous vous joindre a une expedition dans les mines ?", "artus_recruit_quetmine2", []],###
  #  [anyone|plyr ,"artus_recruit_quetmine", [],  "Je ne voullais pas vous déranger Messire.", "close_window", []],###
  
  
  [anyone ,"artus_recruit_quetmine2", [],"Une expedition dites vous, avez vous au moins une chance de faire partir les manteaux de fer ? ou voullez vous simplement m'envoyer a la mort sans raison ?", "artus_recruit_quetmine3",[]],###
  [anyone|plyr ,"artus_recruit_quetmine3", [],  "Nous avons une chance je le crois.", "artus_recruit_quetmine4", []],###
  [anyone ,"artus_recruit_quetmine4", [],"Fort bien...les manteaux de fer ont tué ma femme et ma fille, aidez moi a abattre cette patrouille et je serais des votres.", "artus_recruit_quetmine6",[]],###
  
  [anyone|plyr ,"artus_recruit_quetmine6", [],  "Non attendez, inutile de...", "close_window",
    [
      (assign, "$artus_fix_dial", 1),
      (assign, "$artus_aubmine_rejoin", 1),
      (party_add_members, "p_main_party", "trp_volontaire_grotte4", 1),
      #set relation ici
      
      
      
      
      
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 0, 2, 0),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 2, 1, 0),
      (team_set_relation, 2, 0, 0),
      (mission_disable_talk),
  ]],###
  
  
  
  
  
  
  
  #volontaire Artus premiere phrase
  #  [anyone,"start", [(eq, "$g_talk_troop", "trp_volontaire_grotte4"),
  # (eq, "$no_spawn_garde_ent_auberge_mine", 0),
  #                    ],
  #   "Que me voullez vous Messire ?", "artus_prem_maison", []],
  
  #  [anyone|plyr ,"artus_prem_maison", [],  "Je ne voullais pas vous déranger Messire.", "close_window", []],###
  
  
  #chef gardes interrieur auberge declanche baggare
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_dial_Penthiv_aubtrp1"),
      
    ],
    "Quois ? qui t'as permis d'entrer, qui est tu ?", "chef_aubergmiine", []],
  
  [anyone|plyr ,"chef_aubergmiine", [],  "Le garde a l'entrée m'as dit que vous aurriez du travail pour un mercenaire", "chef_aubergmiine2", []],###
  [anyone|plyr ,"chef_aubergmiine", [],  "Je ne voullais pas vous déranger je repart tout de suite.", "close_window", []],###
  
  
  [anyone ,"chef_aubergmiine2", [],"Vraiment ? et ben...c'est vrai qu'il manque des gars pour surveiller tout le monde, mais toi tu sort d'ou ?", "chef_aubergmiine3",[]],###
  [anyone|plyr ,"chef_aubergmiine3", [],  "Disont que je suit a l'affut de coups qui peuvent me rapporter, que se passe t-il ici ?", "chef_aubergmiine4", []],###
  
  [anyone ,"chef_aubergmiine4", [],"Tu crois peut etre que je vais te mettre au courant de tout. Contente toi d'empécher les villageois de sortir du village et on aurra peut etre une chope et de la viande séchée pour toi.", "chef_aubergmiine5",[]],###
  
  [anyone|plyr ,"chef_aubergmiine5", [],  "Pourquois les empécher de partir ?", "chef_aubergmiine6", []],###
  
  [anyone ,"chef_aubergmiine6", [],"Est ce que t'es sourd ? tu fait ce qu'on te dit ou tu dégage.", "chef_aubergmiine7",[]],###
  [anyone|plyr ,"chef_aubergmiine5", [],  "Peut importe, j'ai a parler avec l'Echanson...en privé. [attaquer]", "close_window",
    [
      
      (team_set_relation, 0, 1, -1),
      (team_set_relation, 0, 2, 0),
      (team_set_relation, 1, 0, -1),
      (team_set_relation, 1, 2, 0),
      (team_set_relation, 2, 1, 0),
      (team_set_relation, 2, 0, 0),
      (mission_disable_talk),
      
      
  ]],###
  [anyone|plyr ,"chef_aubergmiine7", [],  "Dans ce cas je préfère partir, mais je reviendrais.", "close_window", []],###
  
  #gardes interrieur auberge
  [anyone,"start", [(eq, "$g_talk_troop", "trp_dial_Penthiv_aubtrp2"),
      # (eq, "$no_spawn_garde_ent_auberge_mine", 0),
    ],
    "Que fait tu ici toi ? qui t'as dit d'entrer ?", "intauberr_gard", []],
  
  [anyone|plyr ,"intauberr_gard", [],  "C'est votre ami qui garde la porte, il m'as dit que le chef aurait du tavail pour moi.", "close_window", []],###
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_dial_Penthiv_aubtrp3"),
      # (eq, "$no_spawn_garde_ent_auberge_mine", 0),
    ],
    "Qui t'as dit d'entrer maraud ?", "intauberr_gard2", []],
  
  [anyone|plyr ,"intauberr_gard2", [],  "C'est votre ami qui garde la porte, il m'as dit que le chef aurait du tavail pour moi.", "close_window", []],###
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_dial_Penthiv_aubtrp4"),
      # (eq, "$no_spawn_garde_ent_auberge_mine", 0),
    ],
    "Que fait tu la étranger ?", "intauberr_gard3", []],
  
  [anyone|plyr ,"intauberr_gard3", [],  "C'est votre ami qui garde la porte, il m'as dit que le chef aurait du tavail pour moi.", "close_window", []],###
  
  
  
  #dial mission surveillance rennes
  
  #comte premier dial
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rue_dame_comte"),
      (eq, "$comte_sauf", 1),
    ],
    "Mon Dieu, tout ceci m'est insuportable.", "ruedame_comte_sauf", []],
  
  [anyone|plyr ,"ruedame_comte_sauf", [],  "Vous ne craignez plus rien mon seigneur.", "ruedame_comte_sauf2", []],###
  [anyone ,"ruedame_comte_sauf2", [],"Très bien, je vais rentrer a l'interrieur, tu peut t'en aller.", "close_window",
    [
      (call_script, "script_succeed_quest", "qst_surveillance1"),
      (display_message, "@Vous avez terminé votre tour de garde."),
      (jump_to_menu, "mnu_town"),
      (finish_mission),
  ]],###
  
  
  #comte premier dial
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rue_dame_comte"),
      (eq, "$next_dial_ruedame_comte", 1),
    ],
    "C'est inssencé ! que nous veux tu manant ?", "ruedame_gardestart2", []],
  
  [anyone|plyr ,"ruedame_gardestart2", [],  "Pardonnez moi mon seigneur, mais que doit je attendre ?", "ruedame_gardestart3", []],###
  [anyone ,"ruedame_gardestart3", [],"Quel crétin avons nous la, tu dois attendre qu'un austre soldat te releve tout simplement.", "close_window", [ ]],###
  
  
  
  #comte premier dial
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rue_dame_comte"),
      
    ],
    "Es tu la pour la garde soldat ? va a l'entrée et empéche qui que ce soit d'entrer, et veille a ne point nous déranger avec de rustres manières.", "ruedame_gardestart", []],
  
  [anyone|plyr ,"ruedame_gardestart", [],  "Bien compris mon seigneur.", "close_window", [(assign, "$next_dial_ruedame_comte", 1),]],###
  
  
  
  
  
  # [anyone ,"artus_recruit_emo", [],"Rien de bien méchant, je n'ai jamais vu un soldat ne pas supporter la vu du sang, vous irez bientot mieux.", "artus_recruit_aventure", [ ]],###
  
  # peuple attentat
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rue_dame_assassin1"),
      (eq, "$next_dialassassin_sans_epee", 1),
    ],
    "Je n'ai plus d'armes, que veux tu encore ? a ta place j'aurrais honte de travailler pour ce batard de comte.", "ruedame_peuple_collere", []],
  
  [anyone|plyr ,"ruedame_peuple_collere", [],  "Je me fout de ce comte comme de votre condition, mais garder son entrée va me payer de quois boire et manger.", "close_window", []],###
  
  
  
  
  #############
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rue_dame_assassin1"),
      
    ],
    "Quois, que veux tu ?", "ruedame_peuple_arme", []],
  
  [anyone|plyr ,"ruedame_peuple_arme", [],  "Tu porte très mal cette épée, j'aime autant que tu me la donne ou tu risquera de blaisser quelqu'un.", "ruedame_peuple_arme2", []],###
  [anyone ,"ruedame_peuple_arme2", [],"Je n'ai pas d'ordres a recevoir de qui que ce soit, ni du comte ni de ses chiens.", "ruedame_peuple_arme3", [ ]],###
  [anyone|plyr ,"ruedame_peuple_arme3", [],  "Je peut aussi bien la ramasser sur ton cadavre.", "ruedame_peuple_armecada", []],###
  [anyone|plyr ,"ruedame_peuple_arme3", [],  "Très bien garde la.", "close_window", []],###
  
  [anyone ,"ruedame_peuple_armecada", [],"Ca va, la voila, j'éspère que tu va te couper avec.", "close_window",
    [
      (troop_remove_item, "trp_rue_dame_assassin1","itm_sword_medieval_a"),
      (troop_add_item, "trp_player", "itm_sword_medieval_a", 0),
      (assign, "$next_dialassassin_sans_epee", 1),
  ]],###
  
  
  
  
  
  
  # peuple attentat
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rue_dame_assassin2"),
    ],
    "C'est une honte! le Duc devrais mettre aux arrets les fripouilles comme ce comte qui ne pense qu'a boire et a ripailler avec nos impots.", "ruedame_peuple_colleresui", []],
  
  [anyone|plyr ,"ruedame_peuple_colleresui", [],  "Je n'en ai rien a faire de votre comte.", "close_window", []],###
  
  
  # peuple attentat
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rue_dame_assassin3"),
    ],
    "Vive le Duc de Bretagne! et mort aux traitres comme ce comte de mes deux.", "ruedame_peuple_colleresui2", []],
  
  [anyone|plyr ,"ruedame_peuple_colleresui2", [],  "Tachez de ne rien tenter pendant que je suis de garde.", "ruedame_peuple_colleresui22", []],###
  [anyone ,"ruedame_peuple_colleresui22", [],"Pfeu! c'est en laissant les choses s'empirer comme tu le fait que le Duc se retrouve entouré d'ennemis, je serais toi je transpercerais ce comte avec ma lance. pour le Duc !.", "close_window",
    [
  ]],###
  
  
  # peuple attentat
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rue_dame_assassin4"),
    ],
    "Vive le Duc de Bretagne! mort aux traitres !", "ruedame_peuple_suitt", []],
  
  [anyone|plyr ,"ruedame_peuple_suitt", [],  "Je ne veux pas etre mellé a ca.", "close_window", []],###
  
  
  # peuple attentat
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rue_dame_assassin5"),
    ],
    "Regardez moi ce baronnet se pavaner avec ses toilettes, un vraie putain de la cour.", "ruedame_peuple_dernier", []],
  
  [anyone|plyr ,"ruedame_peuple_dernier", [],  "Encore que tu n'ai pas eu a respirer son parfum.", "close_window", []],###
  
  
  
  
  #cinvite conte
  [anyone,"start", [(eq, "$g_talk_troop", "trp_rue_dame_interlocuteur"),
      
    ],
    "Il suffit, ne nous dérange point manant.", "ruedame_derangepoint", []],
  
  [anyone|plyr ,"ruedame_derangepoint", [],  "Pardonnez moi mon seigneur.", "close_window", []],###
  
  #############################################
  
  # troupes cdf camp de siege
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_siege_crane_de_fercamp_troop9"),
      #(eq, "$derniere_variable_du_jeu", 1),
    ],
    "A quand la releve... ", "cdf_camp_relever", []],
  
  [anyone|plyr ,"cdf_camp_relever", [],  "Combien de temps faudra t'il attendre d'aprés toi ?", "cdf_camp_relever2", []],###
  [anyone ,"cdf_camp_relever2", [],"Un siège comme ca ? ca peut durer des mois, en attendant on doit pas marcher et la gamelle est pleine tous les soirs...c'est un genre.", "cdf_camp_relever3",
    [
  ]],
  [anyone|plyr ,"cdf_camp_relever3", [],  "Peut etre que ca n'est pas mon genre...", "cdf_camp_relever4", []],###
  
  [anyone ,"cdf_camp_relever4", [],"T'as qu'a partir et revenir a la fin du siège ca sera pas la première fois.", "close_window",
    [
  ]],
  
  
  
  
  # troupes cdf camp de siege
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_siege_crane_de_fercamp_troop8"),
      #(eq, "$derniere_variable_du_jeu", 1),
    ],
    "Eh l'ami, si tu devais entrer dans la citadelle, tu t'y prendrais comment ?", "cdf_camp_entrer", []],
  
  [anyone|plyr ,"cdf_camp_entrer", [],  "Je n'y ai point pensé.", "cdf_camp_entrer2", []],###
  [anyone ,"cdf_camp_entrer2", [],"Moi...et bien moi, j'entrerai par le mur est, un bon grapin et une corde ferons l'affaire, j'entrerais de nuit...", "cdf_camp_entrer3",
    [
  ]],
  [anyone|plyr ,"cdf_camp_entrer3", [],  "Et... ?", "cdf_camp_entrer4", []],###
  
  [anyone ,"cdf_camp_entrer4", [],"Et ben merde ! que veux tu que je fasse. meme si j'aurrais bien besoin de la prime de Panthièvre, c'est toujours pas assez pour que je me fasse tuer.", "close_window",
    [
  ]],
  
  
  # troupes cdf camp de siege
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_siege_crane_de_fercamp_troop7"),
      #(eq, "$derniere_variable_du_jeu", 1),
    ],
    "Fait tu partie de l'armée du Duc ? celle qui doit nous relever de ce tas de boue ?", "cdf_camp_bpoue", []],
  
  [anyone|plyr ,"cdf_camp_bpoue", [],  "J'ai bien peur que non.", "close_window", []],###
  
  
  
  
  # troupes cdf camp de siege
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_siege_crane_de_fercamp_troop6"),
      #(eq, "$derniere_variable_du_jeu", 1),
    ],
    "D'ou viens tu l'ami ? c'est la première fois que je te voie et j'ai quasiment fait toutes les campagnes de la compagnie.", "cdf_camp_campagne", []],
  
  [anyone|plyr ,"cdf_camp_campagne", [],  "D'ici et d'ailleurs, je n'ai point vraiment de chez moi.", "close_window", []],###
  
  
  
  
  # troupes cdf camp de siege
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_siege_crane_de_fercamp_troop5"),
      #(eq, "$derniere_variable_du_jeu", 1),
    ],
    "As tu entendu parler de la prime pour ceux qui tueraient de Panthièvre ?", "cdf_camp_entendu", []],
  
  [anyone|plyr ,"cdf_camp_entendu", [],  "C'est possible.", "cdf_camp_entendu2", []],###
  
  [anyone ,"cdf_camp_entendu2", [],"Bien sur que t'en as entendu parler, et comme nous tu doit te demander comment piéger ce gibier pour le rapporter au Duc comme trophé.", "close_window",
    [
  ]],
  
  
  
  
  # troupes cdf camp de siege
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_siege_crane_de_fercamp_troop4"),
      #(eq, "$derniere_variable_du_jeu", 1),
    ],
    "Quand je pense a la prime pour la tete de ce batard logé dans son chateau, c'est comme si du gibier et de la cervoise étaient cachés juste dérierre une porte fermée a clef. on pourais sentir l'odeur mais pas s'en saisir.", "cdf_camp_idee", []],
  
  [anyone|plyr ,"cdf_camp_idee", [],  "Il ne nous reste que la solde.", "cdf_camp_idee2", []],###
  
  [anyone ,"cdf_camp_idee2", [],"Hum...je ne sait pas, ca serais moi, j'entrerais la dedans et je ferai un massacre, songe a tout ce qu'on pourais prendre, et n'oublions point les femmes enfermées dans leurs quartiers.", "close_window",
    [
  ]],
  
  
  
  
  # troupes cdf camp de siege
  [anyone,"start", [(eq, "$g_talk_troop", "trp_siege_crane_de_fercamp_troop3"),
      #(eq, "$derniere_variable_du_jeu", 1),
    ],
    "C'est toujours mieux d'attendre que de marcher non ?", "cdf_camp_dialtroopmarche", []],
  
  [anyone|plyr ,"cdf_camp_dialtroopmarche", [],  "Le mieux est encore de dormir avec de la compagnie a l'auberge après un bon repas.", "cdf_camp_dialtroopmarche2", []],###
  
  [anyone ,"cdf_camp_dialtroopmarche2", [],"Pas avant la solde l'ami.", "close_window",
    [
  ]],
  
  
  
  # troupes cdf camp de siege
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_siege_crane_de_fercamp_troop2"),
      (eq, "$derniere_variable_du_jeu", 1),
    ],
    "Ce gauguenard de Panthièvre, si au moins il pouvais attrapper la mort avec un courant d'air, on pourraient rentrer chez nous.", "cdf_camp_dialtroopautre", []],
  
  [anyone|plyr ,"cdf_camp_dialtroopautre", [],  "Quelque chose me dit que tu rentrera tantot.", "close_window", []],###
  
  #
  [anyone,"start", [(eq, "$g_talk_troop", "trp_siege_crane_de_fercamp_troop2"),
      #   (eq, "$derniere_variable_du_jeu", 1),
    ],
    "Il fait froid et on a rien a foutre, pourquois est ce qu'on est venu la ?", "cdf_camp_dialtroop", []],
  
  [anyone|plyr ,"cdf_camp_dialtroop", [],  "Tout n'est jamais simple pour un mercenaire, tu n'as qu'a tuer le temps avant de pouvoir tuer quelqu'un.", "close_window", []],###
  
  
  
  
  
  #sergent si j'ai la chevaliere
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_siege_crane_de_fercamp_troop1"),
      (eq, "$derniere_variable_du_jeu", 1),
    ],
    "J'ai grand peine a croire que tu as fait...ce que tu as dit, évite d'en parler aux autres si tu ne veux pas qu'ils te tranche la main pour reprendre l'anneau.", "cdf_camp_siege_final", []],
  
  [anyone|plyr ,"cdf_camp_siege_final", [],  "Je ne dévoilerais plus ce secret qu'au Duc.", "close_window", []],###
  
  
  
  
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_siege_crane_de_fercamp_troop1"),
      (player_has_item, "itm_preuve_mort_pantievre"),
    ],
    "Ou était tu l'ami, le poste de garde est par ici tu le sait ?", "cdf_camp_siege_vic_bague", []],
  
  [anyone|plyr ,"cdf_camp_siege_vic_bague", [],  "J'était de l'autre coté de la citadelle, j'ai reperé un passage sous-terrain et j'ai profité de l'effet de surprise pour tuer de Panthièvre...", "cdf_camp_siege_vic_bague2", []],###
  
  [anyone|plyr ,"cdf_camp_siege_vic_bague2", [],  "J'ai pris sa chevaliere sur son cadavre, la voici...", "cdf_camp_siege_vic_bague3", []],###
  
  [anyone ,"cdf_camp_siege_vic_bague3", [],"Quois ? bougre de...comment as tu fait ?", "cdf_camp_siege_vic_bague4",
    [
  ]],
  
  [anyone|plyr ,"cdf_camp_siege_vic_bague4", [],  "L'Audace sergent...", "cdf_camp_siege_vic_bague5", []],###
  
  [anyone ,"cdf_camp_siege_vic_bague5", [],"Tu ferai bien de montrer ce bijoux au Duc en personne, il aura 25.000 écus pour toi. Tout le monde sait que c'est ce qu'il as promis de donner a celui qui occiera le batard de de Panthière.", "cdf_camp_siege_vic_bague6",
    [
  ]],
  [anyone|plyr ,"cdf_camp_siege_vic_bague6", [],  "De combien parlez vous ??? je vais mander une audience au Duc de ce pas.", "cdf_camp_siege_vic_bague7", []],###
  
  [anyone ,"cdf_camp_siege_vic_bague7", [],"Garde bien l'anneau pour preuve, sans lui le Duc ne te donnera rien. Bien que meme en le voyant j'ai encore du mal a le croire moi meme.", "close_window",
    [
      (assign, "$derniere_variable_du_jeu", 1),
  ]],
  #sergent premier dial
  
  [anyone,"start", [(eq, "$g_talk_troop", "trp_siege_crane_de_fercamp_troop1"),
    ],
    "Qui va la ? des renforts ?", "cdf_camp_siege_renf",
    [
      (assign, "$peut_attendre", 1),
  ]],
  
  [anyone|plyr ,"cdf_camp_siege_renf", [],  "Le capitaine m'envoie grossir les troupes de votre camp, que se passe t-il sergent ?", "cdf_camp_siege_renf2", []],###
  [anyone ,"cdf_camp_siege_renf2", [],"Rien du tout comme tu voie, il faut juste attendre les armées du Duc et empécher ceux la de sortir de leur citadelle voila tout.", "cdf_camp_siege_renf3",
    [
  ]],
  
  [anyone|plyr ,"cdf_camp_siege_renf3", [],  "Nous devons juste attendre ?", "cdf_camp_siege_renf4", []],###
  
  [anyone ,"cdf_camp_siege_renf4", [],"Attendre et se tenir pret oui, évitez de boire autant que possible.", "close_window",
    [
  ]],
  
  #######################################################################################################################
  [anyone|plyr,"village_elder_talk", [(check_quest_active, "qst_hunt_down_fugitive"),
      (neg|check_quest_concluded, "qst_hunt_down_fugitive"),
      (quest_slot_eq, "qst_hunt_down_fugitive", slot_quest_target_center, "$current_town"),
      (quest_get_slot, ":quest_target_dna", "qst_hunt_down_fugitive", slot_quest_target_dna),
      (call_script, "script_get_name_from_dna_to_s50", ":quest_target_dna"),
      (str_store_string, s4, s50),
    ],
    "I am looking for a man by the name of {s4}. I was told he may be hiding here.", "village_elder_ask_fugitive",[]],
  
  [anyone ,"village_elder_ask_fugitive", [(is_currently_night)],
    "Strangers come and go to our village, {sir/madam}. But I doubt you'll run into him at this hour of the night. You would have better luck during the day.", "village_elder_pretalk",[]],
  [anyone ,"village_elder_ask_fugitive", [],
    "Strangers come and go to our village, {sir/madam}. If he is hiding here, you will surely find him if you look around.", "close_window",[]],
  
  [anyone|plyr,"village_elder_talk", [(store_partner_quest,":elder_quest"),(ge,":elder_quest",0)],
    "About the task you asked of me...", "village_elder_active_mission_1",[]],
  
  [anyone|plyr,"village_elder_talk", [(ge, "$g_talk_troop_faction_relation", 0),(store_partner_quest,":elder_quest"),(lt,":elder_quest",0)],
    "Do you have any tasks I can help you with?", "village_elder_request_mission_ask",[]],
  
  [anyone|plyr,"village_elder_talk", [(party_slot_eq, "$current_town", slot_village_state, 0),
      (neg|party_slot_ge, "$current_town", slot_village_infested_by_bandits, 1),],
    "I want to buy some supplies. I will pay with gold.", "village_elder_trade_begin",[]],
  
  
  [anyone ,"village_elder_trade_begin", [], "Of course, {sir/madam}. Do you want to buy goods or cattle?", "village_elder_trade_talk",[]],
  
  [anyone|plyr,"village_elder_trade_talk", [], "I want to buy food and supplies.", "village_elder_trade",[]],
  
  [anyone ,"village_elder_trade", [],
    "We have some food and other supplies in our storehouse. Come have a look.", "village_elder_pretalk",[(change_screen_trade, "$g_talk_troop"),]],
  
  [anyone|plyr,"village_elder_trade_talk", [(party_slot_eq, "$current_town", slot_village_state, 0),
      (neg|party_slot_ge, "$current_town", slot_village_infested_by_bandits, 1),
      (assign, ":quest_village", 0),
      (try_begin),
        (check_quest_active, "qst_deliver_cattle"),
        (quest_slot_eq, "qst_deliver_cattle", slot_quest_target_center, "$current_town"),
        (assign, ":quest_village", 1),
      (try_end),
      (eq, ":quest_village", 0),
    ],
    "I want to buy some cattle.", "village_elder_buy_cattle",[]],
  
  [anyone|plyr,"village_elder_trade_talk", [], "I changed my mind. I don't need to buy anything.", "village_elder_pretalk",[]],
  
  [anyone|plyr,"village_elder_talk",
    [
    ],
    "Have you seen any enemies around here recently?", "village_elder_ask_enemies",[]],
  
  [anyone,"village_elder_ask_enemies",
    [
      (assign, ":give_report", 0),
      (party_get_slot, ":original_faction", "$g_encountered_party", slot_center_original_faction),
      (store_relation, ":original_faction_relation", ":original_faction", "fac_player_supporters_faction"),
      (try_begin),
        (gt, ":original_faction_relation", 0),
        (party_slot_ge, "$g_encountered_party", slot_center_player_relation, 0),
        (assign, ":give_report", 1),
      (else_try),
        (party_slot_ge, "$g_encountered_party", slot_center_player_relation, 30),
        (assign, ":give_report", 1),
      (try_end),
      (eq, ":give_report", 0),
    ],
    "I am sorry, {sir/madam}. We have neither seen nor heard of any war parties in this area.", "village_elder_pretalk",
    []],
  
  [anyone,"village_elder_ask_enemies",
    [],
    "Hmm. Let me think about it...", "village_elder_tell_enemies",
    [
      (assign, "$temp", 0),
  ]],
  
  [anyone,"village_elder_tell_enemies",
    [
      (assign, ":target_hero_index", "$temp"),
      (assign, ":end_cond", active_npcs_end),
      (try_for_range, ":cur_troop", active_npcs_begin, ":end_cond"),
        (troop_slot_eq, ":cur_troop", slot_troop_occupation, slto_kingdom_hero),
        (troop_get_slot, ":cur_party", ":cur_troop", slot_troop_leaded_party),
        (gt, ":cur_party", 0),
        (store_troop_faction, ":cur_faction", ":cur_troop"),
        (store_relation, ":reln", ":cur_faction", "fac_player_supporters_faction"),
        (lt, ":reln", 0),
        (store_distance_to_party_from_party, ":dist", "$g_encountered_party", ":cur_party"),
        (lt, ":dist", 10),
        (call_script, "script_get_information_about_troops_position", ":cur_troop", 0),
        (eq, reg0, 1), #Troop's location is known.
        (val_sub, ":target_hero_index", 1),
        (lt, ":target_hero_index", 0),
        (assign, ":end_cond", 0),
        (str_store_string, s2, "@He is not commanding any men at the moment."),
        (assign, ":num_troops", 0),
        (assign, ":num_wounded_troops", 0),
        (party_get_num_companion_stacks, ":num_stacks", ":cur_party"),
        (try_for_range_backwards, ":i_stack", 0, ":num_stacks"),
          (party_stack_get_troop_id, ":stack_troop", ":cur_party", ":i_stack"),
          (neg|troop_is_hero, ":stack_troop"),
          (party_stack_get_size, ":stack_size", ":cur_party", ":i_stack"),
          (party_stack_get_num_wounded, ":num_wounded", ":cur_party", ":i_stack"),
          (val_add, ":num_troops", ":stack_size"),
          (val_add, ":num_wounded_troops", ":num_wounded"),
        (try_end),
        (gt, ":num_troops", 0),
        (call_script, "script_round_value", ":num_wounded_troops"),
        (assign, reg1, reg0),
        (call_script, "script_round_value", ":num_troops"),
        (str_store_string, s2, "@He currently commands {reg0} men{reg1?, of which around {reg1} are wounded:}."),
      (try_end),
      (eq, ":end_cond", 0),
    ],
    "{s1} {s2}", "village_elder_tell_enemies",
    [
      (val_add, "$temp", 1),
  ]],
  
  [anyone,"village_elder_tell_enemies",
    [(eq, "$temp", 0)],
    "No, {sir/madam}. We haven't seen any war parties in this area for some time.", "village_elder_pretalk",
    []],
  
  [anyone,"village_elder_tell_enemies",
    [],
    "Well, I guess that was all.", "village_elder_pretalk",
    []],
  
  
  
  
  
  #(fire set up dialogs begin) Asking village elder to set up fire for making prison break easier.
  [anyone|plyr,"village_elder_talk",
    [
      (party_get_slot, ":bound_center", "$current_town", slot_village_bound_center),
      
      (assign, ":num_heroes_in_dungeon", 0),
      (assign, ":num_heroes_given_parole", 0),
      
      (party_get_num_prisoner_stacks, ":num_stacks", ":bound_center"),
      (try_for_range, ":i_stack", 0, ":num_stacks"),
        (party_prisoner_stack_get_troop_id, ":stack_troop",":bound_center",":i_stack"),
        (troop_is_hero, ":stack_troop"),
        (try_begin),
          (call_script, "script_cf_prisoner_offered_parole", ":stack_troop"),
          (party_add_members, "p_temp_party_2", ":stack_troop", 1),
          (val_add, ":num_heroes_given_parole", 1),
        (else_try),
          (party_add_members, "p_temp_party", ":stack_troop", 1),
          (val_add, ":num_heroes_in_dungeon", 1),
        (try_end),
      (try_end),
      
      (ge, ":num_heroes_in_dungeon", 1),
    ],
    "I need you to set a large fire on the outskirts of this village.", "village_elder_ask_set_fire",[]],
  
  [anyone,"village_elder_ask_set_fire",
    [
      (eq, "$g_village_elder_did_not_liked_money_offered", 0),
      (party_get_slot, ":bound_center", "$current_town", slot_village_bound_center),
      (party_get_slot, ":fire_time", ":bound_center", slot_town_last_nearby_fire_time),
      (store_current_hours, ":cur_time"),
      (ge, ":fire_time", ":cur_time"),
    ],
    "We have already agreed upon this, {sir/my lady}. I will do my best. You can trust me.", "close_window",[]],
  
  [anyone,"village_elder_ask_set_fire",
    [
      (eq, "$g_village_elder_did_not_liked_money_offered", 0),
    ],
    "A fire, {sir/madam}! Fires are dangerous! Why would you want such a thing?", "village_elder_ask_set_fire_1",[]],
  
  [anyone,"village_elder_ask_set_fire", #elder did not accepted 100 denars before
    [
      (eq, "$g_village_elder_did_not_liked_money_offered", 1),
    ],
    "I believe that we have already discussed this issue, {sir/my lady}.", "village_elder_ask_set_fire_5",[]],
  
  [anyone,"village_elder_ask_set_fire", #elder did not accepted 100 and 200 denars before
    [
      (eq, "$g_village_elder_did_not_liked_money_offered", 2),
    ],
    "We talked about this {sir/madam} before and your previous offers were low compared to risk you want me to take.", "village_elder_ask_set_fire_5",[]],
  
  [anyone|plyr,"village_elder_ask_set_fire_1",[],
    "I have my reasons, and you will have yours -- a purse of silver. Will you do it, or not?", "village_elder_ask_set_fire_2",[]],
  
  [anyone|plyr,"village_elder_ask_set_fire_1",[],
    "Given the risk you are taking, you are entitled to know my plan.", "village_elder_ask_set_fire_explain_plan",[]],
  
  [anyone|plyr,"village_elder_ask_set_fire_explain_plan",[
      (party_get_slot, ":bound_center", "$g_encountered_party", slot_village_bound_center),
      (str_store_party_name, s4, ":bound_center"),
    ],
    "I wish to rescue a prisoner from {s4}. When you light the fire, the guards in {s4} will see the smoke, and some of them will rush outside to see what is going on. ", "village_elder_ask_set_fire_2",[]],
  
  
  [anyone,"village_elder_ask_set_fire_2",[
      (gt, "$g_talk_troop_effective_relation", 9),
    ],
    "As you wish, {sir/my lady}. You have been a good friend to this village, and, even though there is a risk, we should be glad to return the favor. When do you want this fire to start?", "village_elder_ask_set_fire_9",[]],
  
  [anyone,"village_elder_ask_set_fire_2",[
      (lt, "$g_talk_troop_relation", 0),
    ],
    "I'm sorry, {sir/my lady}. You will forgive me for saying this, but we don't exactly have good reason to trust you. This is too dangerous.", "close_window",[]],
  
  [anyone,"village_elder_ask_set_fire_2",[],
    "As you say, {sir/my lady}. But in doing this, we are taking a very great risk. What's in it for us?", "village_elder_ask_set_fire_3",[]],
  
  
  [anyone|plyr,"village_elder_ask_set_fire_3",
    [
      (store_troop_gold, ":cur_gold", "trp_player"),
      (ge, ":cur_gold", 100),
    ],
    "I can give you 100 denars.", "village_elder_ask_set_fire_4",[(assign, "$g_last_money_offer_to_elder", 100),]],
  
  [anyone|plyr,"village_elder_ask_set_fire_3",
    [
      (store_troop_gold, ":cur_gold", "trp_player"),
      (ge, ":cur_gold", 200),
    ],
    "I can give you 200 denars.", "village_elder_ask_set_fire_6",[(assign, "$g_last_money_offer_to_elder", 200),]],
  
  [anyone|plyr,"village_elder_ask_set_fire_3",
    [
      (store_troop_gold, ":cur_gold", "trp_player"),
      (ge, ":cur_gold", 300),
    ],
    "I can give you 300 denars.", "village_elder_ask_set_fire_6",[(assign, "$g_last_money_offer_to_elder", 300),]],
  
  [anyone|plyr,"village_elder_ask_set_fire_3",[],
    "Never mind.", "close_window",[]],
  
  [anyone,"village_elder_ask_set_fire_4",
    [
      (eq, "$g_village_elder_did_not_liked_money_offered", 0),
    ],
    "This is madness. I cannot take such a risk.", "village_elder_talk",
    [
      (assign, "$g_village_elder_did_not_liked_money_offered", 1),
  ]],
  
  [anyone|plyr,"village_elder_ask_set_fire_5",
    [
      (eq, "$g_village_elder_did_not_liked_money_offered", 1),
      (store_troop_gold, ":cur_gold", "trp_player"),
      (ge, ":cur_gold", 200),
    ],
    "Then let's increase your reward to 200 denars.", "village_elder_ask_set_fire_7", [(assign, "$g_last_money_offer_to_elder", 200),]],
  
  [anyone|plyr,"village_elder_ask_set_fire_5",
    [
      (eq, "$g_village_elder_did_not_liked_money_offered", 1),
      (store_troop_gold, ":cur_gold", "trp_player"),
      (ge, ":cur_gold", 300),
    ],
    "Then let's increase your reward to 300 denars.", "village_elder_ask_set_fire_6",[(assign, "$g_last_money_offer_to_elder", 300),]],
  
  [anyone|plyr,"village_elder_ask_set_fire_5",
    [
      (eq, "$g_village_elder_did_not_liked_money_offered", 2),
      (store_troop_gold, ":cur_gold", "trp_player"),
      (ge, ":cur_gold", 300),
    ],
    "Then let's increase your reward to 300 denars. This is my last offer.", "village_elder_ask_set_fire_6",[(assign, "$g_last_money_offer_to_elder", 300),]],
  
  [anyone|plyr,"village_elder_ask_set_fire_5",[],
    "Never mind.", "close_window",[]],
  
  [anyone,"village_elder_ask_set_fire_6",[],
    "Very well. You are asking me to take a very great risk, but I will do it. When do you want this fire to start?", "village_elder_ask_set_fire_9",
    [
      (troop_remove_gold, "trp_player", "$g_last_money_offer_to_elder"),
  ]],
  
  [anyone,"village_elder_ask_set_fire_7",[],
    "I cannot do such a dangerous thing for 200 denars.", "village_elder_talk",
    [
      (assign, "$g_village_elder_did_not_liked_money_offered", 2),
  ]],
  
  [anyone|plyr,"village_elder_ask_set_fire_9",[],
    "Continue with your preparations. One hour from now, I need that fire.", "village_elder_ask_set_fire_10",
    [
      (party_get_slot, ":bound_center", "$current_town", slot_village_bound_center),
      (store_current_hours, ":cur_time"),
      (assign, ":fire_time", ":cur_time"),
      (party_set_slot, ":bound_center", slot_town_last_nearby_fire_time, ":fire_time"),
      (try_begin),
        (is_between, "$next_center_will_be_fired", villages_begin, villages_end),
        (party_get_slot, ":is_there_already_fire", "$next_center_will_be_fired", slot_village_smoke_added),
        (eq, ":is_there_already_fire", 0),
        (party_get_slot, ":fire_time", "$next_center_will_be_fired", slot_town_last_nearby_fire_time),
        (store_current_hours, ":cur_hours"),
        (store_sub, ":cur_time_sub_fire_duration", ":cur_hours", fire_duration),
        (val_sub, ":cur_time_sub_fire_duration", 1),
        (ge, ":fire_time", ":cur_time_sub_fire_duration"),
        (party_clear_particle_systems, "$next_center_will_be_fired"),
      (try_end),
      (assign, "$next_center_will_be_fired", "$current_town"),
      (assign, "$g_village_elder_did_not_liked_money_offered", 0),
  ]],
  
  [anyone|plyr,"village_elder_ask_set_fire_9",
    [
      (store_time_of_day, ":cur_day_hour"),
      (ge, ":cur_day_hour", 6),
      (lt, ":cur_day_hour", 23),
    ],
    "Do this in at the stroke of midnight. I will wait exactly one hour.", "village_elder_ask_set_fire_11",
    [
      (party_get_slot, ":bound_center", "$current_town", slot_village_bound_center),
      (store_time_of_day, ":cur_day_hour"),
      (store_current_hours, ":cur_time"),
      (store_sub, ":difference", 23, ":cur_day_hour"), #fire will be at 23 midnight today
      (store_add, ":fire_time", ":cur_time", ":difference"),
      (party_set_slot, ":bound_center", slot_town_last_nearby_fire_time, ":fire_time"),
      (try_begin),
        (is_between, "$next_center_will_be_fired", villages_begin, villages_end),
        (party_get_slot, ":is_there_already_fire", "$next_center_will_be_fired", slot_village_smoke_added),
        (eq, ":is_there_already_fire", 0),
        (party_get_slot, ":fire_time", "$next_center_will_be_fired", slot_town_last_nearby_fire_time),
        (store_current_hours, ":cur_hours"),
        (store_sub, ":cur_time_sub_fire_duration", ":cur_hours", fire_duration),
        (val_sub, ":cur_time_sub_fire_duration", 1),
        (ge, ":fire_time", ":cur_time_sub_fire_duration"),
        (party_clear_particle_systems, "$next_center_will_be_fired"),
      (try_end),
      (assign, "$next_center_will_be_fired", "$current_town"),
      (assign, "$g_village_elder_did_not_liked_money_offered", 0),
  ]],
  
  [anyone,"village_elder_ask_set_fire_10",[],
    "Very well, {sir/my lady}. We will make our preparations. Now you make yours.", "close_window",
    [
      (assign, ":maximum_distance", -1),
      (try_for_agents, ":cur_agent"),
        (agent_get_troop_id, ":troop_id", ":cur_agent"),
        (is_between, ":troop_id", village_elders_begin, village_elders_end),
        (agent_get_position, pos0, ":cur_agent"),
        (try_for_range, ":entry_point_id", 0, 64),
          (entry_point_get_position, pos1, ":entry_point_id"),
          (get_distance_between_positions, ":dist", pos0, pos1),
          (gt, ":dist", ":maximum_distance"),
          (assign, ":maximum_distance", ":dist"),
          (copy_position, pos2, pos1),
          (assign, ":village_elder_agent", ":cur_agent"),
        (try_end),
        (try_begin),
          (gt, ":maximum_distance", -1),
          (agent_set_scripted_destination, ":village_elder_agent", pos2),
        (try_end),
      (try_end),
  ]],
  
  [anyone,"village_elder_ask_set_fire_11",[],
    "As you wish, {sir/my lady}. May the heavens protect you.", "close_window",[]],
  #(fire set up dialogs end)
  
  
  
  
  
  
  [anyone|plyr,"village_elder_talk", [(call_script, "script_cf_village_recruit_volunteers_cond"),],
    "Are there any lads from this village who might want to seek their fortune in the wars?", "village_elder_recruit_start",[]],
  
  [anyone|plyr,"village_elder_talk", [],
    "[Leave]", "close_window",[]],
  
  
  
  [anyone ,"village_elder_buy_cattle", [(party_get_slot, reg5, "$g_encountered_party", slot_village_number_of_cattle),
      (gt, reg5, 0),
      (store_item_value, ":cattle_cost", "itm_cattle_meat"),
      (call_script, "script_game_get_item_buy_price_factor", "itm_cattle_meat"),
      (val_mul, ":cattle_cost", reg0),
      #Multiplied by 2 and divided by 100
      (val_div, ":cattle_cost", 50),
      (assign, "$temp", ":cattle_cost"),
      (assign, reg6, ":cattle_cost"),
    ],
    "We have {reg5} heads of cattle, each for {reg6} denars. How many do you want to buy?", "village_elder_buy_cattle_2",[]],
  
  [anyone ,"village_elder_buy_cattle", [],
    "I am afraid we have no cattle left in the village {sir/madam}.", "village_elder_buy_cattle_2",[]],
  
  
  [anyone|plyr,"village_elder_buy_cattle_2", [(party_get_slot, ":num_cattle", "$g_encountered_party", slot_village_number_of_cattle),
      (ge, ":num_cattle", 1),
      (store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", "$temp"),],
    "One.", "village_elder_buy_cattle_complete",[(call_script, "script_buy_cattle_from_village", "$g_encountered_party", 1, "$temp"),
  ]],
  
  [anyone|plyr,"village_elder_buy_cattle_2", [(party_get_slot, ":num_cattle", "$g_encountered_party", slot_village_number_of_cattle),
      (ge, ":num_cattle", 2),
      (store_troop_gold, ":gold", "trp_player"),
      (store_mul, ":cost", "$temp", 2),
      (ge, ":gold", ":cost"),],
    "Two.", "village_elder_buy_cattle_complete",[(call_script, "script_buy_cattle_from_village", "$g_encountered_party", 2, "$temp"),
  ]],
  
  [anyone|plyr,"village_elder_buy_cattle_2", [(party_get_slot, ":num_cattle", "$g_encountered_party", slot_village_number_of_cattle),
      (ge, ":num_cattle", 3),
      (store_troop_gold, ":gold", "trp_player"),
      (store_mul, ":cost", "$temp", 3),
      (ge, ":gold", ":cost"),],
    "Three.", "village_elder_buy_cattle_complete",[(call_script, "script_buy_cattle_from_village", "$g_encountered_party", 3, "$temp"),
  ]],
  
  [anyone|plyr,"village_elder_buy_cattle_2", [(party_get_slot, ":num_cattle", "$g_encountered_party", slot_village_number_of_cattle),
      (ge, ":num_cattle", 4),
      (store_troop_gold, ":gold", "trp_player"),
      (store_mul, ":cost", "$temp", 4),
      (ge, ":gold", ":cost"),],
    "Four.", "village_elder_buy_cattle_complete",[(call_script, "script_buy_cattle_from_village", "$g_encountered_party", 4, "$temp"),
  ]],
  
  [anyone|plyr,"village_elder_buy_cattle_2", [(party_get_slot, ":num_cattle", "$g_encountered_party", slot_village_number_of_cattle),
      (ge, ":num_cattle", 5),
      (store_troop_gold, ":gold", "trp_player"),
      (store_mul, ":cost", "$temp", 5),
      (ge, ":gold", ":cost"),],
    "Five.", "village_elder_buy_cattle_complete",[(call_script, "script_buy_cattle_from_village", "$g_encountered_party", 5, "$temp"),
  ]],
  
  [anyone|plyr,"village_elder_buy_cattle_2", [],
    "Forget it.", "village_elder_pretalk",[]],
  
  [anyone ,"village_elder_buy_cattle_complete", [],
    "I will tell the herders to round up the animals and bring them to you, {sir/madam}. I am sure you will be satisfied with your purchase.", "village_elder_pretalk",[]],
  
  
  [anyone ,"village_elder_recruit_start", [(party_get_slot, ":num_volunteers", "$current_town", slot_center_volunteer_troop_amount),
      (party_get_free_companions_capacity, ":free_capacity", "p_main_party"),
      (val_min, ":num_volunteers", ":free_capacity"),
      (store_troop_gold, ":gold", "trp_player"),
      (store_div, ":gold_capacity", ":gold", 10),#10 denars per man
      (val_min, ":num_volunteers", ":gold_capacity"),
      (eq, ":num_volunteers", 0),
    ],
    "I don't think anyone would be interested, {sir/madam}. Is there anything else I can do for you?", "village_elder_talk",[]],
  
  [anyone ,"village_elder_recruit_start", [(party_get_slot, ":num_volunteers", "$current_town", slot_center_volunteer_troop_amount),
      (party_get_free_companions_capacity, ":free_capacity", "p_main_party"),
      (val_min, ":num_volunteers", ":free_capacity"),
      (store_troop_gold, ":gold", "trp_player"),
      (store_div, ":gold_capacity", ":gold", 10),#10 denars per man
      (val_min, ":num_volunteers", ":gold_capacity"),
      (assign, "$temp",  ":num_volunteers"),
      (assign, reg5, ":num_volunteers"),
      (store_add, reg7, ":num_volunteers", -1),
    ],
    "I can think of {reg5} whom I suspect would jump at the chance. If you could pay 10 denars {reg7?each for their equipment:for his equipment}. " +
    "Does that suit you?", "village_elder_recruit_decision",[]],
  
  #not used:
  ##  [anyone|plyr,"village_elder_recruit_decision", [(party_get_slot, ":num_volunteers", "$current_town", slot_center_volunteer_troop_amount),
  ##                                                  (party_get_free_companions_capacity, ":free_capacity", "p_main_party"),
  ##                                                  (val_min, ":num_volunteers", ":free_capacity"),
  ##                                                  (store_troop_gold, ":gold", "trp_player"),
  ##                                                  (store_div, ":gold_capacity", ":gold", 10),#10 denars per man
  ##                                                  (val_min, ":num_volunteers", ":gold_capacity"),
  ##                                                  (eq, ":num_volunteers", 0),],
  ##   "So be it.", "village_elder_pretalk",
  ##   [
  ##     (try_begin),
  ##       (party_slot_eq, "$current_town", slot_center_volunteer_troop_amount, 0), #do not change the value if it is above 0
  ##       (party_set_slot, "$current_town", slot_center_volunteer_troop_amount, -1),
  ##     (try_end),]],
  
  [anyone|plyr,"village_elder_recruit_decision", [(assign, ":num_volunteers", "$temp"),
      (ge, ":num_volunteers", 1),
      (store_add, reg7, ":num_volunteers", -1)],
    "Tell {reg7?them:him} to make ready.", "village_elder_pretalk",[(call_script, "script_village_recruit_volunteers_recruit"),]],
  
  [anyone|plyr,"village_elder_recruit_decision", [(party_slot_ge, "$current_town", slot_center_volunteer_troop_amount, 1)],
    "No, not now.", "village_elder_pretalk",[]],
  
  [anyone,"village_elder_active_mission_1", [], "Yes {sir/madam}, have you made any progress on it?", "village_elder_active_mission_2",[]],
  
  [anyone|plyr,"village_elder_active_mission_2",[(store_partner_quest,":elder_quest"),
      (eq, ":elder_quest", "qst_deliver_grain"),
      (quest_get_slot, ":quest_target_amount", "qst_deliver_grain", slot_quest_target_amount),
      (call_script, "script_get_troop_item_amount", "trp_player", "itm_grain"),
      (assign, ":cur_amount", reg0),
      (ge, ":cur_amount", ":quest_target_amount"),
      (assign, reg5, ":quest_target_amount"),
    ],
    "Indeed. I brought you {reg5} packs of grain.", "village_elder_deliver_grain_thank",
    []],
  
  [anyone,"village_elder_deliver_grain_thank", [(str_store_party_name, s13, "$current_town")],
    "My good {lord/lady}. You have saved us from hunger and desperation. We cannot thank you enough, but you'll always be in our prayers. " +
    "The village of {s13} will not forget what you have done for us.", "village_elder_deliver_grain_thank_2",
    [(quest_get_slot, ":quest_target_amount", "qst_deliver_grain", slot_quest_target_amount),
      (troop_remove_items, "trp_player", "itm_grain", ":quest_target_amount"),
      (add_xp_as_reward, 400),
      (call_script, "script_change_center_prosperity", "$current_town", 4),
      (call_script, "script_change_player_relation_with_center", "$current_town", 5),
      (call_script, "script_end_quest", "qst_deliver_grain"),
      #Troop commentaries begin
      (call_script, "script_add_log_entry", logent_helped_peasants, "trp_player",  "$current_town", -1, -1),
      #Troop commentaries end
  ]],
  
  [anyone,"village_elder_deliver_grain_thank_2", [],
    "My good {lord/lady}, please, is there anything I can do for you?", "village_elder_talk",[]],
  
  
  [anyone|plyr,"village_elder_active_mission_2", [], "I am still working on it.", "village_elder_active_mission_3",[]],
  [anyone|plyr,"village_elder_active_mission_2", [], "I am afraid I won't be able to finish it.", "village_elder_mission_failed",[]],
  
  [anyone,"village_elder_active_mission_3", [], "Thank you, {sir/madam}. We are praying for your success everyday.", "village_elder_pretalk",[]],
  
  [anyone,"village_elder_mission_failed", [], "Ah, I am sorry to hear that {sir/madam}. I'll try to think of something else.", "village_elder_pretalk",
    [(store_partner_quest,":elder_quest"),
      (call_script, "script_abort_quest", ":elder_quest", 1)]],
  ##
  ##  [anyone,"village_elder_generic_mission_thank", [],
  ##   "You have been so helpful {sir/madam}. I do not know how to thank you.", "village_elder_generic_mission_completed",[]],
  ##
  ##  [anyone|plyr,"village_elder_generic_mission_completed", [],
  ##   "Speak not of it. I only did what needed to be done.", "village_elder_pretalk",[]],
  
  # Currently not needed.
  ##  [anyone|plyr,"village_elder_generic_mission_failed", [],
  ##   "TODO: I'm sorry I failed you sir. It won't happen again.", "village_elder_pretalk",
  ##   [(store_partner_quest,":elder_quest"),
  ##    (call_script, "script_finish_quest", ":elder_quest", 0),
  ##    ]],
  
  
  [anyone,"village_elder_request_mission_ask", [(store_partner_quest,":elder_quest"),(ge,":elder_quest",0)],
    "Well {sir/madam}, you are already engaged with a task helping us. We cannot ask more from you.", "village_elder_pretalk",[]],
  
  [anyone,"village_elder_request_mission_ask", [(troop_slot_eq, "$g_talk_troop", slot_troop_does_not_give_quest, 1)],
    "No {sir/madam}, We don't have any other tasks for you.", "village_elder_pretalk",[]],
  
  [anyone|auto_proceed,"village_elder_request_mission_ask", [], "A task?", "village_elder_tell_mission",
    [
      (call_script, "script_get_quest", "$g_talk_troop"),
      (assign, "$random_quest_no", reg0),
  ]],
  
  
  [anyone,"village_elder_tell_mission", [(eq,"$random_quest_no","qst_deliver_grain")],
    "{My good sir/My good lady}, our village has been going through such hardships lately. " +
    "The harvest has been bad, and recently some merciless bandits took away our seed grain that we had reserved for the planting season. " +
    "If we cannot find some grain soon, we will not be able to plant our fields and then we will have nothing to eat for the coming year. " +
    "If you can help us, we would be indebted to you forever.", "village_elder_tell_deliver_grain_mission",
    [
      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (str_store_party_name_link,s3,":quest_target_center"),
      (quest_get_slot, reg5, "$random_quest_no", slot_quest_target_amount),
      (setup_quest_text,"$random_quest_no"),
      (str_store_string, s2, "@The elder of the village of {s3} asked you to bring them {reg5} packs of grain."),
  ]],
  
  [anyone|plyr,"village_elder_tell_deliver_grain_mission", [],
    "Hmmm. How much grain do you need?", "village_elder_tell_deliver_grain_mission_2",[]],
  [anyone|plyr,"village_elder_tell_deliver_grain_mission", [],
    "I can't be bothered with this. Ask help from someone else.", "village_elder_deliver_grain_mission_reject",[]],
  
  [anyone,"village_elder_tell_deliver_grain_mission_2", [(quest_get_slot, reg5, "$random_quest_no", slot_quest_target_amount)],
    "I think {reg5} packs of grain will let us start the planting. Hopefully, we can find charitable people to help us with the rest.", "village_elder_tell_deliver_grain_mission_3",[]],
  
  [anyone|plyr,"village_elder_tell_deliver_grain_mission_3", [],
    "Then I will go and find you the grain you need.", "village_elder_deliver_grain_mission_accept",[]],
  [anyone|plyr,"village_elder_tell_deliver_grain_mission_3", [],
    "I am afraid I don't have time for this. You'll need to find help elsewhere.", "village_elder_deliver_grain_mission_reject",[]],
  
  [anyone,"village_elder_deliver_grain_mission_accept", [], "Thank you, {sir/madam}. We'll be praying for you night and day.", "close_window",
    [(assign, "$g_leave_encounter",1),
      (call_script, "script_change_player_relation_with_center", "$current_town", 5),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
  ]],
  
  [anyone,"village_elder_deliver_grain_mission_reject", [], "Yes {sir/madam}, of course. I am sorry if I have bothered you with our troubles.", "close_window",
    [(troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1),
  ]],
  
  
  
  [anyone,"village_elder_tell_mission", [(eq,"$random_quest_no", "qst_train_peasants_against_bandits")],
    "We are suffering greatly at the hands of a group of bandits. They take our food and livestock, " +
    "and kill anyone who doesn't obey them immediately. Our men are angry that we cannot defend ourselves, but we are only simple farmers... " +
    "However, with some help, I think that some of the people here could be more than that. " +
    "We just need an experienced warrior to teach us how to fight.",
    "village_elder_tell_train_peasants_against_bandits_mission",
    [
      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (str_store_party_name_link, s13, ":quest_target_center"),
      (quest_get_slot, reg5, "$random_quest_no", slot_quest_target_amount),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@The elder of the village of {s13} asked you to train {reg5} peasants to fight against local bandits."),
  ]],
  
  [anyone|plyr, "village_elder_tell_train_peasants_against_bandits_mission", [],
    "I can teach you how to defend yourself.", "village_elder_train_peasants_against_bandits_mission_accept",[]],
  [anyone|plyr, "village_elder_tell_train_peasants_against_bandits_mission", [],
    "You peasants have no business taking up arms. Just pay the bandits and be off with it.", "village_elder_train_peasants_against_bandits_mission_reject",[]],
  
  [anyone,"village_elder_train_peasants_against_bandits_mission_accept", [], "You will? Oh, splendid! " +
    "We would be deeply indebted to you, {sir/madam}. " +
    "I'll instruct the village folk to assemble here and receive your training. " +
    "If you can teach us how to defend ourselves, I promise you'll receive everything we can give you in return for your efforts.", "close_window",
    [
      (assign, "$g_leave_encounter",1),
      #TODO: Change this value
      (call_script, "script_change_player_relation_with_center", "$current_town", 3),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
  ]],
  
  [anyone,"village_elder_train_peasants_against_bandits_mission_reject", [], "Yes, of course {sir/madam}. " +
    "Thank you for your counsel.", "close_window",
    [
      (troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1),
  ]],
  
  
  [anyone,"village_elder_tell_mission", [(eq,"$random_quest_no","qst_deliver_cattle")],
    "Bandits have driven away our cattle. Our pastures are empty. If we had just a few heads of cattle we could start to raise a herd again.",
    "village_elder_tell_deliver_cattle_mission",
    [
      (quest_get_slot, ":quest_target_center", "$random_quest_no", slot_quest_target_center),
      (str_store_party_name_link,s3,":quest_target_center"),
      (quest_get_slot, reg5, "$random_quest_no", slot_quest_target_amount),
      (setup_quest_text,"$random_quest_no"),
      (str_store_string, s2, "@The elder of the village of {s3} asked you to bring them {reg5} heads of cattle."),
  ]],
  
  [anyone|plyr,"village_elder_tell_deliver_cattle_mission", [],
    "How many animals do you need?", "village_elder_tell_deliver_cattle_mission_2",[]],
  [anyone|plyr,"village_elder_tell_deliver_cattle_mission", [],
    "I don't have time for this. Ask help from someone else.", "village_elder_deliver_cattle_mission_reject",[]],
  
  [anyone,"village_elder_tell_deliver_cattle_mission_2", [(quest_get_slot, reg5, "$random_quest_no", slot_quest_target_amount)],
    "I think {reg5} heads will suffice for a small herd.", "village_elder_tell_deliver_cattle_mission_3",[]],
  
  [anyone|plyr,"village_elder_tell_deliver_cattle_mission_3", [],
    "Then I will bring you the cattle you need.", "village_elder_deliver_cattle_mission_accept",[]],
  [anyone|plyr,"village_elder_tell_deliver_cattle_mission_3", [],
    "I am afraid I don't have time for this. You'll need to find help elsewhere.", "village_elder_deliver_cattle_mission_reject",[]],
  
  [anyone,"village_elder_deliver_cattle_mission_accept", [], "Thank you, {sir/madam}. We'll be praying for you night and day.", "close_window",
    [(assign, "$g_leave_encounter",1),
      (call_script, "script_change_player_relation_with_center", "$current_town", 3),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
  ]],
  
  [anyone,"village_elder_deliver_cattle_mission_reject", [], "Yes {sir/madam}, of course. I am sorry if I have bothered you with our troubles.", "close_window",
    [(troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1),
  ]],
  
  [anyone,"village_elder_tell_mission", [], "Thank you, {sir/madam}, but we do not really need anything right now.", "village_elder_pretalk",[]],
  
  ##  [anyone|plyr,"village_elder_mission_told", [], "TODO: As you wish sir. You can count on me.", "village_elder_mission_accepted",[]],
  ##  [anyone|plyr,"village_elder_mission_told", [], "TODO: I'm afraid I can't carry out this mission right now, sir.", "village_elder_mission_rejected",[]],
  ##
  ##  [anyone,"village_elder_mission_accepted", [], "TODO: Excellent. Do this {playername}. I really have high hopes for you.", "close_window",
  ##   [(assign, "$g_leave_encounter",1),
  ##    (try_begin),
  ##    #TODO: Add quest initializations here
  ##    (try_end),
  ##    (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
  ##    ]],
  
  ##  [anyone,"village_elder_mission_rejected", [], "TODO: Is that so? Perhaps you are not up for the task anyway...", "close_window",
  ##   [(assign, "$g_leave_encounter",1),
  ##    (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -1),
  ##    (troop_set_slot, "$g_talk_troop", slot_troop_does_not_give_quest, 1),
  ##    ]],
  
  
  
  
  #Goods Merchants
  
  [anyone ,"start", [(is_between,"$g_talk_troop",goods_merchants_begin,goods_merchants_end),
      (party_slot_eq, "$current_town", slot_town_lord, "trp_player")],
    "{My lord/my lady}, you honour my humble shop with your presence.", "goods_merchant_talk",[]],
  [anyone ,"start", [(is_between,"$g_talk_troop",goods_merchants_begin,goods_merchants_end)],
    "Welcome {sir/madam}. What can I do for you?", "goods_merchant_talk",[]],
  
  #  [trp_salt_mine_merchant,"start", [], "Hello.", "goods_merchant_talk",[]],
  
  #  [anyone,"merchant_begin", [], " What can I do for you?", "goods_merchant_talk",[]],
  
  [anyone,"goods_merchant_pretalk", [], "Anything else?", "goods_merchant_talk",[]],
  
  [anyone|plyr,"goods_merchant_talk", [], "I want to buy a few items... and perhaps sell some.", "goods_trade_requested",[]],
  [anyone,"goods_trade_requested", [], "Sure, sure... Here, have a look at my stock...", "goods_trade_completed",[[change_screen_trade]]],
  [anyone,"goods_trade_completed", [], "Anything else?", "goods_merchant_talk",[]],
  
  [anyone|plyr,"goods_merchant_talk", [], "What goods should I buy here to trade with other towns?", "trade_info_request",[]],
  
  [anyone|plyr,"goods_merchant_talk", [], "Nothing. Thanks.", "close_window",[]],
  
  [anyone,"trade_info_request", [], "That information can be best obtained from caravan masters " +
    "and travelling merchants. If you want I can send you to the district where foreign merchants stay at when they come to the town. " +
    "If you spend some time there and listen to the talk, " +
    "you can learn a lot about what to buy and where to sell it.", "trade_info_request_2",[]],
  
  [anyone|plyr,"trade_info_request_2", [], "Then I'll go and spend some time with these merchants.", "close_window",
    [
      (jump_to_menu,"mnu_town_trade_assessment_begin"),
      (finish_mission),
  ]],
  
  [anyone|plyr,"trade_info_request_2", [], "I have no time for this right now.", "goods_merchant_pretalk",[]],
  
  
  #  [anyone|plyr,"goods_merchant_talk", [], "What do caravans buy and sell in this town?", "goods_merchant_town_info",[]],
  #  [anyone,"goods_merchant_town_info_completed", [], "Anything else?", "goods_merchant_talk",[]],
  
  
  ##  [anyone,"goods_merchant_town_info", [],
  ##   "TODO: We produce {s1}, and we consume {s2}.", "goods_merchant_town_info_completed",
  ##   [(call_script, "script_print_productions_above_or_below_50", "$g_encountered_party", 1),
  ##    (str_store_string_reg, s1, s51),
  ##    (call_script, "script_print_productions_above_or_below_50", "$g_encountered_party", -1),
  ##    (str_store_string_reg, s2, s51)]],
  ##
  ##  [anyone,"goods_merchant_town_info", [(store_encountered_party,reg(1)),(eq,reg(1),"p_zendar")],
  ##"You can buy tools from here at a very good price.\
  ## The best place to sell them would be Tulga. Heard they pay quite well for tools over there.\
  ## And next time you come here bring some salt. I will pay well for salt.", "goods_merchant_town_info_completed",[]],
  ##  [anyone,"goods_merchant_town_info", [(store_encountered_party,reg(1)),(eq,reg(1),"p_town_1")],
  ##"Sargoth is famous for its fine linen. Many caravans come here to buy that.\
  ## I heard you can sell it at Halmar and make a nice profit.\
  ## And next time you come here bring some iron. I will pay well for iron.", "goods_merchant_town_info_completed",[]],
  ##  [anyone,"goods_merchant_town_info", [[store_encountered_party,reg(1)],[eq,reg(1),"p_town_2"]],
  ##"I can sell you some smoked fish with a special price.\
  ## I heard that caravans take smoked fish to Uxkhal and make a good profit.\
  ## And next time you come here bring some wool. I will pay you well for wool.", "goods_merchant_town_info_completed",[]],
  ##  [anyone,"goods_merchant_town_info", [[store_encountered_party,reg(1)],[eq,reg(1),"p_town_3"]],
  ##"I can sell you some wine with a special price.\
  ## I heard that caravans buy wine from here and sell it at Wercheg, making a good profit.\
  ## And next time you come here, bring some dried meat. I will pay you well for dried meat.", "goods_merchant_town_info_completed",[]],
  ##  [anyone,"goods_merchant_town_info", [[store_encountered_party,reg(1)],[eq,reg(1),"p_town_4"]],
  ##"I have a stock of oil which I can sell you with a good price.\
  ## They say they offer a fortune for oil in Rivacheg, so maybe you can sell it there.\
  ## And next time you come here, bring some furs. I will pay you well for furs.", "goods_merchant_town_info_completed",[]],
  ##  [anyone,"goods_merchant_town_info", [[store_encountered_party,reg(1)],[eq,reg(1),"p_town_5"]],
  ##"Jelkala is famous for its velvet. Many caravans come here to buy that.\
  ## They say merchants will buy it at insane prices in Reyvadin, so maybe you can take it there.\
  ## And next time you come here, bring some pottery. I will pay you well for pottery.", "goods_merchant_town_info_completed",[]],
  ##  [anyone,"goods_merchant_town_info", [[store_encountered_party,reg(1)],[eq,reg(1),"p_town_6"]],
  ##"We produce some excellent ale here in Praven. Most caravans come here to buy that.\
  ## They say that the folks at Khudan will sell their right arms for ale, so maybe you can take it there.\
  ## And next time you come here, bring some spice. I have sold out my stock of spice and I will pay you well for it.", "goods_merchant_town_info_completed",[]],
  ##  [anyone,"goods_merchant_town_info", [[store_encountered_party,reg(1)],[eq,reg(1),"p_town_7"]],
  ##"We produce mostly wheat here in Uxkhal. I would suggest you buy that.\
  ## I heard you can sell it with a good profit in Tulga, so maybe you can take it there.\
  ## And next time you come here, bring some smoked fish. I will pay you well for it.", "goods_merchant_town_info_completed",[]],
  ##
  ##  [anyone,"goods_merchant_town_info", [[store_encountered_party,reg(1)],[eq,reg(1),"p_town_8"]],
  ##"Most caravans come to Reyvadin to buy wool.\
  ## I heard that they take it to Tihr where they pay well for wool.\
  ## And next time you come here, bring some velvet. I will buy it from you at a good price.", "goods_merchant_town_info_completed",[]],
  ##  [anyone,"goods_merchant_town_info", [[store_encountered_party,reg(1)],[eq,reg(1),"p_town_9"]],
  ##"Most caravans come to Khudan to buy furs.\
  ## I heard that they take it to Suno where they pay well for it.\
  ## And next time you come here, bring some ale. I will buy it from you at a good price.", "goods_merchant_town_info_completed",[]],
  ##  [anyone,"goods_merchant_town_info", [[store_encountered_party,reg(1)],[eq,reg(1),"p_town_10"]],
  ##"Most caravans come to Tulga to buy spice.\
  ## They say that in Praven they pay well for spice, so you may think of selling it to the mechants there.\
  ## And next time you come here, bring some wheat. I will buy it from you at a good price.", "goods_merchant_town_info_completed",[]],
  ##  [anyone,"goods_merchant_town_info", [[store_encountered_party,reg(1)],[eq,reg(1),"p_town_11"]],
  ##"We mine a lot of iron here in Curaw. I would suggest you buy that.\
  ## I heard you can take it to Sargoth and sell it with a good profit.\
  ## And next time you come here, bring some dried meat. I will pay you well for it.", "goods_merchant_town_info_completed",[]],
  ##  [anyone,"goods_merchant_town_info", [[store_encountered_party,reg(1)],[eq,reg(1),"p_town_12"]],
  ##"I can sell you some smoked fish with a special price.\
  ## I heard that caravans take smoked fish to Uxkhal and make a good profit.\
  ## And next time you come here bring some wine. I will pay you well for wine.", "goods_merchant_town_info_completed",[]],
  ##  [anyone,"goods_merchant_town_info", [[store_encountered_party,reg(1)],[eq,reg(1),"p_town_13"]],
  ##"I have a stock of dried meat which I can sell you with a good price.\
  ## They say they pay very well for dried meat in Veluca, so maybe you can sell it there.\
  ## And next time you come here, bring some oil. I have sold out my stock of oil and I will pay you well for it.", "goods_merchant_town_info_completed",[]],
  ##  [anyone,"goods_merchant_town_info", [[store_encountered_party,reg(1)],[eq,reg(1),"p_town_14"]],
  ##"We produce some good quality pottery here in Halmar. Most caravans come here to buy that.\
  ## I heard that caravans buy pottery from here and sell it at Jelkala, making a good profit.\
  ## And next time you come here, bring some linen. I have sold out my stock of linen and I will pay you well for it.", "goods_merchant_town_info_completed",[]],
  ##
  ##  [anyone,"goods_merchant_town_info", [[store_encountered_party,reg(1)],[eq,reg(1),"p_salt_mine"]],
  ##"Heh. Are you joking with me? This is the salt mine. Merchants come here to buy salt.", "goods_merchant_town_info_completed",[]],
  ##
  ##  [anyone,"goods_merchant_town_info", [
  ##                                       (store_encountered_party,reg(9)),
  ##                                       (party_get_slot,reg(5),reg(9),slot_town_export_good),
  ##                                       (party_get_slot,reg(6),reg(9),slot_town_import_good),
  ##                                       (ge,reg(5),1),
  ##                                       (ge,reg(6),1),
  ##                                       (str_store_item_name,1,reg(5)),
  ##                                       (str_store_item_name,2,reg(6)),
  ##                                       ],
  ##  "I can sell you some {s1} with a special price.\
  ##And next time you come here bring some {s2}. I will pay you well for that.", "goods_merchant_town_info_completed",[]],
  ##
  ##  [anyone,"goods_merchant_town_info", [
  ##                                       (store_encountered_party,reg(9)),
  ##                                       (party_get_slot,reg(5),reg(9),slot_town_export_good),
  ##                                       (ge,reg(5),1),
  ##                                       (str_store_item_name,1,reg(5)),
  ##                                       ],
  ##  "I can sell you some {s1} with a special price.", "goods_merchant_town_info_completed",[]],
  ##
  ##  [anyone,"goods_merchant_town_info", [
  ##                                       (store_encountered_party,reg(9)),
  ##                                       (party_get_slot,reg(6),reg(9),slot_town_import_good),
  ##                                       (ge,reg(6),1),
  ##                                       (str_store_item_name,2,reg(6)),
  ##                                       ],
  ##  "If you have some {s2} with you, I am ready to pay you good money for it.", "goods_merchant_town_info_completed",[]],
  ##
  ##  [anyone,"goods_merchant_town_info", [],
  ##"Sorry. Caravans hardly ever trade anything here.", "goods_merchant_town_info_completed",[]],
  
  
  
  
  
  
  #############################################################################
  #### ARENA MASTERS
  #############################################################################
  [anyone ,"start", [(store_conversation_troop,reg(1)),
      (is_between,reg(1),arena_masters_begin,arena_masters_end),
      (assign, "$arena_reward_asked", 0), #set some variables.
      (assign, "$arena_tournaments_asked", 0),
      (eq,1,0),
    ],
    "{!}.", "arena_intro_1",[]],
  [anyone ,"start", [(store_conversation_troop,reg(1)),
      (is_between,reg(1),arena_masters_begin,arena_masters_end),
      (eq,"$arena_master_first_talk", 0),
    ],
    "Good day friend. If you came to watch the tournaments you came in vain. There won't be a tournament here anytime soon.", "arena_intro_1",[(assign,"$arena_master_first_talk", 1)]],
  [anyone|plyr,"arena_intro_1", [], "Tournaments? So they hold the tournaments here...", "arena_intro_2",[]],
  [anyone,"arena_intro_2", [], "Yes. You should see this place during one of the tournament fights. " +
    "Everyone from the town and nearby villages comes here. The crowd becomes mad with excitement. " +
    "Anyway, as I said, there won't be an event here soon, so there isn't much to see. " +
    "Except, there is an official duel every now and then, and  of course we have melee fights almost every day.", "arena_intro_3",[]],
  [anyone|plyr,"arena_intro_3", [], "Tell me about the melee fights.", "arena_training_melee_intro",[]],
  [anyone,"arena_training_melee_intro", [], "The fighters and knights get bored waiting for the next tournament, " +
    "so they have invented the training melee. It is a simple idea really. " +
    "Fighters jump into the arena with a weapon. There are no rules, no teams. " +
    "Everyone beats at each other until there is only one fighter left standing. " +
    "Sounds like fun, eh?", "arena_training_melee_intro_2",[]],
  [anyone|plyr,"arena_training_melee_intro_2", [(eq, "$arena_reward_asked", 0)], "Is there a reward?", "arena_training_melee_intro_reward",[(assign, "$arena_reward_asked", 1)]],
  [anyone,"arena_training_melee_intro_reward", [(assign, reg1, arena_tier1_opponents_to_beat),(assign, reg11, arena_tier1_prize),
      (assign, reg2, arena_tier2_opponents_to_beat),(assign, reg12, arena_tier2_prize),
      (assign, reg3, arena_tier3_opponents_to_beat),(assign, reg13, arena_tier3_prize),
      (assign, reg4, arena_tier4_opponents_to_beat),(assign, reg14, arena_tier4_prize),
      (assign, reg15, arena_grand_prize)
    ], "There is, actually. Some of the wealthy townsmen offer prizes for those fighters who show great skill in the fights. " +
    "If you can beat {reg1} opponents before going down, you'll earn {reg11} denars. You'll get {reg12} denars for striking down at least {reg2} opponents, " +
    "{reg13} denars if you can defeat {reg3} opponents, and {reg14} denars if you can survive long enough to beat {reg4} opponents. " +
    "If you can manage to be the last {man/fighter} standing, you'll earn the great prize of the fights, {reg15} denars. Sounds good, eh?", "arena_training_melee_intro_2",[(assign, "$arena_tournaments_asked", 1),]],
  [anyone,"arena_training_melee_explain_reward", [
      (assign, reg1, arena_tier1_opponents_to_beat),(assign, reg11, arena_tier1_prize),
      (assign, reg2, arena_tier2_opponents_to_beat),(assign, reg12, arena_tier2_prize),
      (assign, reg3, arena_tier3_opponents_to_beat),(assign, reg13, arena_tier3_prize),
      (assign, reg4, arena_tier4_opponents_to_beat),(assign, reg14, arena_tier4_prize),
      (assign, reg15, arena_grand_prize)
    ], "Some of the wealthy townsmen offer prizes for those fighters who show great skill in the fights. " +
    "If you can beat {reg1} opponents before going down, you'll earn {reg11} denars. You'll get {reg12} denars for striking down at least {reg2} opponents, " +
    "{reg13} denars if you can defeat {reg3} opponents, and {reg14} denars if you can survive long enough to beat {reg4} opponents. " +
    "If you can manage to be the last {man/fighter} standing, you'll earn the great prize of the fights, {reg15} denars. Sounds good, eh?", "arena_master_melee_pretalk",[]],
  [anyone|plyr,"arena_training_melee_intro_2", [], "Can I join too?", "arena_training_melee_intro_3",[]],
  [anyone,"arena_training_melee_intro_3", [], "Ha ha. You would have to be out of your mind not to. Of course. The melee fights are open to all. " +
    "Actually there is going to be a fight soon. You can go and hop in if you want to.", "arena_master_melee_talk",[]],
  
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),
      (is_between,reg(1),arena_masters_begin,arena_masters_end),
      (eq,"$g_talk_troop_met", 0),
    ],
    "Hello. You seem to be new here. Care to share your name?", "arena_master_intro_1",[]],
  [anyone|plyr,"arena_master_intro_1", [], "I am {playername}.", "arena_master_intro_2",[]],
  [anyone,"arena_master_intro_2", [(store_encountered_party,reg(2)),(str_store_party_name,1,reg(2))],
    "Well met {playername}. I am the master of the tournaments here at {s1}. Talk to me if you want to join the fights.", "arena_master_pre_talk",[]],
  
  
  [anyone|auto_proceed ,"start", [(store_conversation_troop,reg(1)),(is_between,reg(1),arena_masters_begin,arena_masters_end),
      (eq, "$last_training_fight_town", "$current_town"),
      (store_current_hours,":cur_hours"),
      (val_add, ":cur_hours", -4),
      (lt, ":cur_hours", "$training_fight_time")],
    ".", "arena_master_fight_result",[(assign, "$arena_reward_asked", 0)]],
  
  [anyone ,"arena_master_fight_result",
    [
      (eq, "$g_arena_training_won", 0),
      (eq, "$g_arena_training_kills", 0)
    ],
    "Ha-ha, that's quite the bruise you're sporting. But don't worry; everybody gets trounced once in awhile. The important thing is to pick yourself up, dust yourself off and keep fighting. That's what champions do.", "arena_master_pre_talk",[(assign, "$last_training_fight_town", -1)]],
  
  [anyone ,"arena_master_fight_result",
    [
      (eq, "$g_arena_training_won", 0),
      (lt, "$g_arena_training_kills", arena_tier1_opponents_to_beat),
      (assign, reg8, "$g_arena_training_kills")
    ],
    "Hey, you managed to take down {reg8} opponents. Not bad. But that won't bring you any prize money. " +
    "Now, if I were you, I would go back there and show everyone what I can do...", "arena_master_pre_talk",[(assign, "$last_training_fight_town", -1)]],
  
  [anyone ,"arena_master_fight_result",
    [
      (eq, "$g_arena_training_won", 0),
      (lt, "$g_arena_training_kills", arena_tier2_opponents_to_beat),
      (assign, reg8, "$g_arena_training_kills"),
      (assign, reg10, arena_tier1_prize),
    ],
    "You put up quite a good fight there. Good moves. You definitely show promise. " +
    "And you earned a prize of {reg10} denars for knocking down {reg8} opponents.", "arena_master_pre_talk",[
      (call_script, "script_troop_add_gold", "trp_player", arena_tier1_prize),
      (add_xp_to_troop,5,"trp_player"),
      (assign, "$last_training_fight_town", -1)]],
  
  [anyone ,"arena_master_fight_result",
    [
      (eq, "$g_arena_training_won", 0),
      (lt, "$g_arena_training_kills", arena_tier3_opponents_to_beat),
      (assign, reg8, "$g_arena_training_kills"),
      (assign, reg10, arena_tier2_prize),
      (assign, reg12, arena_tier2_opponents_to_beat),
    ],
    "That was a good fight you put up there. You managed to take down no less than {reg8} opponents. " +
    "And of course, you earned a prize money of {reg10} denars.", "arena_master_pre_talk",[
      (call_script, "script_troop_add_gold", "trp_player", arena_tier2_prize),
      (add_xp_to_troop,10,"trp_player"),
      (assign, "$last_training_fight_town", -1)]],
  
  [anyone ,"arena_master_fight_result",
    [
      (eq, "$g_arena_training_won", 0),
      (lt, "$g_arena_training_kills", arena_tier4_opponents_to_beat),
      (assign, reg8, "$g_arena_training_kills"),
      (assign, reg10, arena_tier3_prize)
    ],
    "Your performance was amazing! You are without doubt a very skilled fighter. " +
    "Not everyone can knock down {reg8} people in the fights. Of course you deserve a prize with that performance: {reg10} denars. Nice, eh?", "arena_master_pre_talk",[
      (call_script, "script_troop_add_gold", "trp_player", arena_tier3_prize),
      (add_xp_to_troop,10,"trp_player"),
      (assign, "$last_training_fight_town", -1)]],
  
  [anyone ,"arena_master_fight_result",
    [
      (eq, "$g_arena_training_won", 0),
      (assign, reg8, "$g_arena_training_kills"),
      (assign, reg10, arena_tier4_prize),
    ],
    "That was damned good fighting, {playername}. You have very good moves, excellent tactics. " +
    "And you earned a prize of {reg10} denars for knocking down {reg8} opponents.", "arena_master_pre_talk",
    [
      (call_script, "script_troop_add_gold", "trp_player", arena_tier4_prize),
      (add_xp_to_troop,10,"trp_player"),
      (assign, "$last_training_fight_town", -1),
  ]],
  
  [anyone ,"arena_master_fight_result", [(assign, reg10, arena_grand_prize)],
    "Congratulations champion! Your fight there was something to remember! You managed to be the last fighter standing beating down everyone else. And of course you won the grand prize of the fights: {reg10} denars.", "arena_master_pre_talk",[
      (call_script, "script_troop_add_gold", "trp_player", arena_grand_prize),
      (add_xp_to_troop,200,"trp_player"),
      (assign, "$last_training_fight_town", -1)]],
  
  
  [anyone ,"start", [(store_conversation_troop,reg(1)),(is_between,reg(1),arena_masters_begin,arena_masters_end)],
    "Hello {playername}. Good to see you again.", "arena_master_pre_talk",[(assign, "$arena_reward_asked", 0)]],
  
  
  [anyone,"arena_master_pre_talk", [], "What would you like to do?", "arena_master_talk",[]],
  
  
  #  [anyone|plyr,"arena_master_talk", [], "About the arena fights...", "arena_master_melee",[]],
  [anyone|plyr,"arena_master_talk", [], "About the melee fights...", "arena_master_melee_pretalk",[]],
  [anyone|plyr,"arena_master_talk", [(eq, "$arena_tournaments_asked", 0)], "Will there be a tournament in nearby towns soon?", "arena_master_ask_tournaments",[(assign, "$arena_tournaments_asked", 1)]],
  #steel edition entrainement joutes
  [anyone|plyr,"arena_master_talk", [], "Est t-il possible de s'entrainer a jouter ?", "a_master_joustes_training",[]],
  
  
  
  
  [anyone|plyr,"arena_master_talk", [], "I need to leave now. Good bye.", "close_window",[]],
  
  [anyone,"arena_master_ask_tournaments", [], "{reg2?There won't be any tournaments any time soon.:{reg1?Tournaments are:A tournament is} going to be held at {s15}.}", "arena_master_talk",
    [
      (assign, ":num_tournaments", 0),
      (try_for_range_backwards, ":town_no", towns_begin, towns_end),
        (party_slot_ge, ":town_no", slot_town_has_tournament, 1),
        (val_add, ":num_tournaments", 1),
        (try_begin),
          (eq, ":num_tournaments", 1),
          (str_store_party_name, s15, ":town_no"),
        (else_try),
          (str_store_party_name, s16, ":town_no"),
          (eq, ":num_tournaments", 2),
          (str_store_string, s15, "@{s16} and {s15}"),
        (else_try),
          (str_store_string, s15, "@{!}{s16}, {s15}"),
        (try_end),
      (try_end),
      (try_begin),
        (eq, ":num_tournaments", 0),
        (assign, reg2, 1),
      (else_try),
        (assign, reg2, 0),
        (store_sub, reg1, ":num_tournaments", 1),
      (try_end),
  ]],
  
  [anyone,"arena_master_melee_pretalk", [], "There will be a fight here soon. You can go and jump in if you like.", "arena_master_melee_talk",[]],
  [anyone|plyr,"arena_master_melee_talk", [], "Good. That's what I am going to do.", "close_window",
    [
      (assign, "$last_training_fight_town", "$current_town"),
      (store_current_hours,"$training_fight_time"),
      (assign, "$g_mt_mode", abm_training),
      (party_get_slot, ":scene","$current_town",slot_town_arena),
      (modify_visitors_at_site,":scene"),
      (reset_visitors),
      (store_random_in_range, "$g_player_entry_point", 32, 40),
      (set_visitor, "$g_player_entry_point", "trp_player"),
      (set_jump_mission,"mt_arena_melee_fight"),
      (jump_to_scene, ":scene"),
  ]],
  [anyone|plyr,"arena_master_melee_talk", [], "Thanks. But I will give my bruises some time to heal.", "arena_master_melee_reject",[]],
  [anyone,"arena_master_melee_reject", [], "Good {man/girl}. That's clever of you.", "arena_master_pre_talk",[]],
  
  [anyone|plyr,"arena_master_melee_talk", [(eq, "$arena_reward_asked", 0)], "Actually, can you tell me about the rewards again?", "arena_training_melee_explain_reward",[(assign, "$arena_reward_asked", 1)]],
  
  
  [anyone,"a_master_joustes_training", [], "Bien entendu, il y as toujours des jouteurs amateurs ou confirmés pret a s'exercer quelque soit leur motivations, du palfrenier qui reve de se faire remarquer par une noble dame ou les passionnés de cette discipline.", "close_window",
    [
      #(call_script, "script_training_joutes"),
      #(finish_mission),
      
      
      #(assign, "$last_training_fight_town", "$current_town"),
      #  (store_current_hours,"$training_fight_time"),
      # (assign, "$g_mt_mode", abm_training),
      #  (party_get_slot, ":scene","$current_town",slot_town_arena),
      #  (modify_visitors_at_site,":scene"),
      # (reset_visitors),
      #(store_random_in_range, "$g_player_entry_point", 32, 40),
      #(set_visitor, "$g_player_entry_point", "trp_player"),
      
      #  (set_jump_entry, 60),#
      #        (set_visitor, 60, "trp_player"),#
      #        (set_visitor, 61, "trp_jouteur_training"),#
      
      #   (set_jump_mission,"mt_training_joutes"),
      #    (mission_tpl_entry_set_override_flags, "mt_training_joutes", 60, af_override_all),#
      #    (mission_tpl_entry_clear_override_items, "mt_training_joutes", 60),#
      #    (mission_tpl_entry_add_override_item, "mt_training_joutes", 60, "itm_tutorial_saddle_horse"),#
      #    (mission_tpl_entry_add_override_item, "mt_training_joutes", 60, "itm_mail_mittens"),#
      #   (mission_tpl_entry_add_override_item, "mt_training_joutes", 60, "itm_mail_boots"),#
      #    (mission_tpl_entry_add_override_item, "mt_training_joutes", 60, "itm_mail_chausses"),#
      #    (mission_tpl_entry_add_override_item, "mt_training_joutes", 60, "itm_mail_hauberk"),#
      #    (mission_tpl_entry_add_override_item, "mt_training_joutes", 60, "itm_mail_coif"),#
      #    (mission_tpl_entry_add_override_item, "mt_training_joutes", 60, "itm_new_jousting_lancebluewhite"),#
      
      
      # (jump_to_scene, ":scene"),
      #(finish_mission),
      
      (jump_to_menu, "mnu_tournois_training"),
      (finish_mission),
  ]],
  
  #  [anyone,"arena_master_pre_talk",
  #   [(eq,"$arena_join_or_watch",1),
  #    (ge,"$arena_bet_amount",1),
  #    (eq,"$arena_bet_team","$arena_winner_team"),
  #    (assign,reg(5),"$arena_win_amount")],
  # "You've won the bet, eh? Let me see. The sum you have earned amounts to {reg5} denars. Here you go.", "arena_master_pre_talk",
  #   [(call_script, "script_troop_add_gold", "trp_player", "$arena_win_amount"),
  #    (assign,"$arena_bet_amount",0),
  #    (assign,"$arena_win_amount",0),
  #    ]],
  
  #  [anyone,"arena_master_pre_talk",
  #   [(eq,"$arena_join_or_watch",0),
  #    (ge,"$arena_bet_amount",1),
  #    (eq,"$arena_fight_won",1),
  #    (assign,reg(5),"$arena_win_amount"),
  #   ],
  # "And you had the good sense to bet on yourself too. Hmm let me see. You have won yourself some {reg5} denars. Here you are.", "arena_master_pre_talk",
  #   [(call_script, "script_troop_add_gold", "trp_player", "$arena_win_amount"),
  #    (assign,"$arena_bet_amount",0),
  #    (assign,"$arena_win_amount",0)]],
  
  #  [anyone,"start", [(store_conversation_troop,reg(1)),(is_between,reg(1),arena_masters_begin,arena_masters_end),(eq,"$waiting_for_arena_fight_result",1),(eq,"$arena_join_or_watch",0),(eq,"$arena_fight_won",1)],
  # "Congratulations champion. You made some pretty good moves out there. Here is your share of share of the prize money, 2 denars.", "arena_master_pre_talk",
  #   [(assign,"$waiting_for_arena_fight_result",0),(add_xp_to_troop,20,"trp_player"),(call_script, "script_troop_add_gold", "trp_player",2)]],
  #  [anyone,"start", [(store_conversation_troop,reg(1)),(is_between,reg(1),arena_masters_begin,arena_masters_end),(eq,"$waiting_for_arena_fight_result",1),(eq,"$arena_join_or_watch",0)],
  # "That's quite the bruise you're sporting. But don't worry; everybody gets trounced once in awhile. The important thing is to pick yourself up, dust yourself off and keep fighting. That's what champions do.", "arena_master_pre_talk",[[assign,"$waiting_for_arena_fight_result"]]],
  #  [anyone,"start", [(store_conversation_troop,reg(1)),(is_between,reg(1),arena_masters_begin,arena_masters_end),(eq,"$waiting_for_arena_fight_result",1)],
  # "That was exciting wasn't it? Nothing like a good fight to get the blood flowing.", "arena_master_pre_talk",[(assign,"$waiting_for_arena_fight_result",0)]],
  
  ##  [anyone,"arena_master_melee", [], "The next arena fight will start in a while. Hurry up if you want to take part in it.", "arena_master_melee_talk",[
  ##    (party_get_slot, ":arena_cur_tier","$current_town",slot_town_arena_melee_cur_tier),
  ##    (try_begin), #reg3 = num teams, reg4 = team size
  ##      (eq, ":arena_cur_tier", 0),
  ##      (party_get_slot, "$_num_teams","$current_town",slot_town_arena_melee_1_num_teams),
  ##      (party_get_slot, "$_team_size","$current_town",slot_town_arena_melee_1_team_size),
  ##    (else_try),
  ##      (eq, ":arena_cur_tier", 1),
  ##      (party_get_slot, "$_num_teams","$current_town",slot_town_arena_melee_2_num_teams),
  ##      (party_get_slot, "$_team_size","$current_town",slot_town_arena_melee_2_team_size),
  ##    (else_try),
  ##      (party_get_slot, "$_num_teams","$current_town",slot_town_arena_melee_3_num_teams),
  ##      (party_get_slot, "$_team_size","$current_town",slot_town_arena_melee_3_team_size),
  ##    (try_end),
  ##   ]],
  ##  [anyone|plyr,"arena_master_melee_talk", [], "I want to join the next fight", "arena_master_next_melee_join",[(assign,"$arena_join_or_watch",0)]],
  ##  [anyone|plyr,"arena_master_melee_talk", [], "I would like to watch the next fight", "arena_master_next_melee_watch",
  ##   [(assign,"$arena_join_or_watch",1)]],
  ##  [anyone|plyr,"arena_master_melee_talk", [], "No. perhaps later.", "arena_master_we_will_fight_not",[]],
  ##  [anyone,"arena_master_we_will_fight_not", [], "Alright. Talk to me when you are ready.", "close_window",[]],
  ##  [anyone,"arena_master_next_melee_join", [
  ##    (assign,"$arena_bet_amount"),
  ##    (assign,"$arena_bet_team",0),
  ##    (party_get_slot, ":player_odds", "$g_encountered_party", slot_town_player_odds),
  ##    (store_div, ":divider", ":player_odds", 20),
  ##    (store_mul, ":odds_simple", ":divider", 20),
  ##    (val_sub, ":odds_simple", ":player_odds"),
  ##    (try_begin),
  ##      (lt, ":odds_simple", 0),
  ##      (val_add, ":divider", 1),
  ##    (try_end),
  ##    (val_max, ":divider", 50),
  ##    (store_div, ":odds_player", ":player_odds", ":divider"),
  ##    (store_div, ":odds_other", 1000, ":divider"),
  ##    (try_for_range, ":unused", 0, 5),
  ##      (assign, ":last_divider", 21),
  ##      (try_for_range, ":cur_divider", 2, ":last_divider"),
  ##        (store_div, ":odds_player_test", ":odds_player", ":cur_divider"),
  ##        (val_mul, ":odds_player_test", ":cur_divider"),
  ##        (eq, ":odds_player_test", ":odds_player"),
  ##        (store_div, ":odds_other_test", ":odds_other", ":cur_divider"),
  ##        (val_mul, ":odds_other_test", ":cur_divider"),
  ##        (eq, ":odds_other_test", ":odds_other"),
  ##        (val_div, ":odds_player", ":cur_divider"),
  ##        (val_div, ":odds_other", ":cur_divider"),
  ##        (assign, ":last_divider", 0),
  ##      (try_end),
  ##    (try_end),
  ##    (assign, reg5, ":odds_player"),
  ##    (assign, reg6, ":odds_other"),], "Do you want to place a bet on yourself? The odds against you are {reg5} to {reg6}.", "arena_master_will_you_bet",
  ##   []],
  ##
  ##  [anyone|plyr,"arena_master_will_you_bet", [], "No.", "arena_master_start_fight",[]],
  ##  [anyone|plyr,"arena_master_will_you_bet", [(store_troop_gold,reg(0)),(ge,reg(0),10)], "I want to bet 10 denars.",
  ##   "arena_master_bet_placed",[(assign,"$arena_bet_amount",10),(troop_remove_gold, "trp_player",10)]],
  ##  [anyone|plyr,"arena_master_will_you_bet", [(store_troop_gold,reg(0)),(ge,reg(0),50)], "I want to bet 50 denars.",
  ##   "arena_master_bet_placed",[(assign,"$arena_bet_amount",50),(troop_remove_gold, "trp_player",50)]],
  ##  [anyone|plyr,"arena_master_will_you_bet", [(store_troop_gold,reg(0)),(ge,reg(0),100)], "I want to bet 100 denars.",
  ##   "arena_master_bet_placed",[(assign,"$arena_bet_amount",100),(troop_remove_gold, "trp_player",100)]],
  ##  [anyone,"arena_master_next_melee_watch", [], "Do you want to place a bet?", "arena_master_will_you_bet",[]],
  ##  [anyone,"arena_master_bet_placed", [(eq,"$arena_join_or_watch",1)], "Hmm. That's good. If you win, you'll get {reg5} denars. And which team do you want to place your bet on?", "arena_master_select_team",
  ##   [(store_mul, "$arena_win_amount", "$arena_bet_amount", "$_num_teams"),
  ##    (val_mul, "$arena_win_amount", 9),
  ##    (val_div, "$arena_win_amount", 10),
  ##    (assign, reg5, "$arena_win_amount"),
  ##    ]],
  ##  [anyone|plyr,"arena_master_select_team", [], "The red team. I have a feeling they will win this one.",
  ##   "arena_master_start_fight",[(assign,"$arena_bet_team",0)]],
  ##  [anyone|plyr,"arena_master_select_team", [], "The blue team. They will sweep the ground with the reds.",
  ##   "arena_master_start_fight",[(assign,"$arena_bet_team",1)]],
  ##  [anyone|plyr,"arena_master_select_team", [(ge,"$_num_teams",3)], "The green team. My money is on them this time.",
  ##   "arena_master_start_fight",[(assign,"$arena_bet_team",2)]],
  ##  [anyone|plyr,"arena_master_select_team", [(ge,"$_num_teams",4)], "The yellow team. They will be victorious.",
  ##   "arena_master_start_fight",[(assign,"$arena_bet_team",3)]],
  ##  [anyone,"arena_master_bet_placed", [], "That's good. Let me record that. If you win, you'll get {reg5} denars.", "arena_master_start_fight",
  ##   [(store_mul,"$arena_win_amount", "$arena_bet_amount", "$_num_teams"),
  ##    (party_get_slot, ":player_odds", "$g_encountered_party", slot_town_player_odds),
  ##    (val_sub, "$arena_win_amount", "$arena_bet_amount"),
  ##    (val_mul, "$arena_win_amount", ":player_odds"),
  ##    (val_div, "$arena_win_amount", 1000),
  ##    (val_add, "$arena_win_amount", "$arena_bet_amount"),
  ##    (val_mul, "$arena_win_amount", 9),
  ##    (val_div, "$arena_win_amount", 10),
  ##    (assign, reg5, "$arena_win_amount"),
  ##    ]],
  ##
  ##  [anyone,"arena_master_start_fight", [], "Very well. The fight starts in a moment. Good luck.", "close_window",
  ##   [
  ##    (store_encountered_party,"$current_town"),
  ##    (party_get_slot, ":arena_scene","$current_town",slot_town_arena),
  ##    (modify_visitors_at_site,":arena_scene"),
  ##    (reset_visitors),
  ##
  ##    #Assemble participants
  ##    (assign, ":slot_no", 0),
  ##    (troop_set_slot, "trp_temp_array_a", ":slot_no", "trp_xerina"),
  ##    (val_add, ":slot_no", 1),
  ##    (troop_set_slot, "trp_temp_array_a", ":slot_no", "trp_dranton"),
  ##    (val_add, ":slot_no", 1),
  ##    (troop_set_slot, "trp_temp_array_a", ":slot_no", "trp_kradus"),
  ##    (val_add, ":slot_no", 1),
  ##    (try_for_range, reg(4), 0, 10),
  ##      (lt, ":slot_no", 48),
  ##      (troop_set_slot, "trp_temp_array_a", ":slot_no", "trp_regular_fighter"),
  ##      (val_add, ":slot_no", 1),
  ##    (try_end),
  ##    (try_for_range, reg(4), 0, 10),
  ##      (lt, ":slot_no", 48),
  ##      (troop_set_slot, "trp_temp_array_a", ":slot_no", "trp_veteran_fighter"),
  ##      (val_add, ":slot_no", 1),
  ##    (try_end),
  ##    (try_for_range, reg(4), 0, 10),
  ##      (lt, ":slot_no", 48),
  ##      (troop_set_slot, "trp_temp_array_a", ":slot_no", "trp_champion_fighter"),
  ##      (val_add, ":slot_no", 1),
  ##    (try_end),
  ##    (try_for_range, reg(4), 0, 5),
  ##      (lt, ":slot_no", 48),
  ##      (troop_set_slot, "trp_temp_array_a", ":slot_no", "trp_sword_sister"),
  ##      (val_add, ":slot_no", 1),
  ##    (try_end),
  ##    (try_for_range, reg(4), 0, 10),
  ##      (lt, ":slot_no", 48),
  ##      (troop_set_slot, "trp_temp_array_a", ":slot_no", "trp_hired_blade"),
  ##      (val_add, ":slot_no", 1),
  ##    (try_end),
  ##    (try_for_range, reg(4), 0, 10),
  ##      (lt, ":slot_no", 48),
  ##      (troop_set_slot, "trp_temp_array_a", ":slot_no", "trp_mercenary"),
  ##      (val_add, ":slot_no", 1),
  ##    (try_end),
  ##    (assign, "$pin_troop", "trp_temp_array_a"),
  ##    (call_script, "script_shuffle_troop_slots", 0, 48),
  ##
  ##    (try_for_range, reg(12), 0, 48),
  ##      (troop_set_slot, "trp_temp_array_b", reg(12),reg(12)), #Initialize temp_array_b such that temp_array_b[i] = i
  ##    (try_end),
  ##
  ##    (store_random_in_range, "$arena_player_team", 0, "$_num_teams"),
  ##    (try_for_range, ":i_team", 0, "$_num_teams"), # repeat for num_teams; reg(55) = cur_team
  ##      (assign, ":team_slots_start", ":i_team"),
  ##      (val_mul, ":team_slots_start", 8),
  ##      (assign, ":team_slots_end", ":team_slots_start"),
  ##      (val_add, ":team_slots_end", 8),
  ##      (assign, "$pin_troop", "trp_temp_array_b"),
  ##      (call_script, "script_shuffle_troop_slots", ":team_slots_start", ":team_slots_end"),
  ##      (assign, ":cur_slot", ":team_slots_start"),
  ##      (try_for_range, reg(6), 0, "$_team_size"), # repeat for team_size;
  ##        (troop_get_slot, ":cur_slot_troop", "trp_temp_array_a", ":cur_slot"),
  ##        (try_begin), #place player
  ##          (eq,"$arena_join_or_watch",0),
  ##          (eq, ":i_team", "$arena_player_team"),
  ##          (eq, reg(6), 0),
  ##          (assign, ":cur_slot_troop", "trp_player"),
  ##        (try_end),
  ##        (troop_get_slot, ":cur_entry_no", "trp_temp_array_b", ":cur_slot"),
  ##        (set_visitor,":cur_entry_no",":cur_slot_troop"),
  ##        (val_add, ":cur_slot", 1),
  ##      (try_end),
  ##    (try_end),
  ##
  ##    (try_begin),
  ##      (eq, "$arena_join_or_watch", 1),
  ##      (set_visitor, 33, "trp_player"),#entry point 51
  ##    (try_end),
  ##    (assign, "$arena_fight_won", 0),
  ##    (assign, "$arena_winner_team", -1),
  ##    (assign, "$waiting_for_arena_fight_result", 1),
  ##    (assign, "$g_mt_mode", abm_fight),
  ##    (party_get_slot, reg(6),"$current_town",slot_town_arena_melee_cur_tier),
  ##    (val_add,reg(6),1),
  ##    (val_mod,reg(6),3),
  ##    (party_set_slot, "$current_town",slot_town_arena_melee_cur_tier, reg(6)),
  ###    (set_jump_mission,"mt_arena_melee_fight"),
  ##    (party_get_slot, ":arena_mission_template", "$current_town", slot_town_arena_template),
  ##    (set_jump_mission, ":arena_mission_template"),
  ##    (party_get_slot, reg(7), "$current_town", slot_town_arena),
  ##    (jump_to_scene, reg(7)),
  ##    ]],
  
  
  
  
  
  
  
  
  
  
  
  ######################################################################################
  [trp_galeas,"start", [], "Hello {boy/girl}. If you have any prisoners, I will be happy to buy them from you.", "galeas_talk",[]],
  
  [trp_galeas|plyr,"galeas_talk",
    [[store_num_regular_prisoners,reg(0)],[ge,reg(0),1]],
    "Then you'd better bring your purse. I have got prisoners to sell.", "galeas_sell_prisoners",[]],
  [trp_galeas|plyr,"galeas_talk",[], "Not this time. Good-bye.", "close_window",[]],
  [trp_galeas,"galeas_sell_prisoners", [],
    "Let me see what you have...", "galeas_sell_prisoners_2",
    [[change_screen_trade_prisoners]]],
  [trp_galeas, "galeas_sell_prisoners_2", [], "You take more prisoners, bring them to me. I will pay well.", "close_window",[]],
  
  ##  [party_tpl|pt_refugees,"start", [], "We have been driven out of our homes because of this war.", "close_window",[(assign, "$g_leave_encounter",1)]],
  ##  [party_tpl|pt_farmers,"start", [], "We are just simple farmers.", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  
  # Random Quest related conversations
  #  [trp_nobleman, "start", [],
  #   "Who are you? What do you want? Be warned, we are fully armed and more than capable to defend ourselves. Go to your way now or you will regret it.", "nobleman_talk_1",
  #   [(play_sound,"snd_encounter_nobleman")]],
  #  [trp_nobleman|plyr, "nobleman_talk_1", [],
  #   "I demand that you surrender to me.", "nobleman_talk_2",[]],
  #  [trp_nobleman|plyr, "nobleman_talk_1", [],
  #   "I am sorry sir. You may go.", "close_window",[(assign, "$g_leave_encounter",1)]],
  #  [trp_nobleman, "nobleman_talk_2", [],
  #   "Surrender to a puny peasant like you? Hah. Not likely.", "close_window",[[encounter_attack]]],
  #
  #  [trp_nobleman,"enemy_defeated", [], "Parley! I am of noble birth, and I ask for my right to surrender.", "nobleman_defeated_1",[]],
  #  [trp_nobleman|plyr,"nobleman_defeated_1", [], "And I will grant you that. If you can be ransomed of course...", "nobleman_defeated_2",[]],
  #  [trp_nobleman,"nobleman_defeated_2", [], "Oh, you need not worry about that. My family would pay a large ransom for me.", "nobleman_defeated_3",[]],
  #  [trp_nobleman|plyr,"nobleman_defeated_3", [[str_store_troop_name,1,"$nobleman_quest_giver"]], "Hmm. {s1} will be happy about this... Then you are my prisoner.", "close_window",
  #   [[assign,"$nobleman_quest_succeeded",1],[assign,"$nobleman_quest_nobleman_active",0]]],
  
  # Prisoner Trains
  ##  [anyone,"start", [(eq,"$g_encountered_party_type",spt_prisoner_train)],
  ##   "What do you want?", "prisoner_train_talk",[]],
  ##
  ##  [anyone|plyr,"prisoner_train_talk", [],
  ##   "Set those prisoners free now!", "prisoner_train_talk_ultimatum",[]],
  ##  [anyone,"prisoner_train_talk_ultimatum", [],
  ##   "Or what? Are you going to attack us?", "prisoner_train_talk_ultimatum_2",[]],
  ##  [anyone|plyr,"prisoner_train_talk_ultimatum_2", [],
  ##   "Yes I will. Consider yourself warned!", "prisoner_train_talk_ultimatum_2a",[]],
  ##  [anyone,"prisoner_train_talk_ultimatum_2a", [],
  ##   "We'll see that.", "close_window",[
  ##    (call_script, "script_make_kingdom_hostile_to_player", "$g_encountered_party_faction", -3),
  ##    ]],
  ##
  ##  [anyone|plyr,"prisoner_train_talk_ultimatum_2", [],
  ##   "Attack you? Hell no! I just took pity on those poor souls.", "prisoner_train_talk_ultimatum_2b",[]],
  ##  [anyone,"prisoner_train_talk_ultimatum_2b", [],
  ##   "Find something else to take pity on.", "close_window",[(assign, "$g_leave_encounter",1)]],
  ##  [anyone|plyr,"prisoner_train_talk", [],
  ##   "Better watch those prisoners well. They may try to run away.", "prisoner_train_smalltalk",[]],
  ##  [anyone,"prisoner_train_smalltalk", [],
  ##   "Don't worry. They aren't going anywhere.", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  
  
  ##  [anyone,"start", [(eq, "$g_encountered_party_type", spt_forager), (is_between, "$g_encountered_party_relation", -9, 1)],
  ##   "Hold it right there. Who are you?", "soldiers_interrogation",[(play_sound,"snd_encounter_vaegirs_neutral")]],
  ##  [anyone,"start", [(eq, "$g_encountered_party_type", spt_forager), (le, "$g_encountered_party_relation", -10)],
  ##   "You will not survive this!", "close_window",
  ##   [(store_relation, reg(5),"$g_encountered_party_faction"), (val_sub,reg(5),1), (set_relation,"$g_encountered_party_faction",0,reg(5)),(encounter_attack,0)]],
  ##  [anyone,"start", [(eq, "$g_encountered_party_type", spt_forager),(ge, "$g_encountered_party_relation", 1)],
  ##   "Our lands have been invaded. But we will drive them back.", "close_window",[(assign, "$g_leave_encounter",1),(play_sound,"snd_encounter_vaegirs_ally"),]],
  ##
  ##  [anyone,"start", [(eq, "$g_encountered_party_type", spt_scout),(is_between, "$g_encountered_party_relation", -9, 1)],
  ##   "Hold it right there. Who are you?", "soldiers_interrogation",[]],
  ##  [anyone,"start", [(eq, "$g_encountered_party_type", spt_scout),(le, "$g_encountered_party_relation", -10)],
  ##   "You deserve to die a thousand deaths!", "close_window",
  ##   [(store_relation, reg(5),"$g_encountered_party_faction"), (val_sub,reg(5),2), (set_relation,"$g_encountered_party_faction",0,reg(5)),(encounter_attack,0)]],
  ##  [anyone,"start", [(eq, "$g_encountered_party_type", spt_scout),(ge, "$g_encountered_party_relation", 1)],
  ##   "Venture deep into the enemy territory and find myself a caravan to raid. That's the way I will get rich.", "close_window",[(assign, "$g_leave_encounter",1)]],
  ##
  ##  [anyone,"start", [(this_or_next|eq, "$g_encountered_party_type", spt_patrol),(eq, "$g_encountered_party_type", spt_war_party),(is_between, "$g_encountered_party_relation", -9, 1)],
  ##   "Hold it right there. Who are you?", "soldiers_interrogation",[]],
  ##  [anyone,"start", [(this_or_next|eq, "$g_encountered_party_type", spt_patrol),(eq, "$g_encountered_party_type", spt_war_party),(le, "$g_encountered_party_relation", -10)],
  ##   "You will not survive this!", "close_window",
  ##   [(store_relation, reg(5),"$g_encountered_party_type"), (val_sub,reg(5),3), (set_relation,"$g_encountered_party_type",0,reg(5)),(encounter_attack,0)]],
  ##  [anyone,"start", [(this_or_next|eq, "$g_encountered_party_type", spt_patrol),(eq, "$g_encountered_party_type", spt_war_party),(ge, "$g_encountered_party_relation", 1)],
  ##   "Sooner or later, friend. Victory will belong to us.", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  #swadian parties
  ##  [anyone|plyr,"soldiers_interrogation", [], "I am {playername}.", "soldiers_interrogation_2",[]],
  ##  [anyone,"soldiers_interrogation_2", [], "What are you doing here?", "soldiers_interrogation_3",[]],
  ##  [anyone|plyr,"soldiers_interrogation_3", [], "I am carrying some merchandise.", "soldiers_interrogation_4",[]],
  ##  [anyone|plyr,"soldiers_interrogation_3", [], "I am just admiring the sights.", "soldiers_interrogation_4",[]],
  ##  [anyone,"soldiers_interrogation_4", [], "Hmm. All right. You may go now. But be careful. There is a war going on. The roads are not safe for travellers.", "close_window",[(assign, "$g_leave_encounter",1)]],
  
  
  
  
  
  # Bandits
  ##  [party_tpl|pt_mountain_bandits,"start", [(this_or_next|eq, "$g_encountered_party_template", "pt_mountain_bandits"),(eq, "$g_encountered_party_template", "pt_forest_bandits"),
  ##                                           (eq,"$talk_context",tc_party_encounter),
  ##                                           (party_get_slot,":protected_until_hours", "$g_encountered_party",slot_party_ignore_player_until),
  ##                                           (store_current_hours,":cur_hours"),
  ##                                           (store_sub, ":protection_remaining",":protected_until_hours",":cur_hours"),
  ##                                           (ge, ":protection_remaining", 0)], "What do you want?\
  ## You want to pay us some more money?", "bandit_paid_talk",[]],
  ##
  ##  [anyone|plyr,"bandit_paid_talk", [], "Sorry to trouble you. I'll be on my way now.", "bandit_paid_talk_2a",[]],
  ##  [anyone,"bandit_paid_talk_2a", [], "Yeah. Stop fooling around and go make some money.\
  ## I want to see that purse full next time I see you.", "close_window",[(assign, "$g_leave_encounter",1)]],
  ##  [anyone|plyr,"bandit_paid_talk", [], "No. It's your turn to pay me this time.", "bandit_paid_talk_2b",[]],
  ##  [anyone,"bandit_paid_talk_2b", [], "What nonsense are you talking about? You want trouble? You got it.", "close_window",[
  ##       (party_set_slot,"$g_encountered_party",slot_party_ignore_player_until,0),
  ##       (party_ignore_player, "$g_encountered_party", 0),
  ##    ]],
  
  # Ryan BEGIN
  [party_tpl|pt_mountain_bandits|auto_proceed,"start", [(eq,"$talk_context",tc_party_encounter),(encountered_party_is_attacker)],
    "{!}Warning: This line should never display.", "bandit_introduce",[]],
  [party_tpl|pt_forest_bandits|auto_proceed,"start", [(eq,"$talk_context",tc_party_encounter),(encountered_party_is_attacker)],
    "{!}Warning: This line should never display.", "bandit_introduce",[]],
  [party_tpl|pt_taiga_bandits|auto_proceed,"start", [(eq,"$talk_context",tc_party_encounter),(encountered_party_is_attacker)],
    "{!}Warning: This line should never display.", "bandit_introduce",[]],
  [party_tpl|pt_steppe_bandits|auto_proceed,"start", [(eq,"$talk_context",tc_party_encounter),(encountered_party_is_attacker)],
    "{!}Warning: This line should never display.", "bandit_introduce",[]],
  [party_tpl|pt_desert_bandits|auto_proceed,"start", [(eq,"$talk_context",tc_party_encounter),(encountered_party_is_attacker)],
    "{!}Warning: This line should never display.", "bandit_introduce",[]],
  
  
  [anyone,"bandit_introduce", [
      (store_random_in_range, ":rand", 11, 15),
      (str_store_string, s11, "@I can smell a fat purse a mile away. Methinks yours could do with some lightening, eh?"),
      (str_store_string, s12, "@Why, it be another traveller, chance met upon the road! I should warn you, country here's a mite dangerous for a good {fellow/woman} like you. But for a small donation my boys and I'll make sure you get rightways to your destination, eh?"),
      (str_store_string, s13, "@Well well, look at this! You'd best start coughing up some silver, friend, or me and my boys'll have to break you."),
      (str_store_string, s14, "@There's a toll for passin' through this land, payable to us, so if you don't mind we'll just be collectin' our due from your purse..."),
      (str_store_string_reg, s5, ":rand"),
      ], "{s5}", "bandit_talk",[(play_sound,"snd_encounter_bandits")]],
  
  [anyone|plyr,"bandit_talk", [], "I'll give you nothing but cold steel, you scum!", "close_window",[[encounter_attack]]],
  [anyone|plyr,"bandit_talk", [], "There's no need to fight. I can pay for free passage.", "bandit_barter",[]],
  [anyone,"bandit_barter",
    [(store_relation, ":bandit_relation", "fac_player_faction", "$g_encountered_party_faction"),
      (ge, ":bandit_relation", -50),
      (store_troop_gold, ":total_value", "trp_player"),
      (troop_get_inventory_capacity, ":inv_size", "trp_player"),
      (try_for_range, ":i_slot", 0, ":inv_size"),
        (troop_get_inventory_slot, ":item_id", "trp_player", ":i_slot"),
        (ge, ":item_id", 0),
        (try_begin),
          (is_between, ":item_id", trade_goods_begin, trade_goods_end),
          (store_item_value, ":item_value", ":item_id"),
          (val_add, ":total_value", ":item_value"),
        (try_end),
      (try_end),
      (store_div, "$bandit_tribute", ":total_value", 10), #10000 gold = excellent_target
      (val_max, "$bandit_tribute", 10),
      (assign, reg5, "$bandit_tribute")
      ], "Silver without blood, that's our favourite kind! Hmm, having a look at you, I reckon you could easily come up with {reg5} denars. Pay it, and we'll let you be on your way.", "bandit_barter_2",[]],
  [anyone|plyr,"bandit_barter_2", [[store_troop_gold,reg(2)],[ge,reg(2),"$bandit_tribute"],[assign,reg(5),"$bandit_tribute"]],
    "Very well, take it.", "bandit_barter_3a",[[troop_remove_gold, "trp_player","$bandit_tribute"]]],
  [anyone|plyr,"bandit_barter_2", [],
    "I don't have that much money with me", "bandit_barter_3b",[]],
  [anyone,"bandit_barter_3b", [],
    "That's too bad. I guess we'll just have to sell you into slavery. Take {him/her}, lads!", "close_window",[[encounter_attack]]],
  
  [anyone,"bandit_barter", [],
    "Hey, I've heard of you! You slaughter us freebooters like dogs, and now you expect us to let you go for a few stinking coins? " +
    "Forget it. You gave us no quarter, and you'll get none from us.", "close_window",[]],
  
  
  
  [anyone,"bandit_barter_3a", [], "Heh, that wasn't so hard, was it? All right, we'll let you go now. Be off.", "close_window",[
      (store_current_hours,":protected_until"),
      (val_add, ":protected_until", 72),
      (party_set_slot,"$g_encountered_party",slot_party_ignore_player_until,":protected_until"),
      (party_ignore_player, "$g_encountered_party", 72),
      (assign, "$g_leave_encounter",1)
  ]],
  
  
  [anyone,"start", [(this_or_next|eq, "$g_encountered_party_template", "pt_mountain_bandits"),(eq, "$g_encountered_party_template", "pt_forest_bandits")],
    "Eh? What is it?", "bandit_meet",[]],
  
  [anyone|plyr,"bandit_meet", [], "Your luck has run out, wretch. Prepare to die!", "bandit_attack",
    [(store_relation, ":bandit_relation", "fac_player_faction", "$g_encountered_party_faction"),
      (val_sub, ":bandit_relation", 3),
      (val_max, ":bandit_relation", -100),
      (set_relation, "fac_player_faction", "$g_encountered_party_faction", ":bandit_relation"),
      (party_ignore_player, "$g_encountered_party", 0),
      (party_set_slot,"$g_encountered_party",slot_party_ignore_player_until, 0),
  ]],
  
  [anyone,"bandit_attack", [
      (store_random_in_range, ":rand", 11, 15),
      (str_store_string, s11, "@Another fool come to throw {him/her}self on my weapon, eh? Fine, let's fight!"),
      (str_store_string, s12, "@We're not afraid of you, {sirrah/wench}. Time to bust some heads!"),
      (str_store_string, s13, "@That was a mistake. Now I'm going to have to make your death long and painful."),
      (str_store_string, s14, "@Brave words. Let's see you back them up with deeds, cur!"),
      (str_store_string_reg, s5, ":rand"),
      ], "{s5}", "close_window",[]],
  
  [anyone|plyr,"bandit_meet", [], "Never mind, I have no business with you.", "close_window",[(assign, "$g_leave_encounter", 1)]],
  # Ryan END
  
  
  
  [party_tpl|pt_rescued_prisoners,"start", [(eq,"$talk_context",tc_party_encounter)], "Do you want us to follow you?", "disbanded_troop_ask",[]],
  [anyone|plyr,"disbanded_troop_ask", [], "Yes. Let us ride together.", "disbanded_troop_join",[]],
  [anyone|plyr,"disbanded_troop_ask", [], "No. Not at this time.", "close_window",[(assign, "$g_leave_encounter",1)]],
  [anyone,"disbanded_troop_join", [[neg|party_can_join]], "Unfortunately. You do not have room in your party for us.", "close_window",[(assign, "$g_leave_encounter",1)]],
  [anyone,"disbanded_troop_join", [], "We are at your command.", "close_window",[[party_join],(assign, "$g_leave_encounter",1)]],
  
  [party_tpl|pt_enemy,"start", [(eq,"$talk_context",tc_party_encounter)], "You will not capture me again. Not this time.", "enemy_talk_1",[]],
  [party_tpl|pt_enemy|plyr,"enemy_talk_1", [], "You don't have a chance against me. Give up.", "enemy_talk_2",[]],
  [party_tpl|pt_enemy,"enemy_talk_2", [], "I will give up when you are dead!", "close_window",[[encounter_attack]]],
  
  
  ######################################
  # ROUTED WARRIORS
  ######################################
  
  [party_tpl|pt_routed_warriors, "start", [(eq,"$talk_context",tc_party_encounter)],
    "I beg you, please leave us alone.", "party_encounter_routed_agents_are_caught",
    []],
  
  [party_tpl|pt_routed_warriors|plyr, "party_encounter_routed_agents_are_caught", [],
    "Do you think you can run away from me? You will be my prisoner or die!", "party_encounter_routed_agents_are_caught2",
    []],
  
  [party_tpl|pt_routed_warriors|plyr,"party_encounter_routed_agents_are_caught", [],
    "Ok. We'll leave you in peace for this time, do not face with us again.", "close_window", [(assign, "$g_leave_encounter",1)]],
  
  [party_tpl|pt_routed_warriors, "party_encounter_routed_agents_are_caught2",
    [
      #(store_party_size_wo_prisoners, ":routed_party_size", "$g_encountered_party"),
      #(store_party_size_wo_prisoners, ":main_party_size", "p_main_party"),
      
      # calculate power of routed party
      (assign, ":routed_party_power", 0),
      (party_get_num_companion_stacks, ":num_stacks", "$g_encountered_party"),
      (try_for_range, ":i_stack", 0, ":num_stacks"),
        (party_stack_get_troop_id, ":stack_troop", "$g_encountered_party", ":i_stack"),
        (store_character_level, ":troop_level", ":stack_troop"),
        (try_begin),
          (troop_is_mounted, ":stack_troop"),
          (val_add, ":troop_level", 5),
        (try_end),
        (party_stack_get_size, ":stack_size", "$g_encountered_party", ":i_stack"),
        (val_mul, ":troop_level", ":stack_size"),
        (val_add, ":routed_party_power", ":troop_level"),
      (try_end),
      
      # calculate power of our party
      (assign, ":main_party_power", 0),
      (party_get_num_companion_stacks, ":num_stacks", "p_main_party"),
      (try_for_range, ":i_stack", 0, ":num_stacks"),
        (party_stack_get_troop_id, ":stack_troop", "p_main_party", ":i_stack"),
        (store_character_level, ":troop_level", ":stack_troop"),
        (try_begin),
          (troop_is_mounted, ":stack_troop"),
          (val_add, ":troop_level", 5),
        (try_end),
        (party_stack_get_size, ":stack_size", "p_main_party", ":i_stack"),
        (val_mul, ":troop_level", ":stack_size"),
        (val_add, ":main_party_power", ":troop_level"),
      (try_end),
      
      (store_div, ":main_party_power_divided_by_5", ":main_party_power", 5),
      
      #find num attached parties to routed warriors
      (party_get_num_attached_parties, ":num_attached_parties", "$g_encountered_party"),
      
      (this_or_next|gt, ":num_attached_parties", 0), #always fight
      (ge, ":routed_party_power", ":main_party_power_divided_by_5"),
    ],
    "Haven't you got any mercy? Ok, we will fight you to the last man!", "close_window",
    []],
  
  [party_tpl|pt_routed_warriors, "party_encounter_routed_agents_are_caught2",
    [
      #(store_party_size_wo_prisoners, ":routed_party_size", "$g_encountered_party"),
      #(store_party_size_wo_prisoners, ":main_party_size", "p_main_party"),
      
      # calculate power of routed party
      (assign, ":routed_party_population", 0),
      (assign, ":routed_party_power", 0),
      (party_get_num_companion_stacks, ":num_stacks", "$g_encountered_party"),
      (try_for_range, ":i_stack", 0, ":num_stacks"),
        (party_stack_get_troop_id, ":stack_troop", "$g_encountered_party", ":i_stack"),
        (store_character_level, ":troop_level", ":stack_troop"),
        (try_begin),
          (troop_is_mounted, ":stack_troop"),
          (val_add, ":troop_level", 5),
        (try_end),
        (party_stack_get_size, ":stack_size", "$g_encountered_party", ":i_stack"),
        (val_mul, ":troop_level", ":stack_size"),
        (val_add, ":routed_party_power", ":troop_level"),
        (val_add, ":routed_party_population", ":stack_size"),
      (try_end),
      
      # calculate power of our party
      (assign, ":main_party_power", 0),
      (party_get_num_companion_stacks, ":num_stacks", "p_main_party"),
      (try_for_range, ":i_stack", 0, ":num_stacks"),
        (party_stack_get_troop_id, ":stack_troop", "p_main_party", ":i_stack"),
        (store_character_level, ":troop_level", ":stack_troop"),
        (try_begin),
          (troop_is_mounted, ":stack_troop"),
          (val_add, ":troop_level", 5),
        (try_end),
        (party_stack_get_size, ":stack_size", "p_main_party", ":i_stack"),
        (val_mul, ":troop_level", ":stack_size"),
        (val_add, ":main_party_power", ":troop_level"),
      (try_end),
      
      (store_div, ":main_party_power_divided_by_5", ":main_party_power", 5),
      (lt, ":routed_party_power", ":main_party_power_divided_by_5"),
      
      (store_party_size_wo_prisoners, ":routed_party_size", "$g_encountered_party"),
      (assign, reg3, ":routed_party_size"),
      
      (try_begin),
        (gt, ":routed_party_population", 1),
        (str_store_string, s1, "str_we_resign"),
      (else_try),
        (str_store_string, s1, "str_i_resign"),
      (try_end),
    ],
    "{s1}", "close_window",
    [(assign,"$g_enemy_surrenders", 1),
      (call_script, "script_party_wound_all_members", "$g_encountered_party"),
      (call_script, "script_party_copy", "p_total_enemy_casualties", "$g_encountered_party"),
      #(change_screen_exchange_with_party, "$g_encountered_party"),
  ]],
  
  #[party_tpl|pt_routed_warriors,"close_window_anythink_else", [],
  # "Anythink else.", "close_window", [(assign, "$g_leave_encounter",1)]],
  
  
  # Ryan BEGIN
  [anyone,"sell_prisoner_outlaws", [[store_troop_kind_count,0,"trp_looter"],[ge,reg(0),1],[assign,reg(1),reg(0)],[val_mul,reg(1),10],[val_mul,reg(2),reg(0)],[val_mul,reg(2),10]],
    "Hmmm. 10 denars for each looter makes {reg1} denars for all {reg0} of them.", "sell_prisoner_outlaws",
    [[call_script, "script_troop_add_gold", "trp_player", reg(1)],[add_xp_to_troop,reg(2)],[remove_member_from_party,"trp_looter"]]],
  [anyone,"sell_prisoner_outlaws", [[store_troop_kind_count,0,"trp_bandit"],[ge,reg(0),1],[assign,reg(1),reg(0)],[val_mul,reg(1),20],[assign,reg(2),reg(0)],[val_mul,reg(2),20]],
    "Let me see. You've brought {reg0} bandits, so 20 denars for each comes up to {reg1} denars.", "sell_prisoner_outlaws",
    [[call_script, "script_troop_add_gold", "trp_player", reg(1)],[add_xp_to_troop,reg(2)],[remove_member_from_party,"trp_bandit"]]],
  [anyone,"sell_prisoner_outlaws", [[store_troop_kind_count,0,"trp_brigand"],[ge,reg(0),1],[assign,reg(1),reg(0)],[val_mul,reg(1),30],[assign,reg(2),reg(0)],[val_mul,reg(2),30]],
    "Well well, you've captured {reg0} brigands. Each one is worth 30 denars, so I'll give you {reg1} for them in total.", "sell_prisoner_outlaws",
    [[call_script, "script_troop_add_gold", "trp_player", reg(1)],[add_xp_to_troop,reg(2)],[remove_member_from_party,"trp_brigand"]]],
  [anyone,"sell_prisoner_outlaws", [], "I suppose that'll be all, then.", "sell_prisoner_outlaws_finished",[]],
  # Ryan END
  
  [anyone|plyr,"prisoner_chat", [], "Do not try running away or trying something stupid. I will be watching you.", "prisoner_chat_2",[]],
  [anyone,"prisoner_chat_2", [], "No, I swear I won't.", "close_window",[]],
  
  
  [anyone,"start", [(party_slot_eq, "$current_town", slot_town_lord, "trp_player"),
      (this_or_next|is_between,"$g_talk_troop",weapon_merchants_begin,weapon_merchants_end),
      (this_or_next|is_between,"$g_talk_troop",armor_merchants_begin, armor_merchants_end),
      (             is_between,"$g_talk_troop",horse_merchants_begin, horse_merchants_end),
    ],
    "Greetings, {your lordship/my lady}. How can I serve you today?", "town_merchant_talk",[]],
  
  [anyone,"start", [(this_or_next|is_between,"$g_talk_troop",weapon_merchants_begin,weapon_merchants_end),
      (this_or_next|is_between,"$g_talk_troop",armor_merchants_begin, armor_merchants_end),
      (             is_between,"$g_talk_troop",horse_merchants_begin, horse_merchants_end)], "Good day. What can I do for you?", "town_merchant_talk",[]],
  
  [anyone|plyr,"town_merchant_talk", [(is_between,"$g_talk_troop",weapon_merchants_begin,weapon_merchants_end)],
    "I want to buy a new weapon. Show me your wares.", "trade_requested_weapons",[]],
  [anyone|plyr,"town_merchant_talk", [(is_between,"$g_talk_troop",armor_merchants_begin,armor_merchants_end)],
    "I am looking for some equipment. Show me what you have.", "trade_requested_armor",[]],
  [anyone|plyr,"town_merchant_talk", [(is_between,"$g_talk_troop",horse_merchants_begin,horse_merchants_end)],
    "I am thinking of buying a horse.", "trade_requested_horse",[]],
  
  
  
  [anyone|plyr,"town_merchant_talk",
    [
      (is_between,"$g_talk_troop",horse_merchants_begin,horse_merchants_end),
      (player_has_item, "itm_cheval_praire"),
    ],
    "Je voudrais barder mon cheval, combien cela va t'il me coutter je vous prie ?", "barder_mon_cheval",[]],
  [anyone,"barder_mon_cheval", [], "500 pieces pour une bache épaisse et solide, vous la prennez ?", "barder_mon_cheval2",[]],
  
  [anyone|plyr,"barder_mon_cheval2",
    [
      (store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", 500),
    ],
    "Oui je la prend, installez la vous meme je vous prie.", "barder_mon_cheval3",
    [
      (troop_remove_gold,"trp_player",500),
      (troop_remove_item, "trp_player","itm_cheval_praire"),
      (troop_add_item, "trp_player", "itm_cheval_praire_barder", 0),
  ]],
  
  [anyone|plyr,"barder_mon_cheval2", [], "Je crains de ne pas avoir l'argent mais je reviendrais.", "merchant_trade",[]],
  
  
  [anyone,"barder_mon_cheval3", [], "Pas de probleme, voila. c'est un plaisir de faire affaire avec vous.", "close_window",[]],
  
  
  
  
  
  
  [anyone,"trade_requested_weapons", [], "Ah, yes {sir/madam}. These arms are the best you'll find anywhere.", "merchant_trade",[[change_screen_trade]]],
  [anyone,"trade_requested_armor", [], "Of course, {sir/madam}. You won't find better quality armour than these in all Europe.", "merchant_trade",[[change_screen_trade]]],
  [anyone,"trade_requested_horse", [], "You have a fine eye for horses, {sir/madam}. You won't find better beasts than these anywhere else.", "merchant_trade",[[change_screen_trade]]],
  
  
  [anyone,"merchant_trade", [], "Anything else?", "town_merchant_talk",[]],
  [anyone|plyr,"town_merchant_talk", [], "Tell me. What are people talking about these days?", "merchant_gossip",[]],
  [anyone,"merchant_gossip", [], "Well, nothing new lately. Prices, weather, the war, the same old things.", "town_merchant_talk",[]],
  [anyone|plyr,"town_merchant_talk", [], "Good-bye.", "close_window",[]],
  
  
  
  
  ##  [anyone,"start", [(eq, "$talk_context", 0),
  ##                    (is_between,"$g_talk_troop",walkers_begin, walkers_end),
  ##                    (eq, "$sneaked_into_town",1),
  ##                     ], "Stay away beggar!", "close_window",[]],
  
  
  
  
  
  
  
  #### 1429 steel edition edition acier dials town walkers
  
  ##dials town walker village entree foret broceliand
  [anyone,"start", [(eq, "$talk_context", 0),
      (eq, "$dial_town_walker_entree_foret", 1),
      (is_between,"$g_talk_troop",walkers_begin, walkers_end),
      ], "Messire ? est vous perdu ?", "dial_broce_entv_start",[]],
  
  [anyone|plyr,"dial_broce_entv_start", [], "Pouvez vous me parler de cette foret ?", "dial_broce_entv_start2",[]],
  [anyone|plyr,"dial_broce_entv_start", [], "Je doit vous quitter.", "close_window",[]],
  
  [anyone,"dial_broce_entv_start2", [], "C'est la foret de Lorges messire, on dit beaucoup de choses sur elle, n'y allez point seul mon bon messire, vous risqueriez de vous y perdre ou de tomber sur des brigands ou pire sur la bete.", "dial_broce_entv_start3",[]],
  
  [anyone,"dial_broce_entv_start3", [], "Je ne peut vous en parler, cela porte malheur, adieu.", "close_window",[]],
  
  
  
  ##dials town walker foret village broceliand
  [anyone,"start", [(eq, "$talk_context", 0),
      (eq, "$dial_town_walker_foret", 1),
      (is_between,"$g_talk_troop",walkers_begin, walkers_end),
      ], "Messire ? que vennez vous faire dans ce village perdu ?", "dial_broce_village_start",[]],
  
  [anyone|plyr,"dial_broce_village_start", [], "Que se passse t'il ici ?", "dial_broce_village_start2",[]],
  [anyone|plyr,"dial_broce_village_start", [], "Je ne voullais pas vous déranger.", "close_window",[]],
  
  [anyone,"dial_broce_village_start2", [], "Je ne peut rien dire, allez voir l'echanson a l'auberge.", "close_window",[]],
  
  
  ##
  
  
  [anyone,"start", [(eq, "$talk_context", 0),
      (eq, "$entre_auberg", 1),
      (is_between,"$g_talk_troop",walkers_begin, walkers_end),
      ], "Mon seigneur ?", "rep_player_auberge",[]],
  [anyone|plyr,"rep_player_auberge", [], "Je ne voullais pas vous déranger.", "close_window",[]],
  
  #### edition acier dials town walkers end
  
  [anyone,"start", [(eq, "$talk_context", 0),
      (is_between,"$g_talk_troop",walkers_begin, walkers_end),
      (party_slot_eq, "$current_town", slot_town_lord, "trp_player"),
      ], "My {lord/lady}?", "town_dweller_talk",[(assign, "$welfare_inquired",0),(assign, "$rumors_inquired",0),(assign, "$info_inquired",0)]],
  
  [anyone,"start", [(eq, "$talk_context", 0),
      (is_between,"$g_talk_troop",walkers_begin, walkers_end),
      ], "Good day, {sir/madam}.", "town_dweller_talk",[(assign, "$welfare_inquired", 0),(assign, "$rumors_inquired",0),(assign, "$info_inquired",0)]],
  
  [anyone|plyr,"town_dweller_talk", [(check_quest_active, "qst_hunt_down_fugitive"),
      (neg|check_quest_concluded, "qst_hunt_down_fugitive"),
      (quest_slot_eq, "qst_hunt_down_fugitive", slot_quest_target_center, "$current_town"),
      (quest_get_slot, ":quest_target_dna", "qst_hunt_down_fugitive", slot_quest_target_dna),
      (call_script, "script_get_name_from_dna_to_s50", ":quest_target_dna"),
      (str_store_string, s4, s50),
    ],
    "I am looking for a man by the name of {s4}. I was told he may be hiding here.", "town_dweller_ask_fugitive",[]],
  [anyone ,"town_dweller_ask_fugitive", [],
    "Strangers come and go to our village, {sir/madam}. If he is hiding here, you will surely find him if you look around.", "close_window",[]],
  
  # Ryan BEGIN
  [anyone|plyr,"town_dweller_talk",
    [
      (eq, 1, 0),
      (check_quest_active, "qst_meet_spy_in_enemy_town"),
      (neg|check_quest_succeeded, "qst_meet_spy_in_enemy_town"),
      (quest_slot_eq, "qst_meet_spy_in_enemy_town", slot_quest_target_center, "$current_town"),
      (str_store_item_name,s5,"$spy_item_worn"),
    ],
    "Pardon me, but is that a {s5} you're wearing?", "town_dweller_quest_meet_spy_in_enemy_town_ask_item",
    [
  ]],
  [anyone, "town_dweller_quest_meet_spy_in_enemy_town_ask_item", [
      (str_store_item_name,s5,"$spy_item_worn"),
      
      (try_begin),
        (troop_has_item_equipped,"$g_talk_troop","$spy_item_worn"),
        (str_store_string,s6,"@A {s5}? Well... Yes, I suppose it is. What a strange thing to ask."),
      (else_try),
        (str_store_string,s6,"@Eh? No, it most certainly is not a {s5}. I'd start questioning my eyesight if I were you."),
      (try_end),
    ],
    "{s6}", "town_dweller_talk",[]],
  
  [anyone|plyr|repeat_for_100,"town_dweller_talk",
    [
      (store_repeat_object,":object"),
      (lt,":object",4), # repeat only 4 times
      
      (check_quest_active, "qst_meet_spy_in_enemy_town"),
      (neg|check_quest_succeeded, "qst_meet_spy_in_enemy_town"),
      (quest_slot_eq, "qst_meet_spy_in_enemy_town", slot_quest_target_center, "$current_town"),
      
      (store_add,":string",":object","str_secret_sign_1"),
      (str_store_string, s4, ":string"),
    ],
    "{s4}", "town_dweller_quest_meet_spy_in_enemy_town",
    [
      (store_repeat_object,":object"),
      (assign, "$temp", ":object"),
  ]],
  
  [anyone ,"town_dweller_quest_meet_spy_in_enemy_town",
    [
      (call_script, "script_agent_get_town_walker_details", "$g_talk_agent"),
      (assign, ":walker_type", reg0),
      (eq, ":walker_type", walkert_spy),
      (quest_get_slot, ":secret_sign", "qst_meet_spy_in_enemy_town", slot_quest_target_amount),
      (val_sub, ":secret_sign", secret_signs_begin),
      (eq, ":secret_sign", "$temp"),
      (store_add, ":countersign", ":secret_sign", countersigns_begin),
      (str_store_string, s4, ":countersign"),
    ],
    "{s4}", "town_dweller_quest_meet_spy_in_enemy_town_know",[]],
  
  [anyone, "town_dweller_quest_meet_spy_in_enemy_town", [],
    "Eh? What kind of gibberish is that?", "town_dweller_quest_meet_spy_in_enemy_town_dont_know",[]],
  
  [anyone|plyr, "town_dweller_quest_meet_spy_in_enemy_town_dont_know", [],
    "Never mind.", "close_window",[]],
  
  [anyone|plyr, "town_dweller_quest_meet_spy_in_enemy_town_know", [
      (quest_get_slot, ":quest_giver", "qst_meet_spy_in_enemy_town", slot_quest_giver_troop),
      (str_store_troop_name, s4, ":quest_giver"),
    ],
    "{s4} sent me to collect your reports. Do you have them with you?", "town_dweller_quest_meet_spy_in_enemy_town_chat",[]],
  
  [anyone, "town_dweller_quest_meet_spy_in_enemy_town_chat", [
      (quest_get_slot, ":quest_giver", "qst_meet_spy_in_enemy_town", slot_quest_giver_troop),
      (str_store_troop_name, s4, ":quest_giver"),
    ],
    "I've been expecting you. Here they are, make sure they reach {s4} intact and without delay.", "town_dweller_quest_meet_spy_in_enemy_town_chat_2",[
      (call_script, "script_succeed_quest", "qst_meet_spy_in_enemy_town"),
      (call_script, "script_center_remove_walker_type_from_walkers", "$current_town", walkert_spy),
  ]],
  
  [anyone|plyr, "town_dweller_quest_meet_spy_in_enemy_town_chat_2", [],
    "Farewell.", "close_window",
    [
  ]],
  # Ryan END
  
  [anyone|plyr,"town_dweller_talk", [(party_slot_eq, "$current_town", slot_party_type, spt_village),
      (eq, "$info_inquired", 0)], "What can you tell me about this village?", "town_dweller_ask_info",[(assign, "$info_inquired", 1)]],
  [anyone|plyr,"town_dweller_talk", [(party_slot_eq, "$current_town", slot_party_type, spt_town),
      (eq, "$info_inquired", 0)], "What can you tell me about this town?", "town_dweller_ask_info",[(assign, "$info_inquired", 1)]],
  
  
  [anyone,"town_dweller_ask_info", [(str_store_party_name, s5, "$current_town"),
      (assign, reg4, 0),
      (try_begin),
        (party_slot_eq, "$current_town", slot_party_type, spt_town),
        (assign, reg4, 1),
      (try_end),
      (str_store_string, s6, "@This is the {reg4?town:village} of {s5}, {sir/madam}."),
      (str_clear, s10),
      (try_begin),
        (party_slot_eq, "$current_town", slot_town_lord, "trp_player"),
        (str_store_string, s10, "@{s6} Our {reg4?town:village} and the surrounding lands belong to you of course, my {lord/lady}."),
      (else_try),
        (party_get_slot, ":town_lord", "$current_town", slot_town_lord),
        (ge, ":town_lord", 0),
        (str_store_troop_name, s7, ":town_lord"),
        (store_troop_faction, ":town_lord_faction", ":town_lord"),
        (str_store_faction_name, s8, ":town_lord_faction"),
        (str_store_string, s10, "@{s6} Our {reg4?town:village} and the surrounding lands belong to {s7} of {s8}."),
      (try_end),
      (str_clear, s5),
      (assign, ":number_of_goods", 0),
      (try_for_range, ":cur_good", trade_goods_begin, trade_goods_end),
        (store_sub, ":cur_good_slot", ":cur_good", trade_goods_begin),
        (val_add, ":cur_good_slot", slot_town_trade_good_productions_begin),
        (party_get_slot, ":production", "$g_encountered_party", ":cur_good_slot"),
        (ge, ":production", 5),
        (str_store_item_name, s3, ":cur_good"),
        (try_begin),
          (eq, ":number_of_goods", 0),
          (str_store_string, s5, s3),
        (else_try),
          (eq, ":number_of_goods", 1),
          (str_store_string, s5, "@{s3} and {s5}"),
        (else_try),
          (str_store_string, s5, "@{!}{s3}, {s5}"),
        (try_end),
        (val_add, ":number_of_goods", 1),
      (try_end),
      (try_begin),
        (gt, ":number_of_goods", 0),
        (assign, reg20, 1),
      (else_try),
        (assign, reg20, 0),
      (try_end),
      
      (str_store_string, s11, "@{reg20?We mostly produce {s5} here:We don't produce much here these days}. " +
      "If you would like to learn more, you can speak with our {reg4?guildmaster:village elder}. He is nearby, right over there."),
    ],
    "{s10} {s11}", "close_window",[]],
  
  [anyone|plyr,"town_dweller_talk", [(party_slot_eq, "$current_town", slot_party_type, spt_village),
      (eq, "$welfare_inquired", 0)], "How is life here?", "town_dweller_ask_situation",[(assign, "$welfare_inquired", 1)]],
  [anyone|plyr,"town_dweller_talk", [(party_slot_eq, "$current_town", slot_party_type, spt_town),
      (eq, "$welfare_inquired", 0)], "How is life here?", "town_dweller_ask_situation",[(assign, "$welfare_inquired", 1)]],
  
  
  [anyone,"town_dweller_ask_situation", [(call_script, "script_agent_get_town_walker_details", "$g_talk_agent"),
      (assign, ":walker_type", reg0),
      (eq, ":walker_type", walkert_needs_money),
      (party_slot_eq, "$current_town", slot_party_type, spt_village)],
    "Disaster has struck my family, {sir/madam}. We have no land of our own, and the others have no money to pay for our labor, or even to help us. My poor children lie at home hungry and sick. I don't know what we'll do.", "town_dweller_poor",[]],
  
  [anyone,"town_dweller_ask_situation", [(call_script, "script_agent_get_town_walker_details", "$g_talk_agent"),
      (assign, ":walker_type", reg0),
      (eq, ":walker_type", walkert_needs_money)],
    "My life is miserable, {sir/madam}. I haven't been able to find a job for months, and my poor children go to bed hungry each night. " +
    "My neighbours are too poor themselves to help me.", "town_dweller_poor",[]],
  
  [anyone|plyr,"town_dweller_poor", [(store_troop_gold, ":gold", "trp_player"),
      (ge, ":gold", 300),
    ],
    "Then take these 300 denars. I hope this will help you and your family.", "town_dweller_poor_paid",
    [(troop_remove_gold, "trp_player", 300),
  ]],
  
  [anyone|plyr,"town_dweller_poor", [],
    "Then clearly you must travel somewhere else, or learn another trade.", "town_dweller_poor_not_paid",[]],
  
  [anyone,"town_dweller_poor_not_paid", [], "Yes {sir/madam}. I will do as you say.", "close_window",[]],
  
  [anyone,"town_dweller_poor_paid", [], "{My lord/My good lady}. " +
    "You are so good and generous. I will tell everyone how you helped us.", "close_window",
    [(call_script, "script_change_player_relation_with_center", "$g_encountered_party", 1),
      (call_script, "script_agent_get_town_walker_details", "$g_talk_agent"),
      (assign, ":walker_no", reg2),
      (call_script, "script_center_set_walker_to_type", "$g_encountered_party", ":walker_no", walkert_needs_money_helped),
  ]],
  
  [anyone,"town_dweller_ask_situation", [(call_script, "script_agent_get_town_walker_details", "$g_talk_agent"),
      (assign, ":walker_type", reg0),
      (eq, ":walker_type", walkert_needs_money_helped)
    ],
    "Thank you for your kindness {sir/madam}. With your help our lives will be better. I will pray for you everyday.", "close_window",[]],
  
  [anyone,"town_dweller_ask_situation", [(neg|party_slot_ge, "$current_town", slot_town_prosperity, 30)],
    "Times are hard, {sir/madam}. We work hard all day and yet we go to sleep hungry most nights.", "town_dweller_talk",[]],
  
  [anyone,"town_dweller_ask_situation", [(neg|party_slot_ge, "$current_town", slot_town_prosperity, 70)],
    "Times are hard, {sir/madam}. But we must count our blessings.", "town_dweller_talk",[]],
  [anyone,"town_dweller_ask_situation", [],
    "We are not doing too badly {sir/madam}. We must count our blessings.", "town_dweller_talk",[]],
  
  
  [anyone|plyr,"town_dweller_talk", [], "What is your trade?", "town_dweller_ask_trade",[]],
  
  [anyone,"town_dweller_ask_trade", [
      (call_script, "script_town_walker_occupation_string_to_s14", "$g_talk_agent"),
    ],
    "{s14}", "town_dweller_talk",[]],
  
  
  
  [anyone|plyr,"town_dweller_talk", [(eq, "$rumors_inquired", 0)], "What is the latest rumor around here?", "town_dweller_ask_rumor",[(assign, "$rumors_inquired", 1)]],
  [anyone,"town_dweller_ask_rumor", [(neg|party_slot_ge, "$current_town", slot_center_player_relation, -5)], "I don't know anything that would be of interest to you.", "town_dweller_talk",[]],
  
  [anyone,"town_dweller_ask_rumor", [(store_mul, ":rumor_id", "$current_town", 197),
      (val_add,  ":rumor_id", "$g_talk_agent"),
      (call_script, "script_get_rumor_to_s61", ":rumor_id"),
      (gt, reg0, 0)], "{s61}", "town_dweller_talk",[]],
  
  [anyone,"town_dweller_ask_rumor", [], "I haven't heard anything interesting lately.", "town_dweller_talk",[]],
  
  [anyone|plyr,"town_dweller_talk", [], "[Leave]", "close_window",[]],
  
  [anyone,"start", [(eq, "$talk_context", 0),
      (is_between,"$g_talk_troop",regular_troops_begin, regular_troops_end),
      (party_slot_eq,"$current_town",slot_town_lord, "trp_player"),
      ], "Yes {sir/madam}?", "player_castle_guard_talk",[]],
  [anyone|plyr,"player_castle_guard_talk", [], "How goes the watch, soldier?", "player_castle_guard_talk_2",[]],
  [anyone,"player_castle_guard_talk_2", [], "All is quiet {sir/madam}. Nothing to report.", "player_castle_guard_talk_3",[]],
  [anyone|plyr,"player_castle_guard_talk_3", [], "Good. Keep your eyes open.", "close_window",[]],
  
  
  [anyone,"start", [(eq, "$talk_context", 0),
      (is_between,"$g_talk_troop",regular_troops_begin, regular_troops_end),
      (is_between,"$g_encountered_party_faction",kingdoms_begin, kingdoms_end),
      (eq, "$players_kingdom", "$g_encountered_party_faction"),
      (troop_slot_ge, "trp_player", slot_troop_renown, 100),
      (str_store_party_name, s10, "$current_town"),
      ], "Good day, {sir/madame}. Always an honor to have you here in {s10}.", "close_window",[]],
  
  [anyone,"start", [(eq, "$talk_context", 0),
      (is_between,"$g_talk_troop",regular_troops_begin, regular_troops_end),
      (is_between,"$g_encountered_party_faction",kingdoms_begin, kingdoms_end),
      ], "Mind your manners within the walls and we'll have no trouble.", "close_window",[]],
  
  [anyone,"start", [(eq, "$talk_context", tc_court_talk),
      (is_between,"$g_talk_troop",regular_troops_begin, regular_troops_end),
      (is_between,"$g_encountered_party_faction",kingdoms_begin, kingdoms_end),
      (party_slot_eq,"$current_town",slot_town_lord, "trp_player"),
      ], "Your orders, {my lord/my lady}?", "hall_guard_talk",[]],
  
  [anyone,"start", [(eq, "$talk_context", tc_court_talk),
      (is_between,"$g_talk_troop",regular_troops_begin, regular_troops_end),
      (is_between,"$g_encountered_party_faction",kingdoms_begin, kingdoms_end),
      ], "We are not supposed to talk while on guard, {sir/madam}.", "close_window",[]],
  
  [anyone|plyr,"hall_guard_talk", [], "Stay on duty and let me know if anyone comes to see me.", "hall_guard_duty",[]],
  [anyone,"hall_guard_duty", [], "Yes, {my lord/my lady}. As you wish.", "close_window",[]],
  
  [anyone|plyr,"hall_guard_talk", [
      (eq, 1, 0),
      ], "I want you to arrest this man immediately!", "hall_guard_arrest",[]],
  [anyone,"hall_guard_arrest", [], "Who do you want arrested {sir/madam}?", "hall_guard_arrest_2",[]],
  [anyone|plyr,"hall_guard_arrest_2", [], "Ah, never mind my high spirits lads.", "close_window",[]],
  [anyone|plyr,"hall_guard_arrest_2", [], "Forget it. I will find another way to deal with this.", "close_window",[]],
  
  [anyone,"enemy_defeated", [], "Arggh! I hate this.", "close_window",[]],
  
  [anyone,"party_relieved", [], "Thank you for helping us against those bastards.", "close_window",[]],
  
  [anyone,"start", [(eq,"$talk_context", tc_party_encounter),(store_encountered_party, reg(5)),(party_get_template_id,reg(7),reg(5)),(eq,reg(7),"pt_sea_raiders")],
    "I will drink from your skull!", "battle_reason_stated",[(play_sound,"snd_encounter_sea_raiders")]],
  
  ######################################
  # GENERIC MEMBER CHAT 1429
  ######################################dd
  
  [anyone,"member_chat", [], "Your orders {sir/madam}?", "regular_member_talk",[]],
  [anyone|plyr,"regular_member_talk", [], "Tell me about yourself", "view_regular_char_requested",[]],
  [anyone,"view_regular_char_requested", [], "Aye {sir/madam}. Let me tell you all there is to know about me.", "do_regular_member_view_char",[[change_screen_view_character]]],
  [anyone,"do_regular_member_view_char", [], "Anything else?", "regular_member_talk",[]],
  [anyone|plyr,"regular_member_talk", [], "Je voulais vous dire que je suis fier de vous...", "regular_member_fier",
    [
      
  ]],
  [anyone,"regular_member_fier", [], "C'est un honneur Capitaine,nous nous batterons comme des diables jusqu'a la victoire finale.", "member_chat",[]],
  [anyone|plyr,"regular_member_talk", [], "Nothing. Keep moving.", "close_window",[]],
  
  
  
  
  ######################################
  # GENERIC PARTY ENCOUNTER
  ######################################
  
  [anyone,"start", [(eq,"$talk_context",tc_party_encounter),
      (gt,"$encountered_party_hostile",0),
      (encountered_party_is_attacker),
    ],
    "You have no chance against us. Surrender now or we will kill you all...", "party_encounter_hostile_attacker",
    [(try_begin),
        (eq,"$g_encountered_party_template","pt_steppe_bandits"),
        (play_sound, "snd_encounter_steppe_bandits"),
      (try_end)]],
  #  [anyone|plyr,"party_encounter_hostile_attacker", [
  #                    ],
  #   "I will pay you 1000 denars if you just let us go.", "close_window", []],
  [anyone|plyr,"party_encounter_hostile_attacker", [
    ],
    "We will fight you to the end!", "close_window", []],
  [anyone|plyr,"party_encounter_hostile_attacker", [
    ],
    "Don't attack! We surrender.", "close_window", [(assign,"$g_player_surrenders",1)]],
  
  [anyone,"start", [(eq,"$talk_context",tc_party_encounter),
      (neg|encountered_party_is_attacker),
    ],
    "What do you want?", "party_encounter_hostile_defender",
    []],
  
  [anyone|plyr,"party_encounter_hostile_defender", [],
    "Surrender or die!", "party_encounter_hostile_ultimatum_surrender", [
      
  ]],
  
  #post 0907 changes begin
  [anyone,"party_encounter_hostile_ultimatum_surrender", [],
    "{s43}", "close_window", [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_lord_challenged_default"),
  ]],
  #post 0907 changes end
  
  [anyone|plyr,"party_encounter_hostile_defender", [],
    "Nothing. We'll leave you in peace.", "close_window", [(assign, "$g_leave_encounter",1)]],
  
  
  
  
  
  
  
  
  [anyone|auto_proceed, "start",
    [
      (is_between, "$g_talk_troop", "trp_swadian_merchant", "trp_startup_merchants_end"),
      (check_quest_active, "qst_collect_men"),
      #(neq, "$talk_context", tc_tavern_talk),
      #(neq, "$talk_context", tc_back_alley),
      (eq, "$talk_context", tc_merchants_house),
    ],
    "{!}.", "merchant_end", []],
  
  [anyone, "merchant_end", [],
    "Heh! I must really be in a tight spot, to place my hopes in a passing stranger. However, something about you tells me that my trust is not misplaced. Now, go see if you can round up some volunteers.", "close_window", []],
  
  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_swadian_merchant", "trp_startup_merchants_end"),
      (eq, "$talk_context", tc_merchants_house),
      (check_quest_active, "qst_save_town_from_bandits"),
      
      (store_div, ":number_of_civilian_loses_div_2", "$number_of_civilian_loses", 2),
      
      (try_begin),
        (eq, "$g_killed_first_bandit", 1),
        (store_add, ":player_success", "$number_of_bandits_killed_by_player", 1),
      (else_try),
        (store_add, ":player_success", "$number_of_bandits_killed_by_player", 0),
      (try_end),
      
      (val_sub, ":player_success", ":number_of_civilian_loses_div_2"),
      (val_max, ":player_success", 0),
      
      (call_script, "script_change_player_relation_with_center", "$g_starting_town", ":player_success"),
      
      (try_begin),
        (eq, "$g_killed_first_bandit", 1),
        (gt, "$number_of_bandits_killed_by_player", 2),
        (str_store_string, s3, "str_you_fought_well_at_town_fight_survived"),
        (troop_add_gold, "trp_player", 200),
      (else_try),
        (eq, "$g_killed_first_bandit", 1),
        (gt, "$number_of_bandits_killed_by_player", 0),
        (str_store_string, s3, "str_you_fought_normal_at_town_fight_survived"),
        (troop_add_gold, "trp_player", 200),
      (else_try),
        (eq, "$g_killed_first_bandit", 1),
        (eq, "$number_of_bandits_killed_by_player", 0),
        (str_store_string, s3, "str_you_fought_bad_at_town_fight_survived"),
        (troop_add_gold, "trp_player", 100),
      (else_try),
        (eq, "$g_killed_first_bandit", 0),
        (ge, "$number_of_bandits_killed_by_player", 2),
        (str_store_string, s3, "str_you_fought_well_at_town_fight"),
        (troop_add_gold, "trp_player", 100),
      (else_try),
        (str_store_string, s3, "str_you_wounded_at_town_fight"),
        (troop_add_gold, "trp_player", 100),
      (try_end),
      
      (try_begin),
        (ge, "$number_of_civilian_loses", 1),
        (assign, reg0, "$number_of_civilian_loses"),
        (str_store_string, s2, "str_unfortunately_reg0_civilians_wounded_during_fight_more"),
      (else_try),
        (eq, "$number_of_civilian_loses", 1),
        (assign, reg0, "$number_of_civilian_loses"),
        (str_store_string, s2, "str_unfortunately_reg0_civilians_wounded_during_fight"),
      (else_try),
        (str_store_string, s2, "str_also_one_another_good_news_is_any_civilians_did_not_wounded_during_fight"),
      (try_end),
      
      (call_script, "script_succeed_quest", "qst_save_town_from_bandits"),
      (call_script, "script_end_quest", "qst_save_town_from_bandits"),
    ],
    "{s3}{s2}", "merchant_quest_4e",
    []],
  
  [anyone|plyr,"merchant_quest_4e",
    [
      (try_begin),
        (eq, "$g_killed_first_bandit", 1),
        (gt, "$number_of_bandits_killed_by_player", 2),
        (str_store_string, s1, "str_you_fought_well_at_town_fight_survived_answer"),
      (else_try),
        (eq, "$g_killed_first_bandit", 1),
        (gt, "$number_of_bandits_killed_by_player", 0),
        (str_store_string, s1, "str_you_fought_normal_at_town_fight_survived_answer"),
      (else_try),
        (eq, "$g_killed_first_bandit", 1),
        (eq, "$number_of_bandits_killed_by_player", 0),
        (str_store_string, s1, "str_you_fought_bad_at_town_fight_survived_answer"),
      (else_try),
        (eq, "$g_killed_first_bandit", 0),
        (ge, "$number_of_bandits_killed_by_player", 2),
        (str_store_string, s1, "str_you_fought_well_at_town_fight_answer"),
      (else_try),
        (str_store_string, s1, "str_you_wounded_at_town_fight_answer"),
      (try_end),
    ],
    "{s1}", "merchant_finale",
    [
      (assign, "$dialog_with_merchant_ended", 1),
  ]],
  
  #[anyone|auto_proceed, "start",
  #[
  #  (is_between, "$g_talk_troop", "trp_swadian_merchant", "trp_startup_merchants_end"),
  #  (eq, "$talk_context", tc_merchants_house),
  #  (check_quest_finished, "qst_save_town_from_bandits"),
  #],
  #"{!}.", "merchant_all_quest_completed",
  #[
  #]],
  
  
  [anyone|plyr,"merchant_quest_4e",
    [
    ],
    "The Heavens alone grant us victory.", "merchant_finale",
    [  (assign, "$dialog_with_merchant_ended", 1),
  ]],
  
  [anyone|plyr,"merchant_quest_4e",
    [],
    "I'm glad to see that you're alive, too.", "merchant_finale",
    [
      (assign, "$dialog_with_merchant_ended", 1),
  ]],
  
  [anyone,"merchant_finale", [
      (faction_get_slot, ":faction_leader", "$g_encountered_party_faction", slot_faction_leader),
      (str_store_troop_name, s5, ":faction_leader"),
    ],
    "Yes, yes... Now, a couple of my boys have the watch captain pinned down in a back room, with a knife at his throat. I''ll need to go drag him before {s5} and explain what this breach of the peace is all about. You don't need to be part of that, though. I'll tell you what -- if all goes well, I'll meet you in the tavern again shortly, and let you know how it all came out. If you don't see me in the tavern, but instead see my head on a spike over the city gate, I'll assume you know enough to stay out of town for a while and forget this whole episode ever happened. So -- hopefully we'll meet again!", "close_window",
    [
      (assign, "$g_do_one_more_meeting_with_merchant", 2),
      # (assign, "$g_do_one_more_meeting_with_merchant", 1), no need to this, do not open this line, it is already assigning while leaving mission.
      # (jump_to_menu, "mnu_town"),
      # (finish_mission, 0),
  ]],
  
  
  
  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_swadian_merchant", "trp_startup_merchants_end"),
      (eq, "$talk_context", tc_merchants_house),
      (neg|check_quest_finished, "qst_collect_men"),
      (eq, "$current_startup_quest_phase", 1),
      
      (try_begin),
        (eq, "$g_killed_first_bandit", 1),
        (str_store_string, s1, "str_are_you_all_right"),
      (else_try),
        (str_store_string, s1, "str_you_are_awake"),
      (try_end),
    ],
    "{s1}", "merchant_quest_1_prologue_1",
    []],
  
  [anyone,"merchant_quest_1_prologue_1",
    [
    ],
    "We've always had brigands in the hills, driven to banditry by war, debt, or love of violence. Recently, however, they've been getting bolder -- leaving their camps in the wild and venturing into town, looking for unwary prey. The watch commander tells us it's because of all the fighting on the frontiers -- fewer men to keep an eye on the streets -- but I'm not sure what to make of that. It seems to me that the most logical explanation is that these bandits have an ally inside the walls, who helps them enter unnoticed and helps them identify particularly tempting targets... Last week, you see, they took my brother.", "merchant_quest_1_prologue_2",
    []],
  
  [anyone,"merchant_quest_1_prologue_2",
    [],
    "I don't know what my brother was thinking -- a lad from a prominent house, out alone after dark in times like these... Well, I suppose you were too, but you're a stranger here, and didn't know how bad things have become. He had no such excuse. But he's family, so what can you do? If you don't protect your kin, then people will start thinking that you can't protect your investements, either, and I can't have that... No doubt the gang will soon send word about a ransom, but I don't care to pay it.", "merchant_quest_1_prologue_3",[]],
  
  
  [anyone,"merchant_quest_1_prologue_3",
    [],
    "So here's my proposition. You look like you've had a bit of experience with a blade -- and more importantly, you must have a bit of fire in your belly, or you wouldn't be coming to France to seek your fortune. So here's what I'm asking you to do: gather a small party, track down these bandits to their lair, teach them a lesson they won't forget, and get my brother back safe. In return, you'll earn my lasting gratitude and a bit of silver. What do you say?", "merchant_quest_1a",[]],
  
  [anyone|plyr,"merchant_quest_1a",
    [
    ],
    "I am interested.", "merchant_quest_1b",[]],
  
  [anyone|plyr,"merchant_quest_1a",
    [
    ],
    "I am not interested, have more important business to do.", "close_window",
    [
      (assign, "$dialog_with_merchant_ended", 1),
  ]],
  
  [anyone,"merchant_quest_1b",
    [
    ],
    "You won't be able to do this by yourself, though. If you try and take on the whole gang singlehandedly, the hunter will become the hunted, I'll warrant. You'll first want to round up a group of volunteers. There's always a few lads in the villages around here, looking for a bit of work that's more interesting than tilling the soil or hauling water. They'll follow you if you pay. So... Take this purse of 100 denars. Consider it an advance on your reward. Go round to the villages, and use the money to hire some help. I'll reckon that you need at least five men to take on these bandits.", "merchant_quest_1c",
    [
      (call_script, "script_troop_add_gold", "trp_player", 100),
      
      (str_store_troop_name, s9, "$g_talk_troop"),
      (str_store_party_name, s1, "$g_starting_town"),
      (str_store_string, s2, "str_start_up_quest_message_1"),
      
      (call_script, "script_start_quest", "qst_collect_men", "$g_talk_troop"),
      
      (party_get_position, pos1, "$current_town"),
  ]],
  
  [anyone|plyr,"merchant_quest_1c",
    [
    ],
    "Very good, sir. I'll go collect some men from around the villages.", "merchant_quest_1d",[]],
  
  [anyone,"merchant_quest_1d",
    [
      (str_store_party_name, s1, "$current_town"),
    ],
    "Good. You can find me again in the tavern here in {s1} after you've got your group together. Then we'll speak about what we do next.", "close_window",
    [
      (assign, "$dialog_with_merchant_ended", 1),
  ]],
  
  
  
  #[anyone, "merchant_all_quest_completed",
  #[
  #],
  #"TODO-STARTUP : You can leave now.", "close_window",
  #[
  #]],
  
  [anyone,"start", [], "Surrender or die. Make your choice", "battle_reason_stated",[]],
  [anyone|plyr,"battle_reason_stated", [], "I am not afraid of you. I will fight.", "close_window",[[encounter_attack]]],
  
  [anyone,"start", [], "Hello. What can I do for you?", "free",[]],
  [anyone|plyr,"free", [[neg|in_meta_mission]], "Tell me about yourself", "view_char_requested",[]],
  [anyone,"view_char_requested", [], "Very well, listen to this...", "view_char",[[change_screen_view_character]]],
  [anyone,"view_char", [], "Anything else?", "free",[]],
  
  [anyone|plyr,"end", [], "[Done]", "close_window",[]],
  
  [anyone|plyr,"start", [], "Drop your weapons and surrender if you want to live", "threaten_1",[]],
  [anyone,"threaten_1", [], "We will fight you first", "end",[[encounter_attack]]],
  
  #  [anyone|plyr,"free", [[partner_is_mercmaster]], "I need to hire some mercenaries.", "mercenaries_requested",[]],
  #  [anyone,"mercenaries_requested", [], "I have the toughest fighters in all Calradia.", "buy_mercenaries",[[change_screen_buy_mercenaries]]],
  #  [anyone,"buy_mercenaries", [], "Anything else?", "free",[]],
  
  #  [anyone|plyr,"free", [[partner_is_recruitable]], "I need a capable sergeant like yourself. How much do you ask to work for me?", "employ_mercenary_requested",[]],
  #  [anyone,"employ_mercenary_requested", [[store_mercenary_price,0],[store_mercenary_wage,1]], "I want {reg0} denars now and {reg1} denars as monthly payment.", "employ_mercenary_2",[]],
  #  [anyone|plyr,"employ_mercenary_2", [], "I see I need to think of this.", "employ_mercenary_giveup",[]],
  #  [anyone|plyr,"employ_mercenary_2", [[neg|hero_can_join]], "I don't have any more room in my party right now. I will talk to you again later.", "employ_mercenary_giveup",[]],
  #  [anyone|plyr,"employ_mercenary_2", [[player_gold_ge,reg(0)],[hero_can_join]], "That's fine. Here's the {reg0} denars. From now on you work for me.", "employ_mercenary_commit",[[troop_remove_gold, "trp_player",reg(0)],[recruit_mercenary]]],
  #  [anyone,"employ_mercenary_giveup", [], "Suits me.", "free",[]],
  #  [anyone,"employ_mercenary_commit", [], "You got yourself the best fighter in the land.", "end",[]],
  
  
  [anyone,"member_direct_campaign", [], "Yes, {my lord/my lady}. Which message do you wish to send to the vassals?", "member_direct_campaign_choice",
    []],
  
  
  
  [anyone|plyr,"member_direct_campaign_choice",
    [
      #     (eq, "$g_talk_troop_faction", "$players_kingdom"),
      (this_or_next|neg|faction_slot_ge, "$players_kingdom", slot_faction_marshall, active_npcs_begin),
      (eq, "$players_kingdom", "fac_player_supporters_faction"),
      (this_or_next|faction_slot_eq, "$players_kingdom", slot_faction_ai_state, sfai_default),
      (faction_slot_eq, "$players_kingdom", slot_faction_ai_state, sfai_feast),
    ],
    "I want to start a new campaign. Let us assemble the army here.", "member_direct_campaign_call_to_arms_verify",
    [
      (faction_get_slot, ":old_marshall", "$players_kingdom", slot_faction_marshall),
      (try_begin),
        (ge, ":old_marshall", 0),
        (troop_get_slot, ":old_marshall_party", ":old_marshall", slot_troop_leaded_party),
        (party_is_active, ":old_marshall_party"),
        (party_set_marshall, ":old_marshall_party", 0),
      (try_end),
      
      (faction_set_slot, "$players_kingdom", slot_faction_marshall, "trp_player"),
  ]],
  
  [anyone|plyr,"member_direct_campaign_choice",
    [
      #     (eq, "$g_talk_troop_faction", "$players_kingdom"),
      (faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"),
      (neg|faction_slot_eq, "$players_kingdom", slot_faction_ai_state, sfai_default),
      (neg|faction_slot_eq, "$players_kingdom", slot_faction_ai_state, sfai_feast),
    ],
    "I want to end the campaign and let everyone return home.", "member_give_order_disband_army_verify", []],
  
  [anyone|plyr,"member_direct_campaign_choice",
    [
      #     (eq, "$g_talk_troop_faction", "$players_kingdom"),
      (faction_slot_eq, "$players_kingdom", slot_faction_marshall, "trp_player"),
      (neg|faction_slot_eq, "$players_kingdom", slot_faction_ai_state, sfai_feast),
      (check_quest_active, "qst_organize_feast"),
      (quest_get_slot, ":venue", "qst_organize_feast", slot_quest_target_center),
      (store_faction_of_party, ":venue_faction", ":venue"),
      (eq, ":venue_faction", "$players_kingdom"),
      (str_store_party_name, s4, ":venue"),
    ],
    "I wish to invite the vassals of the realm to a feast at {s4}.", "member_give_order_invite_feast_verify", []],
  
  
  
  
  [anyone|plyr,"member_direct_campaign_choice",
    [
    ],
    "Never mind", "member_pretalk",
    []],
  
  
  
  
  [anyone,"member_give_order_invite_feast_verify", [],
    "You wish to invite the lords of the realm to a feast?", "member_give_order_invite_feast_verify_2",[]],
  
  [anyone|plyr,"member_give_order_invite_feast_verify_2", [], "Yes. It is time for us to strengthen the bonds that bring us together.", "member_give_order_invite_feast",[]],
  [anyone|plyr,"member_give_order_invite_feast_verify_2", [], "On second thought, this is perhaps not the time.", "member_pretalk",[]],
  
  [anyone,"member_give_order_invite_feast",
    [
      (quest_get_slot, ":venue", "qst_organize_feast", slot_quest_target_center),
      (str_store_party_name, s4, ":venue"),
    ],
    "All right then. I shall dispatch messengers informing the lords of the realm of your feast at {s4}.", "member_pretalk",
    [
      (quest_get_slot, ":venue", "qst_organize_feast", slot_quest_target_center),
      
      (assign, "$player_marshal_ai_state", sfai_feast),
      (assign, "$player_marshal_ai_object", ":venue"),
      (call_script, "script_decide_faction_ai", "$players_kingdom"),
      (assign, "$g_recalculate_ais", 1),
      (str_store_party_name, s4, ":venue"),
      
  ]],
  
  
  
  
  
  [anyone,"member_direct_campaign_call_to_arms_verify", [],
    "You wish to summon all lords for a new campaign?", "member_give_order_call_to_arms_verify_2",[]],
  
  [anyone|plyr,"member_give_order_call_to_arms_verify_2", [], "Yes. We must gather all our forces before we march on the enemy.", "member_give_order_call_to_arms",[]],
  [anyone|plyr,"member_give_order_call_to_arms_verify_2", [], "On second thought, it won't be necessary to summon everyone.", "member_pretalk",[]],
  
  [anyone,"member_give_order_call_to_arms",
    [],
    "All right then. I will send messengers and tell everyone to come here.", "member_pretalk",
    [
      (assign, "$player_marshal_ai_state", sfai_gathering_army),
      (assign, "$player_marshal_ai_object", "p_main_party"),
      (call_script, "script_decide_faction_ai", "$players_kingdom"),
      (assign, "$g_recalculate_ais", 1),
  ]],
  
  
  [anyone,"member_give_order_disband_army_verify", [],
    "You want to end the current campaign and release all lords from duty?", "member_give_order_disband_army_2",[]],
  
  [anyone|plyr,"member_give_order_disband_army_2", [], "Yes. We no longer need all our forces here.", "member_give_order_disband_army",[]],
  [anyone|plyr,"member_give_order_disband_army_2", [], "On second thought, it will be better to stay together for now.", "member_pretalk",[]],
  
  [anyone,"member_give_order_disband_army",
    [],
    "All right. I will let everyone know that they are released from duty.", "member_pretalk",
    [
      (assign, "$player_marshal_ai_state", sfai_default),
      (assign, "$player_marshal_ai_object", -1),
      (call_script, "script_decide_faction_ai", "$players_kingdom"),
      (assign, "$g_recalculate_ais", 1),
      
  ]],
  
  
  [anyone,"mayor_wealth_comparison_1",[
      
      (assign, ":wealthiest_center", "$g_encountered_party"),
      (assign, ":poorer_centers", 0),
      (assign, ":richer_centers", 0),
      
      (party_get_slot, ":wealthiest_center_wealth", "$g_encountered_party", slot_town_prosperity),
      (party_get_slot, ":mayor_center_wealth", "$g_encountered_party", slot_town_prosperity),
      
      (try_for_range, ":other_center", towns_begin, towns_end),
        (neq, ":other_center", "$g_encountered_party"),
        (party_get_slot, ":other_center_wealth", ":other_center", slot_town_prosperity),
        (try_begin),
          (gt, ":other_center_wealth", ":wealthiest_center_wealth"),
          (val_add, ":richer_centers", 1),
          (assign, ":wealthiest_center", ":other_center"),
          (assign, ":wealthiest_center_wealth", ":other_center_wealth"),
        (else_try),
          (gt, ":other_center_wealth", ":mayor_center_wealth"),
          (val_add, ":richer_centers", 1),
        (else_try),
          (val_add, ":poorer_centers", 1),
        (try_end),
      (try_end),
      
      (assign, reg4, ":richer_centers"),
      (assign, reg5, ":poorer_centers"),
      (str_store_party_name, s5, "$g_encountered_party"),
      (str_store_party_name, s4, ":wealthiest_center"),
      
      ], "Overall, the wealthiest town in France is known to be {s4}. Here in {s5}, we are poorer than {reg4} towns, and richer than {reg5}.", "mayor_wealth_comparison_2",[
  ]],
  #Production of this town
  #Production of the hinterland
  #Volume of trade
  
  [anyone,"mayor_wealth_comparison_2",[
      
      (assign, ":wealthiest_center", "$g_encountered_party"),
      (assign, ":poorer_centers", 0),
      (assign, ":richer_centers", 0),
      
      (assign, ":mayor_town_production", 0),
      (try_for_range, ":item_kind_id", trade_goods_begin, trade_goods_end),
        (call_script, "script_center_get_production", "$g_encountered_party", ":item_kind_id"),
        (val_add, ":mayor_town_production", reg0),
      (try_end),
      (assign, ":wealthiest_town_production", ":mayor_town_production"),
      
      (try_begin),
        (ge, "$cheat_mode", 1),
        (assign, reg4, ":mayor_town_production"),
        (str_store_party_name, s4, "$g_encountered_party"),
        (display_message, "@{!}DEBUG -- Total production for {s4}: {reg4}"),
      (try_end),
      
      
      (try_for_range, ":other_center", towns_begin, towns_end),
        (neq, ":other_center", "$g_encountered_party"),
        (assign, ":other_town_production", 0),
        (try_for_range, ":item_kind_id", trade_goods_begin, trade_goods_end),
          (call_script, "script_center_get_production", ":other_center", ":item_kind_id"),
          (val_add, ":other_town_production", reg0),
        (try_end),
        (try_begin),
          (ge, "$cheat_mode", 1),
          (assign, reg4, ":other_town_production"),
          (str_store_party_name, s4, ":other_center"),
          (display_message, "@{!}DEBUG -- Total production for {s4}: {reg4}"),
        (try_end),
        
        (try_begin),
          (gt, ":other_town_production", ":wealthiest_town_production"),
          (val_add, ":richer_centers", 1),
          (assign, ":wealthiest_center", ":other_center"),
          (assign, ":wealthiest_town_production", ":other_town_production"),
        (else_try),
          (gt, ":other_town_production", ":mayor_town_production"),
          (val_add, ":richer_centers", 1),
        (else_try),
          (val_add, ":poorer_centers", 1),
        (try_end),
      (try_end),
      
      (assign, reg4, ":richer_centers"),
      (assign, reg5, ":poorer_centers"),
      (str_store_party_name, s5, "$g_encountered_party"),
      (str_store_party_name, s4, ":wealthiest_center"),
      
      ], "In terms of local industry, the most productive town in France is known to be {s4}. Here in {s5}, we produce less than {reg4} towns, and produce more than {reg5}. Production is of course affected by the supply of raw materials, as well as by the overall prosperity of the town.", "mayor_wealth_comparison_3",[
  ]],
  
  [anyone,"mayor_wealth_comparison_3",[
      
      (assign, ":wealthiest_center", "$g_encountered_party"),
      (assign, ":poorer_centers", 0),
      (assign, ":richer_centers", 0),
      
      (try_for_range, ":town", towns_begin, towns_end),
        (party_set_slot, ":town", slot_party_temp_slot_1, 0),
      (try_end),
      
      (try_for_range, ":village", villages_begin, villages_end),
        (assign, ":village_good_production", 0),
        (try_for_range, ":item_kind_id", trade_goods_begin, trade_goods_end),
          (call_script, "script_center_get_production", ":village", ":item_kind_id"),
          (val_add, ":village_good_production", reg0),
        (try_end),
        (party_get_slot, ":market_town", ":village", slot_village_market_town),
        (party_get_slot, ":market_center_production", ":market_town", slot_party_temp_slot_1),
        (val_add, ":market_center_production", ":village_good_production"),
        (party_set_slot, ":market_town", slot_party_temp_slot_1, ":market_center_production"),
      (try_end),
      
      
      (party_get_slot, ":mayor_town_production", "$g_encountered_party", slot_party_temp_slot_1),
      (assign, ":wealthiest_town_production", ":mayor_town_production"),
      
      (try_begin),
        (ge, "$cheat_mode", 1),
        (assign, reg4, ":mayor_town_production"),
        (str_store_party_name, s4, "$g_encountered_party"),
        (display_message, "@{!}DEBUG -- Total rural production for {s4} region: {reg4}"),
      (try_end),
      
      
      (try_for_range, ":other_center", towns_begin, towns_end),
        (neq, ":other_center", "$g_encountered_party"),
        (party_get_slot, ":other_town_production", ":other_center", slot_party_temp_slot_1),
        
        (try_begin),
          (ge, "$cheat_mode", 1),
          (assign, reg4, ":other_town_production"),
          (str_store_party_name, s4, ":other_center"),
          (display_message, "@{!}DEBUG -- Total rural production for {s4} region: {reg4}"),
        (try_end),
        
        (try_begin),
          (gt, ":other_town_production", ":wealthiest_town_production"),
          (val_add, ":richer_centers", 1),
          (assign, ":wealthiest_center", ":other_center"),
          (assign, ":wealthiest_town_production", ":other_town_production"),
        (else_try),
          (gt, ":other_town_production", ":mayor_town_production"),
          (val_add, ":richer_centers", 1),
        (else_try),
          (val_add, ":poorer_centers", 1),
        (try_end),
      (try_end),
      
      (assign, reg4, ":richer_centers"),
      (assign, reg5, ":poorer_centers"),
      (str_store_party_name, s5, "$g_encountered_party"),
      (str_store_party_name, s4, ":wealthiest_center"),
      
      ], "In terms of the output of the surrounding villages, the town of {s4} is the richest in France. Here in {s5}, the villages produce less than the hinterland around {reg4} towns, and produce more than {reg5}. The wealth of a town's hinterland, of course, is heavily dependent on the tides of war. Looting and pillage, and shifts in territory, can make a major impact.", "mayor_wealth_comparison_4",[
  ]],
  
  
  [anyone,"mayor_wealth_comparison_4",[
      
      (assign, ":wealthiest_center", "$g_encountered_party"),
      (assign, ":poorer_centers", 0),
      (assign, ":richer_centers", 0),
      
      (try_for_range, ":town", towns_begin, towns_end),
        (party_set_slot, ":town", slot_party_temp_slot_1, 0),
      (try_end),
      
      (try_for_range, ":log_entry_iterator", 0, "$num_log_entries"),
        (store_sub, ":log_entry_no", "$num_log_entries", ":log_entry_iterator"),
        (troop_slot_eq, "trp_log_array_entry_type", ":log_entry_no", logent_party_traded),
        
        (troop_get_slot, ":event_time",            "trp_log_array_entry_time",              ":log_entry_no"),
        (store_current_hours, ":cur_hour"),
        (store_sub, ":hours_ago", ":cur_hour", ":event_time"),
        (lt, ":hours_ago", 1344),
        
        (troop_get_slot, ":origin",    "trp_log_array_center_object",          ":log_entry_no"),
        (is_between, ":origin", towns_begin, towns_end), #exclude village trading here
        
        (troop_get_slot, ":destination",    "trp_log_array_troop_object",          ":log_entry_no"),
        (party_get_slot, ":num_visits", ":destination", slot_party_temp_slot_1),
        (val_add, ":num_visits", 1),
        (party_set_slot, ":destination", slot_party_temp_slot_1, ":num_visits"),
      (try_end),
      
      (party_get_slot, ":mayor_town_production", "$g_encountered_party", slot_party_temp_slot_1),
      (assign, ":wealthiest_town_production", ":mayor_town_production"),
      
      (try_begin),
        (ge, "$cheat_mode", 1),
        (assign, reg4, ":mayor_town_production"),
        (str_store_party_name, s4, "$g_encountered_party"),
        (display_message, "@{!}DEBUG -- Total trade for {s4}: {reg4}"),
      (try_end),
      
      
      (try_for_range, ":other_center", towns_begin, towns_end),
        (neq, ":other_center", "$g_encountered_party"),
        (party_get_slot, ":other_town_production", ":other_center", slot_party_temp_slot_1),
        
        (try_begin),
          (ge, "$cheat_mode", 1),
          (assign, reg4, ":other_town_production"),
          (str_store_party_name, s4, ":other_center"),
          (display_message, "@{!}DEBUG -- Total trade for {s4}: {reg4}"),
        (try_end),
        
        (try_begin),
          (gt, ":other_town_production", ":wealthiest_town_production"),
          (val_add, ":richer_centers", 1),
          (assign, ":wealthiest_center", ":other_center"),
          (assign, ":wealthiest_town_production", ":other_town_production"),
        (else_try),
          (gt, ":other_town_production", ":mayor_town_production"),
          (val_add, ":richer_centers", 1),
        (else_try),
          (val_add, ":poorer_centers", 1),
        (try_end),
      (try_end),
      
      (assign, reg4, ":richer_centers"),
      (assign, reg5, ":poorer_centers"),
      (str_store_party_name, s5, "$g_encountered_party"),
      (str_store_party_name, s4, ":wealthiest_center"),
      
      ], "In terms of trade, the town of {s4} is believed to have received the most visits from caravans over the past few months. Here in {s5}, we are less visited than {reg4} towns, and more visited than {reg5}. ", "mayor_wealth_comparison_5",[
  ]],
  
  
  [anyone,"mayor_wealth_comparison_5",[
      
      (assign, ":wealthiest_center", "$g_encountered_party"),
      (assign, ":poorer_centers", 0),
      (assign, ":richer_centers", 0),
      
      (try_for_range, ":town", towns_begin, towns_end),
        (party_set_slot, ":town", slot_party_temp_slot_1, 0),
      (try_end),
      
      (try_for_range, ":log_entry_iterator", 0, "$num_log_entries"),
        (store_sub, ":log_entry_no", "$num_log_entries", ":log_entry_iterator"),
        (troop_slot_eq, "trp_log_array_entry_type", ":log_entry_no", logent_traveller_attacked),
        
        (troop_get_slot, ":event_time",            "trp_log_array_entry_time",              ":log_entry_no"),
        (store_current_hours, ":cur_hour"),
        (store_sub, ":hours_ago", ":cur_hour", ":event_time"),
        (lt, ":hours_ago", 1344),
        
        (troop_get_slot, ":origin",    "trp_log_array_center_object",          ":log_entry_no"),
        (troop_get_slot, ":destination",    "trp_log_array_troop_object",          ":log_entry_no"),
        
        (try_begin),
          (is_between, ":destination", towns_begin, towns_end),
          (party_get_slot, ":num_attacks", ":destination", slot_party_temp_slot_1),
          (val_add, ":num_attacks", 1),
          (party_set_slot, ":destination", slot_party_temp_slot_1, ":num_attacks"),
        (try_end),
        
        (try_begin),
          (is_between, ":origin", towns_begin, towns_end),
          (party_get_slot, ":num_attacks", ":origin", slot_party_temp_slot_1),
          (val_add, ":num_attacks", 1),
          (party_set_slot, ":origin", slot_party_temp_slot_1, ":num_attacks"),
        (try_end),
      (try_end),
      
      (party_get_slot, ":mayor_town_production", "$g_encountered_party", slot_party_temp_slot_1),
      (assign, ":wealthiest_town_production", ":mayor_town_production"),
      
      (try_begin),
        (ge, "$cheat_mode", 1),
        (assign, reg4, ":mayor_town_production"),
        (str_store_party_name, s4, "$g_encountered_party"),
        (display_message, "@{!}DEBUG -- Total attacks for {s4}: {reg4}"),
      (try_end),
      
      
      (try_for_range, ":other_center", towns_begin, towns_end),
        (neq, ":other_center", "$g_encountered_party"),
        (party_get_slot, ":other_town_production", ":other_center", slot_party_temp_slot_1),
        
        (try_begin),
          (ge, "$cheat_mode", 1),
          (assign, reg4, ":other_town_production"),
          (str_store_party_name, s4, ":other_center"),
          (display_message, "@{!}DEBUG -- Total attacks for {s4}: {reg4}"),
        (try_end),
        
        (try_begin),
          (gt, ":other_town_production", ":wealthiest_town_production"),
          (val_add, ":richer_centers", 1),
          (assign, ":wealthiest_center", ":other_center"),
          (assign, ":wealthiest_town_production", ":other_town_production"),
        (else_try),
          (gt, ":other_town_production", ":mayor_town_production"),
          (val_add, ":richer_centers", 1),
        (else_try),
          (val_add, ":poorer_centers", 1),
        (try_end),
      (try_end),
      
      (assign, reg4, ":richer_centers"),
      (assign, reg5, ":poorer_centers"),
      (str_store_party_name, s5, "$g_encountered_party"),
      (str_store_party_name, s4, ":wealthiest_center"),
      
      ], "In terms of attacks on travellers, the town of {s4} is believed to be the most dangerous. Here in {s5}, we are less afflicted by bandits and raiders than {reg4} towns, and more afflicted than {reg5}. ", "mayor_pretalk",[
  ]],
  
  
  
  [anyone|plyr,"free", [[in_meta_mission]], " Good-bye.", "close_window",[]],
  [anyone|plyr,"free", [[neg|in_meta_mission]], " [Leave]", "close_window",[]],
  #  [anyone,"free", [], "NO MATCHING SENTENCE!", "close_window",[]],
]
